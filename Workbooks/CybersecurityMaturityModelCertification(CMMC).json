{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "7184f2f2-6f37-4171-b1aa-d5808dc978b5",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n    {\"value\": \"Yes\", \"label\": \"Yes\", \"selected\":true},\r\n    {\"value\": \"No\", \"label\": \"No\"}\r\n]",
            "timeContext": {
              "durationMs": 86400000
            },
            "label": "Guide",
            "value": "No"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameters: Help / Maturity Levels"
    },
    {
      "type": 1,
      "content": {
        "json": "## What is CMMC?\r\nThe Cybersecurity Maturity Model Certification (CMMC) model consists of maturity processes and cybersecurity best practices from multiple cybersecurity standards, frameworks, and other references, as well as inputs from the Defense Industrial Base (DIB) and Department of Defense (DoD stakeholders. CMMC extends beyond the parent organization into sub-contractors, partners, and suppliers. The model is intended to enforce critical thinking approaches for comprehensive security. The CMMC model specifies 5 levels of maturity measurement from Maturity Level 1 (Basic Cyber Hygiene) to Maturity Level 5 (Proactive & Advanced Cyber Practice). The Certification levels will be determined through audits from independent, third-party assessment organizations (C3PAO). The CMMC framework includes 258 controls, 17 control domains, and 5 maturity levels. Note that CMMC controls have varying application across the Cloud Service Provider (CSP) model including customer responsibility, service provider responsibility, and shared responsibility. For more information, see the Office of the Under Secretary of Defense for Acquisition & Sustainment ðŸ’¡[CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### Legend\r\nðŸ“— Definitions & Guides\r\n\r\nðŸ“˜ Controls Covered: Microsoft/Shared Responsibility (Technical Controls, Best Practice Recommendations etc.)\r\n\r\nðŸ“• Controls Not Covered: Customer Responsibility (Policy, Assessment, Administrative Process etc.)\r\n\r\nðŸ”· Requirement / Required Log Source\r\n\r\nâœ³ï¸ Get Started with Microsoft Products\r\n\r\nðŸ’¡   Reference \r\n\r\nðŸ”Ž Recommended RBAC Role: [SecurityReader](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles) or higher\r\n\r\n#### Disclaimer\r\nThe Azure Sentinel CMMC Workbook demonstrates best practice guidance, but Microsoft does not guarantee nor imply compliance. All accreditation requirements and decisions are governed by the ðŸ’¡Â [CMMC Accreditation Body](https://www.cmmcab.org/c3pao-lp). This workbook provides visibility and situational awareness for control requirements delivered with Microsoft technologies in predominantly cloud-based environments. Customer experience will vary by user and some panels may require additional configurations and query modification for operation. Recommendations do not imply coverage of respective controls as they are often one of several courses of action for approaching requirements which is unique to each customer. Recommendations should be considered a starting point for planning full or partial coverage of respective control requirements. ",
        "style": "success"
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "What is CMMC?",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "nav",
        "links": [
          {
            "id": "3e2a4794-0675-421c-a1cc-1a46a7ad697d",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Access Control (AC)",
            "subTarget": "Access Control (AC)",
            "style": "secondary"
          },
          {
            "id": "f9681e36-456d-46c2-8145-6b55dad9a8e4",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Audit & Accountability (AU)",
            "subTarget": "Audit & Accountability (AU)",
            "style": "secondary"
          },
          {
            "id": "d9e02048-bcc6-4806-aad3-1a0fde899b9a",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Awareness & Training (AT)",
            "subTarget": "Awareness & Training (AT)",
            "style": "secondary"
          },
          {
            "id": "4ee0dc8d-6b89-4175-861f-427361c4454d",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Asset & Configuration (AM/CM)",
            "subTarget": "Asset & Configuration (AM/CM)",
            "style": "secondary"
          },
          {
            "id": "a020a6cc-ed94-446c-92c6-faf6f24358a8",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Identification & Authentication (IA)",
            "subTarget": "Identification & Authentication (IA)",
            "style": "secondary"
          },
          {
            "id": "61ff47e9-fff6-4595-ae6e-69edad4e7e52",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Incident Response (IR)",
            "subTarget": "Incident Response (IR)",
            "style": "secondary"
          },
          {
            "id": "984417e2-49c3-4b46-ad69-2fc76ce1e592",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Maintenance & Media Protection (MA/MP)",
            "subTarget": "Maintenance & Media Protection (MA/MP)",
            "style": "secondary"
          },
          {
            "id": "e4e9c9e0-c7cf-4e93-b0cb-bd6be836415d",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Personnel Security (PS)",
            "subTarget": "Personnel Security (PS)",
            "style": "secondary"
          },
          {
            "id": "c413f6e3-029a-4de4-9a65-281b4b3cd2a7",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Physical Protection (PE)",
            "subTarget": "Physical Protection (PE)",
            "style": "secondary"
          },
          {
            "id": "a2e0599d-2215-4804-8e8a-558bdd907d9d",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Recovery & Risk Management (RE/RM)",
            "subTarget": "Recovery & Risk Management (RE/RM)",
            "style": "secondary"
          },
          {
            "id": "512bd820-7e17-4b91-a76f-5e0cf3b7c9dc",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Security Assessment & Situational Awareness (CA/SA)",
            "subTarget": "Security Assessment & Situational Awareness (CA/SA)",
            "style": "secondary"
          },
          {
            "id": "f9d81be3-0050-449b-b883-9dae58d9c45f",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "System & Communications Protection (SC)",
            "subTarget": "System & Communications Protection (SC)",
            "style": "secondary"
          },
          {
            "id": "bd34020b-a24f-4eda-8b61-723a023fb077",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "System & Information Integrity (SI)",
            "subTarget": "System & Information Integrity (SI)",
            "style": "secondary"
          }
        ]
      },
      "customWidth": "100",
      "name": "Parameters: CMMC Control Families",
      "styleSettings": {
        "margin": "150",
        "padding": "100",
        "maxWidth": "100%"
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "c37d2b7e-b0f1-420e-8664-8144db4ea08d",
            "version": "KqlParameterItem/1.0",
            "name": "Maturity_Level",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n    {\"value\": \"Maturity Level 1\", \"label\": \"Maturity Level 1\", \"selected\":true},\r\n    {\"value\": \"Maturity Level 2\", \"label\": \"Maturity Level 2\"},\r\n    {\"value\": \"Maturity Level 3\", \"label\": \"Maturity Level 3\"},\r\n    {\"value\": \"Maturity Level 4\", \"label\": \"Maturity Level 4\"},\r\n    {\"value\": \"Maturity Level 5\", \"label\": \"Maturity Level 5\"}\r\n]",
            "timeContext": {
              "durationMs": 86400000
            },
            "value": "Maturity Level 5"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameters: Help / Maturity Levels - Copy"
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Access Control (AC)\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Access Control (AC)"
      },
      "name": "Access Control (AC)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nAccess Control is the process of authorizing users, groups, and computers to access objects on a network, asset, and/or cloud. Key concepts that make up access control are permissions, ownership of objects, inheritance of permissions, user rights, and object auditing. TheÂ CMMC Access Control familyÂ includesÂ 31Â controlsÂ withÂ varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: Access Control](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-access-control-1-of-10/)\r\n",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Access Control (AC) OV",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Access Control RequirementsÂ (IncludedÂ inÂ Workbook)\r\n|Â Access ControlÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-1Â |Â AC.1.001 | Limit information system access to authorized users, processes acting on behalf of authorized users or devices (including other information systems).  | \r\n|Â ML-1Â |Â AC.1.002 | Limit information system access to the types of transactions and functions that authorized users are permitted to execute.  | \r\n|Â ML-1Â |Â AC.1.003 | Verify and control/limit connections to and use of external information systems. | \r\n|Â ML-1Â |Â AC.1.004 | Control information posted or processed on publicly accessibleinformation systems. | \r\n|Â ML-2Â |Â AC.2.005 | Provide privacy and security notices consistent with applicable Controlled Unclassified Information (CUI) rules.  | \r\n|Â ML-2Â |Â AC.2.006 | Limit use of portable storage devices on external systems. | \r\n|Â ML-2Â |Â AC.2.007 | Employ the principle of least privilege, including for specific security functions and privileged accounts.  | \r\n|Â ML-2Â |Â AC.2.008 |  Use non-privileged accounts or roles when accessing nonsecurity functions. | \r\n|Â ML-2Â |Â AC.2.009 | Limit unsuccessful logon attempts.  | \r\n|Â ML-2Â |Â AC.2.010 | Use session lock with pattern-hiding displays to prevent access and viewing of data after a period of inactivity.  | \r\n|Â ML-2Â |Â AC.2.011 | Authorize wireless access prior to allowing such connections. | \r\n|Â ML-2Â |Â AC.2.013 | Monitor and control remote access sessions.  | \r\n|Â ML-2Â |Â AC.2.015 | Route remote access via managed access control points.  | \r\n|Â ML-2Â |Â AC.2.016 |  Control the flow of CUI in accordance with approved authorizations. | \r\n|Â ML-3Â |Â AC.3.012 | Protect wireless access using authentication and encryption. |\r\n|Â ML-3Â |Â AC.3.014 | Employ cryptographic mechanisms to protect the confidentiality of remote access sessions.  | \r\n|Â ML-3Â |Â AC.3.017 | Separate the duties of individuals to reduce the risk of malevolent activity without collusion. |\r\n|Â ML-3Â |Â AC.3.018 | Prevent non-privileged users from executing privileged functions and capture the execution of such functions in audit logs. |\r\n|Â ML-3Â |Â AC.3.019 | Terminate (automatically) user sessions after a defined condition. | \r\n|Â ML-3Â |Â AC.3.020 | Control connection of mobile devices. | \r\n|Â ML-3Â |Â AC.3.021 | Authorize remote execution of privileged commands and remote access to security-relevant information. | \r\n|Â ML-3Â |Â AC.3.022 | Encrypt CUI on mobile devices and mobile computing platforms. | \r\n|Â ML-4Â |Â AC.4.023 | Control information flows between security domains on connected systems. |\r\n|Â ML-4Â |Â AC.4.025 | Periodically review and update CUI program access permissions. |\r\n|Â ML-4Â |Â AC.4.032 | Restrict remote network access based on organizational defined risk factors such as time of day, location of access, physical location, network connection state and measured properties of the current user and role.  |\r\n|Â ML-5Â |Â AC.5.024 | Identify and mitigate risk associated with unidentified wireless access points connected to the network |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Access Control Requirements (Included in Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning Access Control with Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Microsoft Azure Security Controls Aligned to CMMC: Access Control\r\n\r\n![Image Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/04/CMMC-Series1-SecurityControlsTable-1-768x965.png  \"Azure Security CMMC AC Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "## What Preparation is Required for CMMC Alignment to Access Control Management?\r\n\r\nItâ€™s important to understand that compliance is a shared responsibility between the customer and the Cloud Services Provider (CSP). The graphic below demonstrates the CSP responsibility in respective cloud models (On-Prem, IaaS, PaaS, SaaS) with dark blue aligning with customer responsibility and light blue aligning with CSP responsibility. \r\n\r\n![Image Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.png  \"CSP Responsibility Model\")\r\n\r\nThe management controls for the CMMC Access Control Maturity Capability (AC-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing a policy that includes access control (ML1) and progresses to reviewing and measuring access control activities for effectiveness (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization.\r\n\r\n![Image Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/04/CMMC-Series1-CustomerPolicyResponsibilitiesNEW.png  \"Customer Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning Access Control with Microsoft Azure",
      "styleSettings": {
        "margin": "3",
        "padding": "3",
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing an Access Control Architecture with Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## 8 Steps to CMMC for Access Control Maturity with Microsoft Azure\r\n\r\nMicrosoft Azure has developed an 11-step process to facilitate access control with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate access control including ðŸ’¡[Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Azure AD: Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure), ðŸ’¡[Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/), ðŸ’¡[Azure Policy](https://docs.microsoft.com/en-us/azure/governance/policy/overview), ðŸ’¡[Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/) andðŸ’¡[Azure VPN Gateway](https://azure.microsoft.com/en-us/services/vpn-gateway/).\r\n\r\n![Image Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/04/CMMC-Series1-11Steps-768x448.png  \"11 Steps to CMMC for Access Control with Microsoft Azure\")\r\n\r\n",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "8 Steps to CMMC for Access Control Maturity with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Implement Secure Authentication\r\nðŸ’¡Â [What authentication and verification methods are available in Azure Active Directory?](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-methods)\r\n###Â 2)Â Implement Role Based Access Control\r\nðŸ’¡Â [Tutorial: Grant a user access to Azure resources using the Azure portal](https://docs.microsoft.com/en-us/azure/role-based-access-control/quickstart-assign-role-user-portal)\r\n###Â 3)Â Enforce Least Privilege\r\nðŸ’¡Â [Quickstart: Create a policy assignment to identify non-compliant resources](https://docs.microsoft.com/en-us/azure/governance/policy/assign-policy-portal)\r\n###Â 4)Â Secure Administrative Rights\r\nðŸ’¡Â [Deploy Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-deployment-plan)\r\n###Â 5)Â Configure Lockout Threshold\r\nðŸ’¡Â [Protect user accounts from attacks with Azure Active Directory smart lockout](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-smart-lockout)\r\n###Â 6)Â Configure Inactivity Lockout\r\nðŸ’¡Â [User sign-in frequency](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-session-lifetime#user-sign-in-frequency)\r\n###Â 7)Â Leverage Adaptive Access Control\r\nðŸ’¡Â [What is Conditional Access?](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)\r\n###Â 8)Â Secure Remote Access\r\nðŸ’¡Â [Configuring a VPN Gateway](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpngateways#configuring)\r\n###Â 9)Â Manage Connections\r\nðŸ’¡Â [Tutorial: Deploy and configure Azure Firewall using the Azure portal](https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal)\r\n###Â 10)Â Control Data Usage\r\nðŸ’¡Â [How to configure a label for Rights Management protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-protection)\r\n###Â 11)Â Secure Confidential Data\r\nðŸ’¡Â [How to configure the policy settings for Azure Information Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-settings)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "DocumentationÂ &Â Guides: AC",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing an Access Control Architecture with Microsoft Azure",
      "styleSettings": {
        "margin": "3",
        "padding": "3",
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.1.001",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nðŸ”·Limit Information System Access to Authorized Users (ML-1)\r\n\r\n### CMMC Guidance\r\nControl who can use company computers and who can log on to the company network. Limit the        services and devices, like printers, that can be accessed by company computers. Set up your system  so that authorized users and devices cannot get on to the company network.\r\n\r\n### Microsoft Recommendation  \r\nControl User Authentications with Azure Active Directory \r\n\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AzureActivityÂ (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n\r\n### Navigate \r\nAzure Active Directory > Users\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [What Authentication and Verification Methods are Available in Azure Active Directory?](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-methods)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.i\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.1\r\n\tâ€¢ CIS Controls v7.1 1.4, 1.6, 5.1, 14.6, 15.10, 16.8, 16.9, 16.11\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-3, PR.AC-4, PR.AC-6, PR.PT-3, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-2, AC- 3, AC-17\r\n\tâ€¢ AU ACSC Essential Eight     \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| summarize Activities = count() by User = Caller\r\n| sort by Activities desc\r\n| take 250\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory Users by Action Count (30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "User",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ],
                "rowLimit": 1000
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "AC.1.001",
      "styleSettings": {
        "margin": "3",
        "padding": "3",
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.1.002",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Limit Information Systems Access to Authorized Transactions/Functions (ML-1) \r\n###Â CMMCÂ Guidance\r\nMake sure to limit users/employees to only the information systems, roles, or applications they are permitted to use and that are needed for their jobs.\r\n###Â Microsoft RecommendationÂ Â \r\nConfigure Role Based Access Control (RBAC) with Azure Active Directory \r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· UserAccessAnalytics (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Roles and Administrators\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Grant a User Access to Azure Resources Using the Azure Portal](https://docs.microsoft.com/en-us/azure/role-based-access-control/quickstart-assign-role-user-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.ii\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.2\r\n\tâ€¢ CIS Controls v7.1 1.4, 1.6, 5.1, 8.5, 14.6, 15.10, 16.8, 16.9, 16.11\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-3, PR.AC-4, PR.AC-6, PR.PT-3, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-2, AC-3, AC-17\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "UserAccessAnalytics\r\n| summarize count() by AccessLevel\r\n| sort by count_ desc\r\n| render barchart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory: User Roles by Action Count",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "AC.1.002",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.005",
        "items": [
          {
            "type": 1,
            "content": {
              "json": " ###Â Requirement\r\nðŸ”· Provide privacy and security notices consistent with applicable CUI rules (ML-2) \r\n###Â CMMCÂ Guidance\r\nEvery system has legal information about user privacy and security. A system-use notification banner displays the legal requirements of using the systems. Users are required to click to agree to the displayed requirements of using the system each time they logon to the machine. You can use this implicit agreement in the civil and/or criminal prosecution of an attacker that violates the terms.\r\nDiscuss legal notification requirements with your organizationâ€™s legal counsel. This will ensure that they meet all applicable requirements. You should inform the user that:\r\n\r\n\tâ€¢ You may monitor, record, and subject to audit any information system usage\r\n\tâ€¢ You prohibit unauthorized use of the information system\r\n\tâ€¢ You may subject unauthorized use to criminal and civil penalties\r\n\tâ€¢ Use of the information system indicates consent to monitoring and recording\r\n\t\r\n###Â Microsoft RecommendationÂ Â \r\nConfigure Privacy and Security Notices with Azure Active Directory âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Properties\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Add Your Organization's Privacy Info Using Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-properties-area)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.9\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-8\r\n\t\r\n\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Privacy and Security Notices with Azure Active Directory\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/media/active-directory-properties-area/properties-area.pngÂ Â \"Configure Privacy and Security Notices with Azure Active Directory\")Â "
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.005",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.006",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Limit use of portable storage devices on external systems (ML-2) \r\n###Â CMMCÂ Guidance\r\nA portable storage device is a system component that you can insert and remove from a system. You use it to store data or information. Examples of portable storage devices include:\r\n\r\n\tâ€¢ Floppy disks\r\n\tâ€¢ Compact/digital video disks (CDs/DVDs)\r\n\tâ€¢ Flash/thumb drives\r\n\tâ€¢ External hard disk drives\r\n\tâ€¢ Flash memory cards/drives that contain nonvolatile memory\r\n\r\nYou can put this practice in place two ways:\r\n\r\n\tâ€¢ Set up a policy that describes the usage restrictions of these devices\r\n\tâ€¢ Establish technical means, such as configuring devices to work only when connected to a system to which they can authenticate\r\n\t\r\n###Â Microsoft RecommendationÂ Â \r\nControl Portable Storage Devices with Microsoft Intune  âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n### Required Log (Log Source)\r\nðŸ”· Event (Windows 10) âœ³ï¸ [Get Started with Windows 10](https://www.microsoft.com/en-us/windows/comprehensive-security)\r\n###Â NavigateÂ \r\nAzure > Intune > Device Configuration > Profiles > Create Profile > Configure > General > Removable Storage \r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Control USB Devices and Other Removable Media Using Microsoft Intune](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/control-usb-devices-using-intune)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.21\r\n\tâ€¢ CIS Controls v7.1 13.7, 13.8, 13.9\r\n\tâ€¢ NIST CSF v1.1 ID.AM-4, PR.PT-2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-20(2)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control USB Devices and Removeable Media with Microsoft Intune\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/images/general-settings.pngÂ Â \"How to control USB devices and other removable media using Microsoft Defender for Endpoint\")Â "
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Event\r\n| where EventID in (2003, 2004, 2006, 2010, 2100, 2101, 2105, 2106)\r\n| order by TimeGenerated desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Windows Event Logs for Removeable Media Events",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.006",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.007",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ the Principle of Least Privilege (ML-2) \r\n###Â CMMCÂ Guidance\r\nYou should apply the principle of least privilege to all users and processes on all systems. This means you assign the fewest permissions necessary for the user or process to accomplish their business function. Also, you:\r\n\r\n\tâ€¢ Restrict user access to only the machines and information needed to fulfill job  responsibilities.\r\n\tâ€¢ Limit what system configuration settings users can change, only allowing individuals with a business need to change them.\r\n###Â Microsoft RecommendationÂ Â \r\nConfigure Role Based Access Control (RBAC) with Azure Active Directory \r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AuditLogs (AAD: PIM) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Identity Governance > Privileged Identity Management > Azure AD roles\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [What is Azure AD Privileged Identity Management?](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.5\r\n\tâ€¢ CIS Controls v7.1 14.6\r\n\tâ€¢ NIST CSF v1.1 PR.AC-4\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-6, AC-6(1), AC-6(5)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| where Category == \"RoleManagement\"\r\n| where Identity == \"MS-PIM\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by OperationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory: Privileged Identity Management (PIM) Actions by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.007",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.008",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Use Non-Priviledged Accounts/Roles When Accessing Non-Security Functions (ML-2) \r\n###Â CMMCÂ Guidance\r\nA user with a privileged account can perform more tasks and access more information than a person with a non-privileged account. This means that tasks performed when using the privileged account can have a greater impact on the system. You restrict administrator use of privileged accounts. Only those who perform a function that requires more access can have a privileged account. This reduces the risk of unintentional harm to systems and data.\r\n###Â Microsoft RecommendationÂ Â \r\nControl Administrative Rights with Azure Active Directory: Privileged Identity Management (PIM)\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AuditLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\nAzure Active Directory > Roles and Administrators\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Deploy Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-deployment-plan)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.6\r\n\tâ€¢ CIS Controls v7.1 4.3, 4.6\r\n\tâ€¢ NIST CSF v1.1 PR.AC-4\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-6(2)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| summarize Runs = count(), Success = countif(Result == 'success'), Fails = countif(Result != 'success') by OperationName\r\n// Summarize the total, successful and failed operations by name\r\n| extend SuccessRate = (Success * 100 / Runs)\r\n// Calculate the percentage of succesful operations against the total\r\n| join\r\n(\r\nAuditLogs\r\n| where Result == 'success'\r\n| make-series TrendList = count() on TimeGenerated in range(ago(7d), now(), 3h) by OperationName ) on OperationName\r\n| project OperationName, Runs, SuccessRate\r\n| top 10 by Runs desc\r\n// Show the top 10 of most run operations",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory: Top Administrative Actions by Count",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "OperationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Runs",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.008",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.009",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Limit Unsuccessful Logon Attempts (ML-2) \r\n###Â CMMCÂ Guidance\r\nConsecutive, unsuccessful logon attempts may indicate malicious activity. You can mitigate these types of attacks by limiting the number of unsuccessful logon attempts. There are many ways to do this. Having three consecutive, unsuccessful logon attempts is a common setting. Organizations should set this number at a level that fits their risk profile. Fewer unsuccessful attempts provide higher security. After the system locks an account, it has several options to unlock it. The most common is to keep the account locked for a predefined time. After that time, the account unlocks. Another option is to keep  the account locked until an administrator unlocks it. \r\n###Â Microsoft RecommendationÂ Â \r\nConfigure Lockout Thresholds with Azure Active Directory\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SigninLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Authentication Methods > Password Protection\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Protect User Accounts from Attacks with Azure Active Directory Smart Lockout](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-smart-lockout)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.8\r\n\tâ€¢ NIST CSF v1.1 PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-7\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "letÂ dataÂ =Â SigninLogs\r\n|whereÂ AppDisplayNameÂ inÂ ('*')Â orÂ '*'Â inÂ ('*')\r\n|whereÂ UserDisplayNameÂ inÂ ('*')Â orÂ '*'Â inÂ ('*')\r\n|extendÂ errorCodeÂ =Â Status.errorCode\r\n|extendÂ SigninStatusÂ =Â case(errorCodeÂ ==Â 0,Â \"Success\",Â errorCodeÂ ==Â 50058,Â \"PendingÂ userÂ action\",errorCodeÂ ==Â 50140,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 51006,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50059,Â \"PendingÂ userÂ action\",errorCodeÂ ==Â 65001,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 52004,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50055,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50144,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50072,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50074,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 16000,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 16001,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 16003,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50127,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50125,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50129,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 50143,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 81010,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 81014,Â \"PendingÂ userÂ action\",Â errorCodeÂ ==Â 81012Â ,\"PendingÂ userÂ action\",Â \"Failure\");\r\ndata\r\n|Â summarizeÂ CountÂ =Â count()Â byÂ SigninStatus\r\n|Â joinÂ kindÂ =Â fullouterÂ (datatable(SigninStatus:string)['Success',Â 'PendingÂ actionÂ (Interrupts)',Â 'Failure'])Â onÂ SigninStatus\r\n|Â projectÂ SigninStatusÂ =Â iff(SigninStatusÂ ==Â '',Â SigninStatus1,Â SigninStatus),Â CountÂ =Â iff(SigninStatusÂ ==Â '',Â 0,Â Count)\r\n|Â joinÂ kindÂ =Â innerÂ (data\r\n|Â make-seriesÂ TrendÂ =Â count()Â defaultÂ =Â 0Â onÂ TimeGeneratedÂ fromÂ ago(14d)Â toÂ now()Â stepÂ 6hÂ byÂ SigninStatus)\r\nÂ Â Â Â onÂ SigninStatus\r\n|Â project-awayÂ SigninStatus1,Â TimeGenerated\r\n|Â extendÂ StatusÂ =Â SigninStatus\r\n|Â unionÂ (\r\nÂ Â Â Â dataÂ \r\n|Â summarizeÂ CountÂ =Â count()Â \r\n|Â extendÂ jkeyÂ =Â 1\r\n|Â joinÂ kind=innerÂ (data\r\n|Â make-seriesÂ TrendÂ =Â count()Â defaultÂ =Â 0Â onÂ TimeGeneratedÂ fromÂ ago(14d)Â toÂ now()Â stepÂ 6h\r\n|Â extendÂ jkeyÂ =Â 1)Â onÂ jkey\r\n|Â extendÂ SigninStatusÂ =Â 'AllÂ Sign-ins',Â StatusÂ =Â '*'Â Â Â Â \r\n)\r\n|Â orderÂ byÂ CountÂ desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Login Status Codes by Count",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "SigninStatus",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "Trend",
                  "formatter": 9,
                  "formatOptions": {
                    "palette": "green"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.009",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.010",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Use Session Lock With Pattern Hiding Displays (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou can set session locks on your system. A user can enable the lock. Also, the system can enable it automatically after a preset time, for example from one to five minutes. Sessions locks are a quick way to prevent unauthorized use of the systems without having a user log off. A locked session shows pattern-hiding information on the machine screen. This masks the data on the display.\r\n###Â Microsoft RecommendationÂ Â \r\nConfigure Session Lock with Azure Active Directory Conditional Access Policies âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Conditional Access - Policies > New > Session\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [User Sign-In Frequency](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-session-lifetime?WT.mc_id=Portal-fx#user-sign-in-frequency)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.10\r\n\tâ€¢ CIS Controls v7.1 16.11\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-11, AC-11(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Inactivty Logoff with Azure Active Directory\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/media/howto-conditional-access-session-lifetime/conditional-access-policy-session-sign-in-frequency.pngÂ Â \"Configure Inactivity Logoff\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.010",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.011",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Authorize wireless access prior to allowing such connections (ML-2) \r\n###Â CMMCÂ Guidance\r\nYou should base the use of wireless technologies on approved guidelines from management. These guidelines may include the following:\r\n\t\r\n\tâ€¢ Types of devices, such as corporate or privately owned equipment\r\n\tâ€¢ Configuration requirements of the devices\r\n\tâ€¢ Authorization requirements before granting such connections\r\n\t\r\n###Â Microsoft RecommendationÂ Â \r\nManage Wireless Access with Microsoft Intune  âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n###Â NavigateÂ \r\nMicrosoft Endpoint Manager Admin Center > Devices > Configuration Profiles > Create Profile > Select Platform> Profile: Wi-Fi\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Add and Use Wi-Fi Settings on Your Devices in Microsoft Intune](https://docs.microsoft.com/en-us/mem/intune/configuration/wi-fi-settings-configure)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.16\r\n\tâ€¢ CIS Controls v7.1 15.1, 15.10\r\n\tâ€¢ NIST CSF v1.1 PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-18\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Manage Wireless Access with Microsoft Intune\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/mem/intune/configuration/media/troubleshoot-wi-fi-profiles/windows-wifi-connection-known-networks.pngÂ Â \"Wifi Settings\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.011",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.012",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Protect Wireless Access Using Authentication and Encryption (ML-3) \r\n###Â CMMCÂ Guidance\r\nUse a combination of authentication and encryption methods to protect the access to wireless networks. Authenticating users to a Wireless Access Point can be done in numerous ways. One approach uses shared key authentication based on a Pre-Shared Key. Another possibility uses Network Extensible Authentication Protocol (EAP) based on an authentication server (such as a Remote Authentication Dial-In User Service (RADIUS) server) and a mechanism to enforce port-based network access control. Open authentication should not be used because it authenticates any user, and at best, logs the MAC address, which is easily spoofed.\r\n###Â Microsoft RecommendationÂ Â \r\nManage Wireless Authentication & Encryption with Microsoft Intune âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n###Â NavigateÂ \r\nMicrosoft Endpoint Manager Admin Center > Devices > Configuration Profiles > Create Profile > Select Platform> Profile: Wi-Fi\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Use a Custom Device Profile to Create a WiFi Profile with a Pre-Shared Key in Intune](https://docs.microsoft.com/en-us/mem/intune/configuration/wi-fi-profile-shared-key)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.17\r\n\tâ€¢ CIS Controls v7.1 15.7, 15.8\r\n\tâ€¢ NIST CSF v1.1 PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-18(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Manage Wireless Authentication & Encryption with Microsoft Intune\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/mem/intune/configuration/media/troubleshoot-wi-fi-profiles/android-end-user-company-portal-scep-certificate.pngÂ Â \"Wifi Settings\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.012",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.013",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· MonitorÂ andÂ ControlÂ RemoteÂ AccessÂ SessionsÂ (ML-2)Â \r\n###Â CMMCÂ Guidance\r\nRemoteÂ accessÂ connectionsÂ passÂ throughÂ untrustedÂ networksÂ andÂ shouldÂ thereforeÂ notÂ beÂ trustedÂ withoutÂ properÂ securityÂ controlsÂ inÂ place.Â AllÂ remoteÂ accessÂ shouldÂ implementÂ approvedÂ encryption.Â ThisÂ ensuresÂ theÂ confidentialityÂ ofÂ theÂ data.Â CheckÂ connectionsÂ toÂ ensureÂ thatÂ onlyÂ authorizedÂ usersÂ andÂ devicesÂ areÂ connecting.Â MonitoringÂ mayÂ includeÂ trackingÂ whoÂ isÂ accessingÂ theÂ networkÂ remotelyÂ andÂ whatÂ filesÂ theyÂ areÂ accessingÂ duringÂ theÂ remoteÂ session.Â \r\n###Â Microsoft RecommendationÂ Â \r\n\t1. LeverageÂ AzureÂ ActiveÂ DirectoryÂ ConditionalÂ AccessÂ PoliciesÂ forÂ AuthenticationÂ byÂ IPÂ Location.Â Â \r\n\t2. LeverageÂ MicrosoftÂ CloudÂ AppÂ SecurityÂ forÂ controllingÂ sessionsÂ toÂ allÂ cloudÂ applications.Â \r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SigninLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\n\t1. AzureÂ ActiveÂ DirectoryÂ >Â ConditionalÂ AccessÂ -Â Policies\r\n\t2. M365Â AdminÂ CenterÂ >Â SecurityÂ >Â MoreÂ ResourcesÂ >Â MicrosoftÂ CloudÂ AccessÂ SecurityÂ >Â ControlÂ >Â TemplatesÂ >Â CreateÂ Policy\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [What is Conditional Access?](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)\r\nðŸ’¡Â [Microsoft Cloud App Security Overview](https://docs.microsoft.com/en-us/cloud-app-security/what-is-cloud-app-security)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.12\r\n\tâ€¢ CIS Controls v7.1 12.11, 12.12\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-17(1)\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SigninLogs",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Remote Access by Sign In Location",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "map",
              "mapSettings": {
                "locInfo": "CountryRegion",
                "locInfoColumn": "Location",
                "sizeSettings": "Location",
                "sizeAggregation": "Count",
                "labelSettings": "Location",
                "legendMetric": "Location",
                "legendAggregation": "Count",
                "itemColorSettings": {
                  "nodeColorField": "Location",
                  "colorAggregation": "Count",
                  "type": "heatmap",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.013",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.014",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ Cryptographic Mechanisms to Protect the Confidentiality of Remote Access Sessions (ML-3) \r\n###Â CMMCÂ Guidance\r\nA remote access session involves logging in to the organizationâ€™s network from a remote location such as home or an alternate work site. This remote access session must be secured using FIPS-validated cryptography to provide confidentiality and prevent anyone from capturing session information exchanges.\r\n###Â Microsoft RecommendationÂ Â \r\n\tâ€¢ Review/Implement Azure Defender for Servers Recommendations for Encryption of Data in Transit\r\n\tâ€¢ Deploy Hardware Security Modules for FIPS-140 Encryption Requirements\r\n### Required Log (Log Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Recommendations > Encrypt Data in Transit\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Remediate Recommendations in Azure Defender for Servers](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)\r\nðŸ’¡Â [Tutorial: Deploying HSMs into an Existing Virtual Network Using the Azure CLI](https://docs.microsoft.com/en-us/azure/dedicated-hsm/tutorial-deploy-hsm-cli)\r\nðŸ’¡Â [FIPS 140-2 Validation](https://docs.microsoft.com/en-us/windows/security/threat-protection/fips-140-validation)\r\nðŸ’¡Â [What is Azure Dedicated HSM?](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.13\r\n\tâ€¢ CIS Controls v7.1 15.7, 15.8\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-17(2)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Web Application should only be accessible over HTTPS\" \r\nor RecommendationName == \"Function App should only be accessible over HTTPS\" \r\nor RecommendationName == \"Secure transfer to storage accounts should be enabled\" \r\nor RecommendationName == \"IoT Devices - TLS cipher suite upgrade needed\"\r\nor RecommendationName == \"TLS should be updated to the latest version for your web app\"\r\nor RecommendationName == \"TLS should be updated to the latest version for your function app\"\r\nor RecommendationName == \"FTPS should be required in your function App\"\r\nor RecommendationName == \"FTPS should be required in your web App\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by RecommendationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender Recommendations for Encryption of Data in Transit (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 215",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.014",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.015",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Route Remote Access Via Managed Access Control Points (ML-2) \r\n###Â CMMCÂ Guidance\r\nYou can limit the number of remote access control points. This reduces the attack surface for organizations. Route all remote access sessions through as few points as possible:\r\n\r\n\tâ€¢ Allows for better visibility into the traffic coming into the network\r\n\tâ€¢ Simplifies network management\r\n\tâ€¢ Increases the ability to monitor and control the connections\r\n###Â Microsoft RecommendationÂ \r\nControl Remote Access via VPN Gateway âœ³ï¸ [Get Started with VPN Gateway](https://azure.microsoft.com/en-us/services/vpn-gateway/)\r\n###Â NavigateÂ \r\nAzure Virtual Network Gateways > Add\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Remote Work Using Azure VPN Gateway Point-to-Site](https://docs.microsoft.com/en-us/azure/vpn-gateway/work-remotely-support)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.14\r\n\tâ€¢ CIS Controls v7.1 15.5, 15.10\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-17(3)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control Remote Access with VPN Gateway\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/vpn-gateway/media/working-remotely-support/scenario2.pngÂ Â \"Azure VPN for Remote Access\")Â \r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.015",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.017",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Separate the Duties of Individuals to Reduce the Risk of Malevolent Activity without Collusion (ML-3) \r\n###Â CMMCÂ Guidance\r\nA company must avoid situations in which conflicts of interest or even lack of knowledge can create security problems. This can be accomplished by splitting important duties and tasks between employees in order to reduce intentional or unintentional execution of malicious activities, when those involved are not colluding. This allows the organization to minimize employeesâ€™ fraud, abuse and errors. Summarizing, no one person should be in charge of an entire critical task from beginning to end.\r\n###Â Microsoft RecommendationÂ \r\n\r\n\tâ€¢ Separate organizational duties with Azure Active Directory: Roles and Administrators\r\n\tâ€¢ Require Split-Delegation of Elevated Rights with Azure Active Directory: Privileged Identity Management\r\n\t\r\n### Required Log (Log Source)\r\nðŸ”· AuditLogs (AAD: PIM) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Azure Active Directory > Manage > Role & Administrators\r\n\tâ€¢ Azure Active Directory > Identity Governance > Privileged Identity Management\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Delegate Administration in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/roles/concept-delegation)Â \r\nðŸ’¡Â [Start Using Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-getting-started#)Â \r\n\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.4\r\n\tâ€¢ NIST CSF v1.1 PR.AC-4\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-5\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by OperationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Control Elevated Rights with Azure Active Directory: Priviledged Identity Management. PIM Operations (Last 90 Days) ",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 215",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.017",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.018",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Prevent Non-Privileged Users from Executing Privileged Functions and Capture the Execution of Such Functions in Audit Logs (ML-3) \r\n###Â CMMCÂ Guidance\r\nNon-privileged users should not be given permissions other than those required to do their basic job functions. Privileged users are granted additional permissions. They are employees given authorization to perform certain privileged functions involving the control, monitoring, or administration of the system including security functions. When these special privileged functions are performed, the activity should be captured in an audit log which can be used to identify abuse. Non-privileged employees should not be granted permission to perform any of the functions of a privileged user.\r\n###Â Microsoft RecommendationÂ \r\n\r\n\tâ€¢ Manage Privileged Access with Azure Active Directory: Role-Based Access Control (RBAC)\r\n\tâ€¢ Delegate Privileged Access with Azure Active Directory: Privileged Identity Management\r\n\tâ€¢ Review User Activity in Azure Activity Logs\r\n\t\r\n### Required Log (Log Source)\r\nðŸ”· AzureActivity (Azure Monitor) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n\t\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Azure Active Directory > Manage > Role & Administrators\r\n\tâ€¢ Azure Active Directory > Identity Governance > Privileged Identity Management\r\n\tâ€¢ Monitor > Activity Log\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What is Azure Role-Based Access Control (Azure RBAC)?](https://docs.microsoft.com/en-us/azure/role-based-access-control/overview)Â \r\nðŸ’¡Â [Start using Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-getting-started#)Â \r\nðŸ’¡Â [View Activity Logs to Monitor Actions on Resources](https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/view-activity-logs)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.7\r\n\tâ€¢ NIST CSF v1.1 PR.AC-4\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-6(9), AC-6(10)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where \"All\" == \"All\" or Caller in ('All')\r\n| where \"All\" == \"All\" or ResourceGroup in ('All')\r\n| summarize deletions = countif(OperationName contains \"Delete\"), creations = countif(OperationName contains \"Create\"), updates = countif(OperationName contains \"Update\"), Activities = count() by Caller\r\n| sort by creations desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Review User Activity in Azure Activity Logs (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Caller",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "deletions",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "creations",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "updates",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 215",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.018",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.019",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Terminate (Automatically) User Sessions After a Defined Condition (ML-3) \r\n###Â CMMCÂ Guidance\r\nThis practice may require security policy development if it does not exist. Configure the system to end user sessions based on the organizationâ€™s policy. Policy guidance for session termination usually includes circumstances, events, or specific triggers that require automatically terminating the session or logging off the user. If there is no automatic control of user sessions, an attacker can take advantage of an unattended session.\r\n###Â Microsoft RecommendationÂ \r\n\r\n\tâ€¢ Review Risky Users in Azure Active Directory and Configure Remediation Actions\r\n\tâ€¢ Leverage Azure Active Directory: Conditional Access for Additional Remediation Actions for Risky Users\r\n\t\r\n### Required Log (Log Source)\r\nðŸ”· BehaviorAnalytics (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Azure Active Directory > Users Flagged for Risk\r\n\tâ€¢ Azure Active Directory > Security > Conditional Access\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Remediate Users Flagged for Risk in the Azure Active Directory Portal](https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-remediate-users-flagged-for-risk)Â \r\nðŸ’¡Â [What is Conditional Access?](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.11\r\n\tâ€¢ CIS Controls v7.1 16.7, 16.11\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where TimeGenerated > ago(28d)\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where TimeGenerated > ago(28d) | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where TimeGenerated > ago(28d)\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where TimeGenerated > ago(28d)\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where TimeGenerated > ago(28d)\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where TimeGenerated > ago(28d)\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where TimeGenerated > ago(28d)\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        | where TimeGenerated > ago(28d)\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where TimeGenerated > ago(28d)\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where TimeGenerated > ago(28d)\r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where TimeGenerated > ago(28d)\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where TimeGenerated > ago(28d)\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where TimeGenerated > ago(28d) \r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | where TimeGenerated > ago(28d) \r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert | where TimeGenerated > ago(28d) \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount;\r\nTopUsersByIncidents\r\n| sort by IncidentCount, AlertCount, AnomalyCount desc\r\n| take 250\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Risky User Activity (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "UserName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "AlertCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "AnomalyCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "Caller",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "deletions",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "creations",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "updates",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 215",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.019",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.020",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Control Connection of Mobile Devices (ML-3) \r\n###Â CMMCÂ Guidance\r\nOrganizations should establish guidelines and acceptable practices for the proper configuration and use of mobile devices. First the device must be identified. The availability of a unique identifier is going to depend on the device vendor, and the openness of the vendorâ€™s API, whether or not the device is under EMM/MDM control and, if so, the approach used by the developer of the EMM/MDM. There are many different types of identifiers (e.g., UDID, UUID, Android ID, IMEI, MAC Address, serial number, MDM generated ID) that can be used to identify the device, and an organization must choose an approach that applies under their specific circumstances. Once the device is identified and authenticated, it is checked to ensure it complies with appropriate configuration settings and software versions for the operating system and applications. At the same time the device is checked to ensure anti-virus software is running with current definitions. Finally, hardware configurations are checked to ensure any disallowed features are turned off.\r\n###Â Microsoft Recommendation\r\nControl Connection of Mobile Devices with Microsoft Intune: Conditional Access. âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n###Â NavigateÂ \r\nMicrosoft Endpoint Manager Admin Center > Devices > Conditional Access > New Policy\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What are Common Ways to Use Conditional Access with Intune?](https://docs.microsoft.com/en-us/mem/intune/protect/conditional-access-intune-common-ways-use)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.18\r\n\tâ€¢ CIS Controls v7.1 13.6, 16.7\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3, PR.AC-6\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-19\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â Control Connection of Mobile Devices with Microsoft Intune: Conditional Access\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/mem/intune/protect/media/conditional-access/ca-diagram-1.pngÂ Â \"Intune Conditional Access\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.020",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.021",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Authorize Remote Execution of Privileged Commands and Remote Access to Security-Relevant Information (ML-3) \r\n###Â CMMCÂ Guidance\r\nPrivileged users need to execute commands with elevated privileges. But not all privileged users are allowed to perform these functions from a remote location, and not all privileged commands can be executed remotely. You must document which user roles have permissions to remotely execute privileged commands to make changes and to access security relevant information. In addition, you must document which administrative functions can be executed remotely. This documentation must be used to establish security mechanisms that enforce the policy.\r\n###Â Microsoft RecommendationÂ \r\n\r\n\tâ€¢ Control Privileged Command Execution Rights with Azure Active Directory: Role Based Access Control (RBAC)\r\n\tâ€¢ Control & Monitor Administrative Rights with Azure Active Directory: Privileged Identity Management (PIM)\r\n\tâ€¢ Control Access Sessions by Location with Azure Active Directory: Conditional Access\r\n\tâ€¢ Monitor Execution of Privileged Commands with Azure Monitor\r\n\t\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Azure Active Directory > Manage > Role & Administrators\r\n\tâ€¢ Azure Active Directory > Identity Governance > Privileged Identity Management\r\n\tâ€¢ Azure Active Directory > Security > Conditional Access\r\n\tâ€¢ Monitor > Activity log\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What is Azure Role-Based Access Control (Azure RBAC)?](https://docs.microsoft.com/en-us/azure/role-based-access-control/overview)Â \r\nðŸ’¡Â [Start Using Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-getting-started#)Â \r\nðŸ’¡Â [What is Conditional Access?](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)Â \r\nðŸ’¡Â [View Activity Logs to Monitor Actions on Resources](https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/view-activity-logs)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.15\r\n\tâ€¢ CIS Controls v7.1 8.8, 12.11, 12.12\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-17(4)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â Control & Authorize Remote Execution of Privileged Commands with Azure Active Directory Conditional Access & Privileged Identity Management\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/security/fundamentals/media/management/typical-management-network-topology.pngÂ Â \"Security Management in Azure\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.021",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.022",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Encrypt CUI on Mobile Devices and Mobile Computing Platforms (ML-3) \r\n###Â CMMCÂ Guidance\r\nEnsure CUI is encrypted using approved and validated algorithms for full disk encryption (FDE) or container-based encryption on all mobile devices and platforms to include smartphones, tablets, E-readers, and notebook computers. Mobile phones will typically encrypt a virtual container on the device; CUI should be held within the secure encrypted container. A laptop will typically use FDE. One big advantage of using encrypted containers on smartphones is applications and temporary files are not encrypted, preserving battery life that would otherwise be shortened by unnecessary cryptographic operations.\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Restrict CUI to Mobile Application Management Apps\r\n\tâ€¢ Apply Encryption App Protection Policy Profiles to Mobile Devices with Microsoft Intune \r\n###Â NavigateÂ \r\nMicrosoft Endpoint Manager Admin Center > Apps > App Protection Policies > Create Policy (iOS/Android)\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [How to Create and Assign App Protection Policies](https://docs.microsoft.com/en-us/mem/intune/apps/app-protection-policies)Â \r\nðŸ’¡Â [App Protection Policies Overview](https://docs.microsoft.com/en-us/mem/intune/apps/app-protection-policy)Â \r\nðŸ’¡Â [Microsoft Intune Protected Apps](https://docs.microsoft.com/en-us/mem/intune/apps/apps-supported-intune-apps)Â \r\nðŸ’¡Â [Data Protection Framework Using App Protection Policies](https://docs.microsoft.com/en-us/mem/intune/apps/app-protection-framework)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.19\r\n\tâ€¢ CIS Controls v7.1 13.6\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-19(5)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â Encrypt CUI on Mobile Devices and Mobile Computing Platforms with Microsoft Intune: App Protection Policy and Mobile Application Management\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/mem/intune/apps/media/app-protection-policy/app-protection-policies-with-mdm.pngÂ Â \"Data protection with APP on devices managed by an MDM solution\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.022",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.4.023",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Prevent Non-Privileged Users from Executing Privileged Functions and Capture the Execution of Such Functions in Audit Logs (ML-3) \r\n###Â CMMCÂ Guidance\r\nNon-privileged users should not be given permissions other than those required to do their basic job functions. Privileged users are granted additional permissions. They are employees given authorization to perform certain privileged functions involving the control, monitoring, or administration of the system including security functions. When these special privileged functions are performed, the activity should be captured in an audit log which can be used to identify abuse. Non-privileged employees should not be granted permission to perform any of the functions of a privileged user.\r\n###Â Microsoft RecommendationÂ \r\n\r\n\tâ€¢ Classify Controlled Unclassified Information (CUI)\r\n\tâ€¢ Control Access to Platforms with CUI via Azure Active Directory: Role-Based Access Control (RBAC)\r\n\tâ€¢ Apply Security Labeling to CUI documents/data with Azure Infromation Protection\r\n\tâ€¢ Control CUI Data Flows with Azure Information Protection: Digital Rights Management\r\n\t\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Azure Active Directory > Manage > Role & Administrators\r\n\tâ€¢ Azure Information Protection > Quick start\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What is Azure Role-Based Access Control (Azure RBAC)?](https://docs.microsoft.com/en-us/azure/role-based-access-control/overview)Â \r\nðŸ’¡Â [What is Azure Rights Management?](https://docs.microsoft.com/en-us/azure/information-protection/what-is-azure-rms)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of Draft NIST SP 800-171B 3.1.3e\r\n\tâ€¢ CIS Controls v7.1 12.1, 12.2, 13.1, 13.3, 14.1, 14.2, 14.5, 14.6, 14.7, 15.6, 15.10\r\n\tâ€¢ NIST CSF v1.1 ID.AM-3, PR.AC-5, PR.DS-5, PR.PT-4, DE.AE-1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-4, AC-4(1), AC-4(6), AC-4(8), AC-4(12), AC-4(13), AC-4(15), AC-4(20)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â ConfigureÂ AzureÂ InformationÂ ProtectionÂ PoliciesÂ forÂ ProtectionÂ ofÂ CUI\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/information-protection/media/azrms_elements.pngÂ Â \"AzureÂ InformationÂ Protection: Digital rights Management\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "AC.4.023",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.4.025",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Periodically Review and Update CUI Program Access Permissions (ML-4) \r\n###Â CMMCÂ Guidance\r\nUsers must have organizational approval to read, write and process CUI associated with a program, and the organization must maintain an authoritative list of who has been granted access to CUI. Review and update ACLs and/or appropriate access methods periodically (as determined by the organization, but at least annually) to maintain accurate permission sets when employeesâ€™ roles change.\r\n###Â Microsoft RecommendationÂ \r\nPeriodically Review and Update CUI Program Access Permissions with Azure Active Directory: Access Reviews âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Identity Governance > Access Reviews > Create an Access Review\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What are Azure AD Access Reviews?](https://docs.microsoft.com/en-us/azure/active-directory/governance/access-reviews-overview)Â \r\nðŸ’¡Â [Planning Azure Active Directory Access Reviews Deployment](https://docs.microsoft.com/en-us/azure/active-directory/governance/deploy-access-reviews)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC \r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â Periodically Review and Update CUI Program Access Permissions with Azure Active Directory: Access Reviews\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/governance/media/deploy-access-review/1-planning-review.pngÂ Â \"Access Reviews\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "AC.4.025",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.3.019",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Restrict Remote Network Access Based on Organizationally Defined Risk Factors Such as Time of Day, Location of Access, Physical Location, Network Connection State, and Measured Properties of the Current User and Role (ML-4) \r\n###Â CMMCÂ Guidance\r\nThis practice adds context about the user and the specific access attempt before network access is granted. First, the organization must identify attributes that are important for managing the risk of remote network access. Then, the administrator restricts remote access based on the state of these attributes. The remote access control mechanism must be enhanced to check the attributes such as the subjectâ€™s location, the state of the network (e.g., running services, resources available, traffic statistics, network hosts in the local network and traffic patterns between nodes), host posture, time-of-day, expected behavior associated with the userâ€™s role, and normal behavior for the user based on previous use. All the attributes checked must be within tolerance for the user requesting remote access. The organization is not limited to these attributes or required to use these attributes.\r\n\r\nOne possible approach could include:\r\n\r\n\tâ€¢ A policy database or the organization determined access policy;\r\n\tâ€¢ An attribute database for subjects, the environment and resources; and\r\n\tâ€¢ A policy enforcement engine leveraging a policy language like XACML to check the policy and attributes before access is granted.\r\n\r\n###Â Microsoft RecommendationÂ \r\nRestrict Remote Network Access Based on Risk Factors (Time, Device, Location, State, Role) with Azure Active Directory: Conditional Access\r\n### Required Log (Log Source)\r\nðŸ”· SigninLogs (Conditional Access) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Conditional Access\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What is Conditional Access?](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)Â \r\nðŸ’¡Â [Configuring Azure Active Directory Conditional Access](https://docs.microsoft.com/en-us/appcenter/general/configuring-aad-conditional-access)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.11\r\n\tâ€¢ CIS Controls v7.1 16.7, 16.11\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = SigninLogs\r\n    | where AppDisplayName in ('*') or '*' in ('*')\r\n    | where UserDisplayName in ('*') or '*' in ('*')\r\n    | extend CAStatus = case(ConditionalAccessStatus == \"success\", \"Successful\",\r\n        ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n        ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n        isempty(ConditionalAccessStatus), \"Not applied\", \r\n        \"Disabled\")\r\n    | mvexpand ConditionalAccessPolicies\r\n    | extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n    | extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n        CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n        CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n        CAGrantControlName contains \"Device\", \"Require Device Compliant\", \r\n        CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined Device\", \r\n        CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\r\n        \"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus\r\n| join kind = inner (\r\n    data\r\n    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range(ago(14d), now(), 6h) by CAStatus\r\n    )\r\n    on CAStatus\r\n| project-away CAStatus1, TimeGenerated\r\n| order by Count desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory: Conditional Access Status (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "UserName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "AlertCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "AnomalyCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "Caller",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "deletions",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "creations",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "updates",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "coldHot"
                    }
                  }
                ]
              },
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "CAStatus",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "Trend",
                  "formatter": 9,
                  "formatOptions": {
                    "palette": "blue"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "name": "query - 215",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AC.3.019 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.1.003",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Verify and Control/Limit Connections to External Information Systems (ML-1) \r\n###Â CMMCÂ Guidance\r\nMake sure to control and manage connections between your company network and outside networks, such as the public internet or a network that does not belong to your company. Be aware of applications that can be run by outside systems. Control and limit personal devices like laptops, tablets, and phones from accessing the company networks and information. You can also choose to limit how and when your network is connected to outside systems and/or decide that only certain employees can connect outside systems from network resources.\r\n###Â Microsoft RecommendationÂ \r\nManage external connections and review external access in the Azure Firewall logs\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AzureActivityÂ (Azure Firewall) âœ³ï¸ [Get Started with Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)\r\n###Â NavigateÂ \r\nAzure Firewalls > Select Firewall > Logs\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.iii\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.20\r\n\tâ€¢ CIS Controls v7.1 12.1, 12.4\r\n\tâ€¢ NIST CSF v1.1 ID.AM-4, PR.AC-3\r\n\tâ€¢ CERT RMM v1.2 EXD:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-20, AC-20(1)\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity \r\n| make-series count() default=0 on TimeGenerated from ago(7d) to now() step 1d by CallerIpAddress\r\n| where CallerIpAddress <> \"\"\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Review Azure Firewall Logs for Suspect External Connections",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "AC.1.003",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.1.004",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Control Information Posted on Publicly Accessible Information Systems (ML-1) \r\n###Â CMMCÂ Guidance\r\nDo not allow sensitive information, including Federal Contract Information (FCI), which may include CUI, to become public. It is important to know which users/employees are allowed to publish information on publicly accessible systems, like your company website. Limit and control information that is posted on your companyâ€™s website(s) that can be accessed by the public.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Information Protection to Label/Protect Sensitive Data\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· InformationProtectionLogs_CL (Azure Information Protection) âœ³ï¸ [Get Started with AIP](https://azure.microsoft.com/en-us/services/information-protection)\r\n###Â NavigateÂ \r\nAzure Information Protection > Classifications > Labels\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.iv\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.22\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-22\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "InformationProtectionLogs_CL\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by Activity_s, Operation_s, LabelName_s, ApplicationName_s\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Information Protection Log Activity by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "AC.1.004",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.2.016",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Control the Flow of CUI in Accordance with Approved Authorizations (ML-2)\r\n###Â CMMCÂ Guidance\r\nFlow control regulates where and how information can flow. Firewalls and proxy servers can be used to control traffic flow. Typically, organizations will have a firewall between the internal network and the internet. Often multiple firewalls are used inside a network to create zones to separate sensitive data, business units or user groups. Proxy servers can be used to break the connections between multiple networks. All traffic entering or leaving a network is intercepted by the proxy, preventing direct access between networks. This can have security and performance benefits. Additionally, organizations should ensure that all sensitive information is encrypted before being transmitted over the internet. \r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Establish micro-segmentation with Azure Firewall, Azure VPN Gateway, and Network Security Groups. Protect data transmissions with Azure Virtual Network Gateways/ExpressRoute. \r\n\tâ€¢ Manage Encryption Keys with Azure Key Vault. \r\n\tâ€¢ Leverage Azure Information Protection to Control Access to Sensitive Information via Policy.\r\n\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Networking > Network Security Group > Create\r\n\tâ€¢ Azure Virtual Network Gateway > New\r\n\tâ€¢ Azure Information Protection > Classifications > Labels\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Filter Network Traffic With a Network Security Group Using the Azure Portal](https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic)\r\nðŸ’¡Â [What is VPN Gateway?](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpngateways)\r\nðŸ’¡Â [How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.1.3\r\n\tâ€¢ CIS Controls v7.1 12.1, 12.2, 12.5, 12.8, 13.3, 14.1, 14.6, 14.7\r\n\tâ€¢ NIST CSF v1.1 ID.AM-3, PR.AC-5, PR.DS-5, PR.PT-4\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AC-4\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Azure Information Protection Policies for Protection of CUI\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/information-protection/media/defaultsettings-aip.pngÂ Â \"Azure Information Protection Policies\")Â "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AC.2.016",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AC.5.024",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Identify and Mitigate Risk Associated with Unidentified Wireless Access Points Connected to the Network (ML-5) \r\n###Â CMMCÂ Guidance\r\nThis practice can be implemented in a variety of ways. One approach would be to use a Wireless Intrusion Detection System (WIDS), a network device that monitors the radio spectrum for the presence of unauthorized access points. Other approaches are those used to detect and/or block any rogue network device. On the physical security side, unused RJ45 jacks in a facility can be turned off, however, this does not account for repurposing an authorized jack. A more robust solution is to identify authorized devices and create access controls limiting connections to those devices. Each device that is allowed to connect has a profile to include expected physical location that is maintained by the system administrators. This, in turn, facilitates the creation of a device white list which can be used with a port monitoring tool to control connections. Another approach would be the utilization of device detection software that the system administrator uses to establish a device baseline which is periodically compared to new scans using the same software to identify changes, specifically unauthorized additions when compared to the scan result of authorized connected devices.\r\n###Â Microsoft RecommendationÂ \r\nMitigate Risk Associated with Unidentified Wireless Access Points with Azure Active Directory & Intune Conditional Access for Devices âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Conditional Access > New Policy > Conditions > Device Platforms > Access Controls\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What is a Device Identity?](https://docs.microsoft.com/en-us/azure/active-directory/devices/overview)Â \r\nðŸ’¡Â [How To: Require Managed Devices for Cloud App Access with Conditional Access](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/require-managed-devices)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 15.3\r\n\tâ€¢ NIST CSF v1.1 PR.DS-5, DE.AE-1, DE.CM-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-4(14)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Access Control (AC)"
            },
            "name": "text - 1",
            "styleSettings": {
              "margin": "2",
              "padding": "2",
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â Mitigate Risk Associated with Unidentified Wireless Access Points with Azure Active Directory & Intune Conditional Access for Devices\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/media/require-managed-devices/47.pngÂ Â \"Device Conditional Access\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Access Control (AC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "AC.5.024",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Audit & Accountability (AU)\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Audit & Accountability (AU)"
      },
      "name": "Audit & Accountability (AU)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Control Family Overview\r\nAudit & Accountability involves the evaluation of configurable security and logging options to help identify gaps in security policies and mechanisms. \r\nTheÂ Audit & AccountabilityÂ ControlÂ familyÂ includesÂ 19Â controlsÂ withÂ varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information,Â see ðŸ’¡Â [CMMC with Microsoft Azure: Audit & Accountability Management](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-audit-accountability-management-2-of-10/)\r\n",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Audit & Accountability (AU) - OV",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Audit & Accountability RequirementsÂ (IncludedÂ inÂ Workbook)\r\n|Â Audit & AccountabilityÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â AU.2.041 |  Ensure that the actions of individual system users can be uniquely traced to those users so they can be held accountable for their actions.   |\r\n|Â ML-2Â |Â AU.2.042 |  Create and retain system audit logs and records to the extent needed to enable the monitoring, analysis, investigation and reporting of unlawful or unauthorized system activity.   |\r\n|Â ML-2Â |Â AU.2.043 |   Provide a system capability that compares and synchronizes internal system clocks with an authoritative source to generate time stamps for audit records.  |\r\n|Â ML-2Â |Â AU.2.044 |   Review audit logs.  |\r\n|Â ML-3Â |Â AU.3.048 |  Collect audit information (e.g., logs) into one or more central repositories.   |\r\n|Â ML-3Â |Â AU.3.045 |  Review and update logged events.   |\r\n|Â ML-3Â |Â AU.3.046 |  Alert in the event of an audit logging process failure.   |\r\n|Â ML-3Â |Â AU.3.049 |  Protect audit information and audit logging tools from unauthorized access, modification and deletion.   |\r\n|Â ML-3Â |Â AU.3.050 |   Limit management of audit logging functionality to a subset of privileged users.  |\r\n|Â ML-3Â |Â AU.3.051 |   Correlate audit record review, analysis and reporting processes for investigation and response to indications of unlawful, unauthorized, suspicious or unusual activity.  |\r\n|Â ML-3Â |Â AU.3.052 |  Provide audit record reduction and report generation to support on-demand analysis and reporting.   |\r\n|Â ML-4Â |Â AU.4.053 | Automate analysis of audit logs to identify and act on critical indicators (TTPs) and/or organizationally-defined suspicious activity. | \r\n|Â ML-4Â |Â AU.4.054 | Review audit information for broad activity in addition to per-machine activity. |\r\n|Â ML-5Â |Â AU.5.055 | Identify assets not reporting audit logs and assure appropriate organizationally defined systems are logging. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Audit & Accountability RequirementsÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Audit & Accountability in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Audit & Accountability Management\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/04/CMMC-Series2-BigTable-1.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ AUÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Audit & Accountability Management",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Audit & Accountability Management?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC Audit & Accountability Maturity Capability (AU-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing a policy that includes audit & accountability (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization.\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/04/CMMC-Series2-AdminControlsTable-1.pngÂ Â \"CustomerÂ Responsibilities\")\r\n",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Audit & Accountability Management?",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning Auditing & Accountability with Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing an Audit & Accountability Architecture in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 11 Steps to CMMC for Audit & Accountability Management with Microsoft Azure\r\nMicrosoftÂ AzureÂ hasÂ developedÂ anÂ 11-stepÂ processÂ toÂ facilitateÂ audit & accountabilityÂ maturityÂ withÂ theÂ securityÂ principlesÂ withinÂ CMMC,Â NISTÂ SPÂ 800-53Â R4Â andÂ NISTÂ SPÂ 800-171Â standards.Â NoteÂ thisÂ processÂ isÂ aÂ startingÂ point,Â asÂ CMMCÂ requiresÂ alignmentÂ ofÂ people,Â processes,Â policyÂ andÂ technologyÂ soÂ referÂ toÂ organizationalÂ requirementsÂ andÂ respectiveÂ standardsÂ forÂ implementation.Â AzureÂ hasÂ severalÂ offeringsÂ toÂ facilitateÂ audit & accountabilityÂ including ðŸ’¡[Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Azure Policy](https://docs.microsoft.com/en-us/azure/governance/policy/overview), ðŸ’¡[Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/), ðŸ’¡[Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/), and ðŸ’¡[Log Analytics](https://docs.microsoft.com/en-us/azure/azure-monitor/learn/quick-create-workspace).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/04/CMMC-Series2-11Steps-768x444.pngÂ Â \"11 Steps to CMMC for Audit & Accountability Management with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "11 Steps to CMMC for Audit & Accountability Management with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â LogÂ UserÂ Actions\r\nðŸ’¡Â [Find activity reports in the Azure portal](https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-find-activity-reports)\r\n###Â 2)Â EnableÂ ResourceÂ Logging\r\nðŸ’¡Â [Create diagnostic settings to send platform logs and metrics to different destinations](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/diagnostic-settings#create-diagnostic-settings-in-azure-portal)\r\nðŸ’¡Â [Monitoring Azure virtual machines with Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/monitor-vm-azure)\r\n###Â 3)Â SynchronizeÂ TimeÂ Stamps\r\nðŸ’¡Â [Time sync for Windows VMs in Azure](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/time-sync)\r\n###Â 4)Â CentralizeÂ Logging\r\nðŸ’¡Â [Quickstart: On-board Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-onboard)\r\n###Â 5)Â StreamÂ LogÂ Events\r\nðŸ’¡Â [Connect data sources](https://docs.microsoft.com/en-us/azure/sentinel/connect-data-sources)\r\n###Â 6)Â AlertÂ onÂ LoggingÂ Failures\r\nðŸ’¡Â [Log alerts in Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-unified-log)\r\n###Â 7)Â SetÂ LoggingÂ AdminÂ Controls\r\nðŸ’¡Â [Manage access to log data and workspaces in Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/manage-access)\r\n###Â 8)Â ProtectÂ AuditÂ Logging\r\nðŸ’¡Â [Auditing Azure Sentinel activities](https://techcommunity.microsoft.com/t5/azure-sentinel/auditing-azure-sentinel-activities/ba-p/1718328)\r\n###Â 9)Â ReviewÂ Logs\r\nðŸ’¡Â [Tutorial: Visualize and monitor your data](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-monitor-your-data)\r\n###Â 10)Â InvestigateÂ AbnormalÂ Activity\r\nðŸ’¡Â [Auditing Azure Sentinel activities](https://techcommunity.microsoft.com/t5/azure-sentinel/auditing-azure-sentinel-activities/ba-p/1718328)\r\n###Â 11)Â OptimizeÂ &Â Report\r\nðŸ’¡Â [Automatically create incidents from Microsoft security alerts](https://docs.microsoft.com/en-us/azure/sentinel/create-incidents-from-alerts)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "DocumentationÂ &Â Guides: AU",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing an Auditing & Accountability Architecture in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.2.041",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·Ensure Actions of Individual Systems Users Are Uniquely Traced (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou need to capture information in audit logs. This ensures that you can trace the actions you audit to a specific user. This may include capturing information from users, including:\r\n\r\n\tâ€¢ User IDs\r\n\tâ€¢ Source and Destination Addresses\r\n\tâ€¢ Timestamps\r\n\t\r\n###Â Microsoft RecommendationÂ \r\nAudit User Activity with Azure Active Directory\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nAzureActivity (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\nðŸ”· Azure Active Directory > Audit Logs\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Find Activity Reports in the Azure Portal](https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-find-activity-reports)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.2\r\n\tâ€¢ CIS Controls v7.1 16.8, 16.9\r\n\tâ€¢ NIST CSF v1.1 DE.CM-1, DE.CM-3, DE.CM-7\r\n\tâ€¢ CERT RMM v1.2 MON:SG1.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-2, AU-3, AU-3(1), AU-6, AU-11, AU-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n|project Caller, CallerIpAddress, Category, OperationName, TimeGenerated\r\n| summarize count() by Caller\r\n| sort by count_ desc\r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure User Activity by Action Count (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AU.2.041",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.2.042",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Create & Retain System Audit Logs (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou should ensure that the system creates and retains audit logs. The logs should contain enough information to identify and investigate unlawful or unauthorized system activity. You select the events that require auditing. Also, you determine the information to record in the audit logs about those events. \r\n###Â Microsoft RecommendationÂ \r\nConfigure Audit Logging for All Assets via Diagnostic Settings. Track Compliance via Azure Defender for Servers Recommendations (Logging Category)\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Usage (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nSelect Azure Resource > Diagnostic Settings > Add Diagnostic Setting > Add Desired Audit Settings > Select Desired Configurations > Select Destination Details/ Send to Log Analytics to Azure Sentinel Log Analytics Workspace\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Create Diagnostic Settings to Send Platform Logs and Metrics to Different Destinations](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/diagnostic-settings#create-diagnostic-settings-in-azure-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.1\r\n\tâ€¢ CIS Controls v7.1 6.2\r\n\tâ€¢ NIST CSF v1.1. DE.CM-1, DE.CM-3, DE.CM-7\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-2, AU-3, AU-3(1), AU-6, AU-11, AU-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Usage\r\n| summarizeÂ count()Â byÂ DataType\r\n| sortÂ byÂ count_Â desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Events Count by Log Source (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "Caller",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "DataType"
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AU.2.042",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.2.043",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Synchronize Internal System Clocks to an Authoritative Source (ML-2)\r\n###Â CMMCÂ Guidance\r\nSome organziations have many machines. It is good practice to setup each machine to synchronize its time with a central time server. This ensures that all machines are recording audit logs using the same time source. This is important when you review audit logs for suspicious activity. You need to review events from multiple machines. To use the same time source, you can synchronize machines to a network device or directory service. Also, you an configure machines manually to use the same time servers on the internet. \r\n###Â Microsoft RecommendationÂ \r\nAzure hosts are synchronized to internal Microsoft time servers that take their time from Microsoft-owned Stratum 1 devices, with GPS antennas. Virtual machines in Azure can either depend on their host to pass the accurate time (host time) on to the VM or the VM can directly get time from a time server, or a combination of both. You can monitor Security Baselines to evaluate health status of Windows NTP clients. \r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityBaseline (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nPowershell Command: w32tm /dumpreg /subkey:Parameters | findstr /i \"ntpserver\"\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Time Sync for Windows VMs in Azure](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/time-sync)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.7\r\n\tâ€¢ CIS Controls v7.1 6.1\r\n\tâ€¢ NIST CSF v1.1 PR.PT-1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-8, AU-8(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where Description == \"Ensure \\'Enable Windows NTP Client\\' is set to \\'Enabled\\'\" or Description == \"Ensure \\'Enable Windows NTP Client\\' is set to \\'Disabled\\'\"\r\n| project Resource, AnalyzeResult, ResourceType, ComputerEnvironment, Computer, CceId, RuleSeverity, TimeGenerated\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by AnalyzeResult\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Review Security Baseline for NTP Client Failures (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "Caller",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "DataType"
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AU.2.043",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.045",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Review & Update Logged Events (ML-3)\r\n###Â CMMCÂ Guidance\r\nOrganizations should periodically review logged events that identify possible security incidents, and the organization should update the list of events that need to be logged as necessary. Non-security events that should have logging requirements include:\r\n\r\n\tâ€¢ Logging all installed software on endpoints to identify license irregularities\r\n\tâ€¢ Logging connections to a VPN server or load balancer to manage capacity and quality of service\r\n\t\r\n\r\n###Â Microsoft RecommendationÂ \r\nOnboard Data Sources to Azure Sentinel and Monitor Events âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Data Connectors > Select Data Source. If Pre-Built Connector isn't available, leverage SYSLOG, CEF, or REST-API for data source connections.\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Connect Data Sources](https://docs.microsoft.com/en-us/azure/sentinel/connect-data-sources)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.3\r\n\tâ€¢ CIS Controls v7.1 6.7\r\n\tâ€¢ CERT RMM v1.2 IMC:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-2(3)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Update Logged Events with Azure Sentinel Data Connectors\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/sentinel/media/collect-data/collect-data-page.pngÂ Â \"Azure Sentinel Connectors\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.045",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.046",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Alert In Event of Audit Failure (ML-3)\r\n###Â CMMCÂ Guidance\r\nAudit logging keeps track of activities occurring on the network, servers, user workstations and other components of the overall system. These logs must always be available and functions. The organization's designated security personnel (e.g. system administrator and security officer) need to be aware when the audit log process fails or becomes unavailable. Automated notifications need to be sent to the organization's designated security personnel to immediately take appropriate action. If security personnel are unaware of the audit logging process failure, then they will be unaware of any suspicious activity occurring at the time. Your response to an audit logging process failure should account for the extent of the failure (e.g. a single component's audit logging versus failure of the centralized logging solution), the risks involved in this loss of audit logging, and other factors (e.g. possibility an adversary could have caused the audit logging process failure). \r\n###Â Microsoft RecommendationÂ \r\nConfigure Alerting to Monitor Log Source Health\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”·*Logs (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Logs > Query Last Record Recieved Per Desired Threshold > New Alert Rule > Create Azure Sentinel Alert\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Log Alerts in Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-unified-log)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.4\r\n\tâ€¢ CIS Controls v7.1 6.7\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-5\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource = _TableName *\r\n| where TimeGenerated > ago(7d)\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated)) by _TableName\r\n| where last_log > 0\r\n| project ['Table Name'] = _TableName, ['Last Record Received'] = last_log\r\n| order by ['Last Record Received'] desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Log Source Health ",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "Table Name",
                    "label": "Table name"
                  },
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record recieved",
                    "comment": "When did the last record arrive?"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.046",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.048",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Collect Audit Information in Central Repository (ML-3)\r\n###Â CMMCÂ Guidance\r\nAggregate and store audit logs in a centralized location or locations within the organization. Storing audit logs in a centralized location supports orchestration, automation, correlation, and analysis activities by enabling a full picture of the audit logs, and can support automated analysis capabilities including correlation of events across the enterprise. Ensure that the central repository has the appropriate infrastructure, including protection mechanisms, and the capacity level to meet the logging requirements of the organization. \r\n###Â Microsoft RecommendationÂ \r\nCentralize All Logging in an Azure Sentinel Log Analytics Workspace\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Usage (Log Analytics) ðŸ”· Resources (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Create Workspace > Connect Data Sources\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Quickstart: On-Board Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-onboard)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 6.5\r\n\tâ€¢ CERT RMM v1.2 COMP:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-6(4)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Usage\r\n|Â summarizeÂ count()Â byÂ DataType\r\n|Â sortÂ byÂ count_Â desc\r\n|Â renderÂ barchart\r\n",
              "size": 0,
              "title": "Azure Sentinel Log Analytics Workspace: Log Events Count by Type",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "Caller",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "DataType"
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.048",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.049",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Protect Audit Information From Unauthorized Access, Modification, Deletion (ML-3)\r\n###Â CMMCÂ Guidance\r\nAudit information includes all information (e.g. audit records, audit log settings, and audit reports) needed to successfully audit system activity. Audit logging tools are those programs and devices used to conduct audit and logging activities. This requirement focuses on the technical protection of audit information and limits the ability to access and execute audit logging tools to authorized individuals. Physical protection of audit information is addressed by media protection and physical and environmental protection requirements. \r\n###Â Microsoft RecommendationÂ \r\nProtect Log Analytics Data with Role-Based Access Control (RBAC) and Monitor for Unauthorized Actions on Audit Logging\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AzureActivity (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Logs > Develop LAQueryLogs Query > New Alert Rule > Create Azure Sentinel Alert\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Auditing Azure Sentinel Activities](https://techcommunity.microsoft.com/t5/azure-sentinel/auditing-azure-sentinel-activities/ba-p/1718328)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.8\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-6(7), AU-9\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where TimeGenerated > ago(365d)\r\n| where OperationNameValue contains \"SecurityInsights\"\r\n| where OperationName contains \"Delete\"\r\n| where ActivityStatusValue contains \"Succeeded\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by OperationName, Caller\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Unauthorized Activity (Deletes on Bookmarks, Rules, Threat Intel, Logs, Incidents, Settings, Watchlists)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "timechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "Table Name",
                    "label": "Table name"
                  },
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record recieved",
                    "comment": "When did the last record arrive?"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.049",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.050",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Limit Management of Audit Logging to Priviledged Users (ML-3)\r\n###Â CMMCÂ Guidance\r\nOrganizations should restrict access to audit logging functions to a limited number of privileged users that can modify audit logs and audit settings. There are three classes of users: general users, privileged users, and audit managers. General users should not be granted permissions to perform audit management. All audit managers should come from the set of privileged users, but only a small subset of privileged users must be distinctly separate from the functions performed by users who have audit-related responsibilities to reduce the potential of fraudulent activities by privileged users not being detected or reported. \r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Restrict Access to Audit Logging\r\n\tâ€¢ Monitor Abnormal Log Query Usage\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· LAQueryLogs (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\nðŸ”· SigninLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\n\tâ€¢ Azure Active Directory > Roles and Administrators\r\n\tâ€¢ Azure Sentinel > Logs > Develop LAQueryLogs Query > New Alert Rule > Create Azure Sentinel Alert\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Grant a User Access to Azure Resources Using the Azure Portal](https://docs.microsoft.com/en-us/azure/role-based-access-control/quickstart-assign-role-user-portal)\r\nðŸ’¡Â [Auditing Azure Sentinel Activities](https://techcommunity.microsoft.com/t5/azure-sentinel/auditing-azure-sentinel-activities/ba-p/1718328)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.9\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-6(7), AU-9(4)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "LAQueryLogs\r\n| where TimeGenerated > ago(30d)\r\n| summarize events_count=count() by AADEmail\r\n| extend UserPrincipalName = AADEmail, Queries = events_count\r\n| join kind= leftouter (\r\nSigninLogs)\r\non UserPrincipalName\r\n| project UserPrincipalName, Queries\r\n| summarize arg_max(Queries, *) by UserPrincipalName\r\n| sort by Queries desc\r\n| render columnchart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Query Count by User (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "Table Name",
                    "label": "Table name"
                  },
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record recieved",
                    "comment": "When did the last record arrive?"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.050",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.2.044",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Review Audit Logs (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou should ensure that your organization reviews its audit logs. Logs should be checked regularly, organizations with small environments may be able to do this manually. The process of reviewing audit logs varies by organization. The intent of this practice is to become familiar with the logs being automatically created on the systems present in your organization and identify key events in the logs that might indicate malicious activity. Larger organizations may need automation to complete this task with success. \r\n###Â Microsoft RecommendationÂ \r\nMonitor and Visualize Audit Logging Data with Azure Sentinel Workbooks\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AuditLogs (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Workbooks\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Visualize and Monitor Your Data](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-monitor-your-data)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 6.7\r\n\tâ€¢ NIST CSF v1.1 PR.PT-1\r\n\tâ€¢ CERT RMM v1.2 COMP:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-6\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| where TimeGenerated > ago(30d)\r\n| project OperationName, Category \r\n| summarize count() by OperationName\r\n| sort by count_ desc\r\n| render piechart \r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "User Actions by Count (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AU.2.044",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.051",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Correlate Audit Record Review to Indications of Unauthorized Activity (ML-3)\r\n###Â CMMCÂ Guidance\r\nOrganizations must review, analyze, and report audit records to hep detect and respond to security incidents in a timely manner for the purpose of investigation and corrective actions. Collection of audit logs into one or more central repositories (per AM.3.048) facilitates correlated review. Small organizations may be able to accomplish this manually. Larger organizations will use an automated system for analysis that does correlation of log information across the entire enterprise and supports use of centralized intel feeds. By centralizing intel feeds, subscription costs should be reduced and the effectiveness of the analysis should be increased. Some organizations may want to orchestrate the entire analysis process which includes the use of APIs for collection, correlation, and the automation of responses based on programed rulesets. \r\n###Â Microsoft RecommendationÂ \r\nReview, Analyze, Correlate & Report on Audit Log Records via Azure Sentinel Analytics\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Behavior Analytics (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SigninLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\nðŸ”· AuditLogs (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Alerts \r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Auditing Azure Sentinel Activities](https://techcommunity.microsoft.com/t5/azure-sentinel/auditing-azure-sentinel-activities/ba-p/1718328)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.5\r\n\tâ€¢ CIS Controls v7.1 6.6, 6.7\r\n\tâ€¢ NIST CSF v1.1 DE.AE-3\r\n\tâ€¢ CERT RMM v1.2 COMP: SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-6(3)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Sign-in\"\r\n| where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\nActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\nor ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n| join (\r\nSigninLogs | where TimeGenerated > ago(28d) | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n) on $left.SourceRecordId == $right._ItemId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Successful Logon\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Valid Accounts\",\r\nSubTechnique = \"\",\r\nDescription = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights, ResourceDisplayName,AppDisplayName,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3','c4e39bd9-1100-46d3-8c65-fb160da0071f','158c047a-c907-4556-b7ef-446551a6b5f7','62e90394-69f5-4237-9190-012177145e10','d29b2b05-8046-44ba-8758-1e26182fcf32','729827e3-9c14-49f7-bb1b-9608f156bbb8','966707d0-3269-4727-9be2-8c3a10f19b9d','194ae4cb-b126-40b2-bd5b-6091b380977d','fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c','7495fdc4-34c4-4d15-a289-98788ce399fd','aaf43236-0c0d-4d5f-883a-6955382ac081','3edaf663-341e-4475-9f94-5c398ef6c070','7698a772-787b-4ac8-901f-60d6b08affd2','b1be1c3e-b65d-4f19-8427-f6fa0d97feb9','9f06204d-73c1-4d4c-880a-6edb90606fd8','29232cdf-9323-42fd-ade2-1d097af3e4de','be2f45a1-457d-42af-a067-6ec1fa63bc45','7be44c8a-adaf-4e2a-84d6-ab2649e08a13','e8611ab8-c189-46e8-94e1-60213ab1f814']);\r\nlet AnomalousRoleAssignment = AuditLogs\r\n| where TimeGenerated > ago(28d)\r\n| where OperationName == \"Add member to role\"\r\n| mv-expand TargetResources\r\n| extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n| where isnotempty(RoleId) and RoleId in (critical,high)\r\n| extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n| where isnotempty(RoleName)\r\n| extend TargetId = tostring(TargetResources.id)\r\n| extend Target = tostring(TargetResources.userPrincipalName)\r\n| join kind=inner ( BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Add member to role\"\r\n| where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n) on $left._ItemId == $right.SourceRecordId\r\n| extend AnomalyName = \"Anomalous Role Assignemt\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Account Manipulation\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,RoleName,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority;let LogOns=materialize(\r\nBehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n| where ActionType == \"ResourceAccess\"\r\n| where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n| extend AnomalyName = \"Anomalous Resource Access\",\r\nTactic = \"Lateral Movement\",\r\nTechnique = \"\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n| where ActionType == \"RemoteInteractiveLogon\"\r\n| where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n| extend AnomalyName = \"Anomalous RDP Activity\",\r\nTactic = \"Lateral Movement\",\r\nTechnique = \"\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n| where ActionType == \"InteractiveLogon\"\r\n| where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n| where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n| extend AnomalyName = \"Anomalous Login To Devices\",\r\nTactic = \"Privilege Escalation\",\r\nTechnique = \"Valid Accounts\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Reset user password\"\r\n| where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n| join (\r\nAuditLogs\r\n| where TimeGenerated > ago(28d)\r\n| where OperationName == \"Reset user password\"\r\n) on $left.SourceRecordId == $right._ItemId\r\n| mv-expand TargetResources\r\n| extend Target = iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(TargetResources.userPrincipalName, \"#\")[0])),TargetResources.userPrincipalName),tostring(TargetResources.userPrincipalName)\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Password Reset\",\r\nTactic = \"Impact\",\r\nTechnique = \"Account Access Removal\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority\r\n| sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Sign-in\"\r\n| where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n| join (\r\nSigninLogs\r\n| where TimeGenerated > ago(28d)\r\n) on $left.SourceRecordId == $right._ItemId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Successful Logon\",\r\nTactic = \"Initial Access\",\r\nTechnique = \"Valid Accounts\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights, ResourceDisplayName,AppDisplayName ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActivityType == \"LogOn\"\r\n| where UsersInsights.BlastRadius == \"High\"\r\n| join (\r\nSigninLogs \r\n| where TimeGenerated > ago(28d)\r\n| where Status.errorCode == 50126\r\n) on $left.SourceRecordId == $right._ItemId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Failed Logon\",\r\nTactic = \"Credential Access\",\r\nTechnique = \"Brute Force\",\r\nSubTechnique = \"Password Guessing\",\r\nDescription = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights, ResourceDisplayName,AppDisplayName ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n| where TimeGenerated > ago(28d)\r\n| where OperationName == \"Update user\"\r\n| mv-expand AdditionalDetails\r\n| where AdditionalDetails.key == \"UserPrincipalName\"\r\n| mv-expand TargetResources\r\n| extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n| where isnotempty(RoleId) and RoleId in (critical,high)\r\n| extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n| where isnotempty(RoleName)\r\n| extend TargetId = tostring(TargetResources.id)\r\n| extend Target = iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(TargetResources.userPrincipalName, \"#\")[0])),TargetResources.userPrincipalName),tostring(TargetResources.userPrincipalName)\r\n| join kind=inner ( \r\nBehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Update user\"\r\n| where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n) on $left._ItemId == $right.SourceRecordId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName) \r\n| extend AnomalyName = \"Anomalous Account Manipulation\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Account Manipulation\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,RoleName,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Add user\"\r\n| where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n| join(\r\nAuditLogs\r\n| where TimeGenerated > ago(28d) \r\n| where OperationName == \"Add user\"\r\n) on $left.SourceRecordId == $right._ItemId\r\n| mv-expand TargetResources\r\n| extend Target = iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(TargetResources.userPrincipalName, \"#\")[0])),TargetResources.userPrincipalName),tostring(TargetResources.userPrincipalName)\r\n| extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\nUserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Account Creation\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Create Account\",\r\nSubTechnique = \"Cloud Account\",\r\nDescription = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"Â Â Â \r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority\r\n| sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n| summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n| project Name=tolower(UserName),UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n| sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n| where TimeGenerated > ago(28d) \r\n| summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n| where Status == \"New\" or Status == \"Active\"\r\n| mv-expand AlertIds\r\n| extend AlertId = tostring(AlertIds)\r\n| join kind= innerunique ( \r\nSecurityAlert | where TimeGenerated > ago(28d) \r\n) on $left.AlertId == $right.SystemAlertId\r\n| summarize hint.strategy = shuffle arg_max(TimeGenerated,*), NumberOfUpdates = count() by SystemAlertId\r\n| mv-expand todynamic(Entities)\r\n| where Entities[\"Type\"] =~ \"account\"\r\n| extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\nSid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]) , Host = tostring(Entities[\"Host\"])\r\n| extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| union TopUsersByAnomalies\r\n| extend \r\nAadPivot = iff(isempty(AadUserId),iff(isempty(Sid),Name,Sid),AadUserId),\r\nSidPivot = iff(isempty(Sid),iff(isempty(AadUserId),Name,AadUserId),Sid),\r\nUPNExists = iff(isempty(UPN), false,true),\r\nNameExists = iff(isempty(Name), false,true),\r\nSidExists = iff(isempty(Sid), false,true),\r\nAADExists = iff(isempty(AadUserId), false,true)\r\n| summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber,4),AlertCount=dcountif(AlertId,isnotempty(AlertId),4),AnomalyCount=sum(AnomalyCount),any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true),NameAnchor=anyif(Name, NameExists == true),AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true) , any(SidPivot) by AadPivot\r\n| summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount),AlertCount=sum(AlertCount),AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false),NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false),AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title,any_Severity,any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n| summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount),AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false),AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity,any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n| project [\"UserName\"]=NameAnchor,IncidentCount, AlertCount,AnomalyCount, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| sort by IncidentCount, AlertCount, AnomalyCount desc\r\n| limit 15\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Leverage User Entity Behavior Analytics to Identify Unauthorized Activity",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "IncidentCount",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "redBright",
                          "text": "{0}{1}"
                        }
                      ],
                      "aggregation": "Sum"
                    }
                  },
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.051",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.3.052",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Provide Audit Record Reduction to Support Analysis & Reporting (ML-3) \r\n###Â CMMCÂ Guidance\r\nRaw audit log data is difficult to review, analyze, and report because the volume of data. Audit record reduction is an automated process that interprets raw audit log data and extracts meaningful and relevant information without altering the original logs. An example of log reduction for files to be analyzed would be the removal of details associated with nightly backups. Report generation on reduced log information allows you to create succinct customized reports without the need to burden the reader with unimportant information. In addition, the security relevant audit information must be made available to personnel on-demand for immediate review, analysis, reporting, and event investigation support. Performing audit log reduction and providing on-demand reports may allow the analyst to take mitigating action before the adversary completes their malicious actions. \r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel Analytics to Correlate Audit Log Events and Generate Incidents in Azure Sentinel Incidents\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityIncident (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Incidents\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Automatically Create Incidents from Microsoft Security Alerts](https://docs.microsoft.com/en-us/azure/sentinel/create-incidents-from-alerts)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.3.6\r\n\tâ€¢ NIST CSF v1.1 RS.AN-3\r\n\tâ€¢ CERT RMM v1.2 COMP:SG3.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-7\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime >= ago(30d) and CreatedTime <= now()\r\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData,CreatedTime) by IncidentNumber, Title\r\n| where Severity in ('*') or 'All' == \"All\"\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| extend Owner = todynamic(Owner.assignedTo)\r\n| where Owner in ('*') or 'All' == \"All\"\r\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0]))\r\n| where Product in ('*') or 'All' == \"All\"\r\n| summarize count() by bin(CreatedTime, 1h), Title\r\n| order by count_ desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Consolidate Logging for Review via Azure Sentinel Incidents",
              "noDataMessage": "â€¢ Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢ Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢ Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AU.3.052",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.4.053",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Automate Analysis of Audit Logs to Identify and Act on Critical Indicators (TTPs) and/or Organizationally Defined Suspicious Activity (ML-4) \r\n###Â CMMCÂ Guidance\r\nSpeed of response can be critical in stopping a cyber attack and limiting exposure to the attack. The speed of response is improved when log source platforms automatically and immediately identify indicators for which immediate action is required and authorized to be taken automatically. Some logging platforms will not support automated analysis and action. In those cases, the immediate analysis occurs at the centralized log collection server (see practice AU.3.048).\r\n\r\nThe analysis would look for specific log entry text or data element values in cases where there is certainty that an action should and can occur immediately, as defined by the organization. Actions may range from notifications to blocks. The actions must be automatic but need not be comprehensive in stopping the threat.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel Playbooks for Automated Analysis of Audit Logs and Security Orchestration Automation & Response (SOAR)for Automated Response (Suspend Account, Firewall Block, Notification, etc.) to Suspicious Activity\r\n### Required Log (Log Source)\r\nðŸ”· resources (Logic Apps) âœ³ï¸ [Get Started with Logic Apps](https://azure.microsoft.com/en-us/services/logic-apps/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Conditional Access\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Tutorial: Setup Automated Threat Responses in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 6.6\r\n\tâ€¢ NIST CSF v1.1 DE.AE-3\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-4(2)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where ResourceProvider == \"Microsoft.Logic\"\r\n| summarize count() by Resource\r\n| sort by count_ desc\r\n",
              "size": 0,
              "title": "Azure Sentinel Playbooks Run (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "AU.4.053",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.4.054",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Review Audit Information for Broad Activity in Addition to Per-Machine Activity (ML-4) \r\n###Â CMMCÂ Guidance\r\nExamining audit logs for system-specific indicators provides an important â€œpoint-defenseâ€ ability for a specific system (see practice AU.4.053). Comparing log information across multiple disparate systems allows for a holistic and time-correlated approach to detect cyber attack actions that would not constitute a threat indicator or generate any action when identified on any single system. Some of these attacks may be subtle or infrequent, while others just comprise a large number of machines. This practice requires that a system perspective be used to look for these subtle and distributed (in both logical space and time) indicators and to act upon detecting them in line with other auditing practices. The definition and scope of the system perspective will vary as the size of the organization or enclave changes. For very small installations, broad activity may only mean more than one system.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel: Analysis Fusion Rules for Correlation of Broad Activity Across Multiple Assets and Systems\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityAlert (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Office 365) âœ³ï¸ [Get Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Identity) âœ³ï¸ [Get Microsoft Defender for Identity](https://www.microsoft.com/en-us/microsoft-365/security/identity-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Azure Information Protection)âœ³ï¸ [Get Started with AIP](https://azure.microsoft.com/en-us/services/information-protection)\r\nðŸ”· SecurityAlert (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\nðŸ”· SecurityAlert (Microsoft Cloud App Security) âœ³ï¸ [Get Microsoft Cloud App Security](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\n###Â NavigateÂ \r\nAzure Sentinel > Analysis > Rule Type > Fusion\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Advanced Multistage Attack Detection in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/fusion)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST CSF v1.1 PR.PT-1\r\n\tâ€¢ NIST SP 800-53 Rev 4 RA-5(6), RA-5(8), RA-5(10)\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertType contains \"Fusion\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by AlertName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel Fusion Alerts (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "AU.4.054",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AU.5.055",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Identify Assets Not Reporting Audit Logs and Assure Appropriate Organizationally Defined Systems are Logging (ML-5) \r\n###Â CMMCÂ Guidance\r\nRobust audit logging is critical in defending against cyber attacks and preventing future attacks since logs are a common starting point for incident response and a core element in post-attack cyber forensics. A cyber attacker may try to disrupt logging at the start of an attack, making the absence of audit logging an initial indicator of a potential attack. Even if the audit logging failure occurred from benign causes, restoring the logging is needed to maintain a secure posture.\r\n\r\nIdentifying assets that are reporting logs and comparing against the inventory of assets expected to provide audit logs provides the set of assets for which audit remediation is needed. It is important that the logging requirements for each asset, which may include many logs to be collected, are documented and compared to the set of received logs. Any discrepancies will start an investigation and remediation process.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Monitor to Alert on Log Source Health\r\n### Required Log (Log Source)\r\nðŸ”· *Logs (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nMonitor > Logs > New Alert Rule\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Create, View, and Manage Log Alerts using Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-log)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 6.2\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Audit & Accountability (AU)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource = _TableName *\r\n| where TimeGenerated > ago(7d)\r\n| summarize last_log = datetime_diff(\"second\", now(), max(TimeGenerated))  by _TableName\r\n| where last_log > 3600\r\n| project ['Table Name'] = _TableName, ['Last Record Received'] =  last_log \r\n| order by ['Last Record Received']  desc\r\n\r\n\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Last Data Recieved By Log Type",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource = _TableName *\r\n| where 'All Tables' == 'All Tables' or _TableName == 'All Tables'\r\n| summarize count()  by bin(_TimeReceived, 3h), Type\r\n| project Type, _TimeReceived, count_\r\n\r\n\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Event Baseline by Log Type (30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 1 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Syslog\r\n| where _TimeReceived > ago(1d)\r\n| summarize count() by bin(_TimeReceived, 1m), Type, _ResourceId\r\n| extend counttemp =count_ / 60\r\n| summarize ['Events per Second (eps)'] = avg(counttemp) by Computer = _ResourceId\r\n| order by ['Events per Second (eps)'] asc\r\n\r\n\r\n\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Average Asset Log Events Per Second (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Events per Second (eps)",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redGreen"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 4",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Audit & Accountability (AU)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "AU.5.055",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Awareness & Training (AT)\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Awareness & Training (AT)"
      },
      "name": "Awareness & Training (AT)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Control Family Overview\r\nAwareness & Training is focused on controlling human access to systems, networks, and assets. Personnel Security includes considerations for screening individuals with access to Controlled Unclassified Information (CUI) and protection of such data after personnel actions such as terminations or transfers. TheÂ Personnel SecurityÂ ControlÂ familyÂ includesÂ 10Â controls which varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information,Â see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Awareness & Training (AT) - OV",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "###Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Awareness & TrainingÂ (ManagementÂ Controls)\r\n|Â ATÂ MCÂ MLÂ |\r\n|:-------------Â |:-------------|:-----|\r\n|Â CMMCÂ |Â RequirementsÂ |Â Maturity LevelÂ |\r\n|Â AT-MC ML.2.999Â | Establish a policy that includes Awareness & Training (AT).Â Â |Â MaturityÂ LevelÂ (ML2)Â |\r\n|Â AT-MC ML.2.998Â |Â Document the CMMC practices to implement the Awareness & Training (AT) policy.Â |Â MaturityÂ LevelÂ (ML2)Â |\r\n|Â AT-MC ML.3.997Â |Â Establish, maintain and resource a plan that includes Awareness & Training (AT).Â |Â MaturityÂ LevelÂ (ML3)Â |\r\n|Â AT-MC ML.4.996Â |Â Review and measure Awareness & Training (AT) activities for effectiveness.Â |Â MaturityÂ LevelÂ (ML4)Â |\r\n|Â AT-MC ML.5.995Â |Â Standardize and optimize a documented approach for Awareness & Training (AT) across all applicable organizational units.Â |Â MaturityÂ LevelÂ (ML5)Â |",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Awareness & TrainingÂ (ManagementÂ Controls)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Awareness & TrainingÂ (IncludedÂ inÂ Workbook)\r\n|Â Awareness & Training|\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â AT.2.057Â |Â Ensure that personnel are trained to carry out their assigned information security- related duties and responsibilities.Â |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Awareness & TrainingÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AT.2.057",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Ensure Personnel are Trained for Information Security Responsibilities (ML-2)\r\n###Â CMMCÂ Guidance\r\nTraining imparts skills and knowledge. It enables staff to perform a specific resilience function. Training program identify cybersecurity skill gaps within your organization. Then, the programs train users on their specific cybersecurity roles and responsibilities. \r\nThere is an important distinction between awareness training and role-based training. Awareness training provides general security training to influence user behavior. Role-based training focuses on the knowledge, skills, and abilities needed to complete a specific job. \r\n###Â Microsoft RecommendationÂ \r\nLeverage Microsoft Learn for Role-Based Training for Information Security Professionals in Azure âœ³ï¸ [Get Started with Microsoft Learn](https://docs.microsoft.com/en-us/learn/)\r\n###Â NavigateÂ \r\nMicrosoft Learn > Customize Learning Path > Security Engineer > Browse Recommendations\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Microsoft Learn for Security Engineers](https://docs.microsoft.com/en-us/learn/roles/security-engineer)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.2.2\r\n\tâ€¢ CIS Controls v7.1 17.5, 17.6, 17.7, 17.8, 17.9\r\n\tâ€¢ NIST CSF v1.1 PR.AT-1, PR.AT-2, PR.AT-3, PR.AT-4, PR.AT-5\r\n\tâ€¢ CERT RMM v1.2 OTA:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AT-2, AT-3\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Learn for Role-Based Training for Information Security Professionals in Azure\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/learn/modules/intro-to-security-in-azure/media/1-heading.pngÂ Â \"Microsoft Learn\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "AT.2.057",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Awareness & TrainingÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 2\r\n|Â Awareness & TrainingÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â AT.2.056 | Ensure that managers, system administrators and users of organizational systems are made aware of the security risks associated with their activities and of the applicable policies, standards and procedures related to the security of those systems. | \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CMMC Awareness & TrainingÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 2",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Awareness & TrainingÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3\r\n|Â Awareness & TrainingÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-3Â |Â AT.3.058 | Provide security awareness training on recognizing and reporting potential indicators of insider threat. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "CMMC Awareness & TrainingÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Awareness & TrainingÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 4\r\n|Â Awareness & TrainingÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-4Â |Â AT.4.059 | Provide awareness training focused on recognizing and responding to threats from social engineering, advanced persistent threat actors, breaches and suspicious behaviors; update the training at least annually or when there are significant changes to the threat. | \r\n|Â ML-4Â |Â AT.4.060 | Include practical exercises in awareness training that are aligned with current threat scenarios and provide feedback to individuals involved in the training. | \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Awareness & Training (AT)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "CMMC Awareness & TrainingÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 4",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Asset & Configuration Management (AM/CM)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Asset & Configuration (AM/CM)"
      },
      "name": "Asset & Configuration Management (AM/CM)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nAsset & Configuration Management is an engineering process to establish and maintain consisentency in information technology resources. Establishing security baselines and measuring deviations provides the basis for tracking the security posture of cloud assets. \r\nTheÂ Asset & Configuration ManagementÂ ControlÂ familiesÂ includeÂ 7Â controlsÂ (Asset Management) and 16 controls (Configuration Management withÂ varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information,Â see ðŸ’¡Â [CMMC with Microsoft Azure: Asset & Configuration Management](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-asset-configuration-management-3-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Asset & Configuration Management (AM/CM) - OV",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Asset & Configuration ManagementÂ (IncludedÂ inÂ Workbook)\r\n|Â Asset ManagementÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-3Â |Â AM.3.036 | Define procedures for the handling of CUI data.   |\r\n|Â ML-4Â |Â AM.4.226 |  Employ automated capability to discover and identify systems with specific component attributes (e.g., firmware level, OS type) within your inventory.  |\r\n\r\n|Â Configuration ManagementÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â CM.2.061 |  Establish and maintain baseline configurations and inventories of organizational systems (including hardware, software, firmware and documentation) throughout the respective system development life cycles.  |\r\n|Â ML-2Â |Â CM.2.062 |  Employ the principle of least functionality by configuring organizational systems to provide only essential capabilities.  |\r\n|Â ML-2Â |Â CM.2.063 |  Control and monitor user-installed software.  |\r\n|Â ML-2Â |Â CM.2.064 |  Establish and enforce security configuration settings for information technology products employed in organizational systems.  |\r\n|Â ML-2Â |Â CM.2.065 | Track, review, approve or disapprove and log changes to organizational systems.|\r\n|Â ML-2Â |Â CM.2.066 | Analyze the security impact of changes prior to implementation. | \r\n|Â ML-3Â |Â CM.3.067 | Define, document, approve and enforce physical and logical access restrictions associated with changes to organizational systems. |\r\n|Â ML-3Â |Â CM.3.068 |  Restrict, disable or prevent the use of nonessential programs, functions, ports, protocols and services.  |\r\n|Â ML-3Â |Â CM.3.069 | Apply deny-by-exception (blacklisting) policy to prevent the use of unauthorized software or deny-all, permit-by-exception (whitelisting) policy to allow the execution of authorized software. |\r\n|Â ML-4Â |Â CM.4.073 | Employ application whitelisting and an application vetting process for systems identified by the organization. | \r\n|Â ML-5Â |Â CM.5.074  | Verify the integrity and correctness of security critical or essential software as defined by the organization (e.g., roots of trust, formal verification or cryptographic signatures). |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Asset & Configuration ManagementÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Asset & Configuration Management in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Asset & Configuration Management\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-BigTable-768x819.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ AM/CMÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Asset & Configuration Management",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Asset & Configuration Management?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC Asset Management Maturity Capability (AM-MC) and Configuration Management Maturity (CM-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include asset & configuration management (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization.\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-AssetMgmtMaturityTable.pngÂ Â \"CustomerÂ Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Asset & Configuration Management?",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for Asset & Configuration Management in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing an Asset & Configuration Management Architecture with Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 9 Steps to CMMC for Asset & Configuration Management with Microsoft Azure\r\nMicrosoft Azure has developed a 9-step process to facilitate asset & configuration management with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate asset & configuration management including ðŸ’¡[Azure Defender for Servers](https://azure.microsoft.com/en-us/services/security-center/), ðŸ’¡[Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Azure AD: Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure),ðŸ’¡[Azure Policy](https://docs.microsoft.com/en-us/azure/governance/policy/overview), ðŸ’¡[Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/), and ðŸ’¡[Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-9Steps-1-768x414.pngÂ Â \"11 Steps to CMMC for Asset & Configuration Management with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "9 Steps to CMMC for Asset & Configuration Management with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Protect Confidential Data\r\nðŸ’¡Â [How to configure the policy settings for Azure Information Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-settings)\r\n###Â 2)Â Inventory Systems\r\nðŸ’¡Â [Explore and manage your resources with asset inventory and management tools](https://docs.microsoft.com/en-us/azure/security-center/asset-inventory)\r\n###Â 3)Â Establish System Baselines\r\nðŸ’¡Â [Manage inventory collection from VMs](https://docs.microsoft.com/en-us/azure/automation/change-tracking/manage-inventory-vms)\r\n###Â 4)Â Enforce System Least Priviledge\r\nðŸ’¡Â [What are managed identities for Azure resources?](https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview)\r\n###Â 5)Â Control User-Installed Software\r\nðŸ’¡Â [Deploy Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-deployment-plan)\r\n###Â 6)Â Enforce Security Configurations\r\nðŸ’¡Â [Secure score in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-secure-score)\r\n###Â 7)Â Restrict Ports & Protocols\r\nðŸ’¡Â [Security recommendations - a reference guide](https://docs.microsoft.com/en-us/azure/security-center/recommendations-reference)\r\n###Â 8)Â Restrict Software Execution\r\nðŸ’¡Â [Use adaptive application controls to reduce your machines' attack surfaces](https://docs.microsoft.com/en-us/azure/security-center/security-center-adaptive-application)\r\n###Â 9)Â Employ Application Whitelisting\r\nðŸ’¡Â [Quickstart: Create a policy assignment to identify non-compliant resources](https://docs.microsoft.com/en-us/azure/governance/policy/assign-policy-portal)\r\nðŸ’¡Â [Understand Azure Policy effects](https://docs.microsoft.com/en-us/azure/governance/policy/concepts/effects)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "DocumentationÂ &Â Guides: AM/CM",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing an Asset & Configuration Management Architecture with Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AM.3.036",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Define Procedures for the Handling of CUI data (ML-3)\r\n###Â CMMCÂ Guidance\r\nEstablish procedures for handling CUI. Procedures should include how to categorize data as CUI and how to provide and enforce access control for CUI. It also includes guidance on how to receive, transmit, store, and destroy CUI. The procedures should account for both physical and digital CUI.\r\n###Â Microsoft RecommendationÂ \r\nLeverageÂ AzureÂ InformationÂ ProtectionÂ toÂ ControlÂ AccessÂ toÂ SensitiveÂ InformationÂ viaÂ Policy. âœ³ï¸ [Get Started with Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/)\r\n###Â NavigateÂ \r\nAzureÂ InformationÂ ProtectionÂ >Â ClassificationsÂ >Â Labels\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Configure the Policy Settings for Azure Information Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-settings)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure AzureÂ InformationÂ ProtectionÂ toÂ ControlÂ AccessÂ toÂ CUIÂ viaÂ Policy.\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/information-protection/media/defaultsettings-aip.pngÂ Â \"Azure Information Protection Policies\")Â "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "AM.3.036",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AM.4.226",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ Automated Capability to Discover and Identify Systems in Inventory (ML-4)\r\n###Â CMMCÂ Guidance\r\nOne purpose an organization might have in determining the component attributes is to identify and locate specific systems in the event a vulnerability is discovered in the hardware or software installed so patches can be rapidly deployed to these systems or have the systems isolated from the network. For small organizations or small enclaves, this might be achieved with manual processes. Automation is expected as scale increases in order to achieve results in an operational meaningful timeframe.\r\n###Â Microsoft RecommendationÂ \r\nTrack & Inventory Systems with Azure Defender for Servers\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Heartbeat (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Inventory\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Explore and Manage Your Resources With Asset Inventory and Management Tools](https://docs.microsoft.com/en-us/azure/security-center/asset-inventory)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of Draft NIST SP 800-171B 3.4.3e\r\n\tâ€¢ CIS Controls v7.1 1.1, 1.2, 1.4, 1.5, 2.3, 2.4, 2.5\r\n\tâ€¢ NIST CSF v1.1 ID.AM-1, ID.AM-2\r\n\tâ€¢ CERT RMM v1.2 ADM:SG1.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-8\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Heartbeat\r\n|project OSType, OSName, ResourceType, Computer, ResourceGroup, RemoteIPCountry\r\n|summarize count() by Computer\r\n|project Computer\r\n|sort by Computer asc  ",
              "size": 0,
              "title": "List of Asset Names (Detected By Heartbeat)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "success",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              },
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "Computer"
                },
                "showBorder": false
              },
              "graphSettings": {
                "type": 0
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "AM.4.226",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.2.061",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Establish & Maintain Configurations & Inventories of Organizational Systems (ML-2)\r\n###Â CMMCÂ Guidance\r\nBuild and configure systems from a known, secure, and approved configuration baseline. This includes:\r\n\r\n\tâ€¢ Documenting the software and configuration settings of a system\r\n\tâ€¢ Placement within the network\r\n\tâ€¢ Other specifications as required by the organization\r\nAn effective cybersecurity program depends on system and component configuration and management.\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Enable Security Default with Azure Active Directory\r\n\tâ€¢ Configure & Enforce Security Baselines with Azure Defender for Servers\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Heartbeat (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Active Directory > Properties > Set Access Management for Azure Resources to Yes > Manage Security Defaults > Enable Security Defaults\r\n\tâ€¢ Azure Defender for Servers (Security Center) > Recommendations\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [What Are Security Defaults?](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/concept-fundamentals-security-defaults)\r\nðŸ’¡Â [Azure Security Baseline for Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-baseline)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.1\r\n\tâ€¢ CIS Controls v7.1 1.4, 1.5, 2.1, 2.4, 5.1\r\n\tâ€¢ NIST CSF v1.1 ID.AM-1, ID.AM-2, PR.DS-3, PR.DS-7, PR.IP-1, DE.AE-1\r\n\tâ€¢ CERT RMM v1.2 KIM:SG5.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-2, CM-6, CM-8, CM-8(1)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Heartbeat\r\n| where TimeGenerated > ago(30d)\r\n| summarize LastHeartbeat = max(TimeGenerated) by Computer\r\n| extend State = iff(LastHeartbeat < ago(1h), 'Unhealthy', 'Healthy')\r\n| extend TimeFromNow = now() - LastHeartbeat\r\n| extend [\"TimeAgo\"] = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| join (\r\nHeartbeat\r\n| where TimeGenerated > ago(30d)\r\n| extend Packed = pack_all()\r\n) on Computer\r\n| where TimeGenerated == LastHeartbeat\r\n| join (\r\nHeartbeat\r\n| where TimeGenerated > ago(30d)\r\n| make-series InternalTrend=iff(count() > 0, 1, 0) default = 0 on TimeGenerated from ago(30d) to now() step 1h by Computer\r\n| extend Trend=array_slice(InternalTrend, array_length(InternalTrend) - 30, array_length(InternalTrend)-1)\r\n| extend (s_min, s_minId, s_max, s_maxId, s_avg, s_var, s_stdev) = series_stats(Trend)\r\n| project Computer, Trend, s_avg\r\n) on Computer\r\n| order by State, s_avg asc, TimeAgo\r\n| project [\"Azure Resource\"]=ResourceId, State, [\"Environment\"] = iff(ComputerEnvironment == \"Azure\", ComputerEnvironment, Category), [\"OS\"]=iff(isempty(OSName), OSType, OSName), [\"Time\"]=strcat('ðŸ•’ ', TimeAgo), [\"Heartbeat Trend\"]=Trend, [\"Details\"]=Packed",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor & Enforce System Security Baselines",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 86400000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 65",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CM.2.061",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.2.062",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ the Priviledge of Least Functionality by Configuring Systems for Essential Capabilities (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou should customize organizational systems. To do this, remove non-essential applications and disable services not needed. Systems come with many unnecessary applications and settings enabled by default. Disable unnecessary software and services. These include unused ports and protocols. Leave only the fewest capabilities necessary for the systems to operate effectively.\r\n###Â Microsoft RecommendationÂ \r\nEnable VM Inventory Collection to Monitor/Enforce System Configurations âœ³ï¸ [Get Started with Azure Virtual Machines](https://azure.microsoft.com/en-us/services/virtual-machines/)\r\n###Â NavigateÂ \r\nAzure > Virtual Machines > Resource > Operations > Inventory > Enable\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Manage Inventory Collection From VMs](https://docs.microsoft.com/en-us/azure/automation/automation-vm-inventory)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.6\r\n\tâ€¢ NIST CSF v1.1 PR.IP-1, PR.PT-3\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-7\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Enable Configuration Management with Virtual Machines: Asset Inventory\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-SelectAppropriateCategory-768x342.pngÂ Â \"Establish System Baselines\")Â "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CM.2.062",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.2.063",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Control & Monitor User-Installed Software (ML-2): Applications\r\n###Â CMMCÂ Guidance\r\nYou should limit installed software to items that the organization approved. Users will install software that creates unnecessary risk. This risk applies both to the machine and to the larger operating environment. You should control the software users can install. You should put in place policies and technical controls that can reduce risk to the organization.\r\n###Â Microsoft RecommendationÂ \r\n\t1) Limit Installed Software with Azure Active Directory: Privileged Identity Management\r\n\t2) Leverage Azure Defender for Servers: Adaptive Application Controls for approved applications\r\n\t3) Monitor for suspicious programs/applications with Microsoft Defender for Endpoints\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n\r\n###Â NavigateÂ \r\n\t1) Azure Active Directory > Identity Governance > Privileged Identity Management > Azure AD roles\r\n\t2) Azure Defender for Servers (Security Center) > Azure Defender > Adaptive Application Control\r\n\t3) Microsoft Defender Security Center > Threat & Vulnerability Management > Software Inventory\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Deploy Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-deployment-plan)\r\nðŸ’¡Â [Use Adaptive Application Controls to Reduce Your Machines' Attack Surfaces](https://docs.microsoft.com/en-us/azure/security-center/security-center-adaptive-application#:~:text=How%20to%20enable%20adaptive%20application%20controls%3F%201%20Configure,policy%20page.%20...%203%20Not%20recommended%20list.%20)\r\nðŸ’¡Â [Software Inventory - Threat and Vulnerability Management](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/tvm-software-inventory)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.9\r\n\tâ€¢ CIS Controls v7.1 2.1, 2.2, 2.6\r\n\tâ€¢ NIST CSF v1.1 DE.CM-3\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-11\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Adaptive application controls for defining safe applications should be enabled on your machines\" or RecommendationName == \"Allowlist rules in your adaptive application control policy should be updated\" \r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by RecommendationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Limit Installed Applications with Azure Defender for Servers",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 65",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert \r\n| where ProviderName == \"MDATP\"\r\n| where TimeGenerated > ago(90d)\r\n| sort by TimeGenerated\r\n| search \"tool\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by AlertName\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Suspicous Software with Microsoft Defender for Endpoints",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 65 - Copy"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CM.2.063",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.2.064",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Establish & Enforce Security Configuration Settings (ML-2)\r\n###Â CMMCÂ Guidance\r\nSecurity-related configuration settings should be customized and included as part of an organizationâ€™s baseline configurations for all information systems. These configuration settings should satisfy the organizationâ€™s security requirements and changes or deviations to the security settings should be documented. Organizations should document the Security-related configuration settings and apply them to all systems once tested and approved. The configuration settings should reflect the most restrictive settings that are appropriate for the system. This ensures that information security is an integral part of an organizationâ€™s configuration management process.\r\n###Â Microsoft RecommendationÂ \r\nMonitor & Enforce Security Baselines with Azure Defender for Servers\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityBaselineSummary (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Azure Defender\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Secure Score in Azure Defender](https://docs.microsoft.com/en-us/azure/security-center/secure-score-security-controls)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.2\r\n\tâ€¢ CIS Controls v7.1 1.4, 1.5, 2.1, 2.4, 5.1\r\n\tâ€¢ NIST CSF v1.1 ID.AM-1, ID.AM-2, PR.DS-3, PR.DS-7, PR.IP-1, DE.AE-1\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-2, CM-6, CM-8, CM-8(1)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaselineSummary\r\n| project Resource, PercentageOfPassedRules, CriticalFailedRules, WarningFailedRules\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor & Enforce Security Baselines with Azure Defender for Servers",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "PercentageOfPassedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "green",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "CriticalFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "redBright",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "WarningFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 65",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CM.2.064",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.2.065",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Track, Review, Approve, or Disapprove, and Log Changes to Organizational Systems (ML-2) \r\n###Â CMMCÂ Guidance\r\nYou should track, review, and approve changes before committing to production. Changes to computing environments can create unintended and unforeseen issues. They can affect the security and availability of the systems. Organizations should hold regular meetings about changes. Relevant experts should review and approve proposed changes. They should discuss potential impacts, before the organization puts the changes in place. Relevant items include changes to the physical environment and to the system hosted within it.\r\n###Â Microsoft RecommendationÂ Â \r\nEnable Change Tracking and Inventory from an Automation Account âœ³ï¸ [Get Started with Azure Automation](https://azure.microsoft.com/en-us/services/automation/)\r\n###Â NavigateÂ \r\nAzure Automation Accounts > Add Automation Account > Create > Select Automation Account > Configuration Management > Change Tracking\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Enable Change Tracking and Inventory From an Automation Account](https://docs.microsoft.com/en-us/azure/automation/change-tracking/enable-from-automation-account)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.3\r\n\tâ€¢ NIST CSF v1.1 PR.IP-1, PR.IP-3\r\n\tâ€¢ CERT RMM v1.2 KIM:SG5.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-3\r\n\tâ€¢ AU ACSC Essential Eight\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Enable Change Tracking and Inventory from an Automation account\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/automation/change-tracking/media/enable-from-automation-account/enable-feature.pngÂ Â \"nable Change Tracking and Inventory from an Automation account\r\n\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CM.2.065",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.2.066",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Analyze the Security Impact of Changes Prior to Implementation (ML-2) \r\n###Â CMMCÂ Guidance\r\nYou should analyze the potential security impact of changes before implementing them. Changes to complex environments can cause unforeseen problems to systems and environments. You should perform an analysis that focuses on the security impact of changes. This can uncover potential problems before you implement the change. By doing so, you can help mitigate unforeseen problems.\r\n###Â Microsoft RecommendationÂ Â \r\nLeverage Azure Defender in Test/Dev Environments to Evaluate Security Impact of Changes with Secure Score Prior to Migrating to Production Environments\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecureScoreControls (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender (Security Center) > Secure Score\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Defender: Planning & Operations Guide](https://docs.microsoft.com/en-us/azure/security-center/security-center-planning-and-operations-guide)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.4\r\n\tâ€¢ NIST CSF v1.1 PR.IP-3\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-4\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecureScoreControls\r\n| extend Percent=PercentageScore*100\r\n| summarize avg(Percent) by bin(TimeGenerated,1d), ControlName, SubscriptionId=_SubscriptionId\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender Secure Score Controls (Percentage) Over Time (30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CM.2.066",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.3.067",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Define, Document, Approve, and Enforce Physical and Logical Access Restrictions Associated with Changes to Organizational Systems (ML-3) \r\n###Â CMMCÂ Guidance\r\nDefine, identify, and document qualified individuals authorized to have access and make physical and logical changes to the organizationâ€™s hardware, software, software libraries or firmware components. Control of configuration management activities may involve:\r\n\r\n\tâ€¢ Physical access control which prohibits unauthorized users from gaining physical access to an asset (e.g., requiring a special key card to enter a server room);\r\n\tâ€¢ Logical access control which prevents unauthorized users from logging onto a system to make configuration changes (e.g., requiring specific credentials for modifying configuration settings, patching software, or updating software libraries);\r\n\tâ€¢ Workflow automation in which configuration management workflow rules define human tasks and data or files are routed between people authorized to do configuration management based on pre-defined business rules (e.g., passing an electronic form to a manager requesting approval of configuration change made by an authorized employee);\r\n\tâ€¢ An abstraction layer for configuration management that requires changes be made from an external system through constrained interface (e.g., software updates can only be made from a patch management system with a specific IP address); and\r\n\tâ€¢ Utilization of a configuration management change window (e.g., software updates are only allowed between 8:00 AM and 10:00 AM or between 6:00PM and 8:00PM).\r\n\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Define Physical/Logical Restrictions\r\n\tâ€¢ Document Change Control Policy\r\n\tâ€¢ Control Change Management Rights with Azure Active Directory Privileged Identity Management\r\n\tâ€¢ Track Changes with Azure Automation Accounts\r\n\tâ€¢ Review Activity with Azure Activity Logs\r\n\tâ€¢ Control Administrative Access with Privileged Access Workstations\r\n\r\n### Required Log (Log Source)\r\nðŸ”· AuditLogs (AAD: PIM) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Azure Active Directory > Identity Governance > Privileged Identity Management\r\n\tâ€¢ Azure > Virtual Machines > Change Tracking > Enable Change Tracking > Link to Azure Automation Account\r\n\tâ€¢ Activity Log\r\n\tâ€¢ Privileged Access Workstations\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Start Using Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-getting-started#)Â \r\nðŸ’¡Â [Enable Change Tracking and Inventory From Azure Portal](https://docs.microsoft.com/en-us/azure/automation/change-tracking/enable-from-portal)Â \r\nðŸ’¡Â [Azure Activity Log](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/activity-log)Â \r\nðŸ’¡Â [Privileged Access Workstations](https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/privileged-access-workstations#)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.5\r\n\tâ€¢ CIS Controls v7.1 2.5, 2.7, 2.8, 2.9, 4.3, 11.1, 11.3, 11.7\r\n\tâ€¢ NIST CSF v1.1 PR.IP-1\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-5\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": " AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by OperationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Control Changes with Azure Active Directory: Priviledged Identity Management. PIM Operations (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "PercentageOfPassedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "green",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "CriticalFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "redBright",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "WarningFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 65",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "CM.3.067",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.3.068",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Restrict, Disable, Prevent Non-Essential Ports, Protocols, & Services (ML-3)\r\n###Â CMMCÂ Guidance\r\nOrganizations should only use the minimum set of programs, services, ports, and protocols required for to accomplish the organizationâ€™s mission. This has several implications:\r\n\r\n\tâ€¢ All unnecessary programs and accounts are removed from all endpoints and servers.\r\n\tâ€¢ The organization makes a policy decision to control the execution of programs through either whitelisting or blacklisting. Whitelisting means a program can only run if the software has been vetted in some way, and the executable name has been entered onto a list of allowed software. Blacklisting means any software can execute as long it is not on a list of known malicious software. Whitelisting provides far more security than blacklisting, but the organizationâ€™s policy can direct the implementation of either approach. Control of execution applies to both servers and endpoints.\r\n\tâ€¢ The organization restricts the use of all unnecessary ports, protocols, and system services in order to limit entry points that attackers can use. For example the use of the FTP service is eliminated from all computers, and the associated ports are blocked unless a required service utilizes those ports. The elimination of nonessential functionality on the network and systems provides a smaller attack surface for an attacker to gain access and take control of your network or systems.\r\n###Â Microsoft RecommendationÂ \r\nRestrict, Disable, Prevent Non-Essential Ports, Protocols, & Services with Azure Defender for Servers\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Recommendations > Secure Management / Restrict Unauthorized Network Access\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Security Recommendations - A Reference Guide](https://docs.microsoft.com/en-us/azure/security-center/recommendations-reference)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.7\r\n\tâ€¢ CIS Controls v7.1 9.2, 9.4, 12.4\r\n\tâ€¢ NIST CSF v1.1 PR.IP-1, PR.PT-3\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-7(1), CM-7(2)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Management ports should be closed on your virtual machines\" \r\nor RecommendationName == \"All network ports should be restricted on NSG associated to your VM\" \r\nor RecommendationName == \"Internet-facing virtual machines should be protected with network security groups\" \r\nor RecommendationName == \"Non-internet-facing virtual machines should be protected with network security groups\"\r\nor RecommendationName == \"Management ports of virtual machines should be protected with just-in-time network access control\"\r\nor RecommendationName == \"Function App should only be accessible over HTTPS\"\r\nor RecommendationName == \"Subnets should be associated with a network security group\"\r\nor RecommendationName == \"Network traffic data collection agent should be installed on Linux virtual machines (Preview)\"\r\nor RecommendationName == \"Web Application should only be accessible over HTTPS\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by RecommendationName\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Control Ports, Protocol, & Services with Azure Defender for Servers",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "PercentageOfPassedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "green",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "CriticalFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "redBright",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "WarningFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 65",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "CM.3.068",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.3.069",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Apply Deny-By-Exception (Block) Policy to Prevent the Use of Unauthorized Software or Deny-All, Permit-By-Exception (Allow) Policy to Allow the Execution of Authorized Software (ML-3) \r\n###Â CMMCÂ Guidance\r\nOrganizations should determine their block list or allow list policy and configure the system to manage software that is allowed to run. Block listing or deny-by-exception allows all software to run except if on an unauthorized software list. Allow listing or permit-by-exception does not allow any software to run except if on an authorized software list. The stronger policy of the two is allow listing.\r\n###Â Microsoft RecommendationÂ \r\nBlock Access to Unsanctioned Apps with Microsoft Defender for Endpoint & Microsoft Cloud App Security\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Cloud App Security) âœ³ï¸ [Get Microsoft Cloud App Security](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\n###Â NavigateÂ \r\nMicrosoft Defender Security Center > Settings > Advanced Features > Enable Microsoft Cloud App Security Integration\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Block Access to Unsanctioned Apps with Microsoft Defender for Endpoint & Microsoft Cloud App Security](https://techcommunity.microsoft.com/t5/microsoft-security-and/block-access-to-unsanctioned-apps-with-microsoft-defender-atp/ba-p/1121179)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.4.8\r\n\tâ€¢ CIS Controls v7.1 2.1, 2.2, 2.6, 2.7, 2.8, 2.9\r\n\tâ€¢ NIST CSF v1.1 PR.PT-3\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-7(4), CM-7(5)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert \r\n| where ProviderName == \"MCAS\" or ProviderName == \"MDATP\"\r\n| where AlertName contains \"app\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by AlertName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "SecurityAlerts for Unauthorized Application Activity (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "PercentageOfPassedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "green",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "CriticalFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "redBright",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "WarningFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "CM.3.069",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.4.073",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Employ application allow listing and an application vetting process for systems identified by the organization (ML-4) \r\n###Â CMMCÂ Guidance\r\nThe organization has a procedure to validate systems used for processing CUI information and to identify the applications required for CUI processing. The procedure includes the steps a new application must go through to check it is not malicious and there is a business requirement for the application before it is added to the whitelist. The organization has configured their systems (e.g., desktop, laptop, tablet) to check an application has been approved for use (whitelisted) before the application can run. All unapproved applications are, by default blocked from running on the organizationâ€™s systems. See practice RM.5.152 for more information on handling non-whitelisted software.\r\n###Â Microsoft RecommendationÂ \r\nConfigure & Enforce Application Allow Lists with Microsoft Cloud Application Security & Microsoft Defender for Endpoint\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Cloud App Security) âœ³ï¸ [Get Microsoft Cloud App Security](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Microsoft 365 Admin Center > Security > Microsoft Cloud App Security > Control > Policies > Create Policy > Access Policy\r\n\tâ€¢ Microsoft Defender Security Center > Settings > Advanced Feature > Enable Microsoft Cloud App Security\r\n\t\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Create a Cloud App Security Access Policy](https://docs.microsoft.com/en-us/cloud-app-security/access-policy-aad)Â \r\nðŸ’¡Â [Block Access to Unsanctioned Apps with Microsoft Defender for Endpoint & Microsoft Cloud App Security](https://techcommunity.microsoft.com/t5/microsoft-security-and/block-access-to-unsanctioned-apps-with-microsoft-defender-atp/ba-p/1121179)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of NIST SP 800-171 3.4.8\r\n\tâ€¢ CIS Controls v7.1 2.1, 2.2, 2.6, 2.7, 2.8, 2.9\r\n\tâ€¢ NIST CSF v1.1 PR.PT-3\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CM-7(4), CM-7(5)\r\n\t\r\n\r\n\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert \r\n| where ProviderName == \"MCAS\" or ProviderName == \"MDATP\"\r\n| where AlertName contains \"app\"\r\n| summarize count() by AlertName",
              "size": 0,
              "showAnalytics": true,
              "title": "SecurityAlerts for Unauthorized Application Activity (Count of Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "PercentageOfPassedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "green",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "CriticalFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "redBright",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "WarningFailedRules",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Environment",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Azure",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Direct Agent",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Agent",
                          "representation": "turquoise",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "SCOM Management Server",
                          "representation": "orange",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Heartbeat Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "Details",
                    "formatter": 5
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "AlertName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "CM.4.073",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CM.5.074",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Verify the Integrity and Correctness of Security Critical or Essential Software as Defined by the Organization (e.g., Roots of Trust, Formal Verification, or Cryptographic Signatures) (ML-5) \r\n###Â CMMCÂ Guidance\r\nSystems that perform a critical security function or processing of highly valued CUI data may contain a Trusted Platform Module (TPM) version 1.2 or higher chip. The organization will configure the systems the organization has identified to use a secure boot process (i.e., verify the signature of the OS loader and all kernel objects match expected values) and key applications are authenticated before running them. These procedures ensure the integrity of the security critical software.\r\n###Â Microsoft RecommendationÂ \r\nVerify Device Trusted Platform Modules (TPM) and Enable Bitlocker Encryption with Microsoft Intune. âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n###Â NavigateÂ \r\nMicrosoft Endpoint Manager Admin Center > Endpoint Security > Disk Encryption > Create Policy > Profile: Bitlocker\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Manage BitLocker policy for Windows 10 in Intune](https://docs.microsoft.com/en-us/mem/intune/protect/encrypt-devices)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of Draft NIST SP 800-171B 3.14.1e\r\n\tâ€¢ CIS Controls v7.1 2.10\r\n\tâ€¢ NIST CSF v1.1 PR.DS-6, PR.DS-8, PR.IP-2\r\n\tâ€¢ CERT RMM v1.2 TM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-7(6), SI-7(9), SI-7(10), SA-17\r\n\t\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Asset & Configuration (AM/CM)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Verify Device Trusted Platform Module (TPM) and Enable Bitlocker Encryption with Microsoft Intune\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/mem/intune/protect/media/encrypt-devices/bitlocker-settings.pngÂ Â \"Device Encryption Profiles\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Asset & Configuration (AM/CM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "CM.5.074",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Identification & Authentication (IA)\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Identification & Authentication (IA)"
      },
      "name": "Identification & Authentication (IA)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nIdentification & Authentication ManagementÂ is the process of managing user, system, asset identities and controlling access to authorized resources. TheÂ Identification & Authentication ManagementÂ ControlÂ familyÂ includesÂ 16Â controlsÂ withÂ varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information,Â see ðŸ’¡Â [CMMC with Microsoft Azure: Identification & Authentication Maturity](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-identification-authentication-maturity-4-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Identification & Authentication (IA) - OV",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Identification & AuthenticationÂ (IncludedÂ inÂ Workbook)\r\n|Â Identification & AuthenticationÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-1Â |Â IA.1.076 | Identify information system users, processes acting on behalf of users or devices.  |\r\n|Â ML-1Â |Â IA.1.077 | Authenticate (or verify) the identities of those users, processes or devices, as a prerequisite to allowing access to organizational information systems.  |\r\n|Â ML-2Â |Â IA.2.078 | Enforce a minimum password complexity and change of characters when new passwords are created.  |\r\n|Â ML-2Â |Â IA.2.079 | Prohibit password reuse for a specified number of generations.  |\r\n|Â ML-2Â |Â IA.2.080 | Allow temporary password use for system logons with an immediate change to a permanent password.  |\r\n|Â ML-2Â |Â IA.2.081 |  Store and transmit only cryptographically- protected passwords. |\r\n|Â ML-2Â |Â IA.2.082 |  Obscure feedback of authentication information. |\r\n|Â ML-3Â |Â IA.3.083 |  Use multi-factor authentication for local and network access to privileged accounts and for network access to non-privileged accounts. |\r\n|Â ML-3Â |Â IA.3.084 | Employ replay-resistant authentication mechanisms for network access to privileged and non-privileged accounts.  |\r\n|Â ML-3Â |Â  IA.3.085 | Prevent the reuse of identifiers for a defined period. |\r\n|Â ML-3Â |Â  IA.3.086 | Disable identifiers after a defined period of inactivity. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Identification & AuthenticationÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Identification & Authentication in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Identification & Authentication Management\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series4-BigTable-768x874.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ IAÂ Mapping\")\r\n---\r\n",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Identification & Authentication Management",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Identification & Authentication?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC Identification & Authentication Maturity Capability (IA-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include identification & authentication (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization.\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series4-AdminControlTable.pngÂ Â \"CustomerÂ Responsibilities\")\r\n",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Identification & Authentication?",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for Identification & Authentication in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing an Identification & Authentication Architecture with Microsoft Azure ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 9 Steps to CMMC for Identification & Authentication Management with Microsoft Azure\r\nMicrosoft Azure has developed a 9-step process to facilitate identification & authentication maturity with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate identification & authentication including AðŸ’¡[Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Azure Active Directory: Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure), ðŸ’¡[Azure Active Directory: Domain Services](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure), ðŸ’¡[Azure Policy](https://docs.microsoft.com/en-us/azure/governance/policy/overview), and ðŸ’¡[Key Vault](https://azure.microsoft.com/en-us/services/key-vault/). \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series4-9Steps-768x411.pngÂ Â \"9 Steps to CMMC for Identity & Authentication Maturity with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Identify Users & Managed Identities\r\nðŸ’¡Â [Create an access review of groups and applications in Azure AD access reviews](https://docs.microsoft.com/en-us/azure/active-directory/governance/create-access-review)\r\n###Â 2)Â Perform User Authentication\r\nðŸ’¡Â [What authentication and verification methods are available in Azure Active Directory?](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-methods)\r\n###Â 3)Â Enforce Password Complexity\r\nðŸ’¡Â [Create a custom password policy](https://docs.microsoft.com/en-us/azure/active-directory-domain-services/password-policy#create-a-custom-password-policy)\r\n###Â 4)Â Prohibit Password Reuse\r\nðŸ’¡Â [Create a custom password policy](https://docs.microsoft.com/en-us/azure/active-directory-domain-services/password-policy#create-a-custom-password-policy)\r\n###Â 5)Â Leverage Temporary Passwords\r\nðŸ’¡Â [Reset a user's password using Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-users-reset-password-azure-portal)\r\n###Â 6)Â Protect Passwords\r\nðŸ’¡Â [Quickstart: Set and retrieve a secret from Azure Key Vault using the Azure portal](https://docs.microsoft.com/en-us/azure/key-vault/quick-create-portal)\r\n###Â 7)Â Obscure Authentication Feedback\r\nðŸ’¡Â [Azure Active Directory fundamentals documentation](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/)\r\n###Â 8)Â Implement Multi-Factor Authentication\r\nðŸ’¡Â [Plan an Azure AD Multi-Factor Authentication deployment](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-getstarted)\r\n###Â 9)Â Employ Replay-Resistant Authentication\r\nðŸ’¡Â [Plan and deploy on-premises Azure Active Directory Password Protection](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-ban-bad-on-premises-deploy)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing an Identification & Authentication Architecture with Microsoft Azure ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.1.076",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Identify Information Systems Users & Processes Acting On Behalf of Users (ML-1)\r\n###Â CMMCÂ Guidance\r\nAuthentication helps you to know who is using or viewing your system. Make sure to assign individual, unique identifiers, like user names, to all employees/users who access company systems. Confirm the identities of users, processes, or devices before allowing them access to the companyâ€™s information system-usually done through passwords.\r\n###Â Microsoft RecommendationÂ \r\nReview User Authentications via Azure Active Directory: Access Reviews\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SigninLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\nAzure Active Directory > Identity Governance > Access Reviews > Create An Access Review\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Create An Access Review of Groups and Applications in Azure AD Access Reviews](https://docs.microsoft.com/en-us/azure/active-directory/governance/create-access-review)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.v\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.1\r\n\tâ€¢ CIS Controls v7.1 4.2, 4.3, 16.8, 16.9\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ CERT RMM v1.2 ID:SG1.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-2, IA-3, IA-5\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SigninLogs\r\n| where TimeGenerated > ago(30d)\r\n| project UserId, IPAddress, Location, SourceSystem, TimeGenerated, UserPrincipalName\r\n| summarize count() by UserPrincipalName\r\n| sort by count_ desc \r\n| render barchart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory: User Authentication Count (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "IA.1.076",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.1.077",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Authenticate Identity of Users, Processes, or Devices for Access to IT Systems (ML-1)\r\n###Â CMMCÂ Guidance\r\nBefore you let a person or a device have access to your system, you need to verify that the user or device is who or what it claims to be. This verification is called authentication. The most common way to verify identity is using a username and a hard-to-guess password.Some devices ship with default usernames and passwords. For example, some devices ship so that when you first logon to the device, the username is â€œadminâ€ and the password is â€œadminâ€. When you have devices with this type of default username and password, you need to change the default password to a unique password you create. Default passwords are well known to the public, and easily found in a search. So, these default passwords would be easy for an unauthorized person to guess and use to gain access to your system.\r\n###Â Microsoft RecommendationÂ \r\nControl & Monitor Authentications with Azure Active Directory\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SigninLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\nAzure Active Directory > Authentication Methods\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [What Authentication and Verification Methods are Available in Azure Active Directory?](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-methods)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.vi\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.2\r\n\tâ€¢ CIS Controls v7.1 4.2, 4.3, 16.8, 16.9\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-2, IA-3, IA-5\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SigninLogs\r\n| extend ResultText = case(isnotempty(ResultDescription), ResultDescription, ResultType == 0 and isempty(ResultDescription), \"Successfull login\", \"unknown\")\r\n| summarize dcount(CorrelationId) by ResultText, bin(TimeGenerated,1d) // summarize the total Signin events per Description per hour (by unique CorrelationId's)\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory Authentication Codes Count (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "timechart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "IA.1.077",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.2.078",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Enforce Minimum Password Complexity (ML-2)\r\n###Â CMMCÂ Guidance\r\nPassword complexity means using different types of characters as well as a specified number of characters. These include numbers, lowercase and uppercase letters, and symbols. Define the lowest level of password complexity required. Enforce this rule for all passwords.\r\n###Â Microsoft RecommendationÂ \r\nConfigure Password Complexity Policies in Azure Active Directory\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityBaseline (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure Active Directory > Password Reset / Policies\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Password Policies and Account Restrictions in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-policy#:~:text=%20Password%20policies%20and%20account%20restrictions%20in%20Azure,expiration%20policies.%20A%20global%20administrator%20or...%20More%20)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.7\r\n\tâ€¢ CIS Controls v7.1 4.2, 4.4\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-5(1)\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where TimeGenerated > ago(30d)\r\n| where Description == \"Ensure \\'Minimum password length\\' is set to \\'14 or more character(s)\\'\" or Description == \"Ensure \\'Password must meet complexity requirements\\' is set to \\'Enabled\\'\" or Description == \"Ensure password hashing algorithm is SHA-512\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by AnalyzeResult, Description\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Security Baselines: Password Complexity Assessment (Daily)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IA.2.078",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.2.079",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Prohibit Password Refuse for Specified Number of Generations (ML-2)\r\n###Â CMMCÂ Guidance\r\nIndividuals may not reuse passwords for a defined period of time and a set number of passwords generated.\r\n###Â Microsoft RecommendationÂ \r\nConfigure Password Reuse Policies in Azure Active Directory\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityBaseline (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure Active Directory > Password Reset / Policies\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Password Policies and Account Restrictions in Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-policy#:~:text=%20Password%20policies%20and%20account%20restrictions%20in%20Azure,expiration%20policies.%20A%20global%20administrator%20or...%20More%20)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.8\r\n\tâ€¢ CIS Controls v7.1 4.2, 4.4\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-5(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where TimeGenerated > ago(30d)\r\n| where Description == \"Ensure 'Enforce password history' is set to '24 or more password(s)'\" or Description == \"Ensure 'Maximum password age' is set to '70 or fewer days, but not 0'\" or Description == \"Ensure 'Minimum password age' is set to '1 or more day(s)'\" or Description == \"Ensure minimum days between password changes is 7 or more.\" or Description == \"Ensure all users last password change date is in the past\"\r\n| summarize count() by AnalyzeResult, Description\r\n| sort by AnalyzeResult\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Azure Password Reuse Policy Compliance with Security Baselines",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AnalyzeResult",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Passed",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Failed",
                          "representation": "failed",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "success",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IA.2.079",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.2.080",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Allow Temporary Password Use for System Logons with Immediate Change to Permanent Password (ML-2)\r\n###Â CMMCÂ Guidance\r\nUsers must change their temporary passwords the first time they log in. Temporary passwords usually follow a consistent style within an organization and can be more easily guessed than passwords created by the unique user.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Temporary Passwords in Azure Active Directory âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Users > Select User > Reset Password\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Reset a User's Password Using Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-users-reset-password-azure-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.9\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-5(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Temporary Passwords in Azure Active Directory\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/media/active-directory-users-reset-password-azure-portal/user-profile-reset-password-link.pngÂ Â \"Temporary Password Reset\")\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "text - 95",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IA.2.080",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.2.081",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Store and Transmit Only Cryptographically Protected Passwords (ML-2)\r\n###Â CMMCÂ Guidance\r\nAll passwords must be cryptographically protected in a one-way function for storage and transmission. This type of protection changes passwords into another form, or a hashed password. A one-way transformation makes it impossible to turn the hashed password back into the original password.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Key Vault for Secure Storage of Keys, Secrets, and Passwords\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityBaseline (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure Key Vault\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Quickstart: Set and Retrieve a Secret From Azure Key Vault Using the Azure Portal](https://docs.microsoft.com/en-us/azure/key-vault/quick-create-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.10\r\n\tâ€¢ CIS Controls v7.1 16.4, 16.5\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-5(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where TimeGenerated > ago(30d)\r\n| where Description == \"Ensure password hashing algorithm is SHA-512\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by AnalyzeResult, Description\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Security Baseline Assessment: Ensure Password Hashing Algorithm is SHA-512 (Daily)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AnalyzeResult",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Passed",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Failed",
                          "representation": "failed",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "success",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IA.2.081",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.2.082",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Obscure Feedback of Authentication Information (ML-2)\r\n###Â CMMCÂ Guidance\r\nA password is a type of authentication information. When users enter this information, the system displays a symbol, such as an asterisk. This prevents others from seeing the actual characters. The organization should obscure feedback based on a defined policy. For example, smaller devices may briefly show characters before obscuring.\r\n###Â Microsoft RecommendationÂ \r\nPassword Obfuscation is a Default Azure Active Directory Setting\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityBaseline (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure Active Directory > Default Setting\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Active Directory Fundamentals Documentation](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.11\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-6\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where TimeGenerated > ago(30d)\r\n| where Description contains \"\" \"Ensure 'Do not display the password reveal button' is set to 'Enabled\"\r\n| summarize count() by AnalyzeResult, Description\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Endpoint Password Obfuscation Policies with Security Baselines",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AnalyzeResult",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Passed",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Failed",
                          "representation": "failed",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "success",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IA.2.082",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.3.083",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Use Multi-Factor Authentication for Local & Network Access to Priviledged/Non-Privileged Accounts (ML-3)\r\n###Â CMMCÂ Guidance\r\nImplement a combination of two or more factors of authentication to verify privileged account holdersâ€™ identity regardless of how the user is accessing the account. Implement a combination of two or more factors for non-privileged users requiring network access. These factors include:\r\n\r\n\tâ€¢ Something you know (e.g., password/PIN)\r\n\tâ€¢ Something you have (e.g., token)\r\n\tâ€¢ Something you are (e.g., biometrics)\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Active Directory to Apply Multi-Factor Authentication to Privileged/Non-Privileged Accounts\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Users > Multi Factor Authentication\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Plan an Azure AD Multi-Factor Authentication Deployment](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.3\r\n\tâ€¢ CIS Controls v7.1 4.5, 11.5, 12.11\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-2(1), IA-2(2), IA-2(3)\r\n\tâ€¢ AU ACSC Essential Eight\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"MFA should be enabled on accounts with write permissions on your subscription\" or RecommendationName == \"MFA should be enabled on accounts with read permissions on your subscription\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by RecommendationName\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender for Servers: Security Recommendations (MFA)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "categoricalbar",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "query - 102",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "IA.3.083",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.3.084",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ Replay-Resistant Authentication Mechanisms for Network Access (ML-3)\r\n###Â CMMCÂ Guidance\r\nWhen insecure protocols are used for access to computing resources there is the potential for an adversary to perform a man-in-the-middle attack and capture the information that permitted a staff member to login. As part of a defense-in-depth strategy it is important to use mechanisms that are resilient to the adversary reusing the captured information and gaining access to the computing resources.\r\n###Â Microsoft RecommendationÂ \r\nPlan and Deploy Azure Active Directory Password Protection. âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Authentication Methods > Password Protection\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Enable on-premises Azure Active Directory Password Protection](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-password-ban-bad-on-premises-operations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.4\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-2(8), IA-2(9)\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Plan and Deploy Azure Active Directory Password Protection\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/authentication/media/concept-password-ban-bad-on-premises/azure-ad-password-protection.pngÂ Â \"Plan and deploy on-premises Azure Active Directory Password Protection\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "IA.3.084",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.3.085",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Prevent the Reuse of Identifiers for a Defined Period (ML-3) \r\n###Â CMMCÂ Guidance\r\nIdentifiers uniquely associate a user ID to an individual, group, role or device. Establish guidelines and implement mechanisms to prevent identifiers from being reused for the period of time established by the organization in the policy.\r\n###Â Microsoft RecommendationÂ Â \r\nYou can permanently delete a user from your organization without waiting the 30 days for automatic deletion. A permanently deleted user can't be restored by you, another administrator, nor by Microsoft customer support. âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Users > Deleted Users\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Restore or Remove a Recently Deleted User Using Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-users-restore)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.5\r\n\tâ€¢ CIS Controls v7.1 16.7, 16.10,16.12\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-4"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control & Monitor Deleted Identifiers with Azure Active Directory: Deleted Users\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/media/active-directory-users-restore/users-deleted-users-view-restorable.pngÂ Â \"Deleted Users\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "IA.3.085",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IA.3.086",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Disable Identifiers After a Defined Period of Inactivity (ML-3) \r\n###Â CMMCÂ Guidance\r\nIdentifiers are uniquely associated with an individual, group, role or device. An inactive identifier is one that has not been used for a certain period of time. For example, a user account may be needed for a certain time to allow for transition of business processes to existing or new staff. Once use of the identifier is no longer necessary it should be disabled and marked for deletion based on policy. Failure to maintain awareness of accounts that are no longer needed yet still active could be used by an adversary to exploit IT services.\r\n###Â Microsoft RecommendationÂ Â \r\nConfigure Inactivity Lockout Threshold with the AzureAD Powershell Module \r\n###Â NavigateÂ \r\nPowershell > Install-module AzureAD\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Report on Azure AD Stale Users](https://gallery.technet.microsoft.com/scriptcenter/Report-on-Azure-AD-Stale-8e64c1c5)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.5.6\r\n\tâ€¢ CIS Controls v7.1 16.9, 16.10, 16.11\r\n\tâ€¢ NIST CSF v1.1 PR.AC-1, PR.AC-6, PR.AC-7\r\n\tâ€¢ NIST SP 800-53 Rev 4 IA-4\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Monitor Inactivity Lockout Thresholds with the AzureAD Powershell Module\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/media/concept-sign-ins/06.pngÂ Â \"Sign In Tracking\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Identification & Authentication (IA)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Identification & Authentication (IA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "IA.3.086",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Incident Response (IR)\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Incident Response (IR)"
      },
      "name": "Incident Response (IR)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nIncident ResponseÂ is the process of responding to cybersecurity incidents and events. Incident Response includes preparation, identification, containment, eradication, recovery, and lessons learned phases. TheÂ Incident ResponseÂ ControlÂ familyÂ includesÂ 18Â controlsÂ withÂ varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: Incident Response Maturity](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-incident-response-maturity-5-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Incident Response (IR) - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Incident ResponseÂ (IncludedÂ inÂ Workbook)\r\n|Â Incident ResponseÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â IR.2.092 | Establish an operational incident-handling capability for organizational systems that includes preparation, detection, analysis, containment, recovery and user response activities. |\r\n|Â ML-2Â |Â IR.2.093 | Detect and report events. |\r\n|Â ML-2Â |Â IR.2.094 | Analyze and triage events to support event resolution and incident declaration.|\r\n|Â ML-2Â |Â IR.2.096Â | Develop and implement responses to declared incidents according to pre- defined procedures. | \r\n|Â ML-3Â |Â IR.3.097 | Perform root cause analysis on incidents to determine underlying causes. |\r\n|Â ML-3Â |Â IR.3.098 | Track, document and report incidents to designated officials and/or authorities both internal and external to the organization. |\r\n|Â ML-4Â |Â IR.4.100 | Use knowledge of attacker tactics, techniques and procedures in incident response planning and execution. |\r\n|Â ML-5Â |Â IR.5.102 | Use a combination of manual and automated, real-time response to anomalous activities that match incident patterns. |\r\n|Â ML-5Â |Â IR.5.106 | In response to cyber incidents, utilize forensic data gathering across impacted systems, ensuring the secure transfer and protection of forensic data. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Incident ResponseÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Incident Response  in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â IncidentÂ Response\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series5-BigTable-896x1024.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ IRÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â IncidentÂ Response",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ IncidentÂ ResponseÂ Management?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nTheÂ administrativeÂ controlsÂ forÂ theÂ CMMCÂ IncidentÂ ResponseÂ CapabilityÂ (IR-MC)Â areÂ listedÂ here.Â TheseÂ controlsÂ fallÂ withinÂ theÂ customerâ€™sÂ responsibility.Â ThisÂ startsÂ withÂ establishingÂ policesÂ toÂ includeÂ incidentÂ responseÂ managementÂ (ML2)Â andÂ progressesÂ toÂ aÂ documentedÂ approachÂ acrossÂ allÂ applicableÂ organizationalÂ unitsÂ (ML5).Â TheseÂ controlsÂ shouldÂ beÂ formallyÂ created,Â documentedÂ inÂ theÂ SystemÂ SecurityÂ PlanÂ (SSP)Â andÂ implementedÂ withinÂ theÂ organization.\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series5-AdminControlsTable.pngÂ Â \"CustomerÂ Responsibilities\")\r\n",
              "style": "success"
            },
            "customWidth": "50",
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ IncidentÂ ResponseÂ Management?",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for Incident Response  in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing an Incident Response Architecture in Microsoft Azure ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 8Â StepsÂ toÂ CMMCÂ forÂ IncidentÂ ResponseÂ MaturityÂ withÂ MicrosoftÂ Azure\r\nMicrosoftÂ AzureÂ hasÂ developedÂ anÂ 8-stepÂ processÂ toÂ facilitateÂ incidentÂ responseÂ maturityÂ withÂ theÂ securityÂ principlesÂ withinÂ CMMC,Â NISTÂ SPÂ 800-53Â R4Â andÂ NISTÂ SPÂ 800-171Â standards.Â NoteÂ thisÂ processÂ isÂ aÂ startingÂ point,Â asÂ CMMCÂ requiresÂ alignmentÂ ofÂ people,Â processes,Â policyÂ andÂ technologyÂ soÂ referÂ toÂ organizationalÂ requirementsÂ andÂ respectiveÂ standardsÂ forÂ implementation.Â AzureÂ hasÂ severalÂ offeringsÂ toÂ facilitateÂ incidentÂ responseÂ includingÂ ðŸ’¡[Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/), ðŸ’¡[Azure Defender for Servers](https://azure.microsoft.com/en-us/services/security-center/), ðŸ’¡[Logic Apps](https://azure.microsoft.com/en-us/services/logic-apps/), ðŸ’¡[Log Analytics](https://docs.microsoft.com/en-us/azure/azure-monitor/learn/quick-create-workspace), and ðŸ’¡[Microsoft Graph Security API](https://www.microsoft.com/en-us/security/business/graph-security-api).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series5-8steps-768x399.pngÂ Â \"8Â StepsÂ toÂ CMMCÂ forÂ IncidentÂ ResponseÂ MaturityÂ withÂ MicrosoftÂ Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "8Â StepsÂ toÂ CMMCÂ forÂ IncidentÂ ResponseÂ MaturityÂ withÂ MicrosoftÂ Azure",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â EstablishÂ anÂ IncidentÂ ResponseÂ CapabilityÂ \r\nðŸ’¡Â [Quickstart: On-board Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-onboard)\r\n###Â 2)Â LeverageÂ KnowledgeÂ ofÂ AttackerÂ Tactics\r\nðŸ’¡Â [Connect data from threat intelligence providers](https://docs.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence)\r\n###Â 3)Â DetectÂ &Â ReportÂ Events\r\nðŸ’¡Â [Hunt for threats with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/hunting)\r\n###Â 4)Â AnalyzeÂ &Â TriageÂ Events\r\nðŸ’¡Â [Tutorial: Investigate incidents with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases)\r\n###Â 5)Â GatherÂ IncidentÂ Artifacts\r\nðŸ’¡Â [Keep track of data during hunting with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/bookmarks)\r\n###Â 6)Â ConductÂ IncidentÂ Reporting\r\nðŸ’¡Â [Quickstart: Get started with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-get-visibility)\r\n###Â 7)Â EmployÂ AutomatedÂ Responses\r\nðŸ’¡Â [Tutorial: Set up automated threat responses in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook)\r\n###Â 8)Â ConductÂ RootÂ CauseÂ Analysis\r\nðŸ’¡Â [Tutorial: Investigate incidents with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "DocumentationÂ &Â Guides: IR",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing an Incident Response Architecture in Microsoft Azure ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.2.092",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Establish An Incident Handling Capability (ML-2) \r\n###Â CMMCÂ Guidance\r\nIncident handling should include activities that prepare your organization to respond to incidents. These activities may include the following:\r\n\r\n\tâ€¢ Identify people inside and outside your organization you may need to contact during an incident\r\n\tâ€¢ Establish a way to report incidents, such as an email address or a phone number\r\n\tâ€¢ Establish a system for tracking incidents\r\n\tâ€¢ Determine a place and a way to store evidence of an incident\r\nYou may need software and hardware to analyze incidents when they occur. You should also consider incident prevention activities as part of your incident-handling capability. The incident handling team provides input for such things as risk assessments and training.\r\nYour organization should detect incidents in different ways. Use indicators to detect incidents. Indicators are things that donâ€™t look like what you expect. Examples include:\r\n\r\n\tâ€¢ Alerts from your sensors or antivirus software\r\n\tâ€¢ A filename that looks unusual\r\n\tâ€¢ A log entry that raises concern\r\nAfter you detect an incident, you should analyze it to decide what to do. To analyze an incident, you need to know what should be occurring on your network and what should not. This will help you determine when an incident may have occurred. It may also help you decide what to do about it. You should also document what you know about the incident. Include all the log entries associated with the incident in your documentation.\r\n\tContainment of the incident is important. This stops the damage the incident is causing to your network. You should base the containment activities you do off your incident analysis. These activities can include:\r\n\t\r\n\tâ€¢ Disconnecting a system from the internet\r\n\tâ€¢ changing firewall settings to stop an attack\r\nRecovery activities are things to fix that caused the incident. This will help prevent the incident happening again. Recovery activities also include things that fix the affected systems, including:\r\n\r\n\tâ€¢ Restoring backup data\r\n\tâ€¢ Reinstalling software\r\nUser response activities include:\r\n\r\n\tâ€¢ Performing a lessons-learned analysis\r\n\tâ€¢ Deciding if you should contact the police\r\n\tâ€¢ Updating any policy or plans as a result of after incident analysis\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel to Support Incident Handling Requirements\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityIncident (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Quickstart: On-Board Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-onboard)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.6.1\r\n\tâ€¢ NIST CSF v1.1. RS.RP-1\r\n\tâ€¢ CERT RMM v1.2 IMC:SG1.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IR-2, IR-4\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n|Â whereÂ CreatedTimeÂ >=Â ago(30d)Â andÂ CreatedTimeÂ <=Â now()\r\n|Â whereÂ SeverityÂ inÂ ('*')Â orÂ 'All'Â ==Â Â \"All\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by Severity\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel Incidents Count (30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "query - 110",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IR.2.092",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.4.100",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Knowledge of Attacker TTPs (ML-4) \r\n###Â CMMCÂ Guidance\r\nWhen conducting cyberattacks the attackers (or actors) tend to operate using certain patterns of behavior or exploit capabilities. These patterns and capabilities are known as Tactics, Techniques, and Procedures (TTPs). Knowledge of adversarial TTPs permits an organization to develop the right protective measures and responses to address a potential attack.\r\nAn organization can build their knowledge of attacker TTPs by participating in Information Sharing and Analysis Centers (ISAC) for their industry. An ISAC collects cyber threat information relevant to the industry and its members in order to improve the cyber posture of that industry. Based on the lines of business an organization may consider more than one ISAC.\r\n###Â Microsoft RecommendationÂ \r\nExplore Threat Tactics with Azure Sentinel Hunting & Threat Intelligence\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· ThreatIntelligenceIndicatorÂ  (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Sentinel > Hunting\r\n\tâ€¢ Azure Sentinel > Threat Intelligence\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Hunt for threats with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/hunting#:~:text=Get%20started%20hunting%201%20In%20the%20Azure%20Sentinel,leaving%20the%20hunting%20page.%20...%20More%20items...%20)\r\nðŸ’¡Â [Connect data from threat intelligence providers](https://docs.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\t\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicatorÂ \r\n|Â summarizeÂ CountÂ =Â count()Â byÂ Description\r\n|Â sortÂ byÂ Count\r\n|Â limitÂ 10Â \r\n|Â renderÂ barchartÂ ",
              "size": 0,
              "showAnalytics": true,
              "title": "Threat Indicators Count (7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "IR.4.100",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.2.093",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Detect & Report Events (ML-2) \r\n###Â CMMCÂ Guidance\r\nDetect events on your network. An event is any observable occurrence on the network. You can detect events several ways, including through:\r\n\tâ€¢ Observations of breakdowns in processes or loss in productivity\r\n\tâ€¢ Observations such as alarms and alerts, notification from other organizations\r\n\tâ€¢ The results of audits or assessments\r\nAfter you detect an event, determine if it will affect organizational assets and/or has the potential to disrupt operations. This may require the start of the incident process.\r\n###Â Microsoft RecommendationÂ \r\nDetect & Report Events with Azure Sentinel Analytics\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Analytics\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Hunt for Threats with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/hunting)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CIS Controls v7.1 19.4\r\n\tâ€¢ NIST CSF v1.1 DE.CM-1, DE.CM-2, DE.CM-3, RS.CO-2\r\n\tâ€¢ CERT RMM v1.2 IMC:SG2.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 IR-6\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n|Â whereÂ AlertSeverityÂ inÂ ('*')Â orÂ 'All'Â ==Â Â \"All\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by AlertSeverity\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel Alerts Count (7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IR.2.093",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.2.094",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Analyze & Triage Events (ML-2) \r\n###Â CMMCÂ Guidance\r\nAnalyze events to determine what to do. Categorize, prioritize, or group events to determine how to handle the event. You can take different actions in response to an event:\r\n\r\n\tâ€¢ Declare an incident from the event\r\n\tâ€¢ Escalate it to someone outside the organization\r\n\tâ€¢ Close the event because it does not have a large consequence on the organization\r\n###Â Microsoft RecommendationÂ \r\nAnalyze & Triage Events with Azure Sentinel Incidents\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Usage (Log Analytics) âœ³ï¸ [Get Started with Azure Monitor](https://azure.microsoft.com/en-us/services/monitor/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Incidents\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Investigate Incidents with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CERT RMM v1.2 IMC:SG2.SP4\r\n\tâ€¢ NIST SP 800-53 Rev 4 IR-4(3)"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Usage\r\n|Â summarizeÂ count()Â byÂ DataType\r\n|Â sortÂ byÂ count_Â desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Event Count by Type (7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "graph",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "graphSettings": {
                "type": 2,
                "topContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "centerContent": {
                  "columnMatch": "count_",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "nodeIdField": "DataType",
                "graphOrientation": 3,
                "showOrientationToggles": false,
                "nodeSize": null,
                "staticNodeSize": 100,
                "colorSettings": {
                  "nodeColorField": "count_",
                  "type": 4,
                  "heatmapPalette": "coldHot",
                  "heatmapMin": null,
                  "heatmapMax": null
                },
                "hivesMargin": 5
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IR.2.094",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.2.096",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Develop and Implement Responses to Declared Incidents According to Pre-defined Procedures (ML-3) \r\n###Â CMMCÂ Guidance\r\nWrite procedures ahead of time to use when responding to incidents. These procedures will help guide the development and implementation of responses during an incident. Responses should prevent or contain the impact of an incident while it is occurring or shortly after. The type of response will vary depending on the incident. Response actions might include:\r\n\r\n\tâ€¢ Stopping or containing the damage (e.g., by taking hardware or systems offline)\r\n\tâ€¢ Communicating to users (e.g., avoid opening a specific type of email message)\r\n\tâ€¢ Communicating to stakeholders (e.g., corporate management)\r\n\tâ€¢ Implementing controls (e.g., updating access control lists)\r\n\r\n###Â Microsoft RecommendationÂ Â \r\nDevelop and Implement Responses to Declared Incidents with Azure Sentinel Playbooks âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Playbooks  \r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Set Up Automated Threat Responses in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CIS Controls v7.1 19.1\r\n\tâ€¢ NIST CSF v1.1 RS.RP-1\r\n\tâ€¢ CERT RMM v1.2 IMC:SG4.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 IR-4\r\n\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Develop and Implement Responses to Declared Incidents with Azure Sentinel Playbooks\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/sentinel/media/tutorial-respond-threats-playbook/logic-app.pngÂ Â \"Playbooks\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IR.2.096",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.5.106",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· UtilizeÂ ForensicÂ DataÂ GatheringÂ AcrossÂ ImpactedÂ Systems (ML-5)\r\n###Â CMMCÂ Guidance\r\nThe security operations center (whether in-house or outsourced) must have the necessary forensic data to develop situational awareness across the organizationâ€™s infrastructure. One solution identifies and collects security relevant system events, data, or images using an agent on the system. The agent transfers the events in real-time over a secure channel to a protected network enclave. Other solutions require physical access to the machine from which the data is gathered.\r\nMany individual system security tools such as anti-virus or endpoint detection and response (EDR) tools can create logs, access system information in real-time, or image memory for secure transfer to a central management server. These logs would allow a SOC to begin the investigation. The SOC should also consider software tools used to push software or patches to systems. This would provide an on-demand capability for the SOC to send a security application when needed for forensic data collection.\r\n###Â Microsoft Recommendation\r\nLeverage Azure Security Architecture to Gather Forensic Evidence:\r\n\r\n\tâ€¢ Azure Sentinel\r\n\tâ€¢ Azure Defender for Servers\r\n\tâ€¢ Microsoft Defender for Endpoints\r\n\tâ€¢ Microsoft Defender for Office 365\r\n\tâ€¢ Microsoft Defender for Identity\r\n\tâ€¢ Azure Firewall\r\n\tâ€¢ Microsoft Cloud App Security\r\n\tâ€¢ Key Vault\r\n###Â NavigateÂ \r\nSee Microsoft Reference Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Computer Forensics in Azure](https://docs.microsoft.com/en-us/azure/architecture/example-scenario/forensics/)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST CSF v1.1 RS.AM-3\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###Â Leverage Azure Security Architecture to Gather Forensic Evidence\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/architecture/example-scenario/forensics/media/chain-of-custody.pngÂ Â \"ChainÂ ofÂ Custody\")\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "text - 118",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "IR.5.106",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.5.102",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Develop & Implement Responses  (ML-5) \r\n###Â CMMCÂ Guidance\r\nTo gain an advantage the organization should have pre-defined steps to reduce the risk from someone conducting a known pattern of malicious activity. The steps could be a manual checklist or automated series of actions using scripts or other technology. Organizations may call these pre-defined or automated lists a playbook or runbook. They help to establish a formalized incident response that can be performed. Organizations should balance the speed of response against the possibility of unintended side-effects in determining whether automated responses are appropriate.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel Playbooks for Security Orchestration Automation & Response (SOAR)\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· resourcesÂ  (Logic Apps) âœ³ï¸ [Get Started with Logic Apps](https://azure.microsoft.com/en-us/services/logic-apps/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Playbooks\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Setup Automated Threat Responses in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST SP 800-53 Rev 4 IR-4(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where ResourceProvider == \"Microsoft.Logic\"\r\n| summarize count() by Resource\r\n| sort by count_ desc\r\n",
              "size": 0,
              "title": "Azure Sentinel Playbooks Run (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "IR.5.102",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.3.098",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Track, Document, and Report Incidents (ML-3) \r\n###Â CMMCÂ Guidance\r\nIncident response is a process an organization executes to manage the consequences and reduce the risk as a result of a security breach or cyberattack. The majority of the process consists of identification, containment, eradication, and recovery of the incident. During this process it is essential for an organization to track the work processes required in order to effectively respond. During the process the organization should designate a central hub to serve as the point to coordinate, communicate, and track activities. The hub should receive and document information from system administrators, incident handlers, and others involved throughout the process. As the incident process moves toward eradication the organizationâ€™s executives, affected business units, and any required external stakeholdersshould be kept aware of the incident in order to make decisions affecting the business. Designated staff members should also be assigned to work with executives to provide communications outside the organization in event it is needed.\r\n###Â Microsoft RecommendationÂ \r\nTrack, Document, & Report Incidents with Azure Sentinel\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Securityincident (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Incidents\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Investigate Incidents with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.6.2\r\n\tâ€¢ CIS Controls v7.1 19.4\r\n\tâ€¢ NIST CSF v1.1 RS.CO-2, RS.CO-3\r\n\tâ€¢ CERT RMM v1.2 IMC:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 IR-6, IR-7\r\n\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncidentÂ \r\n|Â extendÂ TacticsÂ =Â todynamic(AdditionalData.tactics)\r\n|Â extendÂ OwnerÂ =Â todynamic(Owner.assignedTo)Â \r\n|Â extendÂ ProductÂ =Â todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0]))Â \r\n|Â summarizeÂ Incidents=dcount(IncidentNumber)Â byÂ Severity,Â bin(CreatedTime,Â 1d)\r\n|Â renderÂ areachartÂ \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel Incidents Count by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "IR.3.098",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "IR.2.097",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Perform Root Cause Analysis of Incidents (ML-2) \r\n###Â CMMCÂ Guidance\r\nExamine the causes of the event or incident and how your organization responded to it. Look at the administrative, technical, and physical control weaknesses. These may have allowed the incident to occur. Use available practices, such as cause-and-effect diagrams, to perform root-cause analysis. This will prevent future similar incidents. After incidents are resolved, conduct reviews and capture lessons learned. Make improvements based on the outcomes of these activities, such as updating plans or controls.\r\n###Â Microsoft RecommendationÂ \r\nPerform Incident Root Cause Analysis with Azure Sentinel Investigate\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· Securityincident (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Incidents > Investigate\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Investigate Incidents with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST CSF v1.1 DE.AE-2\r\n\tâ€¢ CERT RMM v1.2 IMC:SG5.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 AU-2\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n|Â whereÂ SeverityÂ inÂ ('*')Â orÂ 'All'Â ==Â Â \"All\"\r\n|Â whereÂ StatusÂ ==Â \"Closed\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by ClassificationReason\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel: Incident Classification Reason Count (90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Incident Response (IR)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "IR.2.097",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Incident ResponseÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3\r\n|Â Incident ResponseÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-3Â |Â IR.3.099Â | Test the organizational incident response capability. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "CMMC Incident ResponseÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Incident ResponseÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 4\r\n|Â Incident ResponseÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-4Â |Â IR.4.101Â | Establish and maintain a Security Operations Center (SOC) capability that facilitates a 24/7 response capability. | \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "CMMC Incident ResponseÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 4",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Incident ResponseÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 5\r\n|Â Incident ResponseÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-5Â |Â IR.5.108Â | Establish and maintain a Cyber Incident Response Team (CIRT) that can investigate an issue physically or virtually at any location within 24 hours. |\r\n|Â ML-5Â |Â IR.5.110Â | Perform unannounced operational exercises to demonstrate technical and procedural responses. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Incident Response (IR)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "CMMC Incident ResponseÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 5",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Maintenance & Media Protection (MA/MP)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Maintenance & Media Protection (MA/MP)"
      },
      "name": "Maintenance & Media Protection (MA/MP)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nMaintenanceÂ includes processes such as system updates, patching, and configuration changes which are required for the overall functionality of the information system. Media protection includes physical, logical, and administrative controls over sensitive data. \r\nTheÂ Maintenance & Media ProtectionÂ ControlÂ familiesÂ includeÂ 10Â controls for Maintenance and 13 controls for Media Protection. These controls have varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: Maintenance & Media Protection](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-maintenance-media-protection-6-of-10/)\r\n",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Maintenance & Media Protection (MA/MP) - OV",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Maintenance & Media ProtectionÂ (IncludedÂ inÂ Workbook)\r\n|Â MaintenanceÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |\r\n|Â ML-2Â |Â MA.2.111Â |   Perform maintenance on organizational systems.  |\r\n|Â ML-2Â |Â MA.2.112Â |   Perform maintenance on organizational systems.  |\r\n|Â ML-2Â |Â MA.2.113Â |  Require multifactor authentication to establish nonlocal maintenance sessions via external network connections and terminate such connections when nonlocal maintenance is complete.   |\r\n|Â ML-2Â |Â MA.2.114Â |   Supervise the maintenance activities of personnel without required access authorization.  |\r\n|Â ML-3Â |Â MA.3.115Â | Ensure equipment removed for off-site maintenance is sanitized of any CUI. |\r\n|Â ML-3Â |Â MA.3.116Â | Check media containing diagnostic and test programs for malicious code before the media are used in organizational systems. |\r\n\r\n|Â Media ProtectionÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |\r\n|Â ML-1Â |Â MP.1.118Â | Sanitize or destroy information system media containing Federal Contract Information (FCI) before disposal or release for reuse. |\r\n|Â ML-2Â |Â MP.2.119Â |   Protect (e.g., physically control and securely store) system media containing Federal Contract Information, both paper and digital.  |\r\n|Â ML-2Â |Â MP.2.120Â |  Limit access to CUI on system media to authorized users.   |\r\n|Â ML-2Â | MP.2.121Â |Â Control the use of removable media on system components. | \r\n|Â ML-3Â |Â MP.3.122Â |   Mark media with necessary CUI markings and distribution limitations.  |\r\n|Â ML-3Â |Â MP.3.123Â |Â Prohibit the use of portable storage devices when such devices have no identifiable owner. |\r\n|Â ML-3Â |Â MP.3.124Â |Â Control access to media containing CUI and maintain accountability for media during transport outside of controlled areas. |\r\n|Â ML-3Â |Â MP.3.125Â |   Implement cryptographic mechanisms to protect the confidentiality of CUI stored on digital media during transport unless otherwise protected by alternative physical safeguards.  |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Maintenance & Media ProtectionÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Maintenance & Media Protection in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Maintenance & Media Protection\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series6-BigTable-844x1024.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ MA/MPÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Maintenance & Media Protection",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Maintenance & Media ProtectionÂ Management?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe administrative controls for the CMMC Maintenance Maturity Capability (AM-MC) and Media Protection Maturity (MP-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include maintenance & media protection management (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization.\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series6-AdminControlsTable.pngÂ Â \"CustomerÂ Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Maintenance & Media ProtectionÂ Management?",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for Maintenance & Media Protection in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing a Maintenance & Media Protection Architecture with Microsoft Azure ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 8 Steps to CMMC for Maintenance & Media Protection Maturity with Microsoft Azure\r\nMicrosoftÂ AzureÂ has developed an 8-step process to facilitate maintenance & media protection with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate maintenance & media protection including ðŸ’¡[Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Azure Active Directory: Privileged Identity Management](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure), ðŸ’¡[Privileged Access Workstations](https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/privileged-access-workstations), ðŸ’¡[Maintenance Control](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Key Vault](https://docs.microsoft.com/en-us/azure/virtual-machines/maintenance-control-powershell), andðŸ’¡[Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series6-8steps-768x396.pngÂ Â \"8 Steps to CMMC for Maintenance & Media Protection Maturity with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "8 Steps to CMMC for Maintenance & Media Protection Maturity with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Perform Controlled Maintenance\r\nðŸ’¡Â [Managing platform updates with Maintenance Control](https://docs.microsoft.com/en-us/azure/virtual-machines/maintenance-control?toc=/azure/virtual-machines/linux/toc.json&bc=/azure/virtual-machines/linux/breadcrumb/toc.json)\r\n###Â 2)Â Control Maintenance Operations\r\nðŸ’¡Â [Privileged Access Workstations](https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/privileged-access-workstations)\r\n###Â 3)Â Implement Multi-Factor Authentication\r\nðŸ’¡Â [Plan an Azure AD Multi-Factor Authentication deployment](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-getstarted)\r\n###Â 4)Â Supervise Maintenance Personnel\r\nðŸ’¡Â [Deploy Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-deployment-plan)\r\n###Â 5)Â Label Sensitive Data\r\nðŸ’¡Â [Quickstart: Create a new Azure Information Protection label for specific users (PIM)](https://docs.microsoft.com/en-us/azure/information-protection/quickstart-label-specificusers)\r\n###Â 6)Â Protect Sensitive Data\r\nðŸ’¡Â [Azure facilities, premises, and physical security](https://docs.microsoft.com/en-us/azure/security/fundamentals/physical-security)\r\n###Â 7)Â Limit Access to Sensitive Data\r\nðŸ’¡Â [Quickstart: Create a new Azure Information Protection label for specific users](https://docs.microsoft.com/en-us/azure/information-protection/quickstart-label-specificusers)\r\n###Â 8)Â Protect Sensitive Data in Transit\r\nðŸ’¡Â [Quickstart: Set and retrieve a secret from Azure Key Vault using the Azure portal](https://docs.microsoft.com/en-us/azure/key-vault/quick-create-portal)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "DocumentationÂ &Â Guides: MA/MP",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing a Maintenance & Media Protection Architecture with Microsoft Azure ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.1.118",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Sanitize or Destroy Information System Media Containing Federal Contract Information Before Disposal or Release for Reuse (ML-1) \r\n###Â CMMCÂ Guidance\r\nIn this case, â€œmediaâ€ can mean something as simple as paper, or storage devices like diskettes, disks, tapes, microfiche, thumb drives, CDs and DVDs, and even mobile phones. It is important to see what information is on these types of media. If there is Federal contract information (FCI)â€”information you or your company got doing work for the Federal government that is not shared publicly)â€”you or someone in your company should do one of two things before throwing the media away:\r\n\r\n\tâ€¢ Clean or purge the information, if you want to reuse the device\r\n\tâ€¢ Shred or destroy the device so it cannot be read\r\n\r\nSee NIST Special Publication 800-88 Revision 1, Guidelines for Media Sanitization for more information.\r\n\r\n###Â Microsoft RecommendationÂ Â \r\nSecure FCI with Azure Encryption Capabilities. Delete the Key Encryption Key (KEK) for Cryptographic Erasure of data. Data destruction: When customers delete data or leave Azure, Microsoft follows strict standards for overwriting storage resources before their reuse, as well as the physical destruction of decommissioned hardware. Microsoft executes a complete deletion of data on customer request and on contract termination. âœ³ï¸ [Get Started with Key Vault](https://azure.microsoft.com/en-us/services/key-vault/)\r\n###Â NavigateÂ \r\nMicrosoft References Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Key Hierarchy](https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-atrest#key-hierarchy)\r\nðŸ’¡Â [Data Protection](https://docs.microsoft.com/en-us/azure/security/fundamentals/protection-customer-data#data-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.vii\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.3\r\n\tâ€¢ NIST CSF v1.1 PR.DS-3\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-6\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Secure FCI with Azure Encryption Capabilities. Delete the Key Encryption Key (KEK) for Cryptographic Erasure of Data\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/media/delete-resource-group/delete-resource.pngÂ Â \"Deletion\")Â "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "MA.1.118",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.2.111",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Perform Maintenance on Organizational Systems (ML-2)\r\n###Â CMMCÂ Guidance\r\nPerform maintenance on your machines. This includes:\r\n\tâ€¢ Corrective maintenance (e.g., repairing problems with the technology)\r\n\tâ€¢ Preventative maintenance (e.g., updates to prevent potential problems)\r\n\tâ€¢ Adaptive maintenance (e.g., changes to the operative environment)\r\n\tâ€¢ Perfective maintenance (e.g., improve operations)\r\n###Â Microsoft RecommendationÂ \r\nManage Platform Updates with Virtual Machines Maintenance Control\r\n###Â NavigateÂ \r\nVirtual Machines > Edit Columns > Maintenance - Scheduled Windows / Self-Service Window\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Handling Planned Maintenance Notifications Using the Azure Portal](https://docs.microsoft.com/en-us/azure/virtual-machines/maintenance-notifications-portal)\r\nðŸ’¡Â [Managing Platform Updates with Maintenance Control](https://docs.microsoft.com/en-us/azure/virtual-machines/maintenance-control?toc=/azure/virtual-machines/linux/toc.json&bc=/azure/virtual-machines/linux/breadcrumb/toc.json)\r\nðŸ’¡Â [Scheduling Maintenance Updates with Maintenance Control and Azure Functions](https://github.com/Azure/azure-docs-powershell-samples/tree/master/maintenance-auto-scheduler)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.7.1\r\n\tâ€¢ NIST CSF v1.1 PR.MA-1\r\n\tâ€¢ CERT RMM v1.2 TM:SG5.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 MA-2\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Manage Platform Updates with Virtual Machines Maintenance Control\r\n![ImageÂ Name](https://github.com/Azure/azure-docs-powershell-samples/raw/master/maintenance-auto-scheduler/images/run_function.pngÂ Â \"Scheduling Maintenance Updates with Maintenance Control and Azure Functions\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MA.2.111",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.2.112",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Provide Controls on Tools, Techniques, Mechanisms, and Personnel for Systems Maintenance (ML-2)\r\n###Â CMMCÂ Guidance\r\nProtect the tools used to perform maintenance. They must remain secure so they donâ€™t introduce software viruses or other bugs into your system. Protect your maintenance processes so they arenâ€™t used to hurt your network. Supervise the people responsible for maintenance activities. Make sure they donâ€™t behave in a malicious manner.\r\n###Â Microsoft RecommendationÂ \r\nControl Maintenance Operations with Privileged Access Workstations (PAW)\r\n###Â NavigateÂ \r\nðŸ’¡Â [Privileged Access Workstations](https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/privileged-access-workstations)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Active Directory Administrative Tier Model](https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.7.2\r\n\tâ€¢ NIST CSF v1.2 PR.MA-1\r\n\tâ€¢ CERT RMM v1.2 TM:SG5.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 MA-3\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control Maintenance Operations with Privileged Access Workstations (PAW)Maintenance (ML-2)\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows-server/identity/media/privileged-access-workstations/pawfig8.jpgÂ Â \"Privileged Access Workstations\")Â \r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MA.2.112",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.2.113",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Require Multi-Factor Authentication For Non-Logical Maintenance (ML-2)\r\n###Â CMMCÂ Guidance\r\nNonlocal maintenance activities must use multifactor authentication. Multifactor authentication requires at least two things to prove who the user says he is. One thing can be something you have, such as a device that generates a one-time passcode. Another thing can be something you know, for example, a password or passphrase. Or, another thing can be something specific to you, such as a fingerprint. Requiring two or more things to prove your identity increases the security of the connection. Nonlocal maintenance activities are activities conducted from external network connections. After nonlocal maintenance activities are complete, shut down the external network connection.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Active Directory to Apply Role Based Access Control & Multi-Factor Authentication for Maintenance Activities\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Users > Multi Factor Authentication\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Plan an Azure AD Multi-Factor Authentication Deployment](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-getstarted)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.7.5\r\n\tâ€¢ NIST CSF v1.1 PR.MA-2\r\n\tâ€¢ CERT RMM v1.2 TM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 MA-4\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where TimeGenerated > ago(90d)\r\n| where RecommendationName == \"MFA should be enabled on accounts with write permissions on your subscription\" or RecommendationName == \"MFA should be enabled on accounts with read permissions on your subscription\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by RecommendationName\r\n| render timechart \r\n\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender for Servers: MFA Recommendations by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MA.2.113",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.2.114",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Supervise Maintenance Activities of Personnel (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou must supervise everyone who performs maintenance activities. Sometimes a person without proper permissions has to perform maintenance on your machines. Give that individual a logon that is active only once or for a very limited time, to limit system access.\r\n###Â Microsoft RecommendationÂ \r\nControl Admin Activities During Maintenance with Azure Active Directory: Privileged Identity Management (PIM)\r\n###Â NavigateÂ \r\nAzure Active Directory > Identity Governance > Privileged Identity Management\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Deploy Azure AD Privileged Identity Management (PIM)](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-deployment-plan)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.7.6\r\n\tâ€¢ CERT RMM v1.2 TM:SG5.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 MA-5\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control Admin Activities During Maintenance with Azure Active Directory: Privileged Identity Management (PIM)\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series6-SuperviseMaintenancePersonnel1.pngÂ Â \"PIM\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 143",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MA.2.114",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.3.115",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Ensure equipment removed for off-site maintenance is sanitized of any CUI (ML-3) \r\n###Â CMMCÂ Guidance\r\nSanitization is a process that makes access to data infeasible on media such as a hard drive. The process may overwrite the entire media with a fixed pattern such as binary zeros. In addition to clearing the data an organization could purge (e.g., degaussing, secure erasing, or disassembling) the data, or even destroy the media (e.g., incinerating, shredding, or pulverizing). By performing one of these activities the data is extremely hard to recover, thus ensuring its confidentiality.\r\n\r\nIf additional guidance on which specific sanitization actions should be taken on any specific type of media, consider reviewing the description of the Purge actions given in NIST SP 800-88 Revision 1 â€“ Guidelines for Media Sanitization.\r\n\r\n###Â Microsoft RecommendationÂ Â \r\nSecure CUI with Azure Encryption Capabilities. Delete the Key Encryption Key (KEK) for Cryptographic Erasure of data during offsite maintenance. Data destruction: When customers delete data or leave Azure, Microsoft follows strict standards for overwriting storage resources before their reuse, as well as the physical destruction of decommissioned hardware. Microsoft executes a complete deletion of data on customer request and on contract termination. âœ³ï¸ [Get Started with Key Vault](https://azure.microsoft.com/en-us/services/key-vault/)\r\n###Â NavigateÂ \r\nSee Microsoft References Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Key Hierarchy](https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-atrest#key-hierarchy)\r\nðŸ’¡Â [Data Protection](https://docs.microsoft.com/en-us/azure/security/fundamentals/protection-customer-data#data-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.7.3\r\n\tâ€¢ CERT RMM v1.2 TM:SG5.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 MA-2\r\n\t\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Secure CUI with Azure Encryption Capabilities. Delete the Key Encryption Key (KEK) for Cryptographic Erasure of Data During Offsite Maintenance\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/media/delete-resource-group/delete-resource.pngÂ Â \"Deletion\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "MA.3.115",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MA.3.1116",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Check Media Containing Diagnostic and Test Programs for Malicious Code Before the Media are Used in Organizational Systems (ML-3) \r\n###Â CMMCÂ Guidance\r\nAs part of troubleshooting a vendor may provide a diagnostic application to install on a system. The vendor is using the application to help identify the cause of issues on the system. As this is executable code there is a chance that the file is corrupt or infected with malicious code. Implement procedures to scan any files prior to installation. The same level of scrutiny must be made as with any file a staff member may download.\r\n###Â Microsoft RecommendationÂ Â \r\nUse Microsoft Endpoint Configuration Manager to Scan Diagnostic Application Media. âœ³ï¸ [Get Started with Microsoft Endpoint Manager](https://www.microsoft.com/en-us/microsoft-365/microsoft-endpoint-manager)\r\n###Â NavigateÂ \r\nMicrosoft Endpoint Manager > Endpoint Security > Antivirus > Select Asset > Full Scan\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Use Microsoft Endpoint Configuration Manager to Run a Scan](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/run-scan-microsoft-defender-antivirus#use-microsoft-endpoint-configuration-manager-to-run-a-scan)\r\nðŸ’¡Â [Custom Scan a USB Drive](https://gallery.technet.microsoft.com/Custom-scan-a-USB-drive-17b9be2a)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.7.4\r\n\tâ€¢ NIST SP 800-53 Rev 4 MA-3(2)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Microsoft Endpoint Configuration Manager to Scan Diagnostic Application Media\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/images/mem-antivirus-scan-on-demand.pngÂ Â \"Use Microsoft Endpoint Configuration Manager to run a scan\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "MA.3.1116",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.3.122",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Mark Media with Necessary CUI Markings and Distribution Limitations (ML-3)\r\n###Â CMMCÂ Guidance\r\nAll media (e.g., USB drives, CDs, DVDs, diskettes, hard drives, and paper) must be properly marked to alert individuals to the presence of Controlled Unclassified Information (CUI)stored on the media. Since the media itself may be small and provide limited space to mark it you should at a minimum mark it as â€œControlledâ€ or CUIâ€ and the designating agency. If the media is hard to mark alternate methods may be approved to indicate the presence of CUI. For example, a company may place a CUI banner on the desktop background image or monitor attached to the system. They could also require the user to accept a banner message stating CUI may be present on the system.\r\n###Â Microsoft RecommendationÂ \r\nLabel/Control Logical Data with Azure Information Protection\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· InformationProtectionLogs_CL (Azure Information Protection) âœ³ï¸ [Get Started with Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/)\r\n###Â NavigateÂ \r\nAzure Information Protection > Labels\r\n###Â MicrosoftÂ ReferenceÂ \r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Information Protection (AIP) Labeling, Classification, and Protection](https://docs.microsoft.com/en-us/azure/information-protection/aip-classification-and-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.4\r\n\tâ€¢ NIST CSF v1.1 PR.PT-2\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP4\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-3\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Logs = InformationProtectionLogs_CL\r\n| extend MachineName_s = columnifexists(\"MachineName_s\",\"\"), ObjectId_s = columnifexists(\"ObjectId_s\",\"\"), Activity_s = columnifexists(\"Activity_s\",\"\"), LabelId_g = columnifexists(\"LabelId_g\",\"\"), Protected_b = columnifexists(\"Protected_b\",false);\r\nlet minTime = toscalar(Logs\r\n| where isnotempty(MachineName_s)\r\n| summarize min(TimeGenerated));\r\nlet dates = range [\"date\"] from bin(minTime, 1d) to now() step 1d;\r\nLogs\r\n| where isnotempty(MachineName_s)\r\n| summarize labels=countif(isnotempty(ObjectId_s) and Activity_s in (\"NewLabel\", \"UpgradeLabel\", \"DowngradeLabel\", \"RemoveProtection\", \"NewProtection\", \"ChangeProtection\") and isnotempty(LabelId_g)), protected=countif(isnotempty(ObjectId_s) and Activity_s in (\"NewLabel\", \"UpgradeLabel\", \"DowngradeLabel\", \"RemoveProtection\", \"NewProtection\", \"ChangeProtection\") and Protected_b) by bin(TimeGenerated, 1d)\r\n| join kind= rightouter\r\n(\r\ndates\r\n)\r\non $left.TimeGenerated == $right.[\"date\"]\r\n| project [\"date\"], Labels = coalesce(labels, 0), [\"Protected Labels\"] = coalesce(protected, 0)",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Information Protection Label Activity by TIme",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "chartSettings": {
                "showLegend": true
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "MP.3.122",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.2.119",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Protect System Media Containing Federal Contract Information (ML-2)\r\n###Â CMMCÂ Guidance\r\nPhysical CUI includes two types of items:\r\n\tâ€¢ Hardcopy (e.g., paper, microfilm)\r\n\tâ€¢ Digital devices (e.g., CD drives, flash drives, video)\r\nYou should store physical CUI in a secure location. This location should be accessible only to those people with the proper permissions. All who access CUI should follow the process for checking out and returning it.\r\n###Â Microsoft RecommendationÂ \r\nReview Azure Physical Security Controls\r\n###Â NavigateÂ \r\nSee Microsoft Reference Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/en-us/azure/security/fundamentals/physical-security)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.1\r\n\tâ€¢ NIST CSF v1.1 PR.PT-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-4"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Physically Protect CUI Data in a Secure Location\r\n![ImageÂ Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE4q5jn?ver=25d1&q=90&m=6&h=431&w=767&b=%23FFFFFFFF&l=f&o=t&aim=trueÂ Â \"Physical Security Controls\")Â "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MP.2.119",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.2.120",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Limit Access to CUI on System Media to Authorized Users (ML-2)\r\n###Â CMMCÂ Guidance\r\nLimit physical access to CUI to people permitted to access CUI. Use locked or controlled storage areas and limit access to only those allowed to access CUI. Keep track of who accesses physical CUI in some sort of record.\r\n###Â Microsoft RecommendationÂ \r\nLabel/Control Controlled Unclassified Infromation with Azure Information Protection. âœ³ï¸ [Get Started with Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/)\r\n###Â NavigateÂ \r\nAzure Information Protection > Labels\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Information Protection (AIP) Labeling, Classification, and Protection](https://docs.microsoft.com/en-us/azure/information-protection/aip-classification-and-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.2\r\n\tâ€¢ CIS Controls v7.1 14.6\r\n\tâ€¢ NIST CSF v1.1 PR.PT-2\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP4\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-2\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Label/Control Controlled Unclassified Infromation with Azure Information Protection\r\nCreate Controlled Unclassified Information Labels and Policy with Azure Information Protection\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series6-LimitAccessSensitiveData-1024x826.pngÂ Â \"Create a new Azure Information Protection label for specific users\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MP.2.120",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.2.121",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Control the Use of Removable Media on System Components (ML-2) \r\n###Â CMMCÂ Guidance\r\nRemovable media is any type of media storage that you can remove from your computer or machine, for example, CDs, DVDs, diskettes and USB drives. Write a specific policy for removable media for your company. The policy should cover that there are two types of removable media: write-once media and rewritable media. Limit the use of removable media to the smallest number needed. Scan all removable media for viruses. Track removable media that you own and make sure you reuse and dispose of it properly.\r\n###Â Microsoft RecommendationÂ Â \r\nControl Portable Storage Devices with Microsoft Intune\r\n### Required Log (Log Source)\r\nðŸ”· Event (Windows 10) âœ³ï¸ [Get Started with Microsoft Intune](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/microsoft-intune)\r\n###Â NavigateÂ \r\nAzure > Intune > Device Configuration > Profiles > Create Profile > Configure > General > Removable Storage \r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Control USB Devices and Other Removable Media Using Microsoft Intune](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/control-usb-devices-using-intune)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.7\r\n\tâ€¢ CIS Controls v7.1 13.7, 13.8\r\n\tâ€¢ NIST CSF v1.1 PR.PT-2\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP4\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-7\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control USB devices and Other Removable Media using Microsoft Intune\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/images/general-settings.pngÂ Â \"How to control USB devices and other removable media using Microsoft Defender for Endpoint\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Event\r\n| where EventID in (2003, 2004, 2006, 2010, 2100, 2101, 2105, 2106)\r\n| order by TimeGenerated desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Windows Event Logs for Removeable Media Events",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 86400000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "MP.2.121",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.3.123",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Prohibit the Use of Portable Storage Devices When Such Devices Have No Identifiable Owner (ML-3) \r\n###Â CMMCÂ Guidance\r\nA portable storage device is a small hard drive or solid state device that is designed to hold various types of data. It typically plugs into a laptop or desktop port (e.g., USB port). Due to the small size of the device they can be easily lost. This makes the portable storage device an attractive tool to hack an organization. Since the device can hold any type of file it could contain an executable or document that a staff member opens to determine who owns the portable storage device Therefore, an organization should prohibit use if it cannot trace the device to an owner.\r\n###Â Microsoft RecommendationÂ Â \r\nLeverage Microsoft Defender for Endpoint & Microsoft Intune to Prohibit Rogue USB Devices:\r\n\r\n\tâ€¢ Prevent installation of specifically prohibited peripherals\r\n\tâ€¢ Allow installation and usage of specifically approved peripherals with matching device instance IDs\r\n\tâ€¢ Prevent installation and usage of specifically prohibited peripherals with matching device instance IDs\r\n\tâ€¢ Block untrusted and unsigned processes on USB peripherals\r\n\tâ€¢ Protect against Direct Memory Access (DMA) attacks\r\n\t\r\n###Â NavigateÂ \r\nAzure > Intune > Device configuration > Profiles > Create Profile > Profile Type: Device Restrictions\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Control USB Devices and Other Removable Media using Microsoft Defender for Endpoint](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/control-usb-devices-using-intune#prevent-installation-of-specifically-prohibited-peripherals)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.8\r\n\tâ€¢ NIST CSF v1.1 PR.PT-2\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP4\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-7(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Endpoint & Microsoft Intune to Prohibit Rogue USB Devices\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/images/baselines.pngÂ Â \"Rogue USB\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "MP.3.123",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.3.124",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Control Access to Media Containing CUI and Maintain Accountability for Media During Transport Outside of Controlled Areas (ML-3) \r\n###Â CMMCÂ Guidance\r\nProtection of Controlled Unclassified Information (CUI) is applicable to physical and digital formats. Physical control can be accomplished using traditional concepts like restricted access to physical locations or locking papers in a desk or filing cabinet. The digitization of data makes access to CUI much easier. CUI can be stored and transported on magnetic disks, tapes, USB drives, CD-ROMs, and so on. This makes digital CUI data very portable. As a result of the portability it is important for an organization to apply mechanisms to prevent unauthorized access to CUI.\r\n###Â Microsoft Recommendation\r\nLeverage Azure Information Protection to Classify/Protect CUI at Rest and In-Transit âœ³ï¸ [Get Started with Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/)\r\n###Â NavigateÂ \r\nAzure Information Protection > Classifications > Labels > Set Permissions for Documents & Emails Containing This Label\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.5\r\n\tâ€¢ NIST CSF v1.1 PR.PT-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-5\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Information Protection to Classify/Protect CUI at Rest and In-Transit\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/information-protection/media/info-protect-protection-bar-configured.pngÂ Â \"AIP Configuration\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "MP.3.124",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "MP.3.125",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Implement Cryptographic Mechanisms to Protect Confidentiality of CUI in Transit (ML-3)\r\n###Â CMMCÂ Guidance\r\nCUI can be stored and transported on a variety of media like magnetic disks, tapes, USB drives, CD-ROMs, and so on. This makes digital CUI data very portable. The portability increases the chance that the media is lost. When identifying the paths CUI flows through your organization, identify devices to include in this practice.\r\nTo mitigate the risk of losing or exposing CUI an organization should implement an encryption scheme to protect the data. Even if the media is lost the fact that it is properly encrypted renders the data inaccessible to other people. When encryption is not an option, alternative physical safeguards should be applied during transport.\r\n###Â Microsoft RecommendationÂ \r\nReview/Implement Azure Defender for Servers Recommendations for Encryption of Data in Transit\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Recommendations > Encrypt Data in Transit\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Remediate Recommendations in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.6\r\n\tâ€¢ CIS Controls v7.1 13.9\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 MP-5(4)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Web Application should only be accessible over HTTPS\" or RecommendationName == \"Function App should only be accessible over HTTPS\" or RecommendationName == \"IoT Devices - TLS cipher suite upgrade needed\" or RecommendationName == \"Secure transfer to storage accounts should be enabled\" or RecommendationName == \"TLS should be updated to the latest version for your web app\" or RecommendationName == \"TLS should be updated to the latest version for your function app\" or RecommendationName == \"FTPS should be required in your function App\" or RecommendationName == \"FTPS should be required in your web App\"\r\n|Â make-seriesÂ count()Â default=0Â onÂ TimeGeneratedÂ fromÂ ago(90d)Â toÂ now()Â stepÂ 1dÂ byÂ RecommendationName\r\n|Â renderÂ timechartÂ \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender for Servers Encryption in Transit Recommendations by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Maintenance & Media Protection (MA/MP)"
            },
            "name": "query - 151",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Maintenance & Media Protection (MA/MP)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "MP.3.125",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": ""
      },
      "name": "text - 136"
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Personnel Security (PS)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Personnel Security (PS)"
      },
      "name": "text - 153 - Copy - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nPersonnel Security is focused on controlling human access to systems, networks, and assets. Personnel Security includes considerations for screening individuals with access to Controlled Unclassified Information (CUI) and protection of such data after personnel actions such as terminations or transfers. TheÂ Personnel SecurityÂ ControlÂ familyÂ includesÂ 7Â controls which varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ informationÂ onÂ CMMCÂ Personnel SecurityÂ requirements, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Personnel Security (PS)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "text - 189",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "### CMMC: Personnel Security (Management Controls)\r\n| PS MC ML |\r\n|:-------------Â |:-------------|:-----|\r\n|Â CMMCÂ |Â RequirementsÂ |Â Maturity LevelÂ |\r\n| PS-MC-ML.2.999 | Establish a policy that includes Personnel Security (PS). | Maturity Level (ML2) |\r\n| PS-MC-ML.2.998 | Document the CMMC practices to implement the Personnel Security (PS) policy. | Maturity Level (ML2) |\r\n| PS-MC-ML.3.997 | Establish, maintain and resource a plan that includes Personnel Security (PS). | Maturity Level (ML3) |\r\n| PS-MC-ML.4.996 | Review and measure Personnel Security (PS) activities for effectiveness. | Maturity Level (ML4) |\r\n| PS-MC-ML.5.995 | Standardize and optimize a documented approach for Personnel Security (PS) across all applicable organizational units. | Maturity Level (ML5) |",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Personnel Security (PS)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Personnel Security (PS)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Personnel SecurityÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 2\r\n|Â Personnel SecurityÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â PS.2.127Â | Screen individuals prior to authorizing access to organizational systems containing CUI. | \r\n|Â ML-2Â |Â PS.2.128Â | Ensure that organizational systems containing CUI are protected during and after personnel actions such as terminations and transfers. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Personnel Security (PS)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CMMC Personnel SecurityÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 2",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Physical Protection (PE)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Physical Protection (PE)"
      },
      "name": "text - 153 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nPhysical Protections are focused on protecting direct access to systems, networks, and assets. Physical protection includes considerations for limiting physical access, escorting visitors, maintaining visit audit logs, monitoring infrastructure, and protecting Controlled Unclassified Information (CUI). TheÂ Physical ProtectionÂ ControlÂ familyÂ includesÂ 11Â controls which varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ informationÂ onÂ CMMCÂ Physical ProtectionÂ requirements, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "text - 190",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Physical ProtectionÂ (IncludedÂ inÂ Workbook)\r\n|Â Physical ProtectionÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-1Â |Â PE.1.131Â |Â Â Limit physical access to organizational information systems, equipment and the respective operating environments to authorized individuals. Â |\r\n|Â ML-1Â |Â PE.1.132Â |Â Â Escort visitors and monitor visitor activity. Â |Â \r\n|Â ML-1Â |Â PE.1.133Â |Â Â Maintain audit logs of physical access. Â |Â \r\n|Â ML-1Â |Â PE.1.134Â |Â Â Control and manage physical access devices. Â |Â Â \r\n|Â ML-2Â |Â PE.2.135Â |Â Â Protect and monitor the physical facility and support infrastructure for organizational systems. Â |Â Â \r\n|Â ML-3Â |Â PE.3.136Â |Â Â Enforce safeguarding measures for CUI at alternate work sites. Â |Â Â \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Physical ProtectionÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "### CMMC: Physical Protection (Management Controls)\r\n| PE MC ML |\r\n|:-------------Â |:-------------|:-----|\r\n|Â CMMCÂ |Â RequirementsÂ |Â Maturity LevelÂ |\r\n| PE-MC-ML.2.999 | Establish a policy that includes Physical Protection (PE). | Maturity Level (ML2) |\r\n| PE-MC-ML.2.998 | Document the CMMC practices to implement the Physical Protection (PE) policy. | Maturity Level (ML2) |\r\n| PE-MC-ML.3.997 | Establish, maintain and resource a plan that includes Physical Protection (PE). | Maturity Level (ML3) |\r\n| PE-MC-ML.4.996 | Review and measure Physical Protection (PE) activities for effectiveness. | Maturity Level (ML4) |\r\n| PE-MC-ML.5.995 | Standardize and optimize a documented approach for Physical Protection (PE) across all applicable organizational units. | Maturity Level (ML5) |",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Microsoft Azure Security Controls Aligned to CMMC: Physical Protection (Management Controls)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "PE.1.131",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Limit Physical Access to Organizational Information Systems to Authorized Individuals (ML-1) \r\n###Â CMMCÂ Guidance\r\nThink about what parts of your physical space (e.g., office, plant, factory), what equipment, including the network, need to be protected from physical contact. For those parts of your company to which you want only specific employees to have physical access, monitor or limit who is able to enter those spaces with badges, key cards, etc.\r\n###Â NavigateÂ \r\nSee Microsoft Refences Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/en-us/azure/security/fundamentals/physical-security)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.viii\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.10.1\r\n\tâ€¢ NIST CSF v1.1 PR.AC-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 PE-2\r\n\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Limit Physical Access to Organizational Information Systems to Authorized Individuals\r\n![ImageÂ Name](https://stp-api-cdn-prod.azureedge.net/api/Images/e5724a10-491a-11e8-9fe5-75d16dd56b03?hash=7AC632B242A298BFB2E2CFF3968117CFDA3A33AB0A50B1FCBD565C0F6D1DBCB6Â Â \"Physical Security Controls\")Â \r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "PE.1.131",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "PE.1.132",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Escort Visitors and Monitor Visitor Activity (ML-1) \r\n###Â CMMCÂ Guidance\r\nDo not allow visitors, even those people you know well, to walk around your facility without an escort. Make sure that all non-employees wear special visitor badges and/or are escorted by an employee at all times while on your property.\r\n###Â NavigateÂ \r\nSee Microsoft Refences Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/en-us/azure/security/fundamentals/physical-security)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 Partial b.1.ix\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.10.3\r\n\tâ€¢ CERT RMM v1.2 AM:SG1.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 PE-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Escort Visitors and Monitor Visitor Activity\r\n![ImageÂ Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE4q5jn?ver=25d1&q=90&m=6&h=431&w=767&b=%23FFFFFFFF&l=f&o=t&aim=trueÂ Â \"Physical Security Controls\")Â \r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "PE.1.132",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "PE.1.133",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Maintain Audit Logs of Physical Access (ML-1) \r\n###Â CMMCÂ Guidance\r\nMake sure you have a record of who is accessing both your facility (e.g., office, plant, factory) and your equipment. You can do this in writing by having employees and visitors sign in and sign out as they enter and leave your physical space, and by keeping a record of who is coming and going from the facility.\r\n###Â NavigateÂ \r\nSee Microsoft Refences Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Facilities, Premises, and Physical Security](https://docs.microsoft.com/en-us/azure/security/fundamentals/physical-security)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 Partial b.1.ix\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.10.4\r\n\tâ€¢ NIST SP 800-53 Rev 4 PE-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Maintain Audit Logs of Physical Access\r\n![ImageÂ Name](https://c.s-microsoft.com/en-us/CMSImages/homepage_Landing_Header_Image.jpg?version=61160c90-dc82-b15c-3d2c-625de8aea87aÂ Â \"Physical Security Controls\")Â \r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "PE.1.133",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "PE.1.134",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Maintain Audit Logs of Physical Access (ML-1) \r\n###Â CMMCÂ Guidance\r\nControlling physical access devices like locks, badging, key cards, etc. is just as important as monitoring and limiting who is able to physically access certain equipment. Locks, badges, and key cards are only strong protection if you know who has them and what access they allow.\r\n###Â NavigateÂ \r\nSee Microsoft Refences Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Management and Operation of the Azure Production Network](https://docs.microsoft.com/en-us/azure/security/fundamentals/infrastructure-operations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 Partial b.1.ix\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.10.5\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 PE-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Control and Manage Physical Access Devices\r\n![ImageÂ Name](https://stp-api-cdn-prod.azureedge.net/api/Images/e5724a10-491a-11e8-9fe5-75d16dd56b03?hash=7AC632B242A298BFB2E2CFF3968117CFDA3A33AB0A50B1FCBD565C0F6D1DBCB6Â Â \"Physical Security Controls\")Â \r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "PE.1.134",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "PE.2.135",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Protect and Monitor the Physical Facility and Support Infrastructure for Organizational Systems (ML-2) \r\n###Â CMMCÂ Guidance\r\nMake sure that the infrastructure inside of your facility, such as power and network cables, is protected so that visitors and employees cannot access it. The protection also has to be monitored. This can be done with security guards, video cameras, sensors and alarms.\r\n###Â NavigateÂ \r\nSee Microsoft Refences Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Infrastructure Availability](https://docs.microsoft.com/en-us/azure/security/fundamentals/infrastructure-availability)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.10.2\r\n\tâ€¢ NIST CSF v1.1 PR.AC-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 PE-6\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Protect and Monitor the Physical Facility and Support Infrastructure for Organizational Systems\r\n![ImageÂ Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE4q5jn?ver=25d1&q=90&m=6&h=431&w=767&b=%23FFFFFFFF&l=f&o=t&aim=trueÂ Â \"Physical Security Controls\")Â \r\n\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "PE.2.135",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "PE.3.136",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Enforce Safeguarding Measures for CUI at Alternate Work Sites (ML-3) \r\n###Â CMMCÂ Guidance\r\nMost organizations focus on securing their corporate network and devices. Today many organizations have mobile staff who work from home or travel as part of their job. This means the organization needs to define and implement safeguards to account for protection of information beyond the enterprise perimeter. Safeguards may include physical protections, such as locked file drawers, as well as electronic protections.\r\n###Â NavigateÂ \r\nSee Microsoft Refences Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Azure Customer Data Protection](https://docs.microsoft.com/en-us/azure/security/fundamentals/protection-customer-data)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.10.6\r\n\tâ€¢ CERT RMM v1.2 EC:SG2.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 PE-17\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Datacenters: Enforce Safeguarding Measures for CUI at Alternate Work Sites\r\n![ImageÂ Name](https://azurecomcdn.azureedge.net/cvt-64e07773f8d636e00820edb64eb4a314afce18f3223952c2a0e1b4171e93eab3/images/shared/regions-map-desktop.svgÂ Â \"Physical Security Controls\")Â \r\n\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Physical Protection (PE)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "PE.3.136",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Recovery & Risk Management (RE/RM)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Recovery & Risk Management (RE/RM)"
      },
      "name": "Recovery & Risk Management (RE/RM) - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nRecovery ManagementÂ includes processes and procedures aligned to recovering from a disaster and ensuring business continuity. Risk Management ensures a consistent approach to the identification, mitigation, and response to security risks. TheÂ Recovery & Risk ManagementÂ ControlÂ familiesÂ includeÂ 10Â controls for Recovery Management and 17 controls for Risk Management. These controls have varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: Recovery & Risk Management](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-recovery-risk-management-7-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Recovery & Risk Management (RE/RM)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Recovery & Risk ManagementÂ (IncludedÂ inÂ Workbook)\r\n|Â RecoveryÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â | RE.2.137Â | Regularly perform and test data back-ups.  | \r\n|Â ML-2Â | RE.2.138Â | Protect the confidentiality of backup CUI at storage locations.  | \r\n|Â ML-5Â | RE.5.140Â |  Ensure information processing facilities meet organizationally-defined information security continuity, redundancy and availability requirements. | \r\n\r\n|Â Risk ManagementÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â RM.2.141Â |  Periodically assess the risk to organizational operations (including mission, functions, image or reputation), organizational assets and individuals, resulting from the operation of organizational systems and the associated processing, storage or transmission of CUI.   |\r\n|Â ML-2Â |Â RM.2.142Â |  Scan for vulnerabilities in organizational systems and applications periodically and when new vulnerabilities affecting those systems and applications are identified.   |\r\n|Â ML-2Â |Â RM.2.143Â | Remediate vulnerabilities in accordance with risk assessments.    |\r\n|Â ML-4Â |Â RM.4.149Â |  Catalog and periodically update threat profiles and adversary Tactics, Techniques & Procedures (TTPs).  |\r\n|Â ML-4Â |Â RM.4.150Â |  Employ threat intelligence to inform the development of the system and security architectures, selection of security solutions, monitoring, threat hunting and response and recovery activities.   |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Recovery & Risk ManagementÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Recovery & Risk Management in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Recovery & Risk Management\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series7-BigTable-1133x1536.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ RE/RMÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Recovery & Risk Management",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Recovery & Risk ManagementÂ Management?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC Recovery Maturity (RE-MC) and Risk Management Maturity (RM-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include recovery & risk management (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization.\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series7-AdminControlsTable.pngÂ Â \"CustomerÂ Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Recovery & Risk ManagementÂ Management?",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for Recovery & Risk Management in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing a Recovery & Risk Management Architecture with Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 8 Steps to CMMC for Recovery & Risk Management Maturity with Microsoft Azure\r\nMicrosoftÂ Azure has developed an 8-step process to facilitate recovery & risk management with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate recovery & risk management including ðŸ’¡[Azure Backup](https://azure.microsoft.com/en-us/services/backup/), ðŸ’¡[Azure Defender for Servers](https://azure.microsoft.com/en-us/services/security-center/), ðŸ’¡[Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/), andðŸ’¡[Microsoft Graph Security API](https://www.microsoft.com/en-us/security/business/graph-security-api).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series7-8Steps-768x390.pngÂ Â \"8 Steps to CMMC for Recovery & Risk Management Maturity with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "8 Steps to CMMC for Recovery & Risk Management Maturity with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Perform Regular Backups\r\nðŸ’¡Â [What is the Azure Backup service?](https://docs.microsoft.com/en-us/azure/backup/backup-overview)\r\n###Â 2)Â Protect Backups\r\nðŸ’¡Â [Use Azure role-based access control to manage Azure Backup recovery points](https://docs.microsoft.com/en-us/azure/backup/backup-rbac-rs-vault)\r\n###Â 3)Â Validate Backup Facilities\r\nðŸ’¡Â [Azure facilities, premises, and physical security](https://docs.microsoft.com/en-us/azure/security/fundamentals/physical-security)\r\nðŸ’¡Â [Azure global infrastructure](https://azure.microsoft.com/en-us/global-infrastructure/)\r\nðŸ’¡Â [Encryption of data in transit](https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-overview#encryption-of-data-in-transit)\r\n###Â 4)Â Assess Risk Posture\r\nðŸ’¡Â [Secure score in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-secure-score)\r\n###Â 5)Â Conduct Vulnerability Scanning\r\nðŸ’¡Â [Azure Defender's integrated vulnerability assessment solution for Azure and hybrid machines](https://docs.microsoft.com/en-us/azure/security-center/built-in-vulnerability-assessment)\r\n###Â 6)Â Catalog Threat Profiles\r\nðŸ’¡Â [Threat hunting: Why your SOC needs a proactive hunting team](https://www.microsoft.com/security/blog/2020/03/10/threat-hunting-part-1-why-your-soc-needs-a-proactive-hunting-team/)\r\n###Â 7)Â Leverage Threat Intelligence\r\nðŸ’¡Â [Bring your threat intelligence to Azure Sentinel](https://techcommunity.microsoft.com/t5/azure-sentinel/bring-your-threat-intelligence-to-azure-sentinel/ba-p/1167546)\r\n###Â 8)Â Remediate Vulnerabilities\r\nðŸ’¡Â [Use Azure Security Center recommendations to enhance security](https://docs.microsoft.com/en-us/azure/security-center/security-center-using-recommendations)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "DocumentationÂ &Â Guides: RE/RM",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing a Recovery & Risk Management Architecture with Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RE.2.137",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Regularly Perform & Test Backups (ML-2)\r\n###Â CMMCÂ Guidance\r\nBack up your organizational data so you can recover it if a hardware failure, software failure, or malware infection occurs. You can schedule backups to run automatically or manually. Many operating systems include a built-in feature to perform data backups.\r\n\r\nAfter you create a backup, it is important to test it on a regular basis. When you test a backup, verify that the operating system, applications, and data are intact and functional. If you test data backups regularly, you will be in a better position to recover systems and files more efficiently if a failure or infection occurs.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Backups & Recovery Services Vault to Perform/Test Backups. âœ³ï¸ [Get Started with Azure Backup](https://azure.microsoft.com/en-us/services/backup/)\r\n###Â NavigateÂ \r\n\tâ€¢ Backup Vaults\r\n\tâ€¢ Recovery Services Vaults\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [What is the Azure Backup Service?](https://docs.microsoft.com/en-us/azure/backup/backup-overview)\r\nðŸ’¡Â [Recovery Services Vaults Overview](https://docs.microsoft.com/en-us/azure/backup/backup-azure-recovery-services-vault-overview)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CIS Controls v7.1 10.1, 10.3\r\n\tâ€¢ NIST CSF v1.1 PR.IP-4\r\n\tâ€¢ CERT RMM v1.2 KIM:SG6.SP1\r\n\tâ€¢ NIST 800-53 Rev 4 CP-9\r\n\tâ€¢ AU ACSC Essential Eight\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Backups & Recovery Services Vault to Perform/Test Backups\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/backup/media/backup-overview/azure-backup-overview.pngÂ Â \"Azure Backup Service\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "text - 159",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "RE.2.137",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RE.2.138",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Protect Confidentiality of Backup CUI at Storage Locations (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou protect the confidentiality of information to ensure that it remains private and unchanged. Methods to ensure confidentiality may include:\r\n\r\n\tâ€¢ Encrypting files\r\n\tâ€¢ Managing who has access to the information\r\n\tâ€¢ Physically securing devices and media that contains CUI\r\n\tâ€¢ Managing the use of information\r\nStorage locations for information are varied, and may include:\r\n\r\n\tâ€¢ External hard drives\r\n\tâ€¢ USB flash drives\r\n\tâ€¢ Disc media (e.g., CD, DVD, Blu-Ray)\r\n\tâ€¢ Networked Attached Storage (NAS)\r\n\tâ€¢ Cloud backup\r\n\tâ€¢ FTP, FTP Secure, SFTP\r\n###Â Microsoft RecommendationÂ \r\nProtect Backup Confidentiality with Azure Backup & Recovery Services Vault âœ³ï¸ [Get Started with Azure Site Recovery](https://azure.microsoft.com/en-us/services/site-recovery/)\r\n###Â NavigateÂ \r\n\tâ€¢ Backup Vault > Properties\r\n\tâ€¢ Recovery Services Vault > Properties\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Soft delete for Azure Backup](https://docs.microsoft.com/en-us/azure/backup/backup-azure-security-feature-cloud)\r\nðŸ’¡Â [Azure Storage encryption for data at rest](https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.8.9\r\n\tâ€¢ CERT RMM v1.2 MON:SG2.SP4\r\n\tâ€¢ NIST 800-53 Rev 4 CP-9\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Protect Backup Confidentiality with Azure Backup & Recovery Services Vault\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/backup/media/backup-azure-security-feature-cloud/disable-soft-delete.pngÂ Â \"Backup Protection\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "RE.2.138",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RE.5.140",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Ensure Information Processing Facilities Meet Organizationally Defined Information Security Continuity, Redundancy, and Availability Requirements (ML-5) \r\n###Â CMMCÂ Guidance\r\nThis practice requires an organization to do what is needed in order for their cybersecurity solutions to continue to function under stress or attack. This means that even if a solution that helps protect the environment has a failure, then other mechanisms will fill in the gap in order for the functionality to continue. Redundant components can help with this as well as proper planning and implementation. If a firewall fails, make sure another firewall can take its place, or the environment should fail closed preventing traffic from passing until the problem can be fixed. By having redundancy in place, an organization may continue operations with confidence knowing their cyber security mission is functioning properly, and the components will continue to operate properly even when failures may be taking place\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Availability Zones for Security Control Redundancy\r\n###Â NavigateÂ \r\nAvailability Sets\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Building Solutions for High Availability Using Availability Zones](https://docs.microsoft.com/en-us/azure/architecture/high-availability/building-solutions-for-high-availability)Â \r\nðŸ’¡Â [Azure Infrastructure Availability](https://docs.microsoft.com/en-us/azure/security/fundamentals/infrastructure-availability)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST CSF v1.1 PR.IP-9\r\n\tâ€¢ CERT RMM v1.2 RRM:SG1.SP2\r\n\tâ€¢ NIST 800-53 Rev 4 CP-10\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Availability Zones for Security Control Redundancy\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/architecture/high-availability/images/high-availability-001.pngÂ Â \"Azure infrastructure availability\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "text - 159 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "RE.5.140",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RM.2.141",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Periodically Assess Risk to Organizational Operations, Assets, Individuals for Processing, Storage, Transmission of CUI (ML-2)\r\n###Â CMMCÂ Guidance\r\nRisk arises from anything that can reduce an organizationâ€™s assurance of mission/business success; cause harm to image or reputation; or harm individuals, other organizations, or the Nation.Organizations should assess the risk to their operations and assets at regular intervals. Areas where weakness or vulnerabilities could lead to risk may include:\r\n\r\n\tâ€¢ Poorly designed and executed business processes\r\n\tâ€¢ Inadvertent actions of people, such as disclosure or modification of information\r\n\tâ€¢ Intentional actions of people, such as insider threat and fraud\r\n\tâ€¢ Failure of systems to perform as intended\r\n\tâ€¢ Failures of technology\r\n\tâ€¢ External events, such as natural disasters, public infrastructure and supply chain failures\r\nAn organization can perform a formal or an informal risk assessment. In a formal risk assessment, you use established criteria and procedures. Formal risk assessments are documented. It is important to note that risk assessments differ from vulnerability assessments (See RM.2.142). A vulnerability assessment provides input to a risk assessment along with other information such as results from likelihood analysis and analysis of potential treat sources.\r\n###Â Microsoft RecommendationÂ \r\nAssess Risk Posture with Azure Defender for Servers: Secure Score\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Secure Score > Select Subscription\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Secure score in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-secure-score)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.11.1\r\n\tâ€¢ NIST CSF v1.1 ID.RA-1, ID.RA-4, DE.AE-4, RS.MI-3\r\n\tâ€¢ CERT RMM v1.2 RISK:SG4\r\n\tâ€¢ NIST SP 800-53 Rev 4 RA-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| make-series count() default=0 on DiscoveredTimeUTC from ago(30d) to now() step 1d by RecommendationSeverity",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender Secure Score Recommendation Count by Severity",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "timechart",
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "Medium",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "High",
                    "color": "redBright"
                  },
                  {
                    "seriesName": "Low",
                    "color": "blueDark"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "RM.2.141",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RM.2.142",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Scan for Vulnerabilities in Organizational Systems and Applications (ML-2)\r\n###Â CMMCÂ Guidance\r\nA vulnerability scanner is an application that identifies an organizationâ€™s asset vulnerabilities for which the scanner is capable of identifying. Then, the scanner creates a prioritized list of asset vulnerabilities ordered by their level of severity. The scanner also describes each vulnerability and the steps needed to fix it. Your organization should scan for vulnerabilities on all devices connected to the network. This includes servers, desktops, laptops, virtual machines, containers, firewalls, switches, and printers. All assets that have any form of connection to a wired network, Wi-Fi environment, and air-gapped labs that are associated with the CMMC assessment should be scanned.\r\n\r\nOrganizations that develop custom software should perform reviews of the software. Vulnerability analysis of a custom-made solution requires an experienced penetration testerto properly test and validate findings. Automated vulnerability scanners do not necessarily perform well against custom developed applications.\r\n\r\nThe vulnerability scanning process should be a regular activity. It should not be a single occurrence. Organizations should put in place a vulnerability scanner that updates its database each time it performs a scan. This means that the scan looks for the most current vulnerabilities. Schedule scans with consideration of the potential for impact to normal operations. Use caution when scanning critical assets. These assets do need to be scanned, but some scanning options could cause a denial of service against a critical asset. You could replicate the critical asset in a test environment and perform vulnerability scans against the replicated asset. The replicated asset vulnerability scan will produce valid reports that need to be applied to the production system only if the replicated system is an exact duplicate of the production system and has identical functionality in operation when being tested.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Defender for Servers for Vulnerability Management\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityBaseline (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\n\tâ€¢  Microsoft Defender Security Center > Threat Vulnerability Management\r\n\tâ€¢  Azure Defender for Servers (Security Center) > Recommendations > Remediate Vulnerabilities\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Threat and Vulnerability Management Walk-Through](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/next-gen-threat-and-vuln-mgt)\r\nðŸ’¡Â [Azure Defender's Integrated Vulnerability Assessment Solution for Azure and Hybrid Machine](https://docs.microsoft.com/en-us/azure/security-center/built-in-vulnerability-assessment)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.11.2\r\n\tâ€¢ CIS Controls v7.1 3.1, 3.2\r\n\tâ€¢ NIST CSF v1.1 ID.RA-1\r\n\tâ€¢ CERT RMM v1.2 VAR:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 RA-5\r\n\t\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n|project CceId, RuleSeverity, Description, Resource, ResourceType, ComputerEnvironment, BaselineType\r\n|limit 50",
              "size": 0,
              "showAnalytics": true,
              "title": "Priority Securty Baseline Vulnerabilities",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RuleSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "â€‹Informational",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Resource",
                    "formatter": 0,
                    "formatOptions": {
                      "aggregation": "Count"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CceId"
                  },
                  {
                    "columnId": "RuleSeverity",
                    "label": ""
                  },
                  {
                    "columnId": "Description"
                  },
                  {
                    "columnId": "Resource"
                  },
                  {
                    "columnId": "ResourceType"
                  },
                  {
                    "columnId": "ComputerEnvironment"
                  },
                  {
                    "columnId": "BaselineType"
                  }
                ]
              },
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "Medium",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "High",
                    "color": "redBright"
                  },
                  {
                    "seriesName": "Low",
                    "color": "blueDark"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "RM.2.142",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RM.4.149",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Update Threat Profiles/Adversary Tactics, Techniques, Procedures (ML-4)\r\n###Â CMMCÂ Guidance\r\nThis practice enables organizations to proactively increase their ability to include the adversary perspective in their cybersecurity planning and incident response. Organizations should know that setting up a security perimeter around their enterprise is no longer enough to keep that enterprise protected against the adversaries of today. Understanding the adversaries TTPs, and documenting how these techniques could be used against an organization is one of the first steps needed in order to keep the adversaries at bay. If an adversary gains access to an organizationâ€™s enterprise, knowledge of their actions, what their standard operating procedures are, and what they may be going after can be a key part in eradicating them from your enterprise. See practice IR.4.100 for use of this information.\r\n###Â Microsoft RecommendationÂ \r\nCatalog Threat TTPs in the MITRE ATT&CK Framework with Azure Sentinel Hunting\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SentinelGithub (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > Hunting\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Threat Hunting: Why Your SOC Needs a Proactive Hunting Team](https://www.microsoft.com/security/blog/2020/03/10/threat-hunting-part-1-why-your-soc-needs-a-proactive-hunting-team/)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST CSF v1.1 DE.AE-2\r\n\tâ€¢ CERT RMM v1.2 VAR:SG2.SP1\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "letÂ SentinelGithubÂ =Â (externaldata(MITREMatrix:Â string,Â Tactic:Â string,Â TechniqueId:string,Â TechniqueName:string,Â Platform:Â stringÂ ,Â DetectionType:Â stringÂ ,Â DetectionService:Â stringÂ ,Â DetectionId:Â string,Â DetectionName:Â string,Â DetectionDescription:Â string,Â ConnectorId:Â string,Â DataTypes:Â string,Â Query:Â stringÂ ,Â QueryFrequency:Â stringÂ ,Â QueryPeriod:stringÂ ,Â TriggerOperator:Â string,Â TriggerThreshold:Â string,Â DetectionSeverity:Â string,Â DetctionUrl:Â string,Â IngestedDate:Â stringÂ )\r\n[@\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/MITRE%20ATT%26CK/AzureSentinel.csv\"]\r\n);\r\nSentinelGithub\r\n|Â whereÂ isnotempty(Tactic)\r\n|Â extendÂ TacticÂ =Â iff(Tactic==\"PrivilegeÂ Escalation\",\"PrivilegeEscalation\",Tactic)\r\n|Â extendÂ TacticÂ =Â iff(Tactic==\"Persistance\",\"Persistence\",Tactic)\r\n|Â extendÂ TacticÂ =Â iff(Tactic==\"CommmandAndControl\",\"CommandAndControl\",Tactic)\r\n|Â extendÂ TacticÂ =Â iff(Tactic==\"DefenseÂ Evasion\",\"DefenseEvasion\",Tactic)\r\n|Â extendÂ TacticÂ =Â iff(TacticÂ inÂ (\"IntialAccess\",\"InitalAccess\"),\"InitialAccess\",Tactic)\r\n|Â summarizeÂ Count=dcount(DetectionId)Â byÂ Tactic\r\n|Â sortÂ byÂ CountÂ desc\r\n| render barchart",
              "size": 0,
              "showAnalytics": true,
              "title": "Observed Threat Actions by Tactic Category (MITRE ATT&CK Framework)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RuleSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "â€‹Informational",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Resource",
                    "formatter": 0,
                    "formatOptions": {
                      "aggregation": "Count"
                    }
                  }
                ]
              },
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "Medium",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "High",
                    "color": "redBright"
                  },
                  {
                    "seriesName": "Low",
                    "color": "blueDark"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "RM.4.149",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RM.4.150",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ Threat Intelligence For Development of Security Architectures, Selection of Security Solutions, Monitoring, Threat Hunting, Response, & Recovery Activities (ML-4)\r\n###Â CMMCÂ Guidance\r\nThreat intelligence (See RM.4.149 and SA.3.169) provides for an organization with a better understanding of the adversaries and their TTPs. This understanding helps an organization plan, design, architect, and integrate solutions in a manner that will help thwart adversary activities. This understanding should be used to design the enterprise architecture as well as the endpoint monitoring capabilities and to plan threat hunting actions. Threat intelligence can be very valuable when an organization is building their defensive playbook. Having defensive response and recovery actions planned prior to an attack taking place is key to having efficient and timely defensive cyber operation actions.\r\n\r\nPractice IR.4.100 requires a similar use of adversary knowledge for incident response and execution.\r\n###Â Microsoft RecommendationÂ \r\nEmploy Threat Intelligence with Azure Sentinel for Development of Security Architectures\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· ThreatIntelligenceIndicator (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Sentinel > Threat Intelligence\r\n\tâ€¢ Azure Sentinel > Data Connectors > Threat Intelligence Platforms\r\n\tâ€¢ Azure Sentinel > Data Connectors > Threat Intelligence TAXII\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Bring Your Threat Intelligence to Azure Sentinel](https://techcommunity.microsoft.com/t5/azure-sentinel/bring-your-threat-intelligence-to-azure-sentinel/ba-p/1167546)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ Draft NIST SP 800-171B 3.11.1e\r\n\tâ€¢ NIST CSF v1.1 ID.RA-2, ID.RA-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n| summarize CountOfIndicators = count() by SourceSystem, bin(TimeGenerated, 1h)\r\n| render barchart kind=stacked",
              "size": 0,
              "showAnalytics": true,
              "title": "Threat Intelligence Ingestion by Source",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RuleSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "â€‹Informational",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Resource",
                    "formatter": 0,
                    "formatOptions": {
                      "aggregation": "Count"
                    }
                  }
                ]
              },
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "Medium",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "High",
                    "color": "redBright"
                  },
                  {
                    "seriesName": "Low",
                    "color": "blueDark"
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "RM.4.150",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "RM.2.143",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Remediate Vulnerabilities In Accordance With Risk Assessments (ML-2)\r\n###Â CMMCÂ Guidance\r\nReview the prioritized list of vulnerabilities generated from the vulnerability scanner. Not all vulnerabilities may affect an organization the same. Review the risks of not remediating the discovered vulnerabilities. The organization should build upon the prioritized list and develop a prioritized mitigation plan for closing the vulnerabilities identified and track their completion.\r\n###Â Microsoft RecommendationÂ \r\nRemediate Vulnerabilities with Azure Defender Recommendations âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender (Security Center) > Recommendations\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Secure Score in Azure Defender](https://docs.microsoft.com/en-us/azure/security-center/secure-score-security-controls)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.11.3\r\n\tâ€¢ CIS Controls v7.1 3.7\r\n\tâ€¢ NIST CSF v1.1 RS.MI-3\r\n\tâ€¢ CERT RMM v1.2 VAR:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 RA-5\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Remediate Vulnerabilities with Azure Defender for Servers Recommendations\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/security-center/media/secure-score-security-controls/score-on-recommendations-page.pngÂ Â \"Azure Defender for Servers: Recommendations\")\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Recovery & Risk Management (RE/RM)"
            },
            "name": "text - 173",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Recovery & Risk Management (RE/RM)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "RM.2.143",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â Security Assessment & Situational Awareness (CA/SA)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Security Assessment & Situational Awareness (CA/SA)"
      },
      "name": "Security Assessment & Situational Awareness (CA/SA)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nSecurity Assessment includes periodic evaluation of security controls for effectiveness. Situational Awareness is grounded in cyber threat intelligence programs including ingestion, reporting, and sharing. TheÂ Security Assessment & Situational AwarenessÂ ControlÂ familiesÂ includeÂ 13Â controls for Security Assessment and 8 controls for Situational Awareness. These controls have varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: Security Assessment & Situational Awareness](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-security-assessment-situational-awareness-8-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Security Assessment & Situational Awareness (CA/SA) - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Security Assessment & Situational AwarenessÂ (IncludedÂ inÂ Workbook)\r\n|Â Security AssessmentÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â CA.2.158  |  Periodically assess the security controls in organizational systems to determine if the controls are effective in their application.  |\r\n|Â ML-3Â |Â CA.3.161  |  Monitor security controls on an ongoing basis to ensure the continued effectiveness of the controls.  |\r\n|Â ML-4Â |Â CA.4.164  |  Conduct penetration testing periodically, leveraging automated scanning tools and ad hoc tests using human experts.  |\r\n|Â ML-4Â |Â CA.4.227  |  Periodically perform red teaming against organizational assets in order to validate defensive capabilities  |\r\n\r\n|Â Situational AwarenessÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-3Â |Â  SA.3.169 |  Receive and respond to cyber threat intelligence from information sharing forums and sources and communicate to stakeholders.  |\r\n|Â ML-4Â |Â  SA.4.171 |  Establish and maintain a cyber threat hunting capability to search for Indicators of Compromise (IoC) in organizational systems and detect, track and disrupt threats that evade existing controls.  |\r\n|Â ML-4Â |Â  SA.4.173 |  Design network and system security capabilities to leverage, integrate and share Indicators of Compromise (IoC).  |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "CMMC Security Assessment & Situational AwarenessÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for Security Assessment & Situational Awareness in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Security Assessment & Situational Awareness\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series8-BigTable-909x1024.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ CA/SAÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â Security Assessment & Situational Awareness",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Security Assessment & Situational Awareness?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC Security Assessment (CA-MC) and Situational Awareness Maturity (SA-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include security assessment & situational awareness (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization. \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series8-AdminControlsTable.pngÂ Â \"CustomerÂ Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ Security Assessment & Situational Awareness?",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for Security Assessment & Situational Awareness in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing a Security Assessment & Situational Awareness Architecture Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 7 Steps to CMMC for Security Assessment & Situational Awareness with Microsoft Azure\r\nMicrosoftÂ Azure has developed a 7-step process to facilitate security assessment & situational awareness with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate security assessment & situational awareness including ðŸ’¡[Azure Defender for Servers](https://azure.microsoft.com/en-us/services/security-center/), ðŸ’¡[Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/),ðŸ’¡[Azure Blueprints](https://azure.microsoft.com/en-us/services/blueprints/), andðŸ’¡[Microsoft Graph Security API](https://www.microsoft.com/en-us/security/business/graph-security-api).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series8-7Steps-768x365.pngÂ Â \"7 Steps to CMMC for Security Assessment & Situational Awareness with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "7 Steps to CMMC for Security Assessment & Situational Awareness with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Assess Security Controls\r\nðŸ’¡Â [Get Visibility Into Alerts](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-get-visibility)\r\n###Â 2)Â Monitor Security Controls\r\nðŸ’¡Â [Get Visibility Into Alerts](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-get-visibility)\r\n###Â 3)Â Leverage Scanning Tools\r\nðŸ’¡Â [Penetration Testing Rules of Engagement](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement)\r\nðŸ’¡Â [Penetration testing](https://docs.microsoft.com/en-us/azure/security/fundamentals/pen-testing)\r\nðŸ’¡Â [Azure Marketplace: Security Assessment Apps](https://azuremarketplace.microsoft.com/en-us/marketplace/apps?search=Security%20Assessment&page=1)\r\n###Â 4)Â Perform Penetration Testing\r\nðŸ’¡Â [Red vs. Blue - Internal security penetration testing of Microsoft Azure](https://azure.microsoft.com/en-gb/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/)\r\nðŸ’¡Â [Microsoft Enterprise Cloud: Red Teaming Overview (PDF)](https://download.microsoft.com/download/C/1/9/C1990DBA-502F-4C2A-848D-392B93D9B9C3/Microsoft_Enterprise_Cloud_Red_Teaming.pdf)\r\nðŸ’¡Â [Set up a lab to teach ethical hacking class](https://docs.microsoft.com/en-us/azure/lab-services/class-type-ethical-hacking)\r\n###Â 5)Â Ingest Cyber Threat Data\r\nðŸ’¡Â [Connect data from threat intelligence providers](https://docs.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence)\r\n###Â 6)Â Conduct Threat Hunting\r\nðŸ’¡Â [Hunt for threats with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/hunting#:~:text=Get%20started%20hunting%201%20In%20the%20Azure%20Sentinel,leaving%20the%20hunting%20page.%20...%20More%20items...%20)\r\n###Â 7)Â Share Threat Data\r\nðŸ’¡Â [Microsoft Graph Security API overview](https://docs.microsoft.com/en-us/graph/security-concept-overview)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "DocumentationÂ &Â Guides: CA/SA",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing a Security Assessment & Situational Awareness Architecture Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CA.2.158",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Periodically Assess Security Controls to Determine Effectiveness (ML-2)\r\n###Â CMMCÂ Guidance\r\nAs organizations implement security controls, they should avoid a â€œset it and forget itâ€ mentality. The security landscape is constantly changing. Reassess existing controls at periodic intervals in order to validate their usefulness in organizational systems. This will let you determine if the control is still meeting the needs of the organization. Set the assessment schedule according to organizational needs. Consider regulatory obligations and internal policies when assessing the controls.\r\n\r\nTypical outputs of the practice include:\r\n\r\n\tâ€¢ Documented assessment results\r\n\tâ€¢ Proposed new controls, or updates to existing controls\r\n\tâ€¢ Remediation plans\r\n\tâ€¢ New identified risks\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel Workbooks to Assess Security Controls to Determine Effectiveness\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityAlert (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Office 365) âœ³ï¸ [Get Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Identity) âœ³ï¸ [Get Microsoft Defender for Identity](https://www.microsoft.com/en-us/microsoft-365/security/identity-defender)\r\n###Â NavigateÂ \r\nAzure Sentinel > Workbooks > Security Alerts\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Get Visibility Into Alerts](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-get-visibility)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.12.1\r\n\tâ€¢ NIST CSF v1.1 DE.DP-3\r\n\tâ€¢ NIST SP 800-53 Rev 4 CA-2\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where TimeGenerated > ago(90d)\r\n| where isnotempty(ProviderName)\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by ProviderName, VendorName\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Security Alert Source Count by Time (90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "CA.2.158",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CA.3.161",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Monitor Security Controls on Ongoing Basis to Ensure Continued Effectiveness (ML-3)\r\n###Â CMMCÂ Guidance\r\nYou should provide a plan for monitoring and assessing the state of security controls on a recurring basis that occurs more frequently than the periodic assessments discussed in CA.2.158. This process provides a mechanism to assess the overall security posture of your organization. As a result the process not only maintains awareness of vulnerabilities and threats, but also informs management of the effectiveness of the security controls in determining if security controls are current and for management to make an acceptable risk decision.\r\n###Â Microsoft RecommendationÂ \r\nMonitor Security Controls for Efficiency with Azure Sentinel\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityAlert (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Office 365) âœ³ï¸ [Get Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Identity) âœ³ï¸ [Get Microsoft Defender for Identity](https://www.microsoft.com/en-us/microsoft-365/security/identity-defender)\r\n###Â NavigateÂ \r\nAzure Sentinel > Workbooks > Security Alerts\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Get Visibility Into Alerts](https://docs.microsoft.com/en-us/azure/sentinel/quickstart-get-visibility)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.12.3\r\n\tâ€¢ NIST CSF v1.1 PR.IP-7, DE.DP-5\r\n\tâ€¢ CERT RMM v1.2 MON:SG1.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 CA-7\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by ProviderName",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Security Controls for Efficiency (Alert Source Count by Time)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "CA.3.161",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CA.4.164",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Conduct Penetration Testing Periodically, Leveraging Automated Scanning Tools and Human Experts (ML-4)\r\n###Â CMMCÂ Guidance\r\nThis practice focuses on performing penetration testing (pentesting) against organizational solutions in order to identify vulnerabilities and weaknesses. Pentesting is a crucial component to help identify vulnerabilities in solutions as well as help identify flaws in systems under development and production systems. By performing penetration testing an organization can utilize the findings as feedback for development teams to utilize while planning system patching and mitigation strategies. Pentesting teams should have full access to documentation and source code (if developed in-house) of the solutions being tested prior to running attacks. An adversary will attempt to gain full knowledge about a system prior to attacking it; this will increase their likelihood of success. The adversary does this over a period of time, which includes research, recon, and gaining an understanding about the solution prior to launching an attack. The organization should allow a pentest team to have full knowledge of the solution prior to attacking it in order to perform better vulnerability analysis against it. The findings from the pentesting team effort should be used to help build mitigation plans for the solution, which may include modification to source code, design changes, as well as architecture changes. Overall, pentesting should help identify issues that should be fixed in order to increase the overall security posture of the solution. Penetration testing can be performed by an in-house team or a trusted third party. Penetration testing of different adversary types should be conducted over time.\r\n###Â Microsoft RecommendationÂ \r\nConduct Penetration Testing per Organizational Policy and Requirements. \r\n###Â NavigateÂ \r\nMicrosoft Reference Documentation (Below)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Penetration Testing Rules of Engagement](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement)\r\nðŸ’¡Â [Penetration Testing](https://docs.microsoft.com/en-us/azure/security/fundamentals/pen-testing)\r\nðŸ’¡Â [Azure Marketplace: Security Assessment Apps](https://azuremarketplace.microsoft.com/en-us/marketplace/apps?search=Security%20Assessment&page=1)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of Draft NIST SP 800-171B 3.12.1e\r\n\tâ€¢ CIS Controls v7.1 20.2\r\n\tâ€¢ NIST SP 800-53 Rev 4 CA-8\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Marketplace: Security Assessment\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series8-LeverageScanningTool1-768x476.pngÂ Â \"Azure Marketplace: Security Assessment Tools\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "text - 185",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "CA.4.164",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "CA.4.227",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Periodically Perform Red Teaming Against Organizational Assets To Validate Defensive Capabilities (ML-4)\r\n###Â CMMCÂ Guidance\r\nThis practice focuses on red teaming an organization for the purpose of validating defensive cyber capabilities focusing on identifying or thwarting attacks. As the red team performs tests against the organization the red team is also working with the organizationâ€™s cyber defender(s) in order to help validate the defensive capabilities against the attacks used. This is a completely transparent relationship where the red team works with the organizationâ€™s cyber defenders in order to identify areas that need improvement. While large corporations may have internal teams perform this testing, a lot of small companies will lack the in-house expertise to perform red teaming properly. Third-party adversarial assessment teams can be used in this case. Rules of engagement will need to be generated prior to testing in order to define the bounds of the testing, and to make sure test teams know to what levels they may perform testing and making sure the in-bound assets are defined. The red team and cyber defense teams need to keep in mind that they are working together to find gaps, identify misconfigurations, and help improve the cyber defenses of the organization.\r\n\r\nRed teams are typically asked to test environments from outside the enterprise and work their way in. It is recommended to allow red teams to perform testing from inside the environment as well, acting as if the outer perimeter protections have been breached, even if they are considered secure. The best results will be achieved when the red team is given the architectural knowledge of the environment being tested. When completed, the organization should have a better understanding of any cyber defense shortfalls, and be able to prioritize implementing changes as needed.\r\n###Â Microsoft Recommendation\r\nConduct Red-Teaming Per Organizational Policy & Requirements\r\n###Â NavigateÂ \r\nMicrosoft Reference Documentation (Below)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Red vs. Blue - Internal Security Penetration Testing of Microsoft Azure](https://azure.microsoft.com/en-gb/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/)\r\nðŸ’¡Â [Microsoft Enterprise Cloud: Red Teaming Overview (PDF)](https://download.microsoft.com/download/C/1/9/C1990DBA-502F-4C2A-848D-392B93D9B9C3/Microsoft_Enterprise_Cloud_Red_Teaming.pdf)\r\nðŸ’¡Â [Setup a Lab for Ethical Hacking](https://docs.microsoft.com/en-us/azure/lab-services/class-type-ethical-hacking)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 20.3\r\n\tâ€¢ NIST SP 800-53 Rev 4 CA-8(2)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Conduct Red-Teaming Per Organizational Policy & Requirements\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/sentinel/media/qs-get-visibility/map.pngÂ Â \"Azure Sentinel: Malicious Traffic\")\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "text - 185 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "CA.4.227",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SA.3.169",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Receive & Respond to Cyber Threat Intelligence From Information Sharing Forums & Communicate to Stakeholders (ML-3)\r\n###Â CMMCÂ Guidance\r\nTo enhance situational awareness activities within the organization, leverage external sources for cybersecurity threat information. Establish a relationship with external organizations, or periodically survey relevant sources, to ensure you are receiving up-to-date threat intelligence information pertinent to your organization. Examples of sources include: US-CERT, various critical infrastructure sector ISACs, ICS-CERT, industry associations, vendors, and federal briefings.\r\nThreat information is reviewed and, if applicable to your organization, communicated to the appropriate stakeholders for action.\r\n###Â Microsoft RecommendationÂ \r\nManage Cyber Threat Intelligence with Azure Sentinel: Threat Intelligence Platforms / Threat Intelligence TAXII\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· ThreatIntelligenceIndicator (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Sentinel > Data Connectors > Threat Intelligence \r\n\tâ€¢ Azure Sentinel > Threat Intelligence\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Connect data from threat intelligence providers](https://docs.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST CSF v1.1 ID.RA-2\r\n\tâ€¢ NIST SP 800-53 Rev 4 PM-16\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n| where TimeGenerated < now()\r\nand ExpirationDateTime > now()\r\nand Active == true\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| summarize CountOfIndicators = count() by SourceSystem\r\n| order by CountOfIndicators desc \r\n| render barchart kind=unstacked",
              "size": 0,
              "showAnalytics": true,
              "title": "Cyber Threat Intelligence Indicator Counts (Active: Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SA.3.169",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SA.4.171",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Establish & Maintain a Cyber Threat Hunting Capability to Search for Indicators of Compromise & Detect, Track, Disrupt Threats That Evade Existing Controls (ML-4)\r\n###Â CMMCÂ Guidance\r\nIn the cyber arena of today, adversaries are increasingly successful at getting into networks and maintaining their access. Adversaries may be in your network from an attack that happened years ago. In order to find adversaries in an enterprise an organization must perform hunting for the latest TTPs used by the adversaries. In order to do this an organization stands up a threat hunting team or contracts for one that uses a variety of methods, such as log analysis, network traffic analysis, and threat intelligence in order to look for indications that adversaries have been on a system (and may continue to be in place). Once found, the threat hunting team must act quickly to remove the problem, report the incident up the command chain, and continue to look for other pieces of evidence that an adversary has been within the environment. This information could be as simple as a file hash, IP address of the command and control server, a domain name, or the actions that have happened on a system. All of these items can be rolled into an indicator sharing component for others to ingest and benefit.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel Hunting & Azure Sentinel Threat Intelligence to Establish Cyber Threat Hunting Capabilities\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· ThreatIntelligenceIndicator (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\r\n\tâ€¢  Azure Sentinel > Hunting\r\n\tâ€¢  Azure Sentinel > Threat Intelligence\r\n\tâ€¢  Azure Sentinel > Data Connectors > Threat Intelligence Platforms / Threat Intelligence TAXII\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Hunt for Threats with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/hunting)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ Draft NIST SP 800-171B 3.11.2e\r\n\tâ€¢ NIST CSF v1.1 DE.CM-1, DE.CM-2, DE.CM-3, DE.CM-4, DE.CM-5, DE.CM-6, DE.CM.7, DE.CM-8\r\n\tâ€¢ NIST SP 800-53 Rev 4 PM-16\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator \r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by ThreatType\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Threat Intelligence Indicators Count by Threat Type (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "ThreatType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SA.4.171",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SA.4.173",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Design Network & System Security Capabilities to Leverage, Integrate, and Share Indicators of Compromise (ML-4)\r\n###Â CMMCÂ Guidance\r\nMost cyber-defense solutions provide an API (Application Programming Interface) that allows an organization to automate updates to solutions for IoC blocking, hunting, or other mitigation. By automating the process, the organization will remove the likelihood of a human mistyping an entry, and it greatly reduces the time for insertion into the security solution as compared to manual entry.\r\n###Â Microsoft RecommendationÂ \r\nIngest & Share Indicators of Compromise with Azure Sentinel Threat Intelligence & Graph Security API\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Sentinel > Threat Intelligence\r\n\tâ€¢ Azure Sentinel > Data Connectors > Threat Intelligence Platforms / Threat Intelligence TAXII\r\n\tâ€¢ Microsoft Graph Security API\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Import Threat Intelligence into Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/import-threat-intelligence)\r\nðŸ’¡Â [Microsoft Graph Security API overview](https://docs.microsoft.com/en-us/graph/security-concept-overview)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-4(24)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Ingest & Share Indicators of Compromise with Azure Sentinel Threat Intelligence & Graph Security API\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/graph/images/security-overview-diagram-1.pngÂ Â \"Microsoft Graph Security API\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "Security Assessment & Situational Awareness (CA/SA)"
            },
            "name": "text - 193",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SA.4.173",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Security Assessment & Situational AwarenessÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 2\r\n|Â Security Assessment & Situational AwarenessÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-2Â |Â CA.2.157Â | Develop, document and periodically update System Security Plans (SSPs) that describe system boundaries, system environments of operation, how security requirements are implemented and the relationships with or connections to other systems. | \r\n|Â ML-2Â |Â CA.2.159Â | Develop and implement plans of action (e.g., POA&M) designed to correct deficiencies and reduce or eliminate vulnerabilities in organizational systems. | \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "customWidth": "100",
      "name": "CMMC Security Assessment & Situational AwarenessÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 2",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Security Assessment & Situational AwarenessÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3\r\n|Â Security Assessment & Situational AwarenessÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-3Â |Â CA.3.162Â |Â Employ a security assessment of enterprise software that has been developed internally, for internal use, and that has been organizationally-defined as an area of risk. \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level ",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "customWidth": "100",
      "name": "CMMC Security Assessment & Situational AwarenessÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC Security Assessment & Situational AwarenessÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 4\r\n|Â Security Assessment & Situational AwarenessÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-4Â |Â CA.4.163Â |Â Create, maintain and leverage a security strategy and roadmap for organizational cybersecurity improvement. | \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Security Assessment & Situational Awareness (CA/SA)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "customWidth": "100",
      "name": "CMMC Security Assessment & Situational AwarenessÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 4",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â System & Communications Protection (SC)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "System & Communications Protection (SC)"
      },
      "customWidth": "100",
      "name": "System & Communications Protection (SC)",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nSystem & Communications Protection includes network security for administrative and management functions. It focuses on confidentiality for data in transit. TheÂ System & Communications ProtectionÂ ControlÂ familyÂ includesÂ 32Â controls which varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: System & Communications Protection](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-system-communications-protection-9-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "customWidth": "100",
      "name": "System & Communications Protection (SC) - Copy",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC System & Communications ProtectionÂ (IncludedÂ inÂ Workbook)\r\n|Â System & Communications ProtectionÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-1Â |Â SC.1.175Â | Monitor, control and protect organizational communications (e.g., information transmitted or received by organizational information systems) at the external boundaries and key internal boundaries of the information systems.  |\r\n|Â ML-1Â |Â SC.1.176Â | Implement subnetworks for publicly accessible system components that are physically or logically separated from internal networks.  |\r\n|Â ML-2Â |Â SC.2.178Â | Prohibit remote activation of collaborative computing devices and provide indication of devices in use to users present at the device.Â Â | \r\n|Â ML-2Â |Â SC.2.179Â | Use encrypted sessions for the management of network devices.Â Â | \r\n|Â ML-3Â |Â SC.3.177Â | Employ FIPS-validated cryptography when used to protect the confidentiality of CUI.Â | \r\n|Â ML-3Â |Â SC.3.180Â |Â Employ architectural designs, software development techniques and systems engineering principles that promote effective information security within organizational systems. | \r\n|Â ML-3Â |Â SC.3.181Â | Separate user functionality from system management functionality.Â | \r\n|Â ML-3Â |Â SC.3.182Â | Prevent unauthorized and unintended information transfer via shared system resources. | \r\n|Â ML-3Â |Â SC.3.183Â | Deny network communications traffic by default and allow network communications traffic by exception (e.g., deny all, permit by exception).Â Â |\r\n|Â ML-3Â |Â SC.3.184Â | Prevent remote devices from simultaneously establishing non-remote connections with organizational systems and communicating via some other connection to resources in external networks (e.g., split tunneling).Â Â |\r\n|Â ML-3Â |Â SC.3.185Â | Â Implement cryptographic mechanisms to prevent unauthorized disclosure of CUI during transmission unless otherwise protected by alternative physical safeguards.Â |  \r\n|Â ML-3Â |Â SC.3.186Â |Â Terminate network connections associated with communications sessions at the end of the sessions or after a defined period of inactivity. |  \r\n|Â ML-3Â |Â SC.3.187Â | Establish and manage cryptographic keys for cryptography employed in organizational systems.Â Â | \r\n|Â ML-3Â |Â SC.3.188Â |Â Control and monitor the use of mobile code. | \r\n|Â ML-3Â |Â SC.3.189Â |Â Control and monitor the use of Voice over Internet Protocol (VoIP) technologies. |\r\n|Â ML-3Â | SC.3.190Â |Â Protect the authenticity of communications sessions. |  \r\n|Â ML-3Â |Â SC.3.191Â | Â Protect the confidentiality of CUI at rest.Â |\r\n|Â ML-3Â |Â SC.3.192Â |Â Implement Domain Name System (DNS) filtering services.| \r\n|Â ML-4Â |Â SC.4.197Â |Â Employ physical and logical isolation techniques in the system and security architecture and/or and where deemed appropriate by the organization. | \r\n|Â ML-4Â |Â SC.4.199Â | Utilize threat intelligence to proactively block DNS requests from reaching malicious domains. | Â \r\n|Â ML-4Â |Â SC.4.202Â |Â Employ mechanisms to analyze executable code and scripts (e.g., sandbox) traversing Internet network boundaries or other organizationally-defined boundaries. | \r\n|Â ML-4Â |Â SC.4.228Â |Â Isolate administration of organizationally-defined high-value critical network infrastructure components and servers. | \r\n|Â ML-4Â |Â SC.4.229Â |Â Utilize a URL categorization service and implement techniques to enforce URL filtering of websites that are not approved by the organization. | \r\n|Â ML-5Â |Â SC.5.198Â | Â Configure monitoring systems to record packets passing through the organization's Internet network boundaries and other organizational-defined boundaries.Â |  \r\n|Â ML-5Â |Â SC.5.230Â |Â Enforce port and protocol compliance. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "customWidth": "100",
      "name": "CMMC System & Communications ProtectionÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for System & Communication Protection in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â System & Communications Protection\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series9-BigTable-639x1024.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ SCÂ Mapping\")\r\n",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â System & Communications Protection",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ System & Communications Protection?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC System & Communications Protection (SC-MC) are listed here. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include system & communications protection (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization. \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series9-AdminControlsTable.pngÂ Â \"CustomerÂ Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ System & Communications Protection?",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for System & Communication Protection in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing a System & Communication Protection Architecture with Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 11 Steps to CMMC for System & Communications Protection with Microsoft Azure\r\nMicrosoftÂ Azure has developed an 11-step process to facilitate system & communications protection with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate system & communications protection including ðŸ’¡[Azure Defender for Servers](https://azure.microsoft.com/en-us/services/security-center/),ðŸ’¡[Azure Active Directory](https://azure.microsoft.com/en-us/services/active-directory/), ðŸ’¡[Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/),ðŸ’¡[Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/),ðŸ’¡[Network Watcher](https://azure.microsoft.com/en-us/services/network-watcher/), and ðŸ’¡[Azure VPN Gateway](https://azure.microsoft.com/en-us/services/vpn-gateway/).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series9-11Steps-768x448.pngÂ \"11 Steps to CMMC for System & Communications Protection with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "195 - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Secure Collaborative Computing\r\nðŸ’¡Â [Configure Device Registration for Hybrid key trust Windows Hello for Business](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-hybrid-key-trust-devreg)\r\n###Â 2)Â Encrypt Management Sessions\r\nðŸ’¡Â [Privileged Access Workstations](https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/privileged-access-workstations)\r\nðŸ’¡Â [Azure encryption overview](https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-overview)\r\n###Â 3)Â Employ FIPS Validated Encryption\r\nðŸ’¡Â [FIPS 140-2 Validation](https://docs.microsoft.com/en-us/windows/security/threat-protection/fips-140-validation)\r\n###Â 4)Â Separate User/System Functionality\r\nðŸ’¡Â [What are managed identities for Azure resources?](https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview)\r\n###Â 5)Â Prevent Unintended Transfer\r\nðŸ’¡Â [How to configure a label for Rights Management protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-protection)\r\n###Â 6)Â Permit Traffic By Exception\r\nðŸ’¡Â [Tutorial: Deploy and configure Azure Firewall using the Azure portal](https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal)\r\n###Â 7)Â Prevent Split Tunneling\r\nðŸ’¡Â [Configure forced tunneling using the Azure Resource Manager deployment model](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-forced-tunneling-rm)\r\n###Â 8)Â Prevent Unauthorized Disclosure\r\nðŸ’¡Â [How to configure the policy settings for Azure Information Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-settings)\r\n###Â 9)Â Manage Cryptographic Keys\r\nðŸ’¡Â [Quickstart: Set and retrieve a secret from Azure Key Vault using the Azure portal](https://docs.microsoft.com/en-us/azure/key-vault/secrets/quick-create-portal)\r\n###Â 10)Â Protect Confidential Data at Rest\r\nðŸ’¡Â [Explore and manage your resources with asset inventory and management tools](https://docs.microsoft.com/en-us/azure/security-center/asset-inventory)\r\n###Â 11)Â Capture Packets\r\nðŸ’¡Â [Manage packet captures with Azure Network Watcher using PowerShell](https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-packet-capture-manage-powershell#:~:text=Start%20a%20packet%20capture%201%20The%20next%20step,by%20the%20packet%20capture.%20...%20More%20items...%20)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "195 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing a System & Communication Protection Architecture with Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.1.175",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Monitor, Control, and Protect Organizational Communications (i.e., Information Transmitted or Received by Organizational Information Systems) at the External Boundaries and Key Internal Boundaries of the Information Systems (ML-1) \r\n###Â CMMCÂ Guidance\r\nJust as your office or plant has fences and locks for protection from the outside, and uses badges and keycards to keep non-employees out, your companyâ€™s IT network or system has boundaries that must be protected. Many companies use a web proxy and a firewall.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Firewall, Network Security Groups, and Azure Web Application Firewall to Protect Internal/External Boundaries\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AzureDiagnostics (Azure Firewall) âœ³ï¸ [Get Started with Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)\r\n###Â NavigateÂ \r\n\r\n\tâ€¢ Firewalls > Add\r\n\tâ€¢ Create a Resource > Networking > Network Security Group\r\n\tâ€¢ Create a Resource > Networking > Application Gateway > Create WAF Policy\r\n\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal)\r\nðŸ’¡Â [Tutorial: Filter Network Traffic with a Network Security Group Using the Azure Portal](https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic)\r\nðŸ’¡Â [Tutorial: Create an Application Gateway with a Web Application Firewall Using the Azure Portal](https://docs.microsoft.com/en-us/azure/web-application-firewall/ag/application-gateway-web-application-firewall-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.x\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.1\r\n\tâ€¢ NIST CSF v1.1 PR.PT-4\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-7\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let AFTI = AzureDiagnostics \r\n    | where ResourceType == \"AZUREFIREWALLS\"\r\n    | where Resource in~ (split(\"SOC-NS-FW\", \", \"))\r\n    | where OperationName == \"AzureFirewallThreatIntelLog\"\r\n    | summarize Volume=count() by OperationName, bin(TimeGenerated, 12h)\r\n    | project Category=OperationName, Volume, TimeGenerated;\r\nAzureDiagnostics \r\n| where ResourceType == \"AZUREFIREWALLS\"\r\n| where Resource in~ (split(\"SOC-NS-FW\", \", \"))\r\n| where OperationName <> \"AzureFirewallThreatIntelLog\"\r\n| summarize Volume=count() by Category, bin(TimeGenerated, 12h)\r\n| union AFTI\r\n",
              "size": 0,
              "title": "Azure Firewall Events by TIme",
              "timeContext": {
                "durationMs": 86400000
              },
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "SC.1.175",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.1.176",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Implement Subnetworks for Publicly Accessible System Components that are Physically or Logically Separated from Internal Networks (ML-1) \r\n###Â CMMCÂ Guidance\r\nSeparate the publicly accessible systems from the internal systems that need to be protected. Do not place the internal systems on the same network as the publicly accessible systems.\r\n\r\nA network or part of a network that is separated (sometimes physically) from an internal network is called a demilitarized zone (DMZ). A DMZ is a host or part of a network put in a â€œneutral zoneâ€ between an organizationâ€™s internal network (the protected side) and a larger network, like the internet. To separate a subnetwork physically, your company may put in boundary control devices (i.e., routers, gateways, firewalls). This can also be done on a cloud network that can be separated from the rest of the network.\r\n\r\nA DMZ can add an extra layer of security to your companyâ€™s LAN, because an external network node can reach only what is permitted to be accessed in the DMZ.\r\n\r\nPhysical separation might involve a separate network infrastructure, dedicated network equipment with separate LAN segments and a firewall between the internal network and the DMZ segment and a firewall between the DMZ segment and the internet. A logical separation might involve VLAN separation for the DMZ supporting a separate subnet with routing and access controls between subnets.\r\n###Â Microsoft RecommendationÂ \r\nSecure Hybrid Networks with an Azure DMZ (Azure Firewall, Azure Virtual Network Gateways, Network Security Groups, Azure Virtual Networks, Azure Basion)\r\n###Â NavigateÂ \r\nSee Microsoft References Below\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Network DMZ Between Azure and An On-Premises Datacenter](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/dmz/secure-vnet-dmz)Â \r\nðŸ’¡Â [On-Premises Network Connected to Azure Using a VPN Gateway](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/vpn)Â \r\nðŸ’¡Â [Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal)\r\nðŸ’¡Â [Tutorial: Filter Network Traffic with a Network Security Group Using the Azure Portal](https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic)\r\nðŸ’¡Â [What is Azure Bastion?](https://docs.microsoft.com/en-us/azure/bastion/bastion-overview)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.xi\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.5\r\n\tâ€¢ CIS Controls v7.1 14.1\r\n\tâ€¢ NIST CSF v1.1 PR.AC-5\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-7\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Establish a Network DMZ Between Azure and On-Premises Datacenter\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/dmz/images/dmz-private.pngÂ Â \"Azure DMZ\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "SC.1.176",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.2.178",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Prohibit Remote Activation of Collaborative Computing Devices (ML-2)\r\n###Â CMMCÂ Guidance\r\nYou should configure collaborative computing devices so they cannot be activated remotely. Examples of such devices are cameras, microphones, etc. All users should receive a notification when a collaborative computing device is in use. Notification can include an indicator light that turns on when in use, or a specific text window that appears on screen. If a device does not have the means to alert a user when in use, the organization should provide manual means. Manual means can include, as necessary:\r\n\r\n\tâ€¢ Paper notification on entryways\r\n\tâ€¢ Locking entryways when a collaborative computing device is in use\r\n###Â Microsoft RecommendationÂ \r\nControl Collaborative Computing Device Authentication with Windows Hello\r\n###Â NavigateÂ \r\nMicrosoft Refence Documentation (Below)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Configure Device Registration for Hybrid key trust Windows Hello for Business](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-hybrid-key-trust-devreg)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.12\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-15\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control Collaborative Computing Device Authentication with Windows Hello\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/images/event358.pngÂ Â \"Hybrid Windows Hello for Business Provisioning\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "195 - Copy - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "SC.2.178",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.2.179",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Use Encrypted Sessions for Management of Network Devices (ML-2) \r\n###Â CMMCÂ Guidance\r\nWhen an organization connects to and manages network devices, it should use an encrypted session. The most common encrypted method is a Secure Shell (SSH).\r\n###Â Microsoft RecommendationÂ \r\nReview/Implement Azure Defender for Servers Recommendations for Securing Management Ports\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Recommendations > Secure Management Ports\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Remediate recommendations in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 11.5\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Management ports of virtual machines should be protected with just-in-time network access control\" or RecommendationName == \"Management ports should be closed on your virtual machines\" or RecommendationName == \"Internet-facing virtual machines should be protected with network security groups\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by RecommendationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Review/Implement Azure Defender for Servers Recommendations for Securing Management Ports",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "SC.2.179",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.177",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ FIPS Validated Cryptography When Protecting Controlled Unclassified Information (ML-3) \r\n###Â CMMCÂ Guidance\r\nOnly use cryptography validated through the NIST Cryptographic Module Validation Program (CMVP) to protect the confidentiality of CUI. Any other cryptography cannot be used since it has not been tested and validated to protect CUI. FIPS validated cryptography is not a requirement for all information, FIPS-validation is only used for the protection of CUI.\r\n###Â Microsoft RecommendationÂ \r\nDeploy Hardware Security Modules for FIPS-140 Encryption Requirements. âœ³ï¸ [Get Started with Azure Dedicated HSM](https://azure.microsoft.com/en-us/services/azure-dedicated-hsm/)\r\n###Â NavigateÂ \r\nSee Microsoft References Below\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Deploying HSMs into an Existing Virtual Network using the Azure CLI](https://docs.microsoft.com/en-us/azure/dedicated-hsm/tutorial-deploy-hsm-cli)\r\nðŸ’¡Â [FIPS 140-2 Validation](https://docs.microsoft.com/en-us/windows/security/threat-protection/fips-140-validation)\r\nðŸ’¡Â [What is Azure Dedicated HSM?](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.11\r\n\tâ€¢ CIS Controls v7.1 14.4, 14.8\r\n\tâ€¢ NIST CSF v1.1 PR.DS-1, PR.DS-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-13\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Deploy Hardware Security Modules for FIPS-140 Encryption Requirements\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/dedicated-hsm/media/tutorial-deploy-hsm-cli/high-availability-architecture.pngÂ Â \"Deploying HSMs\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.177",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.180",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Employ Architectural Designs, Software Development Techniques, and Systems Engineering Principles that Promote Effective Information Security within Organizational Systems (ML-3) \r\n###Â CMMCÂ Guidance\r\nFamiliarity with security engineering principles and their successful application to your infrastructure will increase the security of your environment. NIST SP 800-160 System Security Engineering: Considerations for a Multidisciplinary Approach in the Engineering of Trustworthy Secure Systems can serve as a source of security engineering and design principles.\r\n\r\nOrganizations need to decide which designs and principles to apply. Some will not be possible or appropriate for your organization as a whole. Some will not be possible, applicable, or appropriate for specific systems or components.\r\n\r\nOnce a decision is made on which designs and principles to apply, they should be applied to your organizationâ€™s policies and security standards. Starting with your baseline configuration, they should be extended through all layers of the technology stack (e.g., hardware, software, firmware) and throughout all the components of your infrastructure. The application of these chosen designs and principles should drive your organization towards a secure architecture with the required security capabilities and intrinsic behaviors present throughout the lifecycle of your technology.\r\n\r\nAs legacy components in your architecture age, it may become increasingly difficult for those components to meet security principles and requirements. This should factor into life-cycle decisions for those components (e.g., replacing legacy hardware, upgrading or re-writing software, upgrading run-time environments).\r\n###Â Microsoft RecommendationÂ \r\nPlan Virtual Networks which Employ Architectural Designs, Software Development Techniques, and Systems Engineering Principles that Promote Effective Information Security within Organizational Systems. âœ³ï¸ [Get Started with Virtual Network](https://azure.microsoft.com/en-us/services/virtual-network/)\r\n###Â NavigateÂ \r\nSee Microsoft References Below\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Plan Virtual Networks](https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-vnet-plan-design-arm)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.2\r\n\tâ€¢ CIS Controls v7.1 5.1, 5.2, 5.4\r\n\tâ€¢ NIST SP 800-53 Rev 4 SA-8\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Plan Virtual Networks\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/virtual-network/media/virtual-networks-udr-overview/routing-example.pngÂ Â \"Plan Virtual Networks\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.180",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.181",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Separate User Functionality from System Management Functionality (ML-3) \r\n###Â CMMCÂ Guidance\r\nPrevent user functionality and services from accessing system management functionality on IT components, e.g., databases, network components, workstations, servers. This reduces the attack surface to those critical interfaces by limiting who can access them and how they can be accessed. This can be achieved through both logical and physical methods using computers, CPUs, operating system, network addresses or a combination of these methods. By separating the user functionality from system management functionality, the administrator or privileged functions are not available to the general user.\r\n\r\nThe intent of this practice is to ensure:\r\n\r\n\tâ€¢ General users are not permitted to perform system administration functions; and\r\n\tâ€¢ System administrators only perform system administration functions from their privileged account.\r\nThis can be accomplished using separation like VLANs or logical separation using strong access control methods.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Active Directory to Review System Assigned vs User Assigned Identity\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AADManagedIdentitySignInLogs (Azure Active Directory) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/) \r\n###Â NavigateÂ \r\nVirtual Machine > Identity > System Assigned / User Assigned\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Configure Managed Identities for Azure Resources on a VM Using the Azure Portal](https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/qs-configure-portal-windows-vm)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.3\r\n\tâ€¢ CIS Controls v7.1 4.3\r\n\tâ€¢ CERT RMM v1.2 KIM:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-2\r\n\tâ€¢ AU ACSC Essential Eight"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AADManagedIdentitySignInLogs\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by ServicePrincipalName\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory: Managed Identity Sign-Ins (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.181",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.182",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Prevent Unauthorized & Unintended Information Transfer via Shared System Resources (ML-3) \r\n###Â CMMCÂ Guidance\r\nNo shared system resource such as cache memory, hard disks, registers, or main memory should be able to pass information from one user to another user. In other words, when objects are reused no residual information should exist on that object. This protects the confidentiality of the information. This is typically a feature provided by operating system and software vendors.â€‹\r\n###Â Microsoft RecommendationÂ \r\nProtect Data Confidentiality with Azure Information Protection Policy. âœ³ï¸ [Get Started with Azure Information Protection](https://azure.microsoft.com/en-us/services/information-protection/)\r\n###Â NavigateÂ \r\nAzure Infromation Protection > Policy\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy-protection)\r\nðŸ’¡Â [Configuring the Azure Information Protection Policy](https://docs.microsoft.com/en-us/azure/information-protection/configure-policy)\r\nðŸ’¡Â [Azure Information Protection Documentation](https://docs.microsoft.com/en-us/azure/information-protection/)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.4\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-4\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Protect Data Confidentiality with Azure Information Protection Policy\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/information-protection/media/info-protect-protection-bar-configured.pngÂ Â \"How to configure a label for Rights Management protection\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.182",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.183 ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Deny Network Communications Traffic by Default and Allow Network Traffic by Exception (ML-3) \r\n###Â CMMCÂ Guidance\r\nBlock all traffic going into and coming out of the network, but permit specific traffic into and coming out based on the organizationâ€™s policies, exceptions, or criteria. This process of permitting only authorized traffic to the network is called whitelisting which limits the number of unintentional connections to the network.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Firewall & Network Security Groups to Deny Traffic by Default\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· AzureDiagnostics (Azure Firewall) âœ³ï¸ [Get Started with Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)\r\n###Â NavigateÂ \r\nAzure Portal > Create Resource > Firewall \r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.6\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-7(5)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePortInt:int \" \" TempDetails\r\n| parse TempDetails with \"was \" Action1 \". Reason: \" Rule1\r\n| parse TempDetails with \"to \" FQDN \":\" TargetPortInt:int \". Action: \" Action2 \".\" *\r\n| parse TempDetails with * \". Rule Collection: \" RuleCollection2a \". Rule:\" Rule2a\r\n| parse TempDetails with * \"Deny.\" RuleCollection2b \". Proceeding with\" Rule2b\r\n| extend SourcePort = tostring(SourcePortInt)\r\n| extend TargetPort = tostring(TargetPortInt)\r\n| extend Action1 = case(Action1 == \"Deny\",\"Deny\",\"Unknown Action\")\r\n| extend Action = case(Action2 == \"\",Action1,Action2),Rule = case(Rule2a == \"\", case(Rule1 == \"\",case(Rule2b == \"\",\"N/A\", Rule2b),Rule1),Rule2a), \r\nRuleCollection = case(RuleCollection2b == \"\",case(RuleCollection2a == \"\",\"No rule matched\",RuleCollection2a), RuleCollection2b),FQDN = case(FQDN == \"\", \"N/A\", FQDN),TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort)\r\n| make-series count() default=0 on TimeGenerated from ago(7d) to now() step 1d by Action\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall Action Count by Time (7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.183 ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.184",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Prevent Remote Devices from Split Tunneling (ML-3) \r\n###Â CMMCÂ Guidance\r\nSplit tunneling for a remote user utilizes two connections: accessing resources on the organizationâ€™s network via a VPN and simultaneously accessing an external network such as the public network or the Internet. Split tunneling introduces a vulnerability where an open unencrypted connection from the public network could allow an adversary to access resources on the network. As a mitigation strategy, the split tunneling setting should be disabled on all devices so that all traffic, including traffic for external networks or the Internet, goes through the organizationâ€™s VPN.\r\n###Â Microsoft RecommendationÂ \r\nLeverage VPN Gateway to Mitigate Split Tunneling. âœ³ï¸ [Get Started with VPN Gateway](https://azure.microsoft.com/en-us/services/vpn-gateway/)\r\n###Â NavigateÂ \r\nVirtual Network Gateways\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Configure Forced Tunneling Using the Azure Resource Manager Deployment Model](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-forced-tunneling-rm)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.7\r\n\tâ€¢ CIS Controls v7.1 12.12\r\n\tâ€¢ NIST CSF v1.1 PR.AC-3\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-7(7)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage VPN Gateway to Mitigate Split Tunneling\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/vpn-gateway/media/vpn-gateway-forced-tunneling-rm/forced-tunnel.pngÂ Â \"Configure forced tunneling using the Azure Resource Manager deployment model\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.184",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.185",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Implement Cryptographic Mechanisms to Prevent Unauthorized Disclosure of Controlled Unclassified Information During Transit (ML-3) \r\n###Â CMMCÂ Guidance\r\nOnly use cryptography validated through the NIST Cryptographic Module Validation Program (CMVP) to protect the confidentiality of CUI during transmission. Any other approved cryptography cannot be used since it has not been tested and validated to protect CUI. FIPS-validated cryptography is not a requirement for all information, it is only used for the protection of CUI. This encryption guideline must be followed unless an alternative physical safeguard is in place to protect CUI.\r\n###Â Microsoft RecommendationÂ \r\nReview/Implement Azure Defender for Servers Recommendations for Encryption of Data in Transit\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Recommendations > Encrypt Data in Transit\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Remediate Recommendations in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.8\r\n\tâ€¢ NIST CSF v1.1 PR.AC-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-8(1)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Web Application should only be accessible over HTTPS\" or RecommendationName == \"Function App should only be accessible over HTTPS\" or RecommendationName == \"IoT Devices - TLS cipher suite upgrade needed\" or RecommendationName == \"Secure transfer to storage accounts should be enabled\" or RecommendationName == \"TLS should be updated to the latest version for your web app\" or RecommendationName == \"TLS should be updated to the latest version for your function app\" or RecommendationName == \"FTPS should be required in your function App\" or RecommendationName == \"FTPS should be required in your web App\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by RecommendationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Review/Implement Azure Defender for Servers Recommendations for Encryption of Data in Transit",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.185",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.186",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Terminate Network Connections Associated with Communications Sessions at the End of the Sessions or After a Defined Period of Inactivity (ML-3) \r\n###Â CMMCÂ Guidance\r\nOrganizations should terminate the internal and external network connections associated with communication sessions at the end of the session or after a period of inactivity by deallocating (stopping) TCP/IP addresses or ports at the operating system level, and/or deallocating assignments at the application system level. This prevents malicious actors from taking advantage of an open network session or an unattended laptop at the end of the connection. Organizationâ€™s must balance user work patterns and needs against security when they determine the length of inactivity that will force a termination\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Control Azure Sessions with Azure Active Directory: Conditional Access (Sessions)\r\n\tâ€¢ Control, Monitor, and Alert on Long Running Sessions (Endpoint, Network, Authentication, Database etc.)\r\n### Required Log (Log Source)\r\nðŸ”· WVDConnections (Windows Virtual Desktop) âœ³ï¸ [Get Windows Virtual Desktop](https://azure.microsoft.com/en-us/services/virtual-desktop/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Conditional Access > New Policy > Access Controls > Session > Sign-in frequency\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Configure Authentication Session Management with Conditional Access](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-session-lifetime)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.9\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-10\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Control Azure Sessions with Azure Active Directory: Conditional Access (Sessions)\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/media/howto-conditional-access-session-lifetime/conditional-access-policy-session-sign-in-frequency.pngÂ Â \"Session Control\")Â \r\n"
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "// Session duration \r\n// Lists users by session duration in the last 24 hours. \r\n// The \"State\" provides information on the connection stage of an actitivity.\r\n// The delta between \"Connected\" and \"Completed\" provides the connection time for a specific connection.\r\nWVDConnections \r\n| where TimeGenerated > ago(90h) \r\n| where State == \"Connected\"  \r\n| project CorrelationId , UserName, ConnectionType , StartTime=TimeGenerated  \r\n| join (WVDConnections  \r\n    | where State == \"Completed\"  \r\n    | project EndTime=TimeGenerated, CorrelationId)  \r\n    on CorrelationId  \r\n| project Duration = EndTime - StartTime, ConnectionType, UserName  \r\n| sort by Duration desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Windows Virtual Desktop (WVD) Sessions by Duration (Last 90 Days)",
              "color": "blueDark",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.186",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.187",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Establish and Manage Cryptographic Keys for Cryptography Employed in Organizational Systems (ML-3)\r\n###Â CMMCÂ Guidance\r\nThe organization develops processes and technical mechanisms to protect the cryptographic keyâ€™s confidentiality, authenticity and authorized use in accordance to industry standards and regulations. Key management systems provide oversight, assurance, and the capability to demonstrate the cryptographic keys are created in a secure manner and protected from loss or misuse throughout their lifecycle, e.g., active, expired, revoked. For a small number of keys, this can be accomplished with manual procedures and mechanisms. As the number of keys and cryptographic units increase, automation and tool support will be required.\r\n\r\nKey establishment best practices are identified in NIST SP 800-56A, B and C. Key management best practices are identified in NIST SP 800-57 Parts 1, 2 and 3.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Key Vault for Secure Key Management\r\n###Â Required Log (Log Source)\r\nðŸ”· AzureDiagnostics (Key Vault) âœ³ï¸ [Get Started with Key Vault](https://azure.microsoft.com/en-us/services/key-vault/)\r\n###Â NavigateÂ \r\nAzure Key Vault\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Quickstart: Set and Retrieve a Secret from Azure Key Vault Using the Azure Portal](https://docs.microsoft.com/en-us/azure/key-vault/secrets/quick-create-portal)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.10\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-12\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where ResourceProvider ==\"MICROSOFT.KEYVAULT\" \r\n| summarize count() by bin(TimeGenerated, 1h), OperationName // Aggregate by hour\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Key Vault Operations by Time (7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "timechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.187",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.188",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Control and Monitor the Use of Mobile Code (ML-3) \r\n###Â CMMCÂ Guidance\r\nEnsure mobile code such as Java, ActiveX, Flash is authorized to execute on the network in accordance to the organizationâ€™s policy and technical configuration, and unauthorized mobile code is not. Then monitor the use of mobile code through boundary devices, audit of configurations, and implement remediation activities as needed.\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Protect Against Mobile Code Execution with Intune: Attack Surface Reduction\r\n\tâ€¢ Deploy Microsoft Defender for Endpoint\r\n\tâ€¢ Enable Azure Defender: Application Control\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure > Intune > Device Configuration > Profile > Create Profile > Configure > Windows Defender Exploit Guard > Attack Surface Reduction\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Block Untrusted and Unsigned Processes](https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/control-usb-devices-using-intune#block-untrusted-and-unsigned-processes-on-usb-peripherals)Â \r\nðŸ’¡Â [Reduce Attack Surfaces with Attack Surface Reduction Rules](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction)Â \r\nðŸ’¡Â [Use Adaptive Application Controls to Reduce Your Machines' Attack Surfaces](https://docs.microsoft.com/en-us/azure/security-center/security-center-adaptive-application)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.13\r\n\tâ€¢ NIST CSF v1.1 DE.CM-5\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-18\r\n\tâ€¢ AU ACSC Essential Eight\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert | where ProviderName == \"MDATP\"\r\n| search \"code\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by AlertName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Endpoint: Code/Process Alerts (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.188",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.189",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Control and Monitor the Use of Voice over Internet Protocol (VoIP) Technologies (ML-3)\r\n###Â CMMCÂ Guidance\r\nControlling VoIP technologies starts with establishing guidelines and enforcing usersâ€™ proper and appropriate usage of VoIP technologies that are described in an organizationâ€™s policies. Monitoring should include the usersâ€™ activity for anything other than what is permitted and authorized and detection of insecure or unauthorized use of the VoIP technology. Security concerns for VoIP include eavesdropping on calls and using ID spoofing to impersonate trusted individuals.\r\n###Â Microsoft RecommendationÂ \r\nMonitor Microsoft Teams & VOIP Technology Usage\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· OfficeActivityÂ (Teams) âœ³ï¸ [Get Microsoft Teams](https://www.microsoft.com/en-us/microsoft-365/microsoft-teams/group-chat-software)\r\n###Â NavigateÂ \r\nMicrosoft 365 Admin Center > Microsoft Teams > Microsoft Teams Admin Center\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Plan Your Teams Voice Solution](https://docs.microsoft.com/en-us/microsoftteams/cloud-voice-landing-page)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.14\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-19\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by Operation\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Teams Operations by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.189",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.190",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Protect the Authenticity of Communications Sessions (ML-3) \r\n###Â CMMCÂ Guidance\r\nThe authentication of a session refers to a user entering login credentials to identify themselves to establish communication to the system. As the communication is established a unique session id is generated to identify the user session as authenticated. Organizations need to develop and implement the necessary controls to validate the identification and protect the session id from attacks such as hijacking.\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Protect Authenticity of Communications with Azure Active Directory: Identity Protection\r\n\tâ€¢ Apply Azure Encryption for Data in Transit\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Identity Protection) âœ³ï¸ [Enable AAD Premium](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\nAzure Active Directory > Security > Identity Protection\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [What is Identity Protection](https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection)Â \r\nðŸ’¡Â [Azure Encryption Overview](https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-overview)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.15\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-23\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProductName == \"Azure Active Directory Identity Protection\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by AlertName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory Identity Protection Alerts (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.190",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.191",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Protect the Confidentiality of Controlled Unclassified Information at Rest (ML-3)\r\n###Â CMMCÂ Guidance\r\nCUI at rest means information that does not move through the network and may be stored on hard drives, media, and mobile devices. Develop a scheme and implement the necessary security controls to protect the confidentiality of CUI at rest. Although an approved encryption method protects data stored at rest, there are other additional technical solutions. The scheme you choose should depend on your organizationâ€™s environment and business needs.\r\n###Â Microsoft RecommendationÂ \r\nReview/Implement Azure Defender for Servers Recommendations for Encryption of Data at Rest\r\n###Â Required Log (Log Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nAzure Defender for Servers (Security Center) > Recommendations > Encrypt Data at Rest\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Remediate Recommendations in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.13.16\r\n\tâ€¢ CIS Controls v7.1 14.8\r\n\tâ€¢ NIST CSF v1.1 PR.DS-1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-28\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"Disk encryption should be applied on virtual machines\" or RecommendationName == \"Transparent Data Encryption on SQL databases should be enabled\" or RecommendationName == \"Secure transfer to storage accounts should be enabled\" \r\n|Â make-seriesÂ count()Â default=0Â onÂ TimeGeneratedÂ fromÂ ago(90d)Â toÂ now()Â stepÂ 1dÂ byÂ RecommendationName\r\n|Â renderÂ timechartÂ ",
              "size": 0,
              "showAnalytics": true,
              "title": "Review/Implement Azure Defender for Servers Recommendations for Encryption of Data at Rest",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.191 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.3.192",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Implement Domain Name System (DNS) Filtering Services (ML-3) \r\n###Â CMMCÂ Guidance\r\nDomain Name System (DNS) filtering blocks access to certain websites or IP addresses. The organization should use DNS to prevent access to known malicious websites or categories of websites. The DNS filtering will prevent users from receiving an IP address for the blocked domain names. A commercial DNS filtering service can be used.\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Implement Domain Name System (DNS) Filtering at the Network Level with Azure Firewall\r\n\tâ€¢ Implement URL Filtering with Microsoft Defender for Endpoint\r\n### Required Log (Log Source)\r\nðŸ”· AzureDiagnostics (Azure Firewall) âœ³ï¸ [Get Started with Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Firewall > Threat Intelligence\r\n\tâ€¢ Microsoft Defender Security Center > Settings > Web Content Filtering\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Use FQDN Filtering in Network Rules](https://docs.microsoft.com/en-us/azure/firewall/fqdn-filtering-network-rules#)Â \r\nðŸ’¡Â [Web Content Filtering](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/web-content-filtering)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 7.7\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-20\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics \r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| where Resource in (split(\"SOC-NS-FW\", \", \"))\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePortInt: int \" \" TempDetails \r\n| parse TempDetails with \"was \" Action1 \". Reason: \" Rule1 \r\n| parse TempDetails with \"to \" FQDN \":\" TargetPortInt: int \". Action: \" Action2 \".\" * \r\n| parse TempDetails with * \". Rule Collection: \" RuleCollection2a \". Rule:\" Rule2a \r\n| parse TempDetails with * \"Deny.\" RuleCollection2b \". Proceeding with\" Rule2b \r\n| extend SourcePort = tostring(SourcePortInt) \r\n| extend TargetPort = tostring(TargetPortInt) \r\n| extend Action1 = case(Action1 == \"denied\", \"Deny\", \"Unknown Action\") \r\n| extend Action = case(Action2 == \"\", Action1, Action2), Rule = case(Rule2a == \"\", case(Rule1 == \"\", case(Rule2b == \"\", \"N/A\", Rule2b), Rule1), Rule2a), RuleCollection = case(RuleCollection2b == \"\", case(RuleCollection2a == \"\", \"No rule matched\", RuleCollection2a), RuleCollection2b), FQDN = case(FQDN == \"\", \"N/A\", FQDN), TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort)\r\n| where Action == \"Deny\"\r\n| where '*' == SourceIP or '*' == \"*\"  \r\n| summarize count() by FQDN\r\n| sort by count_ desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: Blocked FQDNs (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "FQDN",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SC.3.192",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.4.197",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·  Employ Physical and Logical Isolation Techniques in the System and Security Architecture and/or Where Deemed Appropriate by the Organization (ML-4) \r\n###Â CMMCÂ Guidance\r\nWhere the organization deems appropriate they will physically or logically isolate systems containing or processing CUI data from other systems supporting non-CUI business operations. Access controls are implemented to prevent non-authorized users from accessing the networks containing systems hosting and processing CUI information.\r\n###Â Microsoft RecommendationÂ \r\n\tâ€¢ Separate Workloads with Azure Subscriptions\r\n\tâ€¢ Manage Internal Network Traffic with Network Security Groups\r\n\tâ€¢ Manage Internal Routing with Virtual Networks\r\n\tâ€¢ Secure Applications with Application Security Groups\r\n\tâ€¢ Manage External Network Traffic with Azure Firewall\r\n### Required Log (Log Source)\r\nðŸ”· AzureNetworkAnalytics_CL  (Network Security Groups) âœ³ï¸ [Get Started with Virtual Network](https://azure.microsoft.com/en-us/services/virtual-network/)\r\n###Â NavigateÂ \r\n\tâ€¢ Subscriptions\r\n\tâ€¢ Network Security Group\r\n\tâ€¢ Virtual Networks\r\n\tâ€¢ Application Security Groups\r\n\tâ€¢ Azure Firewall\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Secure and Govern Workloads With Network Level Segmentation](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/network-level-segmentation)Â \r\nðŸ’¡Â [Create an Additional Azure Subscription](https://docs.microsoft.com/en-us/azure/cost-management-billing/manage/create-subscription)Â \r\nðŸ’¡Â [How Network Security Groups Filter Network Traffic](https://docs.microsoft.com/en-us/azure/virtual-network/network-security-group-how-it-works)Â \r\nðŸ’¡Â [What is Azure Virtual Network?](https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview)Â \r\nðŸ’¡Â [Application Security Groups](https://docs.microsoft.com/en-us/azure/virtual-network/application-security-groups)Â \r\nðŸ’¡Â [What is Azure Firewall?](https://docs.microsoft.com/en-us/azure/firewall/overview)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of Draft NIST SP 800-171B 3.13.4e\r\n\tâ€¢ CIS Controls v7.1 14.1\r\n\tâ€¢ NIST CSF v1.1 PR.AC-5\r\n\t\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Secure and Govern Workloads with Network Level Segmentation\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/images/resource-flowchart.pngÂ Â \"Network Segmentation\")Â \r\n\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureNetworkAnalytics_CL \r\n| where TimeGenerated > ago(60d) \r\n| project NSG_s, FlowType_s, Region_s, Subnet_s, TimeGenerated\r\n| make-series count() default=0 on TimeGenerated from ago(60d) to now() step 1d by NSG_s\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Network Security Group Rule Activity (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "name": "query - 2"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SC.4.197",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.5.198",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Configure Monitoring Systems to Record Packets Passing through Organization's Internet Network Boundaries (ML-5)\r\n###Â CMMCÂ Guidance\r\nThe organization shall capture and save all packets traversing the network boundary for a period of time determined by the organization. The system will support detailed analysis of an event showing what packets were transmitted and received and be able to reconstruct and determine content transmitted during a specific time period.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Network Watcher to Review Packet Data. âœ³ï¸ [Get Started with Network Watcher](https://azure.microsoft.com/en-us/services/network-watcher/)\r\n###Â NavigateÂ \r\nNetwork Watcher\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Manage Packet Captures with Azure Network Watcher Using PowerShell](https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-packet-capture-manage-powershell#:~:text=Start%20a%20packet%20capture%201%20The%20next%20step,by%20the%20packet%20capture.%20...%20More%20items...%20)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ CIS Controls v7.1 12.5\r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Network Watcher to Review Packet Data\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/network-watcher/media/network-watcher-monitoring-overview/traffic-analytics.pngÂ Â \"Manage packet captures with Azure Network Watcher using the portal\")\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "SC.5.198",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.4.199",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Utilize Threat Intelligence to Proactively Block DNS Requests from Reaching Malicious Domains (ML-4) \r\n###Â CMMCÂ Guidance\r\nAs part of collecting threat intelligence from a variety of sources such as government, industry peer organizations, or commercial services, use the known, bad domain names to feed security mechanisms (e.g., DNS servers or firewalls). Implement checks in the organizationâ€™s system to ensure devices making DNS calls to malicious sites are blocked from getting to those sites. This practice explicitly requires the use of threat intelligence in its application. This differs from the DNS filtering in practice SC.3.192 that allows for other means of creating the filters.\r\n###Â Microsoft RecommendationÂ Â \r\n\tâ€¢ Utilize Azure Sentinel Threat Intelligence to Identify Malicious Domains\r\n\tâ€¢ Implement Domain Name System (DNS) Filtering at the Network Level with Azure Firewall\r\n### Required Log (Log Source)\r\nðŸ”· ThreatIntelligenceIndicator (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· AzureDiagnostics (Azure Firewall) âœ³ï¸ [Get Started with Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Sentinel > Threat Intelligence\r\n\tâ€¢ Azure Firewall > Threat Intelligence\r\n\tâ€¢ Microsoft Defender Security Center > Settings > Web Content Filtering\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Import Threat Intelligence into Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/import-threat-intelligence)Â \r\nðŸ’¡Â [Azure Firewall Threat Intelligence-Based Filtering](https://docs.microsoft.com/en-us/azure/firewall/threat-intel)Â \r\nðŸ’¡Â [Use FQDN Filtering in Network Rules](https://docs.microsoft.com/en-us/azure/firewall/fqdn-filtering-network-rules#)Â \r\nðŸ’¡Â [Web Content Filtering](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/web-content-filtering)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC \r\n\t\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n| where TimeGenerated > (30d)\r\n| project DomainName, ThreatType, Description, TimeGenerated \r\n| where DomainName <> \"\"",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel: DNS Threat Indicators (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Description",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "DomainName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Watch",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Phish",
                          "representation": "redDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "compromise",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Malware",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "malicious",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "benign",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": null,
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "FQDN",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SC.4.199",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.4.202",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ Mechanisms to Analyze Executable Code and Scripts (e.g., Sandbox) Traversing Internet Network Boundaries or Other Organizationally Defined Boundaries (ML-4) \r\n###Â CMMCÂ Guidance\r\nThe organization shall install systems that automatically analyze executable and mobile code passing through the system boundary (e.g., downloaded from the Internet or other transmission method.) This practice is not focused on email, which is covered in practice SI.3.220. Any executable or mobile code identified as suspicious should be quarantined and not allowed to pass through to the user until confirmed not to be malware or required for a business purposes.\r\n###Â Microsoft RecommendationÂ Â \r\nEmploy Microsoft Defender for Endpoint and Azure Defender for Servers to Protect Against Malicous Executables & Scripts\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Antimalware) âœ³ï¸ [Get Azure Antimalware](https://docs.microsoft.com/en-us/azure/security/fundamentals/antimalware)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityAlert (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Cloud App Security) âœ³ï¸ [Get Microsoft Cloud App Security](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\nðŸ”· SecurityAlert (Microsoft Defender for Identity) âœ³ï¸ [Get Microsoft Defender for Identity](https://www.microsoft.com/en-us/microsoft-365/security/identity-defender)\r\n###Â Navigate\r\n\tâ€¢ Microsoft Endpoint Manger Admin Center > Devices > Configuration > Profiles > Microsoft Defender Anti-Virus \r\n\t> Select Cloud Delivered Blocking, File Level Blocking High, Prompt for Sample Submission\r\n\tâ€¢ Security Center > Security Alerts\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Microsoft Antimalware for Azure Cloud Services and Virtual Machines](https://docs.microsoft.com/en-us/azure/security/fundamentals/antimalware#)Â \r\nðŸ’¡Â [Stop and Quarantine Files in Your Network](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/respond-file-alerts#stop-and-quarantine-files-in-your-network)Â \r\nðŸ’¡Â [Add Indicator to Block or Allow a File](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/respond-file-alerts#add-indicator-to-block-or-allow-a-file)Â \r\nðŸ’¡Â [Turn on Block at First Sight](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/configure-block-at-first-sight-microsoft-defender-antivirus)Â \r\nðŸ’¡Â [Use Microsoft Endpoint Configuration Manager and Microsoft Intune to Configure and Manage Microsoft Defender Antivirus](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/configure-block-at-first-sight-microsoft-defender-antivirus)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-44\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Employ Microsoft Defender & Azure Defender to Protect Against Malicous Executables & Scripts\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/images/microsoft-defender-atp-next-generation-protection-engines.pngÂ Â \"Microsoft Defender for Endpoint\")Â \r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where TimeGenerated > (30d)\r\n| search \"malware\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by AlertName, ProviderName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Malware Detections (Last 30 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Description",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "DomainName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Watch",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Phish",
                          "representation": "redDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "compromise",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Malware",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "malicious",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "benign",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": null,
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "FQDN",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SC.4.202",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.4.228",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Isolate Administration of Organizationally Defined High-Value Critical Network Infrastructure Components and Servers (ML-4) \r\n###Â CMMCÂ Guidance\r\nWhere the organization has identified high value critical network infrastructure used in the processing and management of CUI data, they will physically or logically isolate management these systems from their production network, such as through the use of an Out-of-Band network. Access controls are implemented to prevent non-authorized users from accessing the management network and changing the configuration of an infrastructure component processing CUI information.\r\n###Â Microsoft RecommendationÂ Â \r\n\tâ€¢ Leverage Azure Custom Roles for Role Based Access Control (RBAC) to High Value Assets Containing CUI\r\n\tâ€¢ Manage Administrator Access to High Value Assets Containing CUI with Azure Active Directory: Privileged Identity Management\r\n### Required Log (Log Source)\r\nðŸ”· AuditLogs (AAD: PIM) âœ³ï¸ [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/en-us/trial/get-started-active-directory/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Active Directory > Roles & Admins > New Custom Role\r\n\tâ€¢ Azure Active Directory > Identity Governance > Privileged Identity Management > Azure AD roles\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Azure Custom Roles](https://docs.microsoft.com/en-us/azure/role-based-access-control/custom-roles)Â \r\nðŸ’¡Â [What is Azure AD Privileged Identity Management?](https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure)Â \r\nðŸ’¡Â [Security Management in Azure](https://docs.microsoft.com/en-us/azure/security/fundamentals/management)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC modification of NIST SP 800-171 Rev 1 3.13.2\r\n\tâ€¢ CIS Controls v7.1 11.7, 14.1\r\n\tâ€¢ NIST CSF v1.1 PR.AC-5\r\n\tâ€¢ NIST SP 800-53 Rev 4 SA-8\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| where Category == \"RoleManagement\"\r\n| where Identity == \"MS-PIM\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by OperationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Privileged Identity Management (PIM) Activity (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "FQDN",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SC.4.228",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.4.229",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·Utilize a URL Categorization Service and Implement Techniques to Enforce URL Filtering of Websites that are not Approved by the Organization (ML-4) \r\n###Â CMMCÂ Guidance\r\nOrganizations shall have the ability to prevent access to URLs the organization has determined should not be accessed for policy or security reasons. URL filters typically are a blacklist of URLs that block access to known bad sites. Categorization services identify websites according to a set of content attributes and allow organizations to allow or disallow access to entire classes of websites. In addition, organizations may choose to block access to uncategorized sites, which may represent malicious sites. The filters and categories should be updated dynamically through an intel subscription as well as manually.\r\n###Â Microsoft RecommendationÂ Â \r\nLeverage Microsoft Defender for Endpoint, Azure Sentinel Threat Intelligence, Azure Firewall and Azure Content Moderator to Categorize/Enforce Websites for Policy Enforcement\r\n### Required Log (Log Source)\r\nðŸ”· AzureDiagnostics (Azure Firewall) âœ³ï¸ [Get Started with Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)\r\n###Â NavigateÂ \r\n\tâ€¢ Microsoft Defender Security Center > Settings > Web Content Filtering\r\n\tâ€¢ Azure Sentinel > Threat Intelligence\r\n\tâ€¢ Azure Firewall > Threat Intelligence\r\n\tâ€¢ Content Moderator\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Web Content Filtering](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/web-content-filtering)Â \r\nðŸ’¡Â [Use FQDN Filtering in Network Rules](https://docs.microsoft.com/en-us/azure/firewall/fqdn-filtering-network-rules#)Â \r\nðŸ’¡Â [What is Azure Content Moderator?](https://docs.microsoft.com/en-us/azure/cognitive-services/content-moderator/overview)Â \r\nðŸ’¡Â [Import Threat Intelligence into Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/import-threat-intelligence)Â \r\nðŸ’¡Â [Azure Firewall Threat Intelligence-Based Filtering](https://docs.microsoft.com/en-us/azure/firewall/threat-intel)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 7.4\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Microsoft Defender for Endpoint: Web Content Filtering Report\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/images/web-activity-summary.pngÂ Â \"Web Content Filtering\")Â \r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallApplicationRule\"\r\n| parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePortInt: int \" \" TempDetails\r\n| parse TempDetails with \"was \" Action1 \". Reason: \" Rule1\r\n| parse TempDetails with \"to \" FQDN \":\" TargetPortInt: int \". Action: \" Action2 \".\" *\r\n| parse TempDetails with * \". Rule Collection: \" RuleCollection2a \". Rule:\" Rule2a\r\n| parse TempDetails with * \"Deny.\" RuleCollection2b \". Proceeding with\" Rule2b\r\n| extend SourcePort = tostring(SourcePortInt)\r\n| extend TargetPort = tostring(TargetPortInt)\r\n| extend Action1 = case(Action1 == \"denied\", \"Deny\", \"Unknown Action\")\r\n| extend Action = case(Action2 == \"\", Action1, Action2), Rule = case(Rule2a == \"\", case(Rule1 == \"\", case(Rule2b == \"\", \"N/A\", Rule2b), Rule1), Rule2a), RuleCollection = case(RuleCollection2b == \"\", case(RuleCollection2a == \"\", \"No rule matched\", RuleCollection2a), RuleCollection2b), FQDN = case(FQDN == \"\", \"N/A\", FQDN), TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort)\r\n| where Action == \"Deny\" \r\n| summarize count() by URL=FQDN, bin(TimeGenerated, 2d)",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: Top URL Blocks (Last 7 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "timechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Description",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "DomainName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Watch",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Phish",
                          "representation": "redDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "compromise",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Malware",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "malicious",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "benign",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": null,
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "FQDN",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SC.4.229",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SC.5.230",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”·Enforce Port and Protocol Compliance (ML-5) \r\n###Â CMMCÂ Guidance\r\nOrganizations shall enforce traffic crossing the network boundary is in compliance with the standard for the protocol in question and using the appropriate well-known port. If the port or protocol is not known the traffic should be blocked.\r\n###Â Microsoft RecommendationÂ Â \r\nLeverage Azure Defender for Servers to Enforce Port & Protocol Compliance\r\n### Required Log (Log Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\n\tâ€¢ Azure Defender for Servers (Security Center) > Recommendations > Secure Management Ports\r\n\tâ€¢ Azure Firewall > Policies\r\n\tâ€¢ Microsoft Endpoint Security Admin Center > Endpoint Security > Firewall\r\n###Â MicrosoftÂ Reference\r\nðŸ’¡Â [Understanding Just-In-Time (JIT) VM access](https://docs.microsoft.com/en-us/azure/security-center/just-in-time-explained)Â \r\nðŸ’¡Â [Remediate Recommendations in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-recommendations)Â \r\nðŸ’¡Â [Protect Your Network Resources](https://docs.microsoft.com/en-us/azure/security-center/security-center-network-recommendations)Â \r\nðŸ’¡Â [Configure Azure Firewall Rules](https://docs.microsoft.com/en-us/azure/firewall/rule-processing)Â \r\nðŸ’¡Â [Firewall Policy for Endpoint Security in Intune](https://docs.microsoft.com/en-us/mem/intune/protect/endpoint-security-firewall-policy)Â \r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 9.2\r\n\tâ€¢ NIST 800-53 Rev 4 SC-7(17)\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Enforce Port/Protocol Compliance with Azure Defender: Just In Time (JIT) Access\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/security-center/media/just-in-time-explained/unhealthy-resources.pngÂ Â \"JIT\")Â \r\n"
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where TimeGenerated > ago(90d)\r\n| where RecommendationName == \"Management ports should be closed on your virtual machines\" or RecommendationName == \"Management ports of virtual machines should be protected with just-in-time network access control\" or RecommendationName == \"Internet-facing virtual machines should be protected with network security groups\" or RecommendationName == \"All network ports should be restricted on network security groups associated to your virtual machine\" or RecommendationName == \"Adaptive network hardening recommendations should be applied on internet facing virtual machines\" or RecommendationName == \"IoT Devices - Open Ports On Device\"\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by RecommendationName\r\n| render timechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender: Port/Protocol Recommendations (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Description",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "DomainName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "ThreatType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Watch",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Phish",
                          "representation": "redDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "compromise",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "Malware",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "malicious",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "benign",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": null,
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "FQDN",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "failed",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "RecommendationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Communications Protection (SC)"
            },
            "name": "query - 2"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "SC.5.230",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC System & Communications ProtectionÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3\r\n|Â System & Communications ProtectionÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-3Â |Â SC.3.193Â |Â Implement a policy restricting the publication of CUI on externally-owned, publicly-accessible websites (e.g., forums, LinkedIn, Facebook, Twitter, etc.). | \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "customWidth": "100",
      "name": "CMMC System & Communications ProtectionÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 3",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC System & Communications ProtectionÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 5\r\n|Â System & Communications ProtectionÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-5Â |Â SC.5.208Â |Â Employ organizationally-defined and tailored boundary protections in addition to commercially-available solutions. |\r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Communications Protection (SC)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "customWidth": "100",
      "name": "CMMC System & Communications ProtectionÂ (NotÂ IncludedÂ inÂ Workbook): Maturity Level 5",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â System & Information Integrity (SI)",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "System & Information Integrity (SI)"
      },
      "customWidth": "100",
      "name": "System & Information Integrity (SI)",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Control Family Overview\r\nSystem & Information Integrity includes controls to identify system flaws, combat malware, and identify anomalies. TheÂ System & Information IntegrityÂ ControlÂ familyÂ includesÂ 18Â controls which varyingÂ applicationÂ acrossÂ theÂ CloudÂ ServiceÂ ProviderÂ (CSP)Â modelÂ includingÂ customerÂ responsibility,Â serviceÂ providerÂ responsibility,Â andÂ sharedÂ responsibility.Â ForÂ moreÂ information, see ðŸ’¡Â [CMMC with Microsoft Azure: System & Information Integrity](https://devblogs.microsoft.com/azuregov/cmmc-with-microsoft-azure-system-information-integrity-10-of-10/)",
        "style": "success"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "customWidth": "100",
      "name": "System & Information Integrity (SI) - OV",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##Â CMMC System & Information IntegrityÂ (IncludedÂ inÂ Workbook)\r\n|Â System & Information IntegrityÂ |\r\n|Â :Â |Â :Â | :Â |\r\n|Â Maturity LevelÂ | Control #Â |Â RequirementÂ |Â \r\n|Â ML-1Â |Â SI.1.210Â |Â Â Identify, report and correct information and information system flaws in a timely manner. Â |Â \r\n|Â ML-1Â |Â SI.1.211Â |Â Â Provide protection from malicious code at appropriate locations within organizational information systems. Â |Â \r\n|Â ML-1Â |Â SI.1.212Â |Â Â Update malicious code protection mechanisms when new releases are available. Â |\r\n|Â ML-1Â |Â SI.1.213Â |Â Â Perform periodic scans of the information system and real-time scans of files from external sources as files are downloaded, opened or executed. Â |Â \r\n|Â ML-2Â |Â SI.2.214Â |Â Â Monitor system security alerts and advisories and take action in response. Â |Â \r\n|Â ML-2Â |Â SI.2.216Â |Â Â Monitor organizational systems, including inbound and outbound communications traffic, to detect attacks and indicators of potential attacks. Â |\r\n|Â ML-2Â |Â SI.2.217Â |Â Â Identify unauthorized use of organizational systems. Â |\r\n|Â ML-3Â |Â SI.3.218Â |Â Employ spam protection mechanisms at information system access entry and exit points. |\r\n|Â ML-3Â | SI.3.219Â | Implement email forgery protections. |\r\n|Â ML-3Â |Â SI.3.220Â | Utilize email sandboxing to detect or block potentially malicious email. |\r\n|Â ML-4Â |Â SI.4.221Â |Â Â Use threat indicator information relevant to the information and systems being protected and effective mitigations obtained from external organizations to inform intrusion detection and threat hunting. Â |Â \r\n|Â ML-5Â |Â SI.5.222Â |Â Â Analyze system behavior to detect and mitigate execution of normal system commands and scripts that indicate malicious actions. Â |Â \r\n|Â ML-5Â |Â SI.5.223Â |Â Â Monitor individuals and system components on an ongoing basis for anomalous or suspicious behavior. Â |Â \r\nFor more information, see ðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "customWidth": "100",
      "name": "CMMC System & Information IntegrityÂ (IncludedÂ inÂ Workbook)",
      "styleSettings": {
        "maxWidth": "100%",
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Planning for System & Information Integrity in Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â System & Information Integrity\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series10-BigTable-1052x1536.pngÂ Â \"AzureÂ SecurityÂ CMMCÂ SIÂ Mapping\")\r\n---",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "MicrosoftÂ AzureÂ SecurityÂ ControlsÂ AlignedÂ toÂ CMMC:Â System & Information Integrity",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ System & Information Integrity?\r\nItâ€™sÂ importantÂ toÂ understandÂ thatÂ complianceÂ isÂ aÂ sharedÂ responsibilityÂ betweenÂ theÂ customerÂ andÂ theÂ CloudÂ ServicesÂ ProviderÂ (CSP).Â TheÂ graphicÂ belowÂ demonstratesÂ theÂ CSPÂ responsibilityÂ inÂ respectiveÂ cloudÂ modelsÂ (On-Prem,Â IaaS,Â PaaS,Â SaaS)Â withÂ darkÂ blueÂ aligningÂ withÂ customerÂ responsibilityÂ andÂ lightÂ blueÂ aligningÂ withÂ CSPÂ responsibility.Â \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series3-Preparation.pngÂ Â \"CSPÂ ResponsibilityÂ Model\")\r\n\r\nThe management controls for the CMMC System & Information Integrity Maturity (SI-MC) are listed below. These controls fall within the customerâ€™s responsibility. This starts with establishing polices to include system & information integrity (ML2) and progresses to a documented approach across all applicable organizational units (ML5). These controls should be formally created, documented in the System Security Plan (SSP) and implemented within the organization. \r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series10-Preparation.pngÂ Â \"CustomerÂ Responsibilities\")",
              "style": "success"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "WhatÂ PreparationÂ isÂ RequiredÂ forÂ CMMCÂ AlignmentÂ toÂ System & Information Integrity?",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Planning for System & Information Integrity in Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Designing a System & Information Integrity Architecture with Microsoft Azure",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "##Â 10 Steps to CMMC for System & Information Integrity with Microsoft Azure\r\nMicrosoftÂ Azure has has developed a 10-step process to facilitate system & information integrity with the security principles within CMMC, NIST SP 800-53 R4 and NIST SP 800-171 standards. Note this process is a starting point, as CMMC requires alignment of people, processes, policy and technology so refer to organizational requirements and respective standards for implementation. Azure has several offerings to facilitate system & information integrity including ðŸ’¡[Microsoft Cloud App Security](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security), ðŸ’¡[Microsoft Defender for Identity](https://azure.microsoft.com/en-us/features/azure-advanced-threat-protection/), ðŸ’¡[Azure Defender for Servers](https://azure.microsoft.com/en-us/services/security-center/), ðŸ’¡[Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/), ðŸ’¡[Azure DDoS Protectionl](https://azure.microsoft.com/en-us/services/ddos-protection/), andðŸ’¡[Azure Policy](https://docs.microsoft.com/en-us/azure/governance/policy/overview).\r\n\r\n![ImageÂ Name](https://devblogs.microsoft.com/azuregov/wp-content/uploads/sites/43/2020/05/CMMC-Series10-10steps-768x433.pngÂ \"10 Steps to CMMC for System & Information Integrity with Microsoft Azure\")",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "10 Steps to CMMC for System & Information Integrity with Microsoft Azure",
            "styleSettings": {
              "maxWidth": "50%"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "##Â DocumentationÂ &Â Guides\r\n###Â 1)Â Remediate Vulnerabilities\r\nðŸ’¡Â [Use Azure Security Center recommendations to enhance security](https://docs.microsoft.com/en-us/azure/security-center/security-center-using-recommendations)\r\n###Â 2)Â Monitor System Security Alerts\r\nðŸ’¡Â [Tutorial: Create custom analytics rules to detect threats](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom)\r\n###Â 3)Â Leverage Threat Intelligence\r\nðŸ’¡Â [Connect data from threat intelligence providers](https://docs.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence)\r\n###Â 4)Â Implement Malicious Code Protections\r\nðŸ’¡Â [Threat Protection with Microsoft Defender for Endpoints](https://docs.microsoft.com/en-us/windows/security/threat-protection/)\r\n### 5) Update Malicious Code Signatures\r\nðŸ’¡Â [Microsoft Antimalware for Azure Cloud Services and Virtual Machines](https://docs.microsoft.com/en-us/azure/security/fundamentals/antimalware)\r\n###Â 6)Â Perform Periodic Scans\r\nðŸ’¡Â [Quickstart: Create a policy assignment to identify non-compliant resources](https://docs.microsoft.com/en-us/azure/governance/policy/assign-policy-portal)\r\n###Â 7) Detect & Mitigate Malicious Actions\r\nðŸ’¡Â [Tutorial: Investigate a computer](https://docs.microsoft.com/en-us/azure-advanced-threat-protection/investigate-a-computer)\r\n###Â 8)Â Detect Network Attacks\r\nðŸ’¡Â [Quickstart: Create and configure Azure DDoS Protection Standard](https://docs.microsoft.com/en-us/azure/ddos-protection/manage-ddos-protection)\r\n###Â 9)Â Identify Unauthorized Access\r\nðŸ’¡Â [Secure your management ports with just-in-time access](https://docs.microsoft.com/en-us/azure/security-center/security-center-just-in-time)\r\n###Â 10)Â Monitor Individuals\r\nðŸ’¡Â [Enable User and Entity Behavior Analytics (UEBA) in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "DocumentationÂ &Â Guides: SI",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Designing a System & Information Integrity Architecture with Microsoft Azure",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.1.210",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Identify, Report, & Correct Information System Flaws in a Timely Manner (ML-1)\r\n###Â CMMCÂ Guidance\r\nAll software and firmware have potential flaws. Many vendors work to reduce those flaws by releasing vulnerability information and updates to their software and firmware. Organizations should have a process to review relevant vendor newsletters with updates about common problems or weaknesses. After reviewing the information the organization should execute a process called patch management that allows for systems to be updated without adversely affecting the organization. Organizations should also purchase support from their vendors to ensure timely access to updates.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Microsoft Defender Threat Vulnerability Management and Azure Defender to Review/Remediate Vulnerabilities\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityRecommendation (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\n###Â NavigateÂ \r\nMicrosoft Defender Security Center > Threat Vulnerability Management\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Threat and Vulnerability Management Walk-Through](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/next-gen-threat-and-vuln-mgt)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.xii\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.1\r\n\tâ€¢ NIST CSF v1.1 RS.CO-2, RS.MI-3\r\n\tâ€¢ CERT RMM v1.2 VAR:SG2.SP2\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-2\r\n\tâ€¢ UK NCSC Cyber Essentials\r\n\tâ€¢ AU ACSC Essential Eight\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by RecommendationName\r\n| render timechart \r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Defender Recommendations by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "SI.1.210",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.2.214",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Monitor System Security Alerts & Advisories (ML-2)\r\n###Â CMMCÂ Guidance\r\nOrganizations should receive security alerts, advisories, and directives from reputable external organizations. You base identification of these organizations on sector, industry, and the technology you use. There are many ways to received alerts and advisories and may include:\r\n\r\n\tâ€¢ Signing up for email distributions\r\n\tâ€¢ Subscribing to RSS feeds\r\n\tâ€¢ Attending meetings\r\nOrganizations should review alerts and advisories for applicability as they receive them. An organization decides on its own review cycle. The more frequent the alerts and advisories, the more frequent the reviews. This ensures that the organization has the most up-to-date information.\r\n\r\nExternal alerts and advisories may prompt an organization to generate internal security alerts, advisories, or directives. Share these with all personnel with a need-to-know. The individuals should take action to respond to the alerts. Actions vary according to the alert or advisory. Sometimes it may require a system configuration update. Other times, the organization may use the information for situational awareness purposes.\r\n\r\n###Â Microsoft RecommendationÂ \r\nSubscribe to Microsoft Security Response Center: Security Notification Service\r\n###Â NavigateÂ \r\nMicrosoft Reference Documentation (Below)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [MSRC Security Notifications](https://aka.ms/subscribe-msrc-security-notifications)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.3\r\n\tâ€¢ CIS Controls v7.1 6.5, 6.6\r\n\tâ€¢ NIST CSF v1.1 RS.AN-5\r\n\tâ€¢ CERT RMM v1.2 IMC:SG2.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-5\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Subscribe to MSRC Security Notification Service\r\n![ImageÂ Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE2iDfp?ver=3920&q=90&m=6&h=600&w=1600&b=%23FFFFFFFF&l=f&o=t&aim=trueÂ Â \"MSRC\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "SI.2.214",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.4.221",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Use Threat Indicator Information Relevant to Information/Systems Protected (ML-4)\r\n###Â CMMCÂ Guidance\r\nWhen conducting cyberattacks the attackers tend to operate using certain patterns of behavior or exploit capabilities. This collection of patterns and capabilities are known as Tactics, Techniques, and Procedures (TTP). An organization can build their knowledge of attacker TTPs by participating in Information Sharing and Analysis Centers (ISAC) for their industry. An ISAC collects cyber threat information relevant to the industry and its members in order to improve the cyber posture of that industry. Based on the lines of business an organization may consider more than one ISAC. An organization may also acquire TTPs through commercial providers in order to integrate into various technologies.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel Threat Intelligence for System Relevant indicators \r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· ThreatIntelligenceIndicator (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\tâ€¢  Azure Sentinel > Data Connectors > Threat Intelligence \r\n\tâ€¢  Azure Sentinel > Threat Intelligence\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Connect Data from Threat Intelligence Providers](https://docs.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ Draft NIST SP 800-171B 3.14.6e\r\n\tâ€¢ NIST CSF v1.1 ID.RA-2, ID.RA-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n// Select all indicators from the table\r\n// Create a new column to identify the type of indicator, IP, Domain, URL, File, or Other\r\n| extend IndicatorType = iif(isnotempty(EmailSourceIpAddress) or isnotempty(NetworkDestinationIP) or isnotempty(NetworkIP) or isnotempty(NetworkSourceIP) or isnotempty(NetworkCidrBlock), \"IP\", iff(isnotempty(Url), \"URL\", iff(isnotempty(EmailRecipient) or isnotempty(EmailSenderAddress), \"Email\", iff(isnotempty(FileHashValue), \"File\", iff(isnotempty(DomainName) or isnotempty(EmailSourceDomain), \"Domain\", \"Other\")))))\r\n// Summarize and order the data, then render the chart\r\n| summarize CountOfIndicators = count() by IndicatorType, bin(TimeGenerated, 1h)\r\n| order by CountOfIndicators desc\r\n| render barchart kind=stacked\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Threat Indicators by Type",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 4"
        }
      ],
      "name": "SI.4.221",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.1.211",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Provide Protection From Malicious code at Appropriate Locations (ML-1)\r\n###Â CMMCÂ Guidance\r\nYou can protect your companyâ€™s valuable IT system by stopping malicious code at designated locations in your system. Malicious code is program code that purposefully creates an unauthorized function or process that will have a negative impact on the confidentiality, integrity, or availability of an information system. A designated location may be your network device or your computer.\r\n\r\nMalicious code includes the following, which can be hidden in email, email attachments, web access:\r\n\r\n\tâ€¢ Viruses, programs designed to damage, steal information, change data, send email, show messages, or any combination of these things\r\n\tâ€¢ Spyware, a program designed to gather information about a personâ€™s activity in secret, and is usually installed without the person knowing when they click on a link\r\n\tâ€¢ A trojan horse, a type of malware made to look like legitimate/real software, and used by cyber criminals to get access to a companyâ€™s systems\r\nBy using anti-malware tools, you can stop or lessen the impact of malicious code.\r\n###Â Microsoft RecommendationÂ \r\nIntegrate Azure Defender for Servers and Microsoft Defender for Endpoints for Malware Protection\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· ProtectionStatus (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\n\tâ€¢  Microsoft Defender Security Center\r\n\tâ€¢  Azure Defender for Servers (Security Center)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Threat Protection](https://docs.microsoft.com/en-us/windows/security/threat-protection/)\r\nðŸ’¡Â [Protect Your Endpoints with Security Center's Integrated EDR Solution: Microsoft Defender for Endpoint](https://docs.microsoft.com/en-us/azure/security-center/security-center-wdatp)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.xiii\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.2\r\n\tâ€¢ CIS Controls v7.1 8.1\r\n\tâ€¢ NIST CSF v1.1 DE.CM-4\r\n\tâ€¢ CERT RMM v1.2 VAR:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-3\r\n\tâ€¢ AU ACSC Essential Eight\r\n\t\r\n\r\n\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ProtectionStatus\r\n|Â extendÂ ProtectionÂ =Â iff(ThreatStatusRankÂ ==Â 150,Â \"Protected\",Â \"SecurityÂ EventÂ ShouldÂ BeÂ Addressed\")\r\n|Â extendÂ ResourceÂ =Â Computer\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1h by ProtectionStatus\r\n| render timechart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender Protection Status Count by Time",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 2592000000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart",
              "gridSettings": {
                "rowLimit": 50
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "SI.1.211",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.1.212",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Update Malicious Code Protection Mechanisms When New Releases Available (ML-1)\r\n###Â CMMCÂ Guidance\r\nYou can protect your companyâ€™s valuable IT systems by staying up to date on new security releases that stop malicious code and monitoring the system regularly. Malicious code is program code that is always changing, so it is important to always have up-to-date protections, such as anti-malware tools.â€‹\r\n###Â Microsoft RecommendationÂ \r\nAutomatically Update Malicious Code Signatures with Microsoft Anti-Malware Updates\r\n###Â NavigateÂ \r\nMicrosoft Reference Documentation (Below)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Microsoft Antimalware for Azure Cloud Services and Virtual Machines](https://docs.microsoft.com/en-us/azure/security/fundamentals/antimalware)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.xiv\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.4\r\n\tâ€¢ CIS Controls v7.1 8.2\r\n\tâ€¢ NIST CSF v1.1 DE.CM-4\r\n\tâ€¢ CERT RMM v1.2 VAR:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Automatically Update Malicious Code Signatures with Microsoft Anti-Malware Updates\r\n\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/security/fundamentals/media/antimalware/sec-azantimal-fig1.pngÂ Â \"Microsoft Antimalware for Azure Cloud Services and Virtual Machines\")Â \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "text - 237",
            "styleSettings": {
              "maxWidth": "50%"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "SI.1.212",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.1.213",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Perform Periods Scans of Files Downloaded, Opened, Executed (ML-1)\r\n###Â CMMCÂ Guidance\r\nCompanies should use anti-malware software to scan and identify viruses in their computer systems, and have a plan for how often scans are conducted. Real-time scans will look at the system whenever new files are downloaded, opened, and saved. Periodic scans check previously saved files against updated malware information.\r\n###Â Microsoft RecommendationÂ \r\nConduct File Scanning for Alerting with Microsoft Defender for Endpoint & Azure Defender for Servers\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityAlert (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Office 365) âœ³ï¸ [Get Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\nðŸ”· SecurityAlert (Microsoft Defender for Identity) âœ³ï¸ [Get Microsoft Defender for Identity](https://www.microsoft.com/en-us/microsoft-365/security/identity-defender)\r\n###Â NavigateÂ \r\n\tâ€¢  Microsoft Defender Security Center\r\n\tâ€¢  Azure Defender for Servers (Security Center)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Threat Protection](https://docs.microsoft.com/en-us/windows/security/threat-protection/)\r\nðŸ’¡Â [Protect Your endpoints with Security Center's Integrated EDR solution: Microsoft Defender for Endpoint](https://docs.microsoft.com/en-us/azure/security-center/security-center-wdatp)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ FAR Clause 52.204-21 b.1.xv\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.5\r\n\tâ€¢ CIS Controls v7.1 8.4, 8.7\r\n\tâ€¢ NIST CSF v1.1 DE.CM-4\r\n\tâ€¢ CERT RMM v1.2 VAR:SG3.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-3\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProductName in ( 'Azure Active Directory Identity Protection','Azure Advanced Threat Protection','Azure Security Center','Azure Sentinel','Microsoft Antimalware','Microsoft Cloud App Security','Microsoft Defender Advanced Threat Protection' )\r\n| where AlertSeverity in ('Medium','Low','High','Informational')\r\n| extend HostName = tostring(parse_json(Entities)[0].HostName)\r\n| summarize AlertCount = count() by AlertSeverity, VendorName, ProductName, StartTime, RemediationSteps, AlertLink\r\n| limit 25",
              "size": 0,
              "showAnalytics": true,
              "title": "Review Security Alerts for Suspect File Activity",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AlertSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "rowLimit": 50
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 1"
        }
      ],
      "name": "SI.1.213",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.3.218",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Employ Spam Protection Mechanisms at Information System Access Entry and Exit Points (ML-3)\r\n###Â CMMCÂ Guidance\r\nSpam filters should be applied on email that is inbound (coming into the organization) or outbound (leaving the organization). Inbound filters can protect the organizationâ€™s users from spam originating on the internet. Outbound protection helps the organization identify the origins of potential spam on their own network. Without this, an organization risks having its email server blacklisted for sending spam emails.â€‹\r\n###Â Microsoft RecommendationÂ \r\nLeverage Spam Filters with Microsft Defender for Office 365 âœ³ï¸ [Get Microsoft Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\n###Â NavigateÂ \r\nMicrosoft 365 Admin Center > Admin > Service Settings > Email > Spam Filtering > Edit or Create Spam Content Filter Policies\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Anti-Spam Protection in Exchange Online Protection](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spam-protection)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-8\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Spam Filters with Microsft Defender for Office 365\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/microsoft-365/security/media/b8eb2ee3-2eb1-4ea2-b138-f6d7fb2e23de.pngÂ Â \"Exchange Online Protection\")Â "
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SI.3.218",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.3.219",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Implement Email Forgery Protections (ML-3)\r\n###Â CMMCÂ Guidance\r\nImplement email protections in addition to basic spam protections. Some potential advanced email protections include Sender Policy Framework (SPF), Domain Keys Identified Mail (DKIM), and Domain-based Message Authentication, Reporting & Conformance (DMARC). SPF uses DNS to show which servers are allowed to send email for a given domain. DKIM uses asymmetric cryptography to verify the authenticity of an email message and provide assurance of the legitimacy of the email to the recipient. DMARC allows organizations to deploy a combination of DKIM and SPF to further enhance their electronic mail infrastructure by adding linkage to the author (â€œFrom:â€) domain name, published policies for recipient handling of authentication failures, and reporting from receivers to senders, to improve and monitor protection of the domain from fraudulent email.\r\n###Â Microsoft RecommendationÂ \r\nImplement Email Forgery Protections & Monitor for Threats with Microsoft Defender for Office 365\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· SecurityAlertÂ (Microsoft Defender for Office 365) âœ³ï¸ [Get Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\n###Â NavigateÂ \r\nOffice 365 Security & Compliance > Threat Management\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Microsoft Defender for Office 365](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/office-365-atp)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\tâ€¢ CIS Controls v7.1 7.8\r\n\tâ€¢ NIST CSF v1.1 PR.DS-2\r\n\tâ€¢ CERT RMM v1.2 KIM:SG4.SP1\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-8\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"OATP\"\r\n|Â whereÂ TimeGeneratedÂ >=Â ago(30d)Â andÂ TimeGeneratedÂ <=Â now()\r\n|Â whereÂ AlertSeverityÂ inÂ ('*')Â orÂ 'All'Â ==Â Â \"All\"\r\n|Â summarizeÂ CountÂ =Â count()Â byÂ AlertSeverity\r\n|Â renderÂ barchart",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Office 365 Alerts by Count",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AlertSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "rowLimit": 50
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SI.3.219 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.3.220",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Utilize Email Sandboxing to Detect or Block Potentially Malicious Email (ML-3)\r\n###Â CMMCÂ Guidance\r\nYou create an email sandbox by implementing an isolated environment to execute an attached file or linked URL. Before allowing attachments or links to be opened on the production network, they are executed within the sandbox and their behavior is observed. By opening these files or links in a protected environment, the system detects malicious activity before it is introduced into the network.\r\n###Â MicrosoftÂ RecommendationÂ \r\nLeverage Microsoft Defender for Office 365: Safe Attachments and SafeLinks for Attachment/Link Sandbox Detonations\r\n###Â NavigateÂ \r\nðŸ”· Office 365 Security & Compliance > Threat Management âœ³ï¸ [Get Microsoft Defender for Office 365](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Safe Attachments in Microsoft Defender for Office 365](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/atp-safe-attachments)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://www.acq.osd.mil/cmmc/draft.html)\r\n### CMMC Control References\r\n\tâ€¢ CIS Controls v7.1 7.10\r\n\tâ€¢ NIST SP 800-53 Rev 4 SC-44\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Office 365: Safe Attachments and SafeLinks for Attachment/Link Sandbox Detonations\r\n![ImageÂ Name](http://www.microsoft.com/en-us/microsoft-365/blog/wp-content/uploads/sites/2/2017/01/Advanced-Threat-Protection-with-URL-Detonation-and-Dynamic-Delivery-5-1.pngÂ Â \"Safe Attachments\")Â \r\n"
            },
            "customWidth": "50",
            "name": "text - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 3"
        }
      ],
      "name": "SI.3.220",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.5.222",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Analyze System Behavior to Detect/Mitigate Execution of Normal vs Malicious Actions (ML-5)\r\n###Â CMMCÂ Guidance\r\nNormal system commands and scripts used by the adversary will be allowed by normal application whitelists. The adversary uses this fact to move around despite the presence of whitelisting or other defenses. An organization may use endpoint detection and response (EDR) to record system activities and events that occur. Analyzing EDR records is one way to identify execution of a script that operates outside of normal parameters, indicating an exploit is in progress. Another way to approach this is to use User and Entity Behavior Analytics solutions to identify malicious activity.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel: User Entity Behavior Analytics for Abnormal Behavior Detection\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· BehaviorAnalytics (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\nAzure Sentinel > User Entity Behavior Analytics\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Enable User and Entity Behavior Analytics (UEBA) in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ CMMC\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let GetUserAlert = SecurityAlert\r\n| where TimeGenerated > ago(28d)\r\n| summarize arg_max(TimeGenerated,*) by SystemAlertId\r\n| where Entities contains \"account\"\r\n| extend SelectedAccountUPN = tolower(tostring('')),\r\nSelectedName = tolower(tostring('administrator')),\r\nSelectAAD = tolower(tostring('')),\r\nSelectSID = tolower(tostring(''))\r\n| mv-expand todynamic(Entities)\r\n| where Entities[\"Type\"] =~ \"account\"\r\n| extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\nSid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]) , Host = tostring(Entities[\"Host\"])\r\n| extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| where (Name == SelectedName and SelectedName != \"\" ) or (UPN == SelectedAccountUPN and SelectedAccountUPN != \"\") or (AadUserId == SelectAAD and SelectAAD != \"\") or (Sid == SelectSID and SelectSID != \"\")\r\n| serialize Id = tostring(row_number())\r\n| project TimeGenerated, Title=DisplayName, Sid,Severity=AlertSeverity, Description, ProviderName, ProductName, SystemAlertId, Id;\r\nlet MapAlertsToIncidents = SecurityIncident\r\n| where TimeGenerated > ago(28d)\r\n| summarize arg_max(LastModifiedTime, *) by IncidentNumber\r\n| where Status == \"New\" or Status == \"Active\"\r\n| serialize Id = tostring(IncidentNumber)\r\n| mv-expand AlertIds\r\n| extend AlertId = tostring(AlertIds)\r\n| join kind=innerunique (GetUserAlert) on $left.AlertId == $right.SystemAlertId\r\n| project TimeGenerated=TimeGenerated1, Title=Title1, Severity=Severity1,Description=Description1, ProviderName, ProductName, SystemAlertId,Id=Id1,ParentId=Id, IncidentNumber;\r\nlet IncidentAlertsCount = MapAlertsToIncidents\r\n| summarize AlertCount=count() by IncidentNumber\r\n| join kind=innerunique (SecurityIncident \r\n| where TimeGenerated > ago(28d)\r\n| summarize arg_max(LastModifiedTime, *) by IncidentNumber\r\n) on $left.IncidentNumber == $right.IncidentNumber\r\n| extend SecOpsOwner = Owner.assignedTo\r\n| project TimeGenerated, Title,Severity,Description,AlertCount,Status,Owner=SecOpsOwner,BookmarkIds,Comments,Labels,IncidentUrl,Id=tostring(IncidentNumber),ParentId=\"root\";\r\nlet IncidentsAndAlertsForUser = MapAlertsToIncidents \r\n| union IncidentAlertsCount;\r\nIncidentsAndAlertsForUser\r\n| where (Severity == 'All' or 'All' == 'All') and (Status == 'All' or 'All' == 'All') and (Owner == 'All' or 'All' == 'All')\r\n| sort by AlertCount desc\r\n| project TimeGenerated, Severity, Title, AlertCount, Description, Status, Owner, BookmarkIds, Comments, Labels, IncidentUrl, Id, ParentId\r\n| limit 25\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "User Entity Behavior Analytics for Abnormal Behavior Detection",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "AlertSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "rowLimit": 50
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 1",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "SI.5.222",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.2.216",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Monitor Organizational Systems Inbound/Outbound for Indicators of Attack (ML-2)\r\n###Â CMMCÂ Guidance\r\nOrganizations should leverage their monitoring systems to look for indicators of attacks. Think of indicators of attack as a series of actions that an adversary conducts in advance of an attack. Indicators of attack concern the steps involved and the intent of the adversary.\r\n\r\nIndicators of attacks on organizational systems may include:\r\n\r\n\tâ€¢ Internal traffic that indicates the presence of malicious code\r\n\tâ€¢ Malicious code detected during non-business hours\r\n\tâ€¢ The unauthorized data leaving the organization\r\n\tâ€¢ Communicating to external information systems\r\nTo detect attacks and indicators of attacks with success, deploy monitoring devices. Place these devices within the systems at strategic points to collect essential information. Strategic points include internal and external system boundaries. The organization should monitor both inbound traffic and outbound traffic.\r\n###Â Microsoft RecommendationÂ \r\n    â€¢ Leverage Azure DDoS Standard to Protect Against Attacks & Collect Intelligence\r\n    â€¢ Investigate Internal/External Attacks with Azure Sentinel Investigations\r\n### Required Log (Log Source)\r\nðŸ”· SecurityAlert (Azure DDoS) âœ³ï¸ [Get Started with Azure DDoS Protection](https://azure.microsoft.com/en-us/services/ddos-protection/)\r\nðŸ”· SecurityAlert (Antimalware) âœ³ï¸ [Get Azure Antimalware](https://docs.microsoft.com/en-us/azure/security/fundamentals/antimalware)\r\nðŸ”· SecurityAlert (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityAlert (Azure Defender) âœ³ï¸ [Get Started with Azure Defender](https://azure.microsoft.com/en-us/services/azure-defender/)\r\nðŸ”· SecurityAlert (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\nðŸ”· SecurityAlert (Microsoft Cloud App Security) âœ³ï¸ [Get Microsoft Cloud App Security](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\nðŸ”· SecurityAlert (Microsoft Defender for Identity) âœ³ï¸ [Get Microsoft Defender for Identity](https://www.microsoft.com/en-us/microsoft-365/security/identity-defender)\r\n###Â NavigateÂ \r\n    â€¢ DDoS Protection Plans\r\n    â€¢ Azure Sentinel > Investigations\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Quickstart: Create and Configure Azure DDoS Protection Standard](https://docs.microsoft.com/en-us/azure/ddos-protection/manage-ddos-protection)\r\nðŸ’¡Â [Tutorial: Investigate Incidents with Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.6\r\n\tâ€¢ CIS Controls v7.1 12.6\r\n\tâ€¢ NIST CSF v1.1 DE.CM-1\r\n\tâ€¢ CERT RMM v1.2 MON:SG1.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-4\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Monitor for External Attacks with Azure DDoS Standard\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/ddos-protection/media/ddos-best-practices/image-5.pngÂ Â \"Azure DDoS Protection Standard features\")Â "
            },
            "customWidth": "50",
            "name": "text - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where TimeGenerated > ago(90d)\r\n| where AlertName has \"DDoS\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by DisplayName, AlertSeverity\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure DDoS Standard Alerts (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "query - 1"
          },
          {
            "type": 1,
            "content": {
              "json": "### Investigate Attacks with Azure Sentinel Investigations\r\n![ImageÂ Name](https://docs.microsoft.com/en-us/azure/sentinel/media/tutorial-investigate-cases/map-timeline.pngÂ \"Azure Sentinel Investigations\")Â "
            },
            "customWidth": "50",
            "name": "text - 2 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where TimeGenerated > ago(90d)\r\n| make-series count() default=0 on TimeGenerated from ago(90d) to now() step 1d by DisplayName, AlertSeverity\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Security Alerts (Last 90 Days)",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "areachart"
            },
            "customWidth": "50",
            "name": "query - 1 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "SI.2.216",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.2.217 ",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Identify Unauthorized Use of Organizational Systems (ML-2)\r\n###Â CMMCÂ Guidance\r\nOrganizations should define authorized use of their systems. First, have an acceptable-use policy for your system. This policy establishes the baseline for how users access devices and the internet. You define authorized use by specific roles within the organization. Examples of these roles include user, administrator, and technician. After you define authorized use, identify unauthorized use of systems.\r\n\r\nOrganizations can monitor systems by observing audit activities. You can do this in real time or by other manual means, such as access patterns. To identify unauthorized use, leverage existing tools and techniques, such as:\r\n\r\n\tâ€¢ Intrusion detection systems\r\n\tâ€¢ Intrusion prevention systems\r\n\tâ€¢ Malicious code protection software\r\n\tâ€¢ Scanning tools\r\n\tâ€¢ Audit record monitoring software\r\n\tâ€¢ Network monitoring software\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel: User Entity Behavior Analytics for Unauthorized Activity\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· BehaviorAnalytics (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\nðŸ”· SecurityEvent (Microsoft Defender for Endpoint) âœ³ï¸ [Get Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\r\n###Â NavigateÂ \r\nAzure Sentinel > User Entity Behavior Analytics\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Enable User and Entity Behavior Analytics (UEBA) in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ NIST SP 800-171 Rev 1 3.14.7\r\n\tâ€¢ NIST CSF v1.1 DE.CM-1, DE.CM-7\r\n\tâ€¢ CERT RMM v1.2 MON:SG1.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-4\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let timeframe = 1d;\r\nlet ProcessCreationEvents=() {\r\nlet processEvents=SecurityEvent\r\n| where EventID==4688\r\n// filter out common randomly named files related to MSI installers and browsers\r\n| where not(NewProcessName matches regex @\"\\\\TRA[0-9A-Fa-f]{3}\\.tmp\")\r\n| where not(NewProcessName matches regex @\"\\\\TRA[0-9A-Fa-f]{4}\\.tmp\")\r\n| where not(NewProcessName matches regex @\"Installer\\\\MSI[0-9A-Fa-f]{3}\\.tmp\")\r\n| where not(NewProcessName matches regex @\"Installer\\\\MSI[0-9A-Fa-f]{4}\\.tmp\")\r\n| project TimeGenerated, ComputerName=Computer, AccountName=SubjectUserName, AccountDomain=SubjectDomainName,\r\nFileName=tostring(split(NewProcessName, '\\\\')[-1]), ProcessCommandLine = CommandLine, \r\nInitiatingProcessFileName=ParentProcessName, InitiatingProcessCommandLine=\"\", InitiatingProcessParentFileName=\"\";\r\nprocessEvents;\r\n};\r\nlet normalizedProcesses = ProcessCreationEvents \r\n| where TimeGenerated >= ago(timeframe)\r\n// normalize guids\r\n| project TimeGenerated, FileName = replace(\"[0-9A-Fa-f]{8}[-][0-9A-Fa-f]{4}[-][0-9A-Fa-f]{4}[-][0-9A-Fa-f]{4}[-][0-9A-Fa-f]{12}\", \"<guid>\", FileName)\r\n// normalize digits away\r\n| project TimeGenerated, FileName=replace(@'\\d', 'n', FileName); \r\nlet freqs = normalizedProcesses\r\n| summarize frequency=count() by FileName\r\n| join kind= leftouter (\r\nnormalizedProcesses\r\n| summarize Since=min(TimeGenerated), LastSeen=max(TimeGenerated) by FileName\r\n) on FileName;\r\nfreqs \r\n| where frequency <= toscalar( freqs | serialize | project frequency | summarize percentiles(frequency, 5))\r\n| order by frequency asc\r\n| project FileName, frequency, Since, LastSeen \r\n// restrict results to unusual processes seen in last day \r\n| where LastSeen >= ago(1d)\r\n| extend timestamp = LastSeen\r\n| take 50\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Review UEBA Logs for Uncommon File Activity",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "timeContext": {
                "durationMs": 604800000
              },
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "FileName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "2",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "AlertSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "rowLimit": 50
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 2"
        }
      ],
      "name": "SI.2.217 ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "SI.5.223",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "###Â Requirement\r\nðŸ”· Monitor Individuals and System Components for Suspicious Behavior (ML-5)\r\n###Â CMMCÂ Guidance\r\nMonitoring for anomalous or suspicious behavior can be done with signatures, statistical analysis, analytics or machine learning on user activity events. The analysis seeks to find patterns amongst data generated by user activity. This is different than traditional security applications that analyze events. This class of analysis is typically called User and Entity Behavior Analytics (UEBA.\r\n###Â Microsoft RecommendationÂ \r\nLeverage Azure Sentinel: User Entity Behavior Analytics & Watch-listing to Monitor Individuals\r\n###Â RequiredÂ LogÂ (LogÂ Source)\r\nðŸ”· BehaviorAnalytics (Azure Sentinel) âœ³ï¸ [Get Azure Sentinel](https://azure.microsoft.com/en-us/services/azure-sentinel/)\r\n###Â NavigateÂ \r\n\tâ€¢  Azure Sentinel > User Entity Behavior Analytics\r\n\tâ€¢  Azure Sentinel > Watchlists\r\n###Â MicrosoftÂ ReferenceÂ \r\nðŸ’¡Â [Enable User and Entity Behavior Analytics (UEBA) in Azure Sentinel](https://docs.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics)\r\nðŸ’¡Â [Use Azure Sentinel watchlists](https://docs.microsoft.com/en-us/azure/sentinel/watchlists)\r\n###Â CMMCÂ Model\r\nðŸ’¡Â [CMMC Model](https://docs.microsoft.com/en-us/azure/dedicated-hsm/overview)\r\n### CMMC Control References\r\n\tâ€¢ Draft NIST SP 800-171B 3.14.2e\r\n\tâ€¢ CIS Controls v7.1 13.3, 16.12, 16.13\r\n\tâ€¢ NIST CSF v1.1 DE.CM-1, DE.CM-3\r\n\tâ€¢ CERT RMM v1.2 MON:SG1.SP3\r\n\tâ€¢ NIST SP 800-53 Rev 4 SI-4\r\n\t\r\n"
            },
            "customWidth": "50",
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Sign-in\"\r\n| where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\nActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\nor ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n| join (\r\nSigninLogs | where TimeGenerated > ago(28d) | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n) on $left.SourceRecordId == $right._ItemId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Successful Logon\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Valid Accounts\",\r\nSubTechnique = \"\",\r\nDescription = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights, ResourceDisplayName,AppDisplayName,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3','c4e39bd9-1100-46d3-8c65-fb160da0071f','158c047a-c907-4556-b7ef-446551a6b5f7','62e90394-69f5-4237-9190-012177145e10','d29b2b05-8046-44ba-8758-1e26182fcf32','729827e3-9c14-49f7-bb1b-9608f156bbb8','966707d0-3269-4727-9be2-8c3a10f19b9d','194ae4cb-b126-40b2-bd5b-6091b380977d','fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c','7495fdc4-34c4-4d15-a289-98788ce399fd','aaf43236-0c0d-4d5f-883a-6955382ac081','3edaf663-341e-4475-9f94-5c398ef6c070','7698a772-787b-4ac8-901f-60d6b08affd2','b1be1c3e-b65d-4f19-8427-f6fa0d97feb9','9f06204d-73c1-4d4c-880a-6edb90606fd8','29232cdf-9323-42fd-ade2-1d097af3e4de','be2f45a1-457d-42af-a067-6ec1fa63bc45','7be44c8a-adaf-4e2a-84d6-ab2649e08a13','e8611ab8-c189-46e8-94e1-60213ab1f814']);\r\nlet AnomalousRoleAssignment = AuditLogs\r\n| where TimeGenerated > ago(28d)\r\n| where OperationName == \"Add member to role\"\r\n| mv-expand TargetResources\r\n| extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n| where isnotempty(RoleId) and RoleId in (critical,high)\r\n| extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n| where isnotempty(RoleName)\r\n| extend TargetId = tostring(TargetResources.id)\r\n| extend Target = tostring(TargetResources.userPrincipalName)\r\n| join kind=inner ( BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Add member to role\"\r\n| where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n) on $left._ItemId == $right.SourceRecordId\r\n| extend AnomalyName = \"Anomalous Role Assignemt\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Account Manipulation\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,RoleName,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority;let LogOns=materialize(\r\nBehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n| where ActionType == \"ResourceAccess\"\r\n| where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n| extend AnomalyName = \"Anomalous Resource Access\",\r\nTactic = \"Lateral Movement\",\r\nTechnique = \"\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n| where ActionType == \"RemoteInteractiveLogon\"\r\n| where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n| extend AnomalyName = \"Anomalous RDP Activity\",\r\nTactic = \"Lateral Movement\",\r\nTechnique = \"\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n| where ActionType == \"InteractiveLogon\"\r\n| where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n| where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n| extend AnomalyName = \"Anomalous Login To Devices\",\r\nTactic = \"Privilege Escalation\",\r\nTechnique = \"Valid Accounts\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Reset user password\"\r\n| where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n| join (\r\nAuditLogs\r\n| where TimeGenerated > ago(28d)\r\n| where OperationName == \"Reset user password\"\r\n) on $left.SourceRecordId == $right._ItemId\r\n| mv-expand TargetResources\r\n| extend Target = iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(TargetResources.userPrincipalName, \"#\")[0])),TargetResources.userPrincipalName),tostring(TargetResources.userPrincipalName)\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Password Reset\",\r\nTactic = \"Impact\",\r\nTechnique = \"Account Access Removal\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority\r\n| sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Sign-in\"\r\n| where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n| join (\r\nSigninLogs\r\n| where TimeGenerated > ago(28d)\r\n) on $left.SourceRecordId == $right._ItemId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Successful Logon\",\r\nTactic = \"Initial Access\",\r\nTechnique = \"Valid Accounts\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights, ResourceDisplayName,AppDisplayName ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActivityType == \"LogOn\"\r\n| where UsersInsights.BlastRadius == \"High\"\r\n| join (\r\nSigninLogs \r\n| where TimeGenerated > ago(28d)\r\n| where Status.errorCode == 50126\r\n) on $left.SourceRecordId == $right._ItemId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Failed Logon\",\r\nTactic = \"Credential Access\",\r\nTechnique = \"Brute Force\",\r\nSubTechnique = \"Password Guessing\",\r\nDescription = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType,[\"Evidence\"]=ActivityInsights, ResourceDisplayName,AppDisplayName ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n| where TimeGenerated > ago(28d)\r\n| where OperationName == \"Update user\"\r\n| mv-expand AdditionalDetails\r\n| where AdditionalDetails.key == \"UserPrincipalName\"\r\n| mv-expand TargetResources\r\n| extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n| where isnotempty(RoleId) and RoleId in (critical,high)\r\n| extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n| where isnotempty(RoleName)\r\n| extend TargetId = tostring(TargetResources.id)\r\n| extend Target = iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(TargetResources.userPrincipalName, \"#\")[0])),TargetResources.userPrincipalName),tostring(TargetResources.userPrincipalName)\r\n| join kind=inner ( \r\nBehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Update user\"\r\n| where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n) on $left._ItemId == $right.SourceRecordId\r\n| extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName) \r\n| extend AnomalyName = \"Anomalous Account Manipulation\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Account Manipulation\",\r\nSubTechnique = \"\",\r\nDescription = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,RoleName,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n| where TimeGenerated > ago(28d)\r\n| where ActionType == \"Add user\"\r\n| where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n| join(\r\nAuditLogs\r\n| where TimeGenerated > ago(28d) \r\n| where OperationName == \"Add user\"\r\n) on $left.SourceRecordId == $right._ItemId\r\n| mv-expand TargetResources\r\n| extend Target = iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(TargetResources.userPrincipalName, \"#\")[0])),TargetResources.userPrincipalName),tostring(TargetResources.userPrincipalName)\r\n| extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\nUserPrincipalName = iff(UserPrincipalName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserPrincipalName),\r\nUserName = iff(UserName contains \"#EXT#\",replace(\"_\",\"@\",tostring(split(UserPrincipalName, \"#\")[0])),UserName)\r\n| extend AnomalyName = \"Anomalous Account Creation\",\r\nTactic = \"Persistence\",\r\nTechnique = \"Create Account\",\r\nSubTechnique = \"Cloud Account\",\r\nDescription = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"Â Â Â \r\n| project TimeGenerated, AnomalyName,Tactic,Technique,SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target,[\"Evidence\"]=ActivityInsights ,SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights,[\"Anomaly Score\"]=InvestigationPriority\r\n| sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n| summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n| project Name=tolower(UserName),UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n| sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n| where TimeGenerated > ago(28d) \r\n| summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n| where Status == \"New\" or Status == \"Active\"\r\n| mv-expand AlertIds\r\n| extend AlertId = tostring(AlertIds)\r\n| join kind= innerunique ( \r\nSecurityAlert | where TimeGenerated > ago(28d) \r\n) on $left.AlertId == $right.SystemAlertId\r\n| summarize hint.strategy = shuffle arg_max(TimeGenerated,*), NumberOfUpdates = count() by SystemAlertId\r\n| mv-expand todynamic(Entities)\r\n| where Entities[\"Type\"] =~ \"account\"\r\n| extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\nSid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]) , Host = tostring(Entities[\"Host\"])\r\n| extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n| union TopUsersByAnomalies\r\n| extend \r\nAadPivot = iff(isempty(AadUserId),iff(isempty(Sid),Name,Sid),AadUserId),\r\nSidPivot = iff(isempty(Sid),iff(isempty(AadUserId),Name,AadUserId),Sid),\r\nUPNExists = iff(isempty(UPN), false,true),\r\nNameExists = iff(isempty(Name), false,true),\r\nSidExists = iff(isempty(Sid), false,true),\r\nAADExists = iff(isempty(AadUserId), false,true)\r\n| summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber,4),AlertCount=dcountif(AlertId,isnotempty(AlertId),4),AnomalyCount=sum(AnomalyCount),any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true),NameAnchor=anyif(Name, NameExists == true),AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true) , any(SidPivot) by AadPivot\r\n| summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount),AlertCount=sum(AlertCount),AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false),NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false),AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title,any_Severity,any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n| summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount),AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false),AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity,any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n| project [\"UserName\"]=NameAnchor,IncidentCount, AlertCount,AnomalyCount, [\"AadUserId\"]=AadAnchor,[\"OnPremSid\"]=SidAnchor , [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| sort by IncidentCount, AlertCount, AnomalyCount desc\r\n| take 25",
              "size": 0,
              "showAnalytics": true,
              "title": "Review User Entity Behavior Analytics for Abnormal User Behavior",
              "noDataMessage": "â€¢    Confirm Licensing, Availability, and Health of Respective Log Source                                                                                                                                                â€¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     â€¢    Adjust Query Time Thresholds for a Larger Data-Set",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "IncidentCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "yellowOrangeRed"
                    }
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "AlertSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "yellow",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Informational",
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "rowLimit": 25
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "System & Information Integrity (SI)"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "System & Information Integrity (SI)"
        },
        {
          "parameterName": "Maturity_Level",
          "comparison": "isEqualTo",
          "value": "Maturity Level 5"
        }
      ],
      "name": "SI.5.223",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fromTemplateId": "sentinel-CybersecurityMaturityModelCertification(CMMC)",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
