{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "<h2>Top 5 Users by Number of Failed Attempts</h2>"
      },
      "name": "text - 0"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "CommonSecurityLog \r\n| extend outcome = split(split(AdditionalExtensions, \";\", 2)[0], \"=\", 1)[0]\r\n| extend reason = split(split(AdditionalExtensions, \";\", 3)[0], \"=\", 1)[0]\r\n| where DeviceVendor == \"Forcepoint CASB\"\r\n| where DeviceProduct in (\"SaaS Security Gateway\", \"Cloud Service Monitoring\", \"CASB Admin audit log\")\r\n| where outcome ==\"Failure\" \r\n| summarize Count= count() by DestinationUserName| render barchart",
        "size": 0,
        "timeContext": {
          "durationMs": 13568400000,
          "endTime": "2020-02-05T11:48:00.000Z"
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "query - 2"
    },
    {
      "type": 1,
      "content": {
        "json": "\r\n<h2>Top 5 Users With The Highest Number Of Logs</h2>"
      },
      "name": "text - 3"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "CommonSecurityLog \r\n| where DeviceVendor == \"Forcepoint CASB\"\r\n| where DeviceProduct in (\"SaaS Security Gateway\", \"Cloud Service Monitoring\", \"CASB Admin audit log\")\r\n| summarize Count = count() by DestinationUserName\r\n| top 5 by DestinationUserName| render barchart",
        "size": 1,
        "timeContext": {
          "durationMs": 13568400000,
          "endTime": "2020-02-05T11:49:00.000Z"
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "query - 4"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}