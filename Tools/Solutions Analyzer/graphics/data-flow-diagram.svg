<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 900" font-family="Segoe UI, Arial, sans-serif">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <linearGradient id="onlineGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="localGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="scriptGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#333">Solutions Analyzer Data Flow</text>

  <!-- ONLINE SOURCES SECTION -->
  <text x="450" y="60" text-anchor="middle" font-size="14" font-weight="bold" fill="#1565c0">â˜ï¸ ONLINE SOURCES</text>
  
  <!-- Azure Monitor Documentation -->
  <rect x="50" y="75" width="380" height="70" rx="8" fill="url(#onlineGrad)" stroke="#1976d2" stroke-width="2"/>
  <text x="240" y="100" text-anchor="middle" font-size="13" font-weight="bold" fill="#1565c0">Azure Monitor Documentation</text>
  <text x="240" y="118" text-anchor="middle" font-size="10" fill="#555">â€¢ tables-category (table list &amp; categories)</text>
  <text x="240" y="132" text-anchor="middle" font-size="10" fill="#555">â€¢ tables-feature-support (transformations, basic logs)</text>

  <!-- Sentinel Documentation -->
  <rect x="470" y="75" width="380" height="70" rx="8" fill="url(#onlineGrad)" stroke="#1976d2" stroke-width="2"/>
  <text x="660" y="100" text-anchor="middle" font-size="13" font-weight="bold" fill="#1565c0">Microsoft Sentinel Documentation</text>
  <text x="660" y="118" text-anchor="middle" font-size="10" fill="#555">â€¢ data-connectors-reference</text>
  <text x="660" y="132" text-anchor="middle" font-size="10" fill="#555">  (lake-only ingestion, DCR support)</text>

  <!-- Arrow to collect_table_info -->
  <line x1="240" y1="145" x2="400" y2="175" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="660" y1="145" x2="500" y2="175" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- collect_table_info.py -->
  <rect x="320" y="175" width="260" height="40" rx="6" fill="url(#scriptGrad)" stroke="#ef6c00" stroke-width="2"/>
  <text x="450" y="200" text-anchor="middle" font-size="12" font-weight="bold" fill="#e65100">ğŸ collect_table_info.py</text>

  <!-- Arrow to tables_reference.csv -->
  <line x1="450" y1="215" x2="450" y2="240" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- tables_reference.csv -->
  <rect x="340" y="245" width="220" height="35" rx="6" fill="url(#outputGrad)" stroke="#7b1fa2" stroke-width="2"/>
  <text x="450" y="268" text-anchor="middle" font-size="11" font-weight="bold" fill="#6a1b9a">ğŸ“„ tables_reference.csv</text>

  <!-- LOCAL SOURCES SECTION -->
  <text x="450" y="310" text-anchor="middle" font-size="14" font-weight="bold" fill="#2e7d32">ğŸ’» LOCAL SOURCES</text>

  <!-- Azure-Sentinel Repository -->
  <rect x="50" y="325" width="800" height="120" rx="8" fill="url(#localGrad)" stroke="#388e3c" stroke-width="2"/>
  <text x="450" y="345" text-anchor="middle" font-size="13" font-weight="bold" fill="#1b5e20">Azure-Sentinel Repository (cloned locally)</text>
  
  <!-- Sub-boxes for repo contents -->
  <rect x="70" y="355" width="180" height="80" rx="5" fill="white" stroke="#4caf50" stroke-width="1"/>
  <text x="160" y="375" text-anchor="middle" font-size="11" font-weight="bold" fill="#2e7d32">ğŸ“ Solutions/</text>
  <text x="160" y="392" text-anchor="middle" font-size="9" fill="#555">â€¢ Data Connectors</text>
  <text x="160" y="405" text-anchor="middle" font-size="9" fill="#555">â€¢ Analytic Rules</text>
  <text x="160" y="418" text-anchor="middle" font-size="9" fill="#555">â€¢ Hunting Queries, etc.</text>

  <rect x="270" y="355" width="160" height="80" rx="5" fill="white" stroke="#4caf50" stroke-width="1"/>
  <text x="350" y="375" text-anchor="middle" font-size="11" font-weight="bold" fill="#2e7d32">ğŸ“ Parsers/</text>
  <text x="350" y="395" text-anchor="middle" font-size="9" fill="#555">Legacy parsers</text>
  <text x="350" y="410" text-anchor="middle" font-size="9" fill="#555">(pre-Solutions)</text>

  <rect x="450" y="355" width="180" height="80" rx="5" fill="white" stroke="#4caf50" stroke-width="1"/>
  <text x="540" y="375" text-anchor="middle" font-size="11" font-weight="bold" fill="#2e7d32">ğŸ“ Parsers/ASim*/</text>
  <text x="540" y="395" text-anchor="middle" font-size="9" fill="#555">ASIM parsers</text>
  <text x="540" y="410" text-anchor="middle" font-size="9" fill="#555">(11 schemas)</text>

  <rect x="650" y="355" width="180" height="80" rx="5" fill="white" stroke="#4caf50" stroke-width="1"/>
  <text x="740" y="375" text-anchor="middle" font-size="11" font-weight="bold" fill="#2e7d32">ğŸ“ Standalone</text>
  <text x="740" y="392" text-anchor="middle" font-size="9" fill="#555">Detections/</text>
  <text x="740" y="405" text-anchor="middle" font-size="9" fill="#555">Hunting Queries/</text>
  <text x="740" y="418" text-anchor="middle" font-size="9" fill="#555">Playbooks/, Workbooks/</text>

  <!-- Additional inputs row -->
  <!-- Azure Marketplace (Online) -->
  <rect x="50" y="470" width="200" height="50" rx="6" fill="url(#onlineGrad)" stroke="#1976d2" stroke-width="2"/>
  <text x="150" y="490" text-anchor="middle" font-size="11" font-weight="bold" fill="#1565c0">â˜ï¸ Azure Marketplace API</text>
  <text x="150" y="505" text-anchor="middle" font-size="9" fill="#555">Publication status checking</text>

  <!-- Overrides file -->
  <rect x="350" y="470" width="200" height="50" rx="6" fill="white" stroke="#9e9e9e" stroke-width="2"/>
  <text x="450" y="490" text-anchor="middle" font-size="11" font-weight="bold" fill="#616161">ğŸ“„ solution_analyzer_</text>
  <text x="450" y="505" text-anchor="middle" font-size="9" fill="#555">overrides.csv</text>

  <!-- tables_reference input arrow label -->
  <rect x="650" y="470" width="200" height="50" rx="6" fill="url(#outputGrad)" stroke="#7b1fa2" stroke-width="2"/>
  <text x="750" y="492" text-anchor="middle" font-size="11" font-weight="bold" fill="#6a1b9a">ğŸ“„ tables_reference.csv</text>
  <text x="750" y="507" text-anchor="middle" font-size="9" fill="#555">(from step 1)</text>

  <!-- Arrows to map script -->
  <line x1="150" y1="520" x2="350" y2="555" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="450" y1="445" x2="450" y2="550" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="450" y1="520" x2="450" y2="550" stroke="#666" stroke-width="2"/>
  <line x1="750" y1="520" x2="550" y2="555" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- map_solutions_connectors_tables.py -->
  <rect x="270" y="555" width="360" height="45" rx="6" fill="url(#scriptGrad)" stroke="#ef6c00" stroke-width="2"/>
  <text x="450" y="583" text-anchor="middle" font-size="12" font-weight="bold" fill="#e65100">ğŸ map_solutions_connectors_tables.py</text>

  <!-- Arrow to CSVs -->
  <line x1="450" y1="600" x2="450" y2="625" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- CSV outputs -->
  <rect x="200" y="630" width="500" height="65" rx="6" fill="url(#outputGrad)" stroke="#7b1fa2" stroke-width="2"/>
  <text x="450" y="652" text-anchor="middle" font-size="11" font-weight="bold" fill="#6a1b9a">ğŸ“Š CSV Outputs</text>
  <text x="450" y="670" text-anchor="middle" font-size="9" fill="#555">connectors.csv â€¢ solutions.csv â€¢ tables.csv â€¢ content_items.csv</text>
  <text x="450" y="685" text-anchor="middle" font-size="9" fill="#555">parsers.csv â€¢ asim_parsers.csv â€¢ content_tables_mapping.csv</text>

  <!-- Arrow to doc generator -->
  <line x1="450" y1="695" x2="450" y2="720" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- generate_connector_docs.py -->
  <rect x="295" y="725" width="310" height="40" rx="6" fill="url(#scriptGrad)" stroke="#ef6c00" stroke-width="2"/>
  <text x="450" y="750" text-anchor="middle" font-size="12" font-weight="bold" fill="#e65100">ğŸ generate_connector_docs.py</text>

  <!-- Arrow to docs -->
  <line x1="450" y1="765" x2="450" y2="790" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Documentation output -->
  <rect x="250" y="795" width="400" height="50" rx="6" fill="url(#outputGrad)" stroke="#7b1fa2" stroke-width="2"/>
  <text x="450" y="815" text-anchor="middle" font-size="11" font-weight="bold" fill="#6a1b9a">ğŸ“ Markdown Documentation</text>
  <text x="450" y="832" text-anchor="middle" font-size="9" fill="#555">solutions/ â€¢ connectors/ â€¢ tables/ â€¢ content/ â€¢ parsers/ â€¢ asim/</text>

  <!-- Legend - at bottom -->
  <rect x="250" y="860" width="400" height="30" rx="4" fill="#f5f5f5" stroke="#e0e0e0"/>
  <text x="280" y="880" font-size="10" font-weight="bold" fill="#666">Legend:</text>
  <rect x="335" y="872" width="12" height="12" rx="2" fill="url(#onlineGrad)" stroke="#1976d2"/>
  <text x="352" y="882" font-size="9" fill="#555">Online</text>
  <rect x="400" y="872" width="12" height="12" rx="2" fill="url(#localGrad)" stroke="#388e3c"/>
  <text x="417" y="882" font-size="9" fill="#555">Local</text>
  <rect x="460" y="872" width="12" height="12" rx="2" fill="url(#scriptGrad)" stroke="#ef6c00"/>
  <text x="477" y="882" font-size="9" fill="#555">Script</text>
  <rect x="520" y="872" width="12" height="12" rx="2" fill="url(#outputGrad)" stroke="#7b1fa2"/>
  <text x="537" y="882" font-size="9" fill="#555">Output</text>
  <rect x="590" y="872" width="12" height="12" rx="2" fill="white" stroke="#9e9e9e"/>
  <text x="607" y="882" font-size="9" fill="#555">Config</text>
</svg>