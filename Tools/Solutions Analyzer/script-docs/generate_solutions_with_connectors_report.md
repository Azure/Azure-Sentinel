# Solutions with Connectors Report Generator

**Script:** `generate_solutions_with_connectors_report.py`

## Overview

Generates a consolidated report of all Microsoft Sentinel solutions that have data connectors. This script reads the CSV files produced by `map_solutions_connectors_tables.py` and creates both a markdown summary report and a detailed CSV export.

This tool is useful for:
- Getting a quick overview of which solutions include data connectors
- Analyzing connector distribution by collection method
- Exporting solution/connector data for further analysis

## Output

The script generates two output files:

### 1. Markdown Report (`solutions_with_connectors_report.md`)

A human-readable report containing:

- **Summary Statistics**:
  - Total solutions with connectors
  - Total number of connectors
  - Collection method distribution table (count and percentage)

- **Solutions Overview Table**:
  - Solution name (linked to folder)
  - Number of connectors
  - Publisher
  - Support tier
  - Categories

### 2. CSV Export (`solutions_with_connectors.csv`)

A detailed CSV file with one row per solution/connector combination:

| Column | Description |
|--------|-------------|
| `solution_name` | Name of the solution |
| `solution_folder` | Path to solution folder in repository |
| `publisher` | Publisher name (support name or author name) |
| `support_tier` | Support tier (Microsoft, Partner, Community) |
| `categories` | Solution categories |
| `version` | Solution version |
| `connector_count` | Number of connectors in this solution |
| `connector_id` | Connector identifier |
| `connector_title` | Connector display name |
| `collection_method` | Data collection method (e.g., Azure Functions, Agent, Direct) |
| `tables` | Tables ingested by this connector |
| `solution_github_link` | Link to solution folder on GitHub |
| `connector_github_link` | Link to connector definition files |

## Prerequisites

### Input CSV Files

The script requires CSV files generated by `map_solutions_connectors_tables.py`:
- `solutions.csv` - Solution metadata
- `connectors.csv` - Connector details
- `solutions_connectors_tables_mapping.csv` - Solution-connector-table relationships

Run `map_solutions_connectors_tables.py` first to generate these files.

## Running the Script

From the `Tools/Solutions Analyzer` directory:

```bash
# Generate both markdown and CSV reports
python generate_solutions_with_connectors_report.py

# Generate only markdown report
python generate_solutions_with_connectors_report.py --no-csv

# Generate only CSV export
python generate_solutions_with_connectors_report.py --no-md

# Use custom input/output paths
python generate_solutions_with_connectors_report.py \
  --solutions-csv path/to/solutions.csv \
  --connectors-csv path/to/connectors.csv \
  --mapping-csv path/to/mapping.csv \
  --output-md path/to/report.md \
  --output-csv path/to/export.csv
```

## Command Line Options

| Option | Default | Description |
|--------|---------|-------------|
| `--solutions-csv` | `solutions.csv` | Path to solutions CSV file |
| `--connectors-csv` | `connectors.csv` | Path to connectors CSV file |
| `--mapping-csv` | `solutions_connectors_tables_mapping.csv` | Path to mapping CSV file |
| `--output-md` | `solutions_with_connectors_report.md` | Path for markdown report output |
| `--output-csv` | `solutions_with_connectors.csv` | Path for CSV export output |
| `--no-md` | `False` | Skip generating markdown report |
| `--no-csv` | `False` | Skip generating CSV export |

## Example Output

### Collection Method Distribution

| Collection Method | Count | Percentage |
|-------------------|-------|------------|
| Azure Functions | 120 | 35.2% |
| Agent | 85 | 24.9% |
| Direct | 72 | 21.1% |
| REST API Push | 45 | 13.2% |
| Unknown | 19 | 5.6% |

### Solutions Overview

| Solution | # Connectors | Publisher | Support | Category |
|----------|--------------|-----------|---------|----------|
| AWS | 3 | Microsoft | Microsoft | Cloud Provider |
| Azure Active Directory | 2 | Microsoft | Microsoft | Identity |
| CrowdStrike | 2 | CrowdStrike | Partner | Security - Threat Protec... |

## Usage in Pipeline

This script is typically run after `map_solutions_connectors_tables.py`:

1. **`map_solutions_connectors_tables.py`** - Generate input CSVs
2. **`generate_solutions_with_connectors_report.py`** - Generate summary report

The report provides a quick overview useful for solution planning and connector analysis, complementing the detailed documentation generated by `generate_connector_docs.py`.
