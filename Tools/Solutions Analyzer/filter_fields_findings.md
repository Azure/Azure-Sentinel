# Filter Fields Extraction Report

This report summarizes the filter field values extracted from queries across connectors, content items, and ASIM parsers.

## Summary

| Source Type | Total Items | With Filter Fields | Percentage |
|-------------|-------------|-------------------|------------|
| Connectors | 536 | 110 | 20.5% |
| Content Items | 6606 | 1023 | 15.5% |
| ASIM Parsers | 191 | 81 | 42.4% |

## Filter Field Patterns Found

The following table.field combinations were detected in queries:

| Table.Field | Occurrences |
|-------------|-------------|
| CommonSecurityLog.DeviceVendor | 256 |
| CloudAppEvents.ActionType | 182 |
| CommonSecurityLog.DeviceProduct | 182 |
| CommonSecurityLog.DeviceEventClassID | 170 |
| AWSCloudTrail.EventName | 164 |
| AuditLogs.OperationName | 157 |
| SecurityEvent.EventID | 127 |
| Syslog.SyslogMessage | 110 |
| DeviceEvents.ActionType | 106 |
| AzureDiagnostics.Category | 78 |
| OfficeActivity.OfficeWorkload | 53 |
| AzureDiagnostics.ResourceType | 38 |
| Event.Source | 37 |
| WindowsEvent.EventID | 35 |
| Event.EventID | 33 |
| Syslog.ProcessName | 33 |
| AzureActivity.OperationName | 27 |
| AzureDiagnostics.ResourceProvider | 24 |
| Event.EventLog | 23 |
| DeviceNetworkEvents.ActionType | 20 |
| Syslog.Facility | 20 |
| OfficeActivity.RecordType | 19 |
| DeviceRegistryEvents.ActionType | 15 |
| DeviceFileEvents.ActionType | 14 |
| EmailUrlInfo.ActionType | 13 |
| WindowsEvent.Provider | 9 |
| IdentityDirectoryEvents.ActionType | 8 |
| AADNonInteractiveUserSignInLogs.OperationName | 7 |
| IdentityQueryEvents.ActionType | 7 |
| DeviceInfo.ActionType | 5 |
| DeviceProcessEvents.ActionType | 5 |
| EmailEvents.ActionType | 5 |
| IdentityLogonEvents.ActionType | 5 |
| OfficeActivity.OperationName | 5 |
| _ASim_FileEvent.EventType | 5 |
| _ASim_RegistryEvent.EventType | 5 |
| AlertEvidence.ActionType | 4 |
| DeviceImageLoadEvents.ActionType | 3 |
| ASimAuditEventLogs.EventVendor | 2 |
| ASimNetworkSessionLogs.EventProduct | 2 |
| AzureActivity.ResourceProvider | 2 |
| SigninLogs.OperationName | 2 |
| _ASim_ProcessEvent.EventType | 2 |
| ASimDnsActivityLogs.EventProduct | 1 |
| ASimDnsActivityLogs.EventType | 1 |
| ASimDnsActivityLogs.EventVendor | 1 |
| ASimNetworkSessionLogs.EventType | 1 |
| ASimWebSessionLogs.EventType | 1 |
| _Im_ProcessEvent.EventType | 1 |

## Filter Field Format

Filter fields are stored in the format:
```
table.field operator "value(s)" | table.field operator "value" | ...
```

Supported operators:
- Equality: `==`, `=~` (case-insensitive), `!=`
- Set membership: `in`, `in~` (case-insensitive), `!in`, `!in~`
- String matching: `has`, `has_cs`, `contains`, `contains_cs`, `startswith`, `startswith_cs`, `endswith`, `endswith_cs`
- Multi-value string: `has_any`, `has_all`
- Negative string: `!has`, `!contains`, `!startswith`, `!endswith`
- Regex: `matches regex`

Multiple values for in/has_any/has_all operators are comma-separated inside the quotes.

## Fields Extracted

The following fields are extracted from queries:

| Field | Typical Table | Purpose |
|-------|---------------|--------|
| DeviceVendor | CommonSecurityLog | CEF source vendor |
| DeviceProduct | CommonSecurityLog | CEF source product |
| EventVendor | ASIM tables | Normalized source vendor |
| EventProduct | ASIM tables | Normalized source product |
| ResourceType | AzureDiagnostics | Azure resource type |
| Category | AzureDiagnostics | Log category |
| EventID | WindowsEvent/SecurityEvent/Event | Windows event identifier |
| Source | Event | Event log source (e.g., Service Control Manager) |
| Provider | WindowsEvent | Windows event provider |
| Facility | Syslog | Syslog facility (e.g., auth, authpriv, cron) |
| ProcessName | Syslog | Process that generated the log |
| ProcessID | Syslog | Process ID |
| SyslogMessage | Syslog | Message content (uses string operators: has, contains, etc.) |

---

# Full Listings

## Connectors with Filter Fields

Total: 110 connectors

| Connector ID | Title | Filter Fields | File |
|--------------|-------|---------------|------|
| AIVectraDetect | [Deprecated] Vectra AI Detect via Legacy Agent | CommonSecurityLog.DeviceEventClassID == "hsc"  \|  CommonSecurityLog.DeviceEventClassID !in "health,audit,campaigns,hsc,asc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Data%20Connectors/AIVectraDetect.json) |
| AIVectraDetectAma | [Deprecated] Vectra AI Detect via AMA | CommonSecurityLog.DeviceEventClassID == "hsc"  \|  CommonSecurityLog.DeviceEventClassID !in "health,audit,campaigns,hsc,asc"  \|  CommonSecurityLog.DeviceProduct =~ "X Series"  \|  CommonSecurityLog.DeviceVendor =~ "Vectra Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Data%20Connectors/template_AIVectraDetectAma.json) |
| ASimDnsActivityLogs | Windows DNS Events via AMA | ASimDnsActivityLogs.EventProduct == "DNS Server"  \|  ASimDnsActivityLogs.EventType == "Query"  \|  ASimDnsActivityLogs.EventVendor == "Microsoft" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Server%20DNS/Data%20Connectors/template_ASimDnsActivityLogs.JSON) |
| AkamaiSecurityEvents | [Deprecated] Akamai Security Events via Legacy Agent | CommonSecurityLog.DeviceProduct == "akamai_siem"  \|  CommonSecurityLog.DeviceVendor == "Akamai" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Akamai%20Security%20Events/Data%20Connectors/Connector_CEF_Akamai.json) |
| AkamaiSecurityEventsAma | [Deprecated] Akamai Security Events via AMA | CommonSecurityLog.DeviceProduct =~ "akamai_siem"  \|  CommonSecurityLog.DeviceVendor =~ "Akamai" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Akamai%20Security%20Events/Data%20Connectors/template_AkamaiSecurityEventsAMA.json) |
| AristaAwakeSecurity | [Deprecated] Awake Security via Legacy Agent | CommonSecurityLog.DeviceProduct == "Awake Security"  \|  CommonSecurityLog.DeviceVendor == "Arista Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AristaAwakeSecurity/Data%20Connectors/Connector_AristaAwakeSecurity_CEF.json) |
| ArubaClearPass | [Deprecated] Aruba ClearPass via Legacy Agent | CommonSecurityLog.DeviceProduct == "ClearPass"  \|  CommonSecurityLog.DeviceVendor == "Aruba Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Aruba%20ClearPass/Data%20Connectors/Connector_Syslog_ArubaClearPass.json) |
| ArubaClearPassAma | [Deprecated] Aruba ClearPass via AMA | CommonSecurityLog.DeviceProduct =~ "ClearPass"  \|  CommonSecurityLog.DeviceVendor =~ "Aruba Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Aruba%20ClearPass/Data%20Connectors/template_ArubaClearPassAMA.json) |
| AutomatedLogicWebCTRL | Automated Logic WebCTRL  | Event.Source == "ALCWebCTRL" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ALC-WebCTRL/Data%20Connectors/Connector_WindowsEvents_WebCTRL.json) |
| AwsS3 | Amazon Web Services S3 | AWSCloudTrail.EventName == "CreateUser" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Data%20Connectors/template_AwsS3.json) |
| AzureBatchAccount_CCP | Azure Batch Account | AzureDiagnostics.ResourceProvider == "MICROSOFT.BATCH" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Batch%20Account/Data%20Connectors/AzureBatchAccount_CCP.JSON) |
| AzureCognitiveSearch_CCP | Azure Cognitive Search | AzureDiagnostics.ResourceProvider == "MICROSOFT.SEARCH" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Cognitive%20Search/Data%20Connectors/AzureCognitiveSearch_CCP.JSON) |
| AzureDataLakeStorageGen1_CCP | Azure Data Lake Storage Gen1 | AzureDiagnostics.ResourceProvider == "MICROSOFT.DATALAKESTORE" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Data%20Lake%20Storage%20Gen1/Data%20Connectors/AzureDataLakeStorageGen1_CCP.JSON) |
| AzureEventHub_CCP | Azure Event Hub | AzureDiagnostics.ResourceProvider == "MICROSOFT.EVENTHUB" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Event%20Hubs/Data%20Connectors/AzureEventHub_CCP.JSON) |
| AzureFirewall | Azure Firewall | AzureDiagnostics.ResourceType == "AZUREFIREWALLS" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Firewall/Data%20Connectors/AzureFirewall.JSON) |
| AzureKeyVault | Azure Key Vault | AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Key%20Vault/Data%20Connectors/AzureKeyVault.JSON) |
| AzureKubernetes | Azure Kubernetes Service (AKS) | AzureDiagnostics.Category in "cluster-autoscaler,guard,kube-apiserver,kube-audit,kube-audit-admin,kube-controller-manager,kube-scheduler" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20kubernetes%20Service/Data%20Connectors/AzureKubernetes.JSON) |
| AzureLogicApps_CCP | Azure Logic Apps | AzureDiagnostics.ResourceProvider == "MICROSOFT.LOGIC" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Logic%20Apps/Data%20Connectors/AzureLogicApps_CCP.JSON) |
| AzureNSG | Network Security Groups | AzureDiagnostics.Category in "NetworkSecurityGroupEvent,NetworkSecurityGroupRuleCounter" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Network%20Security%20Groups/Data%20Connectors/AzureNSG.JSON) |
| AzureServiceBus_CCP | Azure Service Bus | AzureDiagnostics.ResourceProvider == "MICROSOFT.SERVICEBUS" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Service%20Bus/Data%20Connectors/AzureServiceBus_CCP.JSON) |
| AzureSql | Azure SQL Databases | AzureDiagnostics.Category in "AutomaticTuning,Basic,Blocks,DatabaseWaitStatistics,Deadlocks,DevOpsOperationsAudit,Errors,InstanceAndAppAdvanced,QueryStoreWaitStatistics,SQLInsights,SQLSecurityAuditEvents,Timeouts,WorkloadManagement"  \|  AzureDiagnostics.Category contains "SQLSecurityAuditEvents"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.SQL"  \|  AzureDiagnostics.ResourceType == "SERVERS/DATABASES" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Data%20Connectors/template_AzureSql.JSON) |
| AzureStreamAnalytics_CCP | Azure Stream Analytics | AzureDiagnostics.ResourceProvider == "MICROSOFT.STREAMANALYTICS" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Stream%20Analytics/Data%20Connectors/AzureStreamAnalytics_CCP.JSON) |
| Barracuda | [Deprecated] Barracuda Web Application Firewall via Legacy A | CommonSecurityLog.DeviceVendor == "Barracuda" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Barracuda%20WAF/Data%20Connectors/template_Barracuda.json) |
| BroadcomSymantecDLP | [Deprecated] Broadcom Symantec DLP via Legacy Agent | CommonSecurityLog.DeviceProduct == "DLP"  \|  CommonSecurityLog.DeviceVendor == "Symantec" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Broadcom%20SymantecDLP/Data%20Connectors/Connector_Syslog_SymantecDLP.json) |
| BroadcomSymantecDLPAma | [Deprecated] Broadcom Symantec DLP via AMA | CommonSecurityLog.DeviceProduct =~ "DLP"  \|  CommonSecurityLog.DeviceVendor =~ "Symantec" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Broadcom%20SymantecDLP/Data%20Connectors/template_SymantecDLPAMA.json) |
| CEF | Common Event Format (CEF) | CommonSecurityLog.DeviceVendor !in "Cisco,Check Point,Palo Alto Networks,Fortinet,F5,Barracuda,ExtraHop,OneIdentity,Zscaler,ForgeRock Inc,Cyber-Ark,illusive,Vectra Networks,Citrix,Darktrace,Akamai,Aruba Networks,CrowdStrike,Symantec,Claroty,Contrast Security,Delinea Software,Thycotic Software,FireEye,Forcepoint CSG,Forcepoint,Forcepoint CASB,iboss,Illumio,Imperva Inc.,Infoblox,Morphisec,Netwrix,Nozomi,Onapsis,OSSEC,PingFederate,RidgeSecurity,SonicWall,Trend Micro,vArmour"  \|  CommonSecurityLog.DeviceVendor !in "Cisco,Check Point,Palo Alto Networks,Fortinet,F5,Barracuda,ExtraHop,OneIdentity,Zscaler,ForgeRock Inc,Cyber-Ark,illusive,Vectra Networks,Citrix,Darktrace,Akamai,Aruba Networks,CrowdStrike,Symantec,Claroty,Contrast Security,Delinea Software,Thycotic Software,FireEye,Forcepoint CSG,Forcepoint,Forcepoint CASB,iboss,Illumio,Imperva Inc.,Infoblox,Morphisec,Netwrix,Nozomi,Onapsis,OSSEC,PingFederate,RidgeSecurity,SonicWall,Trend Micro,vArmour,Votiro" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Common%20Event%20Format/Data%20Connectors/CEF.JSON) |
| CTERA | CTERA Syslog | Syslog.ProcessName == "gw-audit"  \|  Syslog.SyslogMessage contains "gw-audit[-]:"  \|  Syslog.SyslogMessage contains "portal portal[-]:" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Data%20Connectors/CTERA_Data_Connector.json) |
| CiscoASA | Cisco ASA via Legacy Agent | CommonSecurityLog.DeviceProduct == "ASA"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoASA/Data%20Connectors/CiscoASA.JSON) |
| CiscoAsaAma | Cisco ASA/FTD via AMA | CommonSecurityLog.DeviceProduct in "ASA,FTD"  \|  CommonSecurityLog.DeviceVendor == "Cisco" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoASA/Data%20Connectors/template_CiscoAsaAma.JSON) |
| CiscoFirepowerEStreamer | [Deprecated] Cisco Firepower eStreamer via Legacy Agent | CommonSecurityLog.DeviceProduct == "Firepower"  \|  CommonSecurityLog.DeviceVendor == "Cisco" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cisco%20Firepower%20EStreamer/Data%20Connectors/CiscoFirepowerEStreamerCollector.json) |
| CiscoFirepowerEStreamerAma | [Deprecated] Cisco Firepower eStreamer via AMA | CommonSecurityLog.DeviceProduct =~ "Firepower"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cisco%20Firepower%20EStreamer/Data%20Connectors/template_CiscoFirepowerEStreamerAMA.json) |
| CiscoSEGAma | [Deprecated] Cisco Secure Email Gateway via AMA | CommonSecurityLog.DeviceProduct =~ "ESA_CONSOLIDATED_LOG_EVENT"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoSEG/Data%20Connectors/template_CiscoSEGAMA.json) |
| CitrixWAF | [Deprecated] Citrix WAF (Web App Firewall) via Legacy Agent | CommonSecurityLog.DeviceProduct == "NetScaler"  \|  CommonSecurityLog.DeviceVendor == "Citrix" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Citrix%20Web%20App%20Firewall/Data%20Connectors/Citrix_WAF.json) |
| CitrixWAFAma | [Deprecated] Citrix WAF (Web App Firewall) via AMA | CommonSecurityLog.DeviceProduct =~ "NetScaler"  \|  CommonSecurityLog.DeviceVendor =~ "Citrix" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Citrix%20Web%20App%20Firewall/Data%20Connectors/template_Citrix_WAFAMA.json) |
| ClarotyAma | [Deprecated] Claroty via AMA | CommonSecurityLog.DeviceVendor =~ "Claroty" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Claroty/Data%20Connectors/template_ClarotyAMA.json) |
| ClarotyxDome | Claroty xDome | CommonSecurityLog.DeviceVendor in "Claroty,Medigate" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Claroty%20xDome/Data%20Connectors/Claroty_xDome.json) |
| ContrastProtect | [Deprecated] Contrast Protect via Legacy Agent | CommonSecurityLog.DeviceVendor == "Contrast Security" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Data%20Connectors/ContrastProtect.json) |
| ContrastProtectAma | [Deprecated] Contrast Protect via AMA | CommonSecurityLog.DeviceVendor =~ "Contrast Security" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Data%20Connectors/template_ContrastProtectAMA.json) |
| CrowdStrikeFalconEndpointProtection | [Deprecated] CrowdStrike Falcon Endpoint Protection via Lega | CommonSecurityLog.DeviceProduct == "FalconHost"  \|  CommonSecurityLog.DeviceVendor == "CrowdStrike" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CrowdStrike%20Falcon%20Endpoint%20Protection/Data%20Connectors/Connector_Syslog_CrowdStrikeFalconEndpointProtection.json) |
| CrowdStrikeFalconEndpointProtectionAma | [Deprecated] CrowdStrike Falcon Endpoint Protection via AMA | CommonSecurityLog.DeviceProduct =~ "FalconHost"  \|  CommonSecurityLog.DeviceVendor =~ "CrowdStrike" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CrowdStrike%20Falcon%20Endpoint%20Protection/Data%20Connectors/template_CrowdStrikeFalconEndpointProtectionAma.json) |
| CyberArk | [Deprecated] CyberArk Enterprise Password Vault (EPV) Events | CommonSecurityLog.DeviceProduct == "Vault"  \|  CommonSecurityLog.DeviceVendor == "Cyber-Ark" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CyberArk%20Enterprise%20Password%20Vault%20%28EPV%29%20Events/Data%20Connectors/CyberArk%20Data%20Connector.json) |
| CyberArkAma | [Deprecated] CyberArk Privilege Access Manager (PAM) Events  | CommonSecurityLog.DeviceProduct =~ "Vault"  \|  CommonSecurityLog.DeviceVendor =~ "Cyber-Ark" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CyberArk%20Enterprise%20Password%20Vault%20%28EPV%29%20Events/Data%20Connectors/template_CyberArkAMA.json) |
| DDOS | Azure DDoS Protection | AzureDiagnostics.Category == "DDoSMitigationReports"  \|  AzureDiagnostics.ResourceType == "PUBLICIPADDRESSES" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20DDoS%20Protection/Data%20Connectors/DDOS.JSON) |
| Darktrace | [Deprecated] AI Analyst Darktrace via Legacy Agent | CommonSecurityLog.DeviceVendor == "Darktrace" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AI%20Analyst%20Darktrace/Data%20Connectors/AIA-Darktrace.json) |
| DarktraceAma | [Deprecated] AI Analyst Darktrace via AMA | CommonSecurityLog.DeviceVendor =~ "Darktrace" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AI%20Analyst%20Darktrace/Data%20Connectors/template_AIA-DarktraceAMA.json) |
| DelineaSecretServerAma | [Deprecated] Delinea Secret Server via AMA | CommonSecurityLog.DeviceProduct =~ "Secret Server"  \|  CommonSecurityLog.DeviceVendor in~ "Delinea Software,Thycotic Software" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Delinea%20Secret%20Server/Data%20Connectors/template_DelineaSecretServerAMA.json) |
| DelineaSecretServer_CEF | [Deprecated] Delinea Secret Server via Legacy Agent | CommonSecurityLog.DeviceProduct == "Secret Server"  \|  CommonSecurityLog.DeviceVendor in "Delinea Software,Thycotic Software" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Delinea%20Secret%20Server/Data%20Connectors/DelineaSecretServer_CEF.json) |
| ESI-ExchangeAdminAuditLogEvents | [Deprecated] Microsoft Exchange Logs and Events | Event.EventLog in "Application,MSExchange Management,System" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Exchange%20Security%20-%20Exchange%20On-Premises/Data%20Connectors/ESI-ExchangeAdminAuditLogEvents.json) |
| ESI-Opt1ExchangeAdminAuditLogsByEventLogs | Microsoft Exchange Admin Audit Logs by Event Logs | Event.EventLog == "MSExchange Management" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Exchange%20Security%20-%20Exchange%20On-Premises/Data%20Connectors/ESI-Opt1ExchangeAdminAuditLogsByEventLogs.json) |
| ESI-Opt2ExchangeServersEventLogs | Microsoft Exchange Logs and Events | Event.EventLog == "Application" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Exchange%20Security%20-%20Exchange%20On-Premises/Data%20Connectors/ESI-Opt2ExchangeServersEventLogs.json) |
| ExtraHopNetworks | [Deprecated] ExtraHop Reveal(x) via Legacy Agent | CommonSecurityLog.DeviceEventClassID == "ExtraHop Detection"  \|  CommonSecurityLog.DeviceVendor == "ExtraHop" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ExtraHop%20Reveal%28x%29/Data%20Connectors/template_ExtraHopNetworks.json) |
| ExtraHopNetworksAma | [Deprecated] ExtraHop Reveal(x) via AMA | CommonSecurityLog.DeviceEventClassID == "ExtraHop Detection"  \|  CommonSecurityLog.DeviceVendor =~ "ExtraHop" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ExtraHop%20Reveal%28x%29/Data%20Connectors/template_ExtraHopReveal%28x%29AMA.json) |
| F5 | [Deprecated] F5 Networks via Legacy Agent | CommonSecurityLog.DeviceVendor == "F5" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/F5%20Networks/Data%20Connectors/template_F5.json) |
| F5Ama | [Deprecated] F5 Networks via AMA | CommonSecurityLog.DeviceVendor =~ "F5" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/F5%20Networks/Data%20Connectors/template_F5NetworksAMA.json) |
| FireEyeNXAma | [Deprecated] FireEye Network Security (NX) via AMA | CommonSecurityLog.DeviceVendor =~ "FireEye" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FireEye%20Network%20Security/Data%20Connectors/template_FireEyeNX_CEFAMA.json) |
| ForcepointCSG | [Deprecated] Forcepoint CSG via Legacy Agent | CommonSecurityLog.DeviceProduct in "Email,Web"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint CSG" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20CSG/Data%20Connectors/ForcepointCloudSecurityGateway.json) |
| ForcepointCSGAma | [Deprecated] Forcepoint CSG via AMA | CommonSecurityLog.DeviceProduct in~ "Email,Web"  \|  CommonSecurityLog.DeviceVendor =~ "Forcepoint CSG" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20CSG/Data%20Connectors/template_ForcepointCloudSecurityGatewayAMA.json) |
| ForcepointCasb | [Deprecated] Forcepoint CASB via Legacy Agent | CommonSecurityLog.DeviceVendor == "Forcepoint CASB" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20CASB/Data%20Connectors/Forcepoint%20CASB.json) |
| ForcepointCasbAma | [Deprecated] Forcepoint CASB via AMA | CommonSecurityLog.DeviceVendor =~ "Forcepoint CASB" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20CASB/Data%20Connectors/template_Forcepoint%20CASBAMA.json) |
| ForcepointNgfw | [Deprecated] Forcepoint NGFW via Legacy Agent | CommonSecurityLog.DeviceProduct == "NGFW"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20NGFW/Data%20Connectors/FORCEPOINT_NGFW.json) |
| ForcepointNgfwAma | [Deprecated] Forcepoint NGFW via AMA | CommonSecurityLog.DeviceProduct =~ "NGFW"  \|  CommonSecurityLog.DeviceVendor =~ "Forcepoint" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20NGFW/Data%20Connectors/template_FORCEPOINT_NGFWAMA.json) |
| ForgeRock | [Deprecated] ForgeRock Identity Platform | CommonSecurityLog.DeviceProduct == "IDM"  \|  CommonSecurityLog.DeviceVendor == "ForgeRock Inc" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ForgeRock%20Common%20Audit%20for%20CEF/Data%20Connectors/ForgeRock_CEF.json) |
| Fortinet | [Deprecated] Fortinet via Legacy Agent | CommonSecurityLog.DeviceProduct startswith "Fortigate"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Fortinet%20FortiGate%20Next-Generation%20Firewall%20connector%20for%20Microsoft%20Sentinel/Data%20Connectors/Fortinet-FortiGate.json) |
| FortinetAma | [Deprecated] Fortinet via AMA | CommonSecurityLog.DeviceProduct =~ "Fortigate"  \|  CommonSecurityLog.DeviceProduct startswith "Fortigate"  \|  CommonSecurityLog.DeviceVendor =~ "Fortinet" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Fortinet%20FortiGate%20Next-Generation%20Firewall%20connector%20for%20Microsoft%20Sentinel/Data%20Connectors/template_Fortinet-FortiGateAma.json) |
| FortinetFortiWeb | [Deprecated] Fortinet FortiWeb Web Application Firewall via  | CommonSecurityLog.DeviceProduct == "Fortiweb"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Fortinet%20FortiWeb%20Cloud%20WAF-as-a-Service%20connector%20for%20Microsoft%20Sentinel/Data%20Connectors/Fortiweb.json) |
| FortinetFortiWebAma | Fortinet FortiWeb Web Application Firewall via AMA | CommonSecurityLog.DeviceProduct contains "Fortiweb"  \|  CommonSecurityLog.DeviceVendor contains "Fortinet" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Fortinet%20FortiWeb%20Cloud%20WAF-as-a-Service%20connector%20for%20Microsoft%20Sentinel/Data%20Connectors/template_FortiwebAma.json) |
| IllumioCoreAma | [Deprecated] Illumio Core via AMA | CommonSecurityLog.DeviceVendor =~ "Illumio" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Illumio%20Core/Data%20Connectors/template_IllumioCoreAMA.json) |
| ImpervaWAFGateway | Imperva WAF Gateway | CommonSecurityLog.DeviceProduct == "WAF Gateway"  \|  CommonSecurityLog.DeviceVendor in "Imperva,Imperva Inc." | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Imperva%20WAF%20Gateway/Data%20Connectors/Connector_Imperva_WAF_Gateway.json) |
| InfobloxCloudDataConnector | [Deprecated] Infoblox Cloud Data Connector via Legacy Agent | CommonSecurityLog.DeviceEventClassID == "DHCP-LEASE-CREATE"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DNS"  \|  CommonSecurityLog.DeviceEventClassID has_cs "RPZ"  \|  CommonSecurityLog.DeviceProduct == "Data Connector"  \|  CommonSecurityLog.DeviceVendor == "Infoblox" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Data%20Connectors/InfobloxCloudDataConnector.json) |
| InfobloxCloudDataConnectorAma | [Recommended] Infoblox Cloud Data Connector via AMA | CommonSecurityLog.DeviceEventClassID == "DHCP-LEASE-CREATE"  \|  CommonSecurityLog.DeviceEventClassID has_cs "Audit"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DHCP"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DNS"  \|  CommonSecurityLog.DeviceEventClassID has_cs "RPZ"  \|  CommonSecurityLog.DeviceEventClassID has_cs "Service"  \|  CommonSecurityLog.DeviceProduct =~ "Data Connector"  \|  CommonSecurityLog.DeviceVendor =~ "Infoblox" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox/Data%20Connectors/InfobloxCEFDataConnector/template_InfobloxCloudDataConnectorAma.JSON) |
| InfobloxSOCInsightsDataConnector_AMA | [Recommended] Infoblox SOC Insight Data Connector via AMA | CommonSecurityLog.DeviceEventClassID =~ "BloxOne-InsightsNotification-Log"  \|  CommonSecurityLog.DeviceProduct =~ "Data Connector"  \|  CommonSecurityLog.DeviceVendor =~ "Infoblox" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox/Data%20Connectors/InfobloxSOCInsights/InfobloxSOCInsightsDataConnector_AMA.json) |
| InfobloxSOCInsightsDataConnector_Legacy | [Deprecated] Infoblox SOC Insight Data Connector via Legacy  | CommonSecurityLog.DeviceEventClassID == "BloxOne-InsightsNotification-Log"  \|  CommonSecurityLog.DeviceProduct == "Data Connector"  \|  CommonSecurityLog.DeviceVendor == "Infoblox" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox/Data%20Connectors/InfobloxSOCInsights/InfobloxSOCInsightsDataConnector_Legacy.json) |
| IronNetIronDefense | IronNet IronDefense | CommonSecurityLog.DeviceProduct in "IronDefense,IronDome"  \|  CommonSecurityLog.DeviceVendor == "IronNet" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/IronNet%20IronDefense/Data%20Connectors/IronNetIronDefense.json) |
| MicrosoftSysmonForLinux | [Deprecated] Microsoft Sysmon For Linux | Syslog.ProcessName == "sysmon" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Sysmon%20For%20Linux/Data%20Connectors/SysmonForLinux.json) |
| MicrosoftThreatProtection | Microsoft Defender XDR | DeviceRegistryEvents.ActionType == "RegistryValueSet" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Data%20Connectors/MicrosoftThreatProtection.JSON) |
| NasuniEdgeAppliance | [Deprecated] Nasuni Edge Appliance | Syslog.Facility != "cron" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Nasuni/Data%20Connectors/Nasuni%20Data%20Connector.json) |
| NetwrixAma | [Deprecated] Netwrix Auditor via AMA | CommonSecurityLog.DeviceVendor =~ "Netwrix" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Netwrix%20Auditor/Data%20Connectors/template_NetwrixAuditorAMA.json) |
| NozomiNetworksN2OSAma | [Deprecated] Nozomi Networks N2OS via AMA | CommonSecurityLog.DeviceVendor has "Nozomi" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/NozomiNetworks/Data%20Connectors/template_NozomiNetworksN2OSAMA.json) |
| OSSECAma | [Deprecated] OSSEC via AMA | CommonSecurityLog.DeviceVendor =~ "OSSEC" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/OSSEC/Data%20Connectors/template_OSSECAMA.json) |
| Office365 | Microsoft 365 (formerly, Office 365) | OfficeActivity.OfficeWorkload in "Exchange,MicrosoftTeams,OneDrive,SharePoint" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Data%20Connectors/Microsoft365.JSON) |
| OnapsisPlatform | [Deprecated] Onapsis Platform | CommonSecurityLog.DeviceProduct == "OSP"  \|  CommonSecurityLog.DeviceVendor == "Onapsis" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Onapsis%20Platform/Data%20Connectors/OnapsisPlatform.json) |
| OneIdentity | One Identity Safeguard | CommonSecurityLog.DeviceProduct == "SPS"  \|  CommonSecurityLog.DeviceVendor == "OneIdentity" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/OneIdentity/Data%20Connectors/OneIdentity.JSON) |
| PaloAltoCDLAma | [Deprecated] Palo Alto Networks Cortex Data Lake (CDL) via A | CommonSecurityLog.DeviceProduct =~ "LF"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAltoCDL/Data%20Connectors/template_PaloAlto_CDLAMA.json) |
| PaloAltoNetworks | [Deprecated] Palo Alto Networks (Firewall) via Legacy Agent | CommonSecurityLog.DeviceProduct has "PAN-OS"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Data%20Connectors/PaloAltoNetworks.json) |
| PaloAltoNetworksAma | [Deprecated] Palo Alto Networks (Firewall) via AMA | CommonSecurityLog.DeviceProduct =~ "PAN-OS"  \|  CommonSecurityLog.DeviceProduct has "PAN-OS"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Data%20Connectors/template_PaloAltoNetworksAMA.json) |
| PaloAltoNetworksCortex | Palo Alto Networks Cortex XDR | CommonSecurityLog.DeviceProduct == "Cortex XDR"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Palo%20Alto%20-%20XDR%20%28Cortex%29/Data%20Connectors/Connector_PaloAlto_XDR_CEF.json) |
| PingFederateAma | [Deprecated] PingFederate via AMA | CommonSecurityLog.DeviceProduct has "PingFederate" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PingFederate/Data%20Connectors/template_PingFederateAMA.json) |
| RadiflowIsid | Radiflow iSID via AMA | CommonSecurityLog.DeviceProduct =~ "iSID" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Data%20Connectors/RadiflowIsid.json) |
| RidgeBotDataConnector | [Deprecated] RIDGEBOT - data connector for Microsoft Sentine | CommonSecurityLog.DeviceEventClassID == "4001"  \|  CommonSecurityLog.DeviceVendor == "RidgeSecurity" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/RidgeSecurity/Data%20Connectors/RidgeSecurity.json) |
| SemperisDSP | Semperis Directory Services Protector | SecurityEvent.EventID in "9211,9212" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Data%20Connectors/SemperisDSP-connector.json) |
| SilverfortAma | Silverfort Admin Console | CommonSecurityLog.DeviceEventClassID == "NewIncident"  \|  CommonSecurityLog.DeviceProduct == "Admin Console"  \|  CommonSecurityLog.DeviceProduct has "Admin Console"  \|  CommonSecurityLog.DeviceVendor == "Silverfort"  \|  CommonSecurityLog.DeviceVendor has "Silverfort" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Silverfort/Data%20Connectors/SilverfortAma.json) |
| SonicWallFirewall | [Deprecated] SonicWall Firewall via Legacy Agent | CommonSecurityLog.DeviceVendor == "SonicWall" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SonicWall%20Firewall/Data%20Connectors/SonicwallFirewall.json) |
| SonicWallFirewallAma | [Deprecated] SonicWall Firewall via AMA | CommonSecurityLog.DeviceVendor =~ "SonicWall" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SonicWall%20Firewall/Data%20Connectors/template_SonicwallFirewallAMA.json) |
| Syslog | Syslog via Legacy Agent | Syslog.Facility != "cron" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Data%20Connectors/template_Syslog.json) |
| SyslogAma | Syslog via AMA | Syslog.Facility != "cron" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Data%20Connectors/template_SyslogAma.json) |
| TrendMicroApexOneAma | [Deprecated] Trend Micro Apex One via AMA | CommonSecurityLog.DeviceProduct =~ "Apex Central"  \|  CommonSecurityLog.DeviceVendor =~ "Trend Micro" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Trend%20Micro%20Apex%20One/Data%20Connectors/template_TrendMicro_ApexOneAMA.json) |
| Votiro | [Deprecated] Votiro Sanitization Engine Logs | CommonSecurityLog.DeviceProduct == "Votiro cloud"  \|  CommonSecurityLog.DeviceVendor == "Votiro" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Votiro/Data%20Connectors/VotiroEvents.json) |
| WAF | Azure Web Application Firewall (WAF) | AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Data%20Connectors/template_WAF.JSON) |
| WindowsFirewallAma | Windows Firewall Events via AMA | ASimNetworkSessionLogs.EventProduct == "Windows Firewall" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Firewall/Data%20Connectors/template_WindowsFirewallAma.JSON) |
| WireX_Systems_NFP | [Deprecated] WireX Network Forensics Platform via Legacy Age | CommonSecurityLog.DeviceProduct == "WireX NFP"  \|  CommonSecurityLog.DeviceVendor == "WireX" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/WireX%20Network%20Forensics%20Platform/Data%20Connectors/WireXsystemsNFP%281b%29.json) |
| WireX_Systems_NFPAma | [Deprecated] WireX Network Forensics Platform via AMA | CommonSecurityLog.DeviceProduct =~ "WireX NFP"  \|  CommonSecurityLog.DeviceVendor =~ "WireX" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/WireX%20Network%20Forensics%20Platform/Data%20Connectors/template_WireXsystemsNFPAMA.json) |
| WithSecureElementsViaConnector | [Deprecated] WithSecure Elements via Connector | CommonSecurityLog.DeviceVendor == "WithSecureâ„¢" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/WithSecureElementsViaConnector/Data%20Connectors/WithSecureElementsViaConnector.json) |
| Zscaler | [Deprecated] Zscaler via Legacy Agent | CommonSecurityLog.DeviceVendor == "Zscaler" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Data%20Connectors/template_Zscaler.JSON) |
| ZscalerAma | [Deprecated] Zscaler via AMA | CommonSecurityLog.DeviceVendor =~ "Zscaler" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Data%20Connectors/template_ZscalerAma.JSON) |
| iboss | [Deprecated] iboss via Legacy Agent | CommonSecurityLog.DeviceVendor =~ "iboss" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/iboss/Data%20Connectors/iboss_cef.json) |
| ibossAma | iboss via AMA | CommonSecurityLog.DeviceVendor =~ "iboss" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/iboss/Data%20Connectors/template_ibossAMA.json) |
| illusiveAttackManagementSystem | [Deprecated] Illusive Platform via Legacy Agent | CommonSecurityLog.DeviceEventClassID in "illusive:access,illusive:login,illusive:suspicious"  \|  CommonSecurityLog.DeviceProduct == "illusive"  \|  CommonSecurityLog.DeviceVendor == "illusive" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Illusive%20Platform/Data%20Connectors/illusive%20Attack%20Management%20System.json) |
| illusiveAttackManagementSystemAma | [Deprecated] Illusive Platform via AMA | CommonSecurityLog.DeviceEventClassID in "illusive:access,illusive:login,illusive:suspicious"  \|  CommonSecurityLog.DeviceProduct =~ "illusive"  \|  CommonSecurityLog.DeviceVendor =~ "illusive" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Illusive%20Platform/Data%20Connectors/template_IllusivePlatformAMA.json) |
| vArmourAC | [Deprecated] vArmour Application Controller via Legacy Agent | CommonSecurityLog.DeviceProduct == "AC"  \|  CommonSecurityLog.DeviceVendor == "vArmour" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/vArmour%20Application%20Controller/Data%20Connectors/Connector_vArmour_AppController_CEF.json) |
| vArmourACAma | [Deprecated] vArmour Application Controller via AMA | CommonSecurityLog.DeviceProduct =~ "AC"  \|  CommonSecurityLog.DeviceVendor =~ "vArmour" | [Link](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/vArmour%20Application%20Controller/Data%20Connectors/template_vArmour_AppControllerAMA.json) |

## Content Items with Filter Fields

Total: 1023 content items

### 

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | AD Account Lockout | SecurityEvent.EventID == "4740" | SecurityEvent/ADAccountLockouts.yaml |
| hunting_query | AD FS Database Local SQL Statements | Event.EventID == "33205"  \|  Event.EventLog =~ "Application"  \|  Event.Source == "MSSQL$MICROSOFT##WID" | SecurityEvent/ADFSDBLocalSqlStatements.yaml |
| hunting_query | ADFSDomainTrustMods[Nobelium] | CloudAppEvents.ActionType in~ "Set domain authentication.,Set federation settings on domain." | Microsoft 365 Defender/Defense evasion/ADFSDomainTrustMods[Nobelium].yaml |
| hunting_query | AI Agents - Dormant Author Authentication Connecti | CloudAppEvents.ActionType == "CopilotInteraction" | AI Agents/DormantAuthorAuthenticationAIAgents.yaml |
| hunting_query | AI Agents - Published Dormant (30d) | CloudAppEvents.ActionType == "CopilotInteraction" | AI Agents/PublishedDormantAIAgents.yaml |
| hunting_query | AIR investigation actions insight | CloudAppEvents.ActionType == "AirInvestigationData" | Microsoft 365 Defender/Email and Collaboration Queries/Remediation/AIR investigation actions insight.yaml |
| hunting_query | ARS Ransomware Event triggered | DeviceEvents.ActionType has_any "AsrRansomwareAudited,AsrRansomwareBlocked" | Microsoft 365 Defender/Ransomware/ASR--Rule-Ransomware-triggered.yaml |
| hunting_query | ASR rules categorized detection graph | DeviceEvents.ActionType in "AsrAdobeReaderChildProcessBlocked,AsrExecutableEmailContentBlocked,AsrExecutableOfficeContentBlocked,AsrLsassCredentialTheftBlocked,AsrObfuscatedScriptBlocked,AsrOfficeChildProcessBlocked,AsrOfficeCommAppChildProcessBlocked,AsrOfficeMacroWin32ApiCallsBlocked,AsrOfficeProcessInjectionBlocked,AsrPersistenceThroughWmiBlocked,AsrPsexecWmiChildProcessBlocked,AsrRansomwareBlocked,AsrScriptExecutableDownloadBlocked,AsrUntrustedExecutableBlocked,AsrUntrustedUsbProcessBlocked,AsrVulnerableSignedDriverBlocked"  \|  DeviceEvents.ActionType startswith "asr" | Microsoft 365 Defender/ASR rules/ASR-rules-categorized-detection-graph.yaml |
| hunting_query | ATP policy status check | CloudAppEvents.ActionType == "Set-AtpPolicyForO365" | Microsoft 365 Defender/Email and Collaboration Queries/Attachment/ATP policy status check.yaml |
| hunting_query | AV Detections with Source | DeviceEvents.ActionType == "AntivirusDetection" | Microsoft 365 Defender/Protection events/AV Detections with Source.yaml |
| hunting_query | AV Detections with USB Disk Drive | DeviceEvents.ActionType in "AntivirusDetection,PnpDeviceConnected" | Microsoft 365 Defender/Protection events/AV Detections with USB Disk Drive.yaml |
| hunting_query | Account MFA Modifications | AuditLogs.OperationName in~ "Admin deleted security info,Admin registered security info,Admin updated security info,User changed default security info,User deleted security info,User registered all required security info,User registered security info,User started security info registration" | AuditLogs/AccountMFAModifications.yaml |
| hunting_query | Active Directory Sensitive Group Modifications | IdentityDirectoryEvents.ActionType == "Group Membership changed" | Microsoft 365 Defender/Credential Access/Active Directory Sensitive Group Modifications.yaml |
| hunting_query | Add uncommon credential type to application [Nobel | CloudAppEvents.ActionType in "Add service principal credentials.,Update application - Certificates and secrets management" | Microsoft 365 Defender/Privilege escalation/Add uncommon credential type to application [Nobelium].yaml |
| hunting_query | AddedCredentialFromContryXAndSigninFromCountryY | CloudAppEvents.ActionType in "Add service principal credentials.,Update application - Certificates and secrets management" | Microsoft 365 Defender/Persistence/AddedCredentialFromContryXAndSigninFromCountryY.yaml |
| hunting_query | Admin Submission Trend (FN) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submission Trend - FN.yaml |
| hunting_query | Admin Submission Trend (FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submission Trend - FP.yaml |
| hunting_query | Admin Submissions by Detection Type | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Detection Type.yaml |
| hunting_query | Admin Submissions by DetectionMethod (Phish FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Detection Method - Phish FP.yaml |
| hunting_query | Admin Submissions by DetectionMethod (Spam FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Detection Method - Spam FP.yaml |
| hunting_query | Admin Submissions by Grading verdict (FN-FP) | CloudAppEvents.ActionType contains "AdminSubmissionTriage" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Grading Verdict - FN-FP.yaml |
| hunting_query | Admin Submissions by Submission State (FN) | CloudAppEvents.ActionType contains "AdminSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Submission State - FN.yaml |
| hunting_query | Admin Submissions by Submission State (FP) | CloudAppEvents.ActionType contains "AdminSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Submission State - FP.yaml |
| hunting_query | Admin Submissions by Submission Type (FN) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Submission Type - FN.yaml |
| hunting_query | Admin Submissions by Submission Type (FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Admin Submissions by Submission Type - FP.yaml |
| hunting_query | Anomaly of MailItemAccess by GraphAPI [Nobelium] | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Exfiltration/Anomaly of MailItemAccess by GraphAPI [Nobelium].yaml |
| hunting_query | Anomaly of MailItemAccess by Other Users Mailbox [ | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Collection/Anomaly of MailItemAccess by Other Users Mailbox [Nobelium].yaml |
| hunting_query | Antivirus detections | DeviceEvents.ActionType == "AntivirusDetection" | Microsoft 365 Defender/Protection events/Antivirus detections.yaml |
| hunting_query | Approved Access Packages Details | AuditLogs.OperationName in "Approve access package assignment request,Request approved,User requests access package assignment" | AuditLogs/ApprovedAccessPackagesDetails.yaml |
| hunting_query | BEC - File sharing tactics - Dropbox | CloudAppEvents.ActionType in "Added users and/or groups to shared file/folder,Invited user to Dropbox and added them to shared file/folder" | Microsoft 365 Defender/Email and Collaboration Queries/Hunting/BEC - File sharing tactics - Dropbox.yaml |
| hunting_query | BEC - File sharing tactics - OneDrive or SharePoin | CloudAppEvents.ActionType in "AddedToSecureLink,SecureLinkCreated" | Microsoft 365 Defender/Email and Collaboration Queries/Hunting/BEC - File sharing tactics - OneDrive or SharePoint.yaml |
| hunting_query | Baseline Comparison | DeviceImageLoadEvents.ActionType == "PowerShellCommand" | Microsoft 365 Defender/General queries/Baseline Comparison.yaml |
| hunting_query | BitLocker Key Retrieval | AuditLogs.OperationName =~ "Read BitLocker key" | AuditLogs/BitLockerKeyRetrieval.yaml |
| hunting_query | C2-NamedPipe | DeviceEvents.ActionType == "NamedPipeEvent" | Microsoft 365 Defender/Command and Control/C2-NamedPipe.yaml |
| hunting_query | CVE-2022-22965 Network Activity | DeviceNetworkEvents.ActionType =~ "NetworkSignatureInspected" | Microsoft 365 Defender/Exploits/CVE-2022-22965 Network Activity.yaml |
| hunting_query | Calculate overall MDO efficacy | CloudAppEvents.ActionType in "AdminSubmissionSubmitted,Malware ZAP,Phish ZAP,Redelivery" | Microsoft 365 Defender/Email and Collaboration Queries/General/Calculate MDO Efficacy.yaml |
| hunting_query | Changes to Blocked Teams Domains | CloudAppEvents.ActionType == "TeamsAdminAction" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Changes to Blocked Teams Domains.yaml |
| hunting_query | Changes to Blocked Teams Domains (NRT) | CloudAppEvents.ActionType == "TeamsAdminAction" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Changes to Blocked Teams Domains (NRT).yaml |
| hunting_query | Code Repo Exfiltration | CloudAppEvents.ActionType =~ "FileUploadedToCloud" | Microsoft 365 Defender/Exfiltration/codeRepoExfil.yaml |
| hunting_query | Connectivity Failures by Device | DeviceNetworkEvents.ActionType == "ConnectionFailed" | Microsoft 365 Defender/Troubleshooting/Connectivity Failures by Device.yaml |
| hunting_query | Connectivity Failures by Domain | DeviceNetworkEvents.ActionType == "ConnectionFailed" | Microsoft 365 Defender/Troubleshooting/Connectivity Failures by Domain.yaml |
| hunting_query | Create account (1) | DeviceEvents.ActionType == "UserAccountCreated" | Microsoft 365 Defender/Persistence/Create account (1).yaml |
| hunting_query | CredentialsAddAfterAdminConsentedToApp[Nobelium] | CloudAppEvents.ActionType in "Add service principal credentials.,Consent to application.,Update application - Certificates and secrets management" | Microsoft 365 Defender/Persistence/CredentialsAddAfterAdminConsentedToApp[Nobelium].yaml |
| hunting_query | Critical user management operations followed by di | WindowsEvent.EventID == "4688" | MultipleDataSources/CriticalOperationsWithSystemrestore.yaml |
| hunting_query | DNSPattern [Nobelium] | DeviceEvents.ActionType in "DNS query,DnsQueryResponse" | Microsoft 365 Defender/Command and Control/DNSPattern [Nobelium].yaml |
| hunting_query | Data copied to other location than C drive | DeviceFileEvents.ActionType == "FileCreated" | Microsoft 365 Defender/Exfiltration/Data copied to other location than C drive.yaml |
| hunting_query | Detect potential kerberoast activities | IdentityLogonEvents.ActionType == "LogonSuccess" | Microsoft 365 Defender/Execution/detect-potential-kerberoast-activities.yaml |
| hunting_query | Doc attachment with link to download | DeviceEvents.ActionType == "BrowserLaunchedToOpenUrl" | Microsoft 365 Defender/Delivery/Doc attachment with link to download.yaml |
| hunting_query | Dormant Service Principal Update Creds and Logs In | AuditLogs.OperationName in "Add service principal credentials,Update application - Certificates and secrets management" | MultipleDataSources/DormantServicePrincipalUpdateCredsandLogsIn.yaml |
| hunting_query | Dormant User Update MFA and Logs In | AuditLogs.OperationName =~ "User registered security info" | MultipleDataSources/DormantUserUpdateMFAandLogsIn.yaml |
| hunting_query | Dormant User Update MFA and Logs In - UEBA | AuditLogs.OperationName =~ "User registered security info" | MultipleDataSources/DormantUserUpdateMFAandLogsIn-UEBA.yaml |
| hunting_query | Email link + download + SmartScreen warning | DeviceEvents.ActionType in "BrowserLaunchedToOpenUrl,SmartScreenAppWarning,SmartScreenUserOverride" | Microsoft 365 Defender/Delivery/Email link + download + SmartScreen warning.yaml |
| hunting_query | EncodedDomainURL [Nobelium] | DeviceEvents.ActionType in "DNS query,DnsQueryResponse" | Microsoft 365 Defender/Command and Control/EncodedDomainURL [Nobelium].yaml |
| hunting_query | ExploitGuardASRStats | DeviceEvents.ActionType endswith "Audited"  \|  DeviceEvents.ActionType startswith "Asr" | Microsoft 365 Defender/Protection events/ExploitGuardASRStats.yaml |
| hunting_query | ExploitGuardASRStats (1) | DeviceEvents.ActionType endswith "Blocked"  \|  DeviceEvents.ActionType startswith "Asr" | Microsoft 365 Defender/Protection events/ExploitGuardASRStats (1).yaml |
| hunting_query | ExploitGuardASRStats (2) | DeviceEvents.ActionType endswith "Audited"  \|  DeviceEvents.ActionType startswith "ASR" | Microsoft 365 Defender/Protection events/ExploitGuardASRStats (2).yaml |
| hunting_query | ExploitGuardAsrDescriptions | DeviceEvents.ActionType startswith "Asr" | Microsoft 365 Defender/Protection events/ExploitGuardAsrDescriptions.yaml |
| hunting_query | ExploitGuardBlockOfficeChildProcess | DeviceEvents.ActionType == "AsrOfficeChildProcessBlocked" | Microsoft 365 Defender/Protection events/ExploitGuardBlockOfficeChildProcess.yaml |
| hunting_query | ExploitGuardBlockOfficeChildProcess (1) | DeviceEvents.ActionType == "AsrOfficeChildProcessAudited" | Microsoft 365 Defender/Protection events/ExploitGuardBlockOfficeChildProcess (1).yaml |
| hunting_query | ExploitGuardBlockOfficeChildProcess (2) | DeviceEvents.ActionType == "AsrOfficeChildProcessBlocked" | Microsoft 365 Defender/Protection events/ExploitGuardBlockOfficeChildProcess (2).yaml |
| hunting_query | ExploitGuardBlockOfficeChildProcess (3) | DeviceEvents.ActionType == "AsrOfficeChildProcessAudited" | Microsoft 365 Defender/Protection events/ExploitGuardBlockOfficeChildProcess (3).yaml |
| hunting_query | ExploitGuardControlledFolderAccess | DeviceEvents.ActionType startswith "ControlledFolderAccess" | Microsoft 365 Defender/Protection events/ExploitGuardControlledFolderAccess.yaml |
| hunting_query | ExploitGuardControlledFolderAccess (1) | DeviceEvents.ActionType startswith "ControlledFolderAccess" | Microsoft 365 Defender/Protection events/ExploitGuardControlledFolderAccess (1).yaml |
| hunting_query | ExploitGuardControlledFolderAccess (2) | DeviceEvents.ActionType contains "ControlledFolderAccess" | Microsoft 365 Defender/Protection events/ExploitGuardControlledFolderAccess (2).yaml |
| hunting_query | ExploitGuardNetworkProtectionEvents | DeviceEvents.ActionType =~ "ExploitGuardNetworkProtectionBlocked" | Microsoft 365 Defender/Protection events/ExploitGuardNetworkProtectionEvents.yaml |
| hunting_query | ExploitGuardStats | DeviceEvents.ActionType endswith "Blocked"  \|  DeviceEvents.ActionType startswith "ExploitGuard" | Microsoft 365 Defender/Protection events/ExploitGuardStats.yaml |
| hunting_query | ExploitGuardStats (1) | DeviceEvents.ActionType endswith "Audited"  \|  DeviceEvents.ActionType startswith "ExploitGuard" | Microsoft 365 Defender/Protection events/ExploitGuardStats (1).yaml |
| hunting_query | Fake computer account authentication attempt | SecurityEvent.EventID in "4624,4625" | SecurityEvent/FakeComputerAccountAuthenticationAttempt.yaml |
| hunting_query | File Copy and Execution | DeviceNetworkEvents.ActionType in "FileCreated,FileModified" | Microsoft 365 Defender/Execution/File Copy and Execution.yaml |
| hunting_query | File Malware Detection Trend | CloudAppEvents.ActionType == "FileMalwareDetected" | Microsoft 365 Defender/Email and Collaboration Queries/Malware/File Malware Detection Trend.yaml |
| hunting_query | File Malware by Top Malware Families (Anti Virus) | CloudAppEvents.ActionType == "FileMalwareDetected" | Microsoft 365 Defender/Email and Collaboration Queries/Malware/File Malware Top Families by AV.yaml |
| hunting_query | File Malware by Top Malware Families (Safe Attachm | CloudAppEvents.ActionType == "FileMalwareDetected" | Microsoft 365 Defender/Email and Collaboration Queries/Malware/File Malware Top Families by Safe Attachments.yaml |
| hunting_query | Files copied to USB drives | DeviceEvents.ActionType in "FileCreated,UsbDriveMounted" | Microsoft 365 Defender/Exfiltration/Files copied to USB drives.yaml |
| hunting_query | Firewall Policy Design Assistant | DeviceNetworkEvents.ActionType in "ConnectionFound,ConnectionRequest,ConnectionSuccess,InboundConnectionAccepted,ListeningConnectionCreated" | Microsoft 365 Defender/General queries/Firewall Policy Design Assistant.yaml |
| hunting_query | Group quarantine release | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | Microsoft 365 Defender/Email and Collaboration Queries/Quarantine/Group quarantine release.yaml |
| hunting_query | High Confidence Phish Released | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | Microsoft 365 Defender/Email and Collaboration Queries/Quarantine/High Confidence Phish Released.yaml |
| hunting_query | High Risk Sign In Around Authentication Method Add | AuditLogs.OperationName in "Register device,User registered security info" | MultipleDataSources/HighRiskSignInAroundAuthMethodOrDeviceRegistration.yaml |
| hunting_query | Hunt for Admin email access | CloudAppEvents.ActionType == "AdminMailAccess" | Microsoft 365 Defender/Email and Collaboration Queries/General/Hunt for Admin email access.yaml |
| hunting_query | Hunt for TABL changes | CloudAppEvents.ActionType contains "TenantAllowBlockListItems" | Microsoft 365 Defender/Email and Collaboration Queries/General/Hunt for TABL changes.yaml |
| hunting_query | ImpersonatedUserFootprint | AlertEvidence.ActionType == "LogonSuccess" | Microsoft 365 Defender/Lateral Movement/ImpersonatedUserFootprint.yaml |
| hunting_query | Inbox rule changes which forward-redirect email | CloudAppEvents.ActionType contains "Set-InboxRule" | Microsoft 365 Defender/Email and Collaboration Queries/Hunting/Inbox rule change which forward-redirect email.yaml |
| hunting_query | Invited Guest User but not redeemed Invite for lon | AuditLogs.OperationName in~ "Invite external user,Redeem external user invite" | AuditLogs/NonredeemedGuesUserInvites.yaml |
| hunting_query | KNOTWEED-COM Registry Key Modified to Point to Col | DeviceRegistryEvents.ActionType == "RegistryValueSet" | Microsoft 365 Defender/Campaigns/KNOTWEED/KNOTWEED-COMRegistryKeyModifiedtoPointtoColorProfileFolder.yaml |
| hunting_query | KNOTWEED-PE File Dropped in Color Profile Folder | DeviceFileEvents.ActionType == "FileCreated" | Microsoft 365 Defender/Campaigns/KNOTWEED/KNOTWEED-PEFileDroppedinColorProfileFolder.yaml |
| hunting_query | Large Scale Malware Deployment via GPO Scheduled T | SecurityEvent.EventID == "5145" | SecurityEvent/LargeScaleMalwareDeploymentGPOScheduledTask.yaml |
| hunting_query | LemonDuck-registration-function | DeviceEvents.ActionType == "PowerShellCommand" | Microsoft 365 Defender/Campaigns/LemonDuck/LemonDuck-registration-function.yaml |
| hunting_query | LocalAdminGroupChanges | DeviceEvents.ActionType == "UserAccountAddedToLocalGroup"  \|  DeviceEvents.ActionType contains "UserAccountCreated"  \|  DeviceEvents.ActionType contains "UserAccountModified" | Microsoft 365 Defender/Persistence/LocalAdminGroupChanges.yaml |
| hunting_query | MDO Threat Protection Detections trend over time | CloudAppEvents.ActionType in "AdminSubmission,Malware ZAP,Phish ZAP,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/General/Total number of detections by MDO over time.yaml |
| hunting_query | MDO daily detection summary report | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission"  \|  CloudAppEvents.ActionType contains "ZAP" | Microsoft 365 Defender/Email and Collaboration Queries/General/MDO daily detection summary report.yaml |
| hunting_query | MailItemsAccessed Throttling [Nobelium] | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Exfiltration/MailItemsAccessed Throttling [Nobelium].yaml |
| hunting_query | MailItemsAccessedTimeSeries[Solarigate] | CloudAppEvents.ActionType =~ "MailItemsAccessed" | Microsoft 365 Defender/Collection/MailItemsAccessedTimeSeries[Solarigate].yaml |
| hunting_query | MailPermissionsAddedToApplication[Nobelium] | CloudAppEvents.ActionType in "Add delegated permission grant.,Consent to application." | Microsoft 365 Defender/Defense evasion/MailPermissionsAddedToApplication[Nobelium].yaml |
| hunting_query | Malware detections by Workload Locations | CloudAppEvents.ActionType == "FileMalwareDetected" | Microsoft 365 Defender/Email and Collaboration Queries/Malware/Malware detections by Workload Locations.yaml |
| hunting_query | Malware detections by Workload Type | CloudAppEvents.ActionType == "FileMalwareDetected" | Microsoft 365 Defender/Email and Collaboration Queries/Malware/Malware detections by Workload Type.yaml |
| hunting_query | Map external devices | DeviceEvents.ActionType == "PnpDeviceConnected" | Microsoft 365 Defender/Exfiltration/Map external devices.yaml |
| hunting_query | Map external devices (1) | DeviceEvents.ActionType == "PnpDeviceConnected" | Microsoft 365 Defender/Exfiltration/Map external devices (1).yaml |
| hunting_query | MosaicLoader | DeviceRegistryEvents.ActionType == "RegistryValueSet" | Microsoft 365 Defender/Exploits/MosaicLoader.yaml |
| hunting_query | Multiple Entra ID Admin Removals | CloudAppEvents.ActionType in~ "Remove eligible member from role.,Remove member from role." | Microsoft 365 Defender/Persistence/multipleAADAdminsRemovals.yaml |
| hunting_query | Multiple Entra ID Admins Removed | AuditLogs.OperationName in~ "Remove eligible member from role,Remove member from role" | SigninLogs/multipleAADAdminRemovals.yaml |
| hunting_query | MultipleLdaps | IdentityQueryEvents.ActionType == "LDAP query" | Microsoft 365 Defender/Discovery/MultipleLdaps.yaml |
| hunting_query | MultipleSensitiveLdaps | IdentityQueryEvents.ActionType == "LDAP query" | Microsoft 365 Defender/Discovery/MultipleSensitiveLdaps.yaml |
| hunting_query | New TABL Items | CloudAppEvents.ActionType == "New-TenantAllowBlockListItems" | Microsoft 365 Defender/Email and Collaboration Queries/General/New TABL Items.yaml |
| hunting_query | NewAppOrServicePrincipalCredential[Nobelium] | CloudAppEvents.ActionType in "Add service principal credentials.,Add service principal.,Update application  Certificates and secrets management" | Microsoft 365 Defender/Persistence/NewAppOrServicePrincipalCredential[Nobelium].yaml |
| hunting_query | Number of unique accounts performing Teams message | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Number of unique accounts performing Teams message Admin submissions.yaml |
| hunting_query | Number of unique accounts performing Teams message | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Number of unique accounts performing Teams message User  submissions.yaml |
| hunting_query | OAuth Apps accessing user mail via GraphAPI [Nobel | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Exfiltration/OAuth Apps accessing user mail via GraphAPI [Nobelium].yaml |
| hunting_query | OAuth Apps reading mail both via GraphAPI and dire | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Exfiltration/OAuth Apps reading mail both via GraphAPI and directly [Nobelium].yaml |
| hunting_query | OAuth Apps reading mail via GraphAPI anomaly [Nobe | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Exfiltration/OAuth Apps reading mail via GraphAPI anomaly [Nobelium].yaml |
| hunting_query | OceanLotus registry activity | DeviceRegistryEvents.ActionType == "RegistryValueSet" | Microsoft 365 Defender/Campaigns/OceanLotus registry activity.yaml |
| hunting_query | Open email link | DeviceEvents.ActionType == "BrowserLaunchedToOpenUrl" | Microsoft 365 Defender/Delivery/Open email link.yaml |
| hunting_query | PUA ThreatName per Computer | DeviceEvents.ActionType == "AntivirusDetection" | Microsoft 365 Defender/Protection events/PUA ThreatName per Computer.yaml |
| hunting_query | PasswordSearch | IdentityQueryEvents.ActionType == "LDAP query" | Microsoft 365 Defender/Discovery/PasswordSearch.yaml |
| hunting_query | Pivot from detections to related downloads | DeviceEvents.ActionType == "AntivirusDetection" | Microsoft 365 Defender/Delivery/Pivot from detections to related downloads.yaml |
| hunting_query | Policy configuration changes for CloudApp Events | CloudAppEvents.ActionType in "Add owner to policy.,Add policy to service principal.,Add policy.,Delete policy.,Remove-CrossTenantAccessPolicy,Remove-LabelPolicy,Update authorization policy.,Update policy.,Write PolicyAssignments,Write PolicyExemptions" | CloudAppEvents/SetPolicyConfigInCloudAppEvents.yaml |
| hunting_query | Possible File Copy to USB Drive | DeviceEvents.ActionType == "PnpDeviceConnected" | Microsoft 365 Defender/Exfiltration/Possible File Copy to USB Drive.yaml |
| hunting_query | Possible SpringShell Exploitation Attempt (CVE-202 | AzureDiagnostics.Category in "ApplicationGatewayAccessLog,ApplicationGatewayFirewallLog,FrontdoorAccessLog,FrontdoorWebApplicationFirewallLog" | AzureDiagnostics/SpringShellExploitationAttempt.yaml |
| hunting_query | Possible Teams phishing activity | CloudAppEvents.ActionType == "ChatCreated" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Possible Teams phishing activity.yaml |
| hunting_query | Potential Local Exploitation for Privilege Escalat | Event.EventID == "1"  \|  Event.EventLog == "Microsoft-Windows-Sysmon/Operational" | SecurityEvent/PotentialLocalExploitationForPrivilegeEscalation.yaml |
| hunting_query | Potential Process Doppelganging | SecurityEvent.EventID == "4985" | SecurityEvent/PotentialProcessDoppelganging.yaml |
| hunting_query | PowershellCommand - uncommon commands on machine | DeviceEvents.ActionType == "PowerShellCommand" | Microsoft 365 Defender/Execution/PowershellCommand - uncommon commands on machine.yaml |
| hunting_query | PowershellCommand footprint | DeviceEvents.ActionType == "PowerShellCommand" | Microsoft 365 Defender/Execution/PowershellCommand footprint.yaml |
| hunting_query | Privileged Account Password Changes | AuditLogs.OperationName has_any "password,security info" | MultipleDataSources/PrivilegedAccountPasswordChanges.yaml |
| hunting_query | Quarantine Release Email Details | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | Microsoft 365 Defender/Email and Collaboration Queries/Quarantine/Quarantine Release Email Details.yaml |
| hunting_query | Quarantine release trend | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | Microsoft 365 Defender/Email and Collaboration Queries/Quarantine/Quarantine release trend.yaml |
| hunting_query | RID Hijacking | SecurityEvent.EventID in "4624,4625" | SecurityEvent/RIDHijacking.yaml |
| hunting_query | Rare firewall rule changes using netsh | Event.Source == "Microsoft-Windows-Sysmon"  \|  SecurityEvent.EventID == "1" | MultipleDataSources/FirewallRuleChanges_using_netsh.yaml |
| hunting_query | Recon Activity with Interactive Logon Correlation | SecurityEvent.EventID == "4624" | MultipleDataSources/ReconActivitywithInteractiveLogonCorrelation.yaml |
| hunting_query | Remote Task Creation/Update using Schtasks Process | SecurityEvent.EventID == "4688" | SecurityEvent/RemoteScheduledTaskCreationUpdateviaSchtasks.yaml |
| hunting_query | Risky Sign-in with Device Registration | AuditLogs.OperationName =~ "Add registered owner to device" | SigninLogs/riskSignInWithDeviceRegistration.yaml |
| hunting_query | Risky Sign-in with Device Registration | CloudAppEvents.ActionType =~ "Add registered owner to device." | Microsoft 365 Defender/Persistence/riskySignInToDeviceRegistration.yaml |
| hunting_query | Risky Sign-in with new MFA method | CloudAppEvents.ActionType =~ "Update user." | Microsoft 365 Defender/Persistence/riskySignInToNewMFAMethod.yaml |
| hunting_query | Roasting | DeviceNetworkEvents.ActionType == "LDAP query" | Microsoft 365 Defender/Discovery/Roasting.yaml |
| hunting_query | RunMRU with non-ASCII characters | DeviceRegistryEvents.ActionType == "RegistryValueSet" | Microsoft 365 Defender/Execution/RunMRUWithNonASCIICharacters.yaml |
| hunting_query | SAM-Name-Changes-CVE-2021-42278 | IdentityDirectoryEvents.ActionType == "SAM Account Name changed" | Microsoft 365 Defender/Privilege escalation/SAM-Name-Changes-CVE-2021-42278.yaml |
| hunting_query | SQL Alert Correlation with CommonSecurityLogs and  | CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | MultipleDataSources/SQLAlertCorrelationwithCommonSecurityLogsandAuditLogs.yaml |
| hunting_query | SensitiveLdaps | IdentityQueryEvents.ActionType == "LDAP query" | Microsoft 365 Defender/Discovery/SensitiveLdaps.yaml |
| hunting_query | ServicePrincipalAddedToRole [Nobelium] | CloudAppEvents.ActionType == "Add member to role." | Microsoft 365 Defender/Privilege escalation/ServicePrincipalAddedToRole [Nobelium].yaml |
| hunting_query | SmartScreen URL block ignored by user | DeviceEvents.ActionType in "SmartScreenUrlWarning,SmartScreenUserOverride" | Microsoft 365 Defender/Protection events/SmartScreen URL block ignored by user.yaml |
| hunting_query | SmartScreen app block ignored by user | DeviceEvents.ActionType in "SmartScreenAppWarning,SmartScreenUserOverride" | Microsoft 365 Defender/Protection events/SmartScreen app block ignored by user.yaml |
| hunting_query | SolarWinds -CVE-2021-35211 | DeviceNetworkEvents.ActionType == "ConnectionSuccess" | Microsoft 365 Defender/Exploits/SolarWinds -CVE-2021-35211.yaml |
| hunting_query | Status of submissions | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Status of submissions.yaml |
| hunting_query | Storage Alert Correlation with CommonSecurityLogs  | CommonSecurityLog.DeviceVendor =~ "Fortinet" | MultipleDataSources/StorageAlertCorrelationwithCommonSecurityLogsandStorageLogs.yaml |
| hunting_query | Storage Alerts Correlation with CommonSecurityLogs | CommonSecurityLog.DeviceVendor =~ "Fortinet" | MultipleDataSources/StorageAlertCorrelationwithCommonSecurityLogsandAuditLogs.yaml |
| hunting_query | Storage File Seen on Endpoint | DeviceFileEvents.ActionType =~ "FileCreated" | AzureStorage/AzureStorageFileOnEndpoint.yaml |
| hunting_query | Successful Sign-In From Non-Compliant Device with  | AuditLogs.OperationName has_any "Download group members,Download groups,Download user registeration details,Download users" | MultipleDataSources/NonCompliantSigninwithBulkDownload.yaml |
| hunting_query | Suspicious DLLs in spool folder | DeviceFileEvents.ActionType in "FileCreated,FileRenamed" | Microsoft 365 Defender/Exploits/Print Spooler RCE/Suspicious DLLs in spool folder.yaml |
| hunting_query | Suspicious command line tokens in LolBins or LolSc | SecurityEvent.EventID == "4688" | SecurityEvent/hunt_LOLBins.yaml |
| hunting_query | Suspicious sign-in attempts from QR code phishing  | CloudAppEvents.ActionType == "MailItemsAccessed" | Microsoft 365 Defender/Email and Collaboration Queries/QR code/Suspicious sign-in attempts from QR code phishing campaigns.yaml |
| hunting_query | SuspiciousUrlClicked | AlertEvidence.ActionType == "BrowserLaunchedToOpenUrl" | Microsoft 365 Defender/Initial access/SuspiciousUrlClicked.yaml |
| hunting_query | System Guard Security Level Baseline | DeviceEvents.ActionType == "DeviceBootAttestationInfo" | Microsoft 365 Defender/General queries/System Guard Security Level Baseline.yaml |
| hunting_query | System Guard Security Level Drop | DeviceEvents.ActionType == "DeviceBootAttestationInfo" | Microsoft 365 Defender/General queries/System Guard Security Level Drop.yaml |
| hunting_query | Teams Admin submission of Malware and Phish daily  | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Teams Admin submission of Malware and Phish daily trend.yaml |
| hunting_query | Teams Admin submission of No Threats daily trend | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Teams Admin submission of No Threats daily trend.yaml |
| hunting_query | Teams Admin-User Submissions Grading Verdicts | CloudAppEvents.ActionType in "AdminSubmissionTriage,UserSubmissionTriage" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Teams Admin-User Submissions Grading Verdicts.yaml |
| hunting_query | Teams User submissions daily trend | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Teams User submissions daily trend.yaml |
| hunting_query | Top 10 Detection Overrides - Admin Email Submissio | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Top Detection Overrides - Admin Submissions.yaml |
| hunting_query | Top 10 sender domains - Admin Teams message submis | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top 10 sender domains - Admin Teams message submissions FN.yaml |
| hunting_query | Top 10 sender domains - Admin email submissions (F | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Top Sender Domains - Admin Submissions FN.yaml |
| hunting_query | Top 10 sender domains - Admin email submissions (F | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Top Sender Domains - Admin Submissions FP.yaml |
| hunting_query | Top 10 sender domains - Teams user submissions FN  | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top 10 sender domains - Teams user submissions FN or FP.yaml |
| hunting_query | Top 10 senders - Teams users submissions FN or FP | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top 10 senders - Teams users submissions FN or FP.yaml |
| hunting_query | Top 10 senders of  Admin Teams message submissions | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top 10 senders of  Admin Teams message submissions FN.yaml |
| hunting_query | Top 10 senders of  Admin Teams message submissions | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top 10 senders of  Admin Teams message submissions FP.yaml |
| hunting_query | Top accounts performing Teams admin submissions FN | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top accounts performing Teams admin submissions FN or FP.yaml |
| hunting_query | Top accounts performing Teams user submissions FN  | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Microsoft Teams protection/Top accounts performing Teams user submissions FN or FP.yaml |
| hunting_query | Top accounts performing admin submissions (FN) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Top accounts performing admin submissions - FN.yaml |
| hunting_query | Top accounts performing admin submissions (FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Top accounts performing admin submissions - FP.yaml |
| hunting_query | Top accounts performing user submissions | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Top accounts performing user submissions.yaml |
| hunting_query | Total Submissions by Submission State | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Total Submissions by Submission State.yaml |
| hunting_query | Total Submissions by Submission Type | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/Total Submissions by Submission Type.yaml |
| hunting_query | Total number of detections by MDO | CloudAppEvents.ActionType in "AdminSubmission,Malware ZAP,Phish ZAP,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/General/Total number of detections by MDO.yaml |
| hunting_query | Unfamiliar Signin Correlation with AzurePortal Sig | AuditLogs.OperationName has_any "Add member to role" | MultipleDataSources/UnfamiliarsignincorrelationwithPortalSigninandAuditlogs.yaml |
| hunting_query | UpdateStsRefreshToken[Solorigate] | CloudAppEvents.ActionType == "Update StsRefreshTokenValidFrom Timestamp." | Microsoft 365 Defender/Defense evasion/UpdateStsRefreshToken[Solorigate].yaml |
| hunting_query | User Account Linked to Storage Account File Upload | SigninLogs.OperationName in~ "PutBlob,PutRange" | AzureStorage/AzureStorageUploadLinkAccount.yaml |
| hunting_query | User Email Submission Trend (FN) | CloudAppEvents.ActionType in "AttackSimUserSubmission,UserSubmission"  \|  CloudAppEvents.ActionType contains "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions Trend - FN.yaml |
| hunting_query | User Email Submissions (FN) - Top Detection Overri | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions - Top detection overrides by Admins.yaml |
| hunting_query | User Email Submissions (FN) - Top Detection Overri | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions - Top detection overrides by Users.yaml |
| hunting_query | User Email Submissions (FN) - Top Inbound P2 Sende | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions - Top email (P2) senders.yaml |
| hunting_query | User Email Submissions (FN) - Top Inbound P2 Sende | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions - Top email (P2) senders domains.yaml |
| hunting_query | User Email Submissions (FN) - Top Intra-Org P2 Sen | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions - Top Intra-Org P2 senders.yaml |
| hunting_query | User Email Submissions (FN) - Top Intra-Org Subjec | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions - Top Intra-Org Subjects.yaml |
| hunting_query | User Email Submissions (FN) by Submission Type | CloudAppEvents.ActionType in "AttackSimUserSubmission,UserSubmission"  \|  CloudAppEvents.ActionType contains "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions by Submission Type.yaml |
| hunting_query | User Email Submissions (FN-FP) by Grading verdict | CloudAppEvents.ActionType contains "UserSubmissionTriage" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions by Grading Verdict - FN-FP.yaml |
| hunting_query | User Email Submissions accuracy vs Admin review ve | CloudAppEvents.ActionType in "SubmissionNotification,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submission Accuracy versus Admin Verdicts.yaml |
| hunting_query | User Email Submissions by Admin review status (Mar | CloudAppEvents.ActionType in "SubmissionNotification,UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions by Admin review status.yaml |
| hunting_query | User clicks on malicious inbound emails | EmailEvents.ActionType == "ClickAllowed" | Microsoft 365 Defender/Email and Collaboration Queries/URL Click/User clicks on malicious inbound emails.yaml |
| hunting_query | User email submissions (FN) from Junk Folder | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User Submissions from Junk Folder.yaml |
| hunting_query | User navigation to redirected URL | DeviceEvents.ActionType == "BrowserLaunchedToOpenUrl" | Microsoft 365 Defender/Initial access/User navigation to redirected URL.yaml |
| hunting_query | User reported submissions | CloudAppEvents.ActionType == "UserSubmission" | Microsoft 365 Defender/Email and Collaboration Queries/Submissions/User reported submissions.yaml |
| hunting_query | VulnComputers | IdentityQueryEvents.ActionType == "LDAP query" | Microsoft 365 Defender/Discovery/VulnComputers.yaml |
| hunting_query | Web Content Filtering Events | DeviceEvents.ActionType in "ExploitGuardNetworkProtectionAudited,ExploitGuardNetworkProtectionBlocked"  \|  DeviceEvents.ActionType startswith_cs "SmartScreenUrl" | Microsoft 365 Defender/General queries/Web Content Filtering Events.yml |
| hunting_query | Windows Anitivirus and EDR Elevation of Privilege  | DeviceFileEvents.ActionType == "FileCreated" | Microsoft 365 Defender/Privilege escalation/detect-av-edr-privileged-delete-vulnerability.yaml |
| hunting_query | Windows Spooler Service Suspicious File Creation | DeviceFileEvents.ActionType == "FileCreated" | Microsoft 365 Defender/Exploits/print-pooler-service-suspicious-file-creation.yaml |
| hunting_query | Windows System Shutdown/Reboot(Sysmon) | Event.EventID == "1"  \|  Event.Source == "Microsoft-Windows-Sysmon" | SecurityEvent/WindowsSystemShutdown-Reboot.yaml |
| hunting_query | Windows filtering events (Firewall) | DeviceEvents.ActionType in "FirewallInboundConnectionBlocked,FirewallInboundConnectionToAppBlocked,FirewallOutboundConnectionBlocked" | Microsoft 365 Defender/Protection events/Windows filtering events (Firewall).yaml |
| hunting_query | anomalous-payload-delivered-from-iso-file | DeviceEvents.ActionType == "BrowserLaunchedToOpenUrl" | Microsoft 365 Defender/Execution/anomalous-payload-delivered-from-iso-file.yaml |
| hunting_query | c2-lookup-from-nonbrowser[Nobelium] | DeviceEvents.ActionType == "DnsQueryResponse" | Microsoft 365 Defender/Campaigns/c2-lookup-from-nonbrowser[Nobelium].yaml |
| hunting_query | c2-lookup-from-nonbrowser[Nobelium] (1) | IdentityQueryEvents.ActionType == "DNS query" | Microsoft 365 Defender/Campaigns/c2-lookup-from-nonbrowser[Nobelium] (1).yaml |
| hunting_query | c2-lookup-response[Nobelium] | DeviceEvents.ActionType == "DnsQueryResponse" | Microsoft 365 Defender/Campaigns/c2-lookup-response[Nobelium].yaml |
| hunting_query | c2-lookup-response[Nobelium] (1) | IdentityQueryEvents.ActionType == "DNS query" | Microsoft 365 Defender/Campaigns/c2-lookup-response[Nobelium] (1).yaml |
| hunting_query | deimos-component-execution | DeviceEvents.ActionType == "AmsiScriptContent" | Microsoft 365 Defender/Campaigns/Jupyter-Solarmaker/deimos-component-execution.yaml |
| hunting_query | detect-impacket-atexec | DeviceRegistryEvents.ActionType in "NamedPipeEvent,RegistryKeyCreated" | Microsoft 365 Defender/Execution/detect-impacket-atexec.yaml |
| hunting_query | detect-impacket-dcomexec | DeviceNetworkEvents.ActionType == "InboundConnectionAccepted" | Microsoft 365 Defender/Execution/detect-impacket-dcomexec.yaml |
| hunting_query | detect-impacket-psexec-module | DeviceEvents.ActionType == "FileCreated" | Microsoft 365 Defender/Execution/detect-impacket-psexec-module.yaml |
| hunting_query | detect-impacket-wmipersist | DeviceEvents.ActionType == "WmiBindEventFilterToConsumer" | Microsoft 365 Defender/Persistence/detect-impacket-wmipersist.yaml |
| hunting_query | detect-suspicious-rdp-connections | DeviceNetworkEvents.ActionType == "ConnectionSuccess" | Microsoft 365 Defender/Lateral Movement/detect-suspicious-rdp-connections.yaml |
| hunting_query | insider-threat-detection-queries (12) | DeviceEvents.ActionType == "UserAccountCreated" | Microsoft 365 Defender/General queries/insider-threat-detection-queries (12).yaml |
| hunting_query | insider-threat-detection-queries (19) | DeviceEvents.ActionType == "UserAccountCreated" | Microsoft 365 Defender/General queries/insider-threat-detection-queries (19).yaml |
| hunting_query | insider-threat-detection-queries (4) | DeviceEvents.ActionType startswith "ScreenshotTaken" | Microsoft 365 Defender/General queries/insider-threat-detection-queries (4).yaml |
| hunting_query | lsass-credential-dumping | DeviceEvents.ActionType in "FileCreated,OpenProcessApiCall" | Microsoft 365 Defender/Credential Access/lsass-credential-dumping.yaml |
| hunting_query | printnightmare-cve-2021-1675 usage detection | DeviceFileEvents.ActionType == "FileCreated" | Microsoft 365 Defender/Exploits/printnightmare-cve-2021-1675 usage detection.yaml |
| hunting_query | qakbot-campaign-registry-edit | DeviceRegistryEvents.ActionType == "RegistryValueSet" | Microsoft 365 Defender/Persistence/qakbot-campaign-registry-edit.yaml |
| hunting_query | regsvr32-rundll32-abnormal-image-loads | DeviceImageLoadEvents.ActionType in "FileCreated,FileRenamed" | Microsoft 365 Defender/Defense evasion/regsvr32-rundll32-image-loads-from-abnormal-locations.yaml |
| hunting_query | scheduled task creation | DeviceEvents.ActionType == "ScheduledTaskCreated" | Microsoft 365 Defender/Persistence/scheduled task creation.yaml |
| hunting_query | snip3-detectsanboxie-function-call | DeviceEvents.ActionType == "PowerShellCommand" | Microsoft 365 Defender/Campaigns/snip3-detectsanboxie-function-call.yaml |
| hunting_query | suspicious-base64-encoded-registry-keys | DeviceRegistryEvents.ActionType has_any "RegistryKeyCreated,RegistryValueSet" | Microsoft 365 Defender/Defense evasion/suspicious-base64-encoded-registry-keys.yaml |
| hunting_query | suspicious-command-interpreters-added-to-registry | DeviceRegistryEvents.ActionType has_any "RegistryKeyCreated,RegistryValueSet" | Microsoft 365 Defender/Defense evasion/suspicious-command-interpreters-added-to-registry.yaml |
| hunting_query | suspicious-keywords-in-registry | DeviceRegistryEvents.ActionType has_any "RegistryKeyCreated,RegistryValueSet" | Microsoft 365 Defender/Defense evasion/suspicious-keywords-in-registry.yaml |
| workbook | AIA-Darktrace | CommonSecurityLog.DeviceProduct in "AI Analyst,Enterprise Immune System"  \|  CommonSecurityLog.DeviceVendor == "Darktrace" | AIA-Darktrace.json |
| workbook | AIVectraDetectWorkbook | CommonSecurityLog.DeviceEventClassID in "asc,audit,campaigns,health,hsc"  \|  CommonSecurityLog.DeviceEventClassID !in "health,audit,campaigns,hsc,asc"  \|  CommonSecurityLog.DeviceEventClassID !in~ "health,audit,campaigns,hsc,asc"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | AIVectraDetectWorkbook.json |
| workbook | AWSS3 | AWSCloudTrail.EventName in "AllocateAddress,AssociateAddress,AuthorizeSecurityGroupEgress,AuthorizeSecurityGroupIngress,CreateNetworkAcl,CreateSecurityGroup,DeleteNetworkAcl,DeleteSecurityGroup,DisassociateAddress,GetCallerIdentity,ReleaseAddress,ReplaceNetworkAclEntry,RevokeSecurityGroupEgress,RevokeSecurityGroupIngress"  \|  AWSCloudTrail.EventName !contains "Image"  \|  AWSCloudTrail.EventName !contains "KeyPair"  \|  AWSCloudTrail.EventName !contains "LaunchTemplate"  \|  AWSCloudTrail.EventName !contains "Tags"  \|  AWSCloudTrail.EventName !contains "Volume"  \|  AWSCloudTrail.EventName contains "Login"  \|  AWSCloudTrail.EventName contains "login"  \|  AWSCloudTrail.EventName contains "signin"  \|  AWSCloudTrail.EventName startswith "authorize"  \|  AWSCloudTrail.EventName startswith "create"  \|  AWSCloudTrail.EventName startswith "delete"  \|  AWSCloudTrail.EventName startswith "replace"  \|  AWSCloudTrail.EventName startswith "revoke" | AWSS3.json |
| workbook | AksSecurity | AzureDiagnostics.Category == "kube-audit" | AksSecurity.json |
| workbook | AmazonWebServicesNetworkActivities | AWSCloudTrail.EventName in "AllocateAddress,AssociateAddress,AuthorizeSecurityGroupEgress,AuthorizeSecurityGroupIngress,CreateNetworkAcl,CreateSecurityGroup,DeleteNetworkAcl,DeleteSecurityGroup,DisassociateAddress,ReleaseAddress,ReplaceNetworkAclEntry,RevokeSecurityGroupEgress,RevokeSecurityGroupIngress"  \|  AWSCloudTrail.EventName !contains "Image"  \|  AWSCloudTrail.EventName !contains "KeyPair"  \|  AWSCloudTrail.EventName !contains "LaunchTemplate"  \|  AWSCloudTrail.EventName !contains "Tags"  \|  AWSCloudTrail.EventName !contains "Volume"  \|  AWSCloudTrail.EventName startswith "authorize"  \|  AWSCloudTrail.EventName startswith "create"  \|  AWSCloudTrail.EventName startswith "delete"  \|  AWSCloudTrail.EventName startswith "replace"  \|  AWSCloudTrail.EventName startswith "revoke" | AmazonWebServicesNetworkActivities.json |
| workbook | AmazonWebServicesUserActivities | AWSCloudTrail.EventName == "GetCallerIdentity"  \|  AWSCloudTrail.EventName contains "Login"  \|  AWSCloudTrail.EventName contains "login"  \|  AWSCloudTrail.EventName contains "signin" | AmazonWebServicesUserActivities.json |
| workbook | AttackSurfaceReduction | DeviceEvents.ActionType startswith "Asr" | AttackSurfaceReduction.json |
| workbook | AutomationHealth | AzureDiagnostics.ResourceProvider == "MICROSOFT.LOGIC" | AutomationHealth.json |
| workbook | AzDDoSStandardWorkbook | AzureDiagnostics.Category in "DDoSMitigationFlowLogs,DDoSMitigationReports,DDoSProtectionNotifications" | AzDDoSStandardWorkbook.json |
| workbook | AzureFirewall | AzureDiagnostics.Category in "AzureFirewallApplicationRule,AzureFirewallNetworkRule"  \|  AzureDiagnostics.ResourceType == "AZUREFIREWALLS" | AzureFirewall.json |
| workbook | AzureFirewallWorkbook | AzureDiagnostics.Category in "AzureFirewallApplicationRule,AzureFirewallDnsProxy,AzureFirewallNetworkRule"  \|  AzureDiagnostics.ResourceType == "AZUREFIREWALLS" | AzureFirewallWorkbook.json |
| workbook | AzureKeyVaultWorkbook | AzureDiagnostics.Category == "AuditEvent"  \|  AzureDiagnostics.ResourceType =~ "VAULTS" | AzureKeyVaultWorkbook.json |
| workbook | AzureOpenAIMonitoring | AzureActivity.OperationName in "Analyze Image,Analyze Text,ChatCompletions_Create,Creates a completion for the chat message"  \|  AzureDiagnostics.Category == "RequestResponse"  \|  AzureDiagnostics.ResourceProvider in "MICROSOFT.COGNITIVESERVICES,MICROSOFT.LOGIC" | AzureOpenAIMonitoring.json |
| workbook | AzureThreatResearchMatrixWorkbook | AzureActivity.OperationName in "Add application,Add conditional access policy,Delete conditional access policy,Invite external user,Redeem external user invite,Update application â€“ Certificates and secrets management,Update conditional access policy"  \|  AzureActivity.OperationName in~ "Add service principal,Add user,Admin deleted security info,Admin registered security info,Admin updated security info,Register device,Unregister device,User changed default security info,User deleted security info,User registered security info"  \|  AzureActivity.OperationName has "Add app role assignment to service principal"  \|  AzureActivity.OperationName has "Add delegated permission grant"  \|  AzureActivity.OperationName has "Consent to application"  \|  AzureActivity.OperationName has_any "Update user" | AzureThreatResearchMatrixWorkbook.JSON |
| workbook | Barracuda | CommonSecurityLog.DeviceVendor == "Barracuda" | Barracuda.json |
| workbook | CheckPoint | CommonSecurityLog.DeviceProduct in~ "Anti Malware,Anti-Bot,Anti-Virus,Application Control,DDoS Protector,IPS,Threat Emulation,URL Filtering"  \|  CommonSecurityLog.DeviceVendor == "Check Point" | CheckPoint.json |
| workbook | Cisco | CommonSecurityLog.DeviceEventClassID in "106100,111008,113012,113015,302010,315011,611102,733100"  \|  CommonSecurityLog.DeviceProduct =~ "ASA"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | Cisco.json |
| workbook | CiscoFirepower | CommonSecurityLog.DeviceProduct =~ "Firepower"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | CiscoFirepower.json |
| workbook | CitrixWAF | CommonSecurityLog.DeviceProduct == "NetScaler"  \|  CommonSecurityLog.DeviceVendor == "Citrix" | CitrixWAF.json |
| workbook | ConditionalAccessTrendsandChanges | AuditLogs.OperationName in "Add conditional access policy,Add member to group,Delete conditional access policy,Update conditional access policy"  \|  AuditLogs.OperationName contains_cs "group" | ConditionalAccessTrendsandChanges.json |
| workbook | CopilotforSecurityMonitoring | CloudAppEvents.ActionType in "Register Microsoft.SecurityCopilot,Write Capacities" | CopilotforSecurityMonitoring.json |
| workbook | CyberArkEPV | CommonSecurityLog.DeviceProduct == "Vault"  \|  CommonSecurityLog.DeviceVendor == "Cyber-Ark" | CyberArkEPV.json |
| workbook | DCR-Toolkit | SecurityEvent.EventID == "and test !has" | DCR-Toolkit.json |
| workbook | Data_Latency_Workbook | AzureActivity.ResourceProvider == "Microsoft.HybridCompute"  \|  CommonSecurityLog.DeviceVendor contains "Cyber-Ark"  \|  CommonSecurityLog.DeviceVendor contains "F5"  \|  CommonSecurityLog.DeviceVendor contains "Forcepoint"  \|  CommonSecurityLog.DeviceVendor contains "Fortinet"  \|  CommonSecurityLog.DeviceVendor contains "Imperva Inc."  \|  CommonSecurityLog.DeviceVendor contains "JSonar"  \|  CommonSecurityLog.DeviceVendor contains "Sonicwall"  \|  CommonSecurityLog.DeviceVendor contains "Trend Micro" | Data_Latency_Workbook.json |
| workbook | DelineaWorkbook | CommonSecurityLog.DeviceProduct == "Secret Server"  \|  CommonSecurityLog.DeviceVendor == "Delinea Software" | DelineaWorkbook.json |
| workbook | DoDZeroTrustWorkbook | AWSCloudTrail.EventName !contains "Image"  \|  AWSCloudTrail.EventName !contains "KeyPair"  \|  AWSCloudTrail.EventName !contains "LaunchTemplate"  \|  AWSCloudTrail.EventName !contains "Tags"  \|  AWSCloudTrail.EventName !contains "Volume"  \|  AWSCloudTrail.EventName startswith "authorize"  \|  AWSCloudTrail.EventName startswith "create"  \|  AWSCloudTrail.EventName startswith "delete"  \|  AWSCloudTrail.EventName startswith "replace"  \|  AWSCloudTrail.EventName startswith "revoke"  \|  AuditLogs.OperationName in "Add app role assignment grant to user,Add application,Add group,Add member to role,Add member to role completed (PIM activation),Add user,Create access package,Reset user password,Update conditional access policy,Update user,User requests access package assignment"  \|  AuditLogs.OperationName contains "PIM"  \|  AuditLogs.OperationName contains "create access package"  \|  AuditLogs.OperationName contains "permanent"  \|  AuditLogs.OperationName has "User requests access package assignment"  \|  AuditLogs.OperationName has "application"  \|  AzureDiagnostics.Category in "Device,NetworkSecurityGroupEvent,kube-audit"  \|  AzureDiagnostics.Category contains "Device"  \|  AzureDiagnostics.Category contains "SQL"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,AZUREFIREWALLS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS,PROFILES,PUBLICIPADDRESSES"  \|  CloudAppEvents.ActionType in "Add member to role,Add service principal.,Add user,InteractiveLogon,LogonSuccess,RemoteInteractiveLogon,Reset user password,ResourceAccess,Sign-in,Update user"  \|  DeviceEvents.ActionType startswith "Asr"  \|  DeviceInfo.ActionType == "AntivirusScanCompleted" | DoDZeroTrustWorkbook.json |
| workbook | EventAnalyzer | SecurityEvent.EventID in "4656,4657,4658,4660,4661,4663,4664,4670,4671,4673,4674,4690,4691,4698,4699,4700,4701,4702,4715,4719,4817,4902,4904,4905,4906,4907,4908,4912,4985,5031,5039,5051,5140,5142,5143,5144,5148,5149,5150,5151,5154,5155,5156,5157,5158,5159,5168,5888,5889,5890" | EventAnalyzer.json |
| workbook | ExchangeCompromiseHunting | DeviceInfo.ActionType =~ "FileCreated"  \|  Event.EventLog =~ "Application"  \|  Event.Source == "Microsoft-Windows-Sysmon"  \|  Event.Source startswith "MSExchange"  \|  SecurityEvent.EventID in "3,4663,4688,5136" | ExchangeCompromiseHunting.json |
| workbook | ExchangeOnline | OfficeActivity.OfficeWorkload == "Exchange" | ExchangeOnline.json |
| workbook | ExtraHopDetectionSummary | CommonSecurityLog.DeviceVendor == "ExtraHop" | ExtraHopDetectionSummary.json |
| workbook | ForcepointCASB | CommonSecurityLog.DeviceProduct in "CASB Admin audit log,Cloud Service Monitoring,SaaS Security Gateway"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint CASB" | ForcepointCASB.json |
| workbook | ForcepointCloudSecuirtyGatewayworkbook | CommonSecurityLog.DeviceProduct in "Email,Web"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint CSG" | ForcepointCloudSecuirtyGatewayworkbook.json |
| workbook | ForcepointNGFW | CommonSecurityLog.DeviceProduct == "NGFW"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint" | ForcepointNGFW.json |
| workbook | ForcepointNGFWAdvanced | CommonSecurityLog.DeviceProduct in "Alert,Audit"  \|  CommonSecurityLog.DeviceVendor in~ "FORCEPOINT,Forcepoint" | ForcepointNGFWAdvanced.json |
| workbook | Fortigate | CommonSecurityLog.DeviceProduct contains "Fortigate"  \|  CommonSecurityLog.DeviceVendor =~ "Fortinet" | Fortigate.json |
| workbook | IllusiveADS | CommonSecurityLog.DeviceEventClassID in "illusive:access,illusive:login,illusive:suspicious" | IllusiveADS.json |
| workbook | IllusiveASM | CommonSecurityLog.DeviceEventClassID == "illusive:violation" | IllusiveASM.json |
| workbook | InsecureProtocols | Event.EventLog == "Microsoft-Windows-SMBServer/Audit"  \|  Event.EventLog =~ "System"  \|  Event.Source =~ "NETLOGON"  \|  SecurityEvent.EventID in "2889,3000,4624,4768,4769,4776,5827,5828,5829,5830,5831" | InsecureProtocols.json |
| workbook | InvestigationInsights | AuditLogs.OperationName == "Consent to application"  \|  AuditLogs.OperationName =~ "Disable Strong Authentication"  \|  AuditLogs.OperationName contains "password"  \|  SecurityEvent.EventID in "1102,4624,4625,4688,4719,4720,4723,4724,4768,4771,4776" | InvestigationInsights.json |
| workbook | IoTAssetDiscovery | CommonSecurityLog.DeviceVendor == "Fortinet" | IoTAssetDiscovery.json |
| workbook | Log4jPostCompromiseHunting | AzureDiagnostics.Category in "ApplicationGatewayAccessLog,ApplicationGatewayFirewallLog,FrontdoorAccessLog,FrontdoorWebApplicationFirewallLog"  \|  Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE"  \|  Syslog.SyslogMessage has "jndi"  \|  Syslog.SyslogMessage has_any "corba,dns,iiop,ldap,nds,nis,rmi" | Log4jPostCompromiseHunting.json |
| workbook | MicrosoftDefenderForEndPoint | DeviceEvents.ActionType in "AntivirusDetection,PnpDeviceConnected"  \|  DeviceEvents.ActionType endswith "Audited"  \|  DeviceEvents.ActionType endswith "Blocked"  \|  DeviceEvents.ActionType startswith "Asr"  \|  DeviceInfo.ActionType in "FileCreated,UsbDriveMounted" | MicrosoftDefenderForEndPoint.json |
| workbook | MicrosoftSentinelDeploymentandMigrationTracker | CommonSecurityLog.DeviceVendor has "Barracuda"  \|  CommonSecurityLog.DeviceVendor has "Check Point"  \|  CommonSecurityLog.DeviceVendor has "Cisco"  \|  CommonSecurityLog.DeviceVendor has "Citrix"  \|  CommonSecurityLog.DeviceVendor has "CyberArk"  \|  CommonSecurityLog.DeviceVendor has "ExtraHop"  \|  CommonSecurityLog.DeviceVendor has "F5"  \|  CommonSecurityLog.DeviceVendor has "ForgeRock"  \|  CommonSecurityLog.DeviceVendor has "Fortinet"  \|  CommonSecurityLog.DeviceVendor has "Illusive"  \|  CommonSecurityLog.DeviceVendor has "OneIdentity"  \|  CommonSecurityLog.DeviceVendor has "Palo Alto"  \|  CommonSecurityLog.DeviceVendor has "Vectra Networks"  \|  CommonSecurityLog.DeviceVendor has "Zscaler" | MicrosoftSentinelDeploymentandMigrationTracker.json |
| workbook | MicrosoftTeams | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams"  \|  OfficeActivity.RecordType =~ "SharePointFileOperation" | MicrosoftTeams.json |
| workbook | Office365 | OfficeActivity.OfficeWorkload in "Exchange,OneDrive,SharePoint" | Office365.json |
| workbook | OnapsisAlarmsOverview | CommonSecurityLog.DeviceVendor == "Onapsis" | OnapsisAlarmsOverview.json |
| workbook | OneIdentity | CommonSecurityLog.DeviceProduct == "SPS"  \|  CommonSecurityLog.DeviceVendor == "OneIdentity" | OneIdentity.json |
| workbook | PaloAltoNetworkThreat | CommonSecurityLog.DeviceEventClassID in~ "correlation,vulnerability,wildfire"  \|  CommonSecurityLog.DeviceEventClassID != "file"  \|  CommonSecurityLog.DeviceEventClassID != "url"  \|  CommonSecurityLog.DeviceProduct has "PAN-OS"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | PaloAltoNetworkThreat.json |
| workbook | PaloAltoOverview | CommonSecurityLog.DeviceEventClassID in~ "end,file,url,wildfire"  \|  CommonSecurityLog.DeviceProduct has "PAN-OS"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | PaloAltoOverview.json |
| workbook | PlaybookHealth | AzureActivity.OperationName == "Microsoft.Logic/workflows/workflowRunCompleted"  \|  AzureActivity.OperationName has "Create"  \|  AzureActivity.OperationName has "Delete"  \|  AzureActivity.OperationName has "Disable"  \|  AzureActivity.OperationName has "Enable"  \|  AzureActivity.OperationName has "set"  \|  AzureActivity.OperationName startswith "Microsoft.Logic/workflows/workflowAction"  \|  AzureActivity.OperationName startswith "Microsoft.Logic/workflows/workflowRun"  \|  AzureActivity.OperationName startswith "Microsoft.Logic/workflows/workflowRunCompleted"  \|  AzureActivity.OperationName startswith "Microsoft.Logic/workflows/workflowTrigger"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.LOGIC" | PlaybookHealth.json |
| workbook | SensitiveOperationsinAzureActivityLogReview | AzureActivity.OperationName =~ "Create or Update Virtual Machine Extension" | SensitiveOperationsinAzureActivityLogReview.JSON |
| workbook | SharePointAndOneDrive | OfficeActivity.OfficeWorkload in "OneDrive,SharePoint" | SharePointAndOneDrive.json |
| workbook | SolarWindsPostCompromiseHunting | DeviceEvents.ActionType contains "ExploitGuardNonMicrosoftSignedBlocked"  \|  DeviceProcessEvents.ActionType == "RemoteInteractiveLogon"  \|  DeviceProcessEvents.ActionType =~ "LdapSearch"  \|  Event.Source == "Microsoft-Windows-Sysmon"  \|  Event.Source =~ "Microsoft-Windows-SENSE"  \|  OfficeActivity.OfficeWorkload =~ "Exchange"  \|  OfficeActivity.OperationName == "Add member to group"  \|  OfficeActivity.OperationName in~ "Set domain authentication,Set federation settings on domain"  \|  OfficeActivity.OperationName has_any "Add service principal,Certificates and secrets management"  \|  SecurityEvent.EventID in "17,18,4624,4662,4670,4688,5145,87" | SolarWindsPostCompromiseHunting.json |
| workbook | SonicWallFirewall | CommonSecurityLog.DeviceVendor == "SonicWall" | SonicWallFirewall.json |
| workbook | SysmonThreatHunting | Event.Source contains "sysmon"  \|  SecurityEvent.EventID in "1,10,11,12,13,17,18,22,3,4624,4625,4720,4722,4723,4724,4725,4726,4728,4729,4732,4733,4738,4740,4746,4747,4751,4752,4756,4761,4762,4767,4771,4781,7,8" | SysmonThreatHunting.json |
| workbook | UnifiSG | CommonSecurityLog.DeviceEventClassID in "DHCP,DNS,Firewall,IPS"  \|  CommonSecurityLog.DeviceVendor == "Unifi" | UnifiSG.json |
| workbook | UserMap | AzureDiagnostics.Category in "ApplicationGatewayFirewallLog,FrontdoorWebApplicationFirewallLog"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.NETWORK"  \|  AzureDiagnostics.ResourceType == "FRONTDOORS" | UserMap.json |
| workbook | VeeamSecurityActivites | Syslog.SyslogMessage has "instanceId"  \|  Syslog.SyslogMessage has "predefined_alarm_id" | VeeamSecurityActivites.json |
| workbook | VeeamSecurityActivities | Syslog.SyslogMessage has "instanceId"  \|  Syslog.SyslogMessage has "predefined_alarm_id" | VeeamSecurityActivities.json |
| workbook | WebApplicationFirewallFirewallEvents | AzureDiagnostics.ResourceType == "APPLICATIONGATEWAYS" | WebApplicationFirewallFirewallEvents.json |
| workbook | WebApplicationFirewallGatewayAccessEvents | AzureDiagnostics.ResourceType == "APPLICATIONGATEWAYS" | WebApplicationFirewallGatewayAccessEvents.json |
| workbook | WebApplicationFirewallOverview | AzureDiagnostics.ResourceType == "APPLICATIONGATEWAYS" | WebApplicationFirewallOverview.json |
| workbook | WindowsAuditChecker | SecurityEvent.EventID in "4624,4625,4768,4769,4771" | WindowsAuditChecker.json |
| workbook | WindowsFirewall | SecurityEvent.EventID in "4624,4625" | WindowsFirewall.json |
| workbook | WindowsFirewallViaAMA | ASimNetworkSessionLogs.EventProduct == "Windows Firewall"  \|  SecurityEvent.EventID in "4624,4625" | WindowsFirewallViaAMA.json |
| workbook | WorkspaceAuditing | AzureActivity.OperationName contains "Create"  \|  AzureActivity.OperationName contains "Delete"  \|  AzureActivity.OperationName contains "Update" | WorkspaceAuditing.json |
| workbook | WorkspaceUsage | AzureActivity.OperationName !in "Microsoft.SecurityInsights/Incidents/investigations/write,Microsoft.SecurityInsights/dataConnectorsCheckRequirements/action"  \|  AzureActivity.ResourceProvider == "Microsoft.SecurityInsights" | WorkspaceUsage.json |
| workbook | ZeroTrustStrategyWorkbook | AWSCloudTrail.EventName !contains "Image"  \|  AWSCloudTrail.EventName !contains "KeyPair"  \|  AWSCloudTrail.EventName !contains "LaunchTemplate"  \|  AWSCloudTrail.EventName !contains "Tags"  \|  AWSCloudTrail.EventName !contains "Volume"  \|  AWSCloudTrail.EventName startswith "authorize"  \|  AWSCloudTrail.EventName startswith "create"  \|  AWSCloudTrail.EventName startswith "delete"  \|  AWSCloudTrail.EventName startswith "replace"  \|  AWSCloudTrail.EventName startswith "revoke"  \|  AuditLogs.OperationName in "Add app role assignment grant to user,Add application,Add group,Add member to role,Add member to role completed (PIM activation),Add user,Create access package,Reset user password,Update conditional access policy,Update user,User requests access package assignment"  \|  AuditLogs.OperationName contains "PIM"  \|  AuditLogs.OperationName contains "create access package"  \|  AuditLogs.OperationName contains "permanent"  \|  AuditLogs.OperationName has "User requests access package assignment"  \|  AuditLogs.OperationName has "application"  \|  AzureDiagnostics.Category in "Device,NetworkSecurityGroupEvent,kube-audit"  \|  AzureDiagnostics.Category contains "Device"  \|  AzureDiagnostics.Category contains "SQL"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,AZUREFIREWALLS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS,PROFILES,PUBLICIPADDRESSES"  \|  CloudAppEvents.ActionType in "Add member to role,Add service principal.,Add user,InteractiveLogon,LogonSuccess,RemoteInteractiveLogon,Reset user password,ResourceAccess,Sign-in,Update user"  \|  DeviceEvents.ActionType startswith "Asr"  \|  DeviceInfo.ActionType == "AntivirusScanCompleted" | ZeroTrustStrategyWorkbook.json |
| workbook | ZscalerFirewall | CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Allow"  \|  CommonSecurityLog.DeviceProduct == "NSSFWlog" | ZscalerFirewall.json |
| workbook | ZscalerOffice365Apps | CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Allow"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | ZscalerOffice365Apps.json |
| workbook | ZscalerThreats | CommonSecurityLog.DeviceEventClassID == "Blocked"  \|  CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Block"  \|  CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | ZscalerThreats.json |
| workbook | ZscalerWebOverview | CommonSecurityLog.DeviceEventClassID in "Allow,Allowed"  \|  CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Allow"  \|  CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | ZscalerWebOverview.json |
| workbook | microsoftdefenderforidentity | IdentityLogonEvents.ActionType in "LogonFailed,LogonSuccess" | microsoftdefenderforidentity.json |
| workbook | pfsense | CommonSecurityLog.DeviceEventClassID == "filterlog"  \|  CommonSecurityLog.DeviceProduct == "pfsense" | pfsense.json |

### AI Analyst Darktrace

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | AIA-Darktrace | CommonSecurityLog.DeviceProduct in "AI Analyst,Enterprise Immune System"  \|  CommonSecurityLog.DeviceVendor == "Darktrace" | [AIA-Darktrace.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AI%20Analyst%20Darktrace/Workbooks/AIA-Darktrace.json) |

### Acronis Cyber Protect Cloud

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Acronis - Login from Abnormal IP - Low Occurrence | CommonSecurityLog.DeviceVendor == "Acronis audit" | [AcronisLoginFromAbnormalIPLowOccurrence.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Analytic%20Rules/AcronisLoginFromAbnormalIPLowOccurrence.yaml) |
| analytic_rule | Acronis - Multiple Endpoints Accessing Malicious U | CommonSecurityLog.DeviceEventClassID == "MaliciousUrlDetected"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisMultipleEndpointsAccessingMaliciousURLs.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Analytic%20Rules/AcronisMultipleEndpointsAccessingMaliciousURLs.yaml) |
| analytic_rule | Acronis - Multiple Endpoints Infected by Ransomwar | CommonSecurityLog.DeviceEventClassID == "ActiveProtectionBlocksSuspiciousActivity"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisMultipleEndpointsInfectedByRansomware.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Analytic%20Rules/AcronisMultipleEndpointsInfectedByRansomware.yaml) |
| analytic_rule | Acronis - Multiple Inboxes with Malicious Content  | CommonSecurityLog.DeviceEventClassID in "MaliciousEmailDetectedPerceptionPointWarning,MaliciousURLDetectedInM365MailboxBackup,MalwareDetectedInM365MailboxBackup"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisMultipleInboxesWithMaliciousContentDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Analytic%20Rules/AcronisMultipleInboxesWithMaliciousContentDetected.yaml) |
| hunting_query | Acronis - ASZ defence: Unauthorized operation is d | CommonSecurityLog.DeviceEventClassID == "ActiveProtectionDetectedAszPartitionAccessed"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisUnauthorizedOperationIsDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisUnauthorizedOperationIsDetected.yaml) |
| hunting_query | Acronis - Agent failed updating more than twice in | CommonSecurityLog.DeviceEventClassID == "AgentAutoUpdateStalled"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisAgentFailedUpdatingMoreThanTwiceInADay.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisAgentFailedUpdatingMoreThanTwiceInADay.yaml) |
| hunting_query | Acronis - Agents offline for 2 days or more | CommonSecurityLog.DeviceEventClassID == "MiniPlanAgentOffline"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisAgentsOfflineFor2DaysOrMore.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisAgentsOfflineFor2DaysOrMore.yaml) |
| hunting_query | Acronis - Audit Log | CommonSecurityLog.DeviceVendor == "Acronis audit" | [AcronisAuditLog.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisAuditLog.yaml) |
| hunting_query | Acronis - Cloud Connection Errors | CommonSecurityLog.DeviceEventClassID in "CloudConnectionAzureApplianceConfigurationFailed,CloudConnectionAzureApplianceDeallocationFailed,CloudConnectionAzureApplianceDeletionFailed,CloudConnectionAzureApplianceEOL,CloudConnectionAzureApplianceFailed,CloudConnectionAzureApplianceUpdateFailed,CloudConnectionAzureCloudAccessExpired,CloudConnectionS3CloudAccessExpired"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisCloudConnectionErrors.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisCloudConnectionErrors.yaml) |
| hunting_query | Acronis - Endpoints Accessing Malicious URLs | CommonSecurityLog.DeviceEventClassID == "MaliciousUrlDetected"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisEndpointsAccessingMaliciousURLs.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisEndpointsAccessingMaliciousURLs.yaml) |
| hunting_query | Acronis - Endpoints Infected by Ransomware | CommonSecurityLog.DeviceEventClassID == "ActiveProtectionBlocksSuspiciousActivity"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisEndpointsInfectedByRansomware.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisEndpointsInfectedByRansomware.yaml) |
| hunting_query | Acronis - Endpoints with Backup issues | CommonSecurityLog.DeviceEventClassID in "ArchiveCorrupted,BackupFailed,BackupNotResponding,BackupRecoveryFailed"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisEndpointsWithBackupIssues.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisEndpointsWithBackupIssues.yaml) |
| hunting_query | Acronis - Endpoints with EDR Incidents | CommonSecurityLog.DeviceEventClassID in "EDRIOCDetected,EDRIncidentDetected"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisEndpointsWithEDRIncidents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisEndpointsWithEDRIncidents.yaml) |
| hunting_query | Acronis - Endpoints with high failed login attempt | CommonSecurityLog.DeviceEventClassID == "MiMonitoringFailedLoginAttemptsOverThreshold"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisEndpointsWithHighFailedLoginAttempts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisEndpointsWithHighFailedLoginAttempts.yaml) |
| hunting_query | Acronis - Inboxes with Malicious Content | CommonSecurityLog.DeviceEventClassID in "MaliciousEmailDetectedPerceptionPointWarning,MaliciousURLDetectedInM365MailboxBackup,MalwareDetectedInM365MailboxBackup"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisInboxesWithMaliciousContentDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisInboxesWithMaliciousContentDetected.yaml) |
| hunting_query | Acronis - Login from Abnormal IP - Low Occurrence | CommonSecurityLog.DeviceVendor == "Acronis audit" | [AcronisLoginFromAbnormalIPLowOccurrence.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisLoginFromAbnormalIPLowOccurrence.yaml) |
| hunting_query | Acronis - Protection Service Errors | CommonSecurityLog.DeviceEventClassID in "ActiveProtectionDriverRemediated,ActiveProtectionInvalidNetworkRecoveryPath,ActiveProtectionServiceConflict,ActiveProtectionServiceFailureToApplyPolicy,ActiveProtectionServiceNotAvailable,ActiveProtectionServiceNotRunning,CPSProtectionFailureDetected,ProtectionServiceNotWorking"  \|  CommonSecurityLog.DeviceVendor == "Acronis" | [AcronisProtectionServiceErrors.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Acronis%20Cyber%20Protect%20Cloud/Hunting%20Queries/AcronisProtectionServiceErrors.yaml) |

### Amazon Web Services

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | AWS Config Service Resource Deletion Attempts | AWSCloudTrail.EventName in~ "DeleteEventBus,DeleteFlowLogs,DeleteTrail,StopLogging,UpdateTrail" | [AWS_ConfigServiceResourceDeletion.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ConfigServiceResourceDeletion.yaml) |
| analytic_rule | Automatic image scanning disabled for ECR | AWSCloudTrail.EventName == "PutImageScanningConfiguration" | [AWS_ECRImageScanningDisabled.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ECRImageScanningDisabled.yaml) |
| analytic_rule | Changes made to AWS CloudTrail logs | AWSCloudTrail.EventName in~ "DeleteEventBus,DeleteFlowLogs,DeleteTrail,StopLogging,UpdateTrail" | [AWS_ClearStopChangeTrailLogs.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ClearStopChangeTrailLogs.yaml) |
| analytic_rule | Changes to AWS Elastic Load Balancer security grou | AWSCloudTrail.EventName in~ "ApplySecurityGroupsToLoadBalancer,SetSecurityGroups" | [AWS_LoadBalancerSecGroupChange.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_LoadBalancerSecGroupChange.yaml) |
| analytic_rule | Changes to AWS Security Group ingress and egress s | AWSCloudTrail.EventName in~ "AuthorizeSecurityGroupEgress,AuthorizeSecurityGroupIngress,RevokeSecurityGroupEgress,RevokeSecurityGroupIngress" | [AWS_IngressEgressSecurityGroupChange.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_IngressEgressSecurityGroupChange.yaml) |
| analytic_rule | Changes to Amazon VPC settings | AWSCloudTrail.EventName in~ "CreateInternetGateway,CreateNatGateway,CreateNetworkAclEntry,CreateRoute,CreateRouteTable" | [AWS_ChangeToVPC.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ChangeToVPC.yaml) |
| analytic_rule | Changes to internet facing AWS RDS Database instan | AWSCloudTrail.EventName in~ "AuthorizeDBSecurityGroupIngress,CreateDBSecurityGroup,DeleteDBSecurityGroup,RevokeDBSecurityGroupIngress" | [AWS_ChangeToRDSDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ChangeToRDSDatabase.yaml) |
| analytic_rule | CloudFormation policy created then used for privil | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedCloudFormationPolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedCloudFormationPolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Created CRUD S3 policy and then privilege escalati | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedCRUDS3PolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedCRUDS3PolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creating keys with encrypt policy without MFA | AWSCloudTrail.EventName in "CreateKey,PutKeyPolicy" | [AWS_CreationofEncryptKeysWithoutMFA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreationofEncryptKeysWithoutMFA.yaml) |
| analytic_rule | Creation of Access Key for IAM User | AWSCloudTrail.EventName == "CreateAccessKey" | [AWS_UserAccessKeyCreated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_UserAccessKeyCreated.yaml) |
| analytic_rule | Creation of CRUD DynamoDB policy and then privileg | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedCRUDDyanmoDBPolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedCRUDDyanmoDBPolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of CRUD KMS policy and then privilege esc | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedCRUDKMSPolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedCRUDKMSPolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of CRUD Lambda policy and then privilege  | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedCURDLambdaPolicytoPrivilegEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedCURDLambdaPolicytoPrivilegEscalation.yaml) |
| analytic_rule | Creation of DataPipeline policy and then privilege | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedDataPipelinePolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedDataPipelinePolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of EC2 policy and then privilege escalati | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedEC2PolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedEC2PolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of Glue policy and then privilege escalat | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedGluePolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedGluePolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of Lambda policy and then privilege escal | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedLambdaPolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedLambdaPolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of SSM policy and then privilege escalati | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedSSMPolicytoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedSSMPolicytoPrivilegeEscalation.yaml) |
| analytic_rule | Creation of new CRUD IAM policy and then privilege | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_CreatedCRUDIAMtoPrivilegeEscalation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CreatedCRUDIAMtoPrivilegeEscalation.yaml) |
| analytic_rule | EC2 Startup Shell Script Changed | AWSCloudTrail.EventName in "CreateLaunchTemplate,ModifyInstanceAttribute" | [AWS_EC2StartupShellScriptChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_EC2StartupShellScriptChanged.yaml) |
| analytic_rule | ECR image scan findings high or critical | AWSCloudTrail.EventName == "DescribeImageScanFindings" | [AWS_ECRContainerHigh.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ECRContainerHigh.yaml) |
| analytic_rule | Full Admin policy created and then attached to Rol | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion" | [AWS_FullAdminPolicyAttachedToRolesUsersGroups.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_FullAdminPolicyAttachedToRolesUsersGroups.yaml) |
| analytic_rule | GuardDuty detector disabled or suspended | AWSCloudTrail.EventName in "DeleteDetector,UpdateDetector" | [AWS_GuardDutyDisabled.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_GuardDutyDisabled.yaml) |
| analytic_rule | Login to AWS Management Console without MFA | AWSCloudTrail.EventName =~ "ConsoleLogin" | [AWS_ConsoleLogonWithoutMFA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_ConsoleLogonWithoutMFA.yaml) |
| analytic_rule | Monitor AWS Credential abuse or hijacking | AWSCloudTrail.EventName =~ "GetCallerIdentity" | [AWS_CredentialHijack.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_CredentialHijack.yaml) |
| analytic_rule | NRT Login to AWS Management Console without MFA | AWSCloudTrail.EventName =~ "ConsoleLogin" | [NRT_AWS_ConsoleLogonWithoutMFA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/NRT_AWS_ConsoleLogonWithoutMFA.yaml) |
| analytic_rule | Network ACL with all the open ports to a specified | AWSCloudTrail.EventName in "CreateNetworkAclEntry,ReplaceNetworkAclEntry" | [AWS_NetworkACLOpenToAllPorts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_NetworkACLOpenToAllPorts.yaml) |
| analytic_rule | Policy version set to default | AWSCloudTrail.EventName == "SetDefaultPolicyVersion" | [AWS_SetDefaulyPolicyVersion.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_SetDefaulyPolicyVersion.yaml) |
| analytic_rule | Privilege escalation via CRUD DynamoDB policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationviaCRUDDynamoDB.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationviaCRUDDynamoDB.yaml) |
| analytic_rule | Privilege escalation via CRUD IAM policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaCRUDIAMPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaCRUDIAMPolicy.yaml) |
| analytic_rule | Privilege escalation via CRUD KMS policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaCRUDKMSPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaCRUDKMSPolicy.yaml) |
| analytic_rule | Privilege escalation via CRUD Lambda policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaCRUDLambdaPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaCRUDLambdaPolicy.yaml) |
| analytic_rule | Privilege escalation via CRUD S3 policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaCRUDS3Policy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaCRUDS3Policy.yaml) |
| analytic_rule | Privilege escalation via CloudFormation policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaCloudFormationPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaCloudFormationPolicy.yaml) |
| analytic_rule | Privilege escalation via DataPipeline policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaDataPipeline.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaDataPipeline.yaml) |
| analytic_rule | Privilege escalation via EC2 policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaEC2Policy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaEC2Policy.yaml) |
| analytic_rule | Privilege escalation via Glue policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaGluePolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaGluePolicy.yaml) |
| analytic_rule | Privilege escalation via Lambda policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaLambdaPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaLambdaPolicy.yaml) |
| analytic_rule | Privilege escalation via SSM policy | AWSCloudTrail.EventName in "PutGroupPolicy,PutRolePolicy,PutUserPolicy" | [AWS_PrivilegeEscalationViaSSM.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationViaSSM.yaml) |
| analytic_rule | Privilege escalation with AdministratorAccess mana | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy" | [AWS_PrivilegeEscalationAdministratorAccessManagedPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationAdministratorAccessManagedPolicy.yaml) |
| analytic_rule | Privilege escalation with FullAccess managed polic | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy" | [AWS_PrivilegeEscalationFullAccessManagedPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationFullAccessManagedPolicy.yaml) |
| analytic_rule | Privilege escalation with admin managed policy | AWSCloudTrail.EventName in "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy" | [AWS_PrivilegeEscalationAdminManagedPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_PrivilegeEscalationAdminManagedPolicy.yaml) |
| analytic_rule | RDS instance publicly exposed | AWSCloudTrail.EventName in "CreateDBInstance,ModifyDBInstance" | [AWS_RDSInstancePubliclyExposed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_RDSInstancePubliclyExposed.yaml) |
| analytic_rule | S3 Object Exfiltration from Anonymous User | AWSCloudTrail.EventName == "GetObject" | [AWS_S3ObjectExfiltrationByAnonymousUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3ObjectExfiltrationByAnonymousUser.yaml) |
| analytic_rule | S3 bucket access point publicly exposed | AWSCloudTrail.EventName == "PutAccessPointPolicy" | [AWS_S3BucketAccessPointExposed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3BucketAccessPointExposed.yaml) |
| analytic_rule | S3 bucket exposed via ACL | AWSCloudTrail.EventName == "PutBucketAcl" | [AWS_S3BucketExposedviaACL.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3BucketExposedviaACL.yaml) |
| analytic_rule | S3 bucket exposed via policy | AWSCloudTrail.EventName == "PutBucketPolicy" | [AWS_S3BucketExposedviaPolicy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3BucketExposedviaPolicy.yaml) |
| analytic_rule | S3 bucket suspicious ransomware activity | AWSCloudTrail.EventName in "GetObject,PutObject" | [AWS_S3Ransomware.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3Ransomware.yaml) |
| analytic_rule | S3 object publicly exposed | AWSCloudTrail.EventName == "PutObjectAcl" | [AWS_S3ObjectPubliclyExposed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3ObjectPubliclyExposed.yaml) |
| analytic_rule | SAML update identity provider | AWSCloudTrail.EventName == "UpdateSAMLProvider" | [AWS_SAMLUpdateIdentity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_SAMLUpdateIdentity.yaml) |
| analytic_rule | SSM document is publicly exposed | AWSCloudTrail.EventName == "ModifyDocumentPermission" | [AWS_SSMPubliclyExposed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_SSMPubliclyExposed.yaml) |
| analytic_rule | Successful brute force attack on S3 Bucket. | AWSCloudTrail.EventName == "GetObject" | [AWS_S3BruteForce.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_S3BruteForce.yaml) |
| analytic_rule | Suspicious AWS EC2 Compute Resource Deployments | AWSCloudTrail.EventName =~ "RunInstances" | [SuspiciousAWSEC2ComputeResourceDeployments.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/SuspiciousAWSEC2ComputeResourceDeployments.yaml) |
| analytic_rule | Suspicious command sent to EC2 | AWSCloudTrail.EventName in "CreateAssociation,PutObject,SendCommand" | [AWS_SuspiciousCommandEC2.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_SuspiciousCommandEC2.yaml) |
| analytic_rule | Suspicious overly permissive KMS key policy create | AWSCloudTrail.EventName in "CreateKey,PutKeyPolicy" | [AWS_OverlyPermessiveKMS.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_OverlyPermessiveKMS.yaml) |
| analytic_rule | Tampering to AWS CloudTrail logs | AWSCloudTrail.EventName in~ "DeleteEventBus,DeleteFlowLogs,DeleteLogGroup,DeleteTrail,StopLogging,UpdateTrail" | [AWS_LogTampering.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_LogTampering.yaml) |
| analytic_rule | Unauthorized EC2 Instance Setup Attempt | AWSCloudTrail.EventName == "RunInstances" | [AWS_UnauthorizedInstanceSetUpAttempt.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_UnauthorizedInstanceSetUpAttempt.yaml) |
| analytic_rule | User IAM Enumeration | AWSCloudTrail.EventName in "ListAccessKeys,ListAttachedRolePolicies,ListAttachedUserPolicies,ListGroupsForUser,ListRoles,ListUsers" | [AWS_UserIAMEnumeration.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_UserIAMEnumeration.yaml) |
| hunting_query | Bucket versioning suspended | AWSCloudTrail.EventName == "PutBucketVersioning" | [AWS_BucketVersioningSuspended.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_BucketVersioningSuspended.yaml) |
| hunting_query | Changes made to AWS IAM objects | AWSCloudTrail.EventName in~ "CreateUser,DeleteGroup,DeleteUser" | [AWS_IAMUserGroupChanges.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_IAMUserGroupChanges.yaml) |
| hunting_query | Changes made to AWS IAM policy | AWSCloudTrail.EventName in~ "AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy,CreatePolicy,CreatePolicyVersion,DeleteGroupPolicy,DeletePolicy,DeletePolicyVersion,DeleteRolePolicy,DeleteUserPolicy,DetachGroupPolicy,DetachRolePolicy,PutGroupPolicy,PutUserPolicy" | [AWS_IAM_PolicyChange.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_IAM_PolicyChange.yaml) |
| hunting_query | CreateLoginProfile detected | AWSCloudTrail.EventName == "CreateLoginProfile" | [AWS_CreateLoginProfile.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_CreateLoginProfile.yaml) |
| hunting_query | CreatePolicyVersion with excessive permissions | AWSCloudTrail.EventName == "CreatePolicyVersion" | [AWS_PolicywithExcessivePermissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_PolicywithExcessivePermissions.yaml) |
| hunting_query | ECR image scan findings low | AWSCloudTrail.EventName == "DescribeImageScanFindings" | [AWS_ECRContainerLow.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_ECRContainerLow.yaml) |
| hunting_query | ECR image scan findings medium | AWSCloudTrail.EventName == "DescribeImageScanFindings" | [AWS_ECRContainerMedium.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_ECRContainerMedium.yaml) |
| hunting_query | Excessive execution of discovery events | AWSCloudTrail.EventName startswith "Describe"  \|  AWSCloudTrail.EventName startswith "Get"  \|  AWSCloudTrail.EventName startswith "List" | [AWS_ExcessiveExecutionofDiscoveryEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_ExcessiveExecutionofDiscoveryEvents.yaml) |
| hunting_query | Failed brute force on S3 bucket | AWSCloudTrail.EventName == "GetObject" | [AWS_FailedBruteForceS3Bucket.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_FailedBruteForceS3Bucket.yaml) |
| hunting_query | IAM Privilege Escalation by Instance Profile attac | AWSCloudTrail.EventName in~ "AddRoleToInstanceProfile,RemoveRoleFromInstanceProfile" | [AWS_IAM_PrivilegeEscalationbyAttachment.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_IAM_PrivilegeEscalationbyAttachment.yaml) |
| hunting_query | IAM assume role policy brute force | AWSCloudTrail.EventName == "AssumeRole" | [AWS_AssumeRoleBruteForce.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_AssumeRoleBruteForce.yaml) |
| hunting_query | Lambda UpdateFunctionCode | AWSCloudTrail.EventName startswith "UpdateFunctionCode" | [AWS_LambdaUpdateFunctionCode.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_LambdaUpdateFunctionCode.yaml) |
| hunting_query | Lambda function throttled | AWSCloudTrail.EventName startswith "PutFunctionConcurrency" | [AWS_LambdaFunctionThrottled.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_LambdaFunctionThrottled.yaml) |
| hunting_query | Lambda layer imported from external account | AWSCloudTrail.EventName startswith "CreateFunction"  \|  AWSCloudTrail.EventName startswith "UpdateFunctionConfiguration" | [AWS_LambdaLayerImportedExternalAccount.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_LambdaLayerImportedExternalAccount.yaml) |
| hunting_query | Login profile updated | AWSCloudTrail.EventName == "UpdateLoginProfile" | [AWS_LoginProfileUpdated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_LoginProfileUpdated.yaml) |
| hunting_query | Modification of route-table attributes | AWSCloudTrail.EventName in "CreateRoute,DeleteRoute,ReplaceRoute" | [AWS_ModificationofRouteTableAttributes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_ModificationofRouteTableAttributes.yaml) |
| hunting_query | Modification of subnet attributes | AWSCloudTrail.EventName == "ModifySubnetAttribute" | [AWS_ModificationofSubnetAttributes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_ModificationofSubnetAttributes.yaml) |
| hunting_query | Modification of vpc attributes | AWSCloudTrail.EventName == "ModifyVpcAttribute" | [AWS_ModificationofVPCAttributes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_ModificationofVPCAttributes.yaml) |
| hunting_query | Multiple failed login attempts to an existing user | AWSCloudTrail.EventName == "ConsoleLogin" | [AWS_FailedBruteForceWithoutMFA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_FailedBruteForceWithoutMFA.yaml) |
| hunting_query | Network ACL deleted | AWSCloudTrail.EventName == "DeleteNetworkAclEntry" | [AWS_NetworkACLDeleted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_NetworkACLDeleted.yaml) |
| hunting_query | New AccessKey created for Root user | AWSCloudTrail.EventName == "CreateAccessKey" | [AWS_NewRootAccessKey.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_NewRootAccessKey.yaml) |
| hunting_query | New access key created to user | AWSCloudTrail.EventName == "CreateAccessKey" | [AWS_CreateAccessKey.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_CreateAccessKey.yaml) |
| hunting_query | Privileged role attached to Instance | AWSCloudTrail.EventName in "AddRoleToInstanceProfile,AttachGroupPolicy,AttachRolePolicy,AttachUserPolicy" | [AWS_PrivilegedRoleAttachedToInstance.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_PrivilegedRoleAttachedToInstance.yaml) |
| hunting_query | RDS instance master password changed | AWSCloudTrail.EventName == "ModifyDBCluster" | [AWS_RDSMasterPasswordChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_RDSMasterPasswordChanged.yaml) |
| hunting_query | Risky role name created | AWSCloudTrail.EventName == "CreateRole" | [AWS_RiskyRoleName.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_RiskyRoleName.yaml) |
| hunting_query | S3 bucket encryption modified | AWSCloudTrail.EventName in "DeleteBucketEncryption,PutBucketEncryption" | [AWS_S3BucketEncryptionModified.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_S3BucketEncryptionModified.yaml) |
| hunting_query | S3 bucket has been deleted | AWSCloudTrail.EventName == "DeleteBucket" | [AWS_S3BucketDeleted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_S3BucketDeleted.yaml) |
| hunting_query | Suspicious EC2 launched without a key pair | AWSCloudTrail.EventName == "RunInstances" | [AWS_EC2_WithoutKeyPair.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_EC2_WithoutKeyPair.yaml) |
| hunting_query | Suspicious credential token access of valid IAM Ro | AWSCloudTrail.EventName == "AssumeRole" | [AWS_SuspiciousCredentialTokenAccessOfValid_IAM_Roles.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_SuspiciousCredentialTokenAccessOfValid_IAM_Roles.yaml) |
| workbook | AmazonWebServicesNetworkActivities | AWSCloudTrail.EventName in "AllocateAddress,AssociateAddress,AuthorizeSecurityGroupEgress,AuthorizeSecurityGroupIngress,CreateNetworkAcl,CreateSecurityGroup,DeleteNetworkAcl,DeleteSecurityGroup,DisassociateAddress,ReleaseAddress,ReplaceNetworkAclEntry,RevokeSecurityGroupEgress,RevokeSecurityGroupIngress"  \|  AWSCloudTrail.EventName !contains "Image"  \|  AWSCloudTrail.EventName !contains "KeyPair"  \|  AWSCloudTrail.EventName !contains "LaunchTemplate"  \|  AWSCloudTrail.EventName !contains "Tags"  \|  AWSCloudTrail.EventName !contains "Volume"  \|  AWSCloudTrail.EventName startswith "authorize"  \|  AWSCloudTrail.EventName startswith "create"  \|  AWSCloudTrail.EventName startswith "delete"  \|  AWSCloudTrail.EventName startswith "replace"  \|  AWSCloudTrail.EventName startswith "revoke" | [AmazonWebServicesNetworkActivities.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Workbooks/AmazonWebServicesNetworkActivities.json) |
| workbook | AmazonWebServicesUserActivities | AWSCloudTrail.EventName == "GetCallerIdentity"  \|  AWSCloudTrail.EventName contains "Login"  \|  AWSCloudTrail.EventName contains "login"  \|  AWSCloudTrail.EventName contains "signin" | [AmazonWebServicesUserActivities.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Workbooks/AmazonWebServicesUserActivities.json) |

### Apache Log4j Vulnerability Detection

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Azure WAF matching for Log4j vuln(CVE-2021-44228) | AzureDiagnostics.Category in "ApplicationGatewayFirewallLog,FrontdoorWebApplicationFirewallLog"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.NETWORK" | [AzureWAFmatching_log4j_vuln.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Analytic%20Rules/AzureWAFmatching_log4j_vuln.yaml) |
| analytic_rule | Log4j vulnerability exploit aka Log4Shell IP IOC | AzureDiagnostics.Category in "AzureFirewallApplicationRule,AzureFirewallNetworkRule"  \|  AzureDiagnostics.ResourceType =~ "AZUREFIREWALLS"  \|  DeviceNetworkEvents.ActionType =~ "InboundConnectionAccepted"  \|  Event.EventID == "3"  \|  Event.Source =~ "Microsoft-Windows-Sysmon" | [Log4J_IPIOC_Dec112021.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Analytic%20Rules/Log4J_IPIOC_Dec112021.yaml) |
| hunting_query | Azure WAF Log4j CVE-2021-44228 hunting | AzureDiagnostics.Category in~ "ApplicationGatewayAccessLog,ApplicationGatewayFirewallLog,FrontdoorAccessLog,FrontdoorWebApplicationFirewallLog" | [WAF_log4j_vulnerability.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/WAF_log4j_vulnerability.yaml) |
| hunting_query | Linux security related process termination activit | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [Process_Termination_Activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Process_Termination_Activity.yaml) |
| hunting_query | Possible Container Miner related artifacts detecte | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [Container_Miner_Activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Container_Miner_Activity.yaml) |
| hunting_query | Possible Linux attack toolkit detected via Syslog  | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [Linux_Toolkit_Detected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Linux_Toolkit_Detected.yaml) |
| hunting_query | Possible exploitation of Apache log4j component de | Syslog.SyslogMessage has "AUOMS_EXECVE"  \|  Syslog.SyslogMessage has "jndi"  \|  Syslog.SyslogMessage has_any "corba,dns,iiop,ldap,nds,nis,rmi" | [Apache_log4j_Vulnerability.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Apache_log4j_Vulnerability.yaml) |
| hunting_query | Suspicious Base64 download activity detected | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [Base64_Download_Activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Base64_Download_Activity.yaml) |
| hunting_query | Suspicious Shell script detected | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [Suspicious_ShellScript_Activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Suspicious_ShellScript_Activity.yaml) |
| hunting_query | Suspicious manipulation of firewall detected via S | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [Firewall_Disable_Activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Hunting%20Queries/Firewall_Disable_Activity.yaml) |
| workbook | Log4jPostCompromiseHunting | AzureDiagnostics.Category in "ApplicationGatewayAccessLog,ApplicationGatewayFirewallLog,FrontdoorAccessLog,FrontdoorWebApplicationFirewallLog"  \|  Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE"  \|  Syslog.SyslogMessage has "jndi"  \|  Syslog.SyslogMessage has_any "corba,dns,iiop,ldap,nds,nis,rmi" | [Log4jPostCompromiseHunting.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Workbooks/Log4jPostCompromiseHunting.json) |

### AristaAwakeSecurity

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Awake Security - High Match Counts By Device | CommonSecurityLog.DeviceProduct == "Awake Security"  \|  CommonSecurityLog.DeviceVendor == "Arista Networks" | [HighMatchCountsByDevice.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AristaAwakeSecurity/Analytic%20Rules/HighMatchCountsByDevice.yaml) |
| analytic_rule | Awake Security - High Severity Matches By Device | CommonSecurityLog.DeviceProduct == "Awake Security"  \|  CommonSecurityLog.DeviceVendor == "Arista Networks" | [HighSeverityMatchesByDevice.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AristaAwakeSecurity/Analytic%20Rules/HighSeverityMatchesByDevice.yaml) |
| analytic_rule | Awake Security - Model With Multiple Destinations | CommonSecurityLog.DeviceProduct == "Awake Security"  \|  CommonSecurityLog.DeviceVendor == "Arista Networks" | [ModelMatchesWithMultipleDestinationsByDevice.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AristaAwakeSecurity/Analytic%20Rules/ModelMatchesWithMultipleDestinationsByDevice.yaml) |
| workbook | AristaAwakeSecurityWorkbook | CommonSecurityLog.DeviceProduct == "Awake Security"  \|  CommonSecurityLog.DeviceVendor == "Arista Networks" | [AristaAwakeSecurityWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AristaAwakeSecurity/Workbooks/AristaAwakeSecurityWorkbook.json) |

### Attacker Tools Threat Protection Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Credential Dumping Tools - File Artifacts | Event.EventID == "11"  \|  Event.EventLog == "Microsoft-Windows-Sysmon/Operational" | [CredentialDumpingToolsFileArtifacts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Attacker%20Tools%20Threat%20Protection%20Essentials/Analytic%20Rules/CredentialDumpingToolsFileArtifacts.yaml) |
| analytic_rule | Credential Dumping Tools - Service Installation | Event.EventID == "7045"  \|  Event.Source == "Service Control Manager" | [CredentialDumpingServiceInstallation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Attacker%20Tools%20Threat%20Protection%20Essentials/Analytic%20Rules/CredentialDumpingServiceInstallation.yaml) |

### Azure Activity

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Granting permissions to account | AzureActivity.OperationName =~ "Create role assignment" | [Granting_Permissions_to_Account.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Activity/Hunting%20Queries/Granting_Permissions_to_Account.yaml) |
| hunting_query | Rare Custom Script Extension | AzureActivity.OperationName =~ "Create or Update Virtual Machine Extension" | [Rare_Custom_Script_Extension.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Activity/Hunting%20Queries/Rare_Custom_Script_Extension.yaml) |

### Azure DDoS Protection

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | DDoS Attack IP Addresses - PPS Threshold | AzureDiagnostics.Category == "DDoSMitigationFlowLogs"  \|  AzureDiagnostics.ResourceType == "PUBLICIPADDRESSES" | [AttackSourcesPPSThreshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20DDoS%20Protection/Analytic%20Rules/AttackSourcesPPSThreshold.yaml) |
| analytic_rule | DDoS Attack IP Addresses - Percent Threshold | AzureDiagnostics.Category == "DDoSMitigationFlowLogs"  \|  AzureDiagnostics.ResourceType == "PUBLICIPADDRESSES" | [AttackSourcesPercentThreshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20DDoS%20Protection/Analytic%20Rules/AttackSourcesPercentThreshold.yaml) |
| workbook | AzDDoSStandardWorkbook | AzureDiagnostics.Category in "DDoSMitigationFlowLogs,DDoSMitigationReports,DDoSProtectionNotifications" | [AzDDoSStandardWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20DDoS%20Protection/Workbooks/AzDDoSStandardWorkbook.json) |

### Azure Firewall

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | AzureFirewallWorkbook | AzureDiagnostics.Category in "AzureFirewallApplicationRule,AzureFirewallDnsProxy,AzureFirewallNetworkRule"  \|  AzureDiagnostics.ResourceType == "AZUREFIREWALLS" | [AzureFirewallWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Firewall/Workbooks/AzureFirewallWorkbook.json) |

### Azure Key Vault

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Azure Key Vault access TimeSeries anomaly | AzureDiagnostics.ResourceType =~ "VAULTS" | [TimeSeriesKeyvaultAccessAnomaly.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Key%20Vault/Analytic%20Rules/TimeSeriesKeyvaultAccessAnomaly.yaml) |
| analytic_rule | Mass secret retrieval from Azure Key Vault | AzureDiagnostics.ResourceType =~ "VAULTS" | [KeyvaultMassSecretRetrieval.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Key%20Vault/Analytic%20Rules/KeyvaultMassSecretRetrieval.yaml) |
| analytic_rule | NRT Sensitive Azure Key Vault operations | AzureDiagnostics.ResourceType =~ "VAULTS" | [NRT_KeyVaultSensitiveOperations.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Key%20Vault/Analytic%20Rules/NRT_KeyVaultSensitiveOperations.yaml) |
| analytic_rule | Sensitive Azure Key Vault operations | AzureDiagnostics.ResourceType =~ "VAULTS" | [KeyVaultSensitiveOperations.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Key%20Vault/Analytic%20Rules/KeyVaultSensitiveOperations.yaml) |
| workbook | AzureKeyVaultWorkbook | AzureDiagnostics.Category == "AuditEvent"  \|  AzureDiagnostics.ResourceType =~ "VAULTS" | [AzureKeyVaultWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Key%20Vault/Workbooks/AzureKeyVaultWorkbook.json) |

### Azure SQL Database solution for sentinel

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Affected rows stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-VolumeAffectedRowsStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-VolumeAffectedRowsStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Credential errors stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-ErrorsCredentialStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-ErrorsCredentialStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Drop attempts stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-HotwordsDropStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-HotwordsDropStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Execution attempts stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-HotwordsExecutionStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-HotwordsExecutionStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Firewall errors stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-ErrorsFirewallStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-ErrorsFirewallStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Firewall rule manipulation attempts stateful anoma | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-HotwordsFirewallRuleStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-HotwordsFirewallRuleStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | OLE object manipulation attempts stateful anomaly  | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-HotwordsOLEObjectStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-HotwordsOLEObjectStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Outgoing connection attempts stateful anomaly on d | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-HotwordsOutgoingStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-HotwordsOutgoingStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Response rows stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-VolumeResponseRowsStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-VolumeResponseRowsStatefulAnomalyOnDatabase.yaml) |
| analytic_rule | Syntax errors stateful anomaly on database | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [Detection-ErrorsSyntaxStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Analytic%20Rules/Detection-ErrorsSyntaxStatefulAnomalyOnDatabase.yaml) |
| hunting_query | Affected rows stateful anomaly on database - hunti | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-VolumeAffectedRowsStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-VolumeAffectedRowsStatefulAnomalyOnDatabase.yaml) |
| hunting_query | Anomalous Query Execution Time | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-AffectedRowAnomaly.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-AffectedRowAnomaly.yaml) |
| hunting_query | Anomalous Query Execution Time | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-ExecutionTimeAnomaly.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-ExecutionTimeAnomaly.yaml) |
| hunting_query | Boolean Blind SQL Injection | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-BooleanBlindSQLi.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-BooleanBlindSQLi.yaml) |
| hunting_query | Prevalence Based SQL Query Size Anomaly | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-PrevalenceBasedQuerySizeAnomaly.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-PrevalenceBasedQuerySizeAnomaly.yaml) |
| hunting_query | Response rows stateful anomaly on database - hunti | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-VolumeResponseRowsStatefulAnomalyOnDatabase.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-VolumeResponseRowsStatefulAnomalyOnDatabase.yaml) |
| hunting_query | Suspicious SQL Stored Procedures | AzureDiagnostics.Category =~ "SQLSecurityAuditEvents" | [HuntingQuery-SuspiciousStoredProcedures.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-SuspiciousStoredProcedures.yaml) |
| hunting_query | Time Based SQL Query Size Anomaly | AzureDiagnostics.Category == "SQLSecurityAuditEvents" | [HuntingQuery-TimeBasedQuerySizeAnomaly.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Hunting%20Queries/HuntingQuery-TimeBasedQuerySizeAnomaly.yaml) |
| workbook | Workbook-AzureSQLSecurity | AzureDiagnostics.Category == "SQLSecurityAuditEvents"  \|  AzureDiagnostics.ResourceType == "SERVERS/DATABASES" | [Workbook-AzureSQLSecurity.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20SQL%20Database%20solution%20for%20sentinel/Workbooks/Workbook-AzureSQLSecurity.json) |

### Azure Web Application Firewall (WAF)

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | AFD WAF - Code Injection | AzureDiagnostics.Category =~ "FrontDoorWebApplicationFirewallLog" | [AFD-WAF-Code-Injection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Analytic%20Rules/AFD-WAF-Code-Injection.yaml) |
| analytic_rule | AFD WAF - Path Traversal Attack | AzureDiagnostics.Category =~ "FrontDoorWebApplicationFirewallLog" | [AFD-WAF-Path-Traversal-Attack.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Analytic%20Rules/AFD-WAF-Path-Traversal-Attack.yaml) |
| analytic_rule | Front Door Premium WAF - SQLi Detection | AzureDiagnostics.Category =~ "FrontDoorWebApplicationFirewallLog" | [AFD-Premium-WAF-SQLiDetection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Analytic%20Rules/AFD-Premium-WAF-SQLiDetection.yaml) |
| analytic_rule | Front Door Premium WAF - XSS Detection | AzureDiagnostics.Category =~ "FrontDoorWebApplicationFirewallLog" | [AFD-Premium-WAF-XSSDetection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Analytic%20Rules/AFD-Premium-WAF-XSSDetection.yaml) |
| workbook | WebApplicationFirewallFirewallEvents | AzureDiagnostics.ResourceType == "APPLICATIONGATEWAYS" | [WebApplicationFirewallFirewallEvents.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Workbooks/WebApplicationFirewallFirewallEvents.json) |
| workbook | WebApplicationFirewallGatewayAccessEvents | AzureDiagnostics.ResourceType == "APPLICATIONGATEWAYS" | [WebApplicationFirewallGatewayAccessEvents.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Workbooks/WebApplicationFirewallGatewayAccessEvents.json) |
| workbook | WebApplicationFirewallOverview | AzureDiagnostics.ResourceType == "APPLICATIONGATEWAYS" | [WebApplicationFirewallOverview.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Web%20Application%20Firewall%20%28WAF%29/Workbooks/WebApplicationFirewallOverview.json) |

### Azure kubernetes Service

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Azure RBAC AKS created role details | AzureDiagnostics.Category == "kube-audit" | [AKS-Rbac.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20kubernetes%20Service/Hunting%20Queries/AKS-Rbac.yaml) |
| hunting_query | Determine users with cluster admin role | AzureDiagnostics.Category == "kube-audit" | [AKS-clusterrolebinding.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20kubernetes%20Service/Hunting%20Queries/AKS-clusterrolebinding.yaml) |
| workbook | AksSecurity | AzureDiagnostics.Category == "kube-audit" | [AksSecurity.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20kubernetes%20Service/Workbooks/AksSecurity.json) |

### AzureSecurityBenchmark

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | AzureSecurityBenchmark | AADNonInteractiveUserSignInLogs.OperationName in "Add member to role,Add user,AzureFirewallIDSLog,NetworkSecurityGroupEvents,Reset user password,Update user"  \|  AADNonInteractiveUserSignInLogs.OperationName contains "PIM"  \|  AADNonInteractiveUserSignInLogs.OperationName contains "create"  \|  AADNonInteractiveUserSignInLogs.OperationName contains "delete"  \|  AADNonInteractiveUserSignInLogs.OperationName contains "lockbox"  \|  AADNonInteractiveUserSignInLogs.OperationName contains "remove"  \|  AADNonInteractiveUserSignInLogs.OperationName contains "update"  \|  AzureDiagnostics.Category in "All,AzureFirewallNetworkRule,NetworkSecurityGroupRuleCounter"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType == "AZUREFIREWALLS"  \|  SecurityEvent.EventID in "2889,3000,4624,4768,4769,4776" | [AzureSecurityBenchmark.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/AzureSecurityBenchmark/Workbooks/AzureSecurityBenchmark.json) |

### Barracuda CloudGen Firewall

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | Barracuda | CommonSecurityLog.DeviceVendor == "Barracuda" | [Barracuda.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Barracuda%20CloudGen%20Firewall/Workbooks/Barracuda.json) |

### Business Email Compromise - Financial Fraud

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Account Elevated to New Role | AuditLogs.OperationName =~ "Add member to role completed (PIM activation)" | [AccountElevatedtoNewRole.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Business%20Email%20Compromise%20-%20Financial%20Fraud/Analytic%20Rules/AccountElevatedtoNewRole.yaml) |
| analytic_rule | Privileged Account Permissions Changed | AuditLogs.OperationName has "Add eligible member" | [PrivilegedAccountPermissionsChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Business%20Email%20Compromise%20-%20Financial%20Fraud/Analytic%20Rules/PrivilegedAccountPermissionsChanged.yaml) |
| hunting_query | Office Mail Rule Creation with suspicious archive  | OfficeActivity.OfficeWorkload =~ "Exchange" | [OfficeMailRuleCreationWithMailMoveActivity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Business%20Email%20Compromise%20-%20Financial%20Fraud/Hunting%20Queries/OfficeMailRuleCreationWithMailMoveActivity.yaml) |
| hunting_query | Risky Sign-in with new MFA method | AuditLogs.OperationName =~ "Update user" | [riskSignInWithNewMFAMethod.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Business%20Email%20Compromise%20-%20Financial%20Fraud/Hunting%20Queries/riskSignInWithNewMFAMethod.yaml) |

### CTERA

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Antivirus Detected an Infected File | Syslog.SyslogMessage contains "found an infected file" | [InfectedFileDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Analytic%20Rules/InfectedFileDetected.yaml) |
| analytic_rule | CTERA Mass Access Denied Detection Analytic | Syslog.ProcessName == "gw-audit" | [MassAccessDenied.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Analytic%20Rules/MassAccessDenied.yaml) |
| analytic_rule | CTERA Mass Deletions Detection Analytic | Syslog.ProcessName == "gw-audit" | [MassDeletions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Analytic%20Rules/MassDeletions.yaml) |
| analytic_rule | CTERA Mass Permissions Changes Detection Analytic | Syslog.ProcessName == "gw-audit" | [MassPermissionChanges.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Analytic%20Rules/MassPermissionChanges.yaml) |
| analytic_rule | Ransom Protect Detected a Ransomware Attack | Syslog.SyslogMessage contains "Ransomware incident detected" | [RansomwareDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Analytic%20Rules/RansomwareDetected.yaml) |
| analytic_rule | Ransom Protect User Blocked | Syslog.SyslogMessage contains "Ransom Protect mechanism blocked" | [RansomwareUserBlocked.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Analytic%20Rules/RansomwareUserBlocked.yaml) |
| hunting_query | CTERA Batch Access Denied Detection | Syslog.ProcessName == "gw-audit" | [AccessDenied.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Hunting%20Queries/AccessDenied.yaml) |
| hunting_query | CTERA Batch File Deletions Detection | Syslog.ProcessName == "gw-audit" | [BatchDeletions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Hunting%20Queries/BatchDeletions.yaml) |
| hunting_query | CTERA Permission Change Detection | Syslog.ProcessName == "gw-audit" | [BatchPermissionChanges.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Hunting%20Queries/BatchPermissionChanges.yaml) |
| workbook | CTERA_Workbook | Syslog.ProcessName == "gw-audit"  \|  Syslog.SyslogMessage contains "ctera_audit"  \|  Syslog.SyslogMessage contains "op=delete" | [CTERA_Workbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CTERA/Workbooks/CTERA_Workbook.json) |

### Check Point

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | CheckPoint | CommonSecurityLog.DeviceProduct in~ "Anti Malware,Anti-Bot,Anti-Virus,Application Control,DDoS Protector,IPS,Threat Emulation,URL Filtering"  \|  CommonSecurityLog.DeviceVendor == "Check Point" | [CheckPoint.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Check%20Point/Workbooks/CheckPoint.json) |

### CiscoASA

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Cisco ASA - average attack detection rate increase | CommonSecurityLog.DeviceEventClassID == "733100" | [CiscoASA-AvgAttackDetectRateIncrease.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoASA/Analytic%20Rules/CiscoASA-AvgAttackDetectRateIncrease.yaml) |
| analytic_rule | Cisco ASA - threat detection message fired | CommonSecurityLog.DeviceEventClassID in "733101,733102,733103,733104,733105" | [CiscoASA-ThreatDetectionMessage.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoASA/Analytic%20Rules/CiscoASA-ThreatDetectionMessage.yaml) |
| workbook | Cisco | CommonSecurityLog.DeviceEventClassID in "106100,111008,113012,113015,302010,315011,611102,733100"  \|  CommonSecurityLog.DeviceProduct =~ "ASA"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | [Cisco.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoASA/Workbooks/Cisco.json) |

### Citrix Web App Firewall

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | CitrixWAF | CommonSecurityLog.DeviceProduct == "NetScaler"  \|  CommonSecurityLog.DeviceVendor == "Citrix" | [CitrixWAF.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Citrix%20Web%20App%20Firewall/Workbooks/CitrixWAF.json) |

### Cloud Identity Threat Protection Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | New External User Granted Admin Role | AuditLogs.OperationName in~ "Invite external user,Redeem external user invite"  \|  AuditLogs.OperationName has "Invite external user"  \|  AuditLogs.OperationName has "Redeem external user invite" | [NewExtUserGrantedAdmin.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cloud%20Identity%20Threat%20Protection%20Essentials/Analytic%20Rules/NewExtUserGrantedAdmin.yaml) |
| hunting_query | Application Granted EWS Permissions | AuditLogs.OperationName has "Add app role assignment to service principal" | [ApplicationGrantedEWSPermissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cloud%20Identity%20Threat%20Protection%20Essentials/Hunting%20Queries/ApplicationGrantedEWSPermissions.yaml) |
| hunting_query | Interactive STS refresh token modifications | AuditLogs.OperationName has "StsRefreshTokenValidFrom" | [StsRefreshTokenModification.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cloud%20Identity%20Threat%20Protection%20Essentials/Hunting%20Queries/StsRefreshTokenModification.yaml) |

### Cloud Service Threat Protection Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Azure Key Vault Access Policy Manipulation | AzureDiagnostics.ResourceType =~ "VAULTS" | [AzureKeyVaultAccessManipulation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cloud%20Service%20Threat%20Protection%20Essentials/Hunting%20Queries/AzureKeyVaultAccessManipulation.yaml) |

### Common Event Format

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | CEFOverviewWorkbook | CommonSecurityLog.DeviceProduct has "PAN-OS" | [CEFOverviewWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Common%20Event%20Format/Workbooks/CEFOverviewWorkbook.json) |

### ContinuousDiagnostics&Mitigation

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | ContinuousDiagnostics&Mitigation | AuditLogs.OperationName contains "PIM"  \|  AzureDiagnostics.Category in "NetworkSecurityGroupEvent,kube-audit"  \|  AzureDiagnostics.Category contains "SQL"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,AZUREFIREWALLS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS,PROFILES,PUBLICIPADDRESSES" | [ContinuousDiagnostics&Mitigation.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ContinuousDiagnostics%26Mitigation/Workbooks/ContinuousDiagnostics%26Mitigation.json) |

### Contrast Protect

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Contrast Blocks | CommonSecurityLog.DeviceVendor == "Contrast Security" | [ContrastBlocks.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Analytic%20Rules/ContrastBlocks.yaml) |
| analytic_rule | Contrast Exploits | CommonSecurityLog.DeviceVendor == "Contrast Security" | [ContrastExploits.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Analytic%20Rules/ContrastExploits.yaml) |
| analytic_rule | Contrast Probes | CommonSecurityLog.DeviceVendor == "Contrast Security" | [ContrastProbes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Analytic%20Rules/ContrastProbes.yaml) |
| analytic_rule | Contrast Suspicious | CommonSecurityLog.DeviceVendor == "Contrast Security" | [ContrastSuspicious.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Analytic%20Rules/ContrastSuspicious.yaml) |
| workbook | ContrastProtect | CommonSecurityLog.DeviceVendor == "Contrast Security" | [ContrastProtect.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Contrast%20Protect/Workbooks/ContrastProtect.json) |

### CyberArk Privilege Access Manager (PAM) Events

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | CyberArkEPV | CommonSecurityLog.DeviceProduct == "Vault"  \|  CommonSecurityLog.DeviceVendor == "Cyber-Ark" | [CyberArkEPV.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CyberArk%20Enterprise%20Password%20Vault%20%28EPV%29%20Events/Workbooks/CyberArkEPV.json) |

### CybersecurityMaturityModelCertification(CMMC)2.0

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | CybersecurityMaturityModelCertification_CMMCV2 | AuditLogs.OperationName in "Add member to role,Add user,NetworkSecurityGroupEvents,Reset user password,Update user"  \|  AuditLogs.OperationName contains "Add"  \|  AuditLogs.OperationName contains "Audit"  \|  AuditLogs.OperationName contains "Change"  \|  AuditLogs.OperationName contains "Create"  \|  AuditLogs.OperationName contains "Delete"  \|  AuditLogs.OperationName contains "Log"  \|  AuditLogs.OperationName contains "Monitor"  \|  AuditLogs.OperationName contains "PIM"  \|  AuditLogs.OperationName contains "Remove"  \|  AuditLogs.OperationName contains "Update"  \|  AuditLogs.OperationName contains "Write"  \|  AuditLogs.OperationName contains "reset"  \|  AzureDiagnostics.Category == "AzureFirewallApplicationRule"  \|  DeviceEvents.ActionType in "Add member to role,Add user,FileCreated,InteractiveLogon,RemoteInteractiveLogon,Reset user password,ResourceAccess,Sign-in,Update user,UsbDriveMounted"  \|  OfficeActivity.RecordType == "MicrosoftTeams" | [CybersecurityMaturityModelCertification_CMMCV2.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CybersecurityMaturityModelCertification%28CMMC%292.0/Workbooks/CybersecurityMaturityModelCertification_CMMCV2.json) |

### Cyborg Security HUNTER

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Metasploit / Impacket PsExec Process Creation Acti | SecurityEvent.EventID == "4688" | [Metasploit Impacket PsExec Process Creation Activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cyborg%20Security%20HUNTER/Hunting%20Queries/Metasploit%20Impacket%20PsExec%20Process%20Creation%20Activity.yaml) |

### DORA Compliance

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | DORACompliance | Event.EventID in "1001,1069,1205" | [DORACompliance.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/DORA%20Compliance/Workbooks/DORACompliance.json) |

### DPDP Compliance

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | DPDPCompliance | AuditLogs.OperationName in "Add member to role,Add user,Consent to application,Reset user password,Update user"  \|  AuditLogs.OperationName =~ "Sign-in activity"  \|  AuditLogs.OperationName != "Consent to application"  \|  AzureDiagnostics.Category == "SQLSecurityAuditEvents"  \|  AzureDiagnostics.ResourceType == "SERVERS/DATABASES"  \|  OfficeActivity.OfficeWorkload == "Exchange"  \|  OfficeActivity.OfficeWorkload in~ "AzureActiveDirectory,MicrosoftTeams"  \|  OfficeActivity.OfficeWorkload has_any "Exchange,OneDrive"  \|  OfficeActivity.OfficeWorkload has_any "OneDrive,SharePoint"  \|  OfficeActivity.RecordType in~ "ExchangeAdmin,SharePointFileOperation" | [DPDPCompliance.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/DPDP%20Compliance/Workbooks/DPDPCompliance.json) |

### Delinea Secret Server

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | DelineaWorkbook | CommonSecurityLog.DeviceProduct == "Secret Server"  \|  CommonSecurityLog.DeviceVendor in "Delinea Software,Thycotic Software" | [DelineaWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Delinea%20Secret%20Server/Workbooks/DelineaWorkbook.json) |

### EatonForeseer

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | EatonForeseer - Unauthorized Logins | SecurityEvent.EventID in "4624,4625,4634,4647,4648,4675" | [EatonUnautorizedLogins.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/EatonForeseer/Analytic%20Rules/EatonUnautorizedLogins.yaml) |
| workbook | EatonForeseerHealthAndAccess | SecurityEvent.EventID in "4624,4625,4634,4647,4648,4675" | [EatonForeseerHealthAndAccess.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/EatonForeseer/Workbooks/EatonForeseerHealthAndAccess.json) |

### Endpoint Threat Protection Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Detecting Macro Invoking ShellBrowserWindow COM Ob | Event.EventID == "1"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [MacroInvokingShellBrowserWindowCOMObjects.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/MacroInvokingShellBrowserWindowCOMObjects.yaml) |
| analytic_rule | Dumping LSASS Process Into a File | Event.EventID == "10"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [DumpingLSASSProcessIntoaFile.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/DumpingLSASSProcessIntoaFile.yaml) |
| analytic_rule | Lateral Movement via DCOM | Event.EventID == "1"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [LateralMovementViaDCOM.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/LateralMovementViaDCOM.yaml) |
| analytic_rule | Potential Remote Desktop Tunneling | SecurityEvent.EventID in "4624,4625" | [PotentialRemoteDesktopTunneling.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/PotentialRemoteDesktopTunneling.yaml) |
| analytic_rule | Registry Persistence via AppCert DLL Modification | Event.EventID == "13"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [RegistryPersistenceViaAppCertDLLModification.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/RegistryPersistenceViaAppCertDLLModification.yaml) |
| analytic_rule | Registry Persistence via AppInit DLLs Modification | Event.EventID == "13"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [RegistryPersistenceViaAppInt_DLLsModification.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/RegistryPersistenceViaAppInt_DLLsModification.yaml) |
| analytic_rule | Security Event log cleared | WindowsEvent.EventID == "1102"  \|  WindowsEvent.Provider =~ "Microsoft-Windows-Eventlog" | [SecurityEventLogCleared.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/SecurityEventLogCleared.yaml) |
| analytic_rule | Suspicious Powershell Commandlet Executed | DeviceEvents.ActionType == "PowerShellCommand" | [SuspiciousPowerShellCommandExecuted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/SuspiciousPowerShellCommandExecuted.yaml) |
| analytic_rule | WDigest downgrade attack | Event.EventID == "13"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [WDigestDowngradeAttack.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/WDigestDowngradeAttack.yaml) |
| analytic_rule | Windows Binaries Executed from Non-Default Directo | SecurityEvent.EventID == "4688" | [WindowsBinariesExecutedfromNon-DefaultDirectory.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/WindowsBinariesExecutedfromNon-DefaultDirectory.yaml) |
| analytic_rule | Windows Binaries Lolbins Renamed | Event.EventID == "1"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [WindowsBinariesLolbinsRenamed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Analytic%20Rules/WindowsBinariesLolbinsRenamed.yaml) |
| hunting_query | Detect Certutil (LOLBins and LOLScripts) Usage | Event.EventID == "1"  \|  Event.Source =~ "Microsoft-Windows-Sysmon" | [Certutil-LOLBins.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/Certutil-LOLBins.yaml) |
| hunting_query | Execution of File with One Character in the Name | Event.EventID == "1"  \|  Event.EventLog =~ "Microsoft-Windows-Sysmon/Operational" | [FileExecutionWithOneCharacterInTheName.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/FileExecutionWithOneCharacterInTheName.yaml) |
| hunting_query | Persisting via IFEO Registry Key | Event.Source =~ "Microsoft-Windows-Sysmon"  \|  WindowsEvent.EventID in "12,13,4657" | [PersistViaIFEORegistryKey.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/PersistViaIFEORegistryKey.yaml) |
| hunting_query | Potential Microsoft Security Services Tampering | Event.Source =~ "Microsoft-Windows-SENSE"  \|  WindowsEvent.EventID in "4688,87" | [PotentialMicrosoftSecurityServicesTampering.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/PotentialMicrosoftSecurityServicesTampering.yaml) |
| hunting_query | Rare Windows Firewall Rule updates using Netsh | Event.Source == "Microsoft-Windows-Sysmon"  \|  SecurityEvent.EventID == "1" | [WindowsFirewallUpdateUsingNetsh.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/WindowsFirewallUpdateUsingNetsh.yaml) |
| hunting_query | Remote Login Performed with WMI | SecurityEvent.EventID in "4624,4625" | [RemoteLoginPerformedwithWMI.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/RemoteLoginPerformedwithWMI.yaml) |
| hunting_query | Remote Scheduled Task Creation or Update using ATS | SecurityEvent.EventID == "5145" | [RemoteScheduledTaskCreationUpdateUsingATSVCNamedPipe.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/RemoteScheduledTaskCreationUpdateUsingATSVCNamedPipe.yaml) |
| hunting_query | Rundll32 (LOLBins and LOLScripts) | Event.EventID == "1"  \|  Event.Source =~ "Microsoft-Windows-Sysmon" | [SignedBinaryProxyExecutionRundll32.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/SignedBinaryProxyExecutionRundll32.yaml) |
| hunting_query | Scheduled Task Creation or Update from User Writab | SecurityEvent.EventID in "4698,4702" | [ScheduledTaskCreationUpdateFromUserWritableDrectory.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/ScheduledTaskCreationUpdateFromUserWritableDrectory.yaml) |
| hunting_query | Suspicious Powershell Commandlet Execution | DeviceEvents.ActionType == "PowerShellCommand" | [SuspiciousPowerShellCommandExecution.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Endpoint%20Threat%20Protection%20Essentials/Hunting%20Queries/SuspiciousPowerShellCommandExecution.yaml) |

### ExtraHop Reveal(x)

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | ExtraHopDetectionSummary | CommonSecurityLog.DeviceVendor == "ExtraHop" | [ExtraHopDetectionSummary.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ExtraHop%20Reveal%28x%29/Workbooks/ExtraHopDetectionSummary.json) |

### FalconFriday

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | ASR Bypassing Writing Executable Content | DeviceFileEvents.ActionType == "FileRenamed" | [ASRBypassingWritingExecutableContent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/ASRBypassingWritingExecutableContent.yaml) |
| analytic_rule | Beacon Traffic Based on Common User Agents Visitin | CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [RecognizingBeaconingTraffic.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/RecognizingBeaconingTraffic.yaml) |
| analytic_rule | Certified Pre-Owned - TGTs requested with certific | SecurityEvent.EventID == "4768" | [CertifiedPreOwned-TGTs-requested.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/CertifiedPreOwned-TGTs-requested.yaml) |
| analytic_rule | Certified Pre-Owned - backup of CA private key - r | SecurityEvent.EventID == "5058" | [CertifiedPreOwned-backup-key-1.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/CertifiedPreOwned-backup-key-1.yaml) |
| analytic_rule | Certified Pre-Owned - backup of CA private key - r | SecurityEvent.EventID == "5059" | [CertifiedPreOwned-backup-key-2.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/CertifiedPreOwned-backup-key-2.yaml) |
| analytic_rule | Component Object Model Hijacking - Vault7 trick | DeviceRegistryEvents.ActionType =~ "RegistryValueSet" | [COMHijacking.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/COMHijacking.yaml) |
| analytic_rule | DCOM Lateral Movement | DeviceProcessEvents.ActionType != "ListeningConnectionCreated" | [DCOMLateralMovement.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/DCOMLateralMovement.yaml) |
| analytic_rule | Excessive share permissions | SecurityEvent.EventID == "5143" | [ExcessiveSharePermissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/ExcessiveSharePermissions.yaml) |
| analytic_rule | Hijack Execution Flow - DLL Side-Loading | DeviceImageLoadEvents.ActionType in "FileCreated,FileModified" | [DLLSideLoading.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/DLLSideLoading.yaml) |
| analytic_rule | Office ASR rule triggered from browser spawned off | DeviceEvents.ActionType contains "Office" | [OfficeASRFromBrowser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/OfficeASRFromBrowser.yaml) |
| analytic_rule | Remote Desktop Protocol - SharpRDP | DeviceProcessEvents.ActionType == "LogonSuccess" | [RemoteDesktopProtocol.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/RemoteDesktopProtocol.yaml) |
| analytic_rule | SMB/Windows Admin Shares | DeviceProcessEvents.ActionType == "InboundConnectionAccepted" | [SMBWindowsAdminShares.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/SMBWindowsAdminShares.yaml) |
| analytic_rule | Suspicious Process Injection from Office applicati | DeviceEvents.ActionType in "CreateRemoteThreadApiCall,QueueUserApcRemoteApiCall,SetThreadContextRemoteApiCall" | [OfficeProcessInjection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/OfficeProcessInjection.yaml) |
| analytic_rule | Suspicious named pipes | DeviceEvents.ActionType == "NamedPipeEvent" | [SuspiciousNamedPipes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/FalconFriday/Analytic%20Rules/SuspiciousNamedPipes.yaml) |

### Forcepoint CASB

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | ForcepointCASB | CommonSecurityLog.DeviceProduct in "CASB Admin audit log,Cloud Service Monitoring,SaaS Security Gateway"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint CASB" | [ForcepointCASB.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20CASB/Workbooks/ForcepointCASB.json) |

### Forcepoint CSG

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | ForcepointCloudSecuirtyGateway | CommonSecurityLog.DeviceProduct in "Email,Web"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint CSG" | [ForcepointCloudSecuirtyGateway.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20CSG/Workbooks/ForcepointCloudSecuirtyGateway.json) |

### Forcepoint NGFW

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | ForcepointNGFW | CommonSecurityLog.DeviceProduct == "NGFW"  \|  CommonSecurityLog.DeviceVendor == "Forcepoint" | [ForcepointNGFW.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20NGFW/Workbooks/ForcepointNGFW.json) |
| workbook | ForcepointNGFWAdvanced | CommonSecurityLog.DeviceProduct in "Alert,Audit"  \|  CommonSecurityLog.DeviceVendor in~ "FORCEPOINT,Forcepoint" | [ForcepointNGFWAdvanced.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Forcepoint%20NGFW/Workbooks/ForcepointNGFWAdvanced.json) |

### Fortinet FortiGate Next-Generation Firewall connector for Microsoft Sentinel

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | Fortigate | CommonSecurityLog.DeviceProduct contains "Fortigate"  \|  CommonSecurityLog.DeviceVendor =~ "Fortinet" | [Fortigate.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Fortinet%20FortiGate%20Next-Generation%20Firewall%20connector%20for%20Microsoft%20Sentinel/Workbooks/Fortigate.json) |

### GDPR Compliance & Data Security

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | GDPRComplianceAndDataSecurity | AuditLogs.OperationName in "Add member to role,Add user,Consent to application,Reset user password,Update user"  \|  AuditLogs.OperationName =~ "Sign-in activity"  \|  AuditLogs.OperationName != "Consent to application"  \|  AzureDiagnostics.Category == "SQLSecurityAuditEvents"  \|  AzureDiagnostics.ResourceType == "SERVERS/DATABASES"  \|  OfficeActivity.OfficeWorkload == "Exchange"  \|  OfficeActivity.OfficeWorkload in~ "AzureActiveDirectory,MicrosoftTeams"  \|  OfficeActivity.OfficeWorkload has_any "Exchange,OneDrive"  \|  OfficeActivity.OfficeWorkload has_any "OneDrive,SharePoint"  \|  OfficeActivity.RecordType in~ "ExchangeAdmin,SharePointFileOperation" | [GDPRComplianceAndDataSecurity.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/GDPR%20Compliance%20%26%20Data%20Security/Workbooks/GDPRComplianceAndDataSecurity.json) |

### Global Secure Access

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | GSAM365EnrichedEvents | OfficeActivity.OfficeWorkload in "Exchange,OneDrive,SPO/OneDrive,SharePoint,Teams" | [GSAM365EnrichedEvents.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Global%20Secure%20Access/Workbooks/GSAM365EnrichedEvents.json) |

### HIPAA Compliance

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | HIPAACompliance | AzureDiagnostics.Category == "AzureFirewallNetworkRule"  \|  AzureDiagnostics.Category =~ "SQLSecurityAuditEvents"  \|  DeviceNetworkEvents.ActionType == "ConnectionSuccess"  \|  SecurityEvent.EventID in "4624,4625" | [HIPAACompliance.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/HIPAA%20Compliance/Workbooks/HIPAACompliance.json) |

### IllumioSaaS

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | IllumioOnPremHealth | Syslog.SyslogMessage has "disk=Policy"  \|  Syslog.SyslogMessage has "disk=Traffic"  \|  Syslog.SyslogMessage has "illumio_pce/system_health"  \|  Syslog.SyslogMessage has "src=collector"  \|  Syslog.SyslogMessage has "src=disk_latency"  \|  Syslog.SyslogMessage has "src=flow_analytics" | [IllumioOnPremHealth.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/IllumioSaaS/Workbooks/IllumioOnPremHealth.json) |

### Illusive Platform

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Illusive Incidents Analytic Rule | CommonSecurityLog.DeviceProduct == "illusive" | [Illusive_Detection_Query.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Illusive%20Platform/Analytic%20Rules/Illusive_Detection_Query.yaml) |
| workbook | IllusiveADS | CommonSecurityLog.DeviceEventClassID in "illusive:access,illusive:login,illusive:suspicious" | [IllusiveADS.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Illusive%20Platform/Workbooks/IllusiveADS.json) |
| workbook | IllusiveASM | CommonSecurityLog.DeviceEventClassID == "illusive:violation" | [IllusiveASM.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Illusive%20Platform/Workbooks/IllusiveASM.json) |

### Infoblox

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | Infoblox_Workbook | CommonSecurityLog.DeviceEventClassID in "DHCP-LEASE-CREATE,DHCP-LEASE-DELETE,DHCP-LEASE-UPDATE"  \|  CommonSecurityLog.DeviceEventClassID has_cs "Audit"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DHCP"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DNS"  \|  CommonSecurityLog.DeviceEventClassID has_cs "RPZ"  \|  CommonSecurityLog.DeviceEventClassID has_cs "Service"  \|  CommonSecurityLog.DeviceProduct == "Data Connector"  \|  CommonSecurityLog.DeviceVendor == "Infoblox" | [Infoblox_Workbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox/Workbooks/Infoblox_Workbook.json) |

### Infoblox Cloud Data Connector

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Infoblox - Data Exfiltration Attack | CommonSecurityLog.DeviceEventClassID has_cs "RPZ" | [Infoblox-DataExfiltrationAttack.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Analytic%20Rules/Infoblox-DataExfiltrationAttack.yaml) |
| analytic_rule | Infoblox - High Threat Level Query Not Blocked Det | CommonSecurityLog.DeviceEventClassID has_cs "RPZ" | [Infoblox-HighThreatLevelQueryNotBlockedDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Analytic%20Rules/Infoblox-HighThreatLevelQueryNotBlockedDetected.yaml) |
| analytic_rule | Infoblox - Many High Threat Level Queries From Sin | CommonSecurityLog.DeviceEventClassID has_cs "RPZ" | [Infoblox-ManyHighThreatLevelQueriesFromSingleHostDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Analytic%20Rules/Infoblox-ManyHighThreatLevelQueriesFromSingleHostDetected.yaml) |
| analytic_rule | Infoblox - Many High Threat Level Single Query Det | CommonSecurityLog.DeviceEventClassID has_cs "RPZ" | [Infoblox-ManyHighThreatLevelSingleQueryDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Analytic%20Rules/Infoblox-ManyHighThreatLevelSingleQueryDetected.yaml) |
| analytic_rule | Infoblox - Many NXDOMAIN DNS Responses Detected | CommonSecurityLog.DeviceEventClassID == "DNS Response" | [Infoblox-ManyNXDOMAINDNSResponsesDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Analytic%20Rules/Infoblox-ManyNXDOMAINDNSResponsesDetected.yaml) |
| workbook | InfobloxCDCB1TDWorkbook | CommonSecurityLog.DeviceEventClassID in "DHCP-LEASE-CREATE,DHCP-LEASE-DELETE,DHCP-LEASE-UPDATE"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DHCP"  \|  CommonSecurityLog.DeviceEventClassID has_cs "DNS"  \|  CommonSecurityLog.DeviceEventClassID has_cs "RPZ" | [InfobloxCDCB1TDWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20Cloud%20Data%20Connector/Workbooks/InfobloxCDCB1TDWorkbook.json) |

### IronNet IronDefense

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Create Incidents from IronDefense | CommonSecurityLog.DeviceProduct == "IronDefense" | [IronDefense_Detection_Query.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/IronNet%20IronDefense/Analytic%20Rules/IronDefense_Detection_Query.yaml) |
| workbook | IronDefenseAlertDetails | CommonSecurityLog.DeviceProduct == "IronDefense" | [IronDefenseAlertDetails.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/IronNet%20IronDefense/Workbooks/IronDefenseAlertDetails.json) |

### Legacy IOC based Threat Protection

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Connection from external IP to OMI related Ports | AzureDiagnostics.Category == "AzureFirewallNetworkRule" | [NetworkConnectiontoOMIPorts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Legacy%20IOC%20based%20Threat%20Protection/Hunting%20Queries/NetworkConnectiontoOMIPorts.yaml) |
| hunting_query | Known Nylon Typhoon Registry modifications pattern | Event.Source == "Microsoft-Windows-Sysmon"  \|  WindowsEvent.EventID in "12,13,4657" | [NylonTyphoonRegIOCPatterns.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Legacy%20IOC%20based%20Threat%20Protection/Hunting%20Queries/NylonTyphoonRegIOCPatterns.yaml) |
| hunting_query | SolarWinds Inventory | Event.Source == "Microsoft-Windows-Sysmon"  \|  WindowsEvent.EventID in "1,4688" | [SolarWindsInventory.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Legacy%20IOC%20based%20Threat%20Protection/Hunting%20Queries/SolarWindsInventory.yaml) |

### Malware Protection Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Detect Print Processors Registry Driver Key Creati | _ASim_RegistryEvent.EventType in "RegistryKeyCreated,RegistryValueSet" | [PrintProcessersModified.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Analytic%20Rules/PrintProcessersModified.yaml) |
| analytic_rule | Detect Registry Run Key Creation/Modification | _ASim_RegistryEvent.EventType in "RegistryKeyCreated,RegistryValueSet" | [StartupRegistryModified.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Analytic%20Rules/StartupRegistryModified.yaml) |
| analytic_rule | Detect Windows Allow Firewall Rule Addition/Modifi | _ASim_RegistryEvent.EventType in "RegistryKeyCreated,RegistryValueSet" | [WindowsAllowFirewallRuleAdded.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Analytic%20Rules/WindowsAllowFirewallRuleAdded.yaml) |
| analytic_rule | Detect Windows Update Disabled from Registry | _ASim_RegistryEvent.EventType in "RegistryKeyCreated,RegistryValueSet" | [WindowsUpdateDisabled.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Analytic%20Rules/WindowsUpdateDisabled.yaml) |
| analytic_rule | Process Creation with Suspicious CommandLine Argum | _ASim_ProcessEvent.EventType == "ProcessCreated" | [SuspiciousProcessCreation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Analytic%20Rules/SuspiciousProcessCreation.yaml) |
| hunting_query | Detect File Creation in Startup Folder | _ASim_FileEvent.EventType == "FileCreated" | [FileCretaedInStartupFolder.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Hunting%20Queries/FileCretaedInStartupFolder.yaml) |
| hunting_query | Detect Files with Ramsomware Extensions | _ASim_FileEvent.EventType !in "FileDeleted,DeleteFile" | [FilesWithRansomwareExtensions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Hunting%20Queries/FilesWithRansomwareExtensions.yaml) |
| hunting_query | Detect Modification to System Files or Directories | _ASim_FileEvent.EventType in "FileCreated,FileModified" | [SystemFilesModifiedByUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Hunting%20Queries/SystemFilesModifiedByUser.yaml) |
| hunting_query | Detect New Scheduled Task Creation that Run Execut | _ASim_ProcessEvent.EventType == "ProcessCreated" | [NewMaliciousScheduledTask.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Hunting%20Queries/NewMaliciousScheduledTask.yaml) |
| hunting_query | Detect New Scheduled Task Entry Creations | _ASim_FileEvent.EventType in "FileCreated,FileModified" | [NewScheduledTaskCreation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Hunting%20Queries/NewScheduledTaskCreation.yaml) |
| hunting_query | Executable Files Created in Uncommon Locations | _ASim_FileEvent.EventType == "FileCreated" | [ExecutableInUncommonLocation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Hunting%20Queries/ExecutableInUncommonLocation.yaml) |
| workbook | MalwareProtectionEssentialsWorkbook | _ASim_RegistryEvent.EventType in "FileCreated,FileModified,ProcessCreated,RegistryKeyCreated,RegistryValueSet" | [MalwareProtectionEssentialsWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials/Workbooks/MalwareProtectionEssentialsWorkbook.json) |

### MaturityModelForEventLogManagementM2131

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | MaturityModelForEventLogManagement_M2131 | AuditLogs.OperationName in "Add member to role,Add user,ApplicationGatewayFirewall,AzureFirewallIDSLog,Reset user password,Update user"  \|  AuditLogs.OperationName !contains "external"  \|  AuditLogs.OperationName !contains "invite"  \|  AuditLogs.OperationName !contains "licnense"  \|  AuditLogs.OperationName contains "group"  \|  AuditLogs.OperationName contains "member"  \|  AuditLogs.OperationName contains "principal"  \|  AuditLogs.OperationName contains "role"  \|  AuditLogs.OperationName contains "user"  \|  AzureDiagnostics.Category in "AzureFirewallApplicationRule,AzureFirewallNetworkRule,EntitlementManagement,FrontdoorWebApplicationFirewallLog,GatewayDiagnosticLog,GroupManagement,IKEDiagnosticLog,NetworkSecurityGroupEvent,RouteDiagnosticLog,TunnelDiagnosticLog,UserManagement,WebApplicationFirewallLogs,kube-audit"  \|  AzureDiagnostics.Category contains "SQL"  \|  AzureDiagnostics.ResourceProvider in "MICROSOFT.CONTAINERSERVICE,MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,AZUREFIREWALLS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS,PROFILES,PUBLICIPADDRESSES,SERVERS/DATABASES"  \|  EmailEvents.ActionType in "Add member to role,Add user,InteractiveLogon,RemoteInteractiveLogon,Reset user password,ResourceAccess,Sign-in,Update user"  \|  OfficeActivity.OfficeWorkload == "Exchange"  \|  OfficeActivity.RecordType == "ExchangeAdmin"  \|  Syslog.SyslogMessage contains "runas"  \|  Syslog.SyslogMessage contains "sudo" | [MaturityModelForEventLogManagement_M2131.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/MaturityModelForEventLogManagementM2131/Workbooks/MaturityModelForEventLogManagement_M2131.json) |

### Microsoft 365

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Accessed files shared by temporary external user | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams"  \|  OfficeActivity.RecordType == "SharePointFileOperation" | [External User added to Team and immediately uploads file.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/External%20User%20added%20to%20Team%20and%20immediately%20uploads%20file.yaml) |
| analytic_rule | Exchange AuditLog Disabled | OfficeActivity.OfficeWorkload =~ "Exchange" | [exchange_auditlogdisabled.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/exchange_auditlogdisabled.yaml) |
| analytic_rule | Exchange workflow MailItemsAccessed operation anom | OfficeActivity.OfficeWorkload =~ "Exchange" | [MailItemsAccessedTimeSeries.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/MailItemsAccessedTimeSeries.yaml) |
| analytic_rule | External user added and removed in short timeframe | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [ExternalUserAddedRemovedInTeams.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/ExternalUserAddedRemovedInTeams.yaml) |
| analytic_rule | Mail redirect via ExO transport rule | OfficeActivity.OfficeWorkload == "Exchange" | [Mail_redirect_via_ExO_transport_rule.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/Mail_redirect_via_ExO_transport_rule.yaml) |
| analytic_rule | Malicious Inbox Rule | OfficeActivity.OfficeWorkload =~ "Exchange" | [Malicious_Inbox_Rule.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/Malicious_Inbox_Rule.yaml) |
| analytic_rule | Multiple Teams deleted by a single user | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [MultipleTeamsDeletes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/MultipleTeamsDeletes.yaml) |
| analytic_rule | Multiple users email forwarded to same destination | OfficeActivity.OfficeWorkload =~ "Exchange" | [Office_MailForwarding.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/Office_MailForwarding.yaml) |
| analytic_rule | Office Policy Tampering | OfficeActivity.RecordType =~ "ExchangeAdmin" | [office_policytampering.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/office_policytampering.yaml) |
| analytic_rule | Office365 Sharepoint File transfer Folders above t | OfficeActivity.OfficeWorkload has_any "OneDrive,SharePoint" | [sharepoint_file_transfer_folders_above_threshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/sharepoint_file_transfer_folders_above_threshold.yaml) |
| analytic_rule | Office365 Sharepoint File transfer above threshold | OfficeActivity.OfficeWorkload has_any "OneDrive,SharePoint" | [sharepoint_file_transfer_above_threshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Analytic%20Rules/sharepoint_file_transfer_above_threshold.yaml) |
| hunting_query | Bots added to multiple teams | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [MultiTeamBot.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/MultiTeamBot.yaml) |
| hunting_query | Exes with double file extension and access summary | OfficeActivity.RecordType =~ "SharePointFileOperation" | [double_file_ext_exes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/double_file_ext_exes.yaml) |
| hunting_query | External user added and removed in a short timefra | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [ExternalUserAddedRemovedInTeams_HuntVersion.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/ExternalUserAddedRemovedInTeams_HuntVersion.yaml) |
| hunting_query | External user from a new organisation added to Tea | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [ExternalUserFromNewOrgAddedToTeams.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/ExternalUserFromNewOrgAddedToTeams.yaml) |
| hunting_query | Files uploaded to teams and access summary | OfficeActivity.RecordType =~ "SharePointFileOperation" | [TeamsFilesUploaded.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/TeamsFilesUploaded.yaml) |
| hunting_query | Mail redirect via ExO transport rule | OfficeActivity.OfficeWorkload == "Exchange" | [Mail_redirect_via_ExO_transport_rule_hunting.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/Mail_redirect_via_ExO_transport_rule_hunting.yaml) |
| hunting_query | Multiple Teams deleted by a single user | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [MultipleTeamsDeletes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/MultipleTeamsDeletes.yaml) |
| hunting_query | Multiple users email forwarded to same destination | OfficeActivity.OfficeWorkload =~ "Exchange" | [MultipleUsersEmailForwardedToSameDestination.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/MultipleUsersEmailForwardedToSameDestination.yaml) |
| hunting_query | New Admin account activity seen which was not seen | OfficeActivity.RecordType == "ExchangeAdmin" | [new_adminaccountactivity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/new_adminaccountactivity.yaml) |
| hunting_query | Non-owner mailbox login activity | OfficeActivity.OfficeWorkload == "Exchange" | [nonowner_MailboxLogin.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/nonowner_MailboxLogin.yaml) |
| hunting_query | Office Mail Forwarding - Hunting Version | OfficeActivity.OfficeWorkload == "Exchange" | [OfficeMailForwarding_hunting.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/OfficeMailForwarding_hunting.yaml) |
| hunting_query | PowerShell or non-browser mailbox login activity | OfficeActivity.OfficeWorkload == "Exchange" | [powershell_or_nonbrowser_MailboxLogin.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/powershell_or_nonbrowser_MailboxLogin.yaml) |
| hunting_query | Previously unseen bot or application added to Team | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [NewBotAddedToTeams.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/NewBotAddedToTeams.yaml) |
| hunting_query | SharePointFileOperation via clientIP with previous | OfficeActivity.RecordType == "SharePointFileOperation" | [sharepoint_downloads.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/sharepoint_downloads.yaml) |
| hunting_query | SharePointFileOperation via devices with previousl | OfficeActivity.RecordType == "SharePointFileOperation" | [new_sharepoint_downloads_by_UserAgent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/new_sharepoint_downloads_by_UserAgent.yaml) |
| hunting_query | SharePointFileOperation via previously unseen IPs | OfficeActivity.RecordType == "SharePointFileOperation" | [new_sharepoint_downloads_by_IP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/new_sharepoint_downloads_by_IP.yaml) |
| hunting_query | User added to Teams and immediately uploads file | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams"  \|  OfficeActivity.RecordType == "SharePointFileOperation" | [UserAddToTeamsAndUploadsFile.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/UserAddToTeamsAndUploadsFile.yaml) |
| hunting_query | User made Owner of multiple teams | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams" | [MultiTeamOwner.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Hunting%20Queries/MultiTeamOwner.yaml) |
| workbook | ExchangeOnline | OfficeActivity.OfficeWorkload == "Exchange" | [ExchangeOnline.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Workbooks/ExchangeOnline.json) |
| workbook | Office365 | OfficeActivity.OfficeWorkload in "Exchange,OneDrive,SharePoint" | [Office365.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Workbooks/Office365.json) |
| workbook | SharePointAndOneDrive | OfficeActivity.OfficeWorkload in "OneDrive,SharePoint" | [SharePointAndOneDrive.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20365/Workbooks/SharePointAndOneDrive.json) |

### Microsoft Business Applications

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Dataverse - Executable uploaded to SharePoint docu | OfficeActivity.OfficeWorkload == "SharePoint" | [Dataverse - Executable uploaded to SharePoint document management site.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Business%20Applications/Analytic%20Rules/Dataverse%20-%20Executable%20uploaded%20to%20SharePoint%20document%20management%20site.yaml) |
| analytic_rule | Dataverse - Guest user exfiltration following Powe | AuditLogs.OperationName == "Update user" | [Dataverse - Guest user exfiltration following Power Platform defense impairment.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Business%20Applications/Analytic%20Rules/Dataverse%20-%20Guest%20user%20exfiltration%20following%20Power%20Platform%20defense%20impairment.yaml) |
| analytic_rule | Dataverse - Malware found in SharePoint document m | OfficeActivity.OfficeWorkload == "SharePoint" | [Dataverse - Malware found in SharePoint document management site.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Business%20Applications/Analytic%20Rules/Dataverse%20-%20Malware%20found%20in%20SharePoint%20document%20management%20site.yaml) |
| analytic_rule | Dataverse - Mass download from SharePoint document | OfficeActivity.OfficeWorkload == "SharePoint" | [Dataverse - Mass download from SharePoint document management.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Business%20Applications/Analytic%20Rules/Dataverse%20-%20Mass%20download%20from%20SharePoint%20document%20management.yaml) |
| analytic_rule | Dataverse - New non-interactive identity granted a | AuditLogs.OperationName =~ "Update application" | [Dataverse - New non-interactive identity granted access.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Business%20Applications/Analytic%20Rules/Dataverse%20-%20New%20non-interactive%20identity%20granted%20access.yaml) |
| analytic_rule | Power Apps - Bulk sharing of Power Apps to newly c | AuditLogs.OperationName == "Invite external user" | [Power Apps - Bulk sharing of Power Apps to newly created guest users.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Business%20Applications/Analytic%20Rules/Power%20Apps%20-%20Bulk%20sharing%20of%20Power%20Apps%20to%20newly%20created%20guest%20users.yaml) |

### Microsoft Defender XDR

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | C2-NamedPipe | DeviceEvents.ActionType == "NamedPipeEvent" | [Command and Control/C2-NamedPipe.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/Command%20and%20Control/C2-NamedPipe.yaml) |
| analytic_rule | Deimos Component Execution | DeviceEvents.ActionType == "AmsiScriptContent" | [Campaign/Jupyter-Solarmaker/DeimosComponentExecution.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/Campaign/Jupyter-Solarmaker/DeimosComponentExecution.yaml) |
| analytic_rule | Detect Potential Kerberoast Activities | IdentityLogonEvents.ActionType == "LogonSuccess" | [Execution/PotentialKerberoastActivities.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/Execution/PotentialKerberoastActivities.yaml) |
| analytic_rule | Files Copied to USB Drives | DeviceEvents.ActionType in "FileCreated,UsbDriveMounted" | [Exfiltration/FilesCopiedToUSBDrives.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/Exfiltration/FilesCopiedToUSBDrives.yaml) |
| analytic_rule | Local Admin Group Changes | DeviceEvents.ActionType == "UserAccountAddedToLocalGroup"  \|  DeviceEvents.ActionType contains "UserAccountCreated"  \|  DeviceEvents.ActionType contains "UserAccountModified" | [Persistence/LocalAdminGroupChanges.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/Persistence/LocalAdminGroupChanges.yaml) |
| analytic_rule | MosaicLoader | DeviceRegistryEvents.ActionType == "RegistryValueSet" | [Exploits/MosaicLoader.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/Exploits/MosaicLoader.yaml) |
| analytic_rule | Possible Phishing with CSL and Network Sessions | AlertEvidence.ActionType =~ "BrowserLaunchedToOpenUrl" | [PossiblePhishingwithCSL&NetworkSession.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/PossiblePhishingwithCSL%26NetworkSession.yaml) |
| analytic_rule | Potential Build Process Compromise - MDE | DeviceFileEvents.ActionType in "FileCreated,FileModified" | [PotentialBuildProcessCompromiseMDE.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/PotentialBuildProcessCompromiseMDE.yaml) |
| analytic_rule | SUNBURST network beacons | DeviceNetworkEvents.ActionType == "ConnectionSuccess" | [SolarWinds_SUNBURST_Network-IOCs.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/SolarWinds_SUNBURST_Network-IOCs.yaml) |
| analytic_rule | TEARDROP memory-only dropper | DeviceEvents.ActionType has "ExploitGuardNonMicrosoftSignedBlocked" | [SolarWinds_TEARDROP_Process-IOCs.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Analytic%20Rules/SolarWinds_TEARDROP_Process-IOCs.yaml) |
| hunting_query | AIR investigation actions insight | CloudAppEvents.ActionType == "AirInvestigationData" | [Email and Collaboration Queries/Remediation/AIR investigation actions insight.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Remediation/AIR%20investigation%20actions%20insight.yaml) |
| hunting_query | ATP policy status check | CloudAppEvents.ActionType == "Set-AtpPolicyForO365" | [Email and Collaboration Queries/Attachment/ATP policy status check.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Attachment/ATP%20policy%20status%20check.yaml) |
| hunting_query | Admin Submission Trend (FN) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | [Email and Collaboration Queries/Submissions/Admin Submission Trend - FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submission%20Trend%20-%20FN.yaml) |
| hunting_query | Admin Submission Trend (FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | [Email and Collaboration Queries/Submissions/Admin Submission Trend - FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submission%20Trend%20-%20FP.yaml) |
| hunting_query | Admin Submissions by Detection Type | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Admin Submissions by Detection Type.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Detection%20Type.yaml) |
| hunting_query | Admin Submissions by DetectionMethod (Phish FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Admin Submissions by Detection Method - Phish FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Detection%20Method%20-%20Phish%20FP.yaml) |
| hunting_query | Admin Submissions by DetectionMethod (Spam FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Admin Submissions by Detection Method - Spam FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Detection%20Method%20-%20Spam%20FP.yaml) |
| hunting_query | Admin Submissions by Grading verdict (FN-FP) | CloudAppEvents.ActionType contains "AdminSubmissionTriage" | [Email and Collaboration Queries/Submissions/Admin Submissions by Grading Verdict - FN-FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Grading%20Verdict%20-%20FN-FP.yaml) |
| hunting_query | Admin Submissions by Submission State (FN) | CloudAppEvents.ActionType contains "AdminSubmission" | [Email and Collaboration Queries/Submissions/Admin Submissions by Submission State - FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Submission%20State%20-%20FN.yaml) |
| hunting_query | Admin Submissions by Submission State (FP) | CloudAppEvents.ActionType contains "AdminSubmission" | [Email and Collaboration Queries/Submissions/Admin Submissions by Submission State - FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Submission%20State%20-%20FP.yaml) |
| hunting_query | Admin Submissions by Submission Type (FN) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | [Email and Collaboration Queries/Submissions/Admin Submissions by Submission Type - FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Submission%20Type%20-%20FN.yaml) |
| hunting_query | Admin Submissions by Submission Type (FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted"  \|  CloudAppEvents.ActionType contains "Submission" | [Email and Collaboration Queries/Submissions/Admin Submissions by Submission Type - FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Admin%20Submissions%20by%20Submission%20Type%20-%20FP.yaml) |
| hunting_query | Anomalous Payload Delivered from ISO files | DeviceEvents.ActionType == "BrowserLaunchedToOpenUrl" | [Execution/AnomalousPayloadDeliveredWithISOFile.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Execution/AnomalousPayloadDeliveredWithISOFile.yaml) |
| hunting_query | BEC - File sharing tactics - Dropbox | CloudAppEvents.ActionType in "Added users and/or groups to shared file/folder,Invited user to Dropbox and added them to shared file/folder" | [Email and Collaboration Queries/Hunting/BEC - File sharing tactics - Dropbox.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Hunting/BEC%20-%20File%20sharing%20tactics%20-%20Dropbox.yaml) |
| hunting_query | BEC - File sharing tactics - OneDrive or SharePoin | CloudAppEvents.ActionType in "AddedToSecureLink,SecureLinkCreated" | [Email and Collaboration Queries/Hunting/BEC - File sharing tactics - OneDrive or SharePoint.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Hunting/BEC%20-%20File%20sharing%20tactics%20-%20OneDrive%20or%20SharePoint.yaml) |
| hunting_query | C2-NamedPipe | DeviceEvents.ActionType == "NamedPipeEvent" | [Command and Control/C2-NamedPipe.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Command%20and%20Control/C2-NamedPipe.yaml) |
| hunting_query | Calculate overall MDO efficacy | CloudAppEvents.ActionType in "AdminSubmissionSubmitted,Malware ZAP,Phish ZAP,Redelivery" | [Email and Collaboration Queries/General/Calculate MDO Efficacy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/Calculate%20MDO%20Efficacy.yaml) |
| hunting_query | Deimos Component Execution | DeviceEvents.ActionType == "AmsiScriptContent" | [Campaigns/Jupyter-Solarmaker/DeimosComponentExecution.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Campaigns/Jupyter-Solarmaker/DeimosComponentExecution.yaml) |
| hunting_query | Detect Potential kerberoast Activities | IdentityLogonEvents.ActionType == "LogonSuccess" | [Execution/PotentialKerberoastActivities.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Execution/PotentialKerberoastActivities.yaml) |
| hunting_query | File Malware Detection Trend | CloudAppEvents.ActionType == "FileMalwareDetected" | [Email and Collaboration Queries/Malware/File Malware Detection Trend.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Malware/File%20Malware%20Detection%20Trend.yaml) |
| hunting_query | File Malware by Top Malware Families (Anti Virus) | CloudAppEvents.ActionType == "FileMalwareDetected" | [Email and Collaboration Queries/Malware/File Malware Top Families by AV.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Malware/File%20Malware%20Top%20Families%20by%20AV.yaml) |
| hunting_query | File Malware by Top Malware Families (Safe Attachm | CloudAppEvents.ActionType == "FileMalwareDetected" | [Email and Collaboration Queries/Malware/File Malware Top Families by Safe Attachments.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Malware/File%20Malware%20Top%20Families%20by%20Safe%20Attachments.yaml) |
| hunting_query | Files Copied to USB Drives | DeviceEvents.ActionType in "FileCreated,UsbDriveMounted" | [Exfiltration/FilesCopiedToUSBDrives.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Exfiltration/FilesCopiedToUSBDrives.yaml) |
| hunting_query | Group quarantine release | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | [Email and Collaboration Queries/Quarantine/Group quarantine release.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Quarantine/Group%20quarantine%20release.yaml) |
| hunting_query | High Confidence Phish Released | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | [Email and Collaboration Queries/Quarantine/High Confidence Phish Released.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Quarantine/High%20Confidence%20Phish%20Released.yaml) |
| hunting_query | Hunt for Admin email access | CloudAppEvents.ActionType == "AdminMailAccess" | [Email and Collaboration Queries/General/Hunt for Admin email access.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/Hunt%20for%20Admin%20email%20access.yaml) |
| hunting_query | Hunt for TABL changes | CloudAppEvents.ActionType contains "TenantAllowBlockListItems" | [Email and Collaboration Queries/General/Hunt for TABL changes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/Hunt%20for%20TABL%20changes.yaml) |
| hunting_query | Inbox rule changes which forward-redirect email | CloudAppEvents.ActionType contains "Set-InboxRule" | [Email and Collaboration Queries/Hunting/Inbox rule change which forward-redirect email.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Hunting/Inbox%20rule%20change%20which%20forward-redirect%20email.yaml) |
| hunting_query | LemonDuck Registration Function | DeviceEvents.ActionType == "PowerShellCommand" | [Campaigns/LemonDuck/LemonDuckRegistrationFunction.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Campaigns/LemonDuck/LemonDuckRegistrationFunction.yaml) |
| hunting_query | Local Admin Group Changes | DeviceEvents.ActionType == "UserAccountAddedToLocalGroup"  \|  DeviceEvents.ActionType contains "UserAccountCreated"  \|  DeviceEvents.ActionType contains "UserAccountModified" | [Persistence/LocalAdminGroupChanges.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Persistence/LocalAdminGroupChanges.yaml) |
| hunting_query | MDO Threat Protection Detections trend over time | CloudAppEvents.ActionType in "AdminSubmission,Malware ZAP,Phish ZAP,UserSubmission" | [Email and Collaboration Queries/General/Total number of detections by MDO over time.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/Total%20number%20of%20detections%20by%20MDO%20over%20time.yaml) |
| hunting_query | MDO daily detection summary report | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission"  \|  CloudAppEvents.ActionType contains "ZAP" | [Email and Collaboration Queries/General/MDO daily detection summary report.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/MDO%20daily%20detection%20summary%20report.yaml) |
| hunting_query | Malware detections by Workload Locations | CloudAppEvents.ActionType == "FileMalwareDetected" | [Email and Collaboration Queries/Malware/Malware detections by Workload Locations.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Malware/Malware%20detections%20by%20Workload%20Locations.yaml) |
| hunting_query | Malware detections by Workload Type | CloudAppEvents.ActionType == "FileMalwareDetected" | [Email and Collaboration Queries/Malware/Malware detections by Workload Type.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Malware/Malware%20detections%20by%20Workload%20Type.yaml) |
| hunting_query | MosaicLoader | DeviceRegistryEvents.ActionType == "RegistryValueSet" | [Exploits/MosaicLoader.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Exploits/MosaicLoader.yaml) |
| hunting_query | New TABL Items | CloudAppEvents.ActionType == "New-TenantAllowBlockListItems" | [Email and Collaboration Queries/General/New TABL Items.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/New%20TABL%20Items.yaml) |
| hunting_query | Number of unique accounts performing Teams message | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Number of unique accounts performing Teams message Admin submissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Number%20of%20unique%20accounts%20performing%20Teams%20message%20Admin%20submissions.yaml) |
| hunting_query | Number of unique accounts performing Teams message | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Microsoft Teams protection/Number of unique accounts performing Teams message User  submissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Number%20of%20unique%20accounts%20performing%20Teams%20message%20User%20%20submissions.yaml) |
| hunting_query | Possible Teams phishing activity | CloudAppEvents.ActionType == "ChatCreated" | [Email and Collaboration Queries/Microsoft Teams protection/Possible Teams phishing activity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Possible%20Teams%20phishing%20activity.yaml) |
| hunting_query | PrintNightmare CVE-2021-1675 usage Detection | DeviceFileEvents.ActionType == "FileCreated" | [Exploits/PrintNightmareUsageDetection-CVE-2021-1675.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Exploits/PrintNightmareUsageDetection-CVE-2021-1675.yaml) |
| hunting_query | Quarantine Release Email Details | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | [Email and Collaboration Queries/Quarantine/Quarantine Release Email Details.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Quarantine/Quarantine%20Release%20Email%20Details.yaml) |
| hunting_query | Quarantine release trend | CloudAppEvents.ActionType == "QuarantineReleaseMessage" | [Email and Collaboration Queries/Quarantine/Quarantine release trend.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Quarantine/Quarantine%20release%20trend.yaml) |
| hunting_query | SAM Name Change CVE-2021-42278 | IdentityDirectoryEvents.ActionType == "SAM Account Name changed" | [Privilege Escalation/SAMNameChange_CVE-2021-42278.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Privilege%20Escalation/SAMNameChange_CVE-2021-42278.yaml) |
| hunting_query | Scheduled Task Creation | DeviceEvents.ActionType == "ScheduledTaskCreated" | [Persistence/ScheduledTaskCreation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Persistence/ScheduledTaskCreation.yaml) |
| hunting_query | Suspicious DLLs in spool Folder | DeviceFileEvents.ActionType in "FileCreated,FileRenamed" | [Exploits/Print Spooler RCE/SuspiciousDLLInSpoolFolder.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Exploits/Print%20Spooler%20RCE/SuspiciousDLLInSpoolFolder.yaml) |
| hunting_query | Suspicious sign-in attempts from QR code phishing  | CloudAppEvents.ActionType == "MailItemsAccessed" | [Email and Collaboration Queries/QR code/Suspicious sign-in attempts from QR code phishing campaigns.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/QR%20code/Suspicious%20sign-in%20attempts%20from%20QR%20code%20phishing%20campaigns.yaml) |
| hunting_query | Teams Admin submission of Malware and Phish daily  | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Teams Admin submission of Malware and Phish daily trend.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Teams%20Admin%20submission%20of%20Malware%20and%20Phish%20daily%20trend.yaml) |
| hunting_query | Teams Admin submission of No Threats daily trend | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Teams Admin submission of No Threats daily trend.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Teams%20Admin%20submission%20of%20No%20Threats%20daily%20trend.yaml) |
| hunting_query | Teams Admin-User Submissions Grading Verdicts | CloudAppEvents.ActionType in "AdminSubmissionTriage,UserSubmissionTriage" | [Email and Collaboration Queries/Microsoft Teams protection/Teams Admin-User Submissions Grading Verdicts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Teams%20Admin-User%20Submissions%20Grading%20Verdicts.yaml) |
| hunting_query | Teams User submissions daily trend | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Microsoft Teams protection/Teams User submissions daily trend.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Teams%20User%20submissions%20daily%20trend.yaml) |
| hunting_query | Top 10 Detection Overrides - Admin Email Submissio | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Top Detection Overrides - Admin Submissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Top%20Detection%20Overrides%20-%20Admin%20Submissions.yaml) |
| hunting_query | Top 10 sender domains - Admin Teams message submis | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Top 10 sender domains - Admin Teams message submissions FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%2010%20sender%20domains%20-%20Admin%20Teams%20message%20submissions%20FN.yaml) |
| hunting_query | Top 10 sender domains - Admin email submissions (F | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Top Sender Domains - Admin Submissions FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Top%20Sender%20Domains%20-%20Admin%20Submissions%20FN.yaml) |
| hunting_query | Top 10 sender domains - Admin email submissions (F | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Top Sender Domains - Admin Submissions FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Top%20Sender%20Domains%20-%20Admin%20Submissions%20FP.yaml) |
| hunting_query | Top 10 sender domains - Teams user submissions FN  | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Microsoft Teams protection/Top 10 sender domains - Teams user submissions FN or FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%2010%20sender%20domains%20-%20Teams%20user%20submissions%20FN%20or%20FP.yaml) |
| hunting_query | Top 10 senders - Teams users submissions FN or FP | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Microsoft Teams protection/Top 10 senders - Teams users submissions FN or FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%2010%20senders%20-%20Teams%20users%20submissions%20FN%20or%20FP.yaml) |
| hunting_query | Top 10 senders of  Admin Teams message submissions | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Top 10 senders of  Admin Teams message submissions FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%2010%20senders%20of%20%20Admin%20Teams%20message%20submissions%20FN.yaml) |
| hunting_query | Top 10 senders of  Admin Teams message submissions | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Top 10 senders of  Admin Teams message submissions FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%2010%20senders%20of%20%20Admin%20Teams%20message%20submissions%20FP.yaml) |
| hunting_query | Top accounts performing Teams admin submissions FN | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Microsoft Teams protection/Top accounts performing Teams admin submissions FN or FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%20accounts%20performing%20Teams%20admin%20submissions%20FN%20or%20FP.yaml) |
| hunting_query | Top accounts performing Teams user submissions FN  | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Microsoft Teams protection/Top accounts performing Teams user submissions FN or FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Microsoft%20Teams%20protection/Top%20accounts%20performing%20Teams%20user%20submissions%20FN%20or%20FP.yaml) |
| hunting_query | Top accounts performing admin submissions (FN) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Top accounts performing admin submissions - FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Top%20accounts%20performing%20admin%20submissions%20-%20FN.yaml) |
| hunting_query | Top accounts performing admin submissions (FP) | CloudAppEvents.ActionType == "AdminSubmissionSubmitted" | [Email and Collaboration Queries/Submissions/Top accounts performing admin submissions - FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Top%20accounts%20performing%20admin%20submissions%20-%20FP.yaml) |
| hunting_query | Top accounts performing user submissions | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/Top accounts performing user submissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Top%20accounts%20performing%20user%20submissions.yaml) |
| hunting_query | Total Submissions by Submission Type | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission" | [Email and Collaboration Queries/Submissions/Total Submissions by Submission Status.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Total%20Submissions%20by%20Submission%20Status.yaml) |
| hunting_query | Total Submissions by Submission Type | CloudAppEvents.ActionType in "AdminSubmission,UserSubmission" | [Email and Collaboration Queries/Submissions/Total Submissions by Submission Type.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/Total%20Submissions%20by%20Submission%20Type.yaml) |
| hunting_query | Total number of detections by MDO | CloudAppEvents.ActionType in "AdminSubmission,Malware ZAP,Phish ZAP,UserSubmission" | [Email and Collaboration Queries/General/Total number of detections by MDO.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/General/Total%20number%20of%20detections%20by%20MDO.yaml) |
| hunting_query | User Email Submission Trend (FN) | CloudAppEvents.ActionType in "AttackSimUserSubmission,UserSubmission"  \|  CloudAppEvents.ActionType contains "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions Trend - FN.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20Trend%20-%20FN.yaml) |
| hunting_query | User Email Submissions (FN) - Top Detection Overri | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions - Top detection overrides by Admins.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20-%20Top%20detection%20overrides%20by%20Admins.yaml) |
| hunting_query | User Email Submissions (FN) - Top Detection Overri | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions - Top detection overrides by Users.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20-%20Top%20detection%20overrides%20by%20Users.yaml) |
| hunting_query | User Email Submissions (FN) - Top Inbound P2 Sende | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions - Top email (P2) senders.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20-%20Top%20email%20%28P2%29%20senders.yaml) |
| hunting_query | User Email Submissions (FN) - Top Inbound P2 Sende | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions - Top email (P2) senders domains.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20-%20Top%20email%20%28P2%29%20senders%20domains.yaml) |
| hunting_query | User Email Submissions (FN) - Top Intra-Org P2 Sen | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions - Top Intra-Org P2 senders.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20-%20Top%20Intra-Org%20P2%20senders.yaml) |
| hunting_query | User Email Submissions (FN) - Top Intra-Org Subjec | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions - Top Intra-Org Subjects.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20-%20Top%20Intra-Org%20Subjects.yaml) |
| hunting_query | User Email Submissions (FN) by Submission Type | CloudAppEvents.ActionType in "AttackSimUserSubmission,UserSubmission"  \|  CloudAppEvents.ActionType contains "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions by Submission Type.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20by%20Submission%20Type.yaml) |
| hunting_query | User Email Submissions (FN-FP) by Grading verdict | CloudAppEvents.ActionType contains "UserSubmissionTriage" | [Email and Collaboration Queries/Submissions/User Submissions by Grading Verdict - FN-FP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20by%20Grading%20Verdict%20-%20FN-FP.yaml) |
| hunting_query | User Email Submissions accuracy vs Admin review ve | CloudAppEvents.ActionType in "SubmissionNotification,UserSubmission" | [Email and Collaboration Queries/Submissions/User Submission Accuracy versus Admin Verdicts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submission%20Accuracy%20versus%20Admin%20Verdicts.yaml) |
| hunting_query | User Email Submissions by Admin review status (Mar | CloudAppEvents.ActionType in "SubmissionNotification,UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions by Admin review status.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20by%20Admin%20review%20status.yaml) |
| hunting_query | User clicks on malicious inbound emails | EmailEvents.ActionType == "ClickAllowed" | [Email and Collaboration Queries/URL Click/User clicks on malicious inbound emails.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/URL%20Click/User%20clicks%20on%20malicious%20inbound%20emails.yaml) |
| hunting_query | User email submissions (FN) from Junk Folder | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User Submissions from Junk Folder.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20Submissions%20from%20Junk%20Folder.yaml) |
| hunting_query | User reported submissions | CloudAppEvents.ActionType == "UserSubmission" | [Email and Collaboration Queries/Submissions/User reported submissions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Email%20and%20Collaboration%20Queries/Submissions/User%20reported%20submissions.yaml) |
| hunting_query | Windows Print Spooler Service Suspicious File Crea | DeviceFileEvents.ActionType == "FileCreated" | [Exploits/SuspiciousFileCreationByPrintSpoolerService.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Hunting%20Queries/Exploits/SuspiciousFileCreationByPrintSpoolerService.yaml) |
| workbook | MicrosoftDefenderForEndPoint | DeviceEvents.ActionType in "AntivirusDetection,PnpDeviceConnected"  \|  DeviceEvents.ActionType endswith "Audited"  \|  DeviceEvents.ActionType endswith "Blocked"  \|  DeviceEvents.ActionType startswith "Asr"  \|  DeviceInfo.ActionType in "FileCreated,UsbDriveMounted" | [MicrosoftDefenderForEndPoint.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Workbooks/MicrosoftDefenderForEndPoint.json) |
| workbook | MicrosoftDefenderForIdentity | IdentityLogonEvents.ActionType in "LogonFailed,LogonSuccess" | [MicrosoftDefenderForIdentity.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Workbooks/MicrosoftDefenderForIdentity.json) |
| workbook | MicrosoftDefenderForOffice365detectionsandinsights | AlertEvidence.ActionType == "Automated Remediation"  \|  CloudAppEvents.ActionType in "AdminSubmissionSubmitted,AttackSimUserSubmission,FileMalwareDetected,Malware ZAP,Phish ZAP,Redelivery,Spam ZAP,SubmissionNotification,UserSubmission"  \|  CloudAppEvents.ActionType contains "AdminSubmission"  \|  CloudAppEvents.ActionType contains "AdminSubmissionTriage"  \|  CloudAppEvents.ActionType contains "Submission"  \|  CloudAppEvents.ActionType contains "UserSubmission"  \|  CloudAppEvents.ActionType contains "UserSubmissionTriage"  \|  EmailUrlInfo.ActionType in "AdminSubmissionSubmitted,AttackSimUserSubmission,ClickBlocked,Malware ZAP,Phish ZAP,Spam ZAP,UserSubmission"  \|  EmailUrlInfo.ActionType =~ "Automated Remediation"  \|  EmailUrlInfo.ActionType contains "Submission"  \|  EmailUrlInfo.ActionType contains "UserSubmission"  \|  EmailUrlInfo.ActionType contains "ZAP"  \|  EmailUrlInfo.ActionType has "Malware ZAP"  \|  EmailUrlInfo.ActionType has "Phish ZAP"  \|  EmailUrlInfo.ActionType has "Spam ZAP"  \|  EmailUrlInfo.ActionType has "ZAP"  \|  EmailUrlInfo.ActionType has_any "ClickAllowed"  \|  EmailUrlInfo.ActionType has_any "ClickBlocked"  \|  EmailUrlInfo.ActionType has_any "UrlErrorPage"  \|  EmailUrlInfo.ActionType has_any "UrlScanInProgress" | [MicrosoftDefenderForOffice365detectionsandinsights.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Defender%20XDR/Workbooks/MicrosoftDefenderForOffice365detectionsandinsights.json) |

### Microsoft Entra ID

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Account Created and Deleted in Short Timeframe | AuditLogs.OperationName in~ "Add user,Delete user" | [AccountCreatedandDeletedinShortTimeframe.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/AccountCreatedandDeletedinShortTimeframe.yaml) |
| analytic_rule | Account created or deleted by non-approved user | AuditLogs.OperationName in~ "Add user,Delete user" | [AccountCreatedDeletedByNonApprovedUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/AccountCreatedDeletedByNonApprovedUser.yaml) |
| analytic_rule | Admin promotion after Role Management Application  | AuditLogs.OperationName =~ "Add app role assignment to service principal" | [AdminPromoAfterRoleMgmtAppPermissionGrant.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/AdminPromoAfterRoleMgmtAppPermissionGrant.yaml) |
| analytic_rule | Conditional Access - A Conditional Access Device p | AuditLogs.OperationName == "Update conditional access policy" | [Conditional Access - A Conditional Access Device platforms condition has changed (the Device platforms condition can be spoofed).yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20Device%20platforms%20condition%20has%20changed%20%28the%20Device%20platforms%20condition%20can%20be%20spoofed%29.yaml) |
| analytic_rule | Conditional Access - A Conditional Access app excl | AuditLogs.OperationName == "Update conditional access policy" | [Conditional Access - A Conditional Access app exclusion has changed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20app%20exclusion%20has%20changed.yaml) |
| analytic_rule | Conditional Access - A Conditional Access policy w | AuditLogs.OperationName == "Delete conditional access policy" | [Conditional Access - A Conditional Access policy was deleted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20policy%20was%20deleted.yaml) |
| analytic_rule | Conditional Access - A Conditional Access policy w | AuditLogs.OperationName == "Update conditional access policy" | [Conditional Access - A Conditional Access policy was disabled.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20policy%20was%20disabled.yaml) |
| analytic_rule | Conditional Access - A Conditional Access policy w | AuditLogs.OperationName == "Update conditional access policy" | [Conditional Access - A Conditional Access policy was put into report-only mode.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20policy%20was%20put%20into%20report-only%20mode.yaml) |
| analytic_rule | Conditional Access - A Conditional Access policy w | AuditLogs.OperationName == "Update conditional access policy" | [Conditional Access - A Conditional Access policy was updated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20policy%20was%20updated.yaml) |
| analytic_rule | Conditional Access - A Conditional Access user/gro | AuditLogs.OperationName == "Update conditional access policy" | [Conditional Access - A Conditional Access usergrouprole exclusion has changed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20Conditional%20Access%20usergrouprole%20exclusion%20has%20changed.yaml) |
| analytic_rule | Conditional Access - A new Conditional Access poli | AuditLogs.OperationName == "Add conditional access policy" | [Conditional Access - A new Conditional Access policy was created.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20A%20new%20Conditional%20Access%20policy%20was%20created.yaml) |
| analytic_rule | Conditional Access - Dynamic Group Exclusion Chang | AuditLogs.OperationName == "Update group" | [Conditional Access - Dynamic Group Exclusion Changes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Conditional%20Access%20-%20Dynamic%20Group%20Exclusion%20Changes.yaml) |
| analytic_rule | Credential added after admin consented to Applicat | AuditLogs.OperationName in~ "Add service principal credentials,Consent to application" | [CredentialAddedAfterAdminConsent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/CredentialAddedAfterAdminConsent.yaml) |
| analytic_rule | Cross-tenant Access Settings Organization Added | AuditLogs.OperationName has "Add a partner to cross-tenant access setting" | [Cross-tenantAccessSettingsOrganizationAdded.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Cross-tenantAccessSettingsOrganizationAdded.yaml) |
| analytic_rule | Cross-tenant Access Settings Organization Deleted | AuditLogs.OperationName has "Delete partner specific cross-tenant access setting" | [Cross-tenantAccessSettingsOrganizationDeleted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Cross-tenantAccessSettingsOrganizationDeleted.yaml) |
| analytic_rule | Cross-tenant Access Settings Organization Inbound  | AuditLogs.OperationName has "Update a partner cross-tenant access setting" | [Cross-tenantAccessSettingsOrganizationInboundCollaborationSettingsChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Cross-tenantAccessSettingsOrganizationInboundCollaborationSettingsChanged.yaml) |
| analytic_rule | Cross-tenant Access Settings Organization Inbound  | AuditLogs.OperationName has "Update a partner cross-tenant access setting" | [Cross-tenantAccessSettingsOrganizationInboundDirectSettingsChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Cross-tenantAccessSettingsOrganizationInboundDirectSettingsChanged.yaml) |
| analytic_rule | Cross-tenant Access Settings Organization Outbound | AuditLogs.OperationName has "Update a partner cross-tenant access setting" | [Cross-tenantAccessSettingsOrganizationOutboundCollaborationSettingsChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Cross-tenantAccessSettingsOrganizationOutboundCollaborationSettingsChanged.yaml) |
| analytic_rule | Cross-tenant Access Settings Organization Outbound | AuditLogs.OperationName has "Update a partner cross-tenant access setting" | [Cross-tenantAccessSettingsOrganizationOutboundDirectSettingsChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/Cross-tenantAccessSettingsOrganizationOutboundDirectSettingsChanged.yaml) |
| analytic_rule | External guest invitation followed by Microsoft En | AuditLogs.OperationName == "Invite external user" | [UnusualGuestActivity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/UnusualGuestActivity.yaml) |
| analytic_rule | First access credential added to Application or Se | AuditLogs.OperationName has "Certificates and secrets management" | [FirstAppOrServicePrincipalCredential.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/FirstAppOrServicePrincipalCredential.yaml) |
| analytic_rule | Guest accounts added in Entra ID Groups other than | AuditLogs.OperationName in "Add member to group,Add owner to group" | [GuestAccountsAddedinAADGroupsOtherThanTheOnesSpecified.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/GuestAccountsAddedinAADGroupsOtherThanTheOnesSpecified.yaml) |
| analytic_rule | Microsoft Entra ID Role Management Permission Gran | AuditLogs.OperationName in~ "Add app role assignment to service principal,Add delegated permission grant" | [AzureADRoleManagementPermissionGrant.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/AzureADRoleManagementPermissionGrant.yaml) |
| analytic_rule | Modified domain federation trust settings | AuditLogs.OperationName in~ "Set domain authentication,Set federation settings on domain" | [ADFSDomainTrustMods.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/ADFSDomainTrustMods.yaml) |
| analytic_rule | NRT First access credential added to Application o | AuditLogs.OperationName has_any "Add service principal,Certificates and secrets management" | [nrt_FirstAppOrServicePrincipalCredential.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/nrt_FirstAppOrServicePrincipalCredential.yaml) |
| analytic_rule | NRT Modified domain federation trust settings | AuditLogs.OperationName in~ "Set domain authentication,Set federation settings on domain" | [NRT_ADFSDomainTrustMods.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/NRT_ADFSDomainTrustMods.yaml) |
| analytic_rule | NRT New access credential added to Application or  | AuditLogs.OperationName has_any "Add service principal,Certificates and secrets management" | [NRT_NewAppOrServicePrincipalCredential.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/NRT_NewAppOrServicePrincipalCredential.yaml) |
| analytic_rule | NRT Privileged Role Assigned Outside PIM | AuditLogs.OperationName =~ "Add member to role"  \|  AuditLogs.OperationName has "Add member to role outside of PIM" | [NRT_PrivlegedRoleAssignedOutsidePIM.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/NRT_PrivlegedRoleAssignedOutsidePIM.yaml) |
| analytic_rule | New access credential added to Application or Serv | AuditLogs.OperationName has_any "Add service principal,Certificates and secrets management" | [NewAppOrServicePrincipalCredential.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/NewAppOrServicePrincipalCredential.yaml) |
| analytic_rule | New onmicrosoft domain added to tenant | AuditLogs.OperationName in "Add unverified domain,Add verified domain" | [NewOnmicrosoftDomainAdded.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/NewOnmicrosoftDomainAdded.yaml) |
| analytic_rule | Possible SignIn from Azure Backdoor | AuditLogs.OperationName == "Add unverified domain" | [PossibleSignInfromAzureBackdoor.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/PossibleSignInfromAzureBackdoor.yaml) |
| analytic_rule | Privileged Role Assigned Outside PIM | AuditLogs.OperationName =~ "Add member to role"  \|  AuditLogs.OperationName has "Add member to role outside of PIM" | [PrivlegedRoleAssignedOutsidePIM.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/PrivlegedRoleAssignedOutsidePIM.yaml) |
| analytic_rule | Rare application consent | AuditLogs.OperationName has "Consent to application" | [RareApplicationConsent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/RareApplicationConsent.yaml) |
| analytic_rule | Suspicious Entra ID Joined Device Update | AuditLogs.OperationName =~ "Update device" | [SuspiciousAADJoinedDeviceUpdate.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/SuspiciousAADJoinedDeviceUpdate.yaml) |
| analytic_rule | Suspicious Service Principal creation activity | AuditLogs.OperationName == "Remove service principal"  \|  AuditLogs.OperationName has_all "Update application" | [SuspiciousServicePrincipalcreationactivity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/SuspiciousServicePrincipalcreationactivity.yaml) |
| analytic_rule | Suspicious application consent for offline access | AuditLogs.OperationName in~ "Add OAuth2PermissionGrant,Add delegated permission grant,Add service principal,Consent to application" | [SuspiciousOAuthApp_OfflineAccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/SuspiciousOAuthApp_OfflineAccess.yaml) |
| analytic_rule | Suspicious application consent similar to O365 Att | AuditLogs.OperationName in~ "Add OAuth2PermissionGrant,Add delegated permission grant,Add service principal,Consent to application" | [MaliciousOAuthApp_O365AttackToolkit.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/MaliciousOAuthApp_O365AttackToolkit.yaml) |
| analytic_rule | Suspicious application consent similar to PwnAuth | AuditLogs.OperationName in~ "Add OAuth2PermissionGrant,Add delegated permission grant,Add service principal,Consent to application" | [MaliciousOAuthApp_PwnAuth.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/MaliciousOAuthApp_PwnAuth.yaml) |
| analytic_rule | full_access_as_app Granted To Application | AuditLogs.OperationName =~ "Consent to application" | [ExchangeFullAccessGrantedToApp.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/ExchangeFullAccessGrantedToApp.yaml) |
| workbook | ConditionalAccessSISM | AuditLogs.OperationName in "Add conditional access policy,Add member to group,Add member to restricted management administrative unit,Delete conditional access policy,Remove member from group,Remove member from restricted management administrative unit,Update conditional access policy,Update group" | [ConditionalAccessSISM.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Workbooks/ConditionalAccessSISM.json) |

### Microsoft Exchange Security - Exchange On-Premises

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | Microsoft Exchange Admin Activity | SecurityEvent.EventID in "4624,4720,4722,4724,4725,4726,7036" | [Microsoft Exchange Admin Activity.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Exchange%20Security%20-%20Exchange%20On-Premises/Workbooks/Microsoft%20Exchange%20Admin%20Activity.json) |

### MicrosoftPurviewInsiderRiskManagement

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Insider Risk_Possible Sabotage | AzureActivity.OperationName contains "delete"  \|  AzureActivity.OperationName contains "remove" | [InsiderPossibleSabotage.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/MicrosoftPurviewInsiderRiskManagement/Hunting%20Queries/InsiderPossibleSabotage.yaml) |
| workbook | InsiderRiskManagement | AuditLogs.OperationName in "Add member to role,Add user,Consent to application,Create Deployment,Create or Update Virtual Machine,Create role assignment,List Storage Account Keys,Reset user password,Update user"  \|  AuditLogs.OperationName in~ "Set domain authentication,Set federation settings on domain,Sign-in activity"  \|  AuditLogs.OperationName != "Consent to application"  \|  AuditLogs.OperationName contains "Create"  \|  AuditLogs.OperationName contains "Delete"  \|  AuditLogs.OperationName contains "Update"  \|  AuditLogs.OperationName contains "delet"  \|  AuditLogs.OperationName contains "delete"  \|  AuditLogs.OperationName contains "remove"  \|  AuditLogs.OperationName has "Create"  \|  AuditLogs.OperationName has_any "Create,Update"  \|  AuditLogs.OperationName has_any "Ip,Security Rule"  \|  EmailEvents.ActionType in "Add member to role,Add user,InteractiveLogon,RemoteInteractiveLogon,Reset user password,ResourceAccess,Sign-in,Update user"  \|  OfficeActivity.OfficeWorkload == "Exchange"  \|  OfficeActivity.OfficeWorkload in~ "AzureActiveDirectory,MicrosoftTeams"  \|  OfficeActivity.OfficeWorkload has_any "Exchange,OneDrive"  \|  OfficeActivity.RecordType in~ "ExchangeAdmin,SharePointFileOperation"  \|  SecurityEvent.EventID in "4723,4724"  \|  Syslog.Facility in "auth,authpriv" | [InsiderRiskManagement.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/MicrosoftPurviewInsiderRiskManagement/Workbooks/InsiderRiskManagement.json) |

### Multi Cloud Attack Coverage Essentials - Resource Abuse

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Cross-Cloud Password Spray detection | AWSCloudTrail.EventName == "ConsoleLogin" | [BrutforceAttemptOnAzurePortalAndAWSConsolAtSameTime.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Multi%20Cloud%20Attack%20Coverage%20Essentials%20-%20Resource%20Abuse/Analytic%20Rules/BrutforceAttemptOnAzurePortalAndAWSConsolAtSameTime.yaml) |
| analytic_rule | High-Risk Cross-Cloud User Impersonation | AWSCloudTrail.EventName in~ "AddUserToGroup,ChangePassword,CreateAccessKey,CreateGroup,CreateMailUser,CreateOrganization,CreateRole,CreateServiceSpecificCredential,CreateUser,CreateVirtualMFADevice,DeleteAccessKey,DeleteGroup,DeleteGroupPolicy,DeleteLoginProfile,DeleteRole,DeleteServiceSpecificCredential,DeleteUser,DisableMailUsers,EnableMailUsers,RegisterToWorkMail,RemoveUserFromGroup,ResetPassword,SetDefaultMailDomain,SetMailUserDetails,UpdateAccountEmailAddress,UploadServerCertificate" | [UserImpersonateByRiskyUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Multi%20Cloud%20Attack%20Coverage%20Essentials%20-%20Resource%20Abuse/Analytic%20Rules/UserImpersonateByRiskyUser.yaml) |
| analytic_rule | Successful AWS Console Login from IP Address Obser | AWSCloudTrail.EventName == "ConsoleLogin" | [SuccessfulAWSConsoleLoginfromIPAddressObservedConductingPasswordSpray.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Multi%20Cloud%20Attack%20Coverage%20Essentials%20-%20Resource%20Abuse/Analytic%20Rules/SuccessfulAWSConsoleLoginfromIPAddressObservedConductingPasswordSpray.yaml) |
| analytic_rule | Suspicious AWS console logins by credential access | AWSCloudTrail.EventName == "ConsoleLogin" | [SuspiciousAWSConsolLoginByCredentialAceessAlerts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Multi%20Cloud%20Attack%20Coverage%20Essentials%20-%20Resource%20Abuse/Analytic%20Rules/SuspiciousAWSConsolLoginByCredentialAceessAlerts.yaml) |
| analytic_rule | User impersonation by Identity Protection alerts | AWSCloudTrail.EventName in~ "AddUserToGroup,ChangePassword,CreateAccessKey,CreateGroup,CreateRole,CreateUser,CreateVirtualMFADevice,DeleteAccessKey,DeleteGroup,DeleteLoginProfile,DeleteRole,DeleteUser,RemoveUserFromGroup" | [UserImpersonateByAAID.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Multi%20Cloud%20Attack%20Coverage%20Essentials%20-%20Resource%20Abuse/Analytic%20Rules/UserImpersonateByAAID.yaml) |

### NISTSP80053

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | NISTSP80053 | AuditLogs.OperationName contains "Delete"  \|  AuditLogs.OperationName contains "PIM"  \|  AuditLogs.OperationName contains "Remove"  \|  AzureDiagnostics.Category in "NetworkSecurityGroupEvent,kube-audit"  \|  AzureDiagnostics.Category contains "SQL"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,AZUREFIREWALLS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS,PROFILES,PUBLICIPADDRESSES" | [NISTSP80053.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/NISTSP80053/Workbooks/NISTSP80053.json) |

### Nasuni

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Ransomware Attack Detected | Syslog.SyslogMessage has "The Filer has detected a new ransomware attack" | [RansomwareAttackDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Nasuni/Analytic%20Rules/RansomwareAttackDetected.yaml) |
| analytic_rule | Ransomware Client Blocked | Syslog.SyslogMessage has "The Filer has enforced the mitigation policy on volume" | [RansomwareClientBlocked.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Nasuni/Analytic%20Rules/RansomwareClientBlocked.yaml) |
| hunting_query | Nasuni File Delete Activity | Syslog.SyslogMessage matchesregex "(nasuni.)([0-9A-Za-z]{8}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{1})" | [FileDeleteEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Nasuni/Hunting%20Queries/FileDeleteEvents.yaml) |

### Network Threat Protection Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Network endpoint to host executable correlation | CommonSecurityLog.DeviceVendor =~ "Trend Micro" | [NetworkEndpointCorrelation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Network%20Threat%20Protection%20Essentials/Analytic%20Rules/NetworkEndpointCorrelation.yaml) |

### Onapsis Platform

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | OnapsisAlarmsOverview | CommonSecurityLog.DeviceVendor == "Onapsis" | [OnapsisAlarmsOverview.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Onapsis%20Platform/Workbooks/OnapsisAlarmsOverview.json) |

### OneIdentity

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | OneIdentity | CommonSecurityLog.DeviceProduct == "SPS"  \|  CommonSecurityLog.DeviceVendor == "OneIdentity" | [OneIdentity.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/OneIdentity/Workbooks/OneIdentity.json) |

### Palo Alto - XDR (Cortex)

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | PaloAltoXDR | CommonSecurityLog.DeviceProduct == "Cortex XDR"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [PaloAltoXDR.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Palo%20Alto%20-%20XDR%20%28Cortex%29/Workbooks/PaloAltoXDR.json) |

### PaloAlto-PAN-OS

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Palo Alto - potential beaconing detected | CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [PaloAlto-NetworkBeaconing.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Analytic%20Rules/PaloAlto-NetworkBeaconing.yaml) |
| analytic_rule | Palo Alto Threat signatures from Unusual IP addres | CommonSecurityLog.DeviceEventClassID in "file,flood,packet,scan,spyware,virus,vulnerability,wildfire,wildfire-virus"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [PaloAlto-UnusualThreatSignatures.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Analytic%20Rules/PaloAlto-UnusualThreatSignatures.yaml) |
| hunting_query | Palo Alto - high-risk ports | CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [PaloAlto-HighRiskPorts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Hunting%20Queries/PaloAlto-HighRiskPorts.yaml) |
| hunting_query | Palo Alto - potential beaconing detected | CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Palo Alto - potential beaconing detected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Hunting%20Queries/Palo%20Alto%20-%20potential%20beaconing%20detected.yaml) |
| workbook | PaloAltoNetworkThreat | CommonSecurityLog.DeviceEventClassID in~ "correlation,vulnerability,wildfire"  \|  CommonSecurityLog.DeviceEventClassID != "file"  \|  CommonSecurityLog.DeviceEventClassID != "url"  \|  CommonSecurityLog.DeviceProduct has "PAN-OS"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [PaloAltoNetworkThreat.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Workbooks/PaloAltoNetworkThreat.json) |
| workbook | PaloAltoOverview | CommonSecurityLog.DeviceEventClassID in~ "end,file,url,wildfire"  \|  CommonSecurityLog.DeviceProduct has "LF"  \|  CommonSecurityLog.DeviceProduct has "PAN-OS"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [PaloAltoOverview.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PaloAlto-PAN-OS/Workbooks/PaloAltoOverview.json) |

### PingFederate

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | PingFederate | CommonSecurityLog.DeviceProduct =~ "PingFederate" | [PingFederate.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/PingFederate/Workbooks/PingFederate.json) |

### Pure Storage

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | External Fabric Module XFM1 is unhealthy | Syslog.SyslogMessage has "purity.alert" | [FB-FabricModuleUnhealthy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Pure%20Storage/Analytic%20Rules/FB-FabricModuleUnhealthy.yaml) |
| analytic_rule | Pure Controller Failed | Syslog.SyslogMessage has "purity.alert" | [PureControllerFailed.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Pure%20Storage/Analytic%20Rules/PureControllerFailed.yaml) |
| analytic_rule | Pure Failed Login | Syslog.SyslogMessage has "invalid username or password"  \|  Syslog.SyslogMessage has "purity.alert" | [PureFailedLogin.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Pure%20Storage/Analytic%20Rules/PureFailedLogin.yaml) |

### Radiflow

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Radiflow - Exploit Detected | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowExploitDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowExploitDetected.yaml) |
| analytic_rule | Radiflow - Network Scanning Detected | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowNetworkScanningDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowNetworkScanningDetected.yaml) |
| analytic_rule | Radiflow - New Activity Detected | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowNewActivityDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowNewActivityDetected.yaml) |
| analytic_rule | Radiflow - Platform Alert | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowPlatformAlert.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowPlatformAlert.yaml) |
| analytic_rule | Radiflow - Policy Violation Detected | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowPolicyViolationDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowPolicyViolationDetected.yaml) |
| analytic_rule | Radiflow - Suspicious Malicious Activity Detected | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowSuspiciousMaliciousActivityDetected.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowSuspiciousMaliciousActivityDetected.yaml) |
| analytic_rule | Radiflow - Unauthorized Command in Operational Dev | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowUnauthorizedCommandinOperationalDevice.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowUnauthorizedCommandinOperationalDevice.yaml) |
| analytic_rule | Radiflow - Unauthorized Internet Access | CommonSecurityLog.DeviceProduct =~ "iSID" | [RadiflowUnauthorizedInternetAccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Radiflow/Analytic%20Rules/RadiflowUnauthorizedInternetAccess.yaml) |

### RidgeSecurity

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Critical Risks | CommonSecurityLog.DeviceEventClassID == "4001"  \|  CommonSecurityLog.DeviceVendor == "RidgeSecurity" | [RidgeSecurity_Risks.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/RidgeSecurity/Analytic%20Rules/RidgeSecurity_Risks.yaml) |
| analytic_rule | Vulerabilities | CommonSecurityLog.DeviceEventClassID startswith "40"  \|  CommonSecurityLog.DeviceVendor == "RidgeSecurity" | [RidgeSecurity_Vulnerabilities.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/RidgeSecurity/Analytic%20Rules/RidgeSecurity_Vulnerabilities.yaml) |

### SOC Handbook

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | AttackSurfaceReduction | DeviceEvents.ActionType startswith "Asr" | [AttackSurfaceReduction.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SOC%20Handbook/Workbooks/AttackSurfaceReduction.json) |
| workbook | InvestigationInsights | AuditLogs.OperationName == "Consent to application"  \|  AuditLogs.OperationName =~ "Disable Strong Authentication"  \|  AuditLogs.OperationName contains "password"  \|  SecurityEvent.EventID in "1102,4624,4625,4688,4719,4720,4723,4724,4768,4771,4776" | [InvestigationInsights.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SOC%20Handbook/Workbooks/InvestigationInsights.json) |

### SOX IT Compliance

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | SOXITCompliance | CommonSecurityLog.DeviceVendor has_any "CrowdStrike,Microsoft,Qualys,Tripwire"  \|  IdentityDirectoryEvents.ActionType in "DirectoryRoleMembershipChanged,GroupMembershipChanged,PrivilegeEscalation,SensitiveAccountChanged,UserAccountControlChanged"  \|  OfficeActivity.OperationName has_any "Add directory role member,Add member to role,Add user,Create user,Role assignment,Update user"  \|  OfficeActivity.OperationName has_any "directory write,policy update,role assignment,role update"  \|  SecurityEvent.EventID in "1100,1102,1104,1240,1241,1242,4656,4657,4660,4663,4670,4688,4719,4720,4726,4732,4739,4754,4907"  \|  Syslog.SyslogMessage has_any "ALTER TABLE,CREATE TABLE,DROP TABLE,database modified,schema change"  \|  Syslog.SyslogMessage has_any "auditd stopped,logging stopped,rsyslog stopped,syslog stopped"  \|  Syslog.SyslogMessage has_any "change,config,edit,modified,updated"  \|  Syslog.SyslogMessage has_any "change,config,modified,registry,updated"  \|  Syslog.SyslogMessage has_any "checksum mismatch,file deleted,file modified,file tamper" | [SOXITCompliance.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SOX%20IT%20Compliance/Workbooks/SOXITCompliance.json) |

### SecurityThreatEssentialSolution

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Threat Essentials - Mail redirect via ExO transpor | OfficeActivity.OfficeWorkload == "Exchange" | [Threat_Essentials_Mail_redirect_via_ExO_transport_rule.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SecurityThreatEssentialSolution/Analytic%20Rules/Threat_Essentials_Mail_redirect_via_ExO_transport_rule.yaml) |

### Semperis Directory Services Protector

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Semperis DSP Failed Logons | SecurityEvent.EventID == "20002" | [Semperis_DSP_Failed_Logons.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Analytic%20Rules/Semperis_DSP_Failed_Logons.yaml) |
| analytic_rule | Semperis DSP Operations Critical Notifications | SecurityEvent.EventID == "30001" | [Semperis_DSP_Operations_Critical_Notifications_.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Analytic%20Rules/Semperis_DSP_Operations_Critical_Notifications_.yaml) |
| analytic_rule | Semperis DSP RBAC Changes | SecurityEvent.EventID == "20012" | [Semperis_DSP_RBAC_Changes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Analytic%20Rules/Semperis_DSP_RBAC_Changes.yaml) |
| workbook | SemperisDSPADChanges | CommonSecurityLog.DeviceEventClassID == "Semperis.DSP.AdChanges" | [SemperisDSPADChanges.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Workbooks/SemperisDSPADChanges.json) |
| workbook | SemperisDSPNotifications | CommonSecurityLog.DeviceProduct == "Core Directory" | [SemperisDSPNotifications.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Workbooks/SemperisDSPNotifications.json) |
| workbook | SemperisDSPQuickviewDashboard | CommonSecurityLog.DeviceProduct == "Core Directory"  \|  SecurityEvent.EventID in "20000,20002,20012,9208,9211,9212" | [SemperisDSPQuickviewDashboard.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Semperis%20Directory%20Services%20Protector/Workbooks/SemperisDSPQuickviewDashboard.json) |

### SentinelSOARessentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | AutomationHealth | AzureDiagnostics.ResourceProvider == "MICROSOFT.LOGIC" | [AutomationHealth.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SentinelSOARessentials/Workbooks/AutomationHealth.json) |

### Silverfort

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Silverfort - Certifried Incident | CommonSecurityLog.DeviceEventClassID == "NewIncident"  \|  CommonSecurityLog.DeviceProduct has "Admin Console"  \|  CommonSecurityLog.DeviceVendor has "Silverfort" | [Certifried.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Silverfort/Analytic%20Rules/Certifried.yaml) |
| analytic_rule | Silverfort - Log4Shell Incident | CommonSecurityLog.DeviceEventClassID == "NewIncident"  \|  CommonSecurityLog.DeviceProduct has "Admin Console"  \|  CommonSecurityLog.DeviceVendor has "Silverfort" | [Log4Shell.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Silverfort/Analytic%20Rules/Log4Shell.yaml) |
| analytic_rule | Silverfort - NoPacBreach Incident | CommonSecurityLog.DeviceEventClassID == "NewIncident"  \|  CommonSecurityLog.DeviceProduct has "Admin Console"  \|  CommonSecurityLog.DeviceVendor has "Silverfort" | [NoPac_Breach.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Silverfort/Analytic%20Rules/NoPac_Breach.yaml) |
| analytic_rule | Silverfort - UserBruteForce Incident | CommonSecurityLog.DeviceEventClassID == "NewIncident"  \|  CommonSecurityLog.DeviceProduct has "Admin Console"  \|  CommonSecurityLog.DeviceVendor has "Silverfort" | [User_Brute_Force.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Silverfort/Analytic%20Rules/User_Brute_Force.yaml) |
| workbook | SilverfortWorkbook | CommonSecurityLog.DeviceProduct has "Admin Console"  \|  CommonSecurityLog.DeviceVendor has "Silverfort" | [SilverfortWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Silverfort/Workbooks/SilverfortWorkbook.json) |

### SonicWall Firewall

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | SonicWallFirewall | CommonSecurityLog.DeviceVendor == "SonicWall" | [SonicWallFirewall.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SonicWall%20Firewall/Workbooks/SonicWallFirewall.json) |

### Standalone Content

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | AD FS Abnormal EKU object identifier attribute | SecurityEvent.EventID == "501" | [SecurityEvent/ADFSAbnormalEnhancedKeyUsageAttribute-OID.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/ADFSAbnormalEnhancedKeyUsageAttribute-OID.yaml) |
| analytic_rule | AD account with Don't Expire Password | WindowsEvent.EventID == "4738" | [SecurityEvent/password_never_expires.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/password_never_expires.yaml) |
| analytic_rule | Account created from non-approved sources | AuditLogs.OperationName =~ "Add User" | [MultipleDataSources/Accountcreatedfromnon-approvedsources.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/Accountcreatedfromnon-approvedsources.yaml) |
| analytic_rule | Addition of a Temporary Access Pass to a Privilege | AuditLogs.OperationName =~ "Admin registered security info" | [AuditLogs/AdditionofaTemporaryAccessPasstoaPrivilegedAccount.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/AdditionofaTemporaryAccessPasstoaPrivilegedAccount.yaml) |
| analytic_rule | AdminSDHolder Modifications | SecurityEvent.EventID == "5136" | [SecurityEvent/AdminSDHolder_Modifications.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/AdminSDHolder_Modifications.yaml) |
| analytic_rule | Application Gateway WAF - SQLi Detection | AzureDiagnostics.Category == "ApplicationGatewayFirewallLog" | [AzureWAF/AppGwWAF-SQLiDetection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AzureWAF/AppGwWAF-SQLiDetection.yaml) |
| analytic_rule | Application Gateway WAF - XSS Detection | AzureDiagnostics.Category == "ApplicationGatewayFirewallLog" | [AzureWAF/AppGwWAF-XSSDetection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AzureWAF/AppGwWAF-XSSDetection.yaml) |
| analytic_rule | Application ID URI Changed | AuditLogs.OperationName has_any "Update Application,Update Service principal" | [AuditLogs/ApplicationIDURIChanged.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ApplicationIDURIChanged.yaml) |
| analytic_rule | Application Redirect URL Update | AuditLogs.OperationName =~ "Update Application" | [AuditLogs/ApplicationRedirectURLUpdate.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ApplicationRedirectURLUpdate.yaml) |
| analytic_rule | Audit policy manipulation using auditpol utility | Event.Source == "Microsoft-Windows-Sysmon"  \|  SecurityEvent.EventID == "1" | [MultipleDataSources/AuditPolicyManipulation_using_auditpol.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/AuditPolicyManipulation_using_auditpol.yaml) |
| analytic_rule | COM Event System Loading New DLL | Event.EventID in "1,7"  \|  Event.Source =~ "Microsoft-Windows-Sysmon" | [SecurityEvent/COMEventSystemLoadingNewDLL.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/COMEventSystemLoadingNewDLL.yaml) |
| analytic_rule | COM Registry Key Modified to Point to File in Colo | DeviceRegistryEvents.ActionType =~ "RegistryValueSet"  \|  SecurityEvent.EventID == "4657" | [MultipleDataSources/COMRegistryKeyModifiedtoPointtoFileinColorDrivers.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/COMRegistryKeyModifiedtoPointtoFileinColorDrivers.yaml) |
| analytic_rule | Changes to Application Logout URL | AuditLogs.OperationName has_any "Update Application,Update Service principal" | [AuditLogs/ChangestoApplicationLogoutURL.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ChangestoApplicationLogoutURL.yaml) |
| analytic_rule | Changes to Application Ownership | AuditLogs.OperationName =~ "Add owner to application" | [AuditLogs/ChangestoApplicationOwnership.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ChangestoApplicationOwnership.yaml) |
| analytic_rule | Changes to PIM Settings | AuditLogs.OperationName =~ "Update role setting in PIM" | [AuditLogs/ChangestoPIMSettings.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ChangestoPIMSettings.yaml) |
| analytic_rule | Cisco - firewall block but success logon to Micros | CommonSecurityLog.DeviceVendor =~ "Cisco" | [MultipleDataSources/SigninFirewallCorrelation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/SigninFirewallCorrelation.yaml) |
| analytic_rule | Conditional Access Policy Modified by New User | AuditLogs.OperationName has "conditional access policy" | [AuditLogs/ConditionalAccessPolicyModifiedbyNewUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ConditionalAccessPolicyModifiedbyNewUser.yaml) |
| analytic_rule | DSRM Account Abuse | Event.EventID == "13"  \|  Event.EventLog == "Microsoft-Windows-Sysmon/Operational" | [SecurityEvent/DSRMAccountAbuse.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/DSRMAccountAbuse.yaml) |
| analytic_rule | Email access via active sync | Event.Source == "Microsoft-Windows-Sysmon"  \|  SecurityEvent.EventID in "1,4688" | [MultipleDataSources/EmailAccessviaActiveSync.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/EmailAccessviaActiveSync.yaml) |
| analytic_rule | End-user consent stopped due to risk-based consent | AuditLogs.OperationName has "Consent to application" | [AuditLogs/End-userconsentstoppedduetorisk-basedconsent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/End-userconsentstoppedduetorisk-basedconsent.yaml) |
| analytic_rule | Failed AWS Console logons but success logon to Azu | AWSCloudTrail.EventName == "ConsoleLogin" | [MultipleDataSources/AWSConsoleAADCorrelation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/AWSConsoleAADCorrelation.yaml) |
| analytic_rule | Failed AzureAD logons but success logon to AWS Con | AWSCloudTrail.EventName =~ "ConsoleLogin" | [MultipleDataSources/AADAWSConsoleCorrelation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/AADAWSConsoleCorrelation.yaml) |
| analytic_rule | Failed AzureAD logons but success logon to host | Syslog.Facility contains "auth"  \|  Syslog.ProcessName != "sudo"  \|  Syslog.SyslogMessage has "Accepted" | [MultipleDataSources/AADHostLoginCorrelation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/AADHostLoginCorrelation.yaml) |
| analytic_rule | Failed host logons but success logon to AzureAD | Syslog.Facility contains "auth"  \|  Syslog.ProcessName != "sudo"  \|  Syslog.SyslogMessage has "from"  \|  Syslog.SyslogMessage has_any "Accepted,Disconnected,Disconnecting,[preauth],disconnect"  \|  WindowsEvent.EventID == "4625" | [MultipleDataSources/HostAADCorrelation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/HostAADCorrelation.yaml) |
| analytic_rule | Fake computer account created | SecurityEvent.EventID == "4720" | [SecurityEvent/FakeComputerAccountCreated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/FakeComputerAccountCreated.yaml) |
| analytic_rule | Fortinet - Beacon pattern detected | CommonSecurityLog.DeviceVendor == "Fortinet" | [CommonSecurityLog/Fortinet-NetworkBeaconPattern.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/CommonSecurityLog/Fortinet-NetworkBeaconPattern.yaml) |
| analytic_rule | Gain Code Execution on ADFS Server via Remote WMI  | Event.Source == "Microsoft-Windows-Sysmon"  \|  WindowsEvent.EventID in "1,19,20,21,4624,4688" | [MultipleDataSources/GainCodeExecutionADFSviaWMI.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/GainCodeExecutionADFSviaWMI.yaml) |
| analytic_rule | Group created then added to built in domain local  | WindowsEvent.EventID in "4727,4728,4731,4732,4754,4756" | [SecurityEvent/GroupCreatedAddedToPrivlegeGroup_1h.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/GroupCreatedAddedToPrivlegeGroup_1h.yaml) |
| analytic_rule | Guest Users Invited to Tenant by New Inviters | AuditLogs.OperationName =~ "Invite external user" | [AuditLogs/GuestUsersInvitedtoTenantbyNewInviters.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/GuestUsersInvitedtoTenantbyNewInviters.yaml) |
| analytic_rule | IP with multiple failed Microsoft Entra ID logins  | CommonSecurityLog.DeviceEventClassID == "globalprotect"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [MultipleDataSources/AAD_PAVPN_Correlation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/AAD_PAVPN_Correlation.yaml) |
| analytic_rule | M365D Alerts Correlation to non-Microsoft Network  | CommonSecurityLog.DeviceProduct startswith "FireWall"  \|  CommonSecurityLog.DeviceProduct startswith "FortiGate"  \|  CommonSecurityLog.DeviceProduct startswith "NSSWeblog"  \|  CommonSecurityLog.DeviceProduct startswith "PAN"  \|  CommonSecurityLog.DeviceProduct startswith "URL"  \|  CommonSecurityLog.DeviceProduct startswith "VPN"  \|  CommonSecurityLog.DeviceVendor has_any "Check Point,Fortinet,Palo Alto Networks,Zscaler" | [MultipleDataSources/SucessfullSiginFromPhingLink.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/SucessfullSiginFromPhingLink.yaml) |
| analytic_rule | Mass Download & copy to USB device by single user | DeviceEvents.ActionType in "FileCreated,FileDownloaded,FileRenamed,UsbDriveMounted" | [SecurityAlert/Massdownload_USBFileCopy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityAlert/Massdownload_USBFileCopy.yaml) |
| analytic_rule | Microsoft Entra ID Health Monitoring Agent Registr | WindowsEvent.EventID in "4656,4663" | [SecurityEvent/AADHealthMonAgentRegKeyAccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/AADHealthMonAgentRegKeyAccess.yaml) |
| analytic_rule | Microsoft Entra ID Health Service Agents Registry  | SecurityEvent.EventID in "4656,4663" | [SecurityEvent/AADHealthSvcAgentRegKeyAccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/AADHealthSvcAgentRegKeyAccess.yaml) |
| analytic_rule | Modification of Accessibility Features | Event.EventID == "1"  \|  Event.EventLog == "Microsoft-Windows-Sysmon/Operational" | [SecurityEvent/AccessibilityFeaturesModification.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/AccessibilityFeaturesModification.yaml) |
| analytic_rule | Multiple Password Reset by user | OfficeActivity.OfficeWorkload == "AzureActiveDirectory"  \|  Syslog.Facility in "auth,authpriv"  \|  Syslog.SyslogMessage matchesregex ".*password changed for.*"  \|  WindowsEvent.EventID in "4723,4724" | [MultipleDataSources/MultiplePasswordresetsbyUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/MultiplePasswordresetsbyUser.yaml) |
| analytic_rule | NRT Malicious Inbox Rule | OfficeActivity.OfficeWorkload =~ "Exchange" | [OfficeActivity/NRT_Malicious_Inbox_Rule.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/OfficeActivity/NRT_Malicious_Inbox_Rule.yaml) |
| analytic_rule | NRT Multiple users email forwarded to same destina | OfficeActivity.OfficeWorkload =~ "Exchange" | [OfficeActivity/NRT_Office_MailForwarding.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/OfficeActivity/NRT_Office_MailForwarding.yaml) |
| analytic_rule | PE file dropped in Color Profile Folder | DeviceFileEvents.ActionType =~ "FileCreated" | [DeviceFileEvents/PEfiledroppedinColorDriversFolder.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/DeviceFileEvents/PEfiledroppedinColorDriversFolder.yaml) |
| analytic_rule | Phishing link click observed in Network Traffic | CommonSecurityLog.DeviceProduct startswith "FireWall"  \|  CommonSecurityLog.DeviceProduct startswith "FortiGate"  \|  CommonSecurityLog.DeviceProduct startswith "NSSWeblog"  \|  CommonSecurityLog.DeviceProduct startswith "PAN"  \|  CommonSecurityLog.DeviceProduct startswith "URL"  \|  CommonSecurityLog.DeviceProduct startswith "VPN"  \|  CommonSecurityLog.DeviceVendor has_any "Check Point,Fortinet,Palo Alto Networks,Zscaler" | [MultipleDataSources/PhishinglinkExecutionObserved.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/PhishinglinkExecutionObserved.yaml) |
| analytic_rule | Possible Resource-Based Constrained Delegation Abu | SecurityEvent.EventID == "5136" | [SecurityEvent/PotenialResourceBasedConstrainedDelegationAbuse.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/PotenialResourceBasedConstrainedDelegationAbuse.yaml) |
| analytic_rule | Potential Build Process Compromise | WindowsEvent.EventID in "4663,4688" | [SecurityEvent/PotentialBuildProcessCompromise.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/PotentialBuildProcessCompromise.yaml) |
| analytic_rule | Potential Kerberoasting | WindowsEvent.EventID == "4769" | [SecurityEvent/PotentialKerberoast.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/PotentialKerberoast.yaml) |
| analytic_rule | RDP Nesting | WindowsEvent.EventID == "4624" | [SecurityEvent/RDP_Nesting.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/RDP_Nesting.yaml) |
| analytic_rule | Risky user signin observed in non-Microsoft networ | CommonSecurityLog.DeviceProduct startswith "FireWall"  \|  CommonSecurityLog.DeviceProduct startswith "FortiGate"  \|  CommonSecurityLog.DeviceProduct startswith "NSSWeblog"  \|  CommonSecurityLog.DeviceProduct startswith "PAN"  \|  CommonSecurityLog.DeviceProduct startswith "URL"  \|  CommonSecurityLog.DeviceProduct startswith "VPN"  \|  CommonSecurityLog.DeviceVendor has_any "Check Point,Fortinet,Palo Alto Networks,Zscaler" | [MultipleDataSources/RiskyUserIn3Pnetworkactivity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/RiskyUserIn3Pnetworkactivity.yaml) |
| analytic_rule | Sdelete deployed via GPO and run recursively (ASIM | _Im_ProcessEvent.EventType =~ "ProcessCreated" | [ASimProcess/SdeletedeployedviaGPOandrunrecursively(ASIMVersion).yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/ASimProcess/SdeletedeployedviaGPOandrunrecursively%28ASIMVersion%29.yaml) |
| analytic_rule | Security Service Registry ACL Modification | WindowsEvent.EventID in "4670,4688" | [MultipleDataSources/SecurityServiceRegistryACLModification.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/SecurityServiceRegistryACLModification.yaml) |
| analytic_rule | Service Principal Assigned App Role With Sensitive | AuditLogs.OperationName =~ "Add app role assignment to service principal" | [AuditLogs/ServicePrincipalAssignedAppRoleWithSensitiveAccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ServicePrincipalAssignedAppRoleWithSensitiveAccess.yaml) |
| analytic_rule | Service Principal Assigned Privileged Role | AuditLogs.OperationName has_all "member to role" | [AuditLogs/ServicePrincipalAssignedPrivilegedRole.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/ServicePrincipalAssignedPrivilegedRole.yaml) |
| analytic_rule | Service Principal Name (SPN) Assigned to User Acco | SecurityEvent.EventID == "5136" | [SecurityEvent/UserPrincipalNameAssignedToUserAccount.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/UserPrincipalNameAssignedToUserAccount.yaml) |
| analytic_rule | Silk Typhoon New UM Service Child Process | WindowsEvent.EventID == "4688" | [SecurityEvent/SilkTyphoonNewUMServiceChildProcess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/SilkTyphoonNewUMServiceChildProcess.yaml) |
| analytic_rule | Silk Typhoon Suspicious UM Service Error | Event.EventLog =~ "Application"  \|  Event.Source startswith "MSExchange" | [SecurityEvent/SilkTyphoonSuspiciousUMServiceError.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/SilkTyphoonSuspiciousUMServiceError.yaml) |
| analytic_rule | Solorigate Named Pipe | WindowsEvent.EventID in "17,18,5145" | [SecurityEvent/SolorigateNamedPipe.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/SolorigateNamedPipe.yaml) |
| analytic_rule | Suspicious Login from deleted guest account | AuditLogs.OperationName =~ "Delete user" | [MultipleDataSources/SuspiciousLoginfromDeletedExternalIdentities.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/SuspiciousLoginfromDeletedExternalIdentities.yaml) |
| analytic_rule | Suspicious linking of existing user to external Us | AuditLogs.OperationName =~ "Update user" | [AuditLogs/SuspiciousLinkingofExternalIdtoExistingUsers.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/SuspiciousLinkingofExternalIdtoExistingUsers.yaml) |
| analytic_rule | Suspicious modification of Global Administrator us | AuditLogs.OperationName =~ "Update user" | [MultipleDataSources/SuspiciousModificationofGlobalAdminProperties.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/MultipleDataSources/SuspiciousModificationofGlobalAdminProperties.yaml) |
| analytic_rule | URL Added to Application from Unknown Domain | AuditLogs.OperationName =~ "Update Application" | [AuditLogs/URLAddedtoApplicationfromUnknownDomain.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/URLAddedtoApplicationfromUnknownDomain.yaml) |
| analytic_rule | User Account Created Using Incorrect Naming Format | AuditLogs.OperationName =~ "Add user" | [AuditLogs/UserAccountCreatedUsingIncorrectNamingFormat.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/UserAccountCreatedUsingIncorrectNamingFormat.yaml) |
| analytic_rule | User State changed from Guest to Member | AuditLogs.OperationName =~ "Update user" | [AuditLogs/UserStatechangedfromGuesttoMember.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/UserStatechangedfromGuesttoMember.yaml) |
| analytic_rule | User account added to built in domain local or glo | WindowsEvent.EventID in "4728,4732,4756" | [SecurityEvent/UserAccountAddedToPrivlegeGroup_1h.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/UserAccountAddedToPrivlegeGroup_1h.yaml) |
| analytic_rule | User account created and deleted within 10 mins | WindowsEvent.EventID in "4720,4726" | [SecurityEvent/UserAccountCreatedDeleted_10m.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/UserAccountCreatedDeleted_10m.yaml) |
| analytic_rule | User account created without expected attributes d | AuditLogs.OperationName =~ "Add user" | [AuditLogs/Useraccountcreatedwithoutexpectedattributesdefined.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/AuditLogs/Useraccountcreatedwithoutexpectedattributesdefined.yaml) |
| analytic_rule | User account enabled and disabled within 10 mins | WindowsEvent.EventID in "4722,4725" | [SecurityEvent/UserAccountEnabledDisabled_10m.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/SecurityEvent/UserAccountEnabledDisabled_10m.yaml) |
| analytic_rule | Wazuh - Large Number of Web errors from an IP | CommonSecurityLog.DeviceProduct =~ "Wazuh" | [CommonSecurityLog/Wazuh-Large_Number_of_Web_errors_from_an_IP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Detections/Analytic%20Rules/CommonSecurityLog/Wazuh-Large_Number_of_Web_errors_from_an_IP.yaml) |
| hunting_query | Active Directory Account lockout and unlocks | IdentityDirectoryEvents.ActionType == "Account Unlock changed" | [Microsoft 365 Defender/Initial access/ActiveDirectory_Account_lockout_and_unlocks.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Initial%20access/ActiveDirectory_Account_lockout_and_unlocks.yaml) |
| hunting_query | Anomalous Microsoft Entra ID apps based on authent | SigninLogs.OperationName == "Sign-in activity" | [SigninLogs/anomalous_app_azuread_signin.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/SigninLogs/anomalous_app_azuread_signin.yaml) |
| hunting_query | Check critical ports opened to the entire internet | AzureDiagnostics.Category == "NetworkSecurityGroupEvent" | [AzureDiagnostics/CriticalPortsOpened.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/AzureDiagnostics/CriticalPortsOpened.yaml) |
| hunting_query | Consent to Application discovery | AuditLogs.OperationName == "Consent to application"  \|  AuditLogs.OperationName != "Consent to application" | [AuditLogs/ConsentToApplicationDiscovery.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/AuditLogs/ConsentToApplicationDiscovery.yaml) |
| hunting_query | Disabled accounts using Squid proxy | Syslog.ProcessName contains "squid" | [Syslog/disabled_account_squid_usage.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Syslog/disabled_account_squid_usage.yaml) |
| hunting_query | External IP address in Command Line | SecurityEvent.EventID == "4688" | [SecurityEvent/ExternalIPaddressinCommandLine.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/SecurityEvent/ExternalIPaddressinCommandLine.yaml) |
| hunting_query | Failed Login Attempt by Expired account | SecurityEvent.EventID in "4625,4769,4776" | [MultipleDataSources/LogonwithExpiredAccount.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/MultipleDataSources/LogonwithExpiredAccount.yaml) |
| hunting_query | Find_deleted_accounts_and_by_whom | IdentityDirectoryEvents.ActionType == "Account deleted" | [Microsoft 365 Defender/Discovery/MDI_Find_deleted_accounts_and_by_whom.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDI_Find_deleted_accounts_and_by_whom.yaml) |
| hunting_query | Inactive or new account signins | AuditLogs.OperationName == "Add user" | [SigninLogs/InactiveAccounts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/SigninLogs/InactiveAccounts.yaml) |
| hunting_query | MDE_AVScanTimesAndType | DeviceEvents.ActionType in "AntivirusScanCancelled,AntivirusScanCompleted" | [Microsoft 365 Defender/Discovery/MDE_AVScanTimesAndType.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDE_AVScanTimesAndType.YAML) |
| hunting_query | MDE_BlockingASRRules | DeviceEvents.ActionType startswith "ASR" | [Microsoft 365 Defender/Discovery/MDE_BlockingASRRules.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDE_BlockingASRRules.YAML) |
| hunting_query | MDE_ListAlPnPDevicesAllowedorBlocked | DeviceEvents.ActionType in "PnpDeviceAllowed,PnpDeviceBlocked" | [Microsoft 365 Defender/Discovery/MDE_ListAlPnPDevicesAllowedorBlocked.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDE_ListAlPnPDevicesAllowedorBlocked.YAML) |
| hunting_query | MDE_ShowUSBMountedDevicesAndDriveLetter | DeviceEvents.ActionType contains "USB" | [Microsoft 365 Defender/Discovery/MDE_ShowUSBMountedDevicesAndDriveLetter.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDE_ShowUSBMountedDevicesAndDriveLetter.YAML) |
| hunting_query | MDE_ShowUSBMountedandfilescopied | DeviceEvents.ActionType == "FileCreated"  \|  DeviceEvents.ActionType contains "USB" | [Microsoft 365 Defender/Discovery/MDE_ShowUSBMountedandfilescopied.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDE_ShowUSBMountedandfilescopied.YAML) |
| hunting_query | MDE_SmartScreenCheck | DeviceNetworkEvents.ActionType in "ExploitGuardNetworkProtectionBlocked,SmartScreenUrlWarning" | [Microsoft 365 Defender/Discovery/MDE_SmartScreenCheck.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDE_SmartScreenCheck.YAML) |
| hunting_query | MDI_Group_Memebership_Changes | IdentityDirectoryEvents.ActionType == "Group Membership changed" | [Microsoft 365 Defender/Discovery/MDI_Group_Memebership_Changes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDI_Group_Memebership_Changes.yaml) |
| hunting_query | MDI_Objects_Moving_OUs | IdentityDirectoryEvents.ActionType == "Account Path changed" | [Microsoft 365 Defender/Discovery/MDI_Objects_Moving_OUs.YAML](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Discovery/MDI_Objects_Moving_OUs.YAML) |
| hunting_query | RareDNSLookupWithDataTransfer | CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [MultipleDataSources/RareDNSLookupWithDataTransfer.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/MultipleDataSources/RareDNSLookupWithDataTransfer.yaml) |
| hunting_query | Tracking Privileged Account Rare Activity | SecurityEvent.EventID in "4624,4625,4720,4726,4728,4732,4756,7045" | [MultipleDataSources/TrackingPrivAccounts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/MultipleDataSources/TrackingPrivAccounts.yaml) |
| hunting_query | User Granted Access and created resources | AzureActivity.OperationName has "Create" | [MultipleDataSources/UserGrantedAccess_CreatesResources.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/MultipleDataSources/UserGrantedAccess_CreatesResources.yaml) |
| summary_rule | FortinetFortigateNetworkSessionIPSummary | CommonSecurityLog.DeviceProduct startswith "FortiGate"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [Network/FortinetFortigateNetworkSessionIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/Network/FortinetFortigateNetworkSessionIPSummary.yaml) |
| summary_rule | FortinetFortigateWebSessionIPSummary | CommonSecurityLog.DeviceProduct startswith "Fortigate"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [WebSession/FortinetFortigateWebSessionIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/WebSession/FortinetFortigateWebSessionIPSummary.yaml) |
| summary_rule | PaloAltoPANOSNetworkSessionIPSummary | CommonSecurityLog.DeviceProduct == "PAN-OS"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Network/PaloAltoPANOSNetworkSessionIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/Network/PaloAltoPANOSNetworkSessionIPSummary.yaml) |
| summary_rule | PaloAltoPANOSWebSessionIPSummary | CommonSecurityLog.DeviceEventClassID == "url"  \|  CommonSecurityLog.DeviceProduct == "PAN-OS"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [WebSession/PaloAltoPANOSWebSessionIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/WebSession/PaloAltoPANOSWebSessionIPSummary.yaml) |
| summary_rule | ZscalarDNSEventsIPSummary | CommonSecurityLog.DeviceProduct == "NSSDNSlog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [DNS/ZscalarDNSEventsIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/DNS/ZscalarDNSEventsIPSummary.yaml) |
| summary_rule | ZscalarNetworkSessionIPSummary | CommonSecurityLog.DeviceProduct == "NSSFWlog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [Network/ZscalarNetworkSessionIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/Network/ZscalarNetworkSessionIPSummary.yaml) |
| summary_rule | ZscalarWebSessionIPSummary | CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [WebSession/ZscalarWebSessionIPSummary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Summary%20rules/Summary%20Rule/WebSession/ZscalarWebSessionIPSummary.yaml) |

### Syslog

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Failed logon attempts in authpriv | Syslog.Facility =~ "authpriv"  \|  Syslog.SyslogMessage has "authentication failure"  \|  Syslog.SyslogMessage has "uid=0"  \|  Syslog.SyslogMessage has "user unknown" | [FailedLogonAttempts_UnknownUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/FailedLogonAttempts_UnknownUser.yaml) |
| analytic_rule | NRT Squid proxy events related to mining pools | Syslog.ProcessName contains "squid" | [NRT_squid_events_for_mining_pools.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/NRT_squid_events_for_mining_pools.yaml) |
| analytic_rule | SFTP File transfer above threshold | Syslog.ProcessName has "sftp"  \|  Syslog.SyslogMessage has "bytes read"  \|  Syslog.SyslogMessage has "close"  \|  Syslog.SyslogMessage has "session opened for" | [sftp_file_transfer_above_threshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/sftp_file_transfer_above_threshold.yaml) |
| analytic_rule | SFTP File transfer folder count above threshold | Syslog.ProcessName has "sftp"  \|  Syslog.SyslogMessage has "bytes read"  \|  Syslog.SyslogMessage has "close"  \|  Syslog.SyslogMessage has "session opened for" | [sftp_file_transfer_folders_above_threshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/sftp_file_transfer_folders_above_threshold.yaml) |
| analytic_rule | SSH - Potential Brute Force | Syslog.ProcessName =~ "sshd"  \|  Syslog.SyslogMessage contains "Failed password for invalid user" | [ssh_potentialBruteForce.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/ssh_potentialBruteForce.yaml) |
| analytic_rule | Squid proxy events for ToR proxies | Syslog.ProcessName contains "squid" | [squid_tor_proxies.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/squid_tor_proxies.yaml) |
| analytic_rule | Squid proxy events related to mining pools | Syslog.ProcessName contains "squid" | [squid_cryptomining_pools.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Analytic%20Rules/squid_cryptomining_pools.yaml) |
| hunting_query | Editing Linux scheduled tasks through Crontab | Syslog.Facility =~ "cron"  \|  Syslog.ProcessName =~ "crontab" | [SchedTaskEditViaCrontab.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/SchedTaskEditViaCrontab.yaml) |
| hunting_query | Linux scheduled task Aggregation | Syslog.Facility =~ "cron"  \|  Syslog.ProcessName in~ "CRON,CROND"  \|  Syslog.SyslogMessage contains "CMD" | [SchedTaskAggregation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/SchedTaskAggregation.yaml) |
| hunting_query | SCX Execute RunAs Providers | Syslog.SyslogMessage has "AUOMS_EXECVE" | [SCXExecuteRunAsProviders.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/SCXExecuteRunAsProviders.yaml) |
| hunting_query | Squid commonly abused TLDs | Syslog.ProcessName contains "squid" | [squid_abused_tlds.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/squid_abused_tlds.yaml) |
| hunting_query | Squid data volume timeseries anomalies | Syslog.ProcessName contains "squid" | [squid_volume_anomalies.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/squid_volume_anomalies.yaml) |
| hunting_query | Squid malformed requests | Syslog.ProcessName contains "squid" | [squid_malformed_requests.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/squid_malformed_requests.yaml) |
| hunting_query | Suspicious crytocurrency mining related threat act | Syslog.Facility == "user"  \|  Syslog.SyslogMessage has "AUOMS_EXECVE" | [CryptoThreatActivity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Syslog/Hunting%20Queries/CryptoThreatActivity.yaml) |

### Teams

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | MicrosoftTeams | OfficeActivity.OfficeWorkload =~ "MicrosoftTeams"  \|  OfficeActivity.RecordType =~ "SharePointFileOperation" | [MicrosoftTeams.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Teams/Workbooks/MicrosoftTeams.json) |

### Threat Intelligence

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | TI Map Domain Entity to DeviceNetworkEvents | DeviceNetworkEvents.ActionType !has "ConnectionFailed" | [DomainEntity_DeviceNetworkEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/DomainEntity_DeviceNetworkEvents.yaml) |
| analytic_rule | TI Map IP Entity to Azure SQL Security Audit Event | AzureDiagnostics.Category == "SQLSecurityAuditEvents"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.SQL" | [IPEntity_AzureSQL.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/IPEntity_AzureSQL.yaml) |
| analytic_rule | TI Map IP Entity to DeviceNetworkEvents | DeviceNetworkEvents.ActionType !has "ConnectionFailed" | [IPEntity_DeviceNetworkEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/IPEntity_DeviceNetworkEvents.yaml) |
| analytic_rule | TI Map URL Entity to DeviceNetworkEvents | DeviceNetworkEvents.ActionType !has "ConnectionFailed" | [URLEntity_DeviceNetworkEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/URLEntity_DeviceNetworkEvents.yaml) |
| analytic_rule | TI Map URL Entity to PaloAlto Data | CommonSecurityLog.DeviceEventClassID =~ "url"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [URLEntity_PaloAlto.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/URLEntity_PaloAlto.yaml) |
| analytic_rule | TI map Domain entity to PaloAlto | CommonSecurityLog.DeviceEventClassID =~ "url"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [DomainEntity_PaloAlto.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/DomainEntity_PaloAlto.yaml) |
| analytic_rule | TI map Domain entity to PaloAlto CommonSecurityLog | CommonSecurityLog.DeviceEventClassID =~ "url" | [DomainEntity_CommonSecurityLog.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/DomainEntity_CommonSecurityLog.yaml) |
| analytic_rule | TI map Email entity to PaloAlto CommonSecurityLog | CommonSecurityLog.DeviceEventClassID == "wildfire"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [EmailEntity_PaloAlto.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/EmailEntity_PaloAlto.yaml) |
| analytic_rule | TI map IP entity to Azure Key Vault logs | AzureDiagnostics.ResourceType =~ "VAULTS" | [IPEntity_AzureKeyVault.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/IPEntity_AzureKeyVault.yaml) |
| analytic_rule | TI map IP entity to Workday(ASimAuditEventLogs) | ASimAuditEventLogs.EventVendor == "Workday" | [IPEntity_Workday.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Analytic%20Rules/IPEntity_Workday.yaml) |
| hunting_query | TI Map File Entity to Security Event | SecurityEvent.EventID in "4648,4673,4688,8002" | [FileEntity_SecurityEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence/Hunting%20Queries/FileEntity_SecurityEvent.yaml) |

### Threat Intelligence (NEW)

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | TI Map Domain Entity to DeviceNetworkEvents | DeviceNetworkEvents.ActionType !has "ConnectionFailed" | [DomainEntity_DeviceNetworkEvents_Updated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/DomainEntity_DeviceNetworkEvents_Updated.yaml) |
| analytic_rule | TI Map IP Entity to Azure SQL Security Audit Event | AzureDiagnostics.Category == "SQLSecurityAuditEvents"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.SQL" | [IPEntity_AzureSQL.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/IPEntity_AzureSQL.yaml) |
| analytic_rule | TI Map IP Entity to DeviceNetworkEvents | DeviceNetworkEvents.ActionType !has "ConnectionFailed" | [IPEntity_DeviceNetworkEvents_Updated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/IPEntity_DeviceNetworkEvents_Updated.yaml) |
| analytic_rule | TI Map URL Entity to DeviceNetworkEvents | DeviceNetworkEvents.ActionType !has "ConnectionFailed" | [URLEntity_DeviceNetworkEvents_Updated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/URLEntity_DeviceNetworkEvents_Updated.yaml) |
| analytic_rule | TI Map URL Entity to PaloAlto Data | CommonSecurityLog.DeviceEventClassID =~ "url"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [URLEntity_PaloAlto.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/URLEntity_PaloAlto.yaml) |
| analytic_rule | TI map Domain entity to PaloAlto | CommonSecurityLog.DeviceEventClassID =~ "url"  \|  CommonSecurityLog.DeviceVendor =~ "Palo Alto Networks" | [DomainEntity_PaloAlto.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/DomainEntity_PaloAlto.yaml) |
| analytic_rule | TI map Domain entity to PaloAlto CommonSecurityLog | CommonSecurityLog.DeviceEventClassID =~ "url" | [DomainEntity_CommonSecurityLog.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/DomainEntity_CommonSecurityLog.yaml) |
| analytic_rule | TI map Email entity to PaloAlto CommonSecurityLog | CommonSecurityLog.DeviceEventClassID == "wildfire"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [EmailEntity_PaloAlto.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/EmailEntity_PaloAlto.yaml) |
| analytic_rule | TI map IP entity to Azure Key Vault logs | AzureDiagnostics.ResourceType =~ "VAULTS" | [IPEntity_AzureKeyVault.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/IPEntity_AzureKeyVault.yaml) |
| analytic_rule | TI map IP entity to Workday(ASimAuditEventLogs) | ASimAuditEventLogs.EventVendor == "Workday" | [IPEntity_Workday_Updated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Analytic%20Rules/IPEntity_Workday_Updated.yaml) |
| hunting_query | TI Map File Entity to Security Event | SecurityEvent.EventID in "4648,4673,4688,8002" | [FileEntity_SecurityEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Threat%20Intelligence%20%28NEW%29/Hunting%20Queries/FileEntity_SecurityEvent.yaml) |

### ThreatAnalysis&Response

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | DynamicThreatModeling&Response | AzureDiagnostics.ResourceType == "PUBLICIPADDRESSES" | [DynamicThreatModeling&Response.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ThreatAnalysis%26Response/Workbooks/DynamicThreatModeling%26Response.json) |

### UEBA Essentials

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| hunting_query | Anomalous Entra High-Privilege Role Modification | AuditLogs.OperationName == "Update user" | [Anomalous Entra High-Privilege Role Modification.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/UEBA%20Essentials/Hunting%20Queries/Anomalous%20Entra%20High-Privilege%20Role%20Modification.yaml) |
| hunting_query | Anomalous High-Privileged Role Assignment | AuditLogs.OperationName =~ "Add member to role" | [Anomalous High-Privileged Role Assignment.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/UEBA%20Essentials/Hunting%20Queries/Anomalous%20High-Privileged%20Role%20Assignment.yaml) |

### VMware SASE

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | VMware SD-WAN Edge - IDS/IPS Alert triggered (Sysl | Syslog.SyslogMessage contains "VCF Alert" | [vmw-sdwan-idps-alert-syslog.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/VMware%20SD-WAN%20and%20SASE/Analytic%20Rules/vmw-sdwan-idps-alert-syslog.yaml) |
| analytic_rule | VMware SD-WAN Edge - Network Anomaly Detection - P | Syslog.SyslogMessage contains "VCF Drop"  \|  Syslog.SyslogMessage contains "packet too big" | [vmw-sdwan-ipfrag-attempt.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/VMware%20SD-WAN%20and%20SASE/Analytic%20Rules/vmw-sdwan-ipfrag-attempt.yaml) |
| analytic_rule | VMware SD-WAN Edge - Network Anomaly Detection - R | Syslog.SyslogMessage contains "Reverse path forwarding check fail"  \|  Syslog.SyslogMessage contains "VCF Drop" | [vmw-sdwan-rpfcheck.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/VMware%20SD-WAN%20and%20SASE/Analytic%20Rules/vmw-sdwan-rpfcheck.yaml) |
| workbook | VMwareSASESOCDashboard | Syslog.SyslogMessage contains "ACTION=VCF"  \|  Syslog.SyslogMessage contains "VCF Alert" | [VMwareSASESOCDashboard.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/VMware%20SD-WAN%20and%20SASE/Workbooks/VMwareSASESOCDashboard.json) |

### Vectra AI Detect

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Vectra AI Detect - Detections with High Severity | CommonSecurityLog.DeviceEventClassID != "asc"  \|  CommonSecurityLog.DeviceEventClassID != "audit"  \|  CommonSecurityLog.DeviceEventClassID != "campaigns"  \|  CommonSecurityLog.DeviceEventClassID != "health"  \|  CommonSecurityLog.DeviceEventClassID != "hsc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-HighSeverityDetection-by-Tactics.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-HighSeverityDetection-by-Tactics.yaml) |
| analytic_rule | Vectra AI Detect - New Campaign Detected | CommonSecurityLog.DeviceEventClassID contains "campaign"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-NewCampaign.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-NewCampaign.yaml) |
| analytic_rule | Vectra AI Detect - Suspected Compromised Account | CommonSecurityLog.DeviceEventClassID == "asc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-Account-by-Severity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-Account-by-Severity.yaml) |
| analytic_rule | Vectra AI Detect - Suspected Compromised Host | CommonSecurityLog.DeviceEventClassID == "hsc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-Host-by-Severity.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-Host-by-Severity.yaml) |
| analytic_rule | Vectra AI Detect - Suspicious Behaviors by Categor | CommonSecurityLog.DeviceEventClassID != "asc"  \|  CommonSecurityLog.DeviceEventClassID != "audit"  \|  CommonSecurityLog.DeviceEventClassID != "campaigns"  \|  CommonSecurityLog.DeviceEventClassID != "health"  \|  CommonSecurityLog.DeviceEventClassID != "hsc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-Suspected-Behavior-by-Tactics.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-Suspected-Behavior-by-Tactics.yaml) |
| analytic_rule | Vectra Account's Behaviors | CommonSecurityLog.DeviceEventClassID != "asc"  \|  CommonSecurityLog.DeviceEventClassID != "audit"  \|  CommonSecurityLog.DeviceEventClassID != "campaigns"  \|  CommonSecurityLog.DeviceEventClassID != "health"  \|  CommonSecurityLog.DeviceEventClassID != "hsc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-Account-Detections.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-Account-Detections.yaml) |
| analytic_rule | Vectra Host's Behaviors | CommonSecurityLog.DeviceEventClassID != "asc"  \|  CommonSecurityLog.DeviceEventClassID != "audit"  \|  CommonSecurityLog.DeviceEventClassID != "campaigns"  \|  CommonSecurityLog.DeviceEventClassID != "health"  \|  CommonSecurityLog.DeviceEventClassID != "hsc"  \|  CommonSecurityLog.DeviceProduct == "X Series"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [VectraDetect-Host-Detections.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Analytic%20Rules/VectraDetect-Host-Detections.yaml) |
| workbook | AIVectraDetectWorkbook | CommonSecurityLog.DeviceEventClassID in "asc,audit,campaigns,health,hsc"  \|  CommonSecurityLog.DeviceEventClassID !in "health,audit,campaigns,hsc,asc"  \|  CommonSecurityLog.DeviceEventClassID !in~ "health,audit,campaigns,hsc,asc"  \|  CommonSecurityLog.DeviceVendor == "Vectra Networks" | [AIVectraDetectWorkbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Vectra%20AI%20Detect/Workbooks/AIVectraDetectWorkbook.json) |

### Veeam

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | VeeamSecurityActivities | Syslog.SyslogMessage has "instanceId"  \|  Syslog.SyslogMessage has "predefined_alarm_id" | [VeeamSecurityActivities.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Veeam/Workbooks/VeeamSecurityActivities.json) |

### Web Shells Threat Protection

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Identify SysAid Server web shell creation | SecurityEvent.EventID in "4663,4688" | [PotentialMercury_Webshell.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Web%20Shells%20Threat%20Protection/Analytic%20Rules/PotentialMercury_Webshell.yaml) |
| hunting_query | Possible Webshell usage attempt related to SpringS | AzureDiagnostics.Category in "ApplicationGatewayAccessLog,ApplicationGatewayFirewallLog,FrontdoorAccessLog,FrontdoorWebApplicationFirewallLog" | [SpringshellWebshellUsage.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Web%20Shells%20Threat%20Protection/Hunting%20Queries/SpringshellWebshellUsage.yaml) |
| hunting_query | Possible webshell drop | DeviceFileEvents.ActionType in "FileCreated,FileModified,FileRenamed" | [Possible webshell drop.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Web%20Shells%20Threat%20Protection/Hunting%20Queries/Possible%20webshell%20drop.yaml) |

### Windows Firewall

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | WindowsFirewall | SecurityEvent.EventID in "4624,4625" | [WindowsFirewall.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Firewall/Workbooks/WindowsFirewall.json) |

### Windows Forwarded Events

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Caramel Tsunami Actor IOC - July 2021 | WindowsEvent.EventID == "4688" | [CaramelTsunami_IOC_WindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Forwarded%20Events/Analytic%20Rules/CaramelTsunami_IOC_WindowsEvent.yaml) |
| analytic_rule | Chia_Crypto_Mining IOC - June 2021 | WindowsEvent.EventID == "4688" | [ChiaCryptoMining_WindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Forwarded%20Events/Analytic%20Rules/ChiaCryptoMining_WindowsEvent.yaml) |
| analytic_rule | Progress MOVEIt File transfer above threshold | Event.EventID == "0"  \|  Event.EventLog == "Application"  \|  Event.Source == "MOVEit DMZ Audit" | [moveit_file_transfer_above_threshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Forwarded%20Events/Analytic%20Rules/moveit_file_transfer_above_threshold.yaml) |
| analytic_rule | Progress MOVEIt File transfer folder count above t | Event.EventID == "0"  \|  Event.EventLog == "Application"  \|  Event.Source == "MOVEit DMZ Audit" | [moveit_file_transfer_folders_above_threshold.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Forwarded%20Events/Analytic%20Rules/moveit_file_transfer_folders_above_threshold.yaml) |

### Windows Security Events

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | AD FS Remote Auth Sync Connection | SecurityEvent.EventID in "412,501,5156" | [ADFSRemoteAuthSyncConnection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/ADFSRemoteAuthSyncConnection.yaml) |
| analytic_rule | AD FS Remote HTTP Network Connection | Event.EventID in "18,3"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [ADFSRemoteHTTPNetworkConnection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/ADFSRemoteHTTPNetworkConnection.yaml) |
| analytic_rule | ADFS Database Named Pipe Connection | Event.EventID == "18"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [ADFSDBNamedPipeConnection.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/ADFSDBNamedPipeConnection.yaml) |
| analytic_rule | Excessive Windows Logon Failures | SecurityEvent.EventID == "4625" | [ExcessiveLogonFailures.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/ExcessiveLogonFailures.yaml) |
| analytic_rule | Exchange OAB Virtual Directory Attribute Containin | SecurityEvent.EventID == "5136" | [ExchangeOABVirtualDirectoryAttributeContainingPotentialWebshell.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/ExchangeOABVirtualDirectoryAttributeContainingPotentialWebshell.yaml) |
| analytic_rule | Gain Code Execution on ADFS Server via SMB + Remot | SecurityEvent.EventID in "4624,4688,4697,4698,4699,4700,4701,4702,5145" | [GainCodeExecutionADFSViaSMB.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/GainCodeExecutionADFSViaSMB.yaml) |
| analytic_rule | Microsoft Entra ID Local Device Join Information a | SecurityEvent.EventID in "4656,4663" | [LocalDeviceJoinInfoAndTransportKeyRegKeysAccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/LocalDeviceJoinInfoAndTransportKeyRegKeysAccess.yaml) |
| analytic_rule | NRT Base64 Encoded Windows Process Command-lines | SecurityEvent.EventID == "4688" | [NRT_base64_encoded_pefile.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/NRT_base64_encoded_pefile.yaml) |
| analytic_rule | NRT Process executed from binary hidden in Base64  | SecurityEvent.EventID == "4688" | [NRT_execute_base64_decodedpayload.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/NRT_execute_base64_decodedpayload.yaml) |
| analytic_rule | NRT Security Event log cleared | SecurityEvent.EventID == "1102" | [NRT_SecurityEventLogCleared.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/NRT_SecurityEventLogCleared.yaml) |
| analytic_rule | New EXE deployed via Default Domain or Default Dom | SecurityEvent.EventID == "4688" | [NewEXEdeployedviaDefaultDomainorDefaultDomainControllerPolicies.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/NewEXEdeployedviaDefaultDomainorDefaultDomainControllerPolicies.yaml) |
| analytic_rule | Non Domain Controller Active Directory Replication | SecurityEvent.EventID in "4624,4662" | [NonDCActiveDirectoryReplication.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/NonDCActiveDirectoryReplication.yaml) |
| analytic_rule | Potential Fodhelper UAC Bypass | SecurityEvent.EventID in "4657,4688" | [PotentialFodhelperUACBypass.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/PotentialFodhelperUACBypass.yaml) |
| analytic_rule | Potential re-named sdelete usage | SecurityEvent.EventID == "4688" | [Potentialre-namedsdeleteusage.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/Potentialre-namedsdeleteusage.yaml) |
| analytic_rule | Process Execution Frequency Anomaly | SecurityEvent.EventID == "4688" | [TimeSeriesAnomaly-ProcessExecutions.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/TimeSeriesAnomaly-ProcessExecutions.yaml) |
| analytic_rule | Scheduled Task Hide | SecurityEvent.EventID == "4657" | [ScheduleTaskHide.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/ScheduleTaskHide.yaml) |
| analytic_rule | Sdelete deployed via GPO and run recursively | SecurityEvent.EventID == "4688" | [SdeletedeployedviaGPOandrunrecursively.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/SdeletedeployedviaGPOandrunrecursively.yaml) |
| analytic_rule | SecurityEvent - Multiple authentication failures f | SecurityEvent.EventID in "4624,4625" | [MultipleFailedFollowedBySuccess.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/MultipleFailedFollowedBySuccess.yaml) |
| analytic_rule | Starting or Stopping HealthService to Avoid Detect | SecurityEvent.EventID in "4624,4656" | [StartStopHealthService.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Analytic%20Rules/StartStopHealthService.yaml) |
| hunting_query | AD Account Lockout | SecurityEvent.EventID == "4740" | [ADAccountLockouts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/ADAccountLockouts.yaml) |
| hunting_query | Commands executed by WMI on new hosts - potential  | SecurityEvent.EventID == "4688" | [CommandsexecutedbyWMIonnewhosts-potentialImpacket.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/CommandsexecutedbyWMIonnewhosts-potentialImpacket.yaml) |
| hunting_query | Crash dump disabled on host | SecurityEvent.EventID == "4657" | [Crashdumpdisabledonhost.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Crashdumpdisabledonhost.yaml) |
| hunting_query | Cscript script daily summary breakdown | SecurityEvent.EventID == "4688" | [cscript_summary.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/cscript_summary.yaml) |
| hunting_query | Decoy User Account Authentication Attempt | SecurityEvent.EventID in "4624,4625" | [DecoyUserAccountAuthenticationAttempt.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/DecoyUserAccountAuthenticationAttempt.yaml) |
| hunting_query | Discord download invoked from cmd line | SecurityEvent.EventID == "4688" | [Discorddownloadinvokedfromcmdline.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Discorddownloadinvokedfromcmdline.yaml) |
| hunting_query | Entropy for Processes for a given Host | SecurityEvent.EventID == "4688" | [ProcessEntropy.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/ProcessEntropy.yaml) |
| hunting_query | Enumeration of users and groups | SecurityEvent.EventID == "4688" | [enumeration_user_and_group.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/enumeration_user_and_group.yaml) |
| hunting_query | Exchange PowerShell Snapin Added | SecurityEvent.EventID == "4688" | [ExchangePowerShellSnapin.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/ExchangePowerShellSnapin.yaml) |
| hunting_query | Group added to Built in Domain Local or Global Gro | SecurityEvent.EventID in "4727,4728,4731,4732,4754,4756" | [GroupAddedToPrivlegeGroup.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/GroupAddedToPrivlegeGroup.yaml) |
| hunting_query | Host Exporting Mailbox and Removing Export | SecurityEvent.EventID == "4688" | [HostExportingMailboxAndRemovingExport.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/HostExportingMailboxAndRemovingExport.yaml) |
| hunting_query | Hosts Running a Rare Process | SecurityEvent.EventID == "4688" | [RareProcess_forWinHost.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/RareProcess_forWinHost.yaml) |
| hunting_query | Hosts Running a Rare Process with Commandline | SecurityEvent.EventID == "4688" | [RareProcessWithCmdLine.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/RareProcessWithCmdLine.yaml) |
| hunting_query | Hosts with new logons | SecurityEvent.EventID in "4624,4625" | [HostsWithNewLogons.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/HostsWithNewLogons.yaml) |
| hunting_query | Invoke-PowerShellTcpOneLine Usage. | SecurityEvent.EventID == "4688" | [Invoke-PowerShellTcpOneLine.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Invoke-PowerShellTcpOneLine.yaml) |
| hunting_query | KrbRelayUp Local Privilege Escalation Service Crea | Event.EventID == "7045"  \|  Event.Source == "Service Control Manager" | [KrbRelayUpServiceCreation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/KrbRelayUpServiceCreation.yaml) |
| hunting_query | Least Common Parent And Child Process Pairs | SecurityEvent.EventID == "4688" | [Least_Common_Parent_Child_Process.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Least_Common_Parent_Child_Process.yaml) |
| hunting_query | Least Common Processes Including Folder Depth | SecurityEvent.EventID == "4688" | [Least_Common_Process_With_Depth.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Least_Common_Process_With_Depth.yaml) |
| hunting_query | Least Common Processes by Command Line | SecurityEvent.EventID == "4688" | [Least_Common_Process_Command_Lines.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Least_Common_Process_Command_Lines.yaml) |
| hunting_query | Long lookback User Account Created and Deleted wit | SecurityEvent.EventID in "4720,4726" | [UserAccountCreatedDeleted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/UserAccountCreatedDeleted.yaml) |
| hunting_query | Multiple Explicit Credential Usage - 4648 events | SecurityEvent.EventID == "4648" | [MultipleExplicitCredentialUsage4648Events.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/MultipleExplicitCredentialUsage4648Events.yaml) |
| hunting_query | New Child Process of W3WP.exe | SecurityEvent.EventID == "4688" | [NewChildProcessOfW3WP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/NewChildProcessOfW3WP.yaml) |
| hunting_query | New PowerShell scripts encoded on the commandline | SecurityEvent.EventID == "4688" | [powershell_newencodedscipts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/powershell_newencodedscipts.yaml) |
| hunting_query | New processes observed in last 24 hours | SecurityEvent.EventID == "4688" | [new_processes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/new_processes.yaml) |
| hunting_query | Nishang Reverse TCP Shell in Base64 | SecurityEvent.EventID == "4688" | [NishangReverseTCPShellBase64.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/NishangReverseTCPShellBase64.yaml) |
| hunting_query | Potential Exploitation of MS-RPRN printer bug | SecurityEvent.EventID == "5145" | [MSRPRN_Printer_Bug_Exploitation.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/MSRPRN_Printer_Bug_Exploitation.yaml) |
| hunting_query | PowerShell downloads | SecurityEvent.EventID == "4688" | [powershell_downloads.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/powershell_downloads.yaml) |
| hunting_query | Powercat Download | SecurityEvent.EventID == "4688" | [PowerCatDownload.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/PowerCatDownload.yaml) |
| hunting_query | Rare Process Path | SecurityEvent.EventID == "4688" | [RareProcessPath.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/RareProcessPath.yaml) |
| hunting_query | Rare Processes Run by Service Accounts | SecurityEvent.EventID in "4624,4688" | [RareProcbyServiceAccount.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/RareProcbyServiceAccount.yaml) |
| hunting_query | Remote Task Creation/Update using Schtasks Process | SecurityEvent.EventID == "4688" | [RemoteScheduledTaskCreationUpdateviaSchtasks.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/RemoteScheduledTaskCreationUpdateviaSchtasks.yaml) |
| hunting_query | Service installation from user writable directory | Event.EventID == "7045"  \|  Event.Source == "Service Control Manager" | [ServiceInstallationFromUsersWritableDirectory.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/ServiceInstallationFromUsersWritableDirectory.yaml) |
| hunting_query | Summary of failed user logons by reason of failure | SecurityEvent.EventID == "4625" | [FailedUserLogons.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/FailedUserLogons.yaml) |
| hunting_query | Summary of user logons by logon type | SecurityEvent.EventID in "4624,4625" | [User Logons By Logon Type.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/User%20Logons%20By%20Logon%20Type.yaml) |
| hunting_query | Summary of users created using uncommon/undocument | SecurityEvent.EventID == "4688" | [persistence_create_account.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/persistence_create_account.yaml) |
| hunting_query | Suspected LSASS Dump | SecurityEvent.EventID == "4688" | [SuspectedLSASSDump.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/SuspectedLSASSDump.yaml) |
| hunting_query | Suspicious Enumeration using Adfind Tool | SecurityEvent.EventID == "4688" | [Suspicious_enumeration_using_adfind.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Suspicious_enumeration_using_adfind.yaml) |
| hunting_query | Suspicious Windows Login Outside Normal Hours | SecurityEvent.EventID in "4624,4625" | [Suspicious_Windows_Login_outside_normal_hours.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/Suspicious_Windows_Login_outside_normal_hours.yaml) |
| hunting_query | Suspicious command line tokens in LolBins or LolSc | SecurityEvent.EventID == "4688" | [SuspiciousCommandlineTokenLolbas.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/SuspiciousCommandlineTokenLolbas.yaml) |
| hunting_query | Uncommon processes - bottom 5% | SecurityEvent.EventID == "4688" | [uncommon_processes.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/uncommon_processes.yaml) |
| hunting_query | User Account added to Built in Sensitive or Privil | SecurityEvent.EventID in "4728,4732,4756" | [UserAccountAddedToPrivlegeGroup.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/UserAccountAddedToPrivlegeGroup.yaml) |
| hunting_query | User account added or removed from a security grou | SecurityEvent.EventID in "4728,4729,4732,4733,4746,4747,4751,4752,4756,4757,4761,4762" | [UserAdd_RemToGroupByUnauthorizedUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/UserAdd_RemToGroupByUnauthorizedUser.yaml) |
| hunting_query | User created by unauthorized user | SecurityEvent.EventID == "4720" | [UserCreatedByUnauthorizedUser.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/UserCreatedByUnauthorizedUser.yaml) |
| hunting_query | VIP account more than 6 failed logons in 10 | SecurityEvent.EventID == "4625" | [CustomUserList_FailedLogons.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/CustomUserList_FailedLogons.yaml) |
| hunting_query | VIP account more than 6 failed logons in 10 | SecurityEvent.EventID == "4625" | [VIPAccountFailedLogons.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/VIPAccountFailedLogons.yaml) |
| hunting_query | Windows System Shutdown/Reboot(Sysmon) | Event.EventID == "1"  \|  Event.EventLog has "shutdown.exe"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [WindowsSystemShutdownReboot.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/WindowsSystemShutdownReboot.yaml) |
| hunting_query | Windows System Time changed on hosts | SecurityEvent.EventID == "4616" | [WindowsSystemTimeChange.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Hunting%20Queries/WindowsSystemTimeChange.yaml) |
| workbook | EventAnalyzer | SecurityEvent.EventID in "4656,4657,4658,4660,4661,4663,4664,4670,4671,4673,4674,4690,4691,4698,4699,4700,4701,4702,4715,4719,4817,4902,4904,4905,4906,4907,4908,4912,4985,5031,5039,5051,5140,5142,5143,5144,5148,5149,5150,5151,5154,5155,5156,5157,5158,5159,5168,5888,5889,5890" | [EventAnalyzer.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Security%20Events/Workbooks/EventAnalyzer.json) |

### ZeroTrust(TIC3.0)

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| workbook | ZeroTrustTIC3 | AuditLogs.OperationName in "Add member to role,Add user,ApplicationGatewayFirewall,AzureFirewallIDSLog,AzureFirewallThreatIntelLog,NetworkSecurityGroupEvents,Reset user password,Update user"  \|  AuditLogs.OperationName contains "PIM"  \|  AzureDiagnostics.Category in "ApplicationGatewayFirewallLog,AzureFirewallApplicationRule,AzureFirewallDnsProxy,AzureFirewallNetworkRule,DDoSMitigationReports,FrontdoorWebApplicationFirewallLog,NetworkSecurityGroupEvent,WebApplicationFirewallLogs,kube-audit"  \|  AzureDiagnostics.Category contains "SQL"  \|  AzureDiagnostics.ResourceProvider == "MICROSOFT.KEYVAULT"  \|  AzureDiagnostics.ResourceType in "APPLICATIONGATEWAYS,AZUREFIREWALLS,CDNWEBAPPLICATIONFIREWALLPOLICIES,FRONTDOORS,PROFILES,PUBLICIPADDRESSES"  \|  EmailEvents.ActionType in "Add member to role,Add user,InteractiveLogon,RemoteInteractiveLogon,Reset user password,ResourceAccess,Sign-in,Update user"  \|  OfficeActivity.RecordType == "MicrosoftTeams" | [ZeroTrustTIC3.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ZeroTrust%28TIC3.0%29/Workbooks/ZeroTrustTIC3.json) |

### Zscaler Internet Access

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | Discord CDN Risky File Download | CommonSecurityLog.DeviceVendor =~ "ZScaler" | [DiscordCDNRiskyDownload.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Analytic%20Rules/DiscordCDNRiskyDownload.yaml) |
| analytic_rule | Request for single resource on domain | CommonSecurityLog.DeviceVendor =~ "Zscaler" | [Zscaler-LowVolumeDomainRequests.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Analytic%20Rules/Zscaler-LowVolumeDomainRequests.yaml) |
| workbook | ZscalerFirewall | CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Allow"  \|  CommonSecurityLog.DeviceProduct == "NSSFWlog" | [ZscalerFirewall.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Workbooks/ZscalerFirewall.json) |
| workbook | ZscalerOffice365Apps | CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Allow"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [ZscalerOffice365Apps.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Workbooks/ZscalerOffice365Apps.json) |
| workbook | ZscalerThreats | CommonSecurityLog.DeviceEventClassID == "Blocked"  \|  CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Block"  \|  CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [ZscalerThreats.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Workbooks/ZscalerThreats.json) |
| workbook | ZscalerWebOverview | CommonSecurityLog.DeviceEventClassID in "Allow,Allowed"  \|  CommonSecurityLog.DeviceEventClassID !contains "Allow"  \|  CommonSecurityLog.DeviceEventClassID contains "Allow"  \|  CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [ZscalerWebOverview.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Zscaler%20Internet%20Access/Workbooks/ZscalerWebOverview.json) |

### vArmour Application Controller

| Type | Name | Filter Fields | File |
|------|------|---------------|------|
| analytic_rule | vArmour AppController - SMB Realm Traversal | CommonSecurityLog.DeviceProduct == "AC"  \|  CommonSecurityLog.DeviceVendor == "vArmour" | [vArmourApplicationControllerSMBRealmTraversal.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/vArmour%20Application%20Controller/Analytic%20Rules/vArmourApplicationControllerSMBRealmTraversal.yaml) |
| workbook | vArmour_AppContoller_Workbook | CommonSecurityLog.DeviceProduct == "AC"  \|  CommonSecurityLog.DeviceVendor == "vArmour" | [vArmour_AppContoller_Workbook.json](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/vArmour%20Application%20Controller/Workbooks/vArmour_AppContoller_Workbook.json) |


## ASIM Parsers with Filter Fields

Total: 81 parsers

### AuditEvent Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimAuditEventBarracudaCEF | Barracuda WAF | CommonSecurityLog.DeviceProduct in "WAAS,WAF"  \|  CommonSecurityLog.DeviceVendor startswith "Barracuda" | [Parsers\ASimAuditEvent\Parsers\ASimAuditEventBarracudaCEF.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuditEvent/Parsers/ASimAuditEventBarracudaCEF.yaml) |
| ASimAuditEventCiscoISE | Cisco ISE | Syslog.ProcessName has_any "CISE,CSCO" | [Parsers\ASimAuditEvent\Parsers\ASimAuditEventCiscoISE.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuditEvent/Parsers/ASimAuditEventCiscoISE.yaml) |
| ASimAuditEventCrowdStrikeFalconHost | CrowdStrike Falcon Endpoint Pr | CommonSecurityLog.DeviceEventClassID == "UserActivityAuditEvent"  \|  CommonSecurityLog.DeviceProduct == "FalconHost"  \|  CommonSecurityLog.DeviceVendor == "CrowdStrike" | [Parsers\ASimAuditEvent\Parsers\ASimAuditEventCrowdStrikeFalconHost.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuditEvent/Parsers/ASimAuditEventCrowdStrikeFalconHost.yaml) |
| ASimAuditEventInfobloxBloxOne | Infoblox BloxOne | CommonSecurityLog.DeviceEventClassID has "AUDIT"  \|  CommonSecurityLog.DeviceVendor == "Infoblox" | [Parsers\ASimAuditEvent\Parsers\ASimAuditEventInfobloxBloxOne.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuditEvent/Parsers/ASimAuditEventInfobloxBloxOne.yaml) |
| ASimAuditEventMicrosoftExchangeAdmin365 | Microsoft SharePoint | OfficeActivity.RecordType == "ExchangeAdmin" | [Parsers\ASimAuditEvent\Parsers\ASimAuditEventMicrosoftExchangeAdmin365.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuditEvent/Parsers/ASimAuditEventMicrosoftExchangeAdmin365.yaml) |
| ASimAuditEventMicrosoftWindowsEvents | Microsoft Windows | WindowsEvent.Provider == "Microsoft-Windows-Eventlog" | [Parsers\ASimAuditEvent\Parsers\ASimAuditEventMicrosoftWindowsEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuditEvent/Parsers/ASimAuditEventMicrosoftWindowsEvents.yaml) |

### Authentication Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimAuthenticationAWSCloudTrail | AWS | AWSCloudTrail.EventName == "ConsoleLogin" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationAWSCloudTrail.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationAWSCloudTrail.yaml) |
| ASimAuthenticationBarracudaWAF | Barracuda WAF | CommonSecurityLog.DeviceProduct in "WAAS,WAF"  \|  CommonSecurityLog.DeviceVendor startswith "Barracuda" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationBarracudaWAF.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationBarracudaWAF.yaml) |
| ASimAuthenticationCiscoASA | Cisco Adaptive Security Applia | CommonSecurityLog.DeviceProduct == "ASA"  \|  CommonSecurityLog.DeviceVendor =~ "Cisco" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationCiscoASA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationCiscoASA.yaml) |
| ASimAuthenticationCiscoISE | Cisco ISE | Syslog.ProcessName has_any "CISE,CSCO" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationCiscoISE.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationCiscoISE.yaml) |
| ASimAuthenticationCrowdStrikeFalconHost | CrowdStrike Falcon Endpoint Pr | CommonSecurityLog.DeviceEventClassID in "twoFactorAuthenticate,userAuthenticate"  \|  CommonSecurityLog.DeviceProduct == "FalconHost"  \|  CommonSecurityLog.DeviceVendor == "CrowdStrike" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationCrowdStrikeFalconHost.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationCrowdStrikeFalconHost.yaml) |
| ASimAuthenticationMicrosoftWindowsEvent | Windows Security Events | WindowsEvent.EventID in "4624,4625,4634"  \|  WindowsEvent.Provider == "Microsoft-Windows-Security-Auditing" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationMicrosoftWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationMicrosoftWindowsEvent.yaml) |
| ASimAuthenticationPaloAltoCortexDataLake | Palo Alto Cortex Data Lake | CommonSecurityLog.DeviceEventClassID == "AUTH"  \|  CommonSecurityLog.DeviceProduct == "LF"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationPaloAltoCortexDataLake.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationPaloAltoCortexDataLake.yaml) |
| ASimAuthenticationSshd | OpenSSH | Syslog.ProcessName == "sshd"  \|  Syslog.SyslogMessage has "Failed"  \|  Syslog.SyslogMessage has "but this does not map back to the address"  \|  Syslog.SyslogMessage has "key RSA"  \|  Syslog.SyslogMessage has "publickey"  \|  Syslog.SyslogMessage startswith "Accepted"  \|  Syslog.SyslogMessage startswith "Failed"  \|  Syslog.SyslogMessage startswith "Invalid user"  \|  Syslog.SyslogMessage startswith "Nasty PTR record"  \|  Syslog.SyslogMessage startswith "Timeout"  \|  Syslog.SyslogMessage startswith "message repeated"  \|  Syslog.SyslogMessage startswith "reverse mapping checking getaddrinfo for" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationSshd.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationSshd.yaml) |
| ASimAuthenticationSu | su | Syslog.ProcessName == "su"  \|  Syslog.SyslogMessage has_all "pam_unix(su"  \|  Syslog.SyslogMessage startswith "FAILED SU"  \|  Syslog.SyslogMessage startswith "Successful su for" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationSu.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationSu.yaml) |
| ASimAuthenticationSudo | sudo | Syslog.ProcessName == "sudo"  \|  Syslog.SyslogMessage has "COMMAND="  \|  Syslog.SyslogMessage has "TTY="  \|  Syslog.SyslogMessage has "USER="  \|  Syslog.SyslogMessage has "incorrect password attempts"  \|  Syslog.SyslogMessage has "session closed for user"  \|  Syslog.SyslogMessage has "user NOT in sudoers" | [Parsers\ASimAuthentication\Parsers\ASimAuthenticationSudo.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimAuthentication/Parsers/ASimAuthenticationSudo.yaml) |

### DhcpEvent Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimDhcpEventInfobloxBloxOne | Infoblox BloxOne | CommonSecurityLog.DeviceEventClassID has "DHCP"  \|  CommonSecurityLog.DeviceVendor == "Infoblox" | [Parsers\ASimDhcpEvent\Parsers\ASimDhcpEventInfobloxBloxOne.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDhcpEvent/Parsers/ASimDhcpEventInfobloxBloxOne.yaml) |

### Dns Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimDnsAzureFirewall | Azure Firewall | AzureDiagnostics.Category == "AzureFirewallDnsProxy"  \|  AzureDiagnostics.ResourceType == "AZUREFIREWALLS" | [Parsers\ASimDns\Parsers\ASimDnsAzureFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsAzureFirewall.yaml) |
| ASimDnsFortinetFortiGate | Fortinet FortiGate | CommonSecurityLog.DeviceEventClassID endswith "54000"  \|  CommonSecurityLog.DeviceEventClassID endswith "54200"  \|  CommonSecurityLog.DeviceEventClassID endswith "54400"  \|  CommonSecurityLog.DeviceEventClassID endswith "54401"  \|  CommonSecurityLog.DeviceEventClassID endswith "54600"  \|  CommonSecurityLog.DeviceEventClassID endswith "54601"  \|  CommonSecurityLog.DeviceEventClassID endswith "54800"  \|  CommonSecurityLog.DeviceEventClassID endswith "54801"  \|  CommonSecurityLog.DeviceEventClassID endswith "54802"  \|  CommonSecurityLog.DeviceEventClassID endswith "54803"  \|  CommonSecurityLog.DeviceEventClassID endswith "54804"  \|  CommonSecurityLog.DeviceEventClassID endswith "54805"  \|  CommonSecurityLog.DeviceProduct startswith "Fortigate"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [Parsers\ASimDns\Parsers\ASimDnsFortinetFortigate.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsFortinetFortigate.yaml) |
| ASimDnsInfobloxBloxOne | Infoblox BloxOne | CommonSecurityLog.DeviceEventClassID has "DNS"  \|  CommonSecurityLog.DeviceVendor == "Infoblox" | [Parsers\ASimDns\Parsers\ASimDnsInfobloxBloxOne.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsInfobloxBloxOne.yaml) |
| ASimDnsInfobloxNIOS | Infoblox NIOS | Syslog.ProcessName == "named"  \|  Syslog.SyslogMessage !has "response:"  \|  Syslog.SyslogMessage has_all "client" | [Parsers\ASimDns\Parsers\ASimDnsInfobloxNIOS.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsInfobloxNIOS.yaml) |
| ASimDnsMicrosoftSysmon | Microsoft Windows Events Sysmo | Event.EventID == "22"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [Parsers\ASimDns\Parsers\ASimDnsMicrosoftSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsMicrosoftSysmon.yaml) |
| ASimDnsMicrosoftSysmonWindowsEvent | Microsoft Windows Events Sysmo | WindowsEvent.EventID == "22"  \|  WindowsEvent.Provider == "Microsoft-Windows-Sysmon" | [Parsers\ASimDns\Parsers\ASimDnsMicrosoftSysmonWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsMicrosoftSysmonWindowsEvent.yaml) |
| ASimDnsZscalerZIA | Zscaler ZIA DNS | CommonSecurityLog.DeviceProduct == "NSSDNSlog" | [Parsers\ASimDns\Parsers\ASimDnsZscalerZIA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimDns/Parsers/ASimDnsZscalerZIA.yaml) |

### FileEvent Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimFileEventLinuxSysmonFileCreated | Microsoft Sysmon for Linux | Syslog.SyslogMessage has_all "<Provider Name=" | [Parsers\ASimFileEvent\Parsers\ASimFileEventLinuxSysmonFileCreated.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventLinuxSysmonFileCreated.yaml) |
| ASimFileEventLinuxSysmonFileDeleted | Microsoft Sysmon for Linux | Syslog.SyslogMessage has "<Provider Name="  \|  Syslog.SyslogMessage has_any "<EventID>23</EventID>,<EventID>26</EventID>" | [Parsers\ASimFileEvent\Parsers\ASimFileEventLinuxSysmonFileDeleted.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventLinuxSysmonFileDeleted.yaml) |
| ASimFileEventMicrosoftSecurityEvents | Microsoft Windows Events | SecurityEvent.EventID == "4663" | [Parsers\ASimFileEvent\Parsers\ASimFileEventMicrosoftSecurityEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventMicrosoftSecurityEvents.yaml) |
| ASimFileEventMicrosoftSharePoint | Microsoft SharePoint | OfficeActivity.RecordType == "SharePointFileOperation" | [Parsers\ASimFileEvent\Parsers\ASimFileEventMicrosoftSharePoint.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventMicrosoftSharePoint.yaml) |
| ASimFileEventMicrosoftSysmon | Windows Sysmon | Event.EventID in "11,23,26"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [Parsers\ASimFileEvent\Parsers\ASimFileEventMicrosoftSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventMicrosoftSysmon.yaml) |
| ASimFileEventMicrosoftSysmonWindowsEvent | Windows Sysmon | WindowsEvent.EventID in "11,23,26"  \|  WindowsEvent.Provider == "Microsoft-Windows-Sysmon" | [Parsers\ASimFileEvent\Parsers\ASimFileEventMicrosoftSysmonWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventMicrosoftSysmonWindowsEvent.yaml) |
| ASimFileEventMicrosoftWindowsEvents | Microsoft Windows Events | WindowsEvent.EventID == "4663" | [Parsers\ASimFileEvent\Parsers\ASimFileEventMicrosoftWindowsEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimFileEvent/Parsers/ASimFileEventMicrosoftWindowsEvents.yaml) |

### NetworkSession Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimNetworkSessionAppGateSDP | AppGate SDP | Syslog.ProcessName in "cz-sessiond,cz-vpnd"  \|  Syslog.SyslogMessage has_all "[AUDIT]"  \|  Syslog.SyslogMessage has_any ":" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionAppGateSDP.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionAppGateSDP.yaml) |
| ASimNetworkSessionAzureFirewall | Azure Firewall | AzureDiagnostics.Category == "AzureFirewallNetworkRule" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionAzureFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionAzureFirewall.yaml) |
| ASimNetworkSessionBarracudaCEF | Barracuda WAF | CommonSecurityLog.DeviceProduct in "WAAS,WAF"  \|  CommonSecurityLog.DeviceVendor startswith "Barracuda" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionBarracudaCEF.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionBarracudaCEF.yaml) |
| ASimNetworkSessionCheckPointFirewall | CheckPointFirewall | CommonSecurityLog.DeviceProduct == "VPN-1 & FireWall-1"  \|  CommonSecurityLog.DeviceVendor == "CheckPoint" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionCheckPointFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionCheckPointFirewall.yaml) |
| ASimNetworkSessionCiscoASA | CiscoASA | CommonSecurityLog.DeviceEventClassID in "106001,106002,106006,106007,106010,106012,106013,106014,106015,106016,106017,106018,106020,106021,106022,106023,106100,302013,302014,302015,302016,302020,302021,710002,710003,710004,710005"  \|  CommonSecurityLog.DeviceProduct == "ASA"  \|  CommonSecurityLog.DeviceVendor == "Cisco" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionCiscoASA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionCiscoASA.yaml) |
| ASimNetworkSessionCiscoFirepower | Cisco Firepower | CommonSecurityLog.DeviceEventClassID has "INTRUSION:400"  \|  CommonSecurityLog.DeviceEventClassID has "PV:112"  \|  CommonSecurityLog.DeviceEventClassID has "RNA:1003:1"  \|  CommonSecurityLog.DeviceEventClassID has_any "INTRUSION:400,PV:112,RNA:1003:1"  \|  CommonSecurityLog.DeviceProduct == "Firepower"  \|  CommonSecurityLog.DeviceVendor == "Cisco" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionCiscoFirepower.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionCiscoFirepower.yaml) |
| ASimNetworkSessionCiscoISE | Cisco ISE | Syslog.ProcessName has_any "CISE,CSCO" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionCiscoISE.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionCiscoISE.yaml) |
| ASimNetworkSessionCrowdStrikeFalconHost | CrowdStrike Falcon Endpoint Pr | CommonSecurityLog.DeviceEventClassID in "FirewallMatchEvent,Network Access In A Detection Summary Event"  \|  CommonSecurityLog.DeviceEventClassID has "Network Access In A Detection Summary Event"  \|  CommonSecurityLog.DeviceProduct == "FalconHost"  \|  CommonSecurityLog.DeviceVendor == "CrowdStrike" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionCrowdStrikeFalconHost.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionCrowdStrikeFalconHost.yaml) |
| ASimNetworkSessionForcePointFirewall | ForcePointFirewall | CommonSecurityLog.DeviceEventClassID in "70734,76508,76509"  \|  CommonSecurityLog.DeviceEventClassID != "0"  \|  CommonSecurityLog.DeviceEventClassID !in "70383,70393,70734,71009,71040"  \|  CommonSecurityLog.DeviceProduct == "Firewall"  \|  CommonSecurityLog.DeviceVendor == "FORCEPOINT" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionForcePointFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionForcePointFirewall.yaml) |
| ASimNetworkSessionFortinetFortiGate | Fortinet FortiGate | CommonSecurityLog.DeviceProduct startswith "FortiGate"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionFortinetFortiGate.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionFortinetFortiGate.yaml) |
| ASimNetworkSessionLinuxSysmon | Sysmon for Linux | Syslog.SyslogMessage has_all "<Provider Name=" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionMicrosoftLinuxSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionMicrosoftLinuxSysmon.yaml) |
| ASimNetworkSessionMicrosoft365Defender | M365 Defender for Endpoint | DeviceNetworkEvents.ActionType == "ConnectionFailed" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionMicrosoft365Defender.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionMicrosoft365Defender.yaml) |
| ASimNetworkSessionMicrosoftSecurityEventFirewall | Windows Firewall | SecurityEvent.EventID in "5152,5154,5155,5156,5157,5158,5159" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionMicrosoftSecurityEventFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionMicrosoftSecurityEventFirewall.yaml) |
| ASimNetworkSessionMicrosoftSysmon | Windows Sysmon | Event.EventID == "3"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionMicrosoftSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionMicrosoftSysmon.yaml) |
| ASimNetworkSessionMicrosoftSysmonWindowsEvent | Windows Sysmon | WindowsEvent.EventID == "3"  \|  WindowsEvent.Provider == "Microsoft-Windows-Sysmon" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionMicrosoftSysmonWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionMicrosoftSysmonWindowsEvent.yaml) |
| ASimNetworkSessionMicrosoftWindowsEventFirewall | Windows Firewall | WindowsEvent.EventID in "5154,5155,5156,5158,5159" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionMicrosoftWindowsEventFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionMicrosoftWindowsEventFirewall.yaml) |
| ASimNetworkSessionNative | Native | ASimNetworkSessionLogs.EventType in "EndpointNetworkSession,L2NetworkSession" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionNative.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionNative.yaml) |
| ASimNetworkSessionPaloAltoCEF | Palo Alto PanOS | CommonSecurityLog.DeviceProduct == "PAN-OS"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionPaloAltoCEF.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionPaloAltoCEF.yaml) |
| ASimNetworkSessionPaloAltoCortexDataLake | Palo Alto Cortex Data Lake | CommonSecurityLog.DeviceEventClassID == "TRAFFIC"  \|  CommonSecurityLog.DeviceProduct == "LF"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionPaloAltoCortexDataLake.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionPaloAltoCortexDataLake.yaml) |
| ASimNetworkSessionSonicWallFirewall | SonicWall | CommonSecurityLog.DeviceVendor == "SonicWall" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionSonicWallFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionSonicWallFirewall.yaml) |
| ASimNetworkSessionWatchGuardFirewareOS | WatchGuard Fireware OS | Syslog.SyslogMessage !has "3000-0151"  \|  Syslog.SyslogMessage !has "icmp"  \|  Syslog.SyslogMessage !has "igmp"  \|  Syslog.SyslogMessage !has "msg="  \|  Syslog.SyslogMessage has "3000-0151"  \|  Syslog.SyslogMessage has "icmp"  \|  Syslog.SyslogMessage has "igmp"  \|  Syslog.SyslogMessage has_any "msg_id=" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionWatchGuardFirewareOS.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionWatchGuardFirewareOS.yaml) |
| ASimNetworkSessionZscalerZIA | Zscaler ZIA Firewall | CommonSecurityLog.DeviceProduct == "NSSFWlog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [Parsers\ASimNetworkSession\Parsers\ASimNetworkSessionzScalerZIA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimNetworkSession/Parsers/ASimNetworkSessionzScalerZIA.yaml) |

### ProcessEvent Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimProcessCreateLinuxSysmon | Sysmon for Linux | Syslog.SyslogMessage has_all "<Provider Name=" | [Parsers\ASimProcessEvent\Parsers\ASimProcessCreateLinuxSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessCreateLinuxSysmon.yaml) |
| ASimProcessCreateMicrosoftSecurityEvents | Security Events | SecurityEvent.EventID == "4688" | [Parsers\ASimProcessEvent\Parsers\ASimProcessCreateMicrosoftSecurityEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessCreateMicrosoftSecurityEvents.yaml) |
| ASimProcessCreateMicrosoftWindowsEvents | Security Events | WindowsEvent.EventID == "4688" | [Parsers\ASimProcessEvent\Parsers\ASimProcessCreateMicrosoftWindowsEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessCreateMicrosoftWindowsEvents.yaml) |
| ASimProcessEventCreateMicrosoftSysmon | Sysmon | Event.EventID == "1"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [Parsers\ASimProcessEvent\Parsers\ASimProcessCreateMicrosoftSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessCreateMicrosoftSysmon.yaml) |
| ASimProcessEventCreateMicrosoftSysmonWindowsEvent | Sysmon | WindowsEvent.EventID == "1"  \|  WindowsEvent.Provider == "Microsoft-Windows-Sysmon" | [Parsers\ASimProcessEvent\Parsers\ASimProcessCreateMicrosoftSysmonWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessCreateMicrosoftSysmonWindowsEvent.yaml) |
| ASimProcessEventTerminateMicrosoftSysmon | Microsoft Windows Events Sysmo | Event.EventID == "5"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [Parsers\ASimProcessEvent\Parsers\ASimProcessTerminateMicrosoftSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessTerminateMicrosoftSysmon.yaml) |
| ASimProcessEventTerminateMicrosoftSysmonWindowsEvent | Microsoft Windows Events Sysmo | WindowsEvent.EventID == "5"  \|  WindowsEvent.Provider == "Microsoft-Windows-Sysmon" | [Parsers\ASimProcessEvent\Parsers\ASimProcessTerminateMicrosoftSysmonWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessTerminateMicrosoftSysmonWindowsEvent.yaml) |
| ASimProcessTerminateLinuxSysmon | Sysmon for Linux | Syslog.SyslogMessage has_all "<Provider Name=" | [Parsers\ASimProcessEvent\Parsers\ASimProcessTerminateLinuxSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessTerminateLinuxSysmon.yaml) |
| ASimProcessTerminateMicrosoftSecurityEvents | Security Events | SecurityEvent.EventID == "4689" | [Parsers\ASimProcessEvent\Parsers\ASimProcessTerminateMicrosoftSecurityEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessTerminateMicrosoftSecurityEvents.yaml) |
| ASimProcessTerminateMicrosoftWindowsEvents | Security Events | WindowsEvent.EventID == "4689" | [Parsers\ASimProcessEvent\Parsers\ASimProcessTerminateMicrosoftWindowsEvents.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimProcessEvent/Parsers/ASimProcessTerminateMicrosoftWindowsEvents.yaml) |

### RegistryEvent Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimRegistryEventMicrosoft365D | Microsoft 365 Defender for End | DeviceRegistryEvents.ActionType in "RegistryKeyDeleted,RegistryKeyRenamed,RegistryValueDeleted,RegistryValueSet" | [Parsers\ASimRegistryEvent\Parsers\ASimRegistryEventMicrosoft365D.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimRegistryEvent/Parsers/ASimRegistryEventMicrosoft365D.yaml) |
| ASimRegistryEventMicrosoftSecurityEvent | Security Events | SecurityEvent.EventID in "4657,4663" | [Parsers\ASimRegistryEvent\Parsers\ASimRegistryEventMicrosoftSecurityEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimRegistryEvent/Parsers/ASimRegistryEventMicrosoftSecurityEvent.yaml) |
| ASimRegistryEventMicrosoftSysmon | Microsoft Sysmon | Event.EventID in "12,13,14"  \|  Event.Source == "Microsoft-Windows-Sysmon" | [Parsers\ASimRegistryEvent\Parsers\ASimRegistryEventMicrosoftSysmon.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimRegistryEvent/Parsers/ASimRegistryEventMicrosoftSysmon.yaml) |
| ASimRegistryEventMicrosoftSysmonWindowsEvent | Microsoft Sysmon | WindowsEvent.EventID in "12,13,14"  \|  WindowsEvent.Provider == "Microsoft-Windows-Sysmon" | [Parsers\ASimRegistryEvent\Parsers\ASimRegistryEventMicrosoftSysmonWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimRegistryEvent/Parsers/ASimRegistryEventMicrosoftSysmonWindowsEvent.yaml) |
| ASimRegistryEventMicrosoftWindowsEvent | Security Events | WindowsEvent.EventID in "4657,4663" | [Parsers\ASimRegistryEvent\Parsers\ASimRegistryEventMicrosoftWindowsEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimRegistryEvent/Parsers/ASimRegistryEventMicrosoftWindowsEvent.yaml) |

### UserManagement Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimUserManagementCiscoISE | Cisco ISE | Syslog.ProcessName has_any "CISE,CSCO" | [Parsers\ASimUserManagement\Parsers\ASimUserManagementCiscoISE.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimUserManagement/Parsers/ASimUserManagementCiscoISE.yaml) |
| ASimUserManagementLinuxAuthpriv | Microsoft | Syslog.Facility == "authpriv"  \|  Syslog.ProcessName in "gpasswd,groupadd,groupdel,groupmod,useradd,userdel,usermod" | [Parsers\ASimUserManagement\Parsers\ASimUserManagementLinuxAuthpriv.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimUserManagement/Parsers/ASimUserManagementLinuxAuthpriv.yaml) |
| ASimUserManagementMicrosoftSecurityEvent | Microsoft Security Event | SecurityEvent.EventID in "4744,4748,4749,4753,4759,4763" | [Parsers\ASimUserManagement\Parsers\ASimUserManagementMicrosoftSecurityEvent.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimUserManagement/Parsers/ASimUserManagementMicrosoftSecurityEvent.yaml) |

### WebSession Schema

| Parser Name | Product | Filter Fields | File |
|-------------|---------|---------------|------|
| ASimWebSessionBarracudaCEF | Barracuda WAF | CommonSecurityLog.DeviceProduct in "WAAS,WAF"  \|  CommonSecurityLog.DeviceVendor startswith "Barracuda" | [Parsers\ASimWebSession\Parsers\ASimWebSessionBarracudaCEF.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionBarracudaCEF.yaml) |
| ASimWebSessionCiscoFirepower | Cisco Firepower | CommonSecurityLog.DeviceEventClassID in "File:500:1,FileMalware:502:1,FireAMP:125:1"  \|  CommonSecurityLog.DeviceEventClassID has "File:500:1"  \|  CommonSecurityLog.DeviceEventClassID has "FileMalware:502:1"  \|  CommonSecurityLog.DeviceProduct == "Firepower"  \|  CommonSecurityLog.DeviceVendor == "Cisco" | [Parsers\ASimWebSession\Parsers\ASimWebSessionCiscoFirepower.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionCiscoFirepower.yaml) |
| ASimWebSessionCitrixNetScaler | Citrix NetScaler | CommonSecurityLog.DeviceEventClassID == "APPFW"  \|  CommonSecurityLog.DeviceProduct == "NetScaler"  \|  CommonSecurityLog.DeviceVendor == "Citrix" | [Parsers\ASimWebSession\Parsers\ASimWebSessionCitrixNetScaler.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionCitrixNetScaler.yaml) |
| ASimWebSessionF5ASM | F5 BIG-IP Application Security | CommonSecurityLog.DeviceProduct == "ASM"  \|  CommonSecurityLog.DeviceVendor == "F5" | [Parsers\ASimWebSession\Parsers\ASimWebSessionF5ASM.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionF5ASM.yaml) |
| ASimWebSessionFortinetFortiGate | Fortinet FortiGate | CommonSecurityLog.DeviceProduct startswith "Fortigate"  \|  CommonSecurityLog.DeviceVendor == "Fortinet" | [Parsers\ASimWebSession\Parsers\ASimWebSessionFortinetFortiGate.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionFortinetFortiGate.yaml) |
| ASimWebSessionNative | Native | ASimWebSessionLogs.EventType in "EndpointNetworkSession,HTTPSession" | [Parsers\ASimWebSession\Parsers\ASimWebSessionNative.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionNative.yaml) |
| ASimWebSessionPaloAltoCEF | Palo Alto Networks | CommonSecurityLog.DeviceEventClassID == "url"  \|  CommonSecurityLog.DeviceProduct == "PAN-OS"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Parsers\ASimWebSession\Parsers\ASimWebSessionPaloAltoCEF.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionPaloAltoCEF.yaml) |
| ASimWebSessionPaloAltoCortexDataLake | Palo Alto Cortex Data Lake | CommonSecurityLog.DeviceEventClassID == "THREAT"  \|  CommonSecurityLog.DeviceProduct == "LF"  \|  CommonSecurityLog.DeviceVendor == "Palo Alto Networks" | [Parsers\ASimWebSession\Parsers\ASimWebSessionPaloAltoCortexDataLake.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionPaloAltoCortexDataLake.yaml) |
| ASimWebSessionSonicWallFirewall | SonicWall | CommonSecurityLog.DeviceVendor == "SonicWall" | [Parsers\ASimWebSession\Parsers\ASimWebSessionSonicWallFirewall.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionSonicWallFirewall.yaml) |
| ASimWebSessionZscalerZIA | Zscaler ZIA | CommonSecurityLog.DeviceProduct == "NSSWeblog"  \|  CommonSecurityLog.DeviceVendor == "Zscaler" | [Parsers\ASimWebSession\Parsers\ASimWebSessionzScalerZIA.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Parsers/ASimWebSession/Parsers/ASimWebSessionzScalerZIA.yaml) |

