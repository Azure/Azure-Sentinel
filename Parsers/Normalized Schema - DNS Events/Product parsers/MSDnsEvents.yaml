Parser:
  Title: Microsoft DNS
  Version: '0.0'
  LastUpdated: May 10, 2021
Product:
  Name: MS DNS Events
Normalization:
  Schema: DnsEvents
  Version: '1.0.0'
References:
- Title: Using functions
  Link: https://docs.microsoft.com
- Title: Tech Community
  Link: https://techcommunity.microsoft.com
Description: |
  TODO
ParserName: MSDnsEvents_DnsEvents_Normalized
ParserQuery: |
  let MSDNSEvents=(){
  DnsEvents
  | extend 
  EventMessage = Message
  ,EventSeverity = Severity
  ,EventType = TaskCategory
  ,EventResult = Result
  ,EventResultDetails = ResultCode
  ,EventReportUrl = ReportReferenceLink
  ,SrcIpAddr = ClientIP
  ,DnsResponseName = IPAddresses
  ,DnsResponseCount = iff( isempty (IPAddresses) ,0, array_length(split(IPAddresses,',')))
  ,MessageType = QueryType
  ,DnsQuery = Name
  ,DnsMultipleResponses = split(IPAddresses,',')
  ,DnsQueryType = QueryType
  ,DnsResponseCode = ResultCode
  ,EventSubType = SubType
  ,EventVendor = "Microsoft"
  ,EventProduct = "Microsoft DNS Server"
  ,DvcHostname = Computer
  ,EventResourceId = _ResourceId};
  MSDNSEvents