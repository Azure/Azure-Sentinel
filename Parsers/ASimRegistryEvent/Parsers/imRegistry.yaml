Parser:
  Title: Registry Event ASIM Parser
  Version: '0.1.2'
  LastUpdated: Oct 10, 2023
Product:
  Name: Source Agnostic
Normalization:
  Schema: RegistryEvent
  Version: '0.1.2'
References:
- Title: ASIM Registry Schema
  Link: https://aka.ms/ASimRegistryEventDoc
- Title: ASIM
  Link: https:/aka.ms/AboutASIM
Description: |
  This ASIM parser supports normalizing Registry Event logs from all supported sources to the ASIM Registry Event normalized schema.
ParserName: imRegistry
EquivalentBuiltInParser: _Im_RegistryEvent 
ParserParams:
  - Name: starttime
    Type: datetime
    Default: datetime(null)
  - Name: endtime
    Type: datetime
    Default: datetime(null)
  - Name: eventtype_in
    Type: dynamic
    Default: dynamic([])
  - Name: actorusername_has_any
    Type: dynamic
    Default: dynamic([])
  - Name: registrykey_has_any
    Type: dynamic
    Default: dynamic([])
  - Name: registryvalue_has_any
    Type: dynamic
    Default: dynamic([])
  - Name: registrydata_has_any
    Type: dynamic
    Default: dynamic([])
  - Name: dvchostname_has_any
    Type: dynamic
    Default: dynamic([])
  - Name: disabled
    Type: bool
    Default: false
Parsers:
  - _Im_RegistryEvent_Empty
  # - _Im_RegistryEvent_MicrosoftSecurityEvents // Deprecated
  - _Im_RegistryEvent_Microsoft365D
  - _Im_RegistryEvent_MicrosoftSysmon
  - _Im_RegistryEvent_MicrosoftWindowsEvent
  - _Im_RegistryEvent_SentinelOne
ParserQuery: |
  union isfuzzy=true
    vimRegistryEventEmpty,
    vimRegistryEventMicrosoft365D (starttime = starttime, endtime = endtime, eventtype_in = eventtype_in, actorusername_has_any = actorusername_has_any, registrykey_has_any = registrykey_has_any, registryvalue_has_any = registrykey_has_any, registrydata_has_any = registrydata_has_any, dvchostname_has_any= dvchostname_has_any, disabled=(imProcessBuiltInDisabled or('ExcludevimRegistryEventMicrosoft365D'   in (DisabledParsers) ))),
    vimRegistryEventMicrosoftSysmon,
    // vimRegistryEventMicrosoftSecurityEvents, // Deprecated, now included in vimRegistryEventMicrosoftWindowsEvent. 
    vimRegistryEventMicrosoftWindowsEvent,
    vimRegistryEventSentinelOne