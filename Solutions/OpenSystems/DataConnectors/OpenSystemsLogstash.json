{
  "id": "OpenSystemsLogstash",
  "title": "OpenSystems Logstash Connector",
  "publisher": "OpenSystems",
  "descriptionMarkdown": "This data connector deploys a Logstash instance to collect logs from your OpenSystems environment via Event Hub and ingest them into Azure Sentinel.",
  "graphQueries": [
    {
      "metricName": "Total logs received",
      "legend": "OpenSystemsLogs_CL",
      "baseQuery": "OpenSystemsLogs_CL"
    }
  ],
  "sampleQueries": [
    {
      "description": "All OpenSystems logs",
      "query": "OpenSystemsLogs_CL | take 100"
    }
  ],
  "dataTypes": [
    {
      "name": "OpenSystemsLogs_CL",
      "lastDataReceivedQuery": "OpenSystemsLogs_CL | summarize LastLogReceived = max(TimeGenerated) | project LastLogReceived"
    }
  ],
  "connectivityCriterias": [
    {
      "type": "IsConnectedQuery",
      "value": [
        "OpenSystemsLogs_CL | summarize LastLogReceived = max(TimeGenerated) | project LastLogReceived"
      ]
    }
  ],
  "availability": {
    "status": 1,
    "isPreview": true
  },
  "permissions": {
    "resourceProvider": [
      {
        "provider": "Microsoft.OperationalInsights/workspaces",
        "permissionsDisplayText": "read and write permissions are required.",
        "providerDisplayName": "Workspace",
        "scope": "Workspace",
        "requiredPermissions": {
          "write": true,
          "read": true,
          "delete": true
        }
      },
      {
        "provider": "Microsoft.OperationalInsights/solutions",
        "permissionsDisplayText": "read permission is required.",
        "providerDisplayName": "Solution",
        "scope": "Workspace",
        "requiredPermissions": {
          "read": true
        }
      }
    ]
  },
  "deploymentSteps": [
    {
      "title": "Deploy Logstash and Data Collection Rule",
      "description": "Click the button below to deploy the ARM template, which will set up the Logstash container instance, data collection rule, and associated resources.",
      "templateUri": "https://raw.githubusercontent.com/mdarii/Azure-Sentinel/feature/sentinel-solution-package/Solutions/OpenSystems/Package/mainTemplate.json",
      "uiFormDefinitionUri": "https://raw.githubusercontent.com/mdarii/Azure-Sentinel/feature/sentinel-solution-package/Solutions/OpenSystems/Package/createUiDefinition.json"
    }
  ],
  "instructionSteps": [
    {
      "title": "Connect to OpenSystems Logstash",
      "description": "Click the 'Deploy to Azure' button below to deploy the Logstash container and associated resources. This will configure the ingestion pipeline from your Event Hub to Azure Sentinel.",
      "instructions": [
        {
          "type": "DeployToAzure",
          "parameters": {
            "templateUri": "https://raw.githubusercontent.com/open-ch/Azure-Sentinel/feature/sentinel-solution-package/Solutions/OpenSystems/Package/mainTemplate.json",
            "uiFormDefinitionUri": "https://raw.githubusercontent.com/open-ch/Azure-Sentinel/feature/sentinel-solution-package/Solutions/OpenSystems/Package/createUiDefinition.json"
          }
        }
      ]
    }
  ]
}
