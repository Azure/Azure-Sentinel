{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Samsung - kai.sme@samsung.com",
    "comments": "Solution template for Samsung Knox Asset Intelligence"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Samsung Knox Asset Intelligence",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "email": "kai.sme@samsung.com",
    "_email": "[variables('email')]",
    "_solutionName": "Samsung Knox Asset Intelligence",
    "_solutionVersion": "3.0.0",
    "solutionId": "samsungelectronics1734042706970.azure-sentinel-solution-samsung-knox-kai",
    "_solutionId": "[variables('solutionId')]",
    "uiConfigId1": "SamsungDCDefinition",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "SamsungDCDefinition",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))))]",
    "dataConnectorVersion1": "1.0.0",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "SamsungKnoxAssetIntelligence.json",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.0",
      "_analyticRulecontentId1": "215e89ca-cdbc-4661-b8b2-7041f6ecc7fb",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '215e89ca-cdbc-4661-b8b2-7041f6ecc7fb')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('215e89ca-cdbc-4661-b8b2-7041f6ecc7fb')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','215e89ca-cdbc-4661-b8b2-7041f6ecc7fb','-', '1.0.0')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.0.0",
      "_analyticRulecontentId2": "fb4853c9-28c1-4dab-830c-e086cb975170",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'fb4853c9-28c1-4dab-830c-e086cb975170')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('fb4853c9-28c1-4dab-830c-e086cb975170')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','fb4853c9-28c1-4dab-830c-e086cb975170','-', '1.0.0')))]"
    },
    "analyticRuleObject3": {
      "analyticRuleVersion3": "1.0.0",
      "_analyticRulecontentId3": "fae7e371-aee8-4d3f-8311-2255a45a30b3",
      "analyticRuleId3": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'fae7e371-aee8-4d3f-8311-2255a45a30b3')]",
      "analyticRuleTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('fae7e371-aee8-4d3f-8311-2255a45a30b3')))]",
      "_analyticRulecontentProductId3": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','fae7e371-aee8-4d3f-8311-2255a45a30b3','-', '1.0.0')))]"
    },
    "analyticRuleObject4": {
      "analyticRuleVersion4": "1.0.0",
      "_analyticRulecontentId4": "fbff0a97-1972-4df8-a78c-254ccb9879ef",
      "analyticRuleId4": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'fbff0a97-1972-4df8-a78c-254ccb9879ef')]",
      "analyticRuleTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('fbff0a97-1972-4df8-a78c-254ccb9879ef')))]",
      "_analyticRulecontentProductId4": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','fbff0a97-1972-4df8-a78c-254ccb9879ef','-', '1.0.0')))]"
    },
    "analyticRuleObject5": {
      "analyticRuleVersion5": "1.0.0",
      "_analyticRulecontentId5": "cd526f4d-dbe9-4149-8a0a-9ec43c3abb16",
      "analyticRuleId5": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'cd526f4d-dbe9-4149-8a0a-9ec43c3abb16')]",
      "analyticRuleTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('cd526f4d-dbe9-4149-8a0a-9ec43c3abb16')))]",
      "_analyticRulecontentProductId5": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','cd526f4d-dbe9-4149-8a0a-9ec43c3abb16','-', '1.0.0')))]"
    },
    "analyticRuleObject6": {
      "analyticRuleVersion6": "1.0.0",
      "_analyticRulecontentId6": "e4032fd2-4d05-4302-b7c0-f3f0380e2313",
      "analyticRuleId6": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'e4032fd2-4d05-4302-b7c0-f3f0380e2313')]",
      "analyticRuleTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('e4032fd2-4d05-4302-b7c0-f3f0380e2313')))]",
      "_analyticRulecontentProductId6": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','e4032fd2-4d05-4302-b7c0-f3f0380e2313','-', '1.0.0')))]"
    },
    "analyticRuleObject7": {
      "analyticRuleVersion7": "1.0.0",
      "_analyticRulecontentId7": "18d4d4f3-6605-4fd2-968c-82c171409c1c",
      "analyticRuleId7": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '18d4d4f3-6605-4fd2-968c-82c171409c1c')]",
      "analyticRuleTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('18d4d4f3-6605-4fd2-968c-82c171409c1c')))]",
      "_analyticRulecontentProductId7": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','18d4d4f3-6605-4fd2-968c-82c171409c1c','-', '1.0.0')))]"
    },
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Samsung Knox Asset Intelligence data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Samsung Knox Asset Intelligence (Preview)",
                  "publisher": "Samsung",
                  "descriptionMarkdown": "Samsung Knox Asset Intelligence Data Connector provides you the ability to centralize mobile security events and logs to view customizes insights in Workbooks and create incidents based on Analytics Rules templates.",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "Samsung User Events logs",
                      "baseQuery": "Samsung_Knox_Audit_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "One-line title for your sample query 1",
                      "query": "Samsung_Knox_Audit_CL\n | take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Samsung_Knox_Application_CL",
                      "lastDataReceivedQuery": "Samsung_Knox_Application_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Samsung_Knox_Audit_CL",
                      "lastDataReceivedQuery": "Samsung_Knox_Audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Samsung_Knox_Process_CL",
                      "lastDataReceivedQuery": "Samsung_Knox_Process_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Samsung_Knox_Network_CL",
                      "lastDataReceivedQuery": "Samsung_Knox_Network_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Samsung_Knox_User_CL",
                      "lastDataReceivedQuery": "Samsung_Knox_User_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Samsung_Knox_System_CL",
                      "lastDataReceivedQuery": "Samsung_Knox_System_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Samsung_Knox_Audit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Entra App",
                        "description": "An Entra Application needs to be registered and provisioned with 'Microsoft Sentinel Contributor'/ 'Microsoft Metrics Publisher' role to setup client secret-based authentication for data transfer. [See the documentation](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app?tabs=client-secret) to learn more about Entra App creation/registration and creating Client Secret credentials"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "This Samsung Knox Data Connector uses Microsoft Log Ingestion API that push security events into Microsoft Sentinel from Samsung Knox Asset Intelligence solution."
                    },
                    {
                      "description": ">**Note**: : Since this Data Connector is designed to support Client Secret-based authentication to securely transfer data, the user must create the Client Secret as credentials during the Entra application creation and registration. Ensure you copy the Client Secret value as soon as it is generated.\n\n>**IMPORTANT**: Save the Tenant (Directory) ID, Client (Application) ID and Client Secret (Secret Value) values",
                      "title": "STEP 1 - Create and register an Entra Application "
                    },
                    {
                      "description": ">**Note**: Once you have installed Samsung Knox Asset Intelligence for Microsoft Sentinel Solution, a Data Collection Rule (DCR) associated with a Data Collection Endpoint (DCE), is auto-generated. To view this information, navigate to [Data Collection Rules](https://portal.azure.com/#browse/microsoft.insights%2Fdatacollectionrules?) and look for DCR with its Name starting with **'samsung-knox-dcr-....'** and click on the DCR to view associated details.\n\n>**IMPORTANT**: Save the values for Immutable ID (DCR) and Data Collection Endpoint",
                      "title": "STEP 2 - Obtain Microsoft Sentinel Data collection Details"
                    },
                    {
                      "description": "1. Login to [Knox Asset Intelligence administration portal](https://central.samsungknox.com/kaiadmin/dai/home) and navigate to **Dashboard Settings**; this is available at the top-right corner of the Portal\n>  **Note**: Ensure the login user has access to 'Security' and 'Manage dashboard view and data collection' permissions\n\n2. Click on Security tab to view settings for Security Operations Integration and for Knox Security Logs.\n\n3. In the Security Operations Integration page, toggle on the **'Enable Microsoft Sentinel Integration'** and enter appropriate values in the required fields - \n\n a. For Tenant ID, Client ID and Client Secret, refer to the information saved from Step 1 while registering the Entra application \n\n b. For Microsoft Sentinel DCE and DCR, refer to the information saved from Step 2  \n\n4. Click on the **'Test Connection'** and ensure the connection is successful.\n\n5. Before you can Save, configure Knox Security Logs by selecting wither Essential or Advanced configuration **(default: Essential)**\n\n6. To complete the Microsoft Sentinel integration, click **'Save'**",
                      "title": "STEP 3 - Connect to Samsung Knox Asset Intelligence solution to configure Microsoft Sentinel to push select Knox Security Events as Alerts -"
                    }
                  ],
                  "metadata": {
                    "id": "790935a7-f8ec-4207-a48f-42a7e4ee0ab7",
                    "version": "1.0.0",
                    "kind": "dataConnector",
                    "source": {
                      "kind": "solution"
                    },
                    "author": {
                      "name": "Samsung Knox Asset Intelligence"
                    },
                    "support": {
                      "name": "Samsung Electronics Co., Ltd.",
                      "email": "kai.sme@samsung.com",
                      "tier": "Partner",
                      "link": "https://www2.samsungknox.com/en/support"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "Samsung Knox Asset Intelligence (Preview)",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Samsung Knox Asset Intelligence",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Samsung",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Samsung Electronics Co., Ltd.",
          "email": "kai.sme@samsung.com",
          "tier": "Partner",
          "link": "https://www2.samsungknox.com/en/support"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Samsung Knox Asset Intelligence (Preview)",
          "publisher": "Samsung",
          "descriptionMarkdown": "Samsung Knox Asset Intelligence Data Connector provides you the ability to centralize mobile security events and logs to view customizes insights in Workbooks and create incidents based on Analytics Rules templates.",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "Samsung User Events logs",
              "baseQuery": "Samsung_Knox_Audit_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Samsung_Knox_Application_CL",
              "lastDataReceivedQuery": "Samsung_Knox_Application_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Samsung_Knox_Audit_CL",
              "lastDataReceivedQuery": "Samsung_Knox_Audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Samsung_Knox_Process_CL",
              "lastDataReceivedQuery": "Samsung_Knox_Process_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Samsung_Knox_Network_CL",
              "lastDataReceivedQuery": "Samsung_Knox_Network_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Samsung_Knox_User_CL",
              "lastDataReceivedQuery": "Samsung_Knox_User_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Samsung_Knox_System_CL",
              "lastDataReceivedQuery": "Samsung_Knox_System_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Samsung_Knox_Audit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "One-line title for your sample query 1",
              "query": "Samsung_Knox_Audit_CL\n | take 10"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Entra App",
                "description": "An Entra Application needs to be registered and provisioned with 'Microsoft Sentinel Contributor'/ 'Microsoft Metrics Publisher' role to setup client secret-based authentication for data transfer. [See the documentation](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app?tabs=client-secret) to learn more about Entra App creation/registration and creating Client Secret credentials"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "This Samsung Knox Data Connector uses Microsoft Log Ingestion API that push security events into Microsoft Sentinel from Samsung Knox Asset Intelligence solution."
            },
            {
              "description": ">**Note**: : Since this Data Connector is designed to support Client Secret-based authentication to securely transfer data, the user must create the Client Secret as credentials during the Entra application creation and registration. Ensure you copy the Client Secret value as soon as it is generated.\n\n>**IMPORTANT**: Save the Tenant (Directory) ID, Client (Application) ID and Client Secret (Secret Value) values",
              "title": "STEP 1 - Create and register an Entra Application "
            },
            {
              "description": ">**Note**: Once you have installed Samsung Knox Asset Intelligence for Microsoft Sentinel Solution, a Data Collection Rule (DCR) associated with a Data Collection Endpoint (DCE), is auto-generated. To view this information, navigate to [Data Collection Rules](https://portal.azure.com/#browse/microsoft.insights%2Fdatacollectionrules?) and look for DCR with its Name starting with **'samsung-knox-dcr-....'** and click on the DCR to view associated details.\n\n>**IMPORTANT**: Save the values for Immutable ID (DCR) and Data Collection Endpoint",
              "title": "STEP 2 - Obtain Microsoft Sentinel Data collection Details"
            },
            {
              "description": "1. Login to [Knox Asset Intelligence administration portal](https://central.samsungknox.com/kaiadmin/dai/home) and navigate to **Dashboard Settings**; this is available at the top-right corner of the Portal\n>  **Note**: Ensure the login user has access to 'Security' and 'Manage dashboard view and data collection' permissions\n\n2. Click on Security tab to view settings for Security Operations Integration and for Knox Security Logs.\n\n3. In the Security Operations Integration page, toggle on the **'Enable Microsoft Sentinel Integration'** and enter appropriate values in the required fields - \n\n a. For Tenant ID, Client ID and Client Secret, refer to the information saved from Step 1 while registering the Entra application \n\n b. For Microsoft Sentinel DCE and DCR, refer to the information saved from Step 2  \n\n4. Click on the **'Test Connection'** and ensure the connection is successful.\n\n5. Before you can Save, configure Knox Security Logs by selecting wither Essential or Advanced configuration **(default: Essential)**\n\n6. To complete the Microsoft Sentinel integration, click **'Save'**",
              "title": "STEP 3 - Connect to Samsung Knox Asset Intelligence solution to configure Microsoft Sentinel to push select Knox Security Events as Alerts -"
            }
          ],
          "id": "[variables('_uiConfigId1')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxAssetIntelligence Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "This Knox Asset Intelligence for Microsoft Sentinel solution installs a workbook that summarizes the mobile security events reported by Samsung Knox devices over a selected reporting period. You can use this workbook to quickly assess the threat type and severity, or identify patterns and anomalies in order to help prioritize incident responses or further investigations."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5b5bf4e9-62b8-4ef2-aeb3-ecd249fb6187\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"CustomTimeRange\",\"label\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":3600000},{\"durationMs\":86400000},{\"durationMs\":604800000},{\"durationMs\":2592000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":604800000}},{\"id\":\"6b4373f0-7c1a-47d8-baed-bc5d0cd7233e\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"timebrush\",\"label\":\"Time Filter\",\"type\":4,\"isRequired\":true,\"isHiddenWhenLocked\":true,\"typeSettings\":{\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":60000,\"endTime\":\"2016-12-12T18:01:00Z\"}},{\"id\":\"a40ffccc-08a0-4e15-9bf2-3ed99658d4d8\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"selectedseverity\",\"label\":\"Severity\",\"type\":2,\"description\":\"Filter on Security Events by Severity\",\"isRequired\":true,\"isGlobal\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"jsonData\":\"[\\\"high\\\", \\\"med\\\",\\\"low\\\"]\",\"value\":[\"value::all\"]},{\"id\":\"e2572416-ae1f-42db-8c31-8d0d4c4315d4\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"selectedtype\",\"label\":\"Type\",\"type\":2,\"description\":\"Filter on Security Events by Type\",\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"jsonData\":\"[\\\"Audit\\\",\\\"Application\\\", \\\"Process\\\", \\\"User\\\", \\\"Network\\\", \\\"System\\\"]\",\"defaultValue\":\"value::all\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let audit = view(){\\n        Samsung_Knox_Audit_CL\\n    };\\nlet application= view(){\\n        Samsung_Knox_Application_CL\\n    };\\n    let system= view(){\\n        Samsung_Knox_System_CL\\n    };\\n    let process= view(){\\n        Samsung_Knox_Process_CL\\n    };\\n    let user= view(){\\n        Samsung_Knox_User_CL\\n    };\\n    let network= view(){\\n        Samsung_Knox_Network_CL\\n    };\\nlet selectedtables = dynamic([{selectedtype}]);\\nlet severityParam = dynamic([{selectedseverity}]);\\nlet maxdatapoints = 10000;\\nlet starttime = {CustomTimeRange:start};\\nlet endtime = {CustomTimeRange:end};\\nlet day = datetime_diff('day',endtime,starttime);\\nlet initialbinsize = case(day >=30, 1d, day >=7, 1d, day >=1,1h,5m);\\nlet datapoints = (binsize : timespan){\\nunion (audit() | where \\\"Audit\\\" in (selectedtables)), (application() | where \\\"Application\\\" in (selectedtables)),(process() | where \\\"Process\\\" in (selectedtables)),(user() | where \\\"User\\\" in (selectedtables)),(network() | where \\\"Network\\\" in (selectedtables)),(system() | where \\\"System\\\" in (selectedtables))\\n| where TimeGenerated >= {CustomTimeRange:start} and TimeGenerated <={CustomTimeRange:end} \\n| where Severity in (severityParam)\\n| summarize Count=count() by Name, bin(TimeGenerated,binsize)};\\n\\nlet totalpoints = datapoints(initialbinsize) |summarize totalrows = count();\\nlet inttotalpoints = toint(toscalar(totalpoints));\\nlet binsizefactor = inttotalpoints/maxdatapoints +1;\\nlet binsize = binsizefactor * initialbinsize;\\n\\nunion (audit() | where \\\"Audit\\\" in (selectedtables)), (application() | where \\\"Application\\\" in (selectedtables)),(process() | where \\\"Process\\\" in (selectedtables)),(user() | where \\\"User\\\" in (selectedtables)),(network() | where \\\"Network\\\" in (selectedtables)),(system() | where \\\"System\\\" in (selectedtables))\\n| where TimeGenerated >= {CustomTimeRange:start} and TimeGenerated <={CustomTimeRange:end} \\n| where Severity in (severityParam)\\n| summarize Count=count() by Name, bin(TimeGenerated,binsize)\\n\",\"size\":2,\"title\":\"Total events\",\"noDataMessage\":\"No security event data found for the selected time period, severity or type.  Please update the filters applied.\",\"timeBrushParameterName\":\"timebrush\",\"timeBrushExportOnlyWhenBrushed\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"60\",\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"0px\",\"padding\":\"0px\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"\\n\\nlet severityParam = dynamic([{selectedseverity}]);\\nlet audit = view(){\\n        Samsung_Knox_Audit_CL\\n    };\\nlet application= view(){\\n        Samsung_Knox_Application_CL\\n    };\\n    let system= view(){\\n        Samsung_Knox_System_CL\\n    };\\n    let process= view(){\\n        Samsung_Knox_Process_CL\\n    };\\n    let user= view(){\\n        Samsung_Knox_User_CL\\n    };\\n    let network= view(){\\n        Samsung_Knox_Network_CL\\n    };\\nlet selectedtables = dynamic([{selectedtype}]);\\nunion (audit() | where \\\"Audit\\\" in (selectedtables)), (application() | where \\\"Application\\\" in (selectedtables)),(process() | where \\\"Process\\\" in (selectedtables)),(user() | where \\\"User\\\" in (selectedtables)),(network() | where \\\"Network\\\" in (selectedtables)),(system() | where \\\"System\\\" in (selectedtables))\\n|where iff('{timebrush:label}'==\\\"12/12/2016 10:00 AM - 10:01 AM\\\" ,  TimeGenerated >= {CustomTimeRange:start} and TimeGenerated <={CustomTimeRange:end},  TimeGenerated >= {timebrush:start} and TimeGenerated <={timebrush:end})\\n|where Severity in (severityParam)\\n| summarize count() by Severity\\n| where Severity in ('high', 'med','low')\\n|order by case( Severity == 'high',3, Severity == 'med',2, Severity == 'low',1,0)\\n\",\"size\":4,\"title\":\"Events by severity\",\"noDataMessage\":\"No security event data found for the selected time period, severity or type.  Please update the filters applied.\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"severity\",\"formatter\":22,\"formatOptions\":{\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[{\"columnName\":\"severity\",\"color\":\"redBright\"},{\"columnName\":\"severity\",\"color\":\"orange\"},{\"columnName\":\"severity\",\"color\":\"lightBlue\"}]}}},{\"columnMatch\":\"count_\",\"formatter\":22,\"formatOptions\":{\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[{\"columnName\":\"severity\",\"color\":\"lightBlue\"},{\"columnName\":\"severity\",\"color\":\"lightBlue\"},{\"columnName\":\"severity\",\"color\":\"lightBlue\"}]}}}]},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"high\",\"representation\":\"redBright\",\"text\":\"{0}\"},{\"operator\":\"==\",\"thresholdValue\":\"low\",\"representation\":\"yellow\",\"text\":\"{0}\"},{\"operator\":\"==\",\"thresholdValue\":\"med\",\"representation\":\"orange\",\"text\":\"{0}\"},{\"operator\":\"Default\",\"representation\":\"lightBlue\",\"text\":\"{0}\"}]}},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"none\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortOrderField\":1}},\"customWidth\":\"100\",\"name\":\"query - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let severityParam = dynamic([{selectedseverity}]);\\nlet audit = view(){\\n        Samsung_Knox_Audit_CL\\n    };\\nlet application= view(){\\n        Samsung_Knox_Application_CL\\n    };\\n    let system= view(){\\n        Samsung_Knox_System_CL\\n    };\\n    let process= view(){\\n        Samsung_Knox_Process_CL\\n    };\\n    let user= view(){\\n        Samsung_Knox_User_CL\\n    };\\n    let network= view(){\\n        Samsung_Knox_Network_CL\\n    };\\nlet selectedtables = dynamic([{selectedtype}]);\\nunion (audit() | where \\\"Audit\\\" in (selectedtables)), (application() | where \\\"Application\\\" in (selectedtables)),(process() | where \\\"Process\\\" in (selectedtables)),(user() | where \\\"User\\\" in (selectedtables)),(network() | where \\\"Network\\\" in (selectedtables)),(system() | where \\\"System\\\" in (selectedtables))\\n|where iff('{timebrush:label}'==\\\"12/12/2016 10:00 AM - 10:01 AM\\\" ,  TimeGenerated >= {CustomTimeRange:start} and TimeGenerated <={CustomTimeRange:end},  TimeGenerated >= {timebrush:start} and TimeGenerated <={timebrush:end})\\n|where Severity in (severityParam)\\n| summarize count() by Type\\n| render piechart \",\"size\":3,\"title\":\"Events by type\",\"noDataMessage\":\"No security event data found for the selected time period, severity or type.  Please update the filters applied.\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"Samsung_Knox_Application_CL\",\"label\":\"Application\"},{\"seriesName\":\"Samsung_Knox_Network_CL\",\"label\":\"Network\"},{\"seriesName\":\"Samsung_Knox_User_CL\",\"label\":\"User\"},{\"seriesName\":\"Samsung_Knox_Process_CL\",\"label\":\"Process\"},{\"seriesName\":\"Samsung_Knox_Audit_CL\",\"label\":\"Audit\"},{\"seriesName\":\"Samsung_Knox_System_CL\",\"label\":\"System\"}]}},\"name\":\"query - 11\"}]},\"name\":\"group - 9\"}]},\"customWidth\":\"40\",\"name\":\"group - 8\",\"styleSettings\":{\"margin\":\"0px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"\\nlet audit = view(){\\n        Samsung_Knox_Audit_CL\\n    };\\nlet application= view(){\\n        Samsung_Knox_Application_CL\\n    };\\n    let system= view(){\\n        Samsung_Knox_System_CL\\n    };\\n    let process= view(){\\n        Samsung_Knox_Process_CL\\n    };\\n    let user= view(){\\n        Samsung_Knox_User_CL\\n    };\\n    let network= view(){\\n        Samsung_Knox_Network_CL\\n    };\\nlet selectedtables = dynamic([{selectedtype}]);\\nlet severityParam = dynamic([{selectedseverity}]);\\nunion (audit() | where \\\"Audit\\\" in (selectedtables)), (application() | where \\\"Application\\\" in (selectedtables)),(process() | where \\\"Process\\\" in (selectedtables)),(user() | where \\\"User\\\" in (selectedtables)),(network() | where \\\"Network\\\" in (selectedtables)),(system() | where \\\"System\\\" in (selectedtables))\\n| where iff('{timebrush:label}'==\\\"12/12/2016 10:00 AM - 10:01 AM\\\" ,  TimeGenerated >= {CustomTimeRange:start} and TimeGenerated <={CustomTimeRange:end},  TimeGenerated >= {timebrush:start} and TimeGenerated <={timebrush:end})\\n| where Severity in (severityParam)\\n|project Time =TimeGenerated,\\nName,\\nSeverity,\\n[\\\"Device Model\\\"] = DeviceModel,\\nType = replace_string(replace_string(Type,\\\"Samsung_Knox_\\\",\\\"\\\"),\\\"_CL\\\",\\\"\\\"),\\nProfile,\\n[\\\"MITRE Technique ID(s)\\\"] = array_strcat(MitreTtp,\\\", \\\")\\n| sort by Time desc\\n\\n\\n\",\"size\":2,\"title\":\"Event list\",\"noDataMessage\":\"No security event data found for the selected time period, severity or type.  Please update the filters applied.\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"high\",\"representation\":\"dot-redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"med\",\"representation\":\"dot-orange\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"low\",\"representation\":\"dot-yellow\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"LOW\",\"representation\":\"dot-yellow\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"HIGH\",\"representation\":\"dot-redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"MED\",\"representation\":\"dot-orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"representation\":\"success\",\"text\":\"{0}{1}\"}]}}],\"rowLimit\":1000}},\"name\":\"query - 9\"}]},\"name\":\"group - 6\"}],\"fromTemplateId\":\"sentinel-SamsungKnoxAssetIntelligence\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=SamsungKnoxAssetIntelligence.json; logoFileName=Samsung_Knox_Asset_Intelligence.svg; description=This Knox Asset Intelligence for Microsoft Sentinel solution installs a workbook that summarizes the mobile security events reported by Samsung Knox devices over a selected reporting period. You can use this workbook to quickly assess the threat type and severity, or identify patterns and anomalies in order to help prioritize incident responses or further investigations.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Samsung Knox Asset Intelligence; templateRelativePath=SamsungKnoxAssetIntelligence.json; subtitle=; provider=Samsung}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Samsung_Knox_Audit_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Samsung_Knox_Application_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Samsung_Knox_System_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Samsung_Knox_Process_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Samsung_Knox_User_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Samsung_Knox_Network_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "SamsungKnoxAssetIntelligence",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxApplicationPrivilegeEscalationOrChange_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "When a Knox mobile app has transitioned from an acceptable uid/esuid/fsuid to a different, non-App id.",
                "displayName": "Knox Application Privilege Escalation or Change",
                "enabled": false,
                "query": "Samsung_Knox_Process_CL \n| where Name == \"PROCESS_PRIVILEGE_ESCALATION\"\n| where MitreTtp has \"T1548\"\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_Process_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "tactics": [
                  "PrivilegeEscalation"
                ],
                "techniques": [
                  "T1548"
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Application Privilege Escalation or Change",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxKeyguardDisabledFeatureSet_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Indicates that an admin has set disabled keyguard features on a Knox device.",
                "displayName": "Knox Keyguard Disabled Feature Set",
                "enabled": false,
                "query": "Samsung_Knox_Audit_CL \n| where Name == \"TAG_KEYGUARD_DISABLED_FEATURES_SET\" \nand MitreTtp has \"T1461\"\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_Audit_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "tactics": [
                  "InitialAccess"
                ],
                "techniques": [
                  "T1461"
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Keyguard Disabled Feature Set",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject3').analyticRuleTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxMobileDeviceBootCompromise_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject3').analyticRuleVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "When Knox device boot binary is at risk of compromise.",
                "displayName": "Knox Mobile Device Boot Compromise",
                "enabled": false,
                "query": "Samsung_Knox_System_CL \n| where Name == \"BOOT_COMPROMISED_SOFTWARE_BINARY\"\nand MitreTtp has \"T1645\"\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_System_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "tactics": [
                  "Persistence"
                ],
                "techniques": [
                  "T1645"
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject3').analyticRuleId3,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 3",
                "parentId": "[variables('analyticRuleObject3').analyticRuleId3]",
                "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject3').analyticRuleVersion3]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Mobile Device Boot Compromise",
        "contentProductId": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "id": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject4').analyticRuleTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxPasswordLockout_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject4').analyticRuleVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "When maximum password attempts have reached and the Knox device is locked out. This is based on the threshold set by the MDM policy.",
                "displayName": "Knox Password Lockout",
                "enabled": false,
                "query": "Samsung_Knox_User_CL \n| where Name == \"PASSWORD_LOCKOUT\"\nand MitreTtp has \"T1110\"\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_User_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "tactics": [
                  "CredentialAccess"
                ],
                "techniques": [
                  "T1110"
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject4').analyticRuleId4,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 4",
                "parentId": "[variables('analyticRuleObject4').analyticRuleId4]",
                "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject4').analyticRuleVersion4]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Password Lockout",
        "contentProductId": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "id": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject5').analyticRuleTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxPeripheralAccessDetectionWithCamera_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject5').analyticRuleVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "When Knox device camera access has been detected through system policy when such access is disabled.",
                "displayName": "Knox Peripheral Access  Detection with Camera",
                "enabled": false,
                "query": "Samsung_Knox_System_CL \n| where Name == \"PERIPHERAL_ACCESS_THROUGH_POLICY_DETECTED_CAMERA\" \nand MitreTtp has \"KNOX.2\"\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_System_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject5').analyticRuleId5,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 5",
                "parentId": "[variables('analyticRuleObject5').analyticRuleId5]",
                "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject5').analyticRuleVersion5]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Peripheral Access  Detection with Camera",
        "contentProductId": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "id": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject6').analyticRuleTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxPeripheralAccessDetectionWithMic_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject6').analyticRuleVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "When Knox device microphone access has been detected through system policy when such access is disabled.",
                "displayName": "Knox Peripheral Access Detection with Mic",
                "enabled": false,
                "query": "Samsung_Knox_System_CL\n| where Name == \"PERIPHERAL_ACCESS_THROUGH_POLICY_DETECTED_MIC\"\nand MitreTtp has \"KNOX.2\"\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_System_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": []
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject6').analyticRuleId6,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 6",
                "parentId": "[variables('analyticRuleObject6').analyticRuleId6]",
                "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject6').analyticRuleVersion6]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Peripheral Access Detection with Mic",
        "contentProductId": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "id": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject7').analyticRuleTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SamsungKnoxSuspiciousURLs_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject7').analyticRuleVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "apiVersion": "2023-02-01-preview",
              "kind": "NRT",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "When a Knox device user clicks on URLs or links detected as suspicious (potentially phishing or malicious) with a high degree of confidence.",
                "displayName": "Knox Suspicious URL Accessed Events",
                "enabled": false,
                "query": "Samsung_Knox_User_CL \n| where Name == \"SUSPICIOUS_URL_ACCESSED\" \nand ConfidenceScore > 0.9\n",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "Samsung_Knox_User_CL"
                    ],
                    "connectorId": "SamsungDCDefinition"
                  }
                ],
                "tactics": [
                  "InitialAccess"
                ],
                "techniques": [
                  "T1566"
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "reopenClosedIncident": false,
                    "lookbackDuration": "5H",
                    "enabled": false,
                    "matchingMethod": "AllEntities"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject7').analyticRuleId7,'/'))))]",
              "properties": {
                "description": "Samsung Knox Asset Intelligence Analytics Rule 7",
                "parentId": "[variables('analyticRuleObject7').analyticRuleId7]",
                "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject7').analyticRuleVersion7]",
                "source": {
                  "kind": "Solution",
                  "name": "Samsung Knox Asset Intelligence",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Samsung",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Samsung Electronics Co., Ltd.",
                  "email": "kai.sme@samsung.com",
                  "tier": "Partner",
                  "link": "https://www2.samsungknox.com/en/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
        "contentKind": "AnalyticsRule",
        "displayName": "Knox Suspicious URL Accessed Events",
        "contentProductId": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "id": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.0",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Samsung Knox Asset Intelligence",
        "publisherDisplayName": "Samsung Electronics Co., Ltd.",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Samsung%20Knox%20Asset%20Intelligence/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Knox Asset Intelligence for Microsoft Sentinel solution enables enterprise IT and SecOps (Security Operations) administrators to view and manage security threats to their Samsung Knox mobile devices. By integrating security events and logs from Knox Asset Intelligence with the Azure Monitor Log Ingestion API, the solution lets enterprise organizations easily view, identify and investigate security threats in near-real-time with Microsoft Sentinel.</p>\n<p><strong>Data Connectors:</strong> 1, <strong>Workbooks:</strong> 1, <strong>Analytic Rules:</strong> 7</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Samsung_Knox_Asset_Intelligence.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Samsung Knox Asset Intelligence",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Samsung",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Samsung Electronics Co., Ltd.",
          "email": "kai.sme@samsung.com",
          "tier": "Partner",
          "link": "https://www2.samsungknox.com/en/support"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
            }
          ]
        },
        "firstPublishDate": "2025-01-15",
        "providers": [
          "Samsung"
        ],
        "categories": {
          "domains": [
            "Security - Threat Protection"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
