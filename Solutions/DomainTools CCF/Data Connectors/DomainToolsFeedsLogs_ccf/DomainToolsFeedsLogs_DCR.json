{
  "name": "DomainToolsDCR",
  "apiVersion": "2021-09-01-preview",
  "type": "Microsoft.Insights/dataCollectionRules",
  "location": "{{location}}",
  "dependsOn": [
    "DomainToolsThreatIntelDomains_CL"
  ],
  "kind": null,
  "properties": {
    "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
    "workspaceResourceId": "{{workspaceResourceId}}",
    "streamDeclarations": {
      "Custom-DomainToolsThreatIntel_NOD_CL": {
        "columns": [
          {
            "name": "timestamp",
            "type": "string",
            "description": "Timestamp"
          },
          {
            "name": "domain",
            "type": "string",
            "description": "Domain"
          }
        ]
      },
      "Custom-DomainToolsThreatIntel_NOH_CL": {
        "columns": [
          {
            "name": "timestamp",
            "type": "string",
            "description": "Timestamp"
          },
          {
            "name": "domain",
            "type": "string",
            "description": "Domain"
          }
        ]
      },
      "Custom-DomainToolsThreatIntel_NAD_CL": {
        "columns": [
          {
            "name": "timestamp",
            "type": "string",
            "description": "Timestamp"
          },
          {
            "name": "domain",
            "type": "string",
            "description": "Domain"
          }
        ]
      },
      "Custom-DomainToolsThreatIntel_DD_CL": {
        "columns": [
          {
            "name": "timestamp",
            "type": "string",
            "description": "Timestamp"
          },
          {
            "name": "domain",
            "type": "string",
            "description": "Domain"
          }
        ]
      }
    },
    "dataSources": {},
    "destinations": {
      "logAnalytics": [
        {
          "name": "dtv2ws1",
          "workspaceResourceId": "{{workspaceResourceId}}"
        }
      ]
    },
    "dataFlows": [
      {
        "streams": [
          "Custom-DomainToolsThreatIntel_NOD_CL"
        ],
        "destinations": [
          "dtv2ws1"
        ],
        "transformKql": "source \n| extend TimeGenerated = todatetime(timestamp), domaintype = 'nod'\n\n",
        "outputStream": "Custom-DomainToolsThreatIntelDomains_CL"
      },
      {
        "streams": [
          "Custom-DomainToolsThreatIntel_NOH_CL"
        ],
        "destinations": [
          "dtv2ws1"
        ],
        "transformKql": "source \n| extend TimeGenerated = todatetime(timestamp), domaintype = 'noh'\n\n",
        "outputStream": "Custom-DomainToolsThreatIntelDomains_CL"
      },
      {
        "streams": [
          "Custom-DomainToolsThreatIntel_NAD_CL"
        ],
        "destinations": [
          "dtv2ws1"
        ],
        "transformKql": "source \n| extend TimeGenerated = todatetime(timestamp), domaintype = 'nad'\n\n",
        "outputStream": "Custom-DomainToolsThreatIntelDomains_CL"
      },
      {
        "streams": [
          "Custom-DomainToolsThreatIntel_DD_CL"
        ],
        "destinations": [
          "dtv2ws1"
        ],
        "transformKql": "source \n| extend TimeGenerated = todatetime(timestamp), domaintype = 'domaindiscovery'\n\n",
        "outputStream": "Custom-DomainToolsThreatIntelDomains_CL"
      }
    ],
    "provisioningState": "Succeeded"
  }
}