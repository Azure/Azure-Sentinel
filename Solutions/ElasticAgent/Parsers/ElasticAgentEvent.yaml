id: abc32ce9-079e-49d6-a216-c17775f2aa4b
Function:
  Title: Parser for ElasticAgentEvent
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: ElasticAgentEvent
FunctionAlias: ElasticAgentEvent
FunctionQuery: |
    ElasticAgentLogs_CL
    | extend EventVendor = 'Elastic'
    | extend EventProduct = 'Elastic Agent'
    | extend EventSchemaVersion = 0.2
    | extend EventCount = 1
    | project-rename MonitoringMetricsBeatMemstatsMemorySys = monitoring_metrics_beat_memstats_memory_sys_d
    , MonitoringMetricsSystemLoadNorm = monitoring_metrics_system_load_norm_s
    , MonitoringMetricsSystemLoad1 = monitoring_metrics_system_load_1_d
    , MonitoringMetricsSystemLoad5 = monitoring_metrics_system_load_5_d
    , MonitoringMetricsSystemLoad15 = monitoring_metrics_system_load_15_d
    , MonitoringMetricsLibbeatConfigModule = monitoring_metrics_libbeat_config_module_s
    , MonitoringMetricsLibbeatOutputWrite = monitoring_metrics_libbeat_output_write_s
    , MonitoringMetricsLibbeatOutputRead = monitoring_metrics_libbeat_output_read_s
    , MonitoringMetricsLibbeatOutputEvents = monitoring_metrics_libbeat_output_events_s
    , MonitoringMetricsLibbeatPipelineClients = monitoring_metrics_libbeat_pipeline_clients_d
    , MonitoringMetricsLibbeatPipelineEvents = monitoring_metrics_libbeat_pipeline_events_s
    , MonitoringMetricsLibbeatPipelineQueue = monitoring_metrics_libbeat_pipeline_queue_s
    , MonitoringMetricsMetricbeatSystemFilesystem = monitoring_metrics_metricbeat_system_filesystem_s
    , MonitoringMetricsMetricbeatSystemCpu = monitoring_metrics_metricbeat_system_cpu_s
    , MonitoringMetricsMetricbeatSystemMemory = monitoring_metrics_metricbeat_system_memory_s
    , MonitoringMetricsMetricbeatSystemNetwork = monitoring_metrics_metricbeat_system_network_s
    , MonitoringMetricsBeatRuntimeGoroutines = monitoring_metrics_beat_runtime_goroutines_d
    , MonitoringMetricsBeatCpuSystem = monitoring_metrics_beat_cpu_system_s
    , MonitoringMetricsBeatCpuUser = monitoring_metrics_beat_cpu_user_s
    , MonitoringMetricsBeatCpuTotal = monitoring_metrics_beat_cpu_total_s
    , MonitoringMetricsBeatHandlesLimit = monitoring_metrics_beat_handles_limit_s
    , MonitoringMetricsBeatHandlesOpen = monitoring_metrics_beat_handles_open_d
    , MonitoringMetricsBeatMemstatsGcNext = monitoring_metrics_beat_memstats_gc_next_d
    , MonitoringMetricsBeatMemstatsMemoryAlloc = monitoring_metrics_beat_memstats_memory_alloc_d
    , MonitoringMetricsBeatMemstatsMemoryTotal = monitoring_metrics_beat_memstats_memory_total_d
    , MonitoringMetricsBeatMemstatsRss = monitoring_metrics_beat_memstats_rss_d
    , MonitoringMetricsBeatInfoUptime = monitoring_metrics_beat_info_uptime_s
    , MonitoringMetricsBeatInfoEphemeralId = monitoring_metrics_beat_info_ephemeral_id_g
    , MonitoringMetricsBeatInfoVersion = monitoring_metrics_beat_info_version_s
    , MonitoringEcsVersion = monitoring_ecs_version_s
    , LogLogger = log_logger_s
    , BeatStateManagementEnabled = beat_state_management_enabled_b
    , BeatStateOutputName = beat_state_output_name_s
    , BeatStateModuleCount = beat_state_module_count_d
    , BeatStateQueueName = beat_state_queue_name_s
    , ServiceId = service_id_g
    , ServiceName = service_name_s
    , ServiceAddress = service_address_s
    , ElasticAgentProcess = elastic_agent_process_s
    , SystemProcessCpuSystemTicks = system_process_cpu_system_ticks_d
    , SystemProcessCpuSystemTime = system_process_cpu_system_time_s
    , SystemProcessCpuTotalTime = system_process_cpu_total_time_s
    , SystemProcessCpuTotalValue = system_process_cpu_total_value_d
    , SystemProcessCpuTotalTicks = system_process_cpu_total_ticks_d
    , SystemProcessCpuUserTicks = system_process_cpu_user_ticks_d
    , SystemProcessCpuUserTime = system_process_cpu_user_time_s
    , SystemProcessFdLimitHard = system_process_fd_limit_hard_d
    , SystemProcessFdLimitSoft = system_process_fd_limit_soft_d
    , SystemProcessFdOpen = system_process_fd_open_d
    , SystemProcessMemorySize = system_process_memory_size_d
    , BeatType = beat_type_s
    , BeatStatsRuntimeGoroutines = beat_stats_runtime_goroutines_d
    , BeatStatsLibbeatOutputType = beat_stats_libbeat_output_type_s
    , BeatStatsLibbeatOutputWrite = beat_stats_libbeat_output_write_s
    , BeatStatsLibbeatOutputRead = beat_stats_libbeat_output_read_s
    , BeatStatsLibbeatOutputEvents = beat_stats_libbeat_output_events_s
    , BeatStatsUptimeMs = beat_stats_uptime_ms_d
    , BeatId = beat_id_g
    , SystemFilesystemFree = system_filesystem_free_d
    , SystemFilesystemDeviceName = system_filesystem_device_name_s
    , SystemFilesystemUsedPct = system_filesystem_used_pct_d
    , SystemFilesystemUsedBytes = system_filesystem_used_bytes_d
    , SystemFilesystemType = system_filesystem_type_s
    , SystemFilesystemFreeFiles = system_filesystem_free_files_d
    , SystemFilesystemMountPoint = system_filesystem_mount_point_s
    , SystemFilesystemFiles = system_filesystem_files_d
    , SystemFilesystemAvailable = system_filesystem_available_d
    , SystemFilesystemTotal = system_filesystem_total_d
    , InputType = input_type_s
    , LogOffset = log_offset_d
    , LogPath = log_path_s
    , LogLevel = log_level_s
    , LogOriginFileLine = log_origin_file_line_d
    , LogOriginFileName = log_origin_file_name_s
    , EcsVersion = ecs_version_s
    , Timestamp = _timestamp_t
    , MetricsetName = metricset_name_s
    , MetricsetPeriod = metricset_period_d
    , EventDataset = event_dataset_s
    , EventModule = event_module_s
    , EventDuration = event_duration_d
    , DataStreamType = data_stream_type_s
    , DataStreamNamespace = data_stream_namespace_s
    , DataStreamDataset = data_stream_dataset_s
    , Tags = tags_s
    , ElasticAgentSnapshot = elastic_agent_snapshot_b
    , ElasticAgentVersion = elastic_agent_version_s
    , ElasticAgentId = elastic_agent_id_g
    , DvcHostname = host_name_s
    , DvcIpAddr = host_ip_s
    , DvcId = host_id_g
    , HostContainerized = host_containerized_b
    , DvcOs = host_os_name_s
    , HostOsType = host_os_type_s
    , HostOsCodename = host_os_codename_s
    , HostOsPlatform = host_os_platform_s
    , HostOsFamily = host_os_family_s
    , DvcOsVersion = host_os_version_s
    , HostOsKernel = host_os_kernel_s
    , SrcMacAddr = host_mac_s
    , HostHostname = host_hostname_s
    , HostArchitecture = host_architecture_s
    , SystemNetworkName = system_network_name_s
    , SystemNetworkInErrors = system_network_in_errors_d
    , SystemNetworkInDropped = system_network_in_dropped_d
    , SystemNetworkInBytes = system_network_in_bytes_d
    , SystemNetworkInPackets = system_network_in_packets_d
    , SystemNetworkOutDropped = system_network_out_dropped_d
    , SystemNetworkOutErrors = system_network_out_errors_d
    , SystemNetworkOutBytes = system_network_out_bytes_d
    , SystemNetworkOutPackets = system_network_out_packets_d
    , ServiceType = service_type_s
    , EventProductVersion = _version_s
    , AgentName = agent_name_s
    , AgentEphemeralId = agent_ephemeral_id_g
    , AgentType = agent_type_s
    , AgentVersion = agent_version_s
    , AgentHostname = agent_hostname_s
    , AgentId = agent_id_g
    , HostCpuUsage = host_cpu_usage_d
    , SystemCpuNicePct = system_cpu_nice_pct_d
    , SystemCpuNiceNormPct = system_cpu_nice_norm_pct_d
    , SystemCpuIowaitPct = system_cpu_iowait_pct_d
    , SystemCpuIowaitNormPct = system_cpu_iowait_norm_pct_d
    , SystemCpuSoftirqPct = system_cpu_softirq_pct_d
    , SystemCpuSoftirqNormPct = system_cpu_softirq_norm_pct_d
    , SystemCpuSystemPct = system_cpu_system_pct_d
    , SystemCpuSystemNormPct = system_cpu_system_norm_pct_d
    , SystemCpuUserPct = system_cpu_user_pct_d
    , SystemCpuUserNormPct = system_cpu_user_norm_pct_d
    , SystemCpuStealNormPct = system_cpu_steal_norm_pct_d
    , SystemCpuStealPct = system_cpu_steal_pct_d
    , SystemCpuIrqPct = system_cpu_irq_pct_d
    , SystemCpuIrqNormPct = system_cpu_irq_norm_pct_d
    , SystemCpuCores = system_cpu_cores_d
    , SystemCpuIdleNormPct = system_cpu_idle_norm_pct_d
    , SystemCpuIdlePct = system_cpu_idle_pct_d
    , SystemCpuTotalPct = system_cpu_total_pct_d
    , SystemCpuTotalNormPct = system_cpu_total_norm_pct_d
    , SystemMemoryFree = system_memory_free_d
    , SystemMemoryUsedPct = system_memory_used_pct_d
    , SystemMemoryUsedBytes = system_memory_used_bytes_d
    , SystemMemorySwapFree = system_memory_swap_free_d
    , SystemMemorySwapUsedBytes = system_memory_swap_used_bytes_d
    , SystemMemorySwapTotal = system_memory_swap_total_d
    , SystemMemoryTotal = system_memory_total_d
    , SystemMemoryActualFree = system_memory_actual_free_d
    , SystemMemoryActualUsedPct = system_memory_actual_used_pct_d
    , SystemMemoryActualUsedBytes = system_memory_actual_used_bytes_d
    , SystemMemoryCached = system_memory_cached_d
    , SrcBytes = host_network_egress_bytes_d
    , SrcPackets = host_network_egress_packets_d
    , DstBytes = host_network_ingress_bytes_d
    , DstPackets = host_network_ingress_packets_d