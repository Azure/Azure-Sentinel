{
    "name": "ObsidianDatasharingDCR",
    "apiVersion": "2021-09-01-preview",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
        "streamDeclarations": {
            "Custom-ObsidianActivity": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "EventCount",
                        "type": "int"
                    },
                    {
                        "name": "EventStartTime",
                        "type": "datetime"
                    },
                    {
                        "name": "EventEndTime",
                        "type": "string"
                    },
                    {
                        "name": "EventType",
                        "type": "string"
                    },
                    {
                        "name": "EventResult",
                        "type": "string"
                    },
                    {
                        "name": "EventProduct",
                        "type": "string"
                    },
                    {
                        "name": "EventVendor",
                        "type": "string"
                    },
                    {
                        "name": "EventSchema",
                        "type": "string"
                    },
                    {
                        "name": "EventSchemaVersion",
                        "type": "string"
                    },
                    {
                        "name": "EventResultDetails",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventSeverity",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventUid",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcIpAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcHostname",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcDomain",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcDomainType",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcFqdn",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcId",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcIdType",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcAction",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventMessage",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventSubType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalUid",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalSubType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalResultDetails",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalSeverity",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventProductVersion",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventReportUrl",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOwner",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcZone",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcMacAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcOs",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcOsVersion",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcOriginalAction",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcInterface",
                        "type": "dynamic"
                    },
                    {
                        "name": "AdditionalFields",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcDescription",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcScopeId",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcScope",
                        "type": "dynamic"
                    },
                    {
                        "name": "Operation",
                        "type": "string"
                    },
                    {
                        "name": "ObjectName",
                        "type": "string"
                    },
                    {
                        "name": "ObjectType",
                        "type": "string"
                    },
                    {
                        "name": "OldValue",
                        "type": "dynamic"
                    },
                    {
                        "name": "NewValue",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorUserId",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorUserIdType",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorScope",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorScopeId",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorUsername",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorUsernameType",
                        "type": "string"
                    },
                    {
                        "name": "ActorUserType",
                        "type": "string"
                    },
                    {
                        "name": "ActorOriginalUserType",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActorSessionId",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetAppId",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetAppName",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetAppType",
                        "type": "string"
                    },
                    {
                        "name": "TargetUrl",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetHostname",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDomain",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDomainType",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetFqdn",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDescription",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDvcId",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDvcScopeId",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDvcScope",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDvcIdType",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDeviceType",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetIpAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetDvcOs",
                        "type": "dynamic"
                    },
                    {
                        "name": "TargetPortNumber",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActingAppId",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActingAppName",
                        "type": "dynamic"
                    },
                    {
                        "name": "ActingAppType",
                        "type": "dynamic"
                    },
                    {
                        "name": "HttpUserVersion",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcIpAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcPortNumber",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcHostname",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDomain",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDomainType",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcFqdn",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDescription",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDvcId",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDvcScopeId",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDvcScope",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDvcIdType",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcDeviceType",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcSubscriptionId",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcGeoCountry",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcGeoRegion",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcGeoCity",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcGeoLatitude",
                        "type": "dynamic"
                    },
                    {
                        "name": "SrcGeoLongitude",
                        "type": "dynamic"
                    },
                    {
                        "name": "RuleName",
                        "type": "dynamic"
                    },
                    {
                        "name": "RuleNumber",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatId",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatName",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatCategory",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatRiskLevel",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatOriginalRiskLevel",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatConfidence",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatOriginalConfidence",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatIsActive",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatFirstReportedTime",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatLastReportedTime",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatIpAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatField",
                        "type": "dynamic"
                    },
                    {
                        "name": "Dvc",
                        "type": "string"
                    },
                    {
                        "name": "Value",
                        "type": "dynamic"
                    },
                    {
                        "name": "User",
                        "type": "dynamic"
                    },
                    {
                        "name": "Application",
                        "type": "dynamic"
                    },
                    {
                        "name": "Dst",
                        "type": "string"
                    },
                    {
                        "name": "Src",
                        "type": "string"
                    },
                    {
                        "name": "IpAddr",
                        "type": "string"
                    },
                    {
                        "name": "Rule",
                        "type": "string"
                    },
                    {
                        "name": "ValueType",
                        "type": "dynamic"
                    }
                ]
            },
            "Custom-ObsidianThreat": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "EventCount",
                        "type": "int"
                    },
                    {
                        "name": "EventStartTime",
                        "type": "datetime"
                    },
                    {
                        "name": "EventEndTime",
                        "type": "datetime"
                    },
                    {
                        "name": "EventType",
                        "type": "string"
                    },
                    {
                        "name": "EventResult",
                        "type": "string"
                    },
                    {
                        "name": "EventProduct",
                        "type": "string"
                    },
                    {
                        "name": "EventVendor",
                        "type": "string"
                    },
                    {
                        "name": "EventSchema",
                        "type": "string"
                    },
                    {
                        "name": "EventSchemaVersion",
                        "type": "string"
                    },
                    {
                        "name": "EventResultDetails",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventUid",
                        "type": "string"
                    },
                    {
                        "name": "EventSeverity",
                        "type": "string"
                    },
                    {
                        "name": "EventMessage",
                        "type": "string"
                    },
                    {
                        "name": "EventSubType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalUid",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalSubType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalResultDetails",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOriginalSeverity",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventProductVersion",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventReportUrl",
                        "type": "dynamic"
                    },
                    {
                        "name": "EventOwner",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcIpAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcHostname",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcDomain",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcDomainType",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcFqdn",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcDescription",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcId",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcIdType",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcMacAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcZone",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcOs",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcOsVersion",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcAction",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcOriginalAction",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcInterface",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcScopeId",
                        "type": "dynamic"
                    },
                    {
                        "name": "DvcScope",
                        "type": "dynamic"
                    },
                    {
                        "name": "AdditionalFields",
                        "type": "dynamic"
                    },
                    {
                        "name": "AlertName",
                        "type": "dynamic"
                    },
                    {
                        "name": "AlertVerdict",
                        "type": "dynamic"
                    },
                    {
                        "name": "AlertStatus",
                        "type": "dynamic"
                    },
                    {
                        "name": "AlertOriginalStatus",
                        "type": "dynamic"
                    },
                    {
                        "name": "DetectionMethod",
                        "type": "dynamic"
                    },
                    {
                        "name": "RuleNumber",
                        "type": "dynamic"
                    },
                    {
                        "name": "RuleName",
                        "type": "dynamic"
                    },
                    {
                        "name": "RuleDescription",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatId",
                        "type": "string"
                    },
                    {
                        "name": "ThreatName",
                        "type": "string"
                    },
                    {
                        "name": "ThreatFirstReportedTime",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatLastReportedTime",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatCategory",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatOriginalCategory",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatIsActive",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatRiskLevel",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatOriginalRiskLevel",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatConfidence",
                        "type": "dynamic"
                    },
                    {
                        "name": "ThreatOriginalConfidence",
                        "type": "dynamic"
                    },
                    {
                        "name": "IndicatorType",
                        "type": "dynamic"
                    },
                    {
                        "name": "IndicatorAssociation",
                        "type": "dynamic"
                    },
                    {
                        "name": "AttackTactics",
                        "type": "dynamic"
                    },
                    {
                        "name": "AttackTechniques",
                        "type": "dynamic"
                    },
                    {
                        "name": "AttackRemediationSteps",
                        "type": "dynamic"
                    },
                    {
                        "name": "UserId",
                        "type": "dynamic"
                    },
                    {
                        "name": "UserIdType",
                        "type": "string"
                    },
                    {
                        "name": "Username",
                        "type": "dynamic"
                    },
                    {
                        "name": "UsernameType",
                        "type": "string"
                    },
                    {
                        "name": "UserType",
                        "type": "string"
                    },
                    {
                        "name": "OriginalUserType",
                        "type": "dynamic"
                    },
                    {
                        "name": "UserSessionId",
                        "type": "dynamic"
                    },
                    {
                        "name": "UserScopeId",
                        "type": "dynamic"
                    },
                    {
                        "name": "UserScope",
                        "type": "dynamic"
                    },
                    {
                        "name": "ProcessId",
                        "type": "dynamic"
                    },
                    {
                        "name": "ProcessCommandLine",
                        "type": "dynamic"
                    },
                    {
                        "name": "ProcessName",
                        "type": "dynamic"
                    },
                    {
                        "name": "ProcessFileCompany",
                        "type": "dynamic"
                    },
                    {
                        "name": "FileName",
                        "type": "dynamic"
                    },
                    {
                        "name": "FilePath",
                        "type": "dynamic"
                    },
                    {
                        "name": "FileSHA1",
                        "type": "dynamic"
                    },
                    {
                        "name": "FileSHA256",
                        "type": "dynamic"
                    },
                    {
                        "name": "FileMD5",
                        "type": "dynamic"
                    },
                    {
                        "name": "FileSize",
                        "type": "dynamic"
                    },
                    {
                        "name": "Url",
                        "type": "dynamic"
                    },
                    {
                        "name": "RegistryKey",
                        "type": "dynamic"
                    },
                    {
                        "name": "RegistryValue",
                        "type": "dynamic"
                    },
                    {
                        "name": "RegistryData",
                        "type": "dynamic"
                    },
                    {
                        "name": "RegistryValueType",
                        "type": "dynamic"
                    },
                    {
                        "name": "EmailMessageId",
                        "type": "dynamic"
                    },
                    {
                        "name": "EmailSubject",
                        "type": "dynamic"
                    },
                    {
                        "name": "Dvc",
                        "type": "string"
                    },
                    {
                        "name": "IpAddr",
                        "type": "dynamic"
                    },
                    {
                        "name": "Hostname",
                        "type": "dynamic"
                    },
                    {
                        "name": "AlertId",
                        "type": "string"
                    },
                    {
                        "name": "AlertDescription",
                        "type": "string"
                    },
                    {
                        "name": "Rule",
                        "type": "string"
                    }
                ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "obsidian-data-destination"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-ObsidianActivity"
                ],
                "destinations": [
                    "obsidian-data-destination"
                ],
                "transformKql": "source",
                "outputStream": "Custom-ObsidianActivity_CL"
            },
            {
                "streams": [
                    "Custom-ObsidianThreat"
                ],
                "destinations": [
                    "obsidian-data-destination"
                ],
                "transformKql": "source",
                "outputStream": "Custom-ObsidianThreat_CL"
            }
        ],
        "dataCollectionEndpointId": "{{dataCollectionEndpointsId}}"
    }
}