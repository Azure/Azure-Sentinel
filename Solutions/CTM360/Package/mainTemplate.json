{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "CTM360 - monitor@ctm360.com",
    "comments": "Solution template for CTM360"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    }
  },
  "variables": {
    "email": "monitor@ctm360.com",
    "_email": "[variables('email')]",
    "_solutionName": "CTM360",
    "_solutionVersion": "3.0.3",
    "solutionId": "ctm360wll1698919697848.ctm360_microsoft_sentinel_solution",
    "_solutionId": "[variables('solutionId')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "dataConnectorCCPVersion": "3.0.3",
    "_dataConnectorContentIdConnectorDefinition1": "CTM360CBSConnectorDefinition",
    "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
    "_dataConnectorContentIdConnections1": "CTM360CBSConnectorDefinitionConnections",
    "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
    "dataCollectionEndpointId1": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "blanks": "[replace('b', 'b', '')]",
    "_dataConnectorContentIdConnectorDefinition2": "CTM360HackerViewConnectorDefinition",
    "dataConnectorTemplateNameConnectorDefinition2": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition2')))]",
    "_dataConnectorContentIdConnections2": "CTM360HackerViewConnectorDefinitionConnections",
    "dataConnectorTemplateNameConnections2": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections2')))]",
    "dataCollectionEndpointId2": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "parserObject1": {
      "_parserName1": "[concat(parameters('workspace'),'/','HackerViewLog')]",
      "_parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'HackerViewLog')]",
      "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('HackerViewLog-Parser')))]",
      "parserVersion1": "1.1.0",
      "parserContentId1": "HackerViewLog-Parser"
    },
    "parserObject2": {
      "_parserName2": "[concat(parameters('workspace'),'/','CBSLog')]",
      "_parserId2": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBSLog')]",
      "parserTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CBSLog-Parser')))]",
      "parserVersion2": "1.1.0",
      "parserContentId2": "CBSLog-Parser"
    },
    "parserObject3": {
      "_parserName3": "[concat(parameters('workspace'),'/','CBS_BreachedCredentials')]",
      "_parserId3": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_BreachedCredentials')]",
      "parserTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CBS_BreachedCredentials-Parser')))]",
      "parserVersion3": "1.0.0",
      "parserContentId3": "CBS_BreachedCredentials-Parser"
    },
    "parserObject4": {
      "_parserName4": "[concat(parameters('workspace'),'/','CBS_CompromisedCards')]",
      "_parserId4": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_CompromisedCards')]",
      "parserTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CBS_CompromisedCards-Parser')))]",
      "parserVersion4": "1.0.0",
      "parserContentId4": "CBS_CompromisedCards-Parser"
    },
    "parserObject5": {
      "_parserName5": "[concat(parameters('workspace'),'/','CBS_DomainInfringement')]",
      "_parserId5": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_DomainInfringement')]",
      "parserTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CBS_DomainInfringement-Parser')))]",
      "parserVersion5": "1.0.0",
      "parserContentId5": "CBS_DomainInfringement-Parser"
    },
    "parserObject6": {
      "_parserName6": "[concat(parameters('workspace'),'/','CBS_MalwareLogs')]",
      "_parserId6": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_MalwareLogs')]",
      "parserTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CBS_MalwareLogs-Parser')))]",
      "parserVersion6": "1.0.0",
      "parserContentId6": "CBS_MalwareLogs-Parser"
    },
    "parserObject7": {
      "_parserName7": "[concat(parameters('workspace'),'/','CBS_SubdomainInfringement')]",
      "_parserId7": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_SubdomainInfringement')]",
      "parserTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CBS_SubdomainInfringement-Parser')))]",
      "parserVersion7": "1.0.0",
      "parserContentId7": "CBS_SubdomainInfringement-Parser"
    },
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.0",
      "_analyticRulecontentId1": "abe1a663-d00d-482e-aa68-9394622ae03e",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'abe1a663-d00d-482e-aa68-9394622ae03e')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('abe1a663-d00d-482e-aa68-9394622ae03e')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','abe1a663-d00d-482e-aa68-9394622ae03e','-', '1.0.0')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.0.0",
      "_analyticRulecontentId2": "abe1a662-d00d-482e-aa68-9394622ae02e",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'abe1a662-d00d-482e-aa68-9394622ae02e')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('abe1a662-d00d-482e-aa68-9394622ae02e')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','abe1a662-d00d-482e-aa68-9394622ae02e','-', '1.0.0')))]"
    },
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "displayName": "CTM360 CyberBlindSpot (Serverless)",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "CTM360CBSConnectorDefinition",
                  "title": "CTM360 CyberBlindSpot (Serverless)",
                  "publisher": "CTM360",
                  "descriptionMarkdown": "The CTM360 Cyber Blind Spot (CBS) connector provides integration with CTM360's CBS platform to ingest security data across 6 module types: incidents, malware logs, breached credentials, compromised cards, domain infringement, and subdomain infringement. This connector uses the Codeless Connector Framework (CCF) for serverless data collection.\n\n**Data Types:**\n- CBSLog_AzureV2_CL\n- CBS_MalwareLogs_AzureV2_CL\n- CBS_BreachedCredentials_AzureV2_CL\n- CBS_CompromisedCards_AzureV2_CL\n- CBS_DomainInfringement_AzureV2_CL\n- CBS_SubdomainInfringement_AzureV2_CL",
                  "graphQueriesTableName": "CBSLog_AzureV2_CL",
                  "graphQueries": [
                    {
                      "metricName": "Incidents",
                      "legend": "CBSLog_AzureV2_CL",
                      "baseQuery": "CBSLog_AzureV2_CL"
                    },
                    {
                      "metricName": "Malware Logs",
                      "legend": "CBS_MalwareLogs_AzureV2_CL",
                      "baseQuery": "CBS_MalwareLogs_AzureV2_CL"
                    },
                    {
                      "metricName": "Breached Credentials",
                      "legend": "CBS_BreachedCredentials_AzureV2_CL",
                      "baseQuery": "CBS_BreachedCredentials_AzureV2_CL"
                    },
                    {
                      "metricName": "Compromised Cards",
                      "legend": "CBS_CompromisedCards_AzureV2_CL",
                      "baseQuery": "CBS_CompromisedCards_AzureV2_CL"
                    },
                    {
                      "metricName": "Domain Infringement",
                      "legend": "CBS_DomainInfringement_AzureV2_CL",
                      "baseQuery": "CBS_DomainInfringement_AzureV2_CL"
                    },
                    {
                      "metricName": "Subdomain Infringement",
                      "legend": "CBS_SubdomainInfringement_AzureV2_CL",
                      "baseQuery": "CBS_SubdomainInfringement_AzureV2_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "All Incidents",
                      "query": "CBSLog_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
                    },
                    {
                      "description": "All Malware Logs",
                      "query": "CBS_MalwareLogs_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
                    },
                    {
                      "description": "Breached Credentials",
                      "query": "CBS_BreachedCredentials_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
                    },
                    {
                      "description": "Compromised Cards",
                      "query": "CBS_CompromisedCards_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
                    },
                    {
                      "description": "Recent Domain Infringements",
                      "query": "CBS_DomainInfringement_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
                    },
                    {
                      "description": "Recent Subdomain Infringements",
                      "query": "CBS_SubdomainInfringement_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CBSLog_AzureV2_CL",
                      "lastDataReceivedQuery": "CBSLog_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    },
                    {
                      "name": "CBS_MalwareLogs_AzureV2_CL",
                      "lastDataReceivedQuery": "CBS_MalwareLogs_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    },
                    {
                      "name": "CBS_BreachedCredentials_AzureV2_CL",
                      "lastDataReceivedQuery": "CBS_BreachedCredentials_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    },
                    {
                      "name": "CBS_CompromisedCards_AzureV2_CL",
                      "lastDataReceivedQuery": "CBS_CompromisedCards_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    },
                    {
                      "name": "CBS_DomainInfringement_AzureV2_CL",
                      "lastDataReceivedQuery": "CBS_DomainInfringement_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    },
                    {
                      "name": "CBS_SubdomainInfringement_AzureV2_CL",
                      "lastDataReceivedQuery": "CBS_SubdomainInfringement_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "CTM360 CBS API Key",
                        "description": "A valid CTM360 Cyber Blind Spot API key is required to connect to the CBS API endpoint."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "Connect CTM360 Cyber Blind Spot to Microsoft Sentinel",
                      "description": "This connector uses the Codeless Connector Framework (CCF) to ingest data from CTM360 CBS into Microsoft Sentinel. Data is collected every 5 minutes across 6 different module types.",
                      "instructions": [
                        {
                          "type": "InfoMessage",
                          "parameters": {
                            "text": "This connector creates 6 separate tables for different CBS module types: Incidents, Malware Logs, Breached Credentials, Compromised Cards, Domain Infringement, and Subdomain Infringement.",
                            "inline": true
                          }
                        }
                      ]
                    },
                    {
                      "title": "Step 1: Obtain CTM360 API Keys",
                      "description": "To setup this integration, you will need CBS API Key. You can get these keys using the following links:\n\nCBS API Key found from this link: https://platform.ctm360.com/start/integrations after logging with you account"
                    },
                    {
                      "title": "Step 2: Configure Connection",
                      "description": "Enter your CTM360 CBS API key and connect to start data ingestion.",
                      "instructions": [
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "CTM360 CBS API Key",
                            "placeholder": "Enter your CTM360 CBS API Key",
                            "type": "password",
                            "name": "apiKey"
                          }
                        },
                        {
                          "type": "ConnectionToggleButton",
                          "parameters": {
                            "connectLabel": "Connect",
                            "disconnectLabel": "Disconnect",
                            "name": "connect"
                          }
                        }
                      ]
                    },
                    {
                      "title": "Step 3: Verify Data Ingestion",
                      "description": "After connecting, data should start flowing within 5-10 minutes. Use the sample queries above to verify data ingestion for each module type.",
                      "instructions": [
                        {
                          "type": "InfoMessage",
                          "parameters": {
                            "text": "Note: Initial data ingestion may take up to 30 minutes. The connector polls every 5 minutes with a 5-minute rolling window.",
                            "inline": true
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "CTM360_CBS_DCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "description": "Data collection rule for CTM360 Cyber Blind Spot connector - 6 module types",
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId1')]",
                "streamDeclarations": {
                  "Custom-CBSLog_Azure_1_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "subject",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "class",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "coa",
                        "type": "string"
                      },
                      {
                        "name": "screenshots",
                        "type": "dynamic"
                      },
                      {
                        "name": "remarks",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "brand",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "long"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  },
                  "Custom-CBS_MalwareLogs_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "masked_password",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "user_domain",
                        "type": "string"
                      },
                      {
                        "name": "website",
                        "type": "string"
                      },
                      {
                        "name": "sources",
                        "type": "dynamic"
                      },
                      {
                        "name": "source_uri",
                        "type": "dynamic"
                      },
                      {
                        "name": "brand",
                        "type": "string"
                      },
                      {
                        "name": "remarks",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "stealer_family",
                        "type": "dynamic"
                      },
                      {
                        "name": "compromise_details",
                        "type": "dynamic"
                      },
                      {
                        "name": "date_compromised",
                        "type": "string"
                      },
                      {
                        "name": "computer_name",
                        "type": "string"
                      },
                      {
                        "name": "operating_system",
                        "type": "string"
                      },
                      {
                        "name": "malware_path",
                        "type": "string"
                      },
                      {
                        "name": "url_path",
                        "type": "dynamic"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "long"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  },
                  "Custom-CBS_BreachedCredentials_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "email",
                        "type": "string"
                      },
                      {
                        "name": "username",
                        "type": "string"
                      },
                      {
                        "name": "breach_source",
                        "type": "dynamic"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "remarks",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "brand",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "long"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  },
                  "Custom-CBS_CompromisedCards_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "masked_password",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "user_domain",
                        "type": "string"
                      },
                      {
                        "name": "website",
                        "type": "string"
                      },
                      {
                        "name": "software",
                        "type": "string"
                      },
                      {
                        "name": "sources",
                        "type": "dynamic"
                      },
                      {
                        "name": "source_uri",
                        "type": "dynamic"
                      },
                      {
                        "name": "brand",
                        "type": "string"
                      },
                      {
                        "name": "remarks",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "long"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  },
                  "Custom-CBS_DomainInfringement_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "subject",
                        "type": "string"
                      },
                      {
                        "name": "confirmation_time",
                        "type": "long"
                      },
                      {
                        "name": "remarks",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "risks",
                        "type": "dynamic"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "incident_status",
                        "type": "string"
                      },
                      {
                        "name": "brand",
                        "type": "string"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "long"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  },
                  "Custom-CBS_SubdomainInfringement_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "subject",
                        "type": "string"
                      },
                      {
                        "name": "remarks",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "risks",
                        "type": "dynamic"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "brand",
                        "type": "string"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "long"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "CTM360CBSWorkspace"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-CBSLog_Azure_1_CL"
                    ],
                    "destinations": [
                      "CTM360CBSWorkspace"
                    ],
                    "outputStream": "Custom-CBSLog_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), IncidentId = tostring(['id']), Subject = tostring(subject), Severity = tostring(severity), IncidentType = tostring(['type']), Class = tostring(class), Status = tostring(['status']), COA = tostring(coa), Screenshots = screenshots, Remarks = tostring(remarks), ExternalLink = tostring(external_link), FirstSeen = tostring(first_seen), LastSeen = tostring(last_seen), Brand = tostring(brand), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, IncidentId, Subject, Severity, IncidentType, Class, Status, COA, Screenshots, Remarks, ExternalLink, FirstSeen, LastSeen, Brand, RawPayload"
                  },
                  {
                    "streams": [
                      "Custom-CBS_MalwareLogs_CL"
                    ],
                    "destinations": [
                      "CTM360CBSWorkspace"
                    ],
                    "outputStream": "Custom-CBS_MalwareLogs_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), Id = tostring(['id']), Domain = tostring(domain), Hostname = tostring(hostname), IncidentType = tostring(['type']), MaskedPassword = tostring(masked_password), User = tostring(user), UserDomain = tostring(user_domain), Website = tostring(website), Sources = sources, SourceUri = source_uri, Brand = tostring(brand), Remarks = tostring(remarks), ExternalLink = tostring(external_link), Status = tostring(['status']), StealerFamily = stealer_family, CompromiseDetails = compromise_details, DateCompromised = tostring(date_compromised), ComputerName = tostring(computer_name), OperatingSystem = tostring(operating_system), MalwarePath = tostring(malware_path), UrlPath = url_path, FirstSeen = tostring(first_seen), LastSeen = tostring(last_seen), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, Id, Domain, Hostname, IncidentType, MaskedPassword, User, UserDomain, Website, Sources, SourceUri, Brand, Remarks, ExternalLink, Status, StealerFamily, CompromiseDetails, DateCompromised, ComputerName, OperatingSystem, MalwarePath, UrlPath, FirstSeen, LastSeen, RawPayload"
                  },
                  {
                    "streams": [
                      "Custom-CBS_BreachedCredentials_CL"
                    ],
                    "destinations": [
                      "CTM360CBSWorkspace"
                    ],
                    "outputStream": "Custom-CBS_BreachedCredentials_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), Id = tostring(['id']), Domain = tostring(domain), Email = tostring(email), Username = tostring(username), BreachSource = breach_source, IncidentType = tostring(['type']), Remarks = tostring(remarks), ExternalLink = tostring(external_link), Brand = tostring(brand), Status = tostring(['status']), FirstSeen = tostring(first_seen), LastSeen = tostring(last_seen), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, Id, Domain, Email, Username, BreachSource, IncidentType, Remarks, ExternalLink, Brand, Status, FirstSeen, LastSeen, RawPayload"
                  },
                  {
                    "streams": [
                      "Custom-CBS_CompromisedCards_CL"
                    ],
                    "destinations": [
                      "CTM360CBSWorkspace"
                    ],
                    "outputStream": "Custom-CBS_CompromisedCards_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), Id = tostring(['id']), Domain = tostring(domain), Hostname = tostring(hostname), IncidentType = tostring(['type']), MaskedPassword = tostring(masked_password), User = tostring(user), UserDomain = tostring(user_domain), Website = tostring(website), Software = tostring(software), Sources = sources, SourceUri = source_uri, Brand = tostring(brand), Remarks = tostring(remarks), ExternalLink = tostring(external_link), Status = tostring(['status']), FirstSeen = tostring(first_seen), LastSeen = tostring(last_seen), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, Id, Domain, Hostname, IncidentType, MaskedPassword, User, UserDomain, Website, Software, Sources, SourceUri, Brand, Remarks, ExternalLink, Status, FirstSeen, LastSeen, RawPayload"
                  },
                  {
                    "streams": [
                      "Custom-CBS_DomainInfringement_CL"
                    ],
                    "destinations": [
                      "CTM360CBSWorkspace"
                    ],
                    "outputStream": "Custom-CBS_DomainInfringement_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), Id = tostring(['id']), Subject = tostring(subject), ConfirmationTime = tolong(confirmation_time), Remarks = tostring(remarks), ExternalLink = tostring(external_link), Severity = tostring(severity), IncidentType = tostring(['type']), Risks = risks, Status = tostring(['status']), IncidentStatus = tostring(incident_status), Brand = tostring(brand), FirstSeen = tostring(first_seen), LastSeen = tostring(last_seen), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, Id, Subject, ConfirmationTime, Remarks, ExternalLink, Severity, IncidentType, Risks, Status, IncidentStatus, Brand, FirstSeen, LastSeen, RawPayload"
                  },
                  {
                    "streams": [
                      "Custom-CBS_SubdomainInfringement_CL"
                    ],
                    "destinations": [
                      "CTM360CBSWorkspace"
                    ],
                    "outputStream": "Custom-CBS_SubdomainInfringement_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), Id = tostring(['id']), Subject = tostring(subject), Remarks = tostring(remarks), ExternalLink = tostring(external_link), Severity = tostring(severity), IncidentType = tostring(['type']), Risks = risks, Status = tostring(['status']), Brand = tostring(brand), FirstSeen = tostring(first_seen), LastSeen = tostring(last_seen), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Risks, Status, Brand, FirstSeen, LastSeen, RawPayload"
                  }
                ]
              }
            },
            {
              "name": "CBSLog_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CBSLog_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "IncidentId",
                      "type": "string"
                    },
                    {
                      "name": "Subject",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "IncidentType",
                      "type": "string"
                    },
                    {
                      "name": "Class",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "COA",
                      "type": "string"
                    },
                    {
                      "name": "Screenshots",
                      "type": "dynamic"
                    },
                    {
                      "name": "Remarks",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "Brand",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CBS_MalwareLogs_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CBS_MalwareLogs_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "Id",
                      "type": "string"
                    },
                    {
                      "name": "Domain",
                      "type": "string"
                    },
                    {
                      "name": "Hostname",
                      "type": "string"
                    },
                    {
                      "name": "IncidentType",
                      "type": "string"
                    },
                    {
                      "name": "MaskedPassword",
                      "type": "string"
                    },
                    {
                      "name": "User",
                      "type": "string"
                    },
                    {
                      "name": "UserDomain",
                      "type": "string"
                    },
                    {
                      "name": "Website",
                      "type": "string"
                    },
                    {
                      "name": "Sources",
                      "type": "dynamic"
                    },
                    {
                      "name": "SourceUri",
                      "type": "dynamic"
                    },
                    {
                      "name": "Brand",
                      "type": "string"
                    },
                    {
                      "name": "Remarks",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "StealerFamily",
                      "type": "dynamic"
                    },
                    {
                      "name": "CompromiseDetails",
                      "type": "dynamic"
                    },
                    {
                      "name": "DateCompromised",
                      "type": "string"
                    },
                    {
                      "name": "ComputerName",
                      "type": "string"
                    },
                    {
                      "name": "OperatingSystem",
                      "type": "string"
                    },
                    {
                      "name": "MalwarePath",
                      "type": "string"
                    },
                    {
                      "name": "UrlPath",
                      "type": "dynamic"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CBS_BreachedCredentials_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CBS_BreachedCredentials_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "Id",
                      "type": "string"
                    },
                    {
                      "name": "Domain",
                      "type": "string"
                    },
                    {
                      "name": "Email",
                      "type": "string"
                    },
                    {
                      "name": "Username",
                      "type": "string"
                    },
                    {
                      "name": "BreachSource",
                      "type": "dynamic"
                    },
                    {
                      "name": "IncidentType",
                      "type": "string"
                    },
                    {
                      "name": "Remarks",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "Brand",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CBS_CompromisedCards_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CBS_CompromisedCards_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "Id",
                      "type": "string"
                    },
                    {
                      "name": "Domain",
                      "type": "string"
                    },
                    {
                      "name": "Hostname",
                      "type": "string"
                    },
                    {
                      "name": "IncidentType",
                      "type": "string"
                    },
                    {
                      "name": "MaskedPassword",
                      "type": "string"
                    },
                    {
                      "name": "User",
                      "type": "string"
                    },
                    {
                      "name": "UserDomain",
                      "type": "string"
                    },
                    {
                      "name": "Website",
                      "type": "string"
                    },
                    {
                      "name": "Software",
                      "type": "string"
                    },
                    {
                      "name": "Sources",
                      "type": "dynamic"
                    },
                    {
                      "name": "SourceUri",
                      "type": "dynamic"
                    },
                    {
                      "name": "Brand",
                      "type": "string"
                    },
                    {
                      "name": "Remarks",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CBS_DomainInfringement_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CBS_DomainInfringement_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "Id",
                      "type": "string"
                    },
                    {
                      "name": "Subject",
                      "type": "string"
                    },
                    {
                      "name": "ConfirmationTime",
                      "type": "long"
                    },
                    {
                      "name": "Remarks",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "IncidentType",
                      "type": "string"
                    },
                    {
                      "name": "Risks",
                      "type": "dynamic"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "IncidentStatus",
                      "type": "string"
                    },
                    {
                      "name": "Brand",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CBS_SubdomainInfringement_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CBS_SubdomainInfringement_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "Id",
                      "type": "string"
                    },
                    {
                      "name": "Subject",
                      "type": "string"
                    },
                    {
                      "name": "Remarks",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "IncidentType",
                      "type": "string"
                    },
                    {
                      "name": "Risks",
                      "type": "dynamic"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "Brand",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "HackerViewLog_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "HackerViewLog_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "IssueId",
                      "type": "string"
                    },
                    {
                      "name": "Title",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "Category",
                      "type": "string"
                    },
                    {
                      "name": "Description",
                      "type": "string"
                    },
                    {
                      "name": "AssetName",
                      "type": "string"
                    },
                    {
                      "name": "AssetType",
                      "type": "string"
                    },
                    {
                      "name": "Port",
                      "type": "int"
                    },
                    {
                      "name": "Protocol",
                      "type": "string"
                    },
                    {
                      "name": "IpAddress",
                      "type": "string"
                    },
                    {
                      "name": "Technology",
                      "type": "string"
                    },
                    {
                      "name": "Cve",
                      "type": "string"
                    },
                    {
                      "name": "CvssScore",
                      "type": "real"
                    },
                    {
                      "name": "Remediation",
                      "type": "string"
                    },
                    {
                      "name": "References",
                      "type": "string"
                    },
                    {
                      "name": "Tags",
                      "type": "string"
                    },
                    {
                      "name": "Priority",
                      "type": "string"
                    },
                    {
                      "name": "AssignedTo",
                      "type": "string"
                    },
                    {
                      "name": "Notes",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "CreatedAt",
                      "type": "string"
                    },
                    {
                      "name": "UpdatedAt",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "CTM360CBSConnectorDefinition",
          "title": "CTM360 CyberBlindSpot (Serverless)",
          "publisher": "CTM360",
          "descriptionMarkdown": "The CTM360 Cyber Blind Spot (CBS) connector provides integration with CTM360's CBS platform to ingest security data across 6 module types: incidents, malware logs, breached credentials, compromised cards, domain infringement, and subdomain infringement. This connector uses the Codeless Connector Framework (CCF) for serverless data collection.\n\n**Data Types:**\n- CBSLog_AzureV2_CL\n- CBS_MalwareLogs_AzureV2_CL\n- CBS_BreachedCredentials_AzureV2_CL\n- CBS_CompromisedCards_AzureV2_CL\n- CBS_DomainInfringement_AzureV2_CL\n- CBS_SubdomainInfringement_AzureV2_CL",
          "graphQueriesTableName": "CBSLog_AzureV2_CL",
          "graphQueries": [
            {
              "metricName": "Incidents",
              "legend": "CBSLog_AzureV2_CL",
              "baseQuery": "CBSLog_AzureV2_CL"
            },
            {
              "metricName": "Malware Logs",
              "legend": "CBS_MalwareLogs_AzureV2_CL",
              "baseQuery": "CBS_MalwareLogs_AzureV2_CL"
            },
            {
              "metricName": "Breached Credentials",
              "legend": "CBS_BreachedCredentials_AzureV2_CL",
              "baseQuery": "CBS_BreachedCredentials_AzureV2_CL"
            },
            {
              "metricName": "Compromised Cards",
              "legend": "CBS_CompromisedCards_AzureV2_CL",
              "baseQuery": "CBS_CompromisedCards_AzureV2_CL"
            },
            {
              "metricName": "Domain Infringement",
              "legend": "CBS_DomainInfringement_AzureV2_CL",
              "baseQuery": "CBS_DomainInfringement_AzureV2_CL"
            },
            {
              "metricName": "Subdomain Infringement",
              "legend": "CBS_SubdomainInfringement_AzureV2_CL",
              "baseQuery": "CBS_SubdomainInfringement_AzureV2_CL"
            }
          ],
          "sampleQueries": [
            {
              "description": "All Incidents",
              "query": "CBSLog_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
            },
            {
              "description": "All Malware Logs",
              "query": "CBS_MalwareLogs_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
            },
            {
              "description": "Breached Credentials",
              "query": "CBS_BreachedCredentials_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
            },
            {
              "description": "Compromised Cards",
              "query": "CBS_CompromisedCards_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
            },
            {
              "description": "Recent Domain Infringements",
              "query": "CBS_DomainInfringement_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
            },
            {
              "description": "Recent Subdomain Infringements",
              "query": "CBS_SubdomainInfringement_AzureV2_CL\n| sort by TimeGenerated desc\n| take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "CBSLog_AzureV2_CL",
              "lastDataReceivedQuery": "CBSLog_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            },
            {
              "name": "CBS_MalwareLogs_AzureV2_CL",
              "lastDataReceivedQuery": "CBS_MalwareLogs_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            },
            {
              "name": "CBS_BreachedCredentials_AzureV2_CL",
              "lastDataReceivedQuery": "CBS_BreachedCredentials_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            },
            {
              "name": "CBS_CompromisedCards_AzureV2_CL",
              "lastDataReceivedQuery": "CBS_CompromisedCards_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            },
            {
              "name": "CBS_DomainInfringement_AzureV2_CL",
              "lastDataReceivedQuery": "CBS_DomainInfringement_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            },
            {
              "name": "CBS_SubdomainInfringement_AzureV2_CL",
              "lastDataReceivedQuery": "CBS_SubdomainInfringement_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "CTM360 CBS API Key",
                "description": "A valid CTM360 Cyber Blind Spot API key is required to connect to the CBS API endpoint."
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Connect CTM360 Cyber Blind Spot to Microsoft Sentinel",
              "description": "This connector uses the Codeless Connector Framework (CCF) to ingest data from CTM360 CBS into Microsoft Sentinel. Data is collected every 5 minutes across 6 different module types.",
              "instructions": [
                {
                  "type": "InfoMessage",
                  "parameters": {
                    "text": "This connector creates 6 separate tables for different CBS module types: Incidents, Malware Logs, Breached Credentials, Compromised Cards, Domain Infringement, and Subdomain Infringement.",
                    "inline": true
                  }
                }
              ]
            },
            {
              "title": "Step 1: Obtain CTM360 API Keys",
              "description": "To setup this integration, you will need CBS API Key. You can get these keys using the following links:\n\nCBS API Key found from this link: https://platform.ctm360.com/start/integrations after logging with you account"
            },
            {
              "title": "Step 2: Configure Connection",
              "description": "Enter your CTM360 CBS API key and connect to start data ingestion.",
              "instructions": [
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "CTM360 CBS API Key",
                    "placeholder": "Enter your CTM360 CBS API Key",
                    "type": "password",
                    "name": "apiKey"
                  }
                },
                {
                  "type": "ConnectionToggleButton",
                  "parameters": {
                    "connectLabel": "Connect",
                    "disconnectLabel": "Disconnect",
                    "name": "connect"
                  }
                }
              ]
            },
            {
              "title": "Step 3: Verify Data Ingestion",
              "description": "After connecting, data should start flowing within 5-10 minutes. Use the sample queries above to verify data ingestion for each module type.",
              "instructions": [
                {
                  "type": "InfoMessage",
                  "parameters": {
                    "text": "Note: Initial data ingestion may take up to 30 minutes. The connector polls every 5 minutes with a 5-minute rolling window.",
                    "inline": true
                  }
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
        "displayName": "CTM360 CyberBlindSpot (Serverless)",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "connectorDefinitionName": {
              "defaultValue": "CTM360 CyberBlindSpot (Serverless)",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "apiKey": {
              "defaultValue": "apiKey",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections1": "[variables('_dataConnectorContentIdConnections1')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360CBSIncidents', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360CBSConnectorDefinition",
                "dataType": "CBSLog_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
                  "httpMethod": "GET",
                  "queryTimeFormat": "UnixTimestampInMills",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "queryParameters": {
                    "date_from": "{_QueryWindowStartTime}",
                    "date_to": "{_QueryWindowEndTime}",
                    "module_type": "incidents",
                    "max_hits": "10000"
                  },
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.hits"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-CBSLog_Azure_1_CL"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360CBSMalwareLogs', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360CBSConnectorDefinition",
                "dataType": "CBS_MalwareLogs_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
                  "httpMethod": "GET",
                  "queryTimeFormat": "UnixTimestampInMills",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "queryParameters": {
                    "date_from": "{_QueryWindowStartTime}",
                    "date_to": "{_QueryWindowEndTime}",
                    "module_type": "malware_logs",
                    "max_hits": "10000"
                  },
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.hits"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-CBS_MalwareLogs_CL"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360CBSBreachedCredentials', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360CBSConnectorDefinition",
                "dataType": "CBS_BreachedCredentials_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
                  "httpMethod": "GET",
                  "queryTimeFormat": "UnixTimestampInMills",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "queryParameters": {
                    "date_from": "{_QueryWindowStartTime}",
                    "date_to": "{_QueryWindowEndTime}",
                    "module_type": "breached_credentials",
                    "max_hits": "10000"
                  },
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.hits"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-CBS_BreachedCredentials_CL"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360CBSCompromisedCards', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360CBSConnectorDefinition",
                "dataType": "CBS_CompromisedCards_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
                  "httpMethod": "GET",
                  "queryTimeFormat": "UnixTimestampInMills",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "queryParameters": {
                    "date_from": "{_QueryWindowStartTime}",
                    "date_to": "{_QueryWindowEndTime}",
                    "module_type": "compromised_cards",
                    "max_hits": "10000"
                  },
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.hits"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-CBS_CompromisedCards_CL"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360CBSDomainInfringement', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360CBSConnectorDefinition",
                "dataType": "CBS_DomainInfringement_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
                  "httpMethod": "GET",
                  "queryTimeFormat": "UnixTimestampInMills",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "queryParameters": {
                    "date_from": "{_QueryWindowStartTime}",
                    "date_to": "{_QueryWindowEndTime}",
                    "module_type": "domain_infringement",
                    "max_hits": "10000",
                    "risk_score_min": "0",
                    "risk_score_max": "100"
                  },
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.hits"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-CBS_DomainInfringement_CL"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360CBSSubdomainInfringement', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360CBSConnectorDefinition",
                "dataType": "CBS_SubdomainInfringement_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
                  "httpMethod": "GET",
                  "queryTimeFormat": "UnixTimestampInMills",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "queryParameters": {
                    "date_from": "{_QueryWindowStartTime}",
                    "date_to": "{_QueryWindowEndTime}",
                    "module_type": "subdomain_infringement",
                    "max_hits": "10000",
                    "risk_score_min": "0",
                    "risk_score_max": "100"
                  },
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.hits"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-CBS_SubdomainInfringement_CL"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition2'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition2')]",
        "displayName": "CTM360 HackerView (Serverless)",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition2'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "CTM360HackerViewConnectorDefinition",
                  "title": "CTM360 HackerView (Serverless)",
                  "publisher": "CTM360",
                  "descriptionMarkdown": "The CTM360 HackerView connector enables you to ingest security issues and vulnerabilities from your HackerView External Attack Surface Management platform into Microsoft Sentinel. This serverless connector uses the REST API to automatically pull issue data for analysis and correlation with other security events.",
                  "graphQueriesTableName": "HackerViewLog_AzureV2_CL",
                  "graphQueries": [
                    {
                      "metricName": "Total Issues Received",
                      "legend": "HackerView Issues",
                      "baseQuery": "HackerViewLog_AzureV2_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "All HackerView Issues",
                      "query": "HackerViewLog_AzureV2_CL\n| take 10"
                    },
                    {
                      "description": "High Severity Issues",
                      "query": "HackerViewLog_AzureV2_CL\n| where Severity == 'High'\n| summarize count() by Category"
                    },
                    {
                      "description": "Recent Issues (Last 24 Hours)",
                      "query": "HackerViewLog_AzureV2_CL\n| where TimeGenerated > ago(24h)\n| project TimeGenerated, Title, Severity, Status, Category"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "HackerViewLog_AzureV2_CL",
                      "lastDataReceivedQuery": "HackerViewLog_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "read": true,
                          "write": true,
                          "delete": false
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "HackerView API Key",
                        "description": "A valid HackerView API key with permissions to access issues data is required."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "Connect CTM360 HackerView to Microsoft Sentinel",
                      "description": "This connector uses the HackerView REST API to automatically ingest security issues into Microsoft Sentinel.",
                      "instructions": [
                        {
                          "type": "InfoMessage",
                          "parameters": {
                            "text": "This is a serverless connector that uses Azure's Codeless Connector Platform (CCP). No Azure Function deployment is required."
                          }
                        }
                      ]
                    },
                    {
                      "title": "Step 1: Obtain CTM360 API Keys",
                      "description": "To setup this integration, you will need HackerView API Key. You can get these keys using the following links:\n\nHackerView API Key found from this link: https://platform.ctm360.com/start/integrations after logging with you account"
                    },
                    {
                      "title": "Step 2: Configure the Connector",
                      "description": "Enter your HackerView API key and click Connect to begin data ingestion.",
                      "instructions": [
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "API Key",
                            "placeholder": "Enter your HackerView API Key",
                            "type": "password",
                            "name": "apiKey"
                          }
                        },
                        {
                          "type": "ConnectionToggleButton",
                          "parameters": {
                            "connectLabel": "Connect",
                            "disconnectLabel": "Disconnect",
                            "name": "connect"
                          }
                        }
                      ]
                    },
                    {
                      "title": "Step 3: Verify Data Ingestion",
                      "description": "After connecting, data should start flowing within 5-10 minutes. Run the following query to verify:",
                      "instructions": [
                        {
                          "type": "InfoMessage",
                          "parameters": {
                            "text": "HackerViewLog_AzureV2_CL\n| take 10"
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition2')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition2'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition2')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections2')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "CTM360HackerViewDCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "description": "Data collection rule for CTM360 HackerView connector with Data Collector API type-suffixed schema",
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId2')]",
                "streamDeclarations": {
                  "Custom-HackerViewLog_Azure_1_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "title",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "first_seen",
                        "type": "string"
                      },
                      {
                        "name": "last_seen",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "description",
                        "type": "string"
                      },
                      {
                        "name": "asset_name",
                        "type": "string"
                      },
                      {
                        "name": "asset_type",
                        "type": "string"
                      },
                      {
                        "name": "port",
                        "type": "int"
                      },
                      {
                        "name": "protocol",
                        "type": "string"
                      },
                      {
                        "name": "ip_address",
                        "type": "string"
                      },
                      {
                        "name": "technology",
                        "type": "string"
                      },
                      {
                        "name": "cve",
                        "type": "string"
                      },
                      {
                        "name": "cvss_score",
                        "type": "real"
                      },
                      {
                        "name": "remediation",
                        "type": "string"
                      },
                      {
                        "name": "references",
                        "type": "string"
                      },
                      {
                        "name": "tags",
                        "type": "string"
                      },
                      {
                        "name": "priority",
                        "type": "string"
                      },
                      {
                        "name": "assigned_to",
                        "type": "string"
                      },
                      {
                        "name": "notes",
                        "type": "string"
                      },
                      {
                        "name": "external_link",
                        "type": "string"
                      },
                      {
                        "name": "created_at",
                        "type": "string"
                      },
                      {
                        "name": "updated_at",
                        "type": "string"
                      },
                      {
                        "name": "raw_payload",
                        "type": "dynamic"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "CTM360HVWorkspace"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-HackerViewLog_Azure_1_CL"
                    ],
                    "destinations": [
                      "CTM360HVWorkspace"
                    ],
                    "outputStream": "Custom-HackerViewLog_AzureV2_CL",
                    "transformKql": "source | extend TimeGenerated = now(), IssueId = columnifexists('id', ''), Title = columnifexists('title', ''), Severity = columnifexists('severity', ''), Status = columnifexists('status', ''), FirstSeen = columnifexists('first_seen', ''), LastSeen = columnifexists('last_seen', ''), Category = columnifexists('category', ''), Description = columnifexists('description', ''), AssetName = columnifexists('asset_name', ''), AssetType = columnifexists('asset_type', ''), Port = toint(columnifexists('port', 0)), Protocol = columnifexists('protocol', ''), IpAddress = columnifexists('ip_address', ''), Technology = columnifexists('technology', ''), Cve = columnifexists('cve', ''), CvssScore = toreal(columnifexists('cvss_score', 0.0)), Remediation = columnifexists('remediation', ''), References = columnifexists('references', ''), Tags = columnifexists('tags', ''), Priority = columnifexists('priority', ''), AssignedTo = columnifexists('assigned_to', ''), Notes = columnifexists('notes', ''), ExternalLink = columnifexists('external_link', ''), CreatedAt = columnifexists('created_at', ''), UpdatedAt = columnifexists('updated_at', ''), RawPayload = todynamic(columnifexists('raw_payload', '{}')) | project TimeGenerated, IssueId, Title, Severity, Status, FirstSeen, LastSeen, Category, Description, AssetName, AssetType, Port, Protocol, IpAddress, Technology, Cve, CvssScore, Remediation, References, Tags, Priority, AssignedTo, Notes, ExternalLink, CreatedAt, UpdatedAt, RawPayload"
                  }
                ]
              }
            },
            {
              "name": "HackerViewLog_AzureV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "HackerViewLog_AzureV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "IssueId",
                      "type": "string"
                    },
                    {
                      "name": "Title",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "LastSeen",
                      "type": "string"
                    },
                    {
                      "name": "Category",
                      "type": "string"
                    },
                    {
                      "name": "Description",
                      "type": "string"
                    },
                    {
                      "name": "AssetName",
                      "type": "string"
                    },
                    {
                      "name": "AssetType",
                      "type": "string"
                    },
                    {
                      "name": "Port",
                      "type": "int"
                    },
                    {
                      "name": "Protocol",
                      "type": "string"
                    },
                    {
                      "name": "IpAddress",
                      "type": "string"
                    },
                    {
                      "name": "Technology",
                      "type": "string"
                    },
                    {
                      "name": "Cve",
                      "type": "string"
                    },
                    {
                      "name": "CvssScore",
                      "type": "real"
                    },
                    {
                      "name": "Remediation",
                      "type": "string"
                    },
                    {
                      "name": "References",
                      "type": "string"
                    },
                    {
                      "name": "Tags",
                      "type": "string"
                    },
                    {
                      "name": "Priority",
                      "type": "string"
                    },
                    {
                      "name": "AssignedTo",
                      "type": "string"
                    },
                    {
                      "name": "Notes",
                      "type": "string"
                    },
                    {
                      "name": "ExternalLink",
                      "type": "string"
                    },
                    {
                      "name": "CreatedAt",
                      "type": "string"
                    },
                    {
                      "name": "UpdatedAt",
                      "type": "string"
                    },
                    {
                      "name": "RawPayload",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition2'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition2'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "CTM360HackerViewConnectorDefinition",
          "title": "CTM360 HackerView (Serverless)",
          "publisher": "CTM360",
          "descriptionMarkdown": "The CTM360 HackerView connector enables you to ingest security issues and vulnerabilities from your HackerView External Attack Surface Management platform into Microsoft Sentinel. This serverless connector uses the REST API to automatically pull issue data for analysis and correlation with other security events.",
          "graphQueriesTableName": "HackerViewLog_AzureV2_CL",
          "graphQueries": [
            {
              "metricName": "Total Issues Received",
              "legend": "HackerView Issues",
              "baseQuery": "HackerViewLog_AzureV2_CL"
            }
          ],
          "sampleQueries": [
            {
              "description": "All HackerView Issues",
              "query": "HackerViewLog_AzureV2_CL\n| take 10"
            },
            {
              "description": "High Severity Issues",
              "query": "HackerViewLog_AzureV2_CL\n| where Severity == 'High'\n| summarize count() by Category"
            },
            {
              "description": "Recent Issues (Last 24 Hours)",
              "query": "HackerViewLog_AzureV2_CL\n| where TimeGenerated > ago(24h)\n| project TimeGenerated, Title, Severity, Status, Category"
            }
          ],
          "dataTypes": [
            {
              "name": "HackerViewLog_AzureV2_CL",
              "lastDataReceivedQuery": "HackerViewLog_AzureV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "read": true,
                  "write": true,
                  "delete": false
                }
              }
            ],
            "customs": [
              {
                "name": "HackerView API Key",
                "description": "A valid HackerView API key with permissions to access issues data is required."
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Connect CTM360 HackerView to Microsoft Sentinel",
              "description": "This connector uses the HackerView REST API to automatically ingest security issues into Microsoft Sentinel.",
              "instructions": [
                {
                  "type": "InfoMessage",
                  "parameters": {
                    "text": "This is a serverless connector that uses Azure's Codeless Connector Platform (CCP). No Azure Function deployment is required."
                  }
                }
              ]
            },
            {
              "title": "Step 1: Obtain CTM360 API Keys",
              "description": "To setup this integration, you will need HackerView API Key. You can get these keys using the following links:\n\nHackerView API Key found from this link: https://platform.ctm360.com/start/integrations after logging with you account"
            },
            {
              "title": "Step 2: Configure the Connector",
              "description": "Enter your HackerView API key and click Connect to begin data ingestion.",
              "instructions": [
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "API Key",
                    "placeholder": "Enter your HackerView API Key",
                    "type": "password",
                    "name": "apiKey"
                  }
                },
                {
                  "type": "ConnectionToggleButton",
                  "parameters": {
                    "connectLabel": "Connect",
                    "disconnectLabel": "Disconnect",
                    "name": "connect"
                  }
                }
              ]
            },
            {
              "title": "Step 3: Verify Data Ingestion",
              "description": "After connecting, data should start flowing within 5-10 minutes. Run the following query to verify:",
              "instructions": [
                {
                  "type": "InfoMessage",
                  "parameters": {
                    "text": "HackerViewLog_AzureV2_CL\n| take 10"
                  }
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition2')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition2'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition2')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections2')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections2'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections2')]",
        "displayName": "CTM360 HackerView (Serverless)",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "connectorDefinitionName": {
              "defaultValue": "CTM360 HackerView (Serverless)",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "apiKey": {
              "defaultValue": "apiKey",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections2": "[variables('_dataConnectorContentIdConnections2')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections2')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections2'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections2')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CTM360HackerViewIssues', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CTM360HackerViewConnectorDefinition",
                "dataType": "HackerViewLog_AzureV2_CL",
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('apiKey')]",
                  "ApiKeyName": "api-key",
                  "IsApiKeyInPostPayload": false
                },
                "request": {
                  "apiEndpoint": "https://hackerview.ctm360.com/api/v2/issues",
                  "httpMethod": "GET",
                  "queryTimeFormat": "dd-MM-yyyy HH:mm",
                  "queryWindowInMin": 5,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "accept": "application/json"
                  },
                  "startTimeAttributeName": "first_seen",
                  "rateLimitQPS": 2
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.issues"
                  ],
                  "format": "json"
                },
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-HackerViewLog_Azure_1_CL"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections2'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject1').parserTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "HackerViewLog_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject1').parserVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject1')._parserName1]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for HackerViewLog",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "HackerViewLog",
                "query": "let HackerViewV1_Empty = datatable(\n    id_s:string, title_s:string, severity_s:string, status_s:string,\n    first_seen_s:string, last_seen_s:string, category_s:string, description_s:string,\n    asset_name_s:string, asset_type_s:string, port_d:int, protocol_s:string,\n    ip_address_s:string, technology_s:string, cve_s:string, cvss_score_d:real,\n    remediation_s:string, references_s:string, tags_s:string, priority_s:string,\n    assigned_to_s:string, notes_s:string, external_link_s:string,\n    created_at_s:string, updated_at_s:string\n)[];\nlet HackerViewV1_view = union isfuzzy=true HackerViewLog_Azure_1_CL, HackerViewV1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'HackerView',\n             SourceConnector = 'FunctionApp',\n             IssueId = column_ifexists('id_s', ''),\n             Title = column_ifexists('title_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             Status = column_ifexists('status_s', ''),\n             FirstSeen = column_ifexists('first_seen_s', ''),\n             LastSeen = column_ifexists('last_seen_s', ''),\n             Category = column_ifexists('category_s', ''),\n             Description = column_ifexists('description_s', ''),\n             AssetName = column_ifexists('asset_name_s', ''),\n             AssetType = column_ifexists('asset_type_s', ''),\n             Port = toint(column_ifexists('port_d', 0)),\n             Protocol = column_ifexists('protocol_s', ''),\n             IpAddress = column_ifexists('ip_address_s', ''),\n             Technology = column_ifexists('technology_s', ''),\n             Cve = column_ifexists('cve_s', ''),\n             CvssScore = toreal(column_ifexists('cvss_score_d', 0.0)),\n             Remediation = column_ifexists('remediation_s', ''),\n             References = column_ifexists('references_s', ''),\n             Tags = column_ifexists('tags_s', ''),\n             Priority = column_ifexists('priority_s', ''),\n             AssignedTo = column_ifexists('assigned_to_s', ''),\n             Notes = column_ifexists('notes_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             CreatedAt = column_ifexists('created_at_s', ''),\n               UpdatedAt = column_ifexists('updated_at_s', ''),\n               RawPayload = '';\nlet HackerViewV2_view = HackerViewLog_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'HackerView',\n               SourceConnector = 'CCF',\n               RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true HackerViewV2_view, HackerViewV1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, SourceConnector, IssueId, Title, Severity, Status, FirstSeen, LastSeen, Category, Description, AssetName, AssetType, Port, Protocol, IpAddress, Technology, Cve, CvssScore, Remediation, References, Tags, Priority, AssignedTo, Notes, ExternalLink, CreatedAt, UpdatedAt, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
              "dependsOn": [
                "[variables('parserObject1')._parserId1]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'HackerViewLog')]",
                "contentId": "[variables('parserObject1').parserContentId1]",
                "kind": "Parser",
                "version": "[variables('parserObject1').parserVersion1]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "contentKind": "Parser",
        "displayName": "Parser for HackerViewLog",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.1.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.1.0')))]",
        "version": "[variables('parserObject1').parserVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject1')._parserName1]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for HackerViewLog",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "HackerViewLog",
        "query": "let HackerViewV1_Empty = datatable(\n    id_s:string, title_s:string, severity_s:string, status_s:string,\n    first_seen_s:string, last_seen_s:string, category_s:string, description_s:string,\n    asset_name_s:string, asset_type_s:string, port_d:int, protocol_s:string,\n    ip_address_s:string, technology_s:string, cve_s:string, cvss_score_d:real,\n    remediation_s:string, references_s:string, tags_s:string, priority_s:string,\n    assigned_to_s:string, notes_s:string, external_link_s:string,\n    created_at_s:string, updated_at_s:string\n)[];\nlet HackerViewV1_view = union isfuzzy=true HackerViewLog_Azure_1_CL, HackerViewV1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'HackerView',\n             SourceConnector = 'FunctionApp',\n             IssueId = column_ifexists('id_s', ''),\n             Title = column_ifexists('title_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             Status = column_ifexists('status_s', ''),\n             FirstSeen = column_ifexists('first_seen_s', ''),\n             LastSeen = column_ifexists('last_seen_s', ''),\n             Category = column_ifexists('category_s', ''),\n             Description = column_ifexists('description_s', ''),\n             AssetName = column_ifexists('asset_name_s', ''),\n             AssetType = column_ifexists('asset_type_s', ''),\n             Port = toint(column_ifexists('port_d', 0)),\n             Protocol = column_ifexists('protocol_s', ''),\n             IpAddress = column_ifexists('ip_address_s', ''),\n             Technology = column_ifexists('technology_s', ''),\n             Cve = column_ifexists('cve_s', ''),\n             CvssScore = toreal(column_ifexists('cvss_score_d', 0.0)),\n             Remediation = column_ifexists('remediation_s', ''),\n             References = column_ifexists('references_s', ''),\n             Tags = column_ifexists('tags_s', ''),\n             Priority = column_ifexists('priority_s', ''),\n             AssignedTo = column_ifexists('assigned_to_s', ''),\n             Notes = column_ifexists('notes_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             CreatedAt = column_ifexists('created_at_s', ''),\n               UpdatedAt = column_ifexists('updated_at_s', ''),\n               RawPayload = '';\nlet HackerViewV2_view = HackerViewLog_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'HackerView',\n               SourceConnector = 'CCF',\n               RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true HackerViewV2_view, HackerViewV1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, SourceConnector, IssueId, Title, Severity, Status, FirstSeen, LastSeen, Category, Description, AssetName, AssetType, Port, Protocol, IpAddress, Technology, Cve, CvssScore, Remediation, References, Tags, Priority, AssignedTo, Notes, ExternalLink, CreatedAt, UpdatedAt, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
      "dependsOn": [
        "[variables('parserObject1')._parserId1]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'HackerViewLog')]",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "kind": "Parser",
        "version": "[variables('parserObject1').parserVersion1]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject2').parserTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBSLog_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject2').parserVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject2')._parserName2]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CBSLog (Incidents)",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CBSLog",
                "query": "let CBSV1_Empty = datatable(\n    id_s:string, subject_s:string, severity_s:string, type_s:string,\n    class_s:string, status_s:string, coa_s:string, remarks_s:string,\n    external_link_s:string, first_seen_s:string, last_seen_s:string,\n    brand_s:string, screenshots_g:dynamic\n)[];\nlet CBSV1_view = union isfuzzy=true CBSLog_Azure_1_CL, CBSV1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             SourceConnector = 'FunctionApp',\n             IncidentId = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Class = column_ifexists('class_s', ''),\n             Status = column_ifexists('status_s', ''),\n             COA = column_ifexists('coa_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             FirstSeen = column_ifexists('first_seen_s', ''),\n             LastSeen = column_ifexists('last_seen_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             Screenshots = column_ifexists('screenshots_g', dynamic(null)),\n             RawPayload = '';\nlet CBSV2_view = CBSLog_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true CBSV2_view, CBSV1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, SourceConnector, IncidentId, Subject, Severity, IncidentType, Class, Status, COA, Screenshots, Remarks, ExternalLink, FirstSeen, LastSeen, Brand, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
              "dependsOn": [
                "[variables('parserObject2')._parserId2]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBSLog')]",
                "contentId": "[variables('parserObject2').parserContentId2]",
                "kind": "Parser",
                "version": "[variables('parserObject2').parserVersion2]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "contentKind": "Parser",
        "displayName": "Parser for CBSLog (Incidents)",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '1.1.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '1.1.0')))]",
        "version": "[variables('parserObject2').parserVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject2')._parserName2]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CBSLog (Incidents)",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CBSLog",
        "query": "let CBSV1_Empty = datatable(\n    id_s:string, subject_s:string, severity_s:string, type_s:string,\n    class_s:string, status_s:string, coa_s:string, remarks_s:string,\n    external_link_s:string, first_seen_s:string, last_seen_s:string,\n    brand_s:string, screenshots_g:dynamic\n)[];\nlet CBSV1_view = union isfuzzy=true CBSLog_Azure_1_CL, CBSV1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             SourceConnector = 'FunctionApp',\n             IncidentId = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Class = column_ifexists('class_s', ''),\n             Status = column_ifexists('status_s', ''),\n             COA = column_ifexists('coa_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             FirstSeen = column_ifexists('first_seen_s', ''),\n             LastSeen = column_ifexists('last_seen_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             Screenshots = column_ifexists('screenshots_g', dynamic(null)),\n             RawPayload = '';\nlet CBSV2_view = CBSLog_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true CBSV2_view, CBSV1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, SourceConnector, IncidentId, Subject, Severity, IncidentType, Class, Status, COA, Screenshots, Remarks, ExternalLink, FirstSeen, LastSeen, Brand, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
      "dependsOn": [
        "[variables('parserObject2')._parserId2]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBSLog')]",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "kind": "Parser",
        "version": "[variables('parserObject2').parserVersion2]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject3').parserTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBS_BreachedCredentials_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject3').parserVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject3')._parserName3]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CBS BreachedCredentials",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CBS_BreachedCredentials",
                "query": "let V1_Empty = datatable(\n    id_s:string, domain_s:string, email_s:string, username_s:string, type_s:string, remarks_s:string, external_link_s:string, brand_s:string, severity_s:string, status_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_BreachedCredentials_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'BreachedCredentials',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Domain = column_ifexists('domain_s', ''),\n             Email = column_ifexists('email_s', ''),\n             Username = column_ifexists('username_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             Status = column_ifexists('status_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_BreachedCredentials_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'BreachedCredentials',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Domain, Email, Username, IncidentType, Remarks, ExternalLink, Brand, Severity, Status, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
              "dependsOn": [
                "[variables('parserObject3')._parserId3]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_BreachedCredentials')]",
                "contentId": "[variables('parserObject3').parserContentId3]",
                "kind": "Parser",
                "version": "[variables('parserObject3').parserVersion3]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "contentKind": "Parser",
        "displayName": "Parser for CBS BreachedCredentials",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "version": "[variables('parserObject3').parserVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject3')._parserName3]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CBS BreachedCredentials",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CBS_BreachedCredentials",
        "query": "let V1_Empty = datatable(\n    id_s:string, domain_s:string, email_s:string, username_s:string, type_s:string, remarks_s:string, external_link_s:string, brand_s:string, severity_s:string, status_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_BreachedCredentials_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'BreachedCredentials',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Domain = column_ifexists('domain_s', ''),\n             Email = column_ifexists('email_s', ''),\n             Username = column_ifexists('username_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             Status = column_ifexists('status_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_BreachedCredentials_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'BreachedCredentials',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Domain, Email, Username, IncidentType, Remarks, ExternalLink, Brand, Severity, Status, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
      "dependsOn": [
        "[variables('parserObject3')._parserId3]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_BreachedCredentials')]",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "kind": "Parser",
        "version": "[variables('parserObject3').parserVersion3]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject4').parserTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBS_CompromisedCards_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject4').parserVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject4')._parserName4]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CBS CompromisedCards",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CBS_CompromisedCards",
                "query": "let V1_Empty = datatable(\n    id_s:string, domain_s:string, hostname_s:string, type_s:string, masked_password_s:string, user_s:string, user_domain_s:string, website_s:string, remarks_s:string, external_link_s:string, brand_s:string, severity_s:string, status_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_CompromisedCards_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'CompromisedCards',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Domain = column_ifexists('domain_s', ''),\n             Hostname = column_ifexists('hostname_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             MaskedPassword = column_ifexists('masked_password_s', ''),\n             User = column_ifexists('user_s', ''),\n             UserDomain = column_ifexists('user_domain_s', ''),\n             Website = column_ifexists('website_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             Status = column_ifexists('status_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_CompromisedCards_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'CompromisedCards',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Domain, Hostname, IncidentType, MaskedPassword, User, UserDomain, Website, Remarks, ExternalLink, Brand, Severity, Status, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject4')._parserId4,'/'))))]",
              "dependsOn": [
                "[variables('parserObject4')._parserId4]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_CompromisedCards')]",
                "contentId": "[variables('parserObject4').parserContentId4]",
                "kind": "Parser",
                "version": "[variables('parserObject4').parserVersion4]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject4').parserContentId4]",
        "contentKind": "Parser",
        "displayName": "Parser for CBS CompromisedCards",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject4').parserContentId4,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject4').parserContentId4,'-', '1.0.0')))]",
        "version": "[variables('parserObject4').parserVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject4')._parserName4]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CBS CompromisedCards",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CBS_CompromisedCards",
        "query": "let V1_Empty = datatable(\n    id_s:string, domain_s:string, hostname_s:string, type_s:string, masked_password_s:string, user_s:string, user_domain_s:string, website_s:string, remarks_s:string, external_link_s:string, brand_s:string, severity_s:string, status_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_CompromisedCards_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'CompromisedCards',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Domain = column_ifexists('domain_s', ''),\n             Hostname = column_ifexists('hostname_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             MaskedPassword = column_ifexists('masked_password_s', ''),\n             User = column_ifexists('user_s', ''),\n             UserDomain = column_ifexists('user_domain_s', ''),\n             Website = column_ifexists('website_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             Status = column_ifexists('status_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_CompromisedCards_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'CompromisedCards',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Domain, Hostname, IncidentType, MaskedPassword, User, UserDomain, Website, Remarks, ExternalLink, Brand, Severity, Status, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject4')._parserId4,'/'))))]",
      "dependsOn": [
        "[variables('parserObject4')._parserId4]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_CompromisedCards')]",
        "contentId": "[variables('parserObject4').parserContentId4]",
        "kind": "Parser",
        "version": "[variables('parserObject4').parserVersion4]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject5').parserTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBS_DomainInfringement_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject5').parserVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject5')._parserName5]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CBS DomainInfringement",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CBS_DomainInfringement",
                "query": "let V1_Empty = datatable(\n    id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, incident_status_s:string, brand_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_DomainInfringement_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'DomainInfringement',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Status = column_ifexists('status_s', ''),\n             IncidentStatus = column_ifexists('incident_status_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_DomainInfringement_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'DomainInfringement',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, IncidentStatus, Brand, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject5')._parserId5,'/'))))]",
              "dependsOn": [
                "[variables('parserObject5')._parserId5]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_DomainInfringement')]",
                "contentId": "[variables('parserObject5').parserContentId5]",
                "kind": "Parser",
                "version": "[variables('parserObject5').parserVersion5]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject5').parserContentId5]",
        "contentKind": "Parser",
        "displayName": "Parser for CBS DomainInfringement",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject5').parserContentId5,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject5').parserContentId5,'-', '1.0.0')))]",
        "version": "[variables('parserObject5').parserVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject5')._parserName5]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CBS DomainInfringement",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CBS_DomainInfringement",
        "query": "let V1_Empty = datatable(\n    id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, incident_status_s:string, brand_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_DomainInfringement_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'DomainInfringement',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Status = column_ifexists('status_s', ''),\n             IncidentStatus = column_ifexists('incident_status_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_DomainInfringement_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'DomainInfringement',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, IncidentStatus, Brand, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject5')._parserId5,'/'))))]",
      "dependsOn": [
        "[variables('parserObject5')._parserId5]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_DomainInfringement')]",
        "contentId": "[variables('parserObject5').parserContentId5]",
        "kind": "Parser",
        "version": "[variables('parserObject5').parserVersion5]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject6').parserTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBS_MalwareLogs_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject6').parserVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject6')._parserName6]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CBS MalwareLogs",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CBS_MalwareLogs",
                "query": "let V1_Empty = datatable(\n    id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, brand_s:string, malware_family_s:string, ioc_value_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_MalwareLogs_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'MalwareLogs',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Status = column_ifexists('status_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             MalwareFamily = column_ifexists('malware_family_s', ''),\n             IocValue = column_ifexists('ioc_value_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_MalwareLogs_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'MalwareLogs',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, Brand, MalwareFamily, IocValue, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject6')._parserId6,'/'))))]",
              "dependsOn": [
                "[variables('parserObject6')._parserId6]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_MalwareLogs')]",
                "contentId": "[variables('parserObject6').parserContentId6]",
                "kind": "Parser",
                "version": "[variables('parserObject6').parserVersion6]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject6').parserContentId6]",
        "contentKind": "Parser",
        "displayName": "Parser for CBS MalwareLogs",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject6').parserContentId6,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject6').parserContentId6,'-', '1.0.0')))]",
        "version": "[variables('parserObject6').parserVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject6')._parserName6]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CBS MalwareLogs",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CBS_MalwareLogs",
        "query": "let V1_Empty = datatable(\n    id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, brand_s:string, malware_family_s:string, ioc_value_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_MalwareLogs_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'MalwareLogs',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Status = column_ifexists('status_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             MalwareFamily = column_ifexists('malware_family_s', ''),\n             IocValue = column_ifexists('ioc_value_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_MalwareLogs_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'MalwareLogs',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, Brand, MalwareFamily, IocValue, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject6')._parserId6,'/'))))]",
      "dependsOn": [
        "[variables('parserObject6')._parserId6]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_MalwareLogs')]",
        "contentId": "[variables('parserObject6').parserContentId6]",
        "kind": "Parser",
        "version": "[variables('parserObject6').parserVersion6]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject7').parserTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBS_SubdomainInfringement_Parser Data Parser with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject7').parserVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject7')._parserName7]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CBS SubdomainInfringement",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CBS_SubdomainInfringement",
                "query": "let V1_Empty = datatable(\n    id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, incident_status_s:string, brand_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_SubdomainInfringement_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'SubdomainInfringement',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Status = column_ifexists('status_s', ''),\n             IncidentStatus = column_ifexists('incident_status_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_SubdomainInfringement_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'SubdomainInfringement',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, IncidentStatus, Brand, RawPayload\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject7')._parserId7,'/'))))]",
              "dependsOn": [
                "[variables('parserObject7')._parserId7]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_SubdomainInfringement')]",
                "contentId": "[variables('parserObject7').parserContentId7]",
                "kind": "Parser",
                "version": "[variables('parserObject7').parserVersion7]",
                "source": {
                  "name": "CTM360",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject7').parserContentId7]",
        "contentKind": "Parser",
        "displayName": "Parser for CBS SubdomainInfringement",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject7').parserContentId7,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject7').parserContentId7,'-', '1.0.0')))]",
        "version": "[variables('parserObject7').parserVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject7')._parserName7]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CBS SubdomainInfringement",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CBS_SubdomainInfringement",
        "query": "let V1_Empty = datatable(\n    id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, incident_status_s:string, brand_s:string\n)[];\nlet V1_view = union isfuzzy=true CBS_SubdomainInfringement_CL, V1_Empty\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'SubdomainInfringement',\n             SourceConnector = 'FunctionApp',\n             Id = column_ifexists('id_s', ''),\n             Subject = column_ifexists('subject_s', ''),\n             Remarks = column_ifexists('remarks_s', ''),\n             ExternalLink = column_ifexists('external_link_s', ''),\n             Severity = column_ifexists('severity_s', ''),\n             IncidentType = column_ifexists('type_s', ''),\n             Status = column_ifexists('status_s', ''),\n             IncidentStatus = column_ifexists('incident_status_s', ''),\n             Brand = column_ifexists('brand_s', ''),\n             RawPayload = '';\nlet V2_view = CBS_SubdomainInfringement_AzureV2_CL\n    | extend EventVendor = 'CTM360',\n             EventProduct = 'CyberBlindSpot',\n             EventCategory = 'SubdomainInfringement',\n             SourceConnector = 'CCF',\n             RawPayload = column_ifexists('RawPayload', '');\nunion isfuzzy=true V2_view, V1_view\n| extend RawPayload = column_ifexists('RawPayload', '')\n| project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, IncidentStatus, Brand, RawPayload\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject7')._parserId7,'/'))))]",
      "dependsOn": [
        "[variables('parserObject7')._parserId7]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CBS_SubdomainInfringement')]",
        "contentId": "[variables('parserObject7').parserContentId7]",
        "kind": "Parser",
        "version": "[variables('parserObject7').parserVersion7]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "HackerViewAnyIssueDetected_AnalyticalRules Analytics Rule with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Generic alert that triggers when ANY HackerView issue/incident is detected in the logs. Extracts nested metadata from RawPayload.",
                "displayName": "HackerView - Any Issue Detected",
                "enabled": false,
                "query": "HackerViewLog\n| extend RawPayloadDyn = todynamic(RawPayload)\n| extend \n  AssetName = coalesce(AssetName, tostring(RawPayloadDyn.meta.asset), tostring(RawPayloadDyn.meta.host)),\n  AssetType = coalesce(AssetType, tostring(RawPayloadDyn.meta.asset_type)),\n  IpAddress = coalesce(IpAddress, tostring(RawPayloadDyn.meta.resolved_ip)),\n  ExternalLink = coalesce(ExternalLink, tostring(RawPayloadDyn.hackerview_link))\n| project TimeGenerated, Title, Severity, AssetName, AssetType, IpAddress, ExternalLink\n",
                "queryFrequency": "PT5M",
                "queryPeriod": "PT5M",
                "severity": "Informational",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "CTM360HackerViewConnectorDefinition"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "Discovery"
                ],
                "techniques": [
                  "T1592",
                  "T1598"
                ],
                "entityMappings": [
                  {
                    "entityType": "Host",
                    "fieldMappings": [
                      {
                        "identifier": "HostName",
                        "columnName": "AssetName"
                      }
                    ]
                  },
                  {
                    "entityType": "IP",
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "IpAddress"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "AssetName": "AssetName",
                  "Severity": "Severity",
                  "IpAddress": "IpAddress"
                },
                "alertDetailsOverride": {
                  "alertDisplayNameFormat": "HackerView Alert - {{Title}}",
                  "alertDescriptionFormat": "HackerView detected {{Severity}} issue {{Title}} on asset {{AssetName}}"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "CTM360 Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "CTM360",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "HackerView - Any Issue Detected",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CBSAnyIssueDetected_AnalyticalRules Analytics Rule with template version 3.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Generic alert that triggers when ANY CyberBlindSpot issue/incident is detected in the logs. Extracts nested metadata from RawPayload.",
                "displayName": "CyberBlindSpot - Any Issue Detected",
                "enabled": false,
                "query": "CBSLog\n| project TimeGenerated, IncidentId, Subject, Severity, IncidentType, Status, Class, ExternalLink, Brand, FirstSeen, LastSeen, Remarks\n",
                "queryFrequency": "PT5M",
                "queryPeriod": "PT5M",
                "severity": "Informational",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "CTM360CBSConnectorDefinition"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "Discovery",
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1592",
                  "T1598",
                  "T1566"
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "Subject"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Brand": "Brand",
                  "IncidentType": "IncidentType",
                  "Subject": "Subject"
                },
                "alertDetailsOverride": {
                  "alertDisplayNameFormat": "CyberBlindSpot Alert - {{IncidentType}} on {{Subject}} - {{Brand}}",
                  "alertDescriptionFormat": "Severity {{Severity}} | Type {{IncidentType}} | Subject {{Subject}} | Asset {{Brand}} | Status {{Status}}"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "CTM360 Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "CTM360",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "CTM360",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Cyber Threat Management 360",
                  "email": "monitor@ctm360.com",
                  "tier": "Partner",
                  "link": "https://www.ctm360.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "CyberBlindSpot - Any Issue Detected",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.3",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "CTM360",
        "publisherDisplayName": "Cyber Threat Management 360",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/CTM360/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The <a href=\"https://hackerview.ctm360.com/\">HACKERVIEW</a> and <a href=\"https://cbs.ctm360.com/\">CBS</a> solutions for Microsoft Sentinel enable you to ingest their respective event data into Microsoft Sentinel using the REST API. This integration streamlines the process of collecting and analyzing security event information. With these solutions, you can enhance your organization's ability to detect and respond to potential security threats effectively.</p>\n<h2 id=\"hackerview\">HACKERVIEW</h2>\n<p><a href=\"https://hackerview.ctm360.com/\">HACKERVIEW</a> is CTM360s External Attack Surface Management platform. It combines automated asset discovery, issue identification/management, remediation guidelines, security ratings, and third-party risk management. This platform maps your organizations digital presence automatically, operating in a passive and non-intrusive manner leveraging data in the public domain.</p>\n<h2 id=\"cyberblindspot\">CyberBlindspot</h2>\n<p><a href=\"https://cbs.ctm360.com/\">CyberBlindspot</a> is CTM360 Digital Risk Protection platform which combines surface, deep, and dark web monitoring, including brand protection, anti-phishing, and takedowns. The platform enables you to take action on incidents derived from threat intelligence that is directly linked to your organization.</p>\n<p><strong>Data Connectors:</strong> 2, <strong>Parsers:</strong> 7, <strong>Analytic Rules:</strong> 2</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/CTM360Logo.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "CTM360",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "CTM360",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Cyber Threat Management 360",
          "email": "monitor@ctm360.com",
          "tier": "Partner",
          "link": "https://www.ctm360.com/"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections2')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject1').parserContentId1]",
              "version": "[variables('parserObject1').parserVersion1]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject2').parserContentId2]",
              "version": "[variables('parserObject2').parserVersion2]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject3').parserContentId3]",
              "version": "[variables('parserObject3').parserVersion3]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject4').parserContentId4]",
              "version": "[variables('parserObject4').parserVersion4]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject5').parserContentId5]",
              "version": "[variables('parserObject5').parserVersion5]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject6').parserContentId6]",
              "version": "[variables('parserObject6').parserVersion6]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject7').parserContentId7]",
              "version": "[variables('parserObject7').parserVersion7]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            }
          ]
        },
        "firstPublishDate": "2023-10-23",
        "providers": [
          "CTM360"
        ],
        "categories": {
          "domains": [
            "Security - Threat Intelligence",
            "Security - Information Protection"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
