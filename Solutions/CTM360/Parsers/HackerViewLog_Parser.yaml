id: HackerViewLog_Parser
Function:
  Title: Parser for HackerViewLog
  Version: '1.1.0'
  LastUpdated: '2025-01-27'
Category: Microsoft Sentinel Parser
FunctionName: HackerViewLog
FunctionAlias: HackerViewLog
FunctionQuery: |
  let HackerViewV1_Empty = datatable(
      id_s:string, title_s:string, severity_s:string, status_s:string,
      first_seen_s:string, last_seen_s:string, category_s:string, description_s:string,
      asset_name_s:string, asset_type_s:string, port_d:int, protocol_s:string,
      ip_address_s:string, technology_s:string, cve_s:string, cvss_score_d:real,
      remediation_s:string, references_s:string, tags_s:string, priority_s:string,
      assigned_to_s:string, notes_s:string, external_link_s:string,
      created_at_s:string, updated_at_s:string
  )[];
  let HackerViewV1_view = union isfuzzy=true HackerViewLog_Azure_1_CL, HackerViewV1_Empty
      | extend EventVendor = 'CTM360',
               EventProduct = 'HackerView',
               SourceConnector = 'FunctionApp',
               IssueId = column_ifexists('id_s', ''),
               Title = column_ifexists('title_s', ''),
               Severity = column_ifexists('severity_s', ''),
               Status = column_ifexists('status_s', ''),
               FirstSeen = column_ifexists('first_seen_s', ''),
               LastSeen = column_ifexists('last_seen_s', ''),
               Category = column_ifexists('category_s', ''),
               Description = column_ifexists('description_s', ''),
               AssetName = column_ifexists('asset_name_s', ''),
               AssetType = column_ifexists('asset_type_s', ''),
               Port = toint(column_ifexists('port_d', 0)),
               Protocol = column_ifexists('protocol_s', ''),
               IpAddress = column_ifexists('ip_address_s', ''),
               Technology = column_ifexists('technology_s', ''),
               Cve = column_ifexists('cve_s', ''),
               CvssScore = toreal(column_ifexists('cvss_score_d', 0.0)),
               Remediation = column_ifexists('remediation_s', ''),
               References = column_ifexists('references_s', ''),
               Tags = column_ifexists('tags_s', ''),
               Priority = column_ifexists('priority_s', ''),
               AssignedTo = column_ifexists('assigned_to_s', ''),
               Notes = column_ifexists('notes_s', ''),
               ExternalLink = column_ifexists('external_link_s', ''),
               CreatedAt = column_ifexists('created_at_s', ''),
               UpdatedAt = column_ifexists('updated_at_s', '');
  let HackerViewV2_view = HackerViewLog_AzureV2_CL
      | extend EventVendor = 'CTM360',
               EventProduct = 'HackerView',
               SourceConnector = 'CCF';
  union isfuzzy=true HackerViewV2_view, HackerViewV1_view
  | project TimeGenerated, EventVendor, EventProduct, SourceConnector, IssueId, Title, Severity, Status, FirstSeen, LastSeen, Category, Description, AssetName, AssetType, Port, Protocol, IpAddress, Technology, Cve, CvssScore, Remediation, References, Tags, Priority, AssignedTo, Notes, ExternalLink, CreatedAt, UpdatedAt
  | project-away *_s, *_d
