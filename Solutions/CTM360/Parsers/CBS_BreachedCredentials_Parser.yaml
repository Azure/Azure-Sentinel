id: CBS_BreachedCredentials_Parser
Function:
  Title: Parser for CBS BreachedCredentials
  Version: '1.0.0'
  LastUpdated: '2025-01-27'
Category: Microsoft Sentinel Parser
FunctionName: CBS_BreachedCredentials
FunctionAlias: CBS_BreachedCredentials
FunctionQuery: |
  let V1_Empty = datatable(
      id_s:string, domain_s:string, email_s:string, username_s:string, type_s:string, remarks_s:string, external_link_s:string, brand_s:string, severity_s:string, status_s:string
  )[];
  let V1_view = union isfuzzy=true CBS_BreachedCredentials_CL, V1_Empty
      | extend EventVendor = 'CTM360',
               EventProduct = 'CyberBlindSpot',
               EventCategory = 'BreachedCredentials',
               SourceConnector = 'FunctionApp',
               Id = column_ifexists('id_s', ''),
               Domain = column_ifexists('domain_s', ''),
               Email = column_ifexists('email_s', ''),
               Username = column_ifexists('username_s', ''),
               IncidentType = column_ifexists('type_s', ''),
               Remarks = column_ifexists('remarks_s', ''),
               ExternalLink = column_ifexists('external_link_s', ''),
               Brand = column_ifexists('brand_s', ''),
               Severity = column_ifexists('severity_s', ''),
               Status = column_ifexists('status_s', ''),
               RawPayload = '';
  let V2_view = CBS_BreachedCredentials_AzureV2_CL
      | extend EventVendor = 'CTM360',
               EventProduct = 'CyberBlindSpot',
               EventCategory = 'BreachedCredentials',
               SourceConnector = 'CCF',
               RawPayload = column_ifexists('RawPayload', '');
  union isfuzzy=true V2_view, V1_view
  | extend RawPayload = column_ifexists('RawPayload', '')
  | project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Domain, Email, Username, IncidentType, Remarks, ExternalLink, Brand, Severity, Status, RawPayload