id: CBS_CompromisedCards_Parser
Function:
  Title: Parser for CBS CompromisedCards
  Version: '1.0.0'
  LastUpdated: '2025-01-27'
Category: Microsoft Sentinel Parser
FunctionName: CBS_CompromisedCards
FunctionAlias: CBS_CompromisedCards
FunctionQuery: |
  let V1_Empty = datatable(
      id_s:string, domain_s:string, hostname_s:string, type_s:string, masked_password_s:string, user_s:string, user_domain_s:string, website_s:string, remarks_s:string, external_link_s:string, brand_s:string, severity_s:string, status_s:string
  )[];
  let V1_view = union isfuzzy=true CBS_CompromisedCards_CL, V1_Empty
      | extend EventVendor = 'CTM360',
               EventProduct = 'CyberBlindSpot',
               EventCategory = 'CompromisedCards',
               SourceConnector = 'FunctionApp',
               Id = column_ifexists('id_s', ''),
               Domain = column_ifexists('domain_s', ''),
               Hostname = column_ifexists('hostname_s', ''),
               IncidentType = column_ifexists('type_s', ''),
               MaskedPassword = column_ifexists('masked_password_s', ''),
               User = column_ifexists('user_s', ''),
               UserDomain = column_ifexists('user_domain_s', ''),
               Website = column_ifexists('website_s', ''),
               Remarks = column_ifexists('remarks_s', ''),
               ExternalLink = column_ifexists('external_link_s', ''),
               Brand = column_ifexists('brand_s', ''),
               Severity = column_ifexists('severity_s', ''),
               Status = column_ifexists('status_s', '');
  let V2_view = CBS_CompromisedCards_AzureV2_CL
      | extend EventVendor = 'CTM360',
               EventProduct = 'CyberBlindSpot',
               EventCategory = 'CompromisedCards',
               SourceConnector = 'CCF';
  union isfuzzy=true V2_view, V1_view
  | project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Domain, Hostname, IncidentType, MaskedPassword, User, UserDomain, Website, Remarks, ExternalLink, Brand, Severity, Status
  | project-away *_s, *_d, *_g