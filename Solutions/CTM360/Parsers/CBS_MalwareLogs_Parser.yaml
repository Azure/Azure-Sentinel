id: CBS_MalwareLogs_Parser
Function:
  Title: Parser for CBS MalwareLogs
  Version: '1.0.0'
  LastUpdated: '2025-01-27'
Category: Microsoft Sentinel Parser
FunctionName: CBS_MalwareLogs
FunctionAlias: CBS_MalwareLogs
FunctionQuery: |
  let V1_Empty = datatable(
      id_s:string, subject_s:string, remarks_s:string, external_link_s:string, severity_s:string, type_s:string, status_s:string, brand_s:string, malware_family_s:string, ioc_value_s:string
  )[];
  let V1_view = union isfuzzy=true CBS_MalwareLogs_CL, V1_Empty
      | extend EventVendor = 'CTM360',
               EventProduct = 'CyberBlindSpot',
               EventCategory = 'MalwareLogs',
               SourceConnector = 'FunctionApp',
               Id = column_ifexists('id_s', ''),
               Subject = column_ifexists('subject_s', ''),
               Remarks = column_ifexists('remarks_s', ''),
               ExternalLink = column_ifexists('external_link_s', ''),
               Severity = column_ifexists('severity_s', ''),
               IncidentType = column_ifexists('type_s', ''),
               Status = column_ifexists('status_s', ''),
               Brand = column_ifexists('brand_s', ''),
               MalwareFamily = column_ifexists('malware_family_s', ''),
               IocValue = column_ifexists('ioc_value_s', '');
  let V2_view = CBS_MalwareLogs_AzureV2_CL
      | extend EventVendor = 'CTM360',
               EventProduct = 'CyberBlindSpot',
               EventCategory = 'MalwareLogs',
               SourceConnector = 'CCF';
  union isfuzzy=true V2_view, V1_view
  | project TimeGenerated, EventVendor, EventProduct, EventCategory, SourceConnector, Id, Subject, Remarks, ExternalLink, Severity, IncidentType, Status, Brand, MalwareFamily, IocValue
  | project-away *_s, *_d, *_g