[
  {
    "name": "CTM360HackerViewIssues",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360HackerViewConnectorDefinition",
      "dataType": "HackerViewLog_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://hackerview.ctm360.com/api/v2/issues",
        "httpMethod": "GET",
        "queryTimeFormat": "dd-MM-yyyy HH:mm",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "startTimeAttributeName": "first_seen",
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.issues"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-HackerViewLog_Azure_1_CL"
      }
    }
  }
]