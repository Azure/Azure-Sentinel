[
  {
    "name": "CTM360CBSIncidents",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360CBSConnectorDefinition",
      "dataType": "CBSLog_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
        "httpMethod": "GET",
        "queryTimeFormat": "UnixTimestampInMills",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "queryParameters": {
          "date_from": "{_QueryWindowStartTime}",
          "date_to": "{_QueryWindowEndTime}",
          "module_type": "incidents",
          "max_hits": "10000"
        },
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.hits"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-CBSLog_Azure_1_CL"
      }
    }
  },
  {
    "name": "CTM360CBSMalwareLogs",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360CBSConnectorDefinition",
      "dataType": "CBS_MalwareLogs_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
        "httpMethod": "GET",
        "queryTimeFormat": "UnixTimestampInMills",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "queryParameters": {
          "date_from": "{_QueryWindowStartTime}",
          "date_to": "{_QueryWindowEndTime}",
          "module_type": "malware_logs",
          "max_hits": "10000"
        },
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.hits"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-CBS_MalwareLogs_CL"
      }
    }
  },
  {
    "name": "CTM360CBSBreachedCredentials",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360CBSConnectorDefinition",
      "dataType": "CBS_BreachedCredentials_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
        "httpMethod": "GET",
        "queryTimeFormat": "UnixTimestampInMills",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "queryParameters": {
          "date_from": "{_QueryWindowStartTime}",
          "date_to": "{_QueryWindowEndTime}",
          "module_type": "breached_credentials",
          "max_hits": "10000"
        },
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.hits"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-CBS_BreachedCredentials_CL"
      }
    }
  },
  {
    "name": "CTM360CBSCompromisedCards",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360CBSConnectorDefinition",
      "dataType": "CBS_CompromisedCards_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
        "httpMethod": "GET",
        "queryTimeFormat": "UnixTimestampInMills",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "queryParameters": {
          "date_from": "{_QueryWindowStartTime}",
          "date_to": "{_QueryWindowEndTime}",
          "module_type": "compromised_cards",
          "max_hits": "10000"
        },
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.hits"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-CBS_CompromisedCards_CL"
      }
    }
  },
  {
    "name": "CTM360CBSDomainInfringement",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360CBSConnectorDefinition",
      "dataType": "CBS_DomainInfringement_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
        "httpMethod": "GET",
        "queryTimeFormat": "UnixTimestampInMills",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "queryParameters": {
          "date_from": "{_QueryWindowStartTime}",
          "date_to": "{_QueryWindowEndTime}",
          "module_type": "domain_infringement",
          "max_hits": "10000",
          "risk_score_min": "0",
          "risk_score_max": "100"
        },
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.hits"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-CBS_DomainInfringement_CL"
      }
    }
  },
  {
    "name": "CTM360CBSSubdomainInfringement",
    "apiVersion": "2023-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CTM360CBSConnectorDefinition",
      "dataType": "CBS_SubdomainInfringement_AzureV2_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apiKey')]",
        "ApiKeyName": "api-key",
        "IsApiKeyInPostPayload": false
      },
      "request": {
        "apiEndpoint": "https://cbs.ctm360.com/api/v2/sentinel",
        "httpMethod": "GET",
        "queryTimeFormat": "UnixTimestampInMills",
        "queryWindowInMin": 5,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "accept": "application/json"
        },
        "queryParameters": {
          "date_from": "{_QueryWindowStartTime}",
          "date_to": "{_QueryWindowEndTime}",
          "module_type": "subdomain_infringement",
          "max_hits": "10000",
          "risk_score_min": "0",
          "risk_score_max": "100"
        },
        "rateLimitQPS": 2
      },
      "response": {
        "eventsJsonPaths": [
          "$.hits"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-CBS_SubdomainInfringement_CL"
      }
    }
  }
]