{
    "type": "Microsoft.Insights/dataCollectionRules",
    "apiVersion": "2025-07-01-preview",
    "name": "RSAIDPlus_AdminLogs_DCR",
    "location": "{{location}}",
    "properties": {
        "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
        "streamDeclarations": {
            "Custom-RSAIDPlus_AdminLogs_CL": {
                "columns": [
                    {
                        "name": "eventId",
                        "type": "long"
                    },
                    {
                        "name": "eventLogDate",
                        "type": "datetime"
                    },
                    {
                        "name": "eventType",
                        "type": "string"
                    },
                    {
                        "name": "serverURL",
                        "type": "string"
                    },
                    {
                        "name": "serverIPAddress",
                        "type": "string"
                    },
                    {
                        "name": "application",
                        "type": "string"
                    },
                    {
                        "name": "customerId",
                        "type": "int"
                    },
                    {
                        "name": "customerName",
                        "type": "string"
                    },
                    {
                        "name": "sourceIPAddress",
                        "type": "string"
                    },
                    {
                        "name": "adminUserName",
                        "type": "string"
                    },
                    {
                        "name": "adminUserRole",
                        "type": "string"
                    },
                    {
                        "name": "activityKey",
                        "type": "string"
                    },
                    {
                        "name": "activityCode",
                        "type": "int"
                    },
                    {
                        "name": "result",
                        "type": "string"
                    },
                    {
                        "name": "reasonKey",
                        "type": "string"
                    },
                    {
                        "name": "message",
                        "type": "string"
                    },
                    {
                        "name": "requiresPublish",
                        "type": "boolean"
                    },
                    {
                        "name": "targetObject1Id",
                        "type": "dynamic"
                    },
                    {
                        "name": "targetObject1Name",
                        "type": "dynamic"
                    },
                    {
                        "name": "targetObject1Type",
                        "type": "dynamic"
                    },
                    {
                        "name": "targetObject2Id",
                        "type": "dynamic"
                    },
                    {
                        "name": "targetObject2Name",
                        "type": "dynamic"
                    },
                    {
                        "name": "targetObject2Type",
                        "type": "dynamic"
                    }
                ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "clv2ws1"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-RSAIDPlus_AdminLogs_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated = todatetime(eventLogDate)\n| project-away eventLogDate\n",
                "outputStream": "Custom-RSAIDPlus_AdminLogs_CL"
            }
        ]
    }    
}