{
	"name": "RSAIDPlus_AdminLogs_Poller",
	"apiVersion": "2025-07-01-preview",
	"type": "Microsoft.SecurityInsights/dataConnectors",
	"location": "{{location}}",
	"kind": "RestApiPoller",
	"properties": {
		"connectorDefinitionName": "RSAIDPlus_AdmingLogs_Connector",
		"dataType": "RSAIDPlus_AdminLogs_CL",
		"dcrConfig": {
			"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
			"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
			"streamName" : "Custom-RSAIDPlus_AdminLogs_CL"
		},
		"auth": {
		    "type": "APIKey",
		    "ApiKey": "[[parameters('access_token')]",
			"ApiKeyName": "Authorization",
            "ApiKeyIdentifier": "Bearer"
		},
		"request": {
			"apiEndpoint": "[[parameters('Admin-API-URL')]",
			"httpMethod": "GET",
			"headers": {
				"Accept": "application/json"
			},
			"retryCount": 3,
            "timeoutInSeconds": 60,
            "queryWindowInMin": 5,
            "StartTimeAttributeName": "startTimeAfter",
            "EndTimeAttributeName": "endTimeOnOrBefore"
		},
		"response": {
		  "eventsJsonPaths": [ "$.elements" ]
		}
	}
}
