id: "488c759d-a82e-44cd-91bb-d766573918d7"
name: "RSA ID Plus - Locked Administrator Account Detected"
description: |
  'Raises an alert when an admin account is locked out of the Admin console (RSAIDPlus Admin Events).'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: RSAIDPlus_AdminLogs_Connector
    dataTypes:
      - RSAIDPlus_AdminLogs_CL
queryFrequency: 30m
queryPeriod: 1d
triggerOperator: GreaterThan
triggerThreshold: 0
tactics: 
  - Impact
  - CredentialAccess
relevantTechniques: []
query: |
    RSAIDPlus_AdminLogs_CL
    |where activityKey == 'LOCKED_ADMIN_ACCOUNT'
    |project TimeGenerated, customerName, adminUserName, adminUserRole, activityKey, sourceIPAddress
entityMappings: 
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: sourceIPAddress
  - entityType: Account
    fieldMappings: 
      - identifier: Name
        columnName: adminUserName
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: customerName
incidentConfiguration:
    createIncident: true
    groupingConfiguration : 
      enabled: true
      reopenClosedIncident: false
      lookbackDuration : 2h
      matchingMethod : AllEntities
eventGroupingSettings:
    aggregationKind: SingleAlert
alertDetailsOverride:
    alertDisplayNameFormat: 'RSA ID Plus Administrator - {{{adminUserName}} is locked out.'
    alertDescriptionFormat: 'Administrator - {{{adminUserName}} with Role - {{{adminUserRole}} got locked out of Admin Console at: {{{TimeGenerated}}'
customDetails:
    Customer_Name: customerName
    Administrator: adminUserName
    Administrator_Type: adminUserRole
    Activity: activityKey
version: 1.0.0
kind: Scheduled