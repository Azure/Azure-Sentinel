[
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2021-10-01-preview",
    "name": "Cyolo-Sentinel-Analytics-Connector",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CyoloSentinelDataConnector",
      "dataType": "Custom-CyoloSentinelAnalyticsTable_CL",
      "auth": {
        "type": "Basic",
        "userName": "{{username}}",
        "password": "{{password}}"
      },
      "request": {
        "apiEndpoint": "{{apiUrl}}/v1/analytics_log",
        "headers": {
          "Accept": "application/json"
        }
      },
      "pagination": {
        "type": "Page",
        "pageParamName": "_page",
        "startPage": 1,
        "maxPages": 10000
      },
      "response": {
        "eventsJsonPaths": [
          "$.data[*]"
        ]
      },
      "dcrConfig": {
        "streamName": "Custom-Cyolo_Analytics",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2021-10-01-preview",
    "name": "Cyolo-Sentinel-Audit-Connector",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CyoloSentinelDataConnector",
      "dataType": "Custom-CyoloSentinelAuditTable_CL",
      "auth": {
        "type": "Basic",
        "userName": "{{username}}",
        "password": "{{password}}"
      },
      "request": {
        "apiEndpoint": "{{apiUrl}}/v1/audit_log",
        "headers": {
          "Accept": "application/json"
        }
      },
      "pagination": {
        "type": "Page",
        "pageParamName": "_page",
        "startPage": 1,
        "maxPages": 10000
      },
      "response": {
        "eventsJsonPaths": [
          "$.data[*]"
        ]
      },
      "dcrConfig": {
        "streamName": "Custom-Cyolo_Audit",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2021-10-01-preview",
    "name": "Cyolo-Sentinel-System-Connector",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "CyoloSentinelDataConnector",
      "dataType": "Custom-CyoloSentinelSystemTable_CL",
      "auth": {
        "type": "Basic",
        "userName": "{{username}}",
        "password": "{{password}}"
      },
      "request": {
        "apiEndpoint": "{{apiUrl}}/v1/system_log",
        "headers": {
          "Accept": "application/json"
        }
      },
      "pagination": {
        "type": "Page",
        "pageParamName": "_page",
        "startPage": 1,
        "maxPages": 10000
      },
      "response": {
        "eventsJsonPaths": [
          "$.data[*]"
        ]
      },
      "dcrConfig": {
        "streamName": "Custom-Cyolo_System",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      }
    }
  }
]