{
  "name": "DataBahn-DCR",
  "apiVersion": "2023-03-11",
  "type": "Microsoft.Insights/dataCollectionRules",
  "location": "{{location}}",
  "properties": {
    "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
    "streamDeclarations": {
      "Custom-databahn_audit_logs": {
        "columns": [
          { "name": "TimeGenerated", "type": "datetime" },
          { "name": "action", "type": "string" },
          { "name": "error", "type": "string" },
          { "name": "id", "type": "string" },
          { "name": "isSuccess", "type": "boolean" },
          { "name": "message", "type": "string" },
          { "name": "objectId", "type": "string" },
          { "name": "objectName", "type": "string" },
          { "name": "objectType", "type": "string" },
          { "name": "origin", "type": "string" },
          { "name": "path", "type": "string" },
          { "name": "subAction", "type": "string" },
          { "name": "subjectEmail", "type": "string" },
          { "name": "subjectId", "type": "string" },
          { "name": "subjectName", "type": "string" },
          { "name": "tenantId", "type": "string" }
        ]
      },
      "Custom-databahn_alerts": {
        "columns": [
          { "name": "TimeGenerated", "type": "datetime" },
          { "name": "action", "type": "string" },
          { "name": "alertType", "type": "string" },
          { "name": "criticality", "type": "string" },
          { "name": "dataPlaneId", "type": "string" },
          { "name": "dismissed", "type": "boolean" },
          { "name": "errorCode", "type": "string" },
          { "name": "errorMessage", "type": "string" },
          { "name": "firstObservedAt", "type": "datetime" },
          { "name": "functionality", "type": "string" },
          { "name": "functionalityEntityId", "type": "string" },
          { "name": "functionalityEntityName", "type": "string" },
          { "name": "functionalityType", "type": "string" },
          { "name": "id", "type": "string" },
          { "name": "lastObservedAt", "type": "datetime" },
          { "name": "message", "type": "string" },
          { "name": "status", "type": "int" },
          { "name": "tenantId", "type": "string" },
          { "name": "subject", "type": "string" },
          { "name": "updatedAt", "type": "datetime" },
          { "name": "updatedBy", "type": "string" }
        ]
      },
      "Custom-databahn_device_inventory": {
        "columns": [
          { "name": "TimeGenerated", "type": "datetime" },
          { "name": "firstSeen", "type": "long" },
          { "name": "hostname", "type": "string" },
          { "name": "lastSeen", "type": "long" },
          { "name": "sourceId", "type": "string" },
          { "name": "sourceName", "type": "string" }
        ]
      }
    },
    "destinations": {
      "logAnalytics": [
        {
          "workspaceResourceId": "{{workspaceResourceId}}",
          "name": "clv2ws1"
        }
      ]
    },
    "dataFlows": [
      {
        "streams": ["Custom-databahn_audit_logs"],
        "destinations": ["clv2ws1"],
        "transformKql": "source\n| extend TimeGenerated = now()",
        "outputStream": "Custom-databahn_audit_logs_CL"
      },
      {
        "streams": ["Custom-databahn_alerts"],
        "destinations": ["clv2ws1"],
        "transformKql": "source\n| extend TimeGenerated = now()",
        "outputStream": "Custom-databahn_alerts_CL"
      },
      {
        "streams": ["Custom-databahn_device_inventory"],
        "destinations": ["clv2ws1"],
        "transformKql": "source\n| extend TimeGenerated = now()",
        "outputStream": "Custom-databahn_device_inventory_CL"
      }
    ]
  }
}
