[{
    "name": "ZeroFoxAlerts_DCR",
    "apiVersion": "2021-09-01-preview",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
        "streamDeclarations": {
            "Custom-ZeroFoxAlerts_AlertsApi": {
                "columns": [
                    {
                        "name": "alert_type",
                        "type": "string",
                        "description": "Type of alert"
                    },
                    {
                        "name": "logs",
                        "type": "string",
                        "description": "Logs of the alert"
                    },
                    {
                        "name": "offending_content_url",
                        "type": "string",
                        "description": "Offending content URL"
                    },
                    {
                        "name": "asset_term",
                        "type": "string",
                        "description": "Asset term"
                    },
                    {
                        "name": "assignee",
                        "type": "string",
                        "description": "Assignee"
                    },
                    {
                        "name": "entity",
                        "type": "dynamic",
                        "description": "Entity information"
                    },
                    {
                        "name": "content_created_at",
                        "type": "datetime",
                        "description": "When the content was created"
                    },
                    {
                        "name": "id",
                        "type": "int",
                        "description": "ID value"
                    },
                    {
                        "name": "severity",
                        "type": "int",
                        "description": "Severity level"
                    },
                    {
                        "name": "perpetrator",
                        "type": "dynamic",
                        "description": "Perpetrator information"
                    },
                    {
                        "name": "rule_group_id",
                        "type": "int",
                        "description": "Rule Group ID"
                    },
                    {
                        "name": "asset",
                        "type": "dynamic",
                        "description": "Asset information"
                    },
                    {
                        "name": "entered_by",
                        "type": "string",
                        "description": "Entered By"
                    },
                    {
                        "name": "metadata",
                        "type": "string",
                        "description": "Metadata"
                    },
                    {
                        "name": "status",
                        "type": "string",
                        "description": "Status"
                    },
                    {
                        "name": "timestamp",
                        "type": "datetime",
                        "description": "Timestamp"
                    },
                    {
                        "name": "rule_name",
                        "type": "string",
                        "description": "Rule Name"
                    },
                    {
                        "name": "last_modified",
                        "type": "datetime",
                        "description": "Last Modified"
                    },
                    {
                        "name": "protected_locations",
                        "type": "string",
                        "description": "Protected Locations"
                    },
                    {
                        "name": "darkweb_term",
                        "type": "string",
                        "description": "Darkweb Term"
                    },
                    {
                        "name": "business_network",
                        "type": "string",
                        "description": "Business Network"
                    },
                    {
                        "name": "reviewed",
                        "type": "boolean",
                        "description": "Reviewed"
                    },
                    {
                        "name": "escalated",
                        "type": "boolean",
                        "description": "Escalated"
                    },
                    {
                        "name": "network",
                        "type": "string",
                        "description": "Network"
                    },
                    {
                        "name": "protected_social_object",
                        "type": "string",
                        "description": "Protected Social Object"
                    },
                    {
                        "name": "notes",
                        "type": "string",
                        "description": "Notes"
                    },
                    {
                        "name": "reviews",
                        "type": "string",
                        "description": "Reviews"
                    },
                    {
                        "name": "rule_id",
                        "type": "int",
                        "description": "Rule ID"
                    },
                    {
                        "name": "tags",
                        "type": "string",
                        "description": "Tags"
                    }
                ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "clv2ws1"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-ZeroFoxAlerts_AlertsApi"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend \n    entity_id_d = toreal(entity.id),\n    entity_name_s = tostring(entity.name),\n    entity_image_s = tostring(entity.image),\n    entity_labels_s = tostring(entity.labels),\n    entity_entity_group_id_d = toreal(entity.entity_group_id),\n    entity_entity_group_name_s = tostring(entity.entity_group_name),\n    entity_term_s = tostring(entity.term),\n    entity_account_s = tostring(entity.account),\n    entity_email_receiver_id_s = tostring(entity.email_receiver_id),\n    perpetrator_name_s = tostring(perpetrator.name),\n    perpetrator_display_name_s = tostring(perpetrator.display_name),\n    perpetrator_id_d = toreal(perpetrator.id),\n    perpetrator_url_s = tostring(perpetrator.url),\n    perpetrator_content_s = tostring(perpetrator.content),\n    perpetrator_type_s = tostring(perpetrator.type),\n    perpetrator_timestamp_t = todatetime(perpetrator.timestamp),\n    perpetrator_network_s = tostring(perpetrator.network),\n    asset_id_d = toreal(asset.id),\n    asset_name_s = tostring(asset.name),\n    asset_image_s = tostring(asset.image),\n    asset_labels_s = tostring(asset.labels),\n    asset_entity_group_id_d = toreal(asset.entity_group_id),\n    asset_entity_group_name_s = tostring(asset.entity_group_name)\n| project-rename \n    TimeGenerated = last_modified,\n    alert_type_s = alert_type,\n    logs_s = logs,\n    offending_content_url_s = offending_content_url,\n    asset_term_s = asset_term,\n    assignee_s = assignee,\n    content_created_at_t = content_created_at,\n    id_d = id,\n    Severity = severity,\n    rule_group_id_d = rule_group_id,\n    entered_by_s = entered_by,\n    metadata_s = metadata,\n    status_s = status,\n    timestamp_t = timestamp,\n    rule_name_s = rule_name,\n    last_modified_t = last_modified,\n    protected_locations_s = protected_locations,\n    darkweb_term_s = darkweb_term,\n    business_network_s = business_network,\n    reviewed_b = reviewed,\n    escalated_b = escalated,\n    network_s = network,\n    protected_social_object_s = protected_social_object,\n    notes_s = notes,\n    reviews_s = reviews,\n    rule_id_d = rule_id,\n    tags_s = tags\n| project TimeGenerated, alert_type_s, logs_s, offending_content_url_s, asset_term_s, assignee_s, entity_id_d, entity_name_s, entity_image_s, entity_labels_s, entity_entity_group_id_d, entity_entity_group_name_s, entity_term_s, content_created_at_t, id_d, Severity, perpetrator_name_s, perpetrator_display_name_s, perpetrator_id_d, perpetrator_url_s, perpetrator_content_s, perpetrator_type_s, perpetrator_timestamp_t, perpetrator_network_s, rule_group_id_d, asset_id_d, asset_name_s, asset_image_s, asset_labels_s, asset_entity_group_id_d, asset_entity_group_name_s, entered_by_s, metadata_s, status_s, timestamp_t, rule_name_s, last_modified_t, protected_locations_s, darkweb_term_s, business_network_s, reviewed_b, escalated_b, network_s, protected_social_object_s, notes_s, reviews_s, rule_id_d, entity_account_s, entity_email_receiver_id_s, tags_s",
                "outputStream": "Custom-ZeroFoxAlertPoller_CL"
            }
        ]
    }
}]
