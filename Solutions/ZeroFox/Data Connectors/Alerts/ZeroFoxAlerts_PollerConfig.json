[
  {
    "name": "ZeroFoxAlertsPoller",
    "apiVersion": "2022-10-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "ZeroFoxAlertsDefinition",
      "dataType": "ZeroFoxAlertPoller_CL",
      "dcrConfig": {
        "streamName": "Custom-ZeroFoxAlertPoller_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "APIKey",
        "apiKeyName": "Authorization",
        "apiKeyIdentifier": "Token",
        "apiKey": "{{apikey}}"
      },
      "request": {
        "apiEndpoint": "https://api.zerofox.com/1.0/alerts/",
        "rateLimitQPS": 10,
        "queryWindowInMin": 5,
        "httpMethod": "Get",
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "startTimeAttributeName": "last_modified_min_date",
        "endTimeAttributeName": "last_modified_max_date",
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json",
          "zf-source": "Microsoft-Sentinel",
          "User-Agent": "Microsoft-Sentinel-ZeroFox-Connector"
        },
        "queryParameters": {
          "sort_direction": "asc"
        }
      },
      "paging": {
        "pagingType": "Offset",
        "offsetParaName": "offset",
        "pageSizeParaName": "limit",
        "pageSize": 100
      },
      "response": {
        "eventsJsonPaths": [
          "$.alerts[*]"
        ]
      }
    }
  }
]
