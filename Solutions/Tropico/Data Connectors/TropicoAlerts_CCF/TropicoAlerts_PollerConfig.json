[
    {
        "name": "TropicoAlertsPoller",
        "apiVersion": "2022-12-01-preview",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "location": "{{workspace-location}}",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "TropicoAlertsDefinition",
            "dataType": "Tropico API",
            "response": {
                "eventsJsonPaths": [
                    "$.items[*]"
                ],
                "format": "json"
            },
            "paging": {
                "pagingType": "NextPageToken",
                "nextPageParaName": "next_token",
                "nextPageTokenJsonPath": "$.metadata.next_token"
            },
            "auth": {
                "apiKeyName": "X-API-Key",
                "ApiKey": "{{apikey}}",
                "type": "APIKey",
                "isApiKeyInPostPayload": false
            },
            "request": {
                "apiEndpoint": "https://backend.tropicosecurity.com/api/asim/alerts",
                "rateLimitQPS": 10,
                "queryWindowInMin": 5,
                "httpMethod": "GET",
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json",
                    "User-Agent": "Tropico Sentinel Connector"
                },
                "startTimeAttributeName": "start_time",
                "endTimeAttributeName": "end_time"
            },
            "dcrConfig": {
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
                "streamName": "Custom-Tropico_Alerts_CL"
            },
            "isActive": true
        }
    }
]
