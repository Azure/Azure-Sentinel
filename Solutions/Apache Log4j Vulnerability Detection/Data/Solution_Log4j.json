{
  "Name": "Apache Log4j Vulnerability Detection",
  "Author": "Microsoft - support@microsoft.com",
  "Logo": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Workbooks/Images/Logos/Log4j.svg\" width=\"150px\" height=\"75px\">",
  "Description": "Microsoft's security research teams have been tracking threats taking advantage of [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228), a remote code execution (RCE) vulnerability in [Apache Log4j 2](https://logging.apache.org/log4j/2.x/) referred to as “Log4Shell”. The vulnerability allows unauthenticated remote code execution, and it is triggered when a specially crafted string provided by the attacker through a variety of different input vectors is parsed and processed by the Log4j 2 vulnerable component. For more technical and mitigation information about the vulnerability, please read the [Microsoft Security Response Center blog](https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/). This solution provides content to monitor, detect and investigate signals related to exploitation of this vulnerability in Microsoft Sentinel.\n\n**Prerequisite :-**\n\n This is a [domain solution](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdocs.microsoft.com%2Fazure%2Fsentinel%2Fsentinel-solutions-catalog%23domain-solutions&data=05%7C01%7Ckavishbakshi%40microsoft.com%7Cbe2a496082b24caa4b8c08da9cefacca%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637994850502413731%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=OJegu%2B2EqD7rmYmK9pm9QniD6YWp5ooloZ6tHzcwVi0%3D&reserved=0) and does not include any data connectors. Install one or more of the listed solutions, or develop your custom ASIM parsers to unlock the value provided by this solution.\n 1. Azure Web Application Firewall (WAF) \n 2. Microsoft 365 \n 3. Windows Server DNS \n 4. CiscoASA \n 5. PaloAlto-PAN-OS \n 6. Microsoft Entra ID \n 7. Azure Activity \n 8. Amazon Web Services \n 9. Azure Firewall \n 10. SquidProxy \n 11. Zscaler Private Access (ZPA) \n 12. Syslog \n 13. Check Point \n 14. Microsoft Defender XDR",
  "Workbooks": [
	"Workbooks/Log4jPostCompromiseHunting.json",
	"Workbooks/Log4jImpactAssessment.json"
  ],
  "Analytic Rules": [
    "Analytic Rules/Log4jVulnerableMachines.yaml",
    "Analytic Rules/AzureWAFmatching_log4j_vuln.yaml",
    "Analytic Rules/Log4J_IPIOC_Dec112021.yaml",
    "Analytic Rules/UserAgentSearch_log4j.yaml"
  ],
  "Hunting Queries": [
    "Hunting Queries/WAF_log4j_vulnerability.yaml",
    "Hunting Queries/NetworkConnectionldap_log4j.yaml",
    "Hunting Queries/Firewall_Disable_Activity.yaml",
    "Hunting Queries/Apache_log4j_Vulnerability.yaml",
    "Hunting Queries/Process_Termination_Activity.yaml",
    "Hunting Queries/Suspicious_ShellScript_Activity.yaml",
    "Hunting Queries/Base64_Download_Activity.yaml",
    "Hunting Queries/Container_Miner_Activity.yaml",
    "Hunting Queries/Linux_Toolkit_Detected.yaml",
    "Hunting Queries/NetworkConnectionToNewExternalLDAPServer.yaml"
  ],
  "Playbooks": [
	"Playbooks/BatchImport/BatchImportToSentinel.json",
	"Playbooks/IndicateProcessor/Log4jIndicatorProcessor.json"
  ],
  "Watchlists" : [
	"Workbooks/Watchlist/Log4j.json"
  ],
  "BasePath": "C:\\GitHub\\Azure-Sentinel\\Solutions\\Apache Log4j Vulnerability Detection",
  "Metadata": "SolutionMetadata.json",
  "Version": "3.0.2",
  "TemplateSpec": true,
  "Is1Pconnector": true
}