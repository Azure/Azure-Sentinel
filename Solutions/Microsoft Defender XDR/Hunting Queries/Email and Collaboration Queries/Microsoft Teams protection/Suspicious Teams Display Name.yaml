id: 02bdbd93-02b7-40e4-9468-d501463e57af
name: Suspicious Teams Display Name
description: |
  This query looks for Teams messages from an external user with a suspicious display name.
description-detailed: |
  This query looks for Teams messages from an external user with a suspicious display name.
  Threat actors may attempt to socially engineer a user by using display names such as IT Support or Help Desk to establish trust.
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - MessageEvents
tactics:
  - InitialAccess
relevantTechniques:
  - T1566
query: |
  let SuspiciousDisplayNames = pack_array("Microsoft  Security", "Help Desk", "Help Desk Team", "Help Desk IT", "Microsoft Security", "IT Support", "Helpdesk");
  MessageEvents
  | where IsExternalThread == 1 and IsOwnedThread == 0
  | where SenderDisplayName has_any (SuspiciousDisplayNames)
version: 1.0.0