id: fea3f03b-0723-4f3e-9f6a-c8a6a67fbde0
name: Teams post delivery events daily trend
description: |
  This query visualizes the daily amount of post delivery events on Teams messages.
description-detailed: |
  This query visualizes the daily amount of post delivery events on Teams messages.
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - MessagePostDeliveryEvents
tactics:
  - InitialAccess
relevantTechniques:
  - T1566
query: |
  //Teams post delivery ZAP events daily trend
  let TimeStart = startofday(ago(30d));
  let TimeEnd = startofday(now());
  MessagePostDeliveryEvents
  | where Timestamp >= TimeStart
  | where ActionType has "ZAP"
  | make-series ZappedTeamsMessages = count() default = 0 on Timestamp from TimeStart to TimeEnd step 1d
  | render timechart
version: 1.0.0