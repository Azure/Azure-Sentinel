{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "config": {
      "isWizard": false,
      "basics": {
        "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Azure_Sentinel.svg\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Microsoft%20Defender%20XDR/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe [Microsoft Defender XDR](https://www.microsoft.com/security/business/threat-protection/microsoft-365-defender) solution for Microsoft Sentinel enables you to ingest Security Alerts/Incidents and raw logs from the products within Microsoft Defender XDR suite into Microsoft Sentinel.\n\nAdditional Hunting Queries to support proactive and reactive hunting for the Microsoft Defender XDR solution can be found on [GitHub](https://github.com/Azure/Azure-Sentinel/tree/master/Hunting%20Queries/Microsoft%20365%20Defender). This repository has a collection of queries developed by Microsoft Security Research and Microsoft Sentinel community contributions.\n\n**Underlying Microsoft Technologies used:**\n\nThis solution takes a dependency on the following technologies, and some of these dependencies either may be in [Preview](https://azure.microsoft.com/support/legal/preview-supplemental-terms/) state or might result in additional ingestion or operational costs:\n\na. [Azure Monitor HTTP Data Collector API](https://docs.microsoft.com/azure/azure-monitor/logs/data-collector-api)\n\n**Data Connectors:** 1, **Workbooks:** 3, **Analytic Rules:** 40, **Hunting Queries:** 160\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
        "subscription": {
          "resourceProviders": [
            "Microsoft.OperationsManagement/solutions",
            "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "Microsoft.Insights/workbooks",
            "Microsoft.Logic/workflows"
          ]
        },
        "location": {
          "metadata": {
            "hidden": "Hiding location, we get it from the log analytics workspace"
          },
          "visible": false
        },
        "resourceGroup": {
          "allowExisting": true
        }
      }
    },
    "basics": [
      {
        "name": "getLAWorkspace",
        "type": "Microsoft.Solutions.ArmApiControl",
        "toolTip": "This filters by workspaces that exist in the Resource Group selected",
        "condition": "[greater(length(resourceGroup().name),0)]",
        "request": {
          "method": "GET",
          "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
        }
      },
      {
        "name": "workspace",
        "type": "Microsoft.Common.DropDown",
        "label": "Workspace",
        "placeholder": "Select a workspace",
        "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
        "constraints": {
          "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
          "required": true
        },
        "visible": true
      }
    ],
    "steps": [
      {
        "name": "dataconnectors",
        "label": "Data Connectors",
        "bladeTitle": "Data Connectors",
        "elements": [
          {
            "name": "dataconnectors1-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Microsoft Defender XDR. You can get Microsoft Defender XDR custom log data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link2",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          }
        ]
      },
      {
        "name": "workbooks",
        "label": "Workbooks",
        "subLabel": {
          "preValidation": "Configure the workbooks",
          "postValidation": "Done"
        },
        "bladeTitle": "Workbooks",
        "elements": [
          {
            "name": "workbooks-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This solution installs workbook(s) to help you gain insights into the telemetry collected in Microsoft Sentinel. After installing the solution, start using the workbook in Manage solution view."
            }
          },
          {
            "name": "workbooks-link",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more",
                "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-monitor-your-data"
              }
            }
          },
          {
            "name": "workbook1",
            "type": "Microsoft.Common.Section",
            "label": "Microsoft Defender for Office 365 Detection and Insights",
            "elements": [
              {
                "name": "workbook1-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Gain extensive insight into your organization's Microsoft Defender for Office 365 Detections by analyzing and correlating events. \nYou can track various detections and insights over time including: metrics for phish, spam, malware, URL and URL click detection details, post delivery detections, user and admin submissions, system overrides and actions taken by security administrators."
                }
              }
            ]
          },
          {
            "name": "workbook2",
            "type": "Microsoft.Common.Section",
            "label": "Microsoft Defender For EndPoint",
            "elements": [
              {
                "name": "workbook2-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "A wokbook to provide details about Microsoft Defender for Endpoint Advance Hunting to Overview & Analyse data brought through M365 Defender Connector."
                }
              }
            ]
          },
          {
            "name": "workbook3",
            "type": "Microsoft.Common.Section",
            "label": "Microsoft Defender For Identity",
            "elements": [
              {
                "name": "workbook3-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Use this workbook to analyse the advance hunting data ingested for Defender For Identity."
                }
              }
            ]
          }
        ]
      },
      {
        "name": "analytics",
        "label": "Analytics",
        "subLabel": {
          "preValidation": "Configure the analytics",
          "postValidation": "Done"
        },
        "bladeTitle": "Analytics",
        "elements": [
          {
            "name": "analytics-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This solution installs the following analytic rule templates. After installing the solution, create and enable analytic rules in Manage solution view."
            }
          },
          {
            "name": "analytics-link",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more",
                "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-detect-threats-custom?WT.mc_id=Portal-Microsoft_Azure_CreateUIDef"
              }
            }
          },
          {
            "name": "analytic1",
            "type": "Microsoft.Common.Section",
            "label": "Possible Phishing with CSL and Network Sessions",
            "elements": [
              {
                "name": "analytic1-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for malicious URL clicks in phishing email recognized by MDO in correlation with CommonSecurityLogs(CSL) & NetworkSession events. \nIf your workspace doesnt have one of the many data sources required for ASIM it may give informational error which can be safely ignored."
                }
              }
            ]
          },
          {
            "name": "analytic2",
            "type": "Microsoft.Common.Section",
            "label": "SUNSPOT malware hashes",
            "elements": [
              {
                "name": "analytic2-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query uses Microsoft Defender for Endpoint data to look for IoCs associated with the SUNSPOT malware shared by Crowdstrike.\nMore details: \n  - https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/ \n  - https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-your-software-build-process-with-azure-sentinel/ba-p/2140807"
                }
              }
            ]
          },
          {
            "name": "analytic3",
            "type": "Microsoft.Common.Section",
            "label": "Potential Build Process Compromise - MDE",
            "elements": [
              {
                "name": "analytic3-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The query looks for source code files being modified immediately after a build process is started. The purpose of this is to look for malicious code injection during the build process. This query uses Microsoft Defender for Endpoint telemetry.\nMore details: https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-the-software-supply-chain-with-azure-sentinel/ba-p/2176463"
                }
              }
            ]
          },
          {
            "name": "analytic4",
            "type": "Microsoft.Common.Section",
            "label": "TEARDROP memory-only dropper",
            "elements": [
              {
                "name": "analytic4-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Identifies SolarWinds TEARDROP memory-only dropper IOCs in Window's defender Exploit Guard activity\nReferences:\n- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html\n- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f"
                }
              }
            ]
          },
          {
            "name": "analytic5",
            "type": "Microsoft.Common.Section",
            "label": "SUNBURST network beacons",
            "elements": [
              {
                "name": "analytic5-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Identifies SolarWinds SUNBURST domain beacon IOCs in DeviceNetworkEvents\nReferences:\n- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html\n- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f"
                }
              }
            ]
          },
          {
            "name": "analytic6",
            "type": "Microsoft.Common.Section",
            "label": "SUNBURST and SUPERNOVA backdoor hashes",
            "elements": [
              {
                "name": "analytic6-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Identifies SolarWinds SUNBURST and SUPERNOVA backdoor file hash IOCs in DeviceFileEvents\nReferences:\n- https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html\n- https://gist.github.com/olafhartong/71ffdd4cab4b6acd5cbcd1a0691ff82f"
                }
              }
            ]
          },
          {
            "name": "analytic7",
            "type": "Microsoft.Common.Section",
            "label": "AV detections related to Ukraine threats",
            "elements": [
              {
                "name": "analytic7-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for Microsoft Defender AV detections for malware observed in relation to the war in Ukraine.\n  Ref: https://msrc-blog.microsoft.com/2022/02/28/analysis-resources-cyber-threat-activity-ukraine/ "
                }
              }
            ]
          },
          {
            "name": "analytic8",
            "type": "Microsoft.Common.Section",
            "label": "AV detections related to Tarrask malware",
            "elements": [
              {
                "name": "analytic8-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for Microsoft Defender AV detections related to Tarrask malware. In Microsoft Sentinel, the SecurityAlerts table includes only the Device Name of the affected device, this query joins the DeviceInfo table to clearly connect other information such as Device group, ip, logged-on users etc. \n This would allow the Microsoft Sentinel analyst to have more context related to the alert, if available.\n Reference: https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/"
                }
              }
            ]
          },
          {
            "name": "analytic9",
            "type": "Microsoft.Common.Section",
            "label": "AV detections related to SpringShell Vulnerability",
            "elements": [
              {
                "name": "analytic9-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for Microsoft Defender AV detections related to the SpringShell vulnerability. In Microsoft Sentinel, the SecurityAlerts table includes only the Device Name of the affected device.\n  This query joins the DeviceInfo table to clearly connect other information such as device group, IP, logged-on users, etc. This would allow the Microsoft Sentinel analyst to have more context related to the alert, if available.\n  Reference: https://www.microsoft.com/security/blog/2022/04/04/springshell-rce-vulnerability-guidance-for-protecting-against-and-detecting-cve-2022-22965/"
                }
              }
            ]
          },
          {
            "name": "analytic10",
            "type": "Microsoft.Common.Section",
            "label": "Execution of software vulnerable to webp buffer overflow of CVE-2023-4863",
            "elements": [
              {
                "name": "analytic10-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks at device, process, and network events from Defender for Endpoint that may be vulnerable to buffer overflow defined in CVE-2023-4863. Results are not an indicator of malicious activity."
                }
              }
            ]
          },
          {
            "name": "analytic11",
            "type": "Microsoft.Common.Section",
            "label": "Deimos Component Execution",
            "elements": [
              {
                "name": "analytic11-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Jupyter, otherwise known as SolarMarker, is a malware family and cluster of components known for its info-stealing and backdoor capabilities that mainly proliferates through search engine optimization manipulation and malicious advertising in order to successfully encourage users to download malicious templates and documents. This malware has been popular since 2020 and currently is still active as of 2021."
                }
              }
            ]
          },
          {
            "name": "analytic12",
            "type": "Microsoft.Common.Section",
            "label": "Imminent Ransomware",
            "elements": [
              {
                "name": "analytic12-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for a series of commands that are commonly used by attackers to disable security tools and system recovery tools before deploying Macaw ransomware in an organization."
                }
              }
            ]
          },
          {
            "name": "analytic13",
            "type": "Microsoft.Common.Section",
            "label": "Java Executing cmd to run Powershell",
            "elements": [
              {
                "name": "analytic13-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Sysrv botnet evolution.\nSysrv is a Go-based botnet that targets both Windows and Linux servers, and steals resources to mine cryptocurrency.\nThe following query finds instances of the Java process being used to execute cmd.exe, and download and execute a PowerShell script."
                }
              }
            ]
          },
          {
            "name": "analytic14",
            "type": "Microsoft.Common.Section",
            "label": "C2-NamedPipe",
            "elements": [
              {
                "name": "analytic14-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Detects the creation of a named pipe used by known APT malware.\nReference - https://docs.microsoft.com/openspecs/windows_protocols/ms-wpo/4de75e21-36fd-440a-859b-75accc74487c"
                }
              }
            ]
          },
          {
            "name": "analytic15",
            "type": "Microsoft.Common.Section",
            "label": "DopplePaymer Procdump",
            "elements": [
              {
                "name": "analytic15-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Doppelpaymer: More human-operated ransomware. There is also a related blog.\nDoppelPaymer is ransomware that is spread manually by human operators. These operators have exhibited extensive knowledge of system administration and common network security misconfigurations. For example, they use SysInternal utilities such as ProcDump to dump credentials from LSASS. They often use these stolen credentials to turn off security software, run malicious commands, and spread malware throughout an organization.\nThe following query detects ProcDump being used to dump credentials from LSASS.\nThe See also section below lists links to other queries associated with DoppelPaymer.\nReferences:\nhttps://msrc-blog.microsoft.com/2019/11/20/customer-guidance-for-the-dopplepaymer-ransomware/\nhttps://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:Win32/DoppelPaymer.KM!MTB\nhttps://docs.microsoft.com/sysinternals/downloads/procdump\nhttps://docs.microsoft.com/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection"
                }
              }
            ]
          },
          {
            "name": "analytic16",
            "type": "Microsoft.Common.Section",
            "label": "LSASS Credential Dumping with Procdump",
            "elements": [
              {
                "name": "analytic16-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, \"Exchange Server zero-days exploited in the wild\".\nIn early March 2021, Microsoft released patches for four different zero-day vulnerabilities affecting Microsoft Exchange Server. The vulnerabilities were being used in a coordinated attack. For more information on the vulnerabilities, visit the following links:\n1. CVE-2021-26855\n2. CVE-2021-26857\n3. CVE-2021-26858\n4. CVE-2021-27065\nThe following query looks for evidence of Procdump being used to dump credentials from LSASS, the Local Security Authentication Server. This might indicate an attacker has compromised user accounts.\nMore queries related to this threat can be found under the See also section of this page.\nReference - https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/"
                }
              }
            ]
          },
          {
            "name": "analytic17",
            "type": "Microsoft.Common.Section",
            "label": "Doppelpaymer Stop Services",
            "elements": [
              {
                "name": "analytic17-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Doppelpaymer: More human-operated ransomware. There is also a related blog.\nDoppelPaymer is ransomware that is spread manually by human operators. These operators have exhibited extensive knowledge of system administration and common network security misconfigurations. They often use stolen credentials from over-privileged service accounts to turn off security software, run malicious commands, and spread malware throughout an organization.\nThe following query detects attempts to stop security services.\nThe See also section below lists links to other queries associated with DoppelPaymer.\nReferences:\nhttps://msrc-blog.microsoft.com/2019/11/20/customer-guidance-for-the-dopplepaymer-ransomware/\nhttps://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:Win32/DoppelPaymer.KM!MTB"
                }
              }
            ]
          },
          {
            "name": "analytic18",
            "type": "Microsoft.Common.Section",
            "label": "Qakbot Campaign Self Deletion",
            "elements": [
              {
                "name": "analytic18-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Qakbot blight lingers, seeds ransomware\nQakbot is malware that steals login credentials from banking and financial services. It has been deployed against small businesses as well as major corporations. Some outbreaks have involved targeted ransomware campaigns that use a similar set of techniques. Links to related queries are listed under See also.\nThe following query detects if an instance of Qakbot has attempted to overwrite its original binary.\nReference - https://www.microsoft.com/security/blog/2017/11/06/mitigating-and-eliminating-info-stealing-qakbot-and-emotet-in-corporate-networks/"
                }
              }
            ]
          },
          {
            "name": "analytic19",
            "type": "Microsoft.Common.Section",
            "label": "Regsvr32 Rundll32 Image Loads Abnormal Extension",
            "elements": [
              {
                "name": "analytic19-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query is looking for regsvr32.exe or rundll32.exe loading DLL images with other extensions than .dll.\nJoins the data to public network events.\nReferences:\nhttps://threathunt.blog/running-live-malware-for-threat-hunting-purposes/"
                }
              }
            ]
          },
          {
            "name": "analytic20",
            "type": "Microsoft.Common.Section",
            "label": "Regsvr32 Rundll32 with Anomalous Parent Process",
            "elements": [
              {
                "name": "analytic20-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This analytical rule looks for rundll32.exe or regsvr32.exe being spawned by abnormal processes: wscript.exe, powershell.exe, cmd.exe, pwsh.exe, cscript.exe.\nBlog: https://threathunt.blog/running-live-malware-for-threat-hunting-purposes/"
                }
              }
            ]
          },
          {
            "name": "analytic21",
            "type": "Microsoft.Common.Section",
            "label": "Detect Suspicious Commands Initiated by Webserver Processes",
            "elements": [
              {
                "name": "analytic21-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Operation Soft Cell.\nOperation Soft Cell is a series of campaigns targeting users' call logs at telecommunications providers throughout the world. These attacks date from as early as 2012.\nOperation Soft Cell operators sometimes use legitimate web server processes to launch commands, especially for network discovery and user/owner discovery. The following query detects activity of this kind.\nReference - https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers"
                }
              }
            ]
          },
          {
            "name": "analytic22",
            "type": "Microsoft.Common.Section",
            "label": "Bitsadmin Activity",
            "elements": [
              {
                "name": "analytic22-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Background Intelligent Transfer Service (BITS) is a way to reliably download files from webservers or SMB servers. \nThis service is commonly used for legitimate purposes, but can also be used as part of a malware downloader. \nAdditionally, bitsadmin can be used to upload files and therefore can be used for data exfiltration. This\nquery will identify use of bitsadmin.exe for either purpose and will identify directionality file transfer\ndirectionality."
                }
              }
            ]
          },
          {
            "name": "analytic23",
            "type": "Microsoft.Common.Section",
            "label": "Office Apps Launching Wscipt",
            "elements": [
              {
                "name": "analytic23-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Trickbot: Pervasive & underestimated.\nTrickbot is a very prevalent piece of malware with an array of malicious capabilities. Originally designed to steal banking credentials, it has since evolved into a modular trojan that can deploy other malware, disable security software, and perform command-and-control (C2) operations.\nTrickbot is frequently spread through email. An attacker will send a target a message with an attachment containing a malicious macro. If the target enables the macro, it will write a JScript Encoded (JSE) file to disk (JScript is a Microsoft dialect of ECMAScript). The JSE file will then be launched using wscript.exe to perform a variety of malicious tasks, particularly reconnaissance.\nThe following query detects when Office applications have launched wscript.exe to run a JSE file.\nSee Detect rundll.exe being used for reconnaissance and command-and-control for another query related to Trickbot activity.\nReference - https://attack.mitre.org/software/S0266/"
                }
              }
            ]
          },
          {
            "name": "analytic24",
            "type": "Microsoft.Common.Section",
            "label": "Detect Potential Kerberoast Activities",
            "elements": [
              {
                "name": "analytic24-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query aim to detect if someone requests service tickets (where count => maxcount)\nThe query requires trimming to set a baseline level for MaxCount  \nMitre Technique: Kerberoasting (T1558.003)\n@MattiasBorg82"
                }
              }
            ]
          },
          {
            "name": "analytic25",
            "type": "Microsoft.Common.Section",
            "label": "Files Copied to USB Drives",
            "elements": [
              {
                "name": "analytic25-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query lists files copied to USB external drives with USB drive information based on FileCreated events associated with most recent USBDriveMount events befor file creations. But be aware that Advanced Hunting is not monitoring all the file types."
                }
              }
            ]
          },
          {
            "name": "analytic26",
            "type": "Microsoft.Common.Section",
            "label": "MosaicLoader",
            "elements": [
              {
                "name": "analytic26-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks Malware Hides Itself Among Windows Defender Exclusions to Evade Detection."
                }
              }
            ]
          },
          {
            "name": "analytic27",
            "type": "Microsoft.Common.Section",
            "label": "Unusual Volume of file deletion by users",
            "elements": [
              {
                "name": "analytic27-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for users performing file deletion activities. Spikes in file deletion observed from risky sign-in sessions are flagged here.\nThis applies to SharePoint and OneDrive users.\nAudit event and Cloud application identifier references.\nReference - https://learn.microsoft.com/microsoft-365/compliance/audit-log-activities?view=o365-worldwide\nReference - https://learn.microsoft.com/azure/sentinel/entities-reference#cloud-application-identifiers"
                }
              }
            ]
          },
          {
            "name": "analytic28",
            "type": "Microsoft.Common.Section",
            "label": "Remote File Creation with PsExec",
            "elements": [
              {
                "name": "analytic28-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query was originally published in the threat analytics report, Ryuk ransomware. There is also a related blog.\nRyuk is human-operated ransomware. Much like DoppelPaymer ransomware, Ryuk is spread manually, often on networks that are already infected with Trickbot.\nRyuk operators use PsExec to manually spread the ransomware to other devices.\nThe following query detects remote file creation events that might indicate an active attack.\nThe See also section below lists links to other queries associated with Ryuk ransomware.\nReferences:\nhttps://www.microsoft.com/security/blog/2020/03/05/human-operated-ransomware-attacks-a-preventable-disaster/\nhttps://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:Win32/Ryuk.AA\nhttps://www.microsoft.com/security/blog/2020/03/05/human-operated-ransomware-attacks-a-preventable-disaster/\nhttps://docs.microsoft.com/sysinternals/downloads/psexec"
                }
              }
            ]
          },
          {
            "name": "analytic29",
            "type": "Microsoft.Common.Section",
            "label": "Service Accounts Performing Remote PS",
            "elements": [
              {
                "name": "analytic29-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Service Accounts Performing Remote PowerShell.\nThe purpose behind this detection is for finding service accounts that are performing remote powershell sessions.\nThere are two phases to the detection: Identify service accounts, Find remote PS cmdlets being ran by these accounts.\nTo accomplish this, we utilize DeviceLogonEvents and DeviceEvents to find cmdlets ran that meet the criteria.\nOne of the main advantages of this method is that only requires server telemetry, and not the attacking client.\nThe first phase relies on the DeviceLogonEvents to determine whether an account is a service account or not, consider the following accounts with logons:.\nRandom_user has DeviceLogonEvents with type 2, 3, 7, 10, 11 & 13.\nRandom_service_account 'should' only have DeviceLogonEvents with type 3,4 or 5."
                }
              }
            ]
          },
          {
            "name": "analytic30",
            "type": "Microsoft.Common.Section",
            "label": "Account Creation",
            "elements": [
              {
                "name": "analytic30-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "User accounts may be created to achieve persistence on a machine.\nRead more here: https://attack.mitre.org/wiki/Technique/T1136.\nTags: #CreateAccount.\nQuery #1: Query for users being created using \"net user\" command.\n\"net user\" commands are noisy, so needs to be joined with another signal -.\nE.g. in this example we look for use of uncommon & undocumented commandline switches (e.g. /ad instead of /add)."
                }
              }
            ]
          },
          {
            "name": "analytic31",
            "type": "Microsoft.Common.Section",
            "label": "Local Admin Group Changes",
            "elements": [
              {
                "name": "analytic31-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for changes to the local administrators group.\nBlogpost: https://www.verboon.info/2020/09/hunting-for-local-group-membership-changes."
                }
              }
            ]
          },
          {
            "name": "analytic32",
            "type": "Microsoft.Common.Section",
            "label": "Rare Process as a Service",
            "elements": [
              {
                "name": "analytic32-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query is looking for rarely seen processes which are launched as a service. Whiltelisted process list need to be updated based on the environment.\nAuthor: Jouni Mikkola\nMore info: https://threathunt.blog/rare-process-launch-as-a-service/"
                }
              }
            ]
          },
          {
            "name": "analytic33",
            "type": "Microsoft.Common.Section",
            "label": "Disabling Security Services via Registry",
            "elements": [
              {
                "name": "analytic33-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for processes modifying the registry to disable security features. This is a common technique used by threat actors for defence evasion."
                }
              }
            ]
          },
          {
            "name": "analytic34",
            "type": "Microsoft.Common.Section",
            "label": "Deletion of data on multiple drives using cipher exe",
            "elements": [
              {
                "name": "analytic34-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to delete data on multiple drives using cipher.exe. This activity is typically done by ransomware to prevent recovery of data after encryption."
                }
              }
            ]
          },
          {
            "name": "analytic35",
            "type": "Microsoft.Common.Section",
            "label": "LaZagne Credential Theft",
            "elements": [
              {
                "name": "analytic35-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "LaZagne is a popular open-source tool used to recover passwords stored on a local computer. It has been used in ransomware attacks to steal credentials and escalate privileges. This query looks for the execution of LaZagne."
                }
              }
            ]
          },
          {
            "name": "analytic36",
            "type": "Microsoft.Common.Section",
            "label": "Clearing of forensic evidence from event logs using wevtutil",
            "elements": [
              {
                "name": "analytic36-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to clear at least 10 log entries from event logs using wevtutil. Clearing event logs can be a sign of ransomware activity, as ransomware often attempts to cover its tracks by deleting logs."
                }
              }
            ]
          },
          {
            "name": "analytic37",
            "type": "Microsoft.Common.Section",
            "label": "Stopping multiple processes using taskkill",
            "elements": [
              {
                "name": "analytic37-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to stop at least 10 separate processes using the taskkill.exe utility. This is a common technique used by ransomware to stop security products and other processes."
                }
              }
            ]
          },
          {
            "name": "analytic38",
            "type": "Microsoft.Common.Section",
            "label": "Potential Ransomware activity related to Cobalt Strike",
            "elements": [
              {
                "name": "analytic38-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for alerts related to suspected ransomware and Cobalt Strike activity, a tool used in numerous ransomware campaigns. It looks for alerts that indicate potential ransomware activity, such as attempts to clear security event logs, delete backup files, and execute Cobalt Strike malware."
                }
              }
            ]
          },
          {
            "name": "analytic39",
            "type": "Microsoft.Common.Section",
            "label": "Qakbot Discovery Activies",
            "elements": [
              {
                "name": "analytic39-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for injected processes launching discovery activity. Qakbot has been observed leading to ransomware in numerous instances. It looks for discovery commands such as net.exe, whoami.exe, nslookup.exe, netstat.exe, arp.exe, and ping.exe."
                }
              }
            ]
          },
          {
            "name": "analytic40",
            "type": "Microsoft.Common.Section",
            "label": "Shadow Copy Deletions",
            "elements": [
              {
                "name": "analytic40-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This rule detects when Shadow Copies are being deleted. This is a know actions that is performed by threat actors.\nThis query detects know commands that have been used by the ransomware actors.\nSome information from Mitre Attack: \nhttps://attack.mitre.org/techniques/T1490/"
                }
              }
            ]
          }
        ]
      },
      {
        "name": "huntingqueries",
        "label": "Hunting Queries",
        "bladeTitle": "Hunting Queries",
        "elements": [
          {
            "name": "huntingqueries-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This solution installs the following hunting queries. After installing the solution, run these hunting queries to hunt for threats in Manage solution view. "
            }
          },
          {
            "name": "huntingqueries-link",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more",
                "uri": "https://docs.microsoft.com/azure/sentinel/hunting"
              }
            }
          },
          {
            "name": "huntingquery1",
            "type": "Microsoft.Common.Section",
            "label": "Spoofing attempts from Specific Domains",
            "elements": [
              {
                "name": "huntingquery1-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query identifies potential phishing or spoofing attempts originating from specific domains with authentication failures. This hunting query depends on OfficeATP data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery2",
            "type": "Microsoft.Common.Section",
            "label": "Determine Successfully Delivered Phishing Emails by top IP Addresses",
            "elements": [
              {
                "name": "huntingquery2-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query identifies phishing emails sent that were successfully delivered, by top IP addressess. cutoff default value is 5, adjust the value as needed. This hunting query depends on OfficeATP data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery3",
            "type": "Microsoft.Common.Section",
            "label": "Determine Successfully Delivered Phishing Emails to Inbox/Junk folder.",
            "elements": [
              {
                "name": "huntingquery3-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query identifies threats which got successfully delivered to Inbox/Junk folder. This hunting query depends on OfficeATP data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery4",
            "type": "Microsoft.Common.Section",
            "label": "Deimos Component Execution",
            "elements": [
              {
                "name": "huntingquery4-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Jupyter, otherwise known as SolarMarker, is a malware family and cluster of components known for its info-stealing and backdoor capabilities that mainly proliferates through search engine optimization manipulation and malicious advertising. This hunting query depends on MicrosoftThreatProtection data connector (DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery5",
            "type": "Microsoft.Common.Section",
            "label": "LemonDuck Registration Function",
            "elements": [
              {
                "name": "huntingquery5-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "LemonDuck is a malware primarily known for its botnet and cryptocurrency mining objectives. First discovered in 2019, LemonDuck has since adopted more sophisticated behavior and escalated its operations in 2021. This hunting query depends on MicrosoftThreatProtection data connector (DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery6",
            "type": "Microsoft.Common.Section",
            "label": "Devices with Log4j vulnerability alerts and additional other alert related context",
            "elements": [
              {
                "name": "huntingquery6-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Microsoft has observed threat actors exploiting vulnerabilities associated with Log4J. This hunting query depends on MicrosoftThreatProtection data connector (AlertInfo AlertEvidence Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery7",
            "type": "Microsoft.Common.Section",
            "label": "Alerts Related to Log4j Vulnerability",
            "elements": [
              {
                "name": "huntingquery7-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Microsoft has observed attackers exploiting vulnerabilities associated with Log4J. This hunting query depends on MicrosoftThreatProtection data connector (AlertInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery8",
            "type": "Microsoft.Common.Section",
            "label": "Malicious Use of MSBuild as LOLBin",
            "elements": [
              {
                "name": "huntingquery8-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Prior to deploying Macaw ransomware in an organization, the adversary frequently uses MSBuild.exe as a LOLBin to communicate with the C2. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery9",
            "type": "Microsoft.Common.Section",
            "label": "Qakbot Reconnaissance Activities",
            "elements": [
              {
                "name": "huntingquery9-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for reconnaissance and beaconing activities after code injection occurs in Qakbot infections. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery10",
            "type": "Microsoft.Common.Section",
            "label": "Judgement Panda Exfil Activity",
            "elements": [
              {
                "name": "huntingquery10-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Original Sigma Rule: https://github.com/Neo23x0/sigma/blob/master/rules/apt/apt_judgement_panda_gtr19.yml.\nQuestions via Twitter: @janvonkirchheim. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery11",
            "type": "Microsoft.Common.Section",
            "label": "C2-NamedPipe",
            "elements": [
              {
                "name": "huntingquery11-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Detects the creation of a named pipe used by known APT malware.\nReference - https://docs.microsoft.com/openspecs/windows_protocols/ms-wpo/4de75e21-36fd-440a-859b-75accc74487c This hunting query depends on MicrosoftThreatProtection data connector (DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery12",
            "type": "Microsoft.Common.Section",
            "label": "Recon with Rundll",
            "elements": [
              {
                "name": "huntingquery12-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query detects suspicious rundll.exe activity associated with Trickbot campaigns. This hunting query depends on MicrosoftThreatProtection data connector (DeviceNetworkEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery13",
            "type": "Microsoft.Common.Section",
            "label": "DopplePaymer Procdump",
            "elements": [
              {
                "name": "huntingquery13-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Detects the use of ProcDump to dump credentials from LSASS memory by DoppelPaymer ransomware operators. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery14",
            "type": "Microsoft.Common.Section",
            "label": "Credential Harvesting Using LaZagne",
            "elements": [
              {
                "name": "huntingquery14-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Detects the use of LaZagne to steal credentials from the SAM database by Ryuk ransomware operators. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery15",
            "type": "Microsoft.Common.Section",
            "label": "LSASS Credential Dumping with Procdump",
            "elements": [
              {
                "name": "huntingquery15-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Detects the use of Procdump to dump credentials from LSASS memory. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery16",
            "type": "Microsoft.Common.Section",
            "label": "Doppelpaymer Stop Services",
            "elements": [
              {
                "name": "huntingquery16-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for attempts to stop security services, which is a common tactic used by DoppelPaymer ransomware operators. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery17",
            "type": "Microsoft.Common.Section",
            "label": "Qakbot Campaign Self Deletion",
            "elements": [
              {
                "name": "huntingquery17-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query detects if an instance of Qakbot has attempted to overwrite its original binary. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery18",
            "type": "Microsoft.Common.Section",
            "label": "Detect Suspicious Commands Initiated by Webserver Processes",
            "elements": [
              {
                "name": "huntingquery18-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Detect suspicious commands initiated by web server processes used for network discovery and user/owner discovery. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery19",
            "type": "Microsoft.Common.Section",
            "label": "Anomalous Payload Delivered from ISO files",
            "elements": [
              {
                "name": "huntingquery19-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for lnk file executions from other locations than C: drive, which can relate to mounted ISO-files. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery20",
            "type": "Microsoft.Common.Section",
            "label": "Bitsadmin Activity",
            "elements": [
              {
                "name": "huntingquery20-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for use of bitsadmin.exe for file transfer, which can be used for legitimate purposes or as part of a malware downloader. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery21",
            "type": "Microsoft.Common.Section",
            "label": "Detect Malicious use of MSIExec",
            "elements": [
              {
                "name": "huntingquery21-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query detects possible download and execution using Msiexec. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery22",
            "type": "Microsoft.Common.Section",
            "label": "Detect Malicious use of Msiexec Mimikatz",
            "elements": [
              {
                "name": "huntingquery22-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for malicious use of msiexec.exe, particularly alongside mimikatz, a common credential dumper and privilege escalation tool. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery23",
            "type": "Microsoft.Common.Section",
            "label": "Office Apps Launching Wscipt",
            "elements": [
              {
                "name": "huntingquery23-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The query searches for Office applications launching wscript.exe to run a JSE file. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery24",
            "type": "Microsoft.Common.Section",
            "label": "PowerShell Downloads",
            "elements": [
              {
                "name": "huntingquery24-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The query searches for PowerShell execution events that could involve a download. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery25",
            "type": "Microsoft.Common.Section",
            "label": "Detect Suspicious Mshta Usage",
            "elements": [
              {
                "name": "huntingquery25-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query detects when mshta.exe has been run, which might include illegitimate usage by attackers. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery26",
            "type": "Microsoft.Common.Section",
            "label": "Files Copied to USB Drives",
            "elements": [
              {
                "name": "huntingquery26-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query lists files copied to USB external drives with USB drive information based on FileCreated events associated with most recent USBDriveMount events befor file creations. This hunting query depends on MicrosoftThreatProtection data connector (DeviceEvents DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery27",
            "type": "Microsoft.Common.Section",
            "label": "Suspicious DLLs in spool Folder",
            "elements": [
              {
                "name": "huntingquery27-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Look for the creation of suspicious DLL files spawned in the \\spool\\ folder along with DLLs that were recently loaded afterwards from \\Old. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents DeviceImageLoadEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery28",
            "type": "Microsoft.Common.Section",
            "label": "Suspicious Files in spool Folder",
            "elements": [
              {
                "name": "huntingquery28-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Monitor for creation of suspicious files in the /spools/driver/ folder. This is a broad-based search that will surface any creation or modification of files in the folder targeted by this exploit. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery29",
            "type": "Microsoft.Common.Section",
            "label": "Suspicious Spoolsv Child Process",
            "elements": [
              {
                "name": "huntingquery29-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Surfaces suspicious spoolsv.exe behavior likely related to CVE-2021-1675 This hunting query depends on MicrosoftThreatProtection data connector (DeviceImageLoadEvents DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery30",
            "type": "Microsoft.Common.Section",
            "label": "Suspicious Tomcat Confluence Process Launch",
            "elements": [
              {
                "name": "huntingquery30-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The query checks for suspicious Tomcat process launches associated with likely exploitation of Confluence - CVE-2022-26134. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery31",
            "type": "Microsoft.Common.Section",
            "label": "MosaicLoader",
            "elements": [
              {
                "name": "huntingquery31-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This hunting query looks Malware Hides Itself Among Windows Defender Exclusions to Evade Detection. This hunting query depends on MicrosoftThreatProtection data connector (DeviceRegistryEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery32",
            "type": "Microsoft.Common.Section",
            "label": "PrintNightmare CVE-2021-1675 usage Detection",
            "elements": [
              {
                "name": "huntingquery32-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for any file creations in the print spooler drivers folder. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery33",
            "type": "Microsoft.Common.Section",
            "label": "Unusual Volume of file deletion by users",
            "elements": [
              {
                "name": "huntingquery33-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for users performing file deletion activities. Spikes in file deletion observed from risky sign-in sessions are flagged here. This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents AADSignInEventsBeta Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery34",
            "type": "Microsoft.Common.Section",
            "label": "Detect MaiSniper",
            "elements": [
              {
                "name": "huntingquery34-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for usage of MailSniper Exchange attack tool. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents DeviceNetworkEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery35",
            "type": "Microsoft.Common.Section",
            "label": "Account Brute Force",
            "elements": [
              {
                "name": "huntingquery35-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This hunting query searches for public IP addresses that failed to logon to a computer multiple times, using multiple accounts, and eventually succeeded. This hunting query depends on MicrosoftThreatProtection data connector (DeviceLogonEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery36",
            "type": "Microsoft.Common.Section",
            "label": "Service Accounts Performing Remote PS",
            "elements": [
              {
                "name": "huntingquery36-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for any Service Accounts Performing Remote PowerShell. This hunting query depends on MicrosoftThreatProtection data connector (DeviceLogonEvents DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery37",
            "type": "Microsoft.Common.Section",
            "label": "Local Admin Group Changes",
            "elements": [
              {
                "name": "huntingquery37-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This hunting query searches for changes to the local administrators group. This hunting query depends on MicrosoftThreatProtection data connector (IdentityInfo DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery38",
            "type": "Microsoft.Common.Section",
            "label": "Scheduled Task Creation",
            "elements": [
              {
                "name": "huntingquery38-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for any scheduled task creation event. This hunting query depends on MicrosoftThreatProtection data connector (DeviceEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery39",
            "type": "Microsoft.Common.Section",
            "label": "Check for multiple signs of Ransomware Activity",
            "elements": [
              {
                "name": "huntingquery39-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for multiple signs of ransomware activity to identify affected devices. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery40",
            "type": "Microsoft.Common.Section",
            "label": "Suspicious Image Load related to IcedId",
            "elements": [
              {
                "name": "huntingquery40-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for suspicious load image events by rundll32.exe or regsvr32.exe, a behavior associated with IcedId, which can lead to IcedId ransomware. This hunting query depends on MicrosoftThreatProtection data connector (DeviceImageLoadEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery41",
            "type": "Microsoft.Common.Section",
            "label": "Clearing of forensic evidence from event logs using wevtutil",
            "elements": [
              {
                "name": "huntingquery41-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to clear at least 10 log entries from event logs using wevtutil. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery42",
            "type": "Microsoft.Common.Section",
            "label": "Stopping multiple processes using taskkill",
            "elements": [
              {
                "name": "huntingquery42-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to stop at least 10 separate processes using the taskkill.exe utility. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery43",
            "type": "Microsoft.Common.Section",
            "label": "Potential Ransomware activity related to Cobalt Strike",
            "elements": [
              {
                "name": "huntingquery43-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for alerts related to suspected ransomware and Cobalt Strike activity, a tool used in numerous ransomware campaigns. This hunting query depends on MicrosoftThreatProtection data connector (AlertInfo AlertEvidence DeviceLogonEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery44",
            "type": "Microsoft.Common.Section",
            "label": "Qakbot Discovery Activies",
            "elements": [
              {
                "name": "huntingquery44-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for injected processes launching discovery activity. Qakbot has been observed leading to ransomware in numerous instances. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery45",
            "type": "Microsoft.Common.Section",
            "label": "Shadow Copy Deletions",
            "elements": [
              {
                "name": "huntingquery45-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This rule detects when Shadow Copies are being deleted. This is a know actions that is performed by threat actors. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery46",
            "type": "Microsoft.Common.Section",
            "label": "Turning off services using sc exe",
            "elements": [
              {
                "name": "huntingquery46-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to turn off at least 10 existing services using sc.exe. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery47",
            "type": "Microsoft.Common.Section",
            "label": "Detect CISA Alert (AA22-117A) 2021 Top Routinely Exploited Vulnerabilities",
            "elements": [
              {
                "name": "huntingquery47-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This advanced hunting query detects CISA Alert (AA22-117A) 2021 Top Routinely Exploited Vulnerabilities https://www.cisa.gov/uscert/ncas/alerts/aa22-117a This hunting query depends on MicrosoftThreatProtection data connector (DeviceTvmSoftwareVulnerabilitiesKB Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery48",
            "type": "Microsoft.Common.Section",
            "label": "Dropping Payload via certutil",
            "elements": [
              {
                "name": "huntingquery48-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "BazaCall campaign tricks users into calling a fake customer support center, and download a malicious Excel file which contains a macro to infect users' device with BazaLoader. This query searches for a copy of certutil.exe used by the macro. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery49",
            "type": "Microsoft.Common.Section",
            "label": "Imminent Ransomware",
            "elements": [
              {
                "name": "huntingquery49-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Before deploying Macaw ransomware in an organization, the attacker will run several commands designed to disable security tools and system recovery tools. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery50",
            "type": "Microsoft.Common.Section",
            "label": "Robbinhood Driver",
            "elements": [
              {
                "name": "huntingquery50-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query detects the presence of the Robbinhood ransomware driver. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery51",
            "type": "Microsoft.Common.Section",
            "label": "Snip3 Malicious Network Connectivity",
            "elements": [
              {
                "name": "huntingquery51-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This hunting query looks for potentially hollowed processes that may be used to facilitate command-and-control or exfiltration by Snip3 malware. This hunting query depends on MicrosoftThreatProtection data connector (DeviceNetworkEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery52",
            "type": "Microsoft.Common.Section",
            "label": "Java Executing cmd to run Powershell",
            "elements": [
              {
                "name": "huntingquery52-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query finds instances of the Java process being used to execute cmd.exe, and download and execute a PowerShell script. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery53",
            "type": "Microsoft.Common.Section",
            "label": "Clear System Logs",
            "elements": [
              {
                "name": "huntingquery53-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This hunting query searches for attempts to use fsutil.exe to clear system logs and delete forensic artifacts. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery54",
            "type": "Microsoft.Common.Section",
            "label": "Regsvr32 Rundll32 Image Loads Abnormal Extension",
            "elements": [
              {
                "name": "huntingquery54-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query is looking for regsvr32.exe or rundll32.exe loading DLL images with other extensions than .dll. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents DeviceNetworkEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery55",
            "type": "Microsoft.Common.Section",
            "label": "Regsvr32 Rundll32 with Anomalous Parent Process",
            "elements": [
              {
                "name": "huntingquery55-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query searches for rundll32.exe or regsvr32.exe being spawned by abnormal processes such as wscript.exe, powershell.exe, cmd.exe, pwsh.exe, cscript.exe. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents DeviceNetworkEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery56",
            "type": "Microsoft.Common.Section",
            "label": "Enumeration of Users & Groups for Lateral Movement",
            "elements": [
              {
                "name": "huntingquery56-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query hunts for attempts to list users or groups using Net commands, which are commonly used for lateral movement. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery57",
            "type": "Microsoft.Common.Section",
            "label": "Detect Potential kerberoast Activities",
            "elements": [
              {
                "name": "huntingquery57-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query aim to detect if someone requests service tickets (where count => maxcount). The query requires trimming to set a baseline level for MaxCount. This hunting query depends on MicrosoftThreatProtection data connector (IdentityLogonEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery58",
            "type": "Microsoft.Common.Section",
            "label": "Webserver Executing Suspicious Applications",
            "elements": [
              {
                "name": "huntingquery58-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for common webserver process names and identifies any processes launched using a scripting language (cmd, powershell, wscript, cscript). This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery59",
            "type": "Microsoft.Common.Section",
            "label": "Windows Print Spooler Service Suspicious File Creation",
            "elements": [
              {
                "name": "huntingquery59-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The query digs in Windows print spooler drivers folder for any file creations. This behavior is used from PoC Exploit of CVE-2021-34527, CVE-2021-1675 or CVE-2022-21999. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery60",
            "type": "Microsoft.Common.Section",
            "label": "Spoolsv Spawning Rundll32",
            "elements": [
              {
                "name": "huntingquery60-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Look for the spoolsv.exe launching rundll32.exe with an empty command line. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery61",
            "type": "Microsoft.Common.Section",
            "label": "MITRE - Suspicious Events",
            "elements": [
              {
                "name": "huntingquery61-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This hunting query looks for several different MITRE techniques, grouped by risk level. A weighting is applied to each risk level and a total score calculated per machine. Techniques can be added/removed as required. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery62",
            "type": "Microsoft.Common.Section",
            "label": "Remote File Creation with PsExec",
            "elements": [
              {
                "name": "huntingquery62-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query detects remote file creation events that might indicate an active attack using PsExec. This hunting query depends on MicrosoftThreatProtection data connector (DeviceFileEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery63",
            "type": "Microsoft.Common.Section",
            "label": "Account Creation",
            "elements": [
              {
                "name": "huntingquery63-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for the creation of user accounts on a machine using the \"net user\" command. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery64",
            "type": "Microsoft.Common.Section",
            "label": "Rare Process as a Service",
            "elements": [
              {
                "name": "huntingquery64-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query looks for rarely seen processes which are launched as a service. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents DeviceNetworkEvents DeviceFileEvents DeviceImageLoadEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery65",
            "type": "Microsoft.Common.Section",
            "label": "SAM Name Change CVE-2021-42278",
            "elements": [
              {
                "name": "huntingquery65-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The following query detects possible CVE-2021-42278 exploitation by finding changes of device names in the network using Microsoft Defender for Identity. This hunting query depends on MicrosoftThreatProtection data connector (IdentityDirectoryEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery66",
            "type": "Microsoft.Common.Section",
            "label": "Disabling Services via Registry",
            "elements": [
              {
                "name": "huntingquery66-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Search for processes modifying the registry to disable security features. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery67",
            "type": "Microsoft.Common.Section",
            "label": "DLLHost.exe WMIC domain discovery",
            "elements": [
              {
                "name": "huntingquery67-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for dllhost.exe calling WMIC to discover additional hosts and associated domain. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery68",
            "type": "Microsoft.Common.Section",
            "label": "PowerShell adding exclusion path for Microsoft Defender of ProgramData",
            "elements": [
              {
                "name": "huntingquery68-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Identify PowerShell creating an exclusion path of ProgramData directory for Microsoft Defender to not monitor. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery69",
            "type": "Microsoft.Common.Section",
            "label": "Deletion of data on multiple drives using cipher exe",
            "elements": [
              {
                "name": "huntingquery69-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query checks for attempts to delete data on multiple drives using cipher.exe. This activity is typically done by ransomware to prevent recovery of data after encryption. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery70",
            "type": "Microsoft.Common.Section",
            "label": "LaZagne Credential Theft",
            "elements": [
              {
                "name": "huntingquery70-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query can be used to locate processes executing credential theft activity, often LaZagne in ransomware compromises. This hunting query depends on MicrosoftThreatProtection data connector (DeviceProcessEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery71",
            "type": "Microsoft.Common.Section",
            "label": "ATP policy status check",
            "elements": [
              {
                "name": "huntingquery71-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query displays the configuration auditing for 'Safe Attachments for SharePoint, OneDrive, and Microsoft Teams' and 'Safe Documents' in Microsoft Defender for Office 365. This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery72",
            "type": "Microsoft.Common.Section",
            "label": "JNLP-File-Attachment",
            "elements": [
              {
                "name": "huntingquery72-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "JNLP file extensions are an uncommon file type often used to deliver malware. This hunting query depends on MicrosoftThreatProtection data connector (EmailAttachmentInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery73",
            "type": "Microsoft.Common.Section",
            "label": "Safe Attachments detections",
            "elements": [
              {
                "name": "huntingquery73-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query provides insights on the detections done by Safe Attachment detections This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery74",
            "type": "Microsoft.Common.Section",
            "label": "Authentication failures by time and authentication type",
            "elements": [
              {
                "name": "huntingquery74-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing authentication failure count by authentication type. Update the authentication type below as DMARC, DKIM, SPM, CompAuth This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery75",
            "type": "Microsoft.Common.Section",
            "label": "Spoof attempts with auth failure",
            "elements": [
              {
                "name": "huntingquery75-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in checking for spoofing attempts on the domain with Authentication failures This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery76",
            "type": "Microsoft.Common.Section",
            "label": "Audit Email Preview-Download action",
            "elements": [
              {
                "name": "huntingquery76-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps report on who Previewed/Downloaded email messages using the Email entity page in Defender for Office 365 This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery77",
            "type": "Microsoft.Common.Section",
            "label": "Hunt for TABL changes",
            "elements": [
              {
                "name": "huntingquery77-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for Tenant allow/block list (TABL) changes in Defender for Office 365 This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery78",
            "type": "Microsoft.Common.Section",
            "label": "Local time to UTC time conversion",
            "elements": [
              {
                "name": "huntingquery78-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Advanced Hunting has default timezone as UTC time. Filters in Advanced Hunting also work in UTC by default whereas query results are shown in local time if user has selected local time zone in security center settings. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery79",
            "type": "Microsoft.Common.Section",
            "label": "MDO daily detection summary report",
            "elements": [
              {
                "name": "huntingquery79-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps report daily on total number of emails, total number of emails detected aby Defender for Office 365 This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents AlertEvidence EmailEvents EmailPostDeliveryEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery80",
            "type": "Microsoft.Common.Section",
            "label": "Mail item accessed",
            "elements": [
              {
                "name": "huntingquery80-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing emails accessed by end users using cloud app events data This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery81",
            "type": "Microsoft.Common.Section",
            "label": "Malicious email senders",
            "elements": [
              {
                "name": "huntingquery81-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for emails from a sender with at least one email in quarantine This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery82",
            "type": "Microsoft.Common.Section",
            "label": "New TABL Items",
            "elements": [
              {
                "name": "huntingquery82-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps identifying when new items being added to the Tenant/Allow Block List (TABL) in Defender for Office 365. This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery83",
            "type": "Microsoft.Common.Section",
            "label": "Emails containing links to IP addresses",
            "elements": [
              {
                "name": "huntingquery83-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for Emails containing links to IP addresses This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery84",
            "type": "Microsoft.Common.Section",
            "label": "Good emails from senders with bad patterns",
            "elements": [
              {
                "name": "huntingquery84-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for good emails from senders with bad patterns This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery85",
            "type": "Microsoft.Common.Section",
            "label": "Hunt for email conversation take over attempts",
            "elements": [
              {
                "name": "huntingquery85-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for email conversation take over attempts This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery86",
            "type": "Microsoft.Common.Section",
            "label": "Hunt for malicious URLs using external IOC source",
            "elements": [
              {
                "name": "huntingquery86-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunt for emails with malicious URLs based on external IOC source This hunting query depends on MicrosoftThreatProtection data connector (EmailUrlInfo EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery87",
            "type": "Microsoft.Common.Section",
            "label": "Hunt for malicious attachments using external IOC source",
            "elements": [
              {
                "name": "huntingquery87-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunt for emails with malicious attachments based on SH256 hash from external IOC source This hunting query depends on MicrosoftThreatProtection data connector (EmailAttachmentInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery88",
            "type": "Microsoft.Common.Section",
            "label": "Inbox rule changes which forward-redirect email",
            "elements": [
              {
                "name": "huntingquery88-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for Inbox rule changes which forward-redirect email This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery89",
            "type": "Microsoft.Common.Section",
            "label": "MDO_CountOfRecipientsEmailaddressbySubject",
            "elements": [
              {
                "name": "huntingquery89-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Count of recipient's email addresses by subject This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery90",
            "type": "Microsoft.Common.Section",
            "label": "MDO_CountOfSendersEmailaddressbySubject",
            "elements": [
              {
                "name": "huntingquery90-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Count of sender's email addresses by subject This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery91",
            "type": "Microsoft.Common.Section",
            "label": "MDO_Countofrecipientsemailaddressesbysubject",
            "elements": [
              {
                "name": "huntingquery91-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Count of recipient's email addresses by subject This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery92",
            "type": "Microsoft.Common.Section",
            "label": "MDO_SummaryOfSenders",
            "elements": [
              {
                "name": "huntingquery92-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Count of all Senders and where they were delivered This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery93",
            "type": "Microsoft.Common.Section",
            "label": "MDO_URLClickedinEmail",
            "elements": [
              {
                "name": "huntingquery93-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "URLs clicked in Email This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery94",
            "type": "Microsoft.Common.Section",
            "label": "Detections by detection methods",
            "elements": [
              {
                "name": "huntingquery94-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing malicious email detections by detection methods This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery95",
            "type": "Microsoft.Common.Section",
            "label": "Mail reply to new domain",
            "elements": [
              {
                "name": "huntingquery95-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing mail that is likely a reply but there is no history of the people chatting and the domain is new This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery96",
            "type": "Microsoft.Common.Section",
            "label": "Mailflow by directionality",
            "elements": [
              {
                "name": "huntingquery96-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing inbound / outbound / intra-org emails by domain per day This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery97",
            "type": "Microsoft.Common.Section",
            "label": "Malicious emails detected per day",
            "elements": [
              {
                "name": "huntingquery97-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing Malware, Phishing, Spam emails caught per day This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery98",
            "type": "Microsoft.Common.Section",
            "label": "Sender recipient contact establishment",
            "elements": [
              {
                "name": "huntingquery98-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in checking the sender-recipient contact establishment status This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery99",
            "type": "Microsoft.Common.Section",
            "label": "Top 100 malicious email senders",
            "elements": [
              {
                "name": "huntingquery99-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing top 100 malicious senders This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery100",
            "type": "Microsoft.Common.Section",
            "label": "Top 100 senders",
            "elements": [
              {
                "name": "huntingquery100-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing top 100 senders in your organization in last 30 days This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery101",
            "type": "Microsoft.Common.Section",
            "label": "Zero day threats",
            "elements": [
              {
                "name": "huntingquery101-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing zero day threats via URL and file detonations This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery102",
            "type": "Microsoft.Common.Section",
            "label": "Email containing malware accessed on a unmanaged device",
            "elements": [
              {
                "name": "huntingquery102-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we are looking for emails containing malware accessed on a unmanaged device This hunting query depends on MicrosoftThreatProtection data connector (EmailPostDeliveryEvents CloudAppEvents AADSignInEventsBeta Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery103",
            "type": "Microsoft.Common.Section",
            "label": "Email containing malware sent by an internal sender",
            "elements": [
              {
                "name": "huntingquery103-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we are looking for emails containing malware attachment sent by an internal sender This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery104",
            "type": "Microsoft.Common.Section",
            "label": "Email malware detection report",
            "elements": [
              {
                "name": "huntingquery104-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing email malware detection cases This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailAttachmentInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery105",
            "type": "Microsoft.Common.Section",
            "label": "Malware detections by detection methods",
            "elements": [
              {
                "name": "huntingquery105-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing malware detections by detection methods This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery106",
            "type": "Microsoft.Common.Section",
            "label": "Admin overrides",
            "elements": [
              {
                "name": "huntingquery106-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in reviewing malicious emails allowed due to admin overrides This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery107",
            "type": "Microsoft.Common.Section",
            "label": "Top policies performing admin overrides",
            "elements": [
              {
                "name": "huntingquery107-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in reviewing top policies for admin overrides (Allow/Block) This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery108",
            "type": "Microsoft.Common.Section",
            "label": "Top policies performing user overrides",
            "elements": [
              {
                "name": "huntingquery108-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in reviewing top policies for user overrides (Allow/Block) This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery109",
            "type": "Microsoft.Common.Section",
            "label": "User overrides",
            "elements": [
              {
                "name": "huntingquery109-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in reviewing malicious emails allowed due to user overrides This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery110",
            "type": "Microsoft.Common.Section",
            "label": "Appspot Phishing Abuse",
            "elements": [
              {
                "name": "huntingquery110-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps surface phishing campaigns associated with Appspot abuse. This hunting query depends on MicrosoftThreatProtection data connector (EmailUrlInfo EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery111",
            "type": "Microsoft.Common.Section",
            "label": "Phish detections by detection methods",
            "elements": [
              {
                "name": "huntingquery111-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing Phish detections done by some of the most frequent detection technologies in the last 7 days This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery112",
            "type": "Microsoft.Common.Section",
            "label": "Campaign with randomly named attachments",
            "elements": [
              {
                "name": "huntingquery112-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection,we hunt for emails with randomly named attachment names from the same sender to multiple recipients This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery113",
            "type": "Microsoft.Common.Section",
            "label": "Campaign with suspicious keywords",
            "elements": [
              {
                "name": "huntingquery113-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection, we track emails with suspicious keywords in subjects. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery114",
            "type": "Microsoft.Common.Section",
            "label": "Custom detection-Emails with QR from non-prevalent senders",
            "elements": [
              {
                "name": "huntingquery114-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection, we check the sender prevalence over the last 14 days and use the same to detect malicious activity via email containing QR code This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery115",
            "type": "Microsoft.Common.Section",
            "label": "Emails delivered having URLs from QR codes",
            "elements": [
              {
                "name": "huntingquery115-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we hunt for inbound emails delivered having URLs from QR codes This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery116",
            "type": "Microsoft.Common.Section",
            "label": "Emails with QR codes and suspicious keywords in subject",
            "elements": [
              {
                "name": "huntingquery116-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we hunt for inbound emails having URLs from QR codes and suspicious keywords in subject This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery117",
            "type": "Microsoft.Common.Section",
            "label": "Emails with QR codes from non-prevalent sender",
            "elements": [
              {
                "name": "huntingquery117-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we hunt for inbound emails having URLs from QR codes and send by non-prevalent senders This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery118",
            "type": "Microsoft.Common.Section",
            "label": "Hunting for sender patterns",
            "elements": [
              {
                "name": "huntingquery118-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection approach, we correlate email from non-prevalent senders in the organization with impersonation intents This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailAttachmentInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery119",
            "type": "Microsoft.Common.Section",
            "label": "Hunting for user signals-clusters",
            "elements": [
              {
                "name": "huntingquery119-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection,we use Email reported by user as malware or phish MDO alert as a starting point to identify the scope of a campaign. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery120",
            "type": "Microsoft.Common.Section",
            "label": "Inbound emails with QR code URLs",
            "elements": [
              {
                "name": "huntingquery120-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we summarize volume of inbound emails with QR code URLs in last 30 days This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery121",
            "type": "Microsoft.Common.Section",
            "label": "Personalized campaigns based on the first few keywords",
            "elements": [
              {
                "name": "huntingquery121-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection, we track emails with personalized subjects. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery122",
            "type": "Microsoft.Common.Section",
            "label": "Personalized campaigns based on the last few keywords",
            "elements": [
              {
                "name": "huntingquery122-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection, we track emails with personalized subjects. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery123",
            "type": "Microsoft.Common.Section",
            "label": "Risky sign-in attempt from a non-managed device",
            "elements": [
              {
                "name": "huntingquery123-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this detection,we hunt for any sign-in attempt from a non-managed, non-compliant, untrusted device. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery124",
            "type": "Microsoft.Common.Section",
            "label": "Suspicious sign-in attempts from QR code phishing campaigns",
            "elements": [
              {
                "name": "huntingquery124-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This detection approach correlates a user accessing an email with image/document attachments and a risky sign-in attempt from non-trusted devices. This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents AADSignInEventsBeta Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery125",
            "type": "Microsoft.Common.Section",
            "label": "Group quarantine release",
            "elements": [
              {
                "name": "huntingquery125-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in reviewing group Quarantine released messages by detection type. Useful to see what is leading to the largest number of messages being released. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery126",
            "type": "Microsoft.Common.Section",
            "label": "High Confidence Phish Released",
            "elements": [
              {
                "name": "huntingquery126-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query shows information about high confidence phish email that has been released from the Quarantine. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery127",
            "type": "Microsoft.Common.Section",
            "label": "Quarantine Release Email Details",
            "elements": [
              {
                "name": "huntingquery127-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query shows information about email that has been released from the Quarantine in Defender for Office 365. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery128",
            "type": "Microsoft.Common.Section",
            "label": "Quarantine release trend",
            "elements": [
              {
                "name": "huntingquery128-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing quarantine release trend in Defender for Office 365 This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery129",
            "type": "Microsoft.Common.Section",
            "label": "Listing Email Remediation Actions via Explorer",
            "elements": [
              {
                "name": "huntingquery129-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Listing Email Remediation Actions performed via Explorer in Defender for Office 365 This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery130",
            "type": "Microsoft.Common.Section",
            "label": "Display Name - Spoof and Impersonation",
            "elements": [
              {
                "name": "huntingquery130-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing incoming email messages where the Display Name of the sender contains own or other partner company/brand name This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery131",
            "type": "Microsoft.Common.Section",
            "label": "referral-phish-emails",
            "elements": [
              {
                "name": "huntingquery131-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "Hunting for credential phishing using the \"Referral\" infrastructure using Defender for Office 365 data This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery132",
            "type": "Microsoft.Common.Section",
            "label": "Spoof and impersonation detections by sender IP",
            "elements": [
              {
                "name": "huntingquery132-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing count of spoof and impersonation detections done per sender IP This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery133",
            "type": "Microsoft.Common.Section",
            "label": "Spoof and impersonation phish detections",
            "elements": [
              {
                "name": "huntingquery133-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing count of phish detections done by spoof detection methods This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery134",
            "type": "Microsoft.Common.Section",
            "label": "User not covered under display name impersonation",
            "elements": [
              {
                "name": "huntingquery134-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps to find threats using display name impersonation for users not already protected with User Impersonation This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents IdentityInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery135",
            "type": "Microsoft.Common.Section",
            "label": "Admin reported submissions",
            "elements": [
              {
                "name": "huntingquery135-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing admin reported email submissions This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery136",
            "type": "Microsoft.Common.Section",
            "label": "Status of submissions",
            "elements": [
              {
                "name": "huntingquery136-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing status of submissions This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery137",
            "type": "Microsoft.Common.Section",
            "label": "Top submitters of admin submissions",
            "elements": [
              {
                "name": "huntingquery137-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing top submitters of admin submissions This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery138",
            "type": "Microsoft.Common.Section",
            "label": "Top submitters of user submissions",
            "elements": [
              {
                "name": "huntingquery138-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing top submitters of user submissions This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery139",
            "type": "Microsoft.Common.Section",
            "label": "User reported submissions",
            "elements": [
              {
                "name": "huntingquery139-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing user reported email submissions This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery140",
            "type": "Microsoft.Common.Section",
            "label": "Attacked more than x times average",
            "elements": [
              {
                "name": "huntingquery140-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing count of users attacked more than x times average. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery141",
            "type": "Microsoft.Common.Section",
            "label": "Malicious mails by sender IPs",
            "elements": [
              {
                "name": "huntingquery141-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing sender IPs sending malicious email of type Malware or Phish This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery142",
            "type": "Microsoft.Common.Section",
            "label": "Top 10 URL domains attacking organization",
            "elements": [
              {
                "name": "huntingquery142-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing list of top 10 URL domains attacking the organization This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery143",
            "type": "Microsoft.Common.Section",
            "label": "Top 10% of most attacked users",
            "elements": [
              {
                "name": "huntingquery143-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing the list of top 10% of most attacked users This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery144",
            "type": "Microsoft.Common.Section",
            "label": "Top external malicious senders",
            "elements": [
              {
                "name": "huntingquery144-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing external top malicious email sender with malware or phishing emails in an organization in last 30 days This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery145",
            "type": "Microsoft.Common.Section",
            "label": "Top targeted users",
            "elements": [
              {
                "name": "huntingquery145-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing top targeted users with malware or phishing emails in an organization in last 30 days This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery146",
            "type": "Microsoft.Common.Section",
            "label": "End user malicious clicks",
            "elements": [
              {
                "name": "huntingquery146-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing list of top users click on Phis URLs This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery147",
            "type": "Microsoft.Common.Section",
            "label": "URL click count by click action",
            "elements": [
              {
                "name": "huntingquery147-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing URL click count by ClickAction This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery148",
            "type": "Microsoft.Common.Section",
            "label": "URL click on ZAP email",
            "elements": [
              {
                "name": "huntingquery148-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we are looking for Url clicks on emails which get actioned by Zerohour auto purge This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Alertinfo AlertEvidence Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery149",
            "type": "Microsoft.Common.Section",
            "label": "URL clicks actions by URL",
            "elements": [
              {
                "name": "huntingquery149-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we are looking URL click actions by URL in the last 7 days This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery150",
            "type": "Microsoft.Common.Section",
            "label": "URLClick details based on malicious URL click alert",
            "elements": [
              {
                "name": "huntingquery150-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "In this query, we are looking for Url clicks on emails which are generated the alert-A potentially malicious URL click was detected This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Alertinfo AlertEvidence Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery151",
            "type": "Microsoft.Common.Section",
            "label": "User clicked through events",
            "elements": [
              {
                "name": "huntingquery151-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing malicious clicks where user was allowed to proceed through malicious URL page. This hunting query depends on MicrosoftThreatProtection data connector (UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery152",
            "type": "Microsoft.Common.Section",
            "label": "User clicks on malicious inbound emails",
            "elements": [
              {
                "name": "huntingquery152-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query provides insights on users who clicked on a suspicious URL This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery153",
            "type": "Microsoft.Common.Section",
            "label": "User clicks on phishing URLs in emails",
            "elements": [
              {
                "name": "huntingquery153-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps in determining clickthroughs when email delivered because of detection overrides. This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents UrlClickEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery154",
            "type": "Microsoft.Common.Section",
            "label": "PhishingEmailUrlRedirector (1)",
            "elements": [
              {
                "name": "huntingquery154-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "The query helps detect emails associated with the open redirector URL campaign using Defender for Office 365 data. This hunting query depends on MicrosoftThreatProtection data connector (EmailUrlInfo Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery155",
            "type": "Microsoft.Common.Section",
            "label": "SafeLinks URL detections",
            "elements": [
              {
                "name": "huntingquery155-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query provides insights on the detections done by SafeLinks protection in Defender for Office 365 This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery156",
            "type": "Microsoft.Common.Section",
            "label": "Total ZAP count",
            "elements": [
              {
                "name": "huntingquery156-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps reviewing count of total ZAP events This hunting query depends on MicrosoftThreatProtection data connector (EmailPostDeliveryEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery157",
            "type": "Microsoft.Common.Section",
            "label": "Automated email notifications and suspicious sign-in activity",
            "elements": [
              {
                "name": "huntingquery157-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for Automated email notifications and suspicious sign-in activity This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents AADSignInEventsBeta Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery158",
            "type": "Microsoft.Common.Section",
            "label": "Files share contents and suspicious sign-in activity",
            "elements": [
              {
                "name": "huntingquery158-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for Files share contents and suspicious sign-in activity This hunting query depends on MicrosoftThreatProtection data connector (EmailEvents AADSignInEventsBeta Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery159",
            "type": "Microsoft.Common.Section",
            "label": "BEC - File sharing tactics - OneDrive or SharePoint",
            "elements": [
              {
                "name": "huntingquery159-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for BEC - File sharing tactics - OneDrive or SharePoint This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          },
          {
            "name": "huntingquery160",
            "type": "Microsoft.Common.Section",
            "label": "BEC - File sharing tactics - Dropbox",
            "elements": [
              {
                "name": "huntingquery160-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": "This query helps hunting for BEC - File sharing tactics - Dropbox This hunting query depends on MicrosoftThreatProtection data connector (CloudAppEvents Parser or Table)"
                }
              }
            ]
          }
        ]
      }
    ],
    "outputs": {
      "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
      "location": "[location()]",
      "workspace": "[basics('workspace')]"
    }
  }
}
