id: 7457a420-8c28-4ce2-a55e-d050e5a6bc4f
name: Privileged Machines Exposed to the Internet
description: |
  'detects AWS instances which are exposed to the internet and can assume privileged roles. This is a default definition by Authomize and can be updated using the edit model.'
requiredDataConnectors:
  - connectorId: Authomize
    dataTypes:
      - Authomize_v2_CL
tactics:
  - Discovery
relevantTechniques:
  - T1613
query: |
  union withsource=_TableName Authomize_v2_CL
  | extend EventID = id_s
  | extend Policy = policy_name_s
  | extend Severity = severity_s
  | extend Description = description_s
  | extend Recommendation = recommendation_s
  | extend URL = url_s
  | extend Tactics = tactics_s
  | where Policy contains "Privileged Machines Exposed to the Internet"
  | project EventID, Policy, Severity, Description, Recommendation, URL, Category, Tactics
  | extend CloudApplication_0_Name = Policy
entityMappings:
  - entityType: CloudApplication
    fieldMappings:
      - identifier: Name
        columnName: Policy
version: 1.0.0
metadata:
    source:
        kind: Authomize
    author:
        name: Steven Riley
    support:
        tier: support@authomize.com