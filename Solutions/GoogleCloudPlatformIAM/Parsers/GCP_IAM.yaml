id: 0a77da75-0ce2-4d55-8d7d-b26e2b3d9f9a
Function:
  Title: Parser for GCP_IAM
  Version: '1.0.0'
  LastUpdated: '2025-02-10'
Category: Microsoft Sentinel Parser
FunctionName: GCP_IAM
FunctionAlias: GCP_IAM
FunctionQuery: |
    let GCPIam_view  = view () {
    let IamQuery_GcpIam_empty = datatable(
           ResourceLabelsTopicId_e:string,
           ResourceLabelsRoleName_e:string,
           LogName_e:string,
           InsertId_e:string,
           ResourceType_e:string,
           ResourceLabelsEmailId_e:string,
           ResourceLabelsProjectId_e:string,
           ResourceLabelsUniqueId_e:string,
           PayloadType_e:string,
           ResourceLabelsLocation_e:string,
           ResourceLabelsMethod_e:string,
    )[];
    let IamQuery_GcpIam = union isfuzzy=true GCP_IAM_CL, IamQuery_GcpIam_empty 
       | extend 
           ResourceLabelsTopicId_e=column_ifexists('resource_labels_topic_id_s', ''),
           ResourceLabelsRoleName_e=column_ifexists('resource_labels_role_name_s', ''),
           LogName_e=column_ifexists('log_name_s', ''),
           InsertId_e=column_ifexists('insert_id_s', ''),
           ResourceType_e=column_ifexists('resource_type_s', ''),
           ResourceLabelsEmailId_e=column_ifexists('resource_labels_email_id_s', ''),
           ResourceLabelsProjectId_e=column_ifexists('resource_labels_project_id_s', ''),
           ResourceLabelsUniqueId_e=column_ifexists('resource_labels_unique_id_s', ''),
           PayloadType_e=column_ifexists('payload__type_s', ''),
           ResourceLabelsLocation_e=column_ifexists('resource_labels_location_s', ''),
           ResourceLabelsMethod_e=column_ifexists('resource_labels_method_s', ''),
       | project-rename
           ResourceLabelsTopicId=ResourceLabelsTopicId_e,
           ResourceLabelsRoleName=ResourceLabelsRoleName_e,
           LogName=LogName_e,
           InsertId=InsertId_e,
           ResourceType=ResourceType_e,
           ResourceLabelsEmailId=ResourceLabelsEmailId_e,
           ResourceLabelsProjectId=ResourceLabelsProjectId_e,
           ResourceLabelsUniqueId=ResourceLabelsUniqueId_e,
           PayloadType=PayloadType_e,
           ResourceLabelsLocation=ResourceLabelsLocation_e,
           ResourceLabelsMethod=ResourceLabelsMethod_e,
    let IamQuery_GcpIamV2 = union isfuzzy=true GCP_IAMV2_CL, IamQuery_GcpIam_empty 
       | extend 
           ResourceLabelsTopicId_e=column_ifexists('ResourceLabelsTopicId', ''),
           ResourceLabelsRoleName_e=column_ifexists('ResourceLabelsRoleName', ''),
           LogName_e=column_ifexists('LogName', ''),
           InsertId_e=column_ifexists('InsertId', ''),
           ResourceType_e=column_ifexists('ResourceType', ''),
           ResourceLabelsEmailId_e=column_ifexists('ResourceLabelsEmailId', ''),
           ResourceLabelsProjectId_e=column_ifexists('ResourceLabelsProjectId', ''),
           ResourceLabelsUniqueId_e=column_ifexists('ResourceLabelsUniqueId', ''),
           PayloadType_e=column_ifexists('PayloadType', ''),
           ResourceLabelsLocation_e=column_ifexists('ResourceLabelsLocation', ''),
           ResourceLabelsMethod_e=column_ifexists('ResourceLabelsMethod', ''),
       | project-rename
           ResourceLabelsTopicId=ResourceLabelsTopicId_e,
           ResourceLabelsRoleName=ResourceLabelsRoleName_e,
           LogName=LogName_e,
           InsertId=InsertId_e,
           ResourceType=ResourceType_e,
           ResourceLabelsEmailId=ResourceLabelsEmailId_e,
           ResourceLabelsProjectId=ResourceLabelsProjectId_e,
           ResourceLabelsUniqueId=ResourceLabelsUniqueId_e,
           PayloadType=PayloadType_e,
           ResourceLabelsLocation=ResourceLabelsLocation_e,
           ResourceLabelsMethod=ResourceLabelsMethod_e,
           union isfuzzy=true IamQuery_GcpIam, IamQuery_GcpIamV2     
           | project-reorder PayloadStatusCode,PayloadStatusMessage,PayloadRequestKeyTypes,PayloadServicedataPermissiondeltaRemovedpermissions,PayloadRequestUpdateMaskPaths,ResourceLabelsTopicId,PayloadServicedataPolicydeltaBindingdeltas,PayloadRequestPolicyAuditconfigs,PayloadRequestPolicyEtag,PayloadRequestPolicyBindings,PayloadRequestResource,PayloadResponseBindings,PayloadResponseAuditconfigs,PayloadRequestPageSize,PayloadRequestRemoveDeletedServiceAccounts,PayloadRequestView,PayloadRequestParent,PayloadRequestShowDeleted,ResourceLabelsRoleName,PayloadServicedataType,PayloadServicedataPermissiondeltaAddedpermissions,PayloadRequestRoleIncludedPermissions,PayloadRequestRoleTitle,PayloadRequestRoleDescription,PayloadRequestRoleId,PayloadResponseGroupName,PayloadResponseIncludedPermissions,PayloadResponseTitle,PayloadResponseGroupTitle,LogName,InsertId,EventSeverity,EventEndTime,ResourceType,ResourceLabelsEmailId,ResourceLabelsProjectId,ResourceLabelsUniqueId,PayloadType,PayloadAuthenticationinfoPrincipalemail,PayloadAuthenticationinfoPrincipalsubject,SrcIpAddr,HttpUserAgentOriginal,PayloadRequestmetadataRequestattributesTime,PayloadServicename,PayloadMethodname,PayloadAuthorizationinfo,PayloadResourcename,PayloadRequestType,PayloadRequestName,PayloadRequestAccountId,PayloadRequestServiceAccountDescription,PayloadRequestServiceAccountDisplayName,PayloadResponseOauth2ClientId,PayloadResponseName,PayloadResponseEtag,PayloadResponseUniqueId,PayloadResponseDescription,PayloadResponseProjectId,PayloadResponseDisplayName,PayloadResponseType,PayloadResponseEmail,PayloadRequestPrivateKeyType,PayloadResponseValidBeforeTimeSeconds,PayloadResponseValidAfterTimeSeconds,PayloadResponseKeyType,PayloadResponseKeyOrigin,PayloadResponsePrivateKeyType,PayloadResponseKeyAlgorithm,ResourceLabelsService,ResourceLabelsVersion,ResourceLabelsLocation,ResourceLabelsMethod,PayloadRequestFullResourceName,PayloadRequestOptionsRequestedPolicyVersion,PayloadRequestSkipVisibilityCheck,PayloadRequestPageToken;
    };
    GCPIam_view