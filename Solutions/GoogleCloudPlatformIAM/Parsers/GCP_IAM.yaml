id: 0a77da75-0ce2-4d55-8d7d-b26e2b3d9f9a
Function:
  Title: Parser for GCP_IAM
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: GCP_IAM
FunctionAlias: GCP_IAM
FunctionQuery: |
    GCP_IAM_CL
    | extend
        payload_status_code_d=column_ifexists('payload_status_code_d', ''),
        payload_status_message_s=column_ifexists('payload_status_message_s', ''),
        payload_request_key_types_s=column_ifexists('payload_request_key_types_s', ''),
        payload_serviceData_permissionDelta_removedPermissions_s=column_ifexists('payload_serviceData_permissionDelta_removedPermissions_s', ''),
        payload_request_update_mask_paths_s=column_ifexists('payload_request_update_mask_paths_s', ''),
        resource_labels_topic_id_s=column_ifexists('resource_labels_topic_id_s', ''),
        payload_serviceData_policyDelta_bindingDeltas_s=column_ifexists('payload_serviceData_policyDelta_bindingDeltas_s', ''),
        payload_request_policy_auditConfigs_s=column_ifexists('payload_request_policy_auditConfigs_s', ''),
        payload_request_policy_etag_s=column_ifexists('payload_request_policy_etag_s', ''),
        payload_request_policy_bindings_s=column_ifexists('payload_request_policy_bindings_s', ''),
        payload_request_resource_s=column_ifexists('payload_request_resource_s', ''),
        payload_response_bindings_s=column_ifexists('payload_response_bindings_s', ''),
        payload_response_auditConfigs_s=column_ifexists('payload_response_auditConfigs_s', ''),
        payload_request_page_size_d=column_ifexists('payload_request_page_size_d', ''),
        payload_request_remove_deleted_service_accounts_b=column_ifexists('payload_request_remove_deleted_service_accounts_b', ''),
        payload_request_view_d=column_ifexists('payload_request_view_d', ''),
        payload_request_parent_s=column_ifexists('payload_request_parent_s', ''),
        payload_request_show_deleted_b=column_ifexists('payload_request_show_deleted_b', ''),
        resource_labels_role_name_s=column_ifexists('resource_labels_role_name_s', ''),
        payload_serviceData__type_s=column_ifexists('payload_serviceData__type_s', ''),
        payload_serviceData_permissionDelta_addedPermissions_s=column_ifexists('payload_serviceData_permissionDelta_addedPermissions_s', ''),
        payload_request_role_included_permissions_s=column_ifexists('payload_request_role_included_permissions_s', ''),
        payload_request_role_title_s=column_ifexists('payload_request_role_title_s', ''),
        payload_request_role_description_s=column_ifexists('payload_request_role_description_s', ''),
        payload_request_role_id_s=column_ifexists('payload_request_role_id_s', ''),
        payload_response_group_name_s=column_ifexists('payload_response_group_name_s', ''),
        payload_response_included_permissions_s=column_ifexists('payload_response_included_permissions_s', ''),
        payload_response_title_s=column_ifexists('payload_response_title_s', ''),
        payload_response_group_title_s=column_ifexists('payload_response_group_title_s', ''),
        log_name_s=column_ifexists('log_name_s', ''),
        insert_id_s=column_ifexists('insert_id_s', ''),
        severity_s=column_ifexists('severity_s', ''),
        timestamp_t=column_ifexists('timestamp_t', ''),
        resource_type_s=column_ifexists('resource_type_s', ''),
        resource_labels_email_id_s=column_ifexists('resource_labels_email_id_s', ''),
        resource_labels_project_id_s=column_ifexists('resource_labels_project_id_s', ''),
        resource_labels_unique_id_s=column_ifexists('resource_labels_unique_id_s', ''),
        payload__type_s=column_ifexists('payload__type_s', ''),
        payload_authenticationInfo_principalEmail_s=column_ifexists('payload_authenticationInfo_principalEmail_s', ''),
        payload_authenticationInfo_principalSubject_s=column_ifexists('payload_authenticationInfo_principalSubject_s', ''),
        payload_requestMetadata_callerIp_s=column_ifexists('payload_requestMetadata_callerIp_s', ''),
        payload_requestMetadata_callerSuppliedUserAgent_s=column_ifexists('payload_requestMetadata_callerSuppliedUserAgent_s', ''),
        payload_requestMetadata_requestAttributes_time_s=column_ifexists('payload_requestMetadata_requestAttributes_time_s', ''),
        payload_serviceName_s=column_ifexists('payload_serviceName_s', ''),
        payload_methodName_s=column_ifexists('payload_methodName_s', ''),
        payload_authorizationInfo_s=column_ifexists('payload_authorizationInfo_s', ''),
        payload_resourceName_s=column_ifexists('payload_resourceName_s', ''),
        payload_request__type_s=column_ifexists('payload_request__type_s', ''),
        payload_request_name_s=column_ifexists('payload_request_name_s', ''),
        payload_request_account_id_s=column_ifexists('payload_request_account_id_s', ''),
        payload_request_service_account_description_s=column_ifexists('payload_request_service_account_description_s', ''),
        payload_request_service_account_display_name_s=column_ifexists('payload_request_service_account_display_name_s', ''),
        payload_response_oauth2_client_id_s=column_ifexists('payload_response_oauth2_client_id_s', ''),
        payload_response_name_s=column_ifexists('payload_response_name_s', ''),
        payload_response_etag_s=column_ifexists('payload_response_etag_s', ''),
        payload_response_unique_id_s=column_ifexists('payload_response_unique_id_s', ''),
        payload_response_description_s=column_ifexists('payload_response_description_s', ''),
        payload_response_project_id_s=column_ifexists('payload_response_project_id_s', ''),
        payload_response_display_name_s=column_ifexists('payload_response_display_name_s', ''),
        payload_response__type_s=column_ifexists('payload_response__type_s', ''),
        payload_response_email_s=column_ifexists('payload_response_email_s', ''),
        payload_request_private_key_type_d=column_ifexists('payload_request_private_key_type_d', ''),
        payload_response_valid_before_time_seconds_d=column_ifexists('payload_response_valid_before_time_seconds_d', ''),
        payload_response_valid_after_time_seconds_d=column_ifexists('payload_response_valid_after_time_seconds_d', ''),
        payload_response_key_type_d=column_ifexists('payload_response_key_type_d', ''),
        payload_response_key_origin_d=column_ifexists('payload_response_key_origin_d', ''),
        payload_response_private_key_type_d=column_ifexists('payload_response_private_key_type_d', ''),
        payload_response_key_algorithm_d=column_ifexists('payload_response_key_algorithm_d', ''),
        resource_labels_service_s=column_ifexists('resource_labels_service_s', ''),
        resource_labels_version_s=column_ifexists('resource_labels_version_s', ''),
        resource_labels_location_s=column_ifexists('resource_labels_location_s', ''),
        resource_labels_method_s=column_ifexists('resource_labels_method_s', ''),
        payload_request_full_resource_name_s=column_ifexists('payload_request_full_resource_name_s', ''),
        payload_request_options_requested_policy_version_d=column_ifexists('payload_request_options_requested_policy_version_d', ''),
        payload_request_skip_visibility_check_b=column_ifexists('payload_request_skip_visibility_check_b', ''),
        payload_request_page_token_s=column_ifexists('payload_request_page_token_s', '')
    | project-rename
        PayloadStatusCode=payload_status_code_d,
        PayloadStatusMessage=payload_status_message_s,
        PayloadRequestKeyTypes=payload_request_key_types_s,
        PayloadServicedataPermissiondeltaRemovedpermissions=payload_serviceData_permissionDelta_removedPermissions_s,
        PayloadRequestUpdateMaskPaths=payload_request_update_mask_paths_s,
        ResourceLabelsTopicId=resource_labels_topic_id_s,
        PayloadServicedataPolicydeltaBindingdeltas=payload_serviceData_policyDelta_bindingDeltas_s,
        PayloadRequestPolicyAuditconfigs=payload_request_policy_auditConfigs_s,
        PayloadRequestPolicyEtag=payload_request_policy_etag_s,
        PayloadRequestPolicyBindings=payload_request_policy_bindings_s,
        PayloadRequestResource=payload_request_resource_s,
        PayloadResponseBindings=payload_response_bindings_s,
        PayloadResponseAuditconfigs=payload_response_auditConfigs_s,
        PayloadRequestPageSize=payload_request_page_size_d,
        PayloadRequestRemoveDeletedServiceAccounts=payload_request_remove_deleted_service_accounts_b,
        PayloadRequestView=payload_request_view_d,
        PayloadRequestParent=payload_request_parent_s,
        PayloadRequestShowDeleted=payload_request_show_deleted_b,
        ResourceLabelsRoleName=resource_labels_role_name_s,
        PayloadServicedataType=payload_serviceData__type_s,
        PayloadServicedataPermissiondeltaAddedpermissions=payload_serviceData_permissionDelta_addedPermissions_s,
        PayloadRequestRoleIncludedPermissions=payload_request_role_included_permissions_s,
        PayloadRequestRoleTitle=payload_request_role_title_s,
        PayloadRequestRoleDescription=payload_request_role_description_s,
        PayloadRequestRoleId=payload_request_role_id_s,
        PayloadResponseGroupName=payload_response_group_name_s,
        PayloadResponseIncludedPermissions=payload_response_included_permissions_s,
        PayloadResponseTitle=payload_response_title_s,
        PayloadResponseGroupTitle=payload_response_group_title_s,
        LogName=log_name_s,
        InsertId=insert_id_s,
        EventSeverity=severity_s,
        EventEndTime=timestamp_t,
        ResourceType=resource_type_s,
        ResourceLabelsEmailId=resource_labels_email_id_s,
        ResourceLabelsProjectId=resource_labels_project_id_s,
        ResourceLabelsUniqueId=resource_labels_unique_id_s,
        PayloadType=payload__type_s,
        PayloadAuthenticationinfoPrincipalemail=payload_authenticationInfo_principalEmail_s,
        PayloadAuthenticationinfoPrincipalsubject=payload_authenticationInfo_principalSubject_s,
        SrcIpAddr=payload_requestMetadata_callerIp_s,
        HttpUserAgentOriginal=payload_requestMetadata_callerSuppliedUserAgent_s,
        PayloadRequestmetadataRequestattributesTime=payload_requestMetadata_requestAttributes_time_s,
        PayloadServicename=payload_serviceName_s,
        PayloadMethodname=payload_methodName_s,
        PayloadAuthorizationinfo=payload_authorizationInfo_s,
        PayloadResourcename=payload_resourceName_s,
        PayloadRequestType=payload_request__type_s,
        PayloadRequestName=payload_request_name_s,
        PayloadRequestAccountId=payload_request_account_id_s,
        PayloadRequestServiceAccountDescription=payload_request_service_account_description_s,
        PayloadRequestServiceAccountDisplayName=payload_request_service_account_display_name_s,
        PayloadResponseOauth2ClientId=payload_response_oauth2_client_id_s,
        PayloadResponseName=payload_response_name_s,
        PayloadResponseEtag=payload_response_etag_s,
        PayloadResponseUniqueId=payload_response_unique_id_s,
        PayloadResponseDescription=payload_response_description_s,
        PayloadResponseProjectId=payload_response_project_id_s,
        PayloadResponseDisplayName=payload_response_display_name_s,
        PayloadResponseType=payload_response__type_s,
        PayloadResponseEmail=payload_response_email_s,
        PayloadRequestPrivateKeyType=payload_request_private_key_type_d,
        PayloadResponseValidBeforeTimeSeconds=payload_response_valid_before_time_seconds_d,
        PayloadResponseValidAfterTimeSeconds=payload_response_valid_after_time_seconds_d,
        PayloadResponseKeyType=payload_response_key_type_d,
        PayloadResponseKeyOrigin=payload_response_key_origin_d,
        PayloadResponsePrivateKeyType=payload_response_private_key_type_d,
        PayloadResponseKeyAlgorithm=payload_response_key_algorithm_d,
        ResourceLabelsService=resource_labels_service_s,
        ResourceLabelsVersion=resource_labels_version_s,
        ResourceLabelsLocation=resource_labels_location_s,
        ResourceLabelsMethod=resource_labels_method_s,
        PayloadRequestFullResourceName=payload_request_full_resource_name_s,
        PayloadRequestOptionsRequestedPolicyVersion=payload_request_options_requested_policy_version_d,
        PayloadRequestSkipVisibilityCheck=payload_request_skip_visibility_check_b,
        PayloadRequestPageToken=payload_request_page_token_s