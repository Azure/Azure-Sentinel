id: db22f541-d2fe-4874-973b-7955e0a66e86
Function:
  Title: Parser for Bitglass
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: Bitglass
FunctionAlias: Bitglass
FunctionQuery: |
    let Bitglass_view  = view () { 
        BitglassLogs_CL
        | extend 
                    EventVendor="Bitglass",
                    SrcFileExtension=column_ifexists('docextension_s', ''),
                    DocType=column_ifexists('doctype_s', ''),
                    SrcFileSHA256=column_ifexists('docsha256_s', ''),
                    SrcFileSHA1=column_ifexists('docsha1_s', ''),
                    PolicyId=column_ifexists('policyid_s', ''),
                    ThreatId=column_ifexists('threatindicator_s', ''),
                    SrcFileMD5=column_ifexists('docmd5_s', ''),
                    Keyword=column_ifexists('keyword_s', ''),
                    HttpStatusCode=column_ifexists('responsecode_d', ''),
                    DvcId=column_ifexists('deviceguid_s', ''),
                    Owner=column_ifexists('owner_s', ''),
                    EventResult=column_ifexists('status_s', ''),
                    SrcFilePath=column_ifexists('folder_s', ''),
                    FileId= column_ifexists('fileid_g', column_ifexists('fileid_s', '')),
                    FileLink=column_ifexists('filelink_s', ''),
                    SharedWith=column_ifexists('sharedwith_s', ''),
                    User=column_ifexists('user_s', ''),
                    Dvc=column_ifexists('device_s', ''),
                    Application=column_ifexists('application_s', ''),
                    SrcGeoLocation=column_ifexists('location_s', ''),
                    EventMessage=column_ifexists('activity_s', ''),
                    HttpRequest=column_ifexists('request_s', ''),
                    TransactionId=column_ifexists('transactionid_s', ''),
                    EmailFrom=column_ifexists('emailfrom_s', ''),
                    EmailTo=column_ifexists('emailto_s', ''),
                    EmailSubject=column_ifexists('emailsubject_s', ''),
                    EmailCc=column_ifexists('emailcc_s', ''),
                    EmailBcc=column_ifexists('emailbcc_s', ''),
                    EmailSentTime=column_ifexists('emailsenttime_s', todatetime(emailsenttime_s)),
                    SrcFileName=column_ifexists('filename_s', ''),
                    DlpPattern=column_ifexists('dlppattern_s', ''),
                    PageTitle=column_ifexists('pagetitle_s', ''),
                    Url=column_ifexists('url_s', ''),
                    EventResultDetails=column_ifexists('details_s', ''),
                    SyslogHeader=column_ifexists('syslogheader_s', ''),
                    NetworkProtocol=column_ifexists('protocol_s', ''),
                    CustomLocation=column_ifexists('customlocation_s', ''),
                    HttpRequestMethod=column_ifexists('requestmethod_s', ''),
                    UserGroup=column_ifexists('usergroup_s', ''),
                    BgCategories=column_ifexists('bgcategories_s', ''),
                    NetworkBytes=column_ifexists('size_s', ''),
                    City=column_ifexists('city_s', ''),
                    DvcGuid=column_ifexists('deviceguid_g', ''),
                    DstIpAddr=column_ifexists('destinationip_s', ''),
                    SrcIpAddr=column_ifexists('IPAddress', ''),
                    Webreputation=column_ifexists('webreputation_s', ''),
                    SrcGeoLongitude=column_ifexists('long_s', ''),
                    DstDomain=column_ifexists('requestdomain_s', ''),
                    SeTransactionid=column_ifexists('setransactionid_g', ''),
                    Arguments=column_ifexists('arguments_s', ''),
                    IndexedTime=todatetime(indexedtime_s),
                    Email=column_ifexists('email_s', ''),
                    BgCloudScore=column_ifexists('bgcloudscore_s', ''),
                    FirstName=column_ifexists('firstname_s', ''),
                    LastName=column_ifexists('lastname_s', ''),
                    DvcHostname=column_ifexists('devicehostname_s', ''),
                    SrcGeoRegionCode=column_ifexists('regioncode_s', ''),
                    SrcGeoLatitude=column_ifexists('lat_s', ''),
                    SrcBytes=column_ifexists('uploadedbytes_s', ''),
                    WebCategories=column_ifexists('webcategories_s', ''),
                    SrcGeoCountryCode=column_ifexists('countrycode_s', ''),
                    HttpReferrer=column_ifexists('referrer_s', ''),
                    SrcGeoCountry=column_ifexists('country_s', ''),
                    SrcGeoRegion=column_ifexists('region_s', ''),
                    Uri=column_ifexists('uri_s', ''),
                    CustomCategories=column_ifexists('customcategories_s', ''),
                    EventEndTime=todatetime(time_s),
                    Action=column_ifexists('action_s', ''),
                    HttpUserAgent=column_ifexists('useragent_s', ''),
                    WebCategoryClass=column_ifexists('webcategoryclass_s', ''),
                    EventType=column_ifexists('log_type_s', '')           
        | project
                    TimeGenerated, 
                    EventVendor,
                    SrcFileExtension,
                    DocType,
                    SrcFileSHA256,
                    SrcFileSHA1,
                    PolicyId,
                    ThreatId,
                    SrcFileMD5,
                    Keyword,
                    HttpStatusCode,
                    DvcId,
                    Owner,
                    EventResult,
                    SrcFilePath,
                    FileId,
                    FileLink,
                    SharedWith,
                    User,
                    Dvc,
                    Application,
                    SrcGeoLocation,
                    EventMessage,
                    HttpRequest,
                    TransactionId,
                    EmailFrom,
                    EmailTo,
                    EmailSubject,
                    EmailCc,
                    EmailBcc,
                    EmailSentTime,
                    SrcFileName,
                    DlpPattern,
                    PageTitle,
                    Url,
                    EventResultDetails,
                    SyslogHeader,
                    NetworkProtocol,
                    CustomLocation,
                    HttpRequestMethod,
                    UserGroup,
                    BgCategories,
                    NetworkBytes,
                    City,
                    DvcGuid,
                    DstIpAddr,
                    SrcIpAddr,
                    Webreputation,
                    SrcGeoLongitude,
                    DstDomain,
                    SeTransactionid,
                    Arguments,
                    IndexedTime,
                    Email,
                    BgCloudScore,
                    FirstName,
                    LastName,
                    DvcHostname,
                    SrcGeoRegionCode,
                    SrcGeoLatitude,
                    SrcBytes,
                    WebCategories,
                    SrcGeoCountryCode,
                    HttpReferrer,
                    SrcGeoCountry,
                    SrcGeoRegion,
                    Uri,
                    CustomCategories,
                    EventEndTime,
                    Action,
                    HttpUserAgent,
                    WebCategoryClass,
                    EventType      
    };
    Bitglass_view