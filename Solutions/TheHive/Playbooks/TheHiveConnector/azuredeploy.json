{
   "$schema":"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
   "contentVersion":"1.0.0.0",
   "parameters":{
      "ConnectorName": {
         "defaultValue": "TheHive",
         "type": "string"
      },
      "API Hostname":{
         "type":"String",
         "defaultValue":"testhost.com",
         "metadata":{
            "description":"Hostname of the TheHive instance."
         }
      },
      "API Port":{
         "type":"String",
         "defaultValue":"9000",
         "metadata":{
            "description":"Port number of TheHive API. By default 9060."
         }
      },
	  "Http Scheme": {
         "type": "String",
         "allowedValues": [
            "http", "https"
         ],
         "metadata": {
            "description": "Http scheme for request execution."
         }
      }
   },
   "variables": {
	   "serviceUrl": "[uri(parameters('Http Scheme'), '://', parameters('API Hostname'), ':', parameters('API Port'))]"   
   },
   "resources":[
      {
         "type":"Microsoft.Web/customApis",
         "apiVersion":"2016-06-01",
         "name":"[parameters('ConnectorName')]",
         "location":"[resourceGroup().location]",
         "properties":{
            "connectionParameters": {
               "username": {
                  "type": "securestring",
                  "uiDefinition": {
                        "displayName": "username",
                        "description": "The username for this api",
                        "tooltip": "Provide the username",
                        "constraints": {
                           "tabIndex": 2,
                           "clearText": true,
                           "required": "true"
                        }
                  }
               },
               "password": {
                  "type": "securestring",
                  "uiDefinition": {
                        "displayName": "password",
                        "description": "The password for this api",
                        "tooltip": "Provide the password",
                        "constraints": {
                           "tabIndex": 3,
                           "clearText": false,
                           "required": "true"
                        }
                  }
               },
               "authType": {
                  "type": "string",
                  "allowedValues": [
                        {
                           "value": "basic"
                        }
                  ],
                  "uiDefinition": {
                        "displayName": "Authentication Type",
                        "description": "Authentication type to connect to your API",
                        "tooltip": "Authentication type to connect to your API",
                        "constraints": {
                           "tabIndex": 1,
                           "required": "true",
                           "allowedValues": [
                              {
                                    "text": "basic",
                                    "value": "basic"
                              }
                           ]
                        }
                  }
               },
               "gateway": {
                  "type": "gatewaySetting",
                  "gatewaySettings": {
                        "dataSourceType": "CustomConnector",
                        "connectionDetails": []
                  },
                  "uiDefinition": {
                        "constraints": {
                           "tabIndex": 4,
                           "required": "true",
                           "capability": [
                              "gateway"
                           ]
                        }
                  }
               }
            },
            "capabilities": [
               "gateway"
            ],
            "brandColor":"#FFFFFF",
            "description":"Connector for TheHive API",
            "displayName":"[parameters('ConnectorName')]",
            "iconUri":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABzCAYAAACB88xJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAwmSURBVHhe7Z35kyRFHcX9j9Q1QEEkBBVQFDVQwQvxxAvvQFBRPBARL1AxvPAKdEFXMSRUUDG8XRXcnvvo6emd6Tl6uiuzqkZ+bvPVRC+dVa+qK4/qqVn6h09sxM6rzKx6XXl+M+sp/fDxwZR6MTWlhkxNqSFTU2rI1JQaMjWlhkxNqSFTU2rI1JQaMjWlhkxNqSFTU2rI1JQaMjWlhhyaKXLzxwPZvrN2iM59g6C3TMs8KQ7FlGj1/YP9U0+tLdHKe2i5J8XETRGbJ+iDqBty62e0/JNgoqYEUgzihVfSh1A34oUrVXn79D6qZqKmyPbdmZtn9fphETfOTZXtq/Q+qmZipgS9pcH+7IXaTUerH6Taw0JufF8r3/7Mearcs1RbJRMzJVy7Rb9hRb+/RrWHCaqt0TKGqzdRXZVMxBSx+2ftRpObbX+Fag+bYPv3mbKK7YeptiomYkq08g7tJuPZ51NdXYhW3quVN1q6luqqonJTROen2g0C2fk51dYF0V/OlnnjB1RbBZWagi5luo6e9K/OlnD9Dq3c8dxlgyDYoFrfVGqKbH9NuzEQdP9FtXUjkDLTWwxbn6Na31RmStBbUDd1gX5TzZuptq6IzZ9o5Qeie5JqfVKZKeHazdrNxI3zBn2xS7UMsf2bpKpDm8T+bkqS3sr1A7l5D/17HtHia7T7iFbfR3U+qcSUYOeP2o2AcOPbVMvAAxy9Vuz+lepK02+qgeCznyjL2me5jhDsZLvzovMA1fqiElPi5eu0m4jmr6S6POTGPfr1jp2DsHmjlp6JKSBs3qBdHy9elbQ5TOsD76aIznHtBoDc+S3V5iH2TmXSsH5bRFd7S5K0OmZVIu0it++mWh94NSWQvUE8/zKt8BiIMe048HZo6Vi+LWH7Li2deO5SqhuHXE+lM/Mc1ZlZpFpXvJqSfgAg2Jun2nHgzUinhbaBaXMhbwmqRqodA6qrePYFWlrozDCtK95MCXpzSQ9LK/T67VRblvTbgraB6fLIzCbMnJ8YxbRlYLMTYucRqnXBmylR86NaYTEC7st9qi2L69uCqmr0WrzJTGdCtPRGLc1o+S1U54IXU9jMKgIjmNYU2wdLDXV4S4awLnK4eS/V2uLFFPxaRgsZLb2Z6mxIVxm2pphWfUWEax/X0o7nXzwIgi2qtcHZFLwRowUEous42EsxHGckPTCDXzvGI8l1C2qc5OEtGXLQRX7amfsFcv0OqrXBzRSxO4gXrtAKh18R1XoGsVli61fqzfmy6na/cxC2Pq3eqhPq/2eo3jey/XXtvv/XeMYg6P6Hak1xMgUPZLRg8cwF6jVuU61Phm9AHvHS65J2jl3ri6SLPP8SLV9fMQfWpuAXGTeeqRUqPP0tqvVGvzWI5l6k5VlE2PoMT8cTtIus3l6mNcHalKh5k1aYaOEqqvOG2NHyK0vVayDxytu1/DCr3A/dhgJWpiCQYLQgQGw/SLW+iBauzuRZlmD3nzRNH9AussGMOMPKlGjpTVohqo7fCk9/U8vPFLQxfdGjafsg00WevUj10FaotgzGpsjNH2kF2D/19EGw91+q9UU8//JUnub4Gswy0EWOG8/S8gtbn6LaMpiZIrZVQ3u5nnn7S1zrCTZtbkPUvIGm74t0FxkEO3+i2nEYmRKuf1HLNFIj2b6srloAGHuM5mmN5ZR9WQ66yPobHalOANOOo7QpQfcx9Yqeo2UqO/dRrU/SS8O2oJ5n6fuEdpE7x6m2iNKmhGuf1DKLlq+jOu+Irnqgl2h524CNSjR9z2S6yCvvoroiSpuSiUhXDRvCiJjWN4hO1PK2gKXrmwABGplYMfMBbPk2JVCNfGpaIWx+mGsrQG7dn+lklCFcfjdNrwrCtVu1vDHjYTMXZ9TQiw4JTlN1PtNWRbDziOrp3Kmqz7dlVjpBPH+5eji3qLLen/TcWBpVIPYeVfnrM8fh+heodhxGpoBMBP3iq6nuyUakag3tucxdoqozu9hjY1OwVjKaOZBqxM20TxZ48OF3qLYMxqaAqKVPnaMaqSrc5iiQrj2ihVep8VtEtWWwMqUftNVg7DK9IM2PcO1Zjtx6QHsOQHbctnvbmaKQGz/MFsYwEvJsIF58rfYMouW3Up0J1qYABEhoBVIFZLqzlezkLHqjv6NaE5xMEaSBk1WtPgqp8vuD6mZ+fhAE61wzAqY30Nj6WjfPIHrZ+ITmh7jWECdTQHr6Zd9zjK3Y/vUgXL1xEM8+N0k/WRshOsawTNH8FckKpOj+nepsoLPCnnapOZsS9FdVn/xirXCIlmTasmAghhnpWD3M0XSByRp42PxY5vpo8RrVHqo3yHIMATCdMvyRDAlbt1KtDc6mALnxXa2AwKbRl6o+xipmOq0hyW4wcl0eYu8xmk7C3KUH4yuLpYdw7TY9rdkLlVH+Zg+8mALSwdjx0uupjiE2j2euZ4St2+j1suDwgfTWjDTxwkuTniS7lnFg9DEtDWy4ZVpbvJkidh7SCgqCMevUCKiLVj+QuS6PvAa+aHqcRXAyosVr1T2MXylMh8Oiiu2LPaq1xZspIByNvJ99XuEMqdz6hdE6SV50O4zF33MDFcR2Jq0isH++6EipJN5t9qIzenSLmc4Fr6YAzIyiR5ZbpagbRojp6IMoQ14DL1u3J38vihVgDX4RiGErahMxM46Zaqw0sr+74t2UIkT332oEfA19EEVgHYWlB84sKql/2d8BxjfpNMvgM2jbhImZggMz49RWt7LInBOPsGai6TonqA6Ma/DzsN1r6cJETMHAjd1wKRrH8hv4xTdo2qIHyAZ7ZUHAyKSi+UHlprierJq35BzsnqT6QFWRVN+bp3oTkAZL2zeVmuLjqNu8LQ3omubB9ADr9SwPEyZhTGWm+DAE1RNL2xYca8vyMaJxbuXGVGKKr8OgTUbapVDd8fTinA3oNFRpjHdTnBr1EWI1+MSeFJaHC9JX+RAwEmzTPFzxagq6vewGbMib53IFe1VYfjaEq37WT9J4MyUZGFqOQxhIj+Xjg/T+Gheq2HXgxxScFWkxUs8jXC6YYGzflUxxPPFvPux6wOILXLAJ4i7Ciyn4tbDC2oIIEZYPVjSZPo+8jwhggcvnWx3PXqwGuC2alw3OpuDY8fQuJhcwFd6TMc0rff7LOJL4K5IOiAwnKcdhG6LKcDYlSp0V6UrRof8YI7BrihDdf9C0JDlPxoUkIHHPzy4EJ1OwfYwV0Bqc2pATdIF2AHNbxhScyRJ5/myIr337TqZEK+7TFqMgSJrlUxXh6eynQ5xoHEuWi1leJjiZMroC5wMfgWwmJGcnk3K4ULR8UBZrU3zfULR4Nc2natInqbpS1BUvi70pW7+khbJFnnY7pcEWHDfIymMLjkdh+ZhgbYogsV7WqC618aGdHknHRLuAzgXLwwT7N8XjHFLur6vfUl3avylOJotXQffRgeg1krERup/oqSGKJQjWktVJDAqDoDMIxI5i7yDQTgo17glVevmH2MhOdqu1LT4O6LFv6EUv6cKygpkid/hCVnpzkiu50+1qsIqgPHaNKQidonkYYG+KAsHWrGAmFDXw+2SjqQsIfWL5gPD0N+g1pvgIbncyhe1iMiVv+RZfI2J6V/LOqEe1F8+9kF5TFuxKZmmb4mQKSH+/ygRRcJo2zoVk17giN75H8wPpDx8YMXNOUqWzdE1xNgXQQo6hqJeSHNqZCobwCctziO1Sts+9L15MAdKgTvb1mleFiTFx4/xkYxNLxxZvpgDsJz/YmKlvFRiC6PiibQt1AiNzBKmz+xiCmGh2rSteTTmDqltRTWDHFA67EWr0jw9wUm2NwdfqYE649gn1g7o+OaEIM8EINi+z79KWakyZ4sTUlBpSO1OwrMrqb98g/ovlXwdqZ4owDI6wxcdiVFXUsvrCIQHsQfrC56dEqqCWprBNrT7Bl05ZvnWhtg19vGh/jHoR+HJRIAOaZ12orSli9y/JfBJ7sC5UtXnUJ7U1BcjNe+mDteWonOBXa1OAr60LVX9LxSe1NwWYhqumQRQnS7euHAlTAA4bwHkv7KHngbMdxa7dRwAOkyNjyhAc8hYtvCLZRs2MwGdpYZ6PoLjD4siZcgaclLfXSGagMZOLozl8Hv52mBxdU85ipqbUkKkpNWRqSg2ZmlJDpqbUjscH/wfV/O1o6PFdEQAAAABJRU5ErkJggg==",
            "backendService": {
               "serviceUrl": "[variables('serviceUrl')]"
            },
            "apiType":"Rest",
            "swagger":{
               "swagger":"2.0",
               "info":{
                  "title":"Default title",
                  "description":"",
                  "version":"1.0"
               },
               "host": "[concat(parameters('API Hostname'), ':', parameters('API Port'))]",
               "basePath":"/",
               "schemes": [
                  "[parameters('Http Scheme')]"
               ],
               "consumes":[

               ],
               "produces":[

               ],
               "paths":{
                  "/api/alert":{
                     "post":{
                        "responses":{
                           "201":{
                              "description":"default",
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "_id":{
                                       "type":"string",
                                       "description":"_id"
                                    },
                                    "id":{
                                       "type":"string",
                                       "description":"id"
                                    },
                                    "createdBy":{
                                       "type":"string",
                                       "description":"createdBy"
                                    },
                                    "updatedBy":{
                                       "type":"string",
                                       "description":"updatedBy"
                                    },
                                    "createdAt":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"createdAt"
                                    },
                                    "updatedAt":{
                                       "type":"string",
                                       "description":"updatedAt"
                                    },
                                    "_type":{
                                       "type":"string",
                                       "description":"_type"
                                    },
                                    "type":{
                                       "type":"string",
                                       "description":"type"
                                    },
                                    "source":{
                                       "type":"string",
                                       "description":"source"
                                    },
                                    "sourceRef":{
                                       "type":"string",
                                       "description":"sourceRef"
                                    },
                                    "externalLink":{
                                       "type":"string",
                                       "description":"externalLink"
                                    },
                                    "case":{
                                       "type":"string",
                                       "description":"case"
                                    },
                                    "title":{
                                       "type":"string",
                                       "description":"title"
                                    },
                                    "description":{
                                       "type":"string",
                                       "description":"description"
                                    },
                                    "severity":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"severity"
                                    },
                                    "date":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"date"
                                    },
                                    "tags":{
                                       "type":"array",
                                       "items":{
                                          "type":"string"
                                       },
                                       "description":"tags"
                                    },
                                    "tlp":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"tlp"
                                    },
                                    "pap":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"pap"
                                    },
                                    "status":{
                                       "type":"string",
                                       "description":"status"
                                    },
                                    "follow":{
                                       "type":"boolean",
                                       "description":"follow"
                                    },
                                    "customFields":{
                                       "type":"object",
                                       "properties":{

                                       },
                                       "description":"customFields"
                                    },
                                    "caseTemplate":{
                                       "type":"string",
                                       "description":"caseTemplate"
                                    },
                                    "artifacts":{
                                       "type":"array",
                                       "items":{

                                       },
                                       "description":"artifacts"
                                    },
                                    "similarCases":{
                                       "type":"array",
                                       "items":{

                                       },
                                       "description":"similarCases"
                                    }
                                 }
                              }
                           }
                        },
                        "summary":"Create alert",
                        "description":"Create an Alert.",
                        "operationId":"create_alert",
                        "parameters":[
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "artifacts":{
                                       "type":"array",
                                       "items":{

                                       },
                                       "description":"artifacts"
                                    },
                                    "description":{
                                       "type":"string",
                                       "description":"description"
                                    },
                                    "severity":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"severity"
                                    },
                                    "source":{
                                       "type":"string",
                                       "description":"source"
                                    },
                                    "sourceRef":{
                                       "type":"string",
                                       "description":"sourceRef"
                                    },
                                    "tags":{
                                       "type":"array",
                                       "items":{
                                          "type":"string"
                                       },
                                       "description":"tags"
                                    },
                                    "title":{
                                       "type":"string",
                                       "description":"title"
                                    },
                                    "tlp":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"tlp"
                                    },
                                    "type":{
                                       "type":"string",
                                       "description":"type"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  },
                  "/api/case":{
                     "post":{
                        "responses":{
                           "201":{
                              "description":"default",
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "_id":{
                                       "type":"string",
                                       "description":"_id"
                                    },
                                    "id":{
                                       "type":"string",
                                       "description":"id"
                                    },
                                    "createdBy":{
                                       "type":"string",
                                       "description":"createdBy"
                                    },
                                    "updatedBy":{
                                       "type":"string",
                                       "description":"updatedBy"
                                    },
                                    "createdAt":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"createdAt"
                                    },
                                    "updatedAt":{
                                       "type":"string",
                                       "description":"updatedAt"
                                    },
                                    "_type":{
                                       "type":"string",
                                       "description":"_type"
                                    },
                                    "caseId":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"caseId"
                                    },
                                    "title":{
                                       "type":"string",
                                       "description":"title"
                                    },
                                    "description":{
                                       "type":"string",
                                       "description":"description"
                                    },
                                    "severity":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"severity"
                                    },
                                    "startDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"startDate"
                                    },
                                    "endDate":{
                                       "type":"string",
                                       "description":"endDate"
                                    },
                                    "impactStatus":{
                                       "type":"string",
                                       "description":"impactStatus"
                                    },
                                    "resolutionStatus":{
                                       "type":"string",
                                       "description":"resolutionStatus"
                                    },
                                    "tags":{
                                       "type":"array",
                                       "items":{

                                       },
                                       "description":"tags"
                                    },
                                    "flag":{
                                       "type":"boolean",
                                       "description":"flag"
                                    },
                                    "tlp":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"tlp"
                                    },
                                    "pap":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"pap"
                                    },
                                    "status":{
                                       "type":"string",
                                       "description":"status"
                                    },
                                    "summary":{
                                       "type":"string",
                                       "description":"summary"
                                    },
                                    "owner":{
                                       "type":"string",
                                       "description":"owner"
                                    },
                                    "customFields":{
                                       "type":"object",
                                       "properties":{

                                       },
                                       "description":"customFields"
                                    },
                                    "stats":{
                                       "type":"object",
                                       "properties":{

                                       },
                                       "description":"stats"
                                    },
                                    "permissions":{
                                       "type":"array",
                                       "items":{
                                          "type":"string"
                                       },
                                       "description":"permissions"
                                    }
                                 }
                              }
                           }
                        },
                        "summary":"Create case",
                        "operationId":"create_case",
                        "parameters":[
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "title":{
                                       "type":"string",
                                       "description":"title"
                                    },
                                    "description":{
                                       "type":"string",
                                       "description":"description"
                                    },
                                    "Severity":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"Severity"
                                    },
                                    "tlp":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"tlp"
                                    },
                                    "pap":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"pap"
                                    },
                                    "startDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"startDate"
                                    },
                                    "tags":{
                                       "type":"array",
                                       "items":{
                                          "type":"string"
                                       },
                                       "description":"tags"
                                    },
                                    "flag":{
                                       "type":"boolean",
                                       "description":"flag"
                                    },
                                    "owner":{
                                       "type":"string",
                                       "description":"owner"
                                    },
                                    "tasks":{
                                       "type":"array",
                                       "items":{
                                          "type":"object",
                                          "properties":{
                                             "title":{
                                                "type":"string",
                                                "description":"title"
                                             },
                                             "description":{
                                                "type":"string",
                                                "description":"description"
                                             }
                                          }
                                       },
                                       "description":"tasks"
                                    },
                                    "customFields":{
                                       "type":"object",
                                       "properties":{
                                          "cvss":{
                                             "type":"object",
                                             "properties":{
                                                "integer":{
                                                   "type":"integer",
                                                   "format":"int32",
                                                   "description":"integer"
                                                }
                                             },
                                             "description":"cvss"
                                          },
                                          "businessUnit":{
                                             "type":"object",
                                             "properties":{
                                                "string":{
                                                   "type":"string",
                                                   "description":"string"
                                                }
                                             },
                                             "description":"businessUnit"
                                          }
                                       },
                                       "description":"customFields"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  },
                  "/api/case/{id}/task":{
                     "post":{
                        "responses":{
                           "201":{
                              "description":"default",
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "id":{
                                       "type":"string",
                                       "description":"id"
                                    },
                                    "_id":{
                                       "type":"string",
                                       "description":"_id"
                                    },
                                    "createdBy":{
                                       "type":"string",
                                       "description":"createdBy"
                                    },
                                    "createdAt":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"createdAt"
                                    },
                                    "_type":{
                                       "type":"string",
                                       "description":"_type"
                                    },
                                    "title":{
                                       "type":"string",
                                       "description":"title"
                                    },
                                    "group":{
                                       "type":"string",
                                       "description":"group"
                                    },
                                    "description":{
                                       "type":"string",
                                       "description":"description"
                                    },
                                    "owner":{
                                       "type":"string",
                                       "description":"owner"
                                    },
                                    "status":{
                                       "type":"string",
                                       "description":"status"
                                    },
                                    "flag":{
                                       "type":"boolean",
                                       "description":"flag"
                                    },
                                    "startDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"startDate"
                                    },
                                    "endDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"endDate"
                                    },
                                    "order":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"order"
                                    },
                                    "dueDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"dueDate"
                                    }
                                 }
                              }
                           }
                        },
                        "summary":"Create task",
                        "operationId":"create_task",
                        "parameters":[
                           {
                              "name":"id",
                              "in":"path",
                              "required":true,
                              "type":"string"
                           },
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "title":{
                                       "type":"string",
                                       "description":"title"
                                    },
                                    "group":{
                                       "type":"string",
                                       "description":"group"
                                    },
                                    "description":{
                                       "type":"string",
                                       "description":"description"
                                    },
                                    "owner":{
                                       "type":"string",
                                       "description":"owner"
                                    },
                                    "status":{
                                       "type":"string",
                                       "description":"status"
                                    },
                                    "flag":{
                                       "type":"boolean",
                                       "description":"flag"
                                    },
                                    "startDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"startDate"
                                    },
                                    "endDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"endDate"
                                    },
                                    "order":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"order"
                                    },
                                    "dueDate":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"dueDate"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  },
                  "/api/v1/query":{
                     "post":{
                        "responses":{
                           "201":{
                              "description":"default",
                              "schema":{
                                 "type":"array",
                                 "items":{
                                    "type":"object",
                                    "properties":{
                                       "_id":{
                                          "type":"string",
                                          "description":"_id"
                                       },
                                       "_type":{
                                          "type":"string",
                                          "description":"_type"
                                       },
                                       "_createdBy":{
                                          "type":"string",
                                          "description":"_createdBy"
                                       },
                                       "_updatedBy":{
                                          "type":"string",
                                          "description":"_updatedBy"
                                       },
                                       "_createdAt":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"_createdAt"
                                       },
                                       "_updatedAt":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"_updatedAt"
                                       },
                                       "dataType":{
                                          "type":"string",
                                          "description":"dataType"
                                       },
                                       "data":{
                                          "type":"string",
                                          "description":"data"
                                       },
                                       "startDate":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"startDate"
                                       },
                                       "tlp":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"tlp"
                                       },
                                       "tags":{
                                          "type":"array",
                                          "items":{

                                          },
                                          "description":"tags"
                                       },
                                       "ioc":{
                                          "type":"boolean",
                                          "description":"ioc"
                                       },
                                       "sighted":{
                                          "type":"boolean",
                                          "description":"sighted"
                                       },
                                       "reports":{
                                          "type":"object",
                                          "properties":{

                                          },
                                          "description":"reports"
                                       },
                                       "message":{
                                          "type":"string",
                                          "description":"message"
                                       },
                                       "extraData":{
                                          "type":"object",
                                          "properties":{

                                          },
                                          "description":"extraData"
                                       },
                                       "attachment":{
                                          "type":"object",
                                          "properties":{
                                             "_id":{
                                                "type":"string",
                                                "description":"_id"
                                             },
                                             "_type":{
                                                "type":"string",
                                                "description":"_type"
                                             },
                                             "_createdBy":{
                                                "type":"string",
                                                "description":"_createdBy"
                                             },
                                             "_createdAt":{
                                                "type":"integer",
                                                "format":"int32",
                                                "description":"_createdAt"
                                             },
                                             "name":{
                                                "type":"string",
                                                "description":"name"
                                             },
                                             "hashes":{
                                                "type":"array",
                                                "items":{
                                                   "type":"string"
                                                },
                                                "description":"hashes"
                                             },
                                             "size":{
                                                "type":"integer",
                                                "format":"int32",
                                                "description":"size"
                                             },
                                             "contentType":{
                                                "type":"string",
                                                "description":"contentType"
                                             },
                                             "id":{
                                                "type":"string",
                                                "description":"id"
                                             }
                                          },
                                          "description":"attachment"
                                       }
                                    }
                                 }
                              }
                           }
                        },
                        "summary":"List observables",
                        "operationId":"list_observables",
                        "description":"List last 30 observables for a case",
                        "parameters":[
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "query":{
                                       "type":"array",
                                       "items":{
                                          "type":"object",
                                          "properties":{
                                             "_name":{
                                                "type":"string",
                                                "description":"_name"
                                             },
                                             "idOrName":{
                                                "type":"string",
                                                "description":"idOrName"
                                             },
                                             "_fields":{
                                                "type":"array",
                                                "items":{
                                                   "type":"object",
                                                   "properties":{
                                                      "startDate":{
                                                         "type":"string",
                                                         "description":"startDate"
                                                      }
                                                   }
                                                },
                                                "description":"_fields"
                                             },
                                             "from":{
                                                "type":"integer",
                                                "format":"int32",
                                                "description":"from"
                                             },
                                             "to":{
                                                "type":"integer",
                                                "format":"int32",
                                                "description":"to"
                                             }
                                          }
                                       },
                                       "description":"query"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  },
                  "/api/v1/user/{id}":{
                     "patch":{
                        "responses":{
                           "204":{
                              "description":"default",
                              "schema":{

                              }
                           }
                        },
                        "summary":"Lock user",
                        "operationId":"lock_user",
                        "parameters":[
                           {
                              "name":"id",
                              "in":"path",
                              "required":true,
                              "type":"string"
                           },
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "locked":{
                                       "type":"boolean",
                                       "description":"locked"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  },
                  "/api/v0/case/{caseId}/artifact":{
                     "post":{
                        "responses":{
                           "201":{
                              "description":"default",
                              "schema":{
                                 "type":"array",
                                 "items":{
                                    "type":"object",
                                    "properties":{
                                       "_id":{
                                          "type":"string",
                                          "description":"_id"
                                       },
                                       "id":{
                                          "type":"string",
                                          "description":"id"
                                       },
                                       "createdBy":{
                                          "type":"string",
                                          "description":"createdBy"
                                       },
                                       "createdAt":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"createdAt"
                                       },
                                       "_type":{
                                          "type":"string",
                                          "description":"_type"
                                       },
                                       "ip":{
                                          "type":"string",
                                          "description":"ip"
                                       },
                                       "data":{
                                          "type":"string",
                                          "description":"data"
                                       },
                                       "startDate":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"startDate"
                                       },
                                       "tlp":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"tlp"
                                       },
                                       "tags":{
                                          "type":"array",
                                          "items":{

                                          },
                                          "description":"tags"
                                       },
                                       "ioc":{
                                          "type":"boolean",
                                          "description":"ioc"
                                       },
                                       "sighted":{
                                          "type":"boolean",
                                          "description":"sighted"
                                       },
                                       "message":{
                                          "type":"string",
                                          "description":"message"
                                       },
                                       "reports":{
                                          "type":"object",
                                          "properties":{

                                          },
                                          "description":"reports"
                                       },
                                       "stats":{
                                          "type":"object",
                                          "properties":{

                                          },
                                          "description":"stats"
                                       }
                                    }
                                 }
                              }
                           }
                        },
                        "summary":"Create observable for a case",
                        "description":"Creates an observable which can be linked to a case",
                        "operationId":"create_observable_case",
                        "parameters":[
                           {
                              "name":"caseId",
                              "in":"path",
                              "required":true,
                              "type":"string"
                           },
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "dataType":{
                                       "type":"string",
                                       "description":"dataType"
                                    },
                                    "tlp":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"tlp"
                                    },
                                    "ioc":{
                                       "type":"boolean",
                                       "description":"ioc"
                                    },
                                    "sighted":{
                                       "type":"boolean",
                                       "description":"sighted"
                                    },
                                    "tags":{
                                       "type":"array",
                                       "items":{

                                       },
                                       "description":"tags"
                                    },
                                    "data":{
                                       "type":"array",
                                       "items":{
                                          "type":"string"
                                       },
                                       "description":"data"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  },
                  "/api/v0/alert/{alertId}/artifact":{
                     "post":{
                        "responses":{
                           "201":{
                              "description":"default",
                              "schema":{
                                 "type":"array",
                                 "items":{
                                    "type":"object",
                                    "properties":{
                                       "_id":{
                                          "type":"string",
                                          "description":"_id"
                                       },
                                       "id":{
                                          "type":"string",
                                          "description":"id"
                                       },
                                       "createdBy":{
                                          "type":"string",
                                          "description":"createdBy"
                                       },
                                       "createdAt":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"createdAt"
                                       },
                                       "_type":{
                                          "type":"string",
                                          "description":"_type"
                                       },
                                       "ip":{
                                          "type":"string",
                                          "description":"ip"
                                       },
                                       "data":{
                                          "type":"string",
                                          "description":"data"
                                       },
                                       "startDate":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"startDate"
                                       },
                                       "tlp":{
                                          "type":"integer",
                                          "format":"int32",
                                          "description":"tlp"
                                       },
                                       "tags":{
                                          "type":"array",
                                          "items":{

                                          },
                                          "description":"tags"
                                       },
                                       "ioc":{
                                          "type":"boolean",
                                          "description":"ioc"
                                       },
                                       "sighted":{
                                          "type":"boolean",
                                          "description":"sighted"
                                       },
                                       "message":{
                                          "type":"string",
                                          "description":"message"
                                       },
                                       "reports":{
                                          "type":"object",
                                          "properties":{

                                          },
                                          "description":"reports"
                                       },
                                       "stats":{
                                          "type":"object",
                                          "properties":{

                                          },
                                          "description":"stats"
                                       }
                                    }
                                 }
                              }
                           }
                        },
                        "summary":"Create observable for an alert",
                        "description":"Creates an observable which can be linked to an alert.",
                        "operationId":"create_observable_alert",
                        "parameters":[
                           {
                              "name":"alertId",
                              "in":"path",
                              "required":true,
                              "type":"string"
                           },
                           {
                              "name":"body",
                              "in":"body",
                              "required":false,
                              "schema":{
                                 "type":"object",
                                 "properties":{
                                    "dataType":{
                                       "type":"string",
                                       "description":"dataType"
                                    },
                                    "tlp":{
                                       "type":"integer",
                                       "format":"int32",
                                       "description":"tlp"
                                    },
                                    "ioc":{
                                       "type":"boolean",
                                       "description":"ioc"
                                    },
                                    "sighted":{
                                       "type":"boolean",
                                       "description":"sighted"
                                    },
                                    "tags":{
                                       "type":"array",
                                       "items":{

                                       },
                                       "description":"tags"
                                    },
                                    "data":{
                                       "type":"array",
                                       "items":{
                                          "type":"string"
                                       },
                                       "description":"data"
                                    }
                                 }
                              }
                           }
                        ]
                     }
                  }
               },
               "definitions":{

               },
               "parameters":{

               },
               "responses":{

               },
               "securityDefinitions":{
                  "basic_auth":{
                     "type":"basic"
                  }
               },
               "security":[
                  {
                     "basic_auth":[

                     ]
                  }
               ],
               "tags":[

               ]
            }
         }
      }
   ]
}