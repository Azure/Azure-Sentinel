[
	{
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"apiVersion": "2022-10-01-preview",
		"name": "JumpCloudAPIRequest",
		"kind": "RestApiPoller",
		"properties": {
			"connectorDefinitionName": "JumpCloudMultiRule",
			"dataType": "JumpCloud_CL",
			"dcrConfig": {
				"streamName": "Custom-JumpCloud_API",
				"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
				"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			},
			"auth": {
				"type": "APIKey",
				"ApiKey": "{{apiKey}}",
				"ApiKeyName": "x-api-key"
			},
			"request": {
				"apiEndpoint": "https://api.jumpcloud.com/insights/directory/v1/events",
				"httpMethod": "POST",
				"queryParameters": {
					"perPage": 1000
				},
				"IsPostPayloadJson": true,
				"queryParametersTemplate": "{\"service\": [\"all\"], \"start_time\": \"{_QueryWindowStartTime}\", \"end_time\": \"{_QueryWindowEndTime}\" }",
				"queryWindowInMin": 5,
				"queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
				"startTimeAttributeName": "t0",
				"endTimeAttributeName": "t1",
				"rateLimitQps": 2,
				"retryCount": 3,
				"timeoutInSeconds": 60,
				"headers": {
					"Accept": "application/json",
					"x-org-id": "{{organization}}"
				}
			},
			"paging": {
				"pagingType": "LinkHeader",
				"linkHeaderRelLinkName": "rel=next"
			},
			"response": {
				"eventsJsonPaths": ["$"]
			}
		}
	}
]
