[
	{
		"name": "JumpCloudDCR",
		"apiVersion": "2021-09-01-preview",
		"type": "Microsoft.Insights/dataCollectionRules",
		"location": "{{location}}",
		"properties": {
			"dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
			"streamDeclarations": {
				"Custom-JumpCloud_API": {
					"columns": [
						{
							"name": "timestamp",
							"type": "datetime",
							"description": "Timestamp of when the event occurred (UTC)."
						},
						{
							"name": "correlation",
							"type": "string",
							"description": "Details for a background process or parent event that can be used to correlate related events."
						},
						{
							"name": "resource",
							"type": "string",
							"description": "Resource that changed or attempted the login."
						},
						{
							"name": "system_group",
							"type": "string",
							"description": "string that contains the closest device/system group involved in the event."
						},
						{
							"name": "system",
							"type": "string",
							"description": "The string that describes the system."
						},
						{
							"name": "target_resource",
							"type": "string",
							"description": "Target resource involved in the event."
						},
						{
							"name": "event_type",
							"type": "string",
							"description": "Event type."
						},
						{
							"name": "useragent",
							"type": "string",
							"description": "User agent information for the browser that submitted the request."
						},
						{
							"name": "auth_method",
							"type": "string",
							"description": "Session = console, api-key = api-key."
						},
						{
							"name": "geoip",
							"type": "string",
							"description": "Geo IP information for the IP address that made the request."
						},
						{
							"name": "mfa",
							"type": "boolean",
							"description": "Denotes whether MFA was used on an authentication attempt."
						},
						{
							"name": "mfa_meta",
							"type": "string",
							"description": "string that contains metadata around MFA authentication such as the type of MFA."
						},
						{
							"name": "eventType",
							"type": "string",
							"description": "Type of the event"
						},
						{
							"name": "provider",
							"type": "string",
							"description": "The org ID of the provider if the org is a provider org."
						},
						{
							"name": "success",
							"type": "boolean",
							"description": "Denotes whether a login attempt was successful."
						},
						{
							"name": "message_chain",
							"type": "string",
							"description": "Results detail for each event."
						},
						{
							"name": "error_message",
							"type": "string",
							"description": "Error details."
						},
						{
							"name": "idm_client_id",
							"type": "string",
							"description": "The client ID for the Identity Management integration."
						},
						{
							"name": "application",
							"type": "string",
							"description": "Information for the application that the event was initiated for."
						},
						{
							"name": "auth_context",
							"type": "string",
							"description": "string for authentication context including factors used, device information, and policies applied."
						},
						{
							"name": "service",
							"type": "string",
							"description": "Service that the event originated from."
						},
						{
							"name": "organization",
							"type": "string",
							"description": "Organization that the user belongs to."
						},
						{
							"name": "association",
							"type": "string",
							"description": "string that describes a change in association, such as adding a user to a group."
						},
						{
							"name": "client_ip",
							"type": "string",
							"description": "IP address that the request came from."
						},
						{
							"name": "initiated_by",
							"type": "string",
							"description": "string that describes who initiated the request."
						},
						{
							"name": "changes",
							"type": "string",
							"description": "List of changes made in the request. You cannot search on the contents of this field."
						},
						{
							"name": "id",
							"type": "string",
							"description": "Unique ID for the event"
						},
						{
							"name": "category",
							"type": "string",
							"description": "Category of alert"
						},
						{
							"name": "severity",
							"type": "string",
							"description": "Severity of alert."
						},
						{
							"name": "username",
							"type": "string",
							"description": "Username provided for the alert service call."
						},
						{
							"name": "user_agent",
							"type": "string",
							"description": "User agent information for the browser that submitted the request."
						},
						{
							"name": "version",
							"type": "string",
							"description": "The schema version for the document object."
						},
						{
							"name": "idp_initiated",
							"type": "boolean",
							"description": "Returns true if the request was initiated from the Identity Provider (JumpCloud). Returns false if the auth was initiated from the service provider."
						},
						{
							"name": "nas_mfa_state",
							"type": "string",
							"description": "Disabled: No MFA required. Enabled: MFA is required if the user is configured for MFA. Required: MFA is required unless the user is excluded and not configured for MFA. Always: MFA always required."
						},
						{
							"name": "auth_type",
							"type": "string",
							"description": "Authentication type."
						},
						{
							"name": "eap_type",
							"type": "string",
							"description": "EAP type."
						},
						{
							"name": "outer",
							"type": "string",
							"description": "Object for outer."
						},
						{
							"name": "system_timestamp",
							"type": "datetime",
							"description": "Local system time."
						},
						{
							"name": "message",
							"type": "string",
							"description": "Log message associated with a login attempt."
						},
						{
							"name": "src_ip",
							"type": "string",
							"description": "IP address the login request came from."
						},
						{
							"name": "process_name",
							"type": "string",
							"description": "Process that initiated a login attempt."
						},
						{
							"name": "app_management_source",
							"type": "string",
							"description": "The JumpCloud method of configuring and installing the application."
						},
						{
							"name": "windows_meta",
							"type": "string",
							"description": "Information about Windows authentications including whether the login had elevated privileges and the logon type."
						},
						{
							"name": "connection_id",
							"type": "string",
							"description": "Unique id for every LDAP connection."
						},
						{
							"name": "operation_number",
							"type": "int",
							"description": "All operation requests and operation result pairs are given incremental operation numbers beginning with operation_number=0 to identify the distinct operations being performed."
						},
						{
							"name": "dn",
							"type": "string",
							"description": "Distinguished name (DN) provided for authentication."
						},
						{
							"name": "mech",
							"type": "string",
							"description": "The authentication method used. Either simple or SASL."
						},
						{
							"name": "start_tls",
							"type": "boolean",
							"description": "The starttls protocol that was used to open the LDAP connection."
						},
						{
							"name": "tls_established",
							"type": "boolean",
							"description": "The LDAPS protocol that was used to open the LDAP connection."
						},
						{
							"name": "error_code",
							"type": "int",
							"description": "Result code."
						},
						{
							"name": "oid",
							"type": "string",
							"description": "LDAP object identifier."
						},
						{
							"name": "base",
							"type": "string",
							"description": "The base of the subtree in which the search is to be constrained."
						},
						{
							"name": "scope",
							"type": "int",
							"description": "The search scope. This specifies the portion of the target subtree that should be considered."
						},
						{
							"name": "deref",
							"type": "int",
							"description": "The alias dereferencing behavior, which indicates how the server should treat any aliases encountered while processing the search."
						},
						{
							"name": "filter",
							"type": "string",
							"description": "The filter criteria for the search with the scope."
						},
						{
							"name": "attr",
							"type": "string",
							"description": "A set of attributes to be returned to the client."
						},
						{
							"name": "number_of_results",
							"type": "int",
							"description": "Number of rows returned from the search."
						},
						{
							"name": "auth_meta",
							"type": "string",
							"description": "Object for authentication context including factors used, device information if cert was present, push device information if JumpCloud Protect was a factor, and policies that were applied."
						},
						{
							"name": "mdm_type",
							"type": "string",
							"description": "The type of MDM service."
						},
						{
							"name": "device_object_id",
							"type": "string",
							"description": "Unique ID for the device."
						},
						{
							"name": "device_manager_object_id",
							"type": "string",
							"description": "Unique ID for the device manager."
						},
						{
							"name": "windows_device_uuid",
							"type": "string",
							"description": "Unique ID for the windows device."
						},
						{
							"name": "command_uuid",
							"type": "string",
							"description": "Unique ID for the command."
						},
						{
							"name": "request_type",
							"type": "string",
							"description": "The type of command."
						},
						{
							"name": "command",
							"type": "string",
							"description": "The executed command."
						},
						{
							"name": "status",
							"type": "string",
							"description": "The command result: Acknowledged, Error, CommandFormatError, and Idle."
						},
						{
							"name": "error_chain",
							"type": "string",
							"description": "Raw error details as reported by the MDM device."
						},
						{
							"name": "result",
							"type": "string",
							"description": "Description of the end result of the event"
						},
						{
							"name": "name",
							"type": "string",
							"description": "The name of the notification channel."
						},
						{
							"name": "description",
							"type": "string",
							"description": "The description of the notification channel."
						},
						{
							"name": "channel_object_id",
							"type": "string",
							"description": "Unique ID for the notification channel."
						},
						{
							"name": "config",
							"type": "string",
							"description": "The configuration of the notification channel."
						},
						{
							"name": "referrer_object_id",
							"type": "string",
							"description": "Unique ID for the referrer."
						},
						{
							"name": "referrer_type",
							"type": "string",
							"description": "The type of referrer."
						},
						{
							"name": "object_storage_item_object_id",
							"type": "string",
							"description": "Unique ID for the object storage item."
						},
						{
							"name": "object_storage_item_version_object_id",
							"type": "string",
							"description": "Unique ID for the object storage item version."
						},
						{
							"name": "object_storage_item_version_name",
							"type": "string",
							"description": "Name of the object storage item."
						},
						{
							"name": "object_storage_item_version_size",
							"type": "int",
							"description": "Size of the object storage item's version in bytes."
						},
						{
							"name": "object_storage_item_version_sha_256_sum",
							"type": "string",
							"description": "Object storage item version's SHA-256 sum."
						},
						{
							"name": "total_software_item_count",
							"type": "int",
							"description": "Total count of object storage items with a SOFTWARE_APP referrer type for the organization."
						},
						{
							"name": "total_space_used",
							"type": "int",
							"description": "Total sum of object storage items."
						},
						{
							"name": "system_object_id",
							"type": "string",
							"description": "Unique ID for the system associated with the request."
						},
						{
							"name": "detail",
							"type": "string",
							"description": "Log message associated with an alert event."
						},
						{
							"name": "pid",
							"type": "string",
							"description": "Partner ID of the MSP."
						},
						{
							"name": "access_request_id",
							"type": "string",
							"description": "Access request ID."
						},
						{
							"name": "workflow",
							"type": "string",
							"description": "Workflow object with id name type and description."
						}
					]
				}
			},
			"destinations": {
				"logAnalytics": [
					{
						"workspaceResourceId": "{{workspaceResourceId}}",
						"name": "clv2ws1"
					}
				]
			},
			"dataFlows": [
				{
					"streams": [
						"Custom-JumpCloud_API"
					],
					"destinations": [
						"clv2ws1"
					],
					"transformKql": "source\r\n| extend \r\n TimeGenerated = timestamp | extend Type=\"JumpCloud_CL\"",
					"outputStream": "Custom-JumpCloud_CL"
				}
			]
		}
	}
]
