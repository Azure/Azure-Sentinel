{
	"type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
	"apiVersion": "2022-09-01-preview",
	"name": "JumpCloudMultiRule",
	"location": "{{location}}",
	"kind": "Customizable",
	"properties": {
		"connectorUiConfig": {
			"id": "JumpCloudMultiRule",
			"title": "JumpCloud (using REST API)",
			"publisher": "Microsoft",
			"descriptionMarkdown": "The [JumpCloud](https://jumpcloud.com) connector allows you to easily connect your JumpCloud organization events to Microsoft Sentinel. The data connector uses the [JumpCloud REST API](https://jumpcloud.com/api) to fetch logs and supports DCR-based ingestion time transformations that parse the received data and ingest into ASIM and custom tables in your Log Analytics workspace.",
			"graphQueriesTableName": "JumpCloud_CL",
			"graphQueries": [
				{
					"metricName": "Total events received",
					"legend": "Get Events",
					"baseQuery": "{{graphQueriesTableName}}"
				}
			],
			"sampleQueries": [
				{
					"description": "Get Sample of JumpCloud Events",
					"query": "{{graphQueriesTableName}}\n  | take 10"
				}
			],
			"dataTypes": [
				{
					"name": "{{graphQueriesTableName}}",
					"lastDataReceivedQuery": "{{graphQueriesTableName}}\n       | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
				}
			],
			"connectivityCriteria": [
				{
					"type": "HasDataConnectors"
				}
			],
			"availability": {
				"isPreview": false
			},
			"permissions": {
				"resourceProvider": [
					{
						"provider": "Microsoft.OperationalInsights/workspaces",
						"permissionsDisplayText": "Read and Write permissions are required.",
						"providerDisplayName": "Workspace",
						"scope": "Workspace",
						"requiredPermissions": {
							"write": true,
							"read": true,
							"delete": true
						}
					},
					{
						"provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
						"permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
						"providerDisplayName": "Keys",
						"scope": "Workspace",
						"requiredPermissions": {
							"action": true
						}
					}
				],
				"customs": [
					{
						"name": "JumpCloud REST API Key",
						"description": "Enable API access in JumpCloud and generate API Key. Please refer to JumpCloud official [documentation](https://jumpcloud.com/api) for more information."
					},
					{
						"name": "JumpCloud Organization Id",
						"description": "Obtain your JumpCloud organization id to fetch events. Follow the steps in the [documentation](https://jumpcloud.com/api) to obtain the Organization Id using the JumpCloud API Key obtained in previous step."
					}
				]
			},
			"instructionSteps": [
				{
					"description": "Currently, this connector allows to ingest events from the following [JumpCloud REST API](https://jumpcloud.com/api) endpoint: \n 1. [Get Organization Events](https://jumpcloud.com/api) \n>This connector parses events into JumpCloud_CL Table.",
					"instructions": [
						{
							"parameters": {
								"label": "Organization Id",
								"placeholder": "OrganizationId",
								"type": "text",
								"name": "organization"
							},
							"type": "Textbox"
						},
						{
							
							"parameters": {
								"label": "API Key",
								"placeholder": "ApiKey",
								"type": "securestring",
								"name": "apiKey"
							},
							"type": "Textbox"
						},
						{
							"parameters": {
								"label": "Event Types",
								"placeholder": "all;directory;radius;sso;systems;ldap;mdm",
								"type": "text",
								"requestObjectKey": "queryParametersTemplate",
								"name": "eventtypes"
							},
							"type": "Textbox"
						},
						{
							"parameters": {
								"label": "toggle",
								"name": "toggle"
							},
							"type": "ConnectionToggleButton"
						}
					],
					"title": "Connect JumpCloud events to Microsoft Sentinel"
				}
			]
		}
	}
}
