{
  "id": "Pathlock_TDnR",
  "title": "Pathlock TDnR Integration",
  "publisher": "Pathlock",
  "logo": "Pathlock_TDnR.svg",
  "descriptionMarkdown": "Ingest Pathlock TDnR alerts and SAP security audit events into Microsoft Sentinel via the codeless connector platform (push through DCE+DCR).",
  "graphQueriesTableName": "Pathlock_TDnR_CL",
  "graphQueries": [
    {
      "metricName": "Events over time",
      "legend": "AlertSeverityText",
      "baseQuery": "Pathlock_TDnR_CL | summarize count() by bin(TimeGenerated, 1h), tostring(AlertSeverityText) | order by bin(TimeGenerated, 1h) asc"
    }
  ],
  "sampleQueries": [
    {
      "description": "Latest 10 events",
      "query": "Pathlock_TDnR_CL | take 10"
    },
    {
      "description": "Top ABAP programs",
      "query": "Pathlock_TDnR_CL | summarize count() by AbapProgramName | top 10 by count_ desc"
    },
    {
      "description": "Events by user and client",
      "query": "Pathlock_TDnR_CL | summarize count() by User, ClientId | order by count_ desc"
    }
  ],
  "dataTypes": [
    {
      "name": "Pathlock_TDnR_CL",
      "lastDataReceivedQuery": "Pathlock_TDnR_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
    }
  ],
  "connectivityCriteria": [
    {
      "type": "HasDataConnectors"
    }
  ],
  "availability": {
    "isPreview": true
  },
  "permissions": {
    "resourceProvider": [
      {
        "provider": "Microsoft.OperationalInsights/workspaces",
        "permissionsDisplayText": "Read and Write permissions are required.",
        "providerDisplayName": "Workspace",
        "scope": "Workspace",
        "requiredPermissions": {
          "write": true,
          "read": true,
          "delete": true
        }
      },
      {
        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
        "permissionsDisplayText": "Read permission to shared keys for the workspace is required.",
        "providerDisplayName": "Keys",
        "scope": "Workspace",
        "requiredPermissions": {
          "action": true
        }
      }
    ],
    "customs": [
      {
        "name": "Microsoft Entra",
        "description": "Create an app registration with client secret for OAuth2 client-credentials."
      },
      {
        "name": "Azure Monitor",
        "description": "Grant the app permission to post to the Data Collection Rule (Logs Ingestion API)."
      }
    ]
  },
  "instructionSteps": [
    {
      "title": "1. Deploy push connector resources",
      "description": "Creates a Data Collection Endpoint (DCE) + Data Collection Rule (DCR) and an Entra application with secret. Grants permission for logs ingestion.",
      "instructions": [
        {
          "type": "Markdown",
          "parameters": {
            "content": "Click **Deploy push connector resources** to create the Azure resources."
          }
        },
        {
          "type": "DeployPushConnectorButton_test",
          "parameters": {
            "label": "Deploy push connector resources",
            "applicationDisplayName": "Pathlock TDnR push to Microsoft Sentinel"
          }
        }
      ]
    },
    {
      "title": "2. Configure Pathlock with these values",
      "description": "Provide these parameters to Pathlock so it can push records to the Logs Ingestion API.",
      "instructions": [
        {
          "type": "CopyableLabel",
          "parameters": {
            "label": "Tenant ID",
            "fillWith": [
              "TenantId"
            ]
          }
        },
        {
          "type": "CopyableLabel",
          "parameters": {
            "label": "Entra Application ID",
            "fillWith": [
              "ApplicationId"
            ]
          }
        },
        {
          "type": "CopyableLabel",
          "parameters": {
            "label": "Entra Application Secret",
            "fillWith": [
              "ApplicationSecret"
            ]
          }
        },
        {
          "type": "CopyableLabel",
          "parameters": {
            "label": "Data Collection Endpoint (DCE) URL",
            "fillWith": [
              "DataCollectionEndpoint"
            ]
          }
        },
        {
          "type": "CopyableLabel",
          "parameters": {
            "label": "DCR Immutable ID",
            "fillWith": [
              "DataCollectionRuleId"
            ]
          }
        },
        {
          "type": "CopyableLabel",
          "parameters": {
            "label": "Stream ID",
            "value": "Custom-Pathlock_TDnR_CL"
          }
        }
      ]
    }
  ],
  "metadata": {
    "id": "Pathlock_TDnR",
    "version": "1.0.0",
    "kind": "dataConnector",
    "source": {
      "kind": "solution",
      "name": "Pathlock TDnR for Microsoft Sentinel"
    },
    "author": {
      "name": "Pathlock",
      "email": "support@pathlock.com"
    },
    "support": {
      "tier": "Partner",
      "name": "Pathlock",
      "email": "support@pathlock.com",
      "link": "https://pathlock.com/support"
    }
  }
}