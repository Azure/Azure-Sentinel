{
  "type": "Microsoft.Insights/dataCollectionRules",
  "apiVersion": "2023-03-11",
  "name": "Pathlock_TDnR-DCR",
  "location": "{{location}}",
  "properties": {
    "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
    "streamDeclarations": {
      "Custom-Pathlock_TDnR_CL": {
        "columns": [
          { "name": "TimeGenerated", "type": "datetime" },
        { "name": "SYSID", "type": "string" },
        { "name": "KEY_FIELD", "type": "string" },
        { "name": "MANDT", "type": "string" },
        { "name": "DATA_SOURCE", "type": "string" },
        { "name": "EVENTID", "type": "string" },
        { "name": "EVENTID_LFDNR", "type": "string" },
        { "name": "INSTANCE", "type": "string" },
        { "name": "HOSTNAME", "type": "string" },
        { "name": "BNAME", "type": "string" },
        { "name": "TCODE", "type": "string" },
        { "name": "REPORT", "type": "string" },
        { "name": "OKCODE", "type": "string" },
        { "name": "AREA", "type": "string" },
        { "name": "SUBID", "type": "string" },
        { "name": "AGR_NAME", "type": "string" },
        { "name": "PROFN", "type": "string" },
        { "name": "TERMINAL", "type": "string" },
        { "name": "DATUM", "type": "string" },
        { "name": "ZEIT", "type": "string" },
        { "name": "SRC_IP", "type": "string" },
        { "name": "DEST_IP", "type": "string" },
        { "name": "URI", "type": "string" },
        { "name": "PGMID", "type": "string" },
        { "name": "OBJECT", "type": "string" },
        { "name": "OBJ_NAME", "type": "string" },
        { "name": "LOG_LINE", "type": "string" },
        { "name": "DATUM_UTC", "type": "string" },
        { "name": "ZEIT_UTC", "type": "string" },
        { "name": "FORWARDED", "type": "string" },
        { "name": "EXPORTED", "type": "string" },
        { "name": "CONFIRMED", "type": "string" },
        { "name": "RT_SYSID", "type": "string" },
        { "name": "CONF_USER", "type": "string" },
        { "name": "CONF_DATE", "type": "string" },
        { "name": "CONF_TIME", "type": "string" },
        { "name": "CONF_CHG_USER", "type": "string" },
        { "name": "CONF_CHG_DATE", "type": "string" },
        { "name": "CONF_CHG_TIME", "type": "string" },
        { "name": "INCIDENT", "type": "string" },
        { "name": "PUSH", "type": "string" },
        { "name": "BYTES", "type": "long" },
        { "name": "AFFECTED_USER", "type": "string" },
        { "name": "TABNAME", "type": "string" },
        { "name": "FILTER_NO", "type": "string" },
        { "name": "FILENAME", "type": "string" },
        { "name": "AUDIT_ACTIONID", "type": "string" },
        { "name": "MSG_TYPE", "type": "string" },
        { "name": "MSG_ID", "type": "string" },
        { "name": "MSG_NO", "type": "string" },
        { "name": "MESSAGE_V1", "type": "string" },
        { "name": "MESSAGE_V2", "type": "string" },
        { "name": "MESSAGE_V3", "type": "string" },
        { "name": "MESSAGE_V4", "type": "string" },
        { "name": "CENTRAL_TS", "type": "string" }
        ]
      }
    },
    "destinations": {
      "logAnalytics": [
        {
          "name": "clv2ws1",
          "workspaceResourceId": "{{workspaceResourceId}}"
        }
      ]
    },
    "dataFlows": [
      {
        "streams": [ "Microsoft-ABAPAuditLog" ],
        "destinations": [ "clv2ws1" ],
        "transformKql": "source\n",
        "outputStream": "Microsoft-ABAPAuditLog"
      },
      {
        "streams": [ "Custom-Pathlock_TDnR_CL" ],
        "destinations": [ "clv2ws1" ],
        "transformKql": "source\n",
        "outputStream": "Custom-Pathlock_TDnR_CL"
      }
    ]
  }
}