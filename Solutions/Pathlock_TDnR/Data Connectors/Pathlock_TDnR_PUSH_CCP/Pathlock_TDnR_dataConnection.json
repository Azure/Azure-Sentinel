{
  "type": "Microsoft.SecurityInsights/dataConnectors",
  "apiVersion": "2025-04-01-preview",
  "name": "[[concat(parameters('workspaceName'), '/Pathlock_TDnR_Push')]]",
  "location": "[[resourceGroup().location]]",
  "kind": "Push",
  "properties": {
    "connectorDefinitionName": "Pathlock_TDnR",
"dcrConfig": {
  "dataCollectionRuleId": "[[resourceId('Microsoft.Insights/dataCollectionRules', 'Pathlock_TDnR-DCR')]]",
  "dataCollectionEndpoint": "[[resourceId('Microsoft.Insights/dataCollectionEndpoints', parameters('workspaceName'))]]",
  "dataCollectionRuleImmutableId": "[[reference(resourceId('Microsoft.Insights/dataCollectionRules', 'Pathlock_TDnR-DCR'), '2023-03-11').properties.immutableId]]",
  "streamName": "Custom-Pathlock_TDnR_CL"
},
    "auth": {
      "type": "Push",
      "appId": "{{appId}}",
      "servicePrincipalId": "{{servicePrincipalId}}"
    },
    "request": {
      "RetryCount": 1
    },
    "response": {
      "eventsJsonPaths": [
        "$.messages"
      ]
    }
  }
}
