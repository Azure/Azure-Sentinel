{
    "id": "Pathlock_TDnR",
    "title": "Pathlock Threat Detection and Response Integration",
    "publisher": "Pathlock Inc.",
    "logo": "pathlock_logo.svg",
    "descriptionMarkdown": "Pathlock Threat Detection and Response enables seamless forwarding of security alerts and logs detected and collected by the Pathlock Platform into Microsoft Sentinel Solution for SAP.",
    "graphQueriesTableName": "Pathlock_TDnR_CL",
    "graphQueries": [
        {
            "metricName": "Total events received",
            "legend": "SID",
            "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated, SYSID= sid"
        }
    ],
    "sampleQueries": [
        {
            "description": "Get Sample Events",
            "query": "{{graphQueriesTableName}}\n | take 10"
        }
    ],
    "dataTypes": [
        {
            "name": "{{graphQueriesTableName}}",
            "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | where name_s == \"no data test\" | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
        }
    ],
    "connectivityCriteria": [
        {
            "type": "HasDataConnectors"
        }
    ],
    "availability": {
        "isPreview": true
    },
    "permissions": {
        "resourceProvider": [
            {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                    "write": true,
                    "read": true,
                    "delete": true
                }
            },
            {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "Read permissions to shared keys for the workspace are required.",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                    "action": true
                }
            }
        ],
        "customs": [
            {
                "name": "Microsoft Entra",
                "description": "Permission to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
            },
            {
                "name": "Microsoft Azure",
                "description": "Permission to assign Monitoring Metrics Publisher role on data collection rules. Typically requires Azure RBAC Owner or User Access Administrator role."
            }
        ]
    },
    "instructionSteps": [
        {
            "title": "1. Create ARM Resources and Provide the Required Permissions",
            "description": "We will create data collection rule (DCR) and data collection endpoint (DCE) resources. We will also create a Microsoft Entra app registration and assign the required permissions to it.",
            "instructions": [
                {
                    "type": "Markdown",
                    "parameters": {
                        "content": "#### Automated deployment of Azure resources\nClicking on \"Deploy push connector resources\" will trigger the creation of DCR and DCE resources.\nIt will then create a Microsoft Entra app registration with client secret and grant permissions on the DCR. This setup enables data to be sent securely to the DCR using a OAuth v2 client credentials."
                    }
                },
                {
                    "parameters": {
                        "label": "Deploy push connector resources",
                        "applicationDisplayName": "Pathlock Threat Detection and Response forwarding to Microsoft Sentinel Solution for SAP"
                    },
                    "type": "DeployPushConnectorButton_test"
                }
            ]
        },
        {
            "title": "2. Maintain the data collection endpoint details and authentication info in Pathlock Threat Detection and Response",
            "description": "Share the data collection endpoint URL and authentication info with the Pathlock Threat Detection and Response Integration administrator to configure the Integration.",
            "instructions": [
                {
                    "parameters": {
                        "label": "Use this value to configure as Tenant ID in the LogIngestionAPI credential.",
                        "fillWith": [
                            "TenantId"
                        ]
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "label": "Entra Application ID",
                        "fillWith": [
                            "ApplicationId"
                        ],
                        "placeholder": "Deploy push connector to get the Application ID"
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "label": "Entra Application Secret",
                        "fillWith": [
                            "ApplicationSecret"
                        ],
                        "placeholder": "Deploy push connector to get the Application Secret"
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "label": "Use this value to configure the LogsIngestionURL parameter.",
                        "fillWith": [
                            "DataCollectionEndpoint"
                        ],
                        "placeholder": "Deploy push connector to get the DCE URI"
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "label": "DCR Immutable ID",
                        "fillWith": [
                            "DataCollectionRuleId"
                        ],
                        "placeholder": "Deploy push connector to get the DCR ID"
                    },
                    "type": "CopyableLabel"
                }
            ]
        }
    ],
    "metadata": {
        "id": "Pathlock_TDnR",
        "version": "3.0.0",
        "kind": "dataConnector",
        "source": {
            "kind": "solution",
            "name": "Pathlock Threat Detection and Response Integration for Microsoft Sentinel Solution for SAP"
        },
        "author": {
            "name": "Pathlock Inc.",
            "email": "support@pathlock.com"
        },
        "support": {
            "tier": "Partner",
            "name": "Pathlock Threat Detection and Response",
            "email": "support@pathlock.com",
            "link": "https://pathlock.com/support/"
        }
    }
}
