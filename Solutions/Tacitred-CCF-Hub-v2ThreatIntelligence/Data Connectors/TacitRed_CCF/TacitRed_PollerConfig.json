[
  {
    "name": "TacitRedFindings",
    "apiVersion": "2023-02-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "TacitRedThreatIntel",
      "dataType": "TacitRed_Findings_CL",
      "dcrConfig": {
        "streamName": "Custom-TacitRed_Findings_Raw",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{tacitRedDcrImmutableId}}"
      },
      "auth": {
        "type": "APIKey",
        "ApiKeyName": "Authorization",
        "ApiKey": "{{tacitRedApiKey}}"
      },
      "request": {
        "apiEndpoint": "https://app.tacitred.com/api/v1/findings",
        "httpMethod": "GET",
        "queryParameters": {
          "page_size": 50,
          "types[]": "compromised_credentials"
        },
        "queryWindowInMin": 5,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "startTimeAttributeName": "from",
        "endTimeAttributeName": "until",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Microsoft-Sentinel-TacitRed/1.0"
        }
      },
      "paging": {
        "pagingType": "LinkHeader",
        "linkHeaderTokenJsonPath": "$.next"
      },
      "response": {
        "eventsJsonPaths": ["$.results"],
        "format": "json"
      },
      "shouldJoinNestedData": true
    }
  }
]
