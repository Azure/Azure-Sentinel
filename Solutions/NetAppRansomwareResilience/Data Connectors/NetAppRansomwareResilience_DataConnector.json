{
    "id": "NetAppRansomwareResilienceCustomLogsIngestion",
    "title": "NetAppRansomwareResilience Data Connector",
    "publisher": "NetAppRansomwareResilience",
    "descriptionMarkdown": "Data connector for ingesting NetApp Ransomware Resilience alerts into Microsoft Sentinel. This connector enables seamless integration of Ransomware Resilience alerts, facilitating enhanced monitoring and response capabilities for ransomware threats within NetApp storage environments.",
    "additionalRequirementBanner": "You need to have an active NetApp Ransomware Resilience subscription and appropriate permissions to access Ransomware Resilience alert data.",
    "graphQueries": [
        {
            "metricName": "Total data received",
            "legend": "NetAppRansomwareResilience_alerts_CL",
            "baseQuery": "NetAppRansomwareResilience_alerts_CL"
        }
    ],
    "dataTypes": [
        {
            "name": "NetAppRansomwareResilience_alerts_CL",
            "lastDataReceivedQuery": "NetAppRansomwareResilience_alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
        }
    ],
    "sampleQueries": [
        {
            "description": "Default Query",
            "query": "NetAppRansomwareResilience_alerts_CL"
        }
    ],
    "connectivityCriterias": [
        {
            "type": "IsConnectedQuery",
            "value": [
                "NetAppRansomwareResilience_alerts_CL"
            ]
        }
    ],
    "availability": {
        "status": 1,
        "isPreview": true
    },
    "permissions": {
        "resourceProvider": [
            {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                    "write": true,
                    "read": true,
                    "delete": true
                }
            },
            {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                    "action": true
                }
            }
        ],
        "customs": [
            {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
            },
            {
                "name": "NetApp Console Organization",
                "description": "NetApp Console Organization with permissions to create a new Service Account"
            }
        ]
    },
    "instructionSteps": [
        {
            "title": "1. Configuration",
            "description": "You need to have an active NetApp Ransomware Resilience subscription and appropriate permissions to access Ransomware Resilience alert data."
        },
        {
            "title": "2. Deploy the ARM Template",
            "description": "Click the button below to deploy the NetApp Ransomware Resilience data connector using Azure Resource Manager template:\n\n[![Deployment Button](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FNetApp%2FAzure-Sentinel%2Frefs%2Fheads%2Fnetapp-rps%2FSolutions%2FNetAppRansomwareResilience%2FData%2520Connectors%2Fazuredeploy_rrs_dataconnector.json)"
        }
    ]
}