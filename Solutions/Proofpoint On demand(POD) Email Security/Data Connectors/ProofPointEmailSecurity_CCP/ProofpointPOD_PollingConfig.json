[
	{
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"apiVersion": "2021-10-01-preview",
		"name": "ProofpointPodMessageConnection",
		"location": "{{location}}",
		"kind": "WebSocket",
		"properties": {
			"connectorDefinitionName": "ProofpointCCPDefinition",
			"dataType": "ProofpointPODMessage_CL",
			"auth": {
				"type": "APIKey",
				"ApiKey": "{{apiKey}}",
				"apiKeyName": "Authorization",
				"apiKeyIdentifier": "Bearer"
			},
			"request": {
				"httpMethod": "Get",
				"apiEndpoint": "wss://logstream.proofpoint.com:443/v1/stream",
				"queryParameters": {
					"cid": "{{clusterId}}",
					"type": "message"
				},
				"rateLimitQPS": 20,
				"retryCount": 2,
				"timeoutInSeconds": 180,
				"logResponseContent": true,
				"websocket": {
					"enabled": true,
					"keepAlive": {
						"enabled": true,
						"intervalInSeconds": 120,
						"message": "ping"
					}
				}
			},
			"response": {
				"eventsJsonPaths": [
					"$"
				]
			},
			"dcrConfig": {
				"streamName": "Custom-ProofpointPodMessage",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			}
		}
	},
	{
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"apiVersion": "2021-10-01-preview",
		"name": "ProofpointPodMailLogConnection",
		"location": "{{location}}",
		"kind": "WebSocket",
		"properties": {
			"connectorDefinitionName": "ProofpointCCPDefinition",
			"dataType": "ProofpointPODMailLog_CL",
			"auth": {
				"type": "APIKey",
				"ApiKey": "{{apiKey}}",
				"apiKeyName": "Authorization",
				"apiKeyIdentifier": "Bearer"
			},
			"request": {
				"httpMethod": "Get",
				"apiEndpoint": "wss://logstream.proofpoint.com:443/v1/stream",
				"queryParameters": {
					"cid": "{{clusterId}}",
					"type": "maillog"
				},
				"rateLimitQPS": 20,
				"retryCount": 2,
				"timeoutInSeconds": 180,
				"logResponseContent": true,
				"websocket": {
					"enabled": true,
					"keepAlive": {
					"enabled": true,
						"intervalInSeconds": 120,
						"message": "ping"
					}
				}
			},
			"response": {
				"eventsJsonPaths": [
					"$"
				]
			},
			"dcrConfig": {
				"streamName": "Custom-ProofpointPodMailLog",
				"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
				"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			}
		}
	}
]