{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Varonis",
    "comments": "Solution template for Varonis Purview"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    }
  },
  "variables": {
    "_solutionName": "Varonis Purview",
    "_solutionVersion": "3.0.1",
    "solutionId": "varonis.varonispurview",
    "_solutionId": "[variables('solutionId')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "dataConnectorCCPVersion": "1.0.0",
    "_dataConnectorContentIdConnectorDefinition1": "VaronisPurviewPush",
    "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
    "_dataConnectorContentIdConnections1": "VaronisPurviewPushConnections",
    "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
    "blanks": "[replace('b', 'b', '')]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "displayName": "Varonis Purview Push Connector",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "VaronisPurviewPush",
                  "title": "Varonis Purview Push Connector",
                  "publisher": "Varonis",
                  "descriptionMarkdown": "The [Varonis Purview](https://www.varonis.com/) connector provides the capability to sync resources from Varonis to Microsoft Purview.",
                  "graphQueries": [
                    {
                      "metricName": "Telemetry",
                      "legend": "jamfprotecttelemetryv2_CL",
                      "baseQuery": "jamfprotecttelemetryv2_CL"
                    },
                    {
                      "metricName": "Unified Logs",
                      "legend": "jamfprotectunifiedlogs_CL",
                      "baseQuery": "jamfprotectunifiedlogs_CL"
                    },
                    {
                      "metricName": "Alerts",
                      "legend": "jamfprotectalerts_CL",
                      "baseQuery": "jamfprotectalerts_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Jamf Protect - All Alerts",
                      "query": "jamfprotectalerts_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Jamf Protect - All Telemetry events",
                      "query": "jamfprotecttelemetryv2_CL\n | sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "jamfprotecttelemetryv2_CL",
                      "lastDataReceivedQuery": "jamfprotecttelemetryv2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "jamfprotectunifiedlogs_CL",
                      "lastDataReceivedQuery": "jamfprotectunifiedlogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "jamfprotectalerts_CL",
                      "lastDataReceivedQuery": "jamfprotectalerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "jamfprotecttelemetryv2_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
                        "jamfprotectunifiedlogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
                        "jamfprotectalerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Microsoft Entra",
                        "description": "Permission to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
                      },
                      {
                        "name": "Microsoft Azure",
                        "description": "Permission to assign Monitoring Metrics Publisher role on data collection rule (DCR). Typically requires Azure RBAC Owner or User Access Administrator role"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "1. Create ARM Resources and Provide the Required Permissions",
                      "description": "This connector reads data from the tables that Jamf Protect uses in a Microsoft Analytics Workspace, if the [data forwarding](https://docs.jamf.com/jamf-protect/documentation/Data_Forwarding_to_a_Third_Party_Storage_Solution.html?hl=sentinel#task-4227) option is enabled in Jamf Protect then raw event data is sent to the Microsoft Sentinel Ingestion API.",
                      "instructions": [
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### Automated Configuration and Secure Data Ingestion with Entra Application \nClicking on \"Deploy\" will trigger the creation of Log Analytics tables and a Data Collection Rule (DCR). \nIt will then create an Entra application, link the DCR to it, and set the entered secret in the application. This setup enables data to be sent securely to the DCR using an Entra token."
                          }
                        },
                        {
                          "parameters": {
                            "label": "Deploy Jamf Protect connector resources",
                            "applicationDisplayName": "Jamf Protect Connector Application"
                          },
                          "type": "DeployPushConnectorButton"
                        }
                      ]
                    },
                    {
                      "title": "2. Push your logs into the workspace",
                      "description": "Use the following parameters to configure the your machine to send the logs to the workspace.",
                      "instructions": [
                        {
                          "parameters": {
                            "label": "Tenant ID (Directory ID)",
                            "fillWith": [
                              "TenantId"
                            ]
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Entra App Registration Application ID",
                            "fillWith": [
                              "ApplicationId"
                            ],
                            "placeholder": "Deploy push connector to get the App Registration Application ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Entra App Registration Secret",
                            "fillWith": [
                              "ApplicationSecret"
                            ],
                            "placeholder": "Deploy push connector to get the App Registration Secret"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Data Collection Endpoint Uri",
                            "fillWith": [
                              "DataCollectionEndpoint"
                            ],
                            "placeholder": "Deploy push connector to get the Data Collection Endpoint Uri"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Data Collection Rule Immutable ID",
                            "fillWith": [
                              "DataCollectionRuleId"
                            ],
                            "placeholder": "Deploy push connector to get the Data Collection Rule Immutable ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Unified Logs Stream Name",
                            "value": "Custom-jamfprotectunifiedlogs"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Telemetry Stream Name",
                            "value": "Custom-jamfprotecttelemetryv2"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "label": "Alerts Stream Name",
                            "value": "Custom-jamfprotectalerts"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Varonis"
                },
                "support": {
                  "name": "Varonis",
                  "email": "support@varonis.com",
                  "tier": "Partner",
                  "link": "https://www.varonis.com/resources/support"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "VaronisPurviewCustomDCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "streamDeclarations": {
                  "Custom-jamfprotecttelemetryv2": {
                    "columns": [
                      {
                        "name": "action",
                        "type": "dynamic"
                      },
                      {
                        "name": "action_type",
                        "type": "int"
                      },
                      {
                        "name": "deadline",
                        "type": "int"
                      },
                      {
                        "name": "event",
                        "type": "dynamic"
                      },
                      {
                        "name": "event_type",
                        "type": "int"
                      },
                      {
                        "name": "glob_seq_num",
                        "type": "int"
                      },
                      {
                        "name": "host",
                        "type": "dynamic"
                      },
                      {
                        "name": "mach_time",
                        "type": "long"
                      },
                      {
                        "name": "metadata",
                        "type": "dynamic"
                      },
                      {
                        "name": "process",
                        "type": "dynamic"
                      },
                      {
                        "name": "seq_num",
                        "type": "int"
                      },
                      {
                        "name": "thread",
                        "type": "dynamic"
                      },
                      {
                        "name": "time",
                        "type": "datetime"
                      },
                      {
                        "name": "uuid",
                        "type": "string"
                      },
                      {
                        "name": "version",
                        "type": "int"
                      }
                    ]
                  },
                  "Custom-jamfprotectunifiedlogs": {
                    "columns": [
                      {
                        "name": "TimeGenerated",
                        "type": "datetime"
                      },
                      {
                        "name": "caid",
                        "type": "string"
                      },
                      {
                        "name": "certid",
                        "type": "string"
                      },
                      {
                        "name": "input",
                        "type": "dynamic"
                      }
                    ]
                  },
                  "Custom-jamfprotectalerts": {
                    "columns": [
                      {
                        "name": "TimeGenerated",
                        "type": "datetime"
                      },
                      {
                        "name": "caid",
                        "type": "string"
                      },
                      {
                        "name": "certid",
                        "type": "string"
                      },
                      {
                        "name": "input",
                        "type": "dynamic"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-jamfprotecttelemetryv2"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\n//ASIM - Generic Fields\n| extend\n    EventVendor = metadata.vendor,\n    EventProduct = metadata.product,\n    EventSchemaVersion = metadata.schemaVersion,\n    EventProductVersion = host.protectVersion,\n    EventSeverity = \"Informational\",\n    //\n    // Jamf Protect - Device Hostnames\n    TargetHostname = host.hostname,\n    DvcHostname = host.hostname,\n    DvcSerial = host.serial,\n    DvcIpAddr = host.ips,\n    DvcId = host.provisioningUDID,\n    DvcOs = \"macOS\",\n    DvcOsVersion = host.os,\n    SrcDeviceType = \"Computer\"\n| project-rename\n    TimeGenerated = ['time'],\n    EventOriginalUid = uuid,\n    EventOriginalType = event_type,\n    EventCount = glob_seq_num\n| project-away\n    metadata,\n    host,\n    seq_num,\n    version,\n    deadline,\n    mach_time,\n    action_type\n\n",
                    "outputStream": "Custom-jamfprotecttelemetryv2_CL"
                  },
                  {
                    "streams": [
                      "Custom-jamfprotectunifiedlogs"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\n//ASIM - Generic Fields\n| extend\n    EventVendor = \"Jamf\",\n    EventProduct = \"Unified Log Stream\",\n    // EventSchemaVersion = metadata.schemaVersion,\n    EventProductVersion = input.host.protectVersion,\n    EventSeverity = case(input.match.severity == 0, \"Informational\", input.match.severity == 1, \"Low\", input.match.severity == 2, \"Medium\", input.match.severity == 3, \"High\", \"Informational\"),\n    EventOriginalType = input.eventType,\n    EventOriginalUid = input.match.uuid,\n    EventType = \"UnifiedLog\",\n    EventResult = case(input.match.actions has \"Prevented\", \"Prevented\", \"Allowed\"),\n    EventMessage = input.match.event.name,\n    EventResultMessage = input.match.event.composedMessage,\n    // EventReportUrl = strcat(\"https://\", context_identity_claims_hd_s, \".jamfcloud.com/Alerts/\", input.match.uuid),\n    //     //\n    //     // Jamf Protect - Device Hostnames\n    TargetHostname = input.host.hostname,\n    DvcHostname = input.host.hostname,\n    DvcSerial = input.host.serial,\n    DvcIpAddr = input.host.ips,\n    DvcId = input.host.provisioningUDID,\n    DvcOs = \"macOS\",\n    DvcOsVersion = input.host.os,\n    SrcDeviceType = \"Computer\",\n    // Jamf Protect - Event Details\n    //\n    // Jamf Protect Alerts - Process\n    //\n    ProcessEventType = \"Create\",\n    ProcessEventSubType = \"Exec\",\n    TargetProcessName = input.match.event.process,\n    TargetProcessId = input.match.event.processIdentifier,\n    TargetProcessGuid = input.match.event.uuid,\n    TargetProcessCommandLine = input.match.event.process.args,\n    TargetProcessCurrentDirectory = input.match.event.processImagePath\n| project-away\n    caid,\n    certid\n",
                    "outputStream": "Custom-jamfprotectunifiedlogs_CL"
                  },
                  {
                    "streams": [
                      "Custom-jamfprotectalerts"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\n//ASIM - Generic Fields \n| extend\n    EventVendor = \"Jamf\",\n    EventProduct = \"Alerts Stream\",\n    EventProductVersion = input.host.protectVersion,\n    EventSeverity = case(input.match.severity == 0, \"Informational\", input.match.severity == 1, \"Low\", input.match.severity == 2, \"Medium\", input.match.severity == 3, \"High\", \"Informational\"),\n    EventOriginalType = input.eventType,\n    EventOriginalUid = input.match.uuid,\n    EventType = case(input.eventType == \"GPClickEvent\", \"Click\", input.eventType == \"GPDownloadEvent\", \"Download\", input.eventType == \"GPFSEvent\", \"FileSystem\", input.eventType == \"GPProcessEvent\", \"Process\", input.eventType == \"GPKeylogRegisterEvent\", \"Keylog\", input.eventType == \"GPGatekeeperEvent\", \"Gatekeeper\", input.eventType == \"GPMRTEvent\", \"MRT\", input.eventType == \"GPPreventedExecutionEvent\", \"ProcessDenied\", input.eventType == \"GPThreatMatchExecEvent\", \"ProcessPrevented\", input.eventType == \"GPUnifiedLogEvent\", \"UnifiedLog\", input.eventType == \"GPUSBEvent\", \"USB\", input.eventType == \"auth-mount\", \"UsbBlock\", \"Unknown\"),\n    EventResult = case(input.match.actions has \"Prevented\", \"Prevented\", \"Allowed\"),\n    EventMessage = input.match.facts[0].name,\n    EventResultMessage = input.match.facts[0].human,\n    TargetHostname = input.host.hostname,\n    DvcHostname = input.host.hostname,\n    DvcSerial = input.host.serial,\n    DvcIpAddr = input.host.ips,\n    DvcId = input.host.provisioningUDID,\n    DvcOs = \"macOS\",\n    DvcOsVersion = input.host.os,\n    SrcDeviceType = \"Computer\",\n    ProcessEventType = case(input.match.event.type == 0, \"None\", input.match.event.type == 1, \"Create\", input.match.event.type == 2, \"Exit\", \"\"),\n    ProcessEventSubType = case(input.match.event.subType == 7, \"Exec\", input.match.event.subType == 1, \"Fork\", input.match.event.subType == 23, \"Execve\", input.match.event.subType == 43190, \"Posix Spawn\", \"\"),\n    ActingProcessName = input.related.processes[array_length(input.related.processes) - 1].path,\n    ActingProcessId = toint(input.related.processes[0].responsiblePID),\n    ActingProcessGuid = input.related.processes[array_length(input.related.processes) - 1].uuid,\n    ParentProcessName = iff(array_length(input.related.processes) > 1, tostring(input.related.processes[1].path), \"\"),\n    ParentProcessId = iff(array_length(input.related.processes) > 1, toint(input.related.processes[1].pid), int(null)),\n    ParentProcessGuid = iff(array_length(input.related.processes) > 1, tostring(input.related.processes[1].uuid), \"\"),\n    TargetProcessName = input.related.processes[0].name,\n    TargetProcessId = toint(input.related.processes[0].pid),\n    TargetProcessGuid = input.related.processes[0].uuid,\n    TargetProcessSHA1 = input.related.binaries[0].sha1hex,\n    TargetProcessSHA256 = input.related.binaries[0].sha256hex,\n    TargetProcessCommandLine = input.related.processes[0].args,\n    TargetProcessCurrentDirectory = input.related.processes[0].path,\n    TargetProcessStatusCode = input.related.processes[0].exitCode,\n    TargetFilePath = input.related.files[0].path,\n    TargetFileSHA1 = input.related.files[0].sha1hex,\n    TargetFileSHA256 = input.related.files[0].sha256hex,\n    TargetFileSize = input.related.files[0].size,\n    TargetFileSigningInfoMessage = input.related.files[0].signingInfo.statusMessage,\n    TargetFileSignerType = case(input.related.files[0].signingInfo.signerType == 0, \"Apple\", input.related.files[0].signingInfo.signerType == 1, \"App Store\", input.related.files[0].signingInfo.signerType == 2, \"Developer\", input.related.files[0].signingInfo.signerType == 3, \"Ad Hoc\", input.related.files[0].signingInfo.signerType == 4, \"Unsigned\", \"\"),\n    TargetFileSigningTeamID = input.related.files[0].signingInfo.teamid,\n    TargetFileIsDownload = tobool(input.related.files[0].isDownload),\n    TargetFileIsAppBundle = tobool(input.related.files[0].isAppBundle),\n    TargetFileIsDirectory = tobool(input.related.files[0].isDirectory),\n    TargetFileIsScreenshot = tobool(input.related.files[0].isScreenShot),\n    TargetFileExtendedAttributes = input.related.files[0].xattrs,\n    TargetBinaryFilePath = input.related.binaries[0].path,\n    TargetBinarySHA1 = input.related.binaries[0].sha1hex,\n    TargetBinarySHA256 = input.related.binaries[0].sha256hex,\n    TargetBinarySigningInfoMessage = input.related.binaries[0].signingInfo.statusMessage,\n    TargetbinarySignerType = case(input.related.binaries[0].signingInfo.signerType == 0, \"Apple\", input.related.binaries[0].signingInfo.signerType == 1, \"App Store\", input.related.binaries[0].signingInfo.signerType == 2, \"Developer\", input.related.binaries[0].signingInfo.signerType == 3, \"Ad Hoc\", input.related.binaries[0].signingInfo.signerType == 4, \"Unsigned\", \"\"),\n    TargetBinarySigningTeamID = input.related.binaries[0].signingInfo.teamid,\n    TargetBinarySigningAppID = input.related.binaries[0].signingInfo.appid\n| project-away caid, certid\n\n",
                    "outputStream": "Custom-jamfprotectalerts_CL"
                  }
                ],
                "dataCollectionEndpointId": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]"
              }
            },
            {
              "name": "jamfprotecttelemetryv2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "plan": "Analytics",
                "schema": {
                  "name": "jamfprotecttelemetryv2_CL",
                  "columns": [
                    {
                      "name": "action",
                      "type": "dynamic"
                    },
                    {
                      "name": "event",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventOriginalType",
                      "type": "int"
                    },
                    {
                      "name": "EventCount",
                      "type": "int"
                    },
                    {
                      "name": "process",
                      "type": "dynamic"
                    },
                    {
                      "name": "thread",
                      "type": "dynamic"
                    },
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "EventOriginalUid",
                      "type": "string"
                    },
                    {
                      "name": "EventVendor",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventProduct",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventSchemaVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventProductVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventSeverity",
                      "type": "string"
                    },
                    {
                      "name": "TargetHostname",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcHostname",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcSerial",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcIpAddr",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcId",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcOs",
                      "type": "string"
                    },
                    {
                      "name": "DvcOsVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "SrcDeviceType",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "jamfprotectalerts_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "plan": "Analytics",
                "schema": {
                  "name": "jamfprotectalerts_CL",
                  "columns": [
                    {
                      "name": "input",
                      "type": "dynamic"
                    },
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "EventVendor",
                      "type": "string"
                    },
                    {
                      "name": "EventProduct",
                      "type": "string"
                    },
                    {
                      "name": "EventProductVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventSeverity",
                      "type": "string"
                    },
                    {
                      "name": "EventOriginalType",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventOriginalUid",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventType",
                      "type": "string"
                    },
                    {
                      "name": "EventResult",
                      "type": "string"
                    },
                    {
                      "name": "EventMessage",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventResultMessage",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetHostname",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcHostname",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcSerial",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcIpAddr",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcId",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcOs",
                      "type": "string"
                    },
                    {
                      "name": "DvcOsVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "SrcDeviceType",
                      "type": "string"
                    },
                    {
                      "name": "ProcessEventType",
                      "type": "string"
                    },
                    {
                      "name": "ProcessEventSubType",
                      "type": "string"
                    },
                    {
                      "name": "ActingProcessName",
                      "type": "dynamic"
                    },
                    {
                      "name": "ActingProcessId",
                      "type": "int"
                    },
                    {
                      "name": "ActingProcessGuid",
                      "type": "dynamic"
                    },
                    {
                      "name": "ParentProcessName",
                      "type": "dynamic"
                    },
                    {
                      "name": "ParentProcessId",
                      "type": "int"
                    },
                    {
                      "name": "ParentProcessGuid",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessName",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessId",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessGuid",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessSHA1",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessSHA256",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessCommandLine",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessCurrentDirectory",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessStatusCode",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFilePath",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFileSHA1",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFileSHA256",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFileSize",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFileSigningInfoMessage",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFileSignerType",
                      "type": "string"
                    },
                    {
                      "name": "TargetFileSigningTeamID",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetFileIsDownload",
                      "type": "boolean"
                    },
                    {
                      "name": "TargetFileIsAppBundle",
                      "type": "boolean"
                    },
                    {
                      "name": "TargetFileIsDirectory",
                      "type": "boolean"
                    },
                    {
                      "name": "TargetFileIsScreenshot",
                      "type": "boolean"
                    },
                    {
                      "name": "TargetFileExtendedAttributes",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetBinaryFilePath",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetBinarySHA1",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetBinarySHA256",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetBinarySigningInfoMessage",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetbinarySignerType",
                      "type": "string"
                    },
                    {
                      "name": "TargetBinarySigningTeamID",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetBinarySigningAppID",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "jamfprotectunifiedlogs_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "plan": "Analytics",
                "schema": {
                  "name": "jamfprotectunifiedlogs_CL",
                  "columns": [
                    {
                      "name": "input",
                      "type": "dynamic"
                    },
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "EventProductVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventSeverity",
                      "type": "string"
                    },
                    {
                      "name": "EventOriginalType",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventOriginalUid",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventType",
                      "type": "string"
                    },
                    {
                      "name": "EventResult",
                      "type": "string"
                    },
                    {
                      "name": "EventMessage",
                      "type": "dynamic"
                    },
                    {
                      "name": "EventResultMessage",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetHostname",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcHostname",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcSerial",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcIpAddr",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcId",
                      "type": "dynamic"
                    },
                    {
                      "name": "DvcOs",
                      "type": "string"
                    },
                    {
                      "name": "DvcOsVersion",
                      "type": "dynamic"
                    },
                    {
                      "name": "SrcDeviceType",
                      "type": "string"
                    },
                    {
                      "name": "ProcessEventType",
                      "type": "string"
                    },
                    {
                      "name": "ProcessEventSubType",
                      "type": "string"
                    },
                    {
                      "name": "TargetProcessName",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessId",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessGuid",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessCommandLine",
                      "type": "dynamic"
                    },
                    {
                      "name": "TargetProcessCurrentDirectory",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "VaronisPurviewPush",
          "title": "Varonis Purview Push Connector",
          "publisher": "Varonis",
          "descriptionMarkdown": "The [Varonis Purview](https://www.varonis.com/) connector provides the capability to sync resources from Varonis to Microsoft Purview.",
          "graphQueries": [
            {
              "metricName": "Telemetry",
              "legend": "jamfprotecttelemetryv2_CL",
              "baseQuery": "jamfprotecttelemetryv2_CL"
            },
            {
              "metricName": "Unified Logs",
              "legend": "jamfprotectunifiedlogs_CL",
              "baseQuery": "jamfprotectunifiedlogs_CL"
            },
            {
              "metricName": "Alerts",
              "legend": "jamfprotectalerts_CL",
              "baseQuery": "jamfprotectalerts_CL"
            }
          ],
          "sampleQueries": [
            {
              "description": "Jamf Protect - All Alerts",
              "query": "jamfprotectalerts_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Jamf Protect - All Telemetry events",
              "query": "jamfprotecttelemetryv2_CL\n | sort by TimeGenerated desc"
            }
          ],
          "dataTypes": [
            {
              "name": "jamfprotecttelemetryv2_CL",
              "lastDataReceivedQuery": "jamfprotecttelemetryv2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "jamfprotectunifiedlogs_CL",
              "lastDataReceivedQuery": "jamfprotectunifiedlogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "jamfprotectalerts_CL",
              "lastDataReceivedQuery": "jamfprotectalerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "jamfprotecttelemetryv2_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
                "jamfprotectunifiedlogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
                "jamfprotectalerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
              ]
            }
          ],
          "availability": {
            "status": 1
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              }
            ],
            "customs": [
              {
                "name": "Microsoft Entra",
                "description": "Permission to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
              },
              {
                "name": "Microsoft Azure",
                "description": "Permission to assign Monitoring Metrics Publisher role on data collection rule (DCR). Typically requires Azure RBAC Owner or User Access Administrator role"
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "1. Create ARM Resources and Provide the Required Permissions",
              "description": "This connector reads data from the tables that Jamf Protect uses in a Microsoft Analytics Workspace, if the [data forwarding](https://docs.jamf.com/jamf-protect/documentation/Data_Forwarding_to_a_Third_Party_Storage_Solution.html?hl=sentinel#task-4227) option is enabled in Jamf Protect then raw event data is sent to the Microsoft Sentinel Ingestion API.",
              "instructions": [
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### Automated Configuration and Secure Data Ingestion with Entra Application \nClicking on \"Deploy\" will trigger the creation of Log Analytics tables and a Data Collection Rule (DCR). \nIt will then create an Entra application, link the DCR to it, and set the entered secret in the application. This setup enables data to be sent securely to the DCR using an Entra token."
                  }
                },
                {
                  "parameters": {
                    "label": "Deploy Jamf Protect connector resources",
                    "applicationDisplayName": "Jamf Protect Connector Application"
                  },
                  "type": "DeployPushConnectorButton"
                }
              ]
            },
            {
              "title": "2. Push your logs into the workspace",
              "description": "Use the following parameters to configure the your machine to send the logs to the workspace.",
              "instructions": [
                {
                  "parameters": {
                    "label": "Tenant ID (Directory ID)",
                    "fillWith": [
                      "TenantId"
                    ]
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Entra App Registration Application ID",
                    "fillWith": [
                      "ApplicationId"
                    ],
                    "placeholder": "Deploy push connector to get the App Registration Application ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Entra App Registration Secret",
                    "fillWith": [
                      "ApplicationSecret"
                    ],
                    "placeholder": "Deploy push connector to get the App Registration Secret"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Data Collection Endpoint Uri",
                    "fillWith": [
                      "DataCollectionEndpoint"
                    ],
                    "placeholder": "Deploy push connector to get the Data Collection Endpoint Uri"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Data Collection Rule Immutable ID",
                    "fillWith": [
                      "DataCollectionRuleId"
                    ],
                    "placeholder": "Deploy push connector to get the Data Collection Rule Immutable ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Unified Logs Stream Name",
                    "value": "Custom-jamfprotectunifiedlogs"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Telemetry Stream Name",
                    "value": "Custom-jamfprotecttelemetryv2"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "label": "Alerts Stream Name",
                    "value": "Custom-jamfprotectalerts"
                  },
                  "type": "CopyableLabel"
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Varonis"
        },
        "support": {
          "name": "Varonis",
          "email": "support@varonis.com",
          "tier": "Partner",
          "link": "https://www.varonis.com/resources/support"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
        "displayName": "Varonis Purview Push Connector",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "auth": {
              "type": "object",
              "defaultValue": {
                "appId": "[[parameters('auth').appId]]",
                "servicePrincipalId": "[[parameters('auth').servicePrincipalId]]"
              }
            },
            "connectorDefinitionName": {
              "defaultValue": "Varonis Purview Push Connector",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections1": "[variables('_dataConnectorContentIdConnections1')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Varonis"
                },
                "support": {
                  "name": "Varonis",
                  "email": "support@varonis.com",
                  "tier": "Partner",
                  "link": "https://www.varonis.com/resources/support"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'VaronisPurviewConnector', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "Push",
              "properties": {
                "connectorDefinitionName": "VaronisPurviewPush",
                "dcrConfig": {
                  "streamName": "Custom-jamfprotecttelemetryv2",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "Push",
                  "AppId": "[[parameters('auth').appId]",
                  "ServicePrincipalId": "[[parameters('auth').servicePrincipalId]"
                },
                "request": {
                  "RetryCount": 1
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.messages"
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.1",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Varonis Purview",
        "publisherDisplayName": "Varonis",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Varonis%20Purview/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>Varonis Data Security SaaS Platform: Automatically find your critical data, remediate risk, and stop threats before your data can be compromised.</p>\n<p><strong>Data Connectors:</strong> 1</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/VaronisLogo.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Varonis Purview",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Varonis"
        },
        "support": {
          "name": "Varonis",
          "email": "support@varonis.com",
          "tier": "Partner",
          "link": "https://www.varonis.com/resources/support"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            }
          ]
        },
        "firstPublishDate": "2025-10-27",
        "lastPublishDate": "2025-10-01",
        "providers": [
          "Varonis"
        ],
        "categories": {
          "domains": [
            "Security -  Data Protection"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
