id: 06c97d41-652a-4ff0-9bf5-dca775126fff
Function:
  Title: Parser for Mimecast Awareness Training Safe Score
  Version: '1.0.1'
  LastUpdated: '2025-10-17'
Category: Microsoft Sentinel Parser
FunctionName: AwarenessSafeScore
FunctionAlias: AwarenessSafeScore
FunctionQuery: |
    let dummy_table = datatable(TimeGenerated: datetime) [];
    let Awareness_Safe_Score_view = view() {
        union isfuzzy=true
            dummy_table,
            Awareness_SafeScore_Details_CL
        | extend
            ["Email Address"] = column_ifexists('emailAddress', ''),
            ["Name"] = column_ifexists('name', ''),
            ["Risk"] = column_ifexists('risk', ''),
            ["Human Error"]= column_ifexists('humanError', ''),
            ["Sentiment"] = column_ifexists('sentiment', ''),
            ["Engagement"] = column_ifexists('engagement', ''),
            ["Knowledge"] = column_ifexists('knowledge', ''),
            ["User State"] = column_ifexists('userState', ''),
            ["Department"] = column_ifexists('department', ''),
            ["Time Generated"] = column_ifexists('TimeGenerated', '')
        | summarize arg_max(["Time Generated"], *)
            by
            ["Email Address"],
            ["Name"],
            ["Risk"],
            ["Human Error"],
            ["Sentiment"],
            ["Engagement"],
            ["Knowledge"],
            ["User State"],
            ["Department"] 
        | project
            ["Email Address"],
            ["Name"],
            ["Risk"],
            ["Human Error"],
            ["Sentiment"],
            ["Engagement"],
            ["Knowledge"],
            ["User State"],
            ["Department"] 
    };
    Awareness_Safe_Score_view