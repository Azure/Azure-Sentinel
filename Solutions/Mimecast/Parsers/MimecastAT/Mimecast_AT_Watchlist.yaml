id: 7afbe4ec-9fa1-429d-9a25-6c3f0519330e
Function:
  Title: Parser for Mimecast Awareness Training Watchlist
  Version: '1.0.1'
  LastUpdated: '2025-10-17'
Category: Microsoft Sentinel Parser
FunctionName: AwarenessWatchlist
FunctionAlias: AwarenessWatchlist
FunctionQuery: |
    let dummy_table = datatable(TimeGenerated: datetime) [];
    let Awareness_Watchlist_view = view() {
        union isfuzzy=true
            dummy_table,
            Awareness_Watchlist_Details_CL
        | extend
            ["Email"]= column_ifexists('email', ''),
            ["Name"] = column_ifexists('name', ''),
            ["Watchlist Count"] = column_ifexists('watchlistCount', 0),
            ["User State"] = column_ifexists('userState', ''),
            ["User ID"] = column_ifexists('userId', ''),
            ["Department"] = column_ifexists('department', ''),
            ["Time Generated"] = column_ifexists('Time Generated', '')
        | summarize arg_max(["Time Generated"], *) by  ["Email"], ["Name"], ["Watchlist Count"], ["User State"], ["User ID"], ["Department"]
        | project
            ["Time Generated"],
            ["Email"],
            ["Name"],
            ["Watchlist Count"],
            ["User State"],
            ["User ID"],
            ["Department"]
    };
    Awareness_Watchlist_view

