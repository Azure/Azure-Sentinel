id: bf754aad-692b-46cd-b5b4-6f044bd105a4
Function:
  Title: Parser for Mimecast Awareness Training User Data
  Version: '1.0.1'
  LastUpdated: '2025-10-17'
Category: Microsoft Sentinel Parser
FunctionName: AwarenessUserData
FunctionAlias: AwarenessUserData
FunctionQuery: |
    let dummy_table = datatable(TimeGenerated: datetime) [];
    let Awareness_User_Data_view = view() {
        union isfuzzy=true
            dummy_table,
            Awareness_User_Data_CL
        | extend
            ["Time Generated"] = column_ifexists('TimeGenerated', ''),
            ["Time Reported"] = column_ifexists('timeReported', ''),
            ["Name"] = column_ifexists('name', ''),
            ["Email"] = column_ifexists('email', ''),
            ["Template Name"] = column_ifexists('templateName', ''),
            ["Status"] = column_ifexists('status', ''),
            ["Num of Campaigns Clicked"] = column_ifexists('numCampaignsClicked', ''),
            ["Num of Campaigns Sent"] = column_ifexists('numCampaignsSent', ''),
            ["Num of Correct Answers"] = column_ifexists('numCorrectAnswers', ''),
            ["Num of Training Modules Assigned"] = column_ifexists('numTrainingModulesAssigned', ''),
            ["Num of Incorrect Answers"] = column_ifexists('numIncorrectAnswers', ''),
            ["User State"] = column_ifexists('userState', ''),
            ["Clicked IP"] = column_ifexists('clickedIp', ''),
            ["Reaction Time"] = column_ifexists('reactionTime', ''),
            ["Time Opened"] = column_ifexists('timeOpened', ''),
            ["Department"] = column_ifexists('department', ''),
            ["Time Scheduled"] = column_ifexists('timeScheduled', ''),
            ["Time Clicked"] = column_ifexists('timeClicked', ''),
            ["Num of Campaigns Scanned"] = column_ifexists('numCampaignsScanned', ''),
            ["Num of Campaigns Clicked Scanned"] = column_ifexists('numCampaignsClickedScanned', ''),
            ["Time Scanned"] = column_ifexists('timeScanned', ''),
            ["Time Submitted"] = column_ifexists('timeSubmitted', ''),
            Items = column_ifexists('items', '')
        | summarize arg_max(["Time Generated"], *)
            by
            ["Time Reported"],
            ["Name"],
            ["Email"],
            ["Template Name"],
            ["Status"],
            ["Num of Campaigns Clicked"],
            ["Num of Campaigns Sent"],
            ["Num of Correct Answers"],
            ["Num of Training Modules Assigned"],
            ["Num of Incorrect Answers"],
            ["User State"],
            ["Clicked IP"],
            ["Reaction Time"],
            ["Time Opened"],
            ["Time Clicked"],
            ["Time Scheduled"],
            ["Department"],
            ["Num of Campaigns Scanned"],
            ["Num of Campaigns Clicked Scanned"],
            ["Time Scanned"],
            ["Time Submitted"],
            Items
        | project
            ["Time Reported"],
            ["Name"],
            ["Email"],
            ["Template Name"],
            ["Status"],
            ["Num of Campaigns Clicked"],
            ["Num of Campaigns Sent"],
            ["Num of Correct Answers"],
            ["Num of Training Modules Assigned"],
            ["Num of Incorrect Answers"],
            ["User State"],
            ["Clicked IP"],
            ["Reaction Time"],
            ["Time Opened"],
            ["Time Clicked"],
            ["Time Scheduled"],
            ["Department"],
            ["Num of Campaigns Scanned"],
            ["Num of Campaigns Clicked Scanned"],
            ["Time Scanned"],
            ["Time Submitted"],
            Items
    };
    Awareness_User_Data_view