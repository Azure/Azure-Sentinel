id: aea16729-fdd1-43aa-84bd-9127c0c53d03
Function:
  Title: Parser for Mimecast TTP ATTACHMENT
  Version: "1.0.1"
  LastUpdated: "2025-10-17"
Category: Microsoft Sentinel Parser
FunctionName: MimecastTTPAttachment
FunctionAlias: MimecastTTPAttachment
FunctionQuery: |
  let dummy_table = datatable(
    TimeGenerated: datetime,
    senderAddress: string,
    recipientAddress: string,
    messageId: string
  ) [];
  let MimecastTTPAttachment = view() {
      union isfuzzy=true
          dummy_table,
          Ttp_Attachment_CL
      | summarize arg_max(TimeGenerated, *) by senderAddress, recipientAddress, messageId
      | extend
          ["Time Generated"]  = column_ifexists('TimeGenerated', ''),
          ["Type"] = column_ifexists('Type', ''),
          ["Mimecast Event ID"] = 'ttp_attachment',
          ["Mimecast Event Category"] = 'ttp_attachment',
          ["Action Triggered"] = column_ifexists('actionTriggered', ''),
          ["Event Time"]  = column_ifexists('Date', ''),
          ["Definition"] = column_ifexists('definition', ''),
          ["Details"] = column_ifexists('details', ''),
          ["File Hash"] = column_ifexists('fileHash', ''),
          ["File Name"] = column_ifexists('fileName', ''),
          ["File Type"] = column_ifexists('fileType', ''),
          ["Message ID"] = column_ifexists('messageId', ''),
          ["Recipient Address"] = column_ifexists('recipientAddress', ''),
          ["Result"] = column_ifexists('result', ''),
          ["Route"] = column_ifexists('route', ''),
          ["Sender Address"] = column_ifexists('senderAddress', ''),
          ["Subject"] = column_ifexists('subject', '')
      | extend ['Event Time'] = iff(isempty(['Event Time']), now(), todatetime((["Event Time"])))
      | project
          ["Time Generated"],
          ["Type"],
          ["Mimecast Event ID"],
          ["Mimecast Event Category"],
          ["Action Triggered"],
          ["Event Time"],
          ["Definition"],
          ["Details"],
          ["File Hash"],
          ["File Name"],
          ["File Type"],
          ["Message ID"],
          ["Recipient Address"],
          ["Result"],
          ["Route"],
          ["Sender Address"],
          ["Subject"] 
  };
  MimecastTTPAttachment