id: c78aaea4-8a16-4e8b-9722-073e7181efd1
Function:
  Title: Parser for Mimecast Cloud Integrated
  Version: "1.0.1"
  LastUpdated: "2025-10-23"
Category: Microsoft Sentinel Parser
FunctionName: MimecastCloudIntegrated
FunctionAlias: MimecastCloudIntegrated
FunctionQuery: |
  let dummy_table = datatable(TimeGenerated: datetime) [];
  let MimecastCloudIntegrated = view() {
  union isfuzzy=true dummy_table,
  Cloud_Integrated_CL
  | extend Category = column_ifexists('category', ''),
      ["Time Generated"] = column_ifexists('TimeGenerated', ''),
      ["Event Time"] = column_ifexists('timestamp', ''),
      ['Account ID'] = column_ifexists('accountId', ''),
      ['Aggregate ID']  = column_ifexists('aggregateId', ''),
      ['Processing ID']  = column_ifexists('processingId', ''),
      ['Message ID']  = column_ifexists('messageId', ''),
      ["Attachments"] = column_ifexists('attachments', ''),
      ["Recipients"] = column_ifexists('recipients', ''),
      ["Tags"] = column_ifexists('tags', ''),
      ['Policies Applied']  = column_ifexists('policiesApplied', ''),
      ['Historical Mail']  = column_ifexists('historicalMail', ''),
      ['Sender IP']  = column_ifexists('senderIp', ''),
      ['Sender Envelope']  = column_ifexists('senderEnvelope', ''),
      ["Subject"]= column_ifexists('subject', ''),
      ["Source"] = column_ifexists('source', ''),
      ['Threat State'] = column_ifexists('threatState', ''),
      ['Threat Type']  = column_ifexists('threatType', ''),
      ["Direction"] = column_ifexists('direction', ''),
      ['Sender Header'] = column_ifexists('senderHeader', ''),
      ["Type"]  = column_ifexists('type_', ''),
      ["Subtype"]  = column_ifexists('subtype', '')
  |  summarize arg_max(["Time Generated"] , *) by ["Event Time"],
        ["Type"],
        ['Account ID'],
        ['Aggregate ID'],
        ['Processing ID'],
        ['Message ID'],
        ["Attachments"],
        ["Recipients"],
        ["Tags"],
        ['Policies Applied'],
        ['Historical Mail'],
        ['Sender IP'],
        ['Sender Envelope'],
        ["Subject"],
        ["Source"],
        ['Threat State'],
        ['Threat Type'],
        ["Direction"],
        ['Sender Header'],
        ["Subtype"]
  | extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(unixtime_milliseconds_todatetime( tolong(["Event Time"])) )  )
  | project   ["Event Time"] ,
        ["Time Generated"],
        ['Account ID'],
        ['Aggregate ID'],
        ['Processing ID'],
        ['Message ID'],
        ["Attachments"],
        ["Recipients"],
        ["Tags"],
        ['Policies Applied'],
        ['Historical Mail'],
        ['Sender IP'],
        ['Sender Envelope'],
        ["Subject"],
        ["Source"],
        ['Threat State'],
        ['Threat Type'],
        ["Direction"],
        ['Sender Header'],
        ["Type"],
        ["Subtype"]
  };
  MimecastCloudIntegrated