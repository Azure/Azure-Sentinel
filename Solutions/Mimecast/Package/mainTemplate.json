{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Mimecast - dlapi@mimecast.com",
    "comments": "Solution template for Mimecast"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Mimecast Audit Workbook",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook2-name": {
      "type": "string",
      "defaultValue": "Mimecast Awareness Training Workbook",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook3-name": {
      "type": "string",
      "defaultValue": "Mimecast Cloud Integrated Workbook",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook4-name": {
      "type": "string",
      "defaultValue": "Mimecast Secure Email Gateway Workbook",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook5-name": {
      "type": "string",
      "defaultValue": "Mimecast Targeted Threat Protection Workbook",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "email": "dlapi@mimecast.com",
    "_email": "[variables('email')]",
    "_solutionName": "Mimecast",
    "_solutionVersion": "3.0.0",
    "solutionId": "mimecast.azure-sentinel-solution-mimecast",
    "_solutionId": "[variables('solutionId')]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.0",
      "_analyticRulecontentId1": "617a55be-a8d8-49c1-8687-d19a0231056f",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '617a55be-a8d8-49c1-8687-d19a0231056f')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('617a55be-a8d8-49c1-8687-d19a0231056f')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','617a55be-a8d8-49c1-8687-d19a0231056f','-', '1.0.0')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.0.0",
      "_analyticRulecontentId2": "c048fa06-0d50-4626-ae82-a6cea812d9c4",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c048fa06-0d50-4626-ae82-a6cea812d9c4')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c048fa06-0d50-4626-ae82-a6cea812d9c4')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c048fa06-0d50-4626-ae82-a6cea812d9c4','-', '1.0.0')))]"
    },
    "analyticRuleObject3": {
      "analyticRuleVersion3": "1.0.0",
      "_analyticRulecontentId3": "952faed4-c6a6-4873-aeb9-b348e9ce5aba",
      "analyticRuleId3": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '952faed4-c6a6-4873-aeb9-b348e9ce5aba')]",
      "analyticRuleTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('952faed4-c6a6-4873-aeb9-b348e9ce5aba')))]",
      "_analyticRulecontentProductId3": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','952faed4-c6a6-4873-aeb9-b348e9ce5aba','-', '1.0.0')))]"
    },
    "analyticRuleObject4": {
      "analyticRuleVersion4": "1.0.0",
      "_analyticRulecontentId4": "f00197ab-491f-41e7-9e22-a7003a4c1e54",
      "analyticRuleId4": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'f00197ab-491f-41e7-9e22-a7003a4c1e54')]",
      "analyticRuleTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('f00197ab-491f-41e7-9e22-a7003a4c1e54')))]",
      "_analyticRulecontentProductId4": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','f00197ab-491f-41e7-9e22-a7003a4c1e54','-', '1.0.0')))]"
    },
    "analyticRuleObject5": {
      "analyticRuleVersion5": "1.0.0",
      "_analyticRulecontentId5": "72bd7b0c-493c-4fa5-8a95-7f6376b6cfb2",
      "analyticRuleId5": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '72bd7b0c-493c-4fa5-8a95-7f6376b6cfb2')]",
      "analyticRuleTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('72bd7b0c-493c-4fa5-8a95-7f6376b6cfb2')))]",
      "_analyticRulecontentProductId5": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','72bd7b0c-493c-4fa5-8a95-7f6376b6cfb2','-', '1.0.0')))]"
    },
    "analyticRuleObject6": {
      "analyticRuleVersion6": "1.0.0",
      "_analyticRulecontentId6": "33bf0cc9-e568-42bf-9571-c22adf7be66d",
      "analyticRuleId6": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '33bf0cc9-e568-42bf-9571-c22adf7be66d')]",
      "analyticRuleTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('33bf0cc9-e568-42bf-9571-c22adf7be66d')))]",
      "_analyticRulecontentProductId6": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','33bf0cc9-e568-42bf-9571-c22adf7be66d','-', '1.0.0')))]"
    },
    "analyticRuleObject7": {
      "analyticRuleVersion7": "1.0.0",
      "_analyticRulecontentId7": "2ef77cef-439f-4d94-848f-3eca67510d2f",
      "analyticRuleId7": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '2ef77cef-439f-4d94-848f-3eca67510d2f')]",
      "analyticRuleTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('2ef77cef-439f-4d94-848f-3eca67510d2f')))]",
      "_analyticRulecontentProductId7": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','2ef77cef-439f-4d94-848f-3eca67510d2f','-', '1.0.0')))]"
    },
    "analyticRuleObject8": {
      "analyticRuleVersion8": "1.0.0",
      "_analyticRulecontentId8": "d3bd7640-3600-49f9-8d10-6fe312e68b4f",
      "analyticRuleId8": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd3bd7640-3600-49f9-8d10-6fe312e68b4f')]",
      "analyticRuleTemplateSpecName8": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d3bd7640-3600-49f9-8d10-6fe312e68b4f')))]",
      "_analyticRulecontentProductId8": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d3bd7640-3600-49f9-8d10-6fe312e68b4f','-', '1.0.0')))]"
    },
    "analyticRuleObject9": {
      "analyticRuleVersion9": "1.0.0",
      "_analyticRulecontentId9": "0cda82c8-e8f0-4117-896e-a10f1b43e64a",
      "analyticRuleId9": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '0cda82c8-e8f0-4117-896e-a10f1b43e64a')]",
      "analyticRuleTemplateSpecName9": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('0cda82c8-e8f0-4117-896e-a10f1b43e64a')))]",
      "_analyticRulecontentProductId9": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','0cda82c8-e8f0-4117-896e-a10f1b43e64a','-', '1.0.0')))]"
    },
    "analyticRuleObject10": {
      "analyticRuleVersion10": "1.0.0",
      "_analyticRulecontentId10": "80f244cd-b0d6-404e-9aed-37f7a66eda9f",
      "analyticRuleId10": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '80f244cd-b0d6-404e-9aed-37f7a66eda9f')]",
      "analyticRuleTemplateSpecName10": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('80f244cd-b0d6-404e-9aed-37f7a66eda9f')))]",
      "_analyticRulecontentProductId10": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','80f244cd-b0d6-404e-9aed-37f7a66eda9f','-', '1.0.0')))]"
    },
    "analyticRuleObject11": {
      "analyticRuleVersion11": "1.0.0",
      "_analyticRulecontentId11": "d78d7352-fa5a-47d4-b48f-cb2c3252c0eb",
      "analyticRuleId11": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd78d7352-fa5a-47d4-b48f-cb2c3252c0eb')]",
      "analyticRuleTemplateSpecName11": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d78d7352-fa5a-47d4-b48f-cb2c3252c0eb')))]",
      "_analyticRulecontentProductId11": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d78d7352-fa5a-47d4-b48f-cb2c3252c0eb','-', '1.0.0')))]"
    },
    "analyticRuleObject12": {
      "analyticRuleVersion12": "1.0.0",
      "_analyticRulecontentId12": "8e52bcf1-4f50-4c39-8678-d9efad64e379",
      "analyticRuleId12": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '8e52bcf1-4f50-4c39-8678-d9efad64e379')]",
      "analyticRuleTemplateSpecName12": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('8e52bcf1-4f50-4c39-8678-d9efad64e379')))]",
      "_analyticRulecontentProductId12": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','8e52bcf1-4f50-4c39-8678-d9efad64e379','-', '1.0.0')))]"
    },
    "analyticRuleObject13": {
      "analyticRuleVersion13": "1.0.0",
      "_analyticRulecontentId13": "cfd67598-ad0d-430a-a793-027eb4dbe967",
      "analyticRuleId13": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'cfd67598-ad0d-430a-a793-027eb4dbe967')]",
      "analyticRuleTemplateSpecName13": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('cfd67598-ad0d-430a-a793-027eb4dbe967')))]",
      "_analyticRulecontentProductId13": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','cfd67598-ad0d-430a-a793-027eb4dbe967','-', '1.0.0')))]"
    },
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "Mimecast_Audit_Workbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "workbookVersion2": "1.0.0",
    "workbookContentId2": "Mimecast_Awareness_Training_Workbook",
    "workbookId2": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId2'))]",
    "workbookTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId2'))))]",
    "_workbookContentId2": "[variables('workbookContentId2')]",
    "_workbookcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId2'),'-', variables('workbookVersion2'))))]",
    "workbookVersion3": "1.0.0",
    "workbookContentId3": "Mimecast_Cloud_Integrated_Workbook",
    "workbookId3": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId3'))]",
    "workbookTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId3'))))]",
    "_workbookContentId3": "[variables('workbookContentId3')]",
    "_workbookcontentProductId3": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId3'),'-', variables('workbookVersion3'))))]",
    "workbookVersion4": "1.0.0",
    "workbookContentId4": "Mimecast_SEG_Workbook",
    "workbookId4": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId4'))]",
    "workbookTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId4'))))]",
    "_workbookContentId4": "[variables('workbookContentId4')]",
    "_workbookcontentProductId4": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId4'),'-', variables('workbookVersion4'))))]",
    "workbookVersion5": "1.0.0",
    "workbookContentId5": "Mimecast_TTP_Workbook",
    "workbookId5": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId5'))]",
    "workbookTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId5'))))]",
    "_workbookContentId5": "[variables('workbookContentId5')]",
    "_workbookcontentProductId5": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId5'),'-', variables('workbookVersion5'))))]",
    "Mimecast Data Connector Trigger Sync": "Mimecast Data Connector Trigger Sync",
    "_Mimecast Data Connector Trigger Sync": "[variables('Mimecast Data Connector Trigger Sync')]",
    "TemplateEmptyArray": "[json('[]')]",
    "playbookVersion1": "1.0",
    "playbookContentId1": "Mimecast Data Connector Trigger Sync",
    "_playbookContentId1": "[variables('playbookContentId1')]",
    "playbookId1": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId1'))]",
    "playbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId1'))))]",
    "_playbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId1'),'-', variables('playbookVersion1'))))]",
    "blanks": "[replace('b', 'b', '')]",
    "parserObject1": {
      "_parserName1": "[concat(parameters('workspace'),'/','AwarenessPerformanceDetails')]",
      "_parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessPerformanceDetails')]",
      "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('AwarenessPerformanceDetails-Parser')))]",
      "parserVersion1": "1.0.0",
      "parserContentId1": "AwarenessPerformanceDetails-Parser"
    },
    "parserObject2": {
      "_parserName2": "[concat(parameters('workspace'),'/','AwarenessSafeScore')]",
      "_parserId2": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessSafeScore')]",
      "parserTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('AwarenessSafeScore-Parser')))]",
      "parserVersion2": "1.0.0",
      "parserContentId2": "AwarenessSafeScore-Parser"
    },
    "parserObject3": {
      "_parserName3": "[concat(parameters('workspace'),'/','AwarenessUserData')]",
      "_parserId3": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessUserData')]",
      "parserTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('AwarenessUserData-Parser')))]",
      "parserVersion3": "1.0.0",
      "parserContentId3": "AwarenessUserData-Parser"
    },
    "parserObject4": {
      "_parserName4": "[concat(parameters('workspace'),'/','AwarenessWatchlist')]",
      "_parserId4": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessWatchlist')]",
      "parserTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('AwarenessWatchlist-Parser')))]",
      "parserVersion4": "1.0.0",
      "parserContentId4": "AwarenessWatchlist-Parser"
    },
    "parserObject5": {
      "_parserName5": "[concat(parameters('workspace'),'/','MimecastAudit')]",
      "_parserId5": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastAudit')]",
      "parserTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastAudit-Parser')))]",
      "parserVersion5": "1.0.0",
      "parserContentId5": "MimecastAudit-Parser"
    },
    "parserObject6": {
      "_parserName6": "[concat(parameters('workspace'),'/','MimecastCloudIntegrated')]",
      "_parserId6": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastCloudIntegrated')]",
      "parserTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastCloudIntegrated-Parser')))]",
      "parserVersion6": "1.0.0",
      "parserContentId6": "MimecastCloudIntegrated-Parser"
    },
    "parserObject7": {
      "_parserName7": "[concat(parameters('workspace'),'/','MimecastCG')]",
      "_parserId7": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastCG')]",
      "parserTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastCG-Parser')))]",
      "parserVersion7": "1.0.0",
      "parserContentId7": "MimecastCG-Parser"
    },
    "parserObject8": {
      "_parserName8": "[concat(parameters('workspace'),'/','MimecastDLP')]",
      "_parserId8": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastDLP')]",
      "parserTemplateSpecName8": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastDLP-Parser')))]",
      "parserVersion8": "1.0.0",
      "parserContentId8": "MimecastDLP-Parser"
    },
    "parserObject9": {
      "_parserName9": "[concat(parameters('workspace'),'/','MimecastTTPAttachment')]",
      "_parserId9": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPAttachment')]",
      "parserTemplateSpecName9": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastTTPAttachment-Parser')))]",
      "parserVersion9": "1.0.0",
      "parserContentId9": "MimecastTTPAttachment-Parser"
    },
    "parserObject10": {
      "_parserName10": "[concat(parameters('workspace'),'/','MimecastTTPImpersonation')]",
      "_parserId10": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPImpersonation')]",
      "parserTemplateSpecName10": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastTTPImpersonation-Parser')))]",
      "parserVersion10": "1.0.0",
      "parserContentId10": "MimecastTTPImpersonation-Parser"
    },
    "parserObject11": {
      "_parserName11": "[concat(parameters('workspace'),'/','MimecastTTPUrl')]",
      "_parserId11": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPUrl')]",
      "parserTemplateSpecName11": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('MimecastTTPUrl-Parser')))]",
      "parserVersion11": "1.0.0",
      "parserContentId11": "MimecastTTPUrl-Parser"
    },
    "uiConfigId1": "MimecastATAPI",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "MimecastATAPI",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))))]",
    "dataConnectorVersion1": "1.0.0",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "uiConfigId2": "MimecastAuditAPI",
    "_uiConfigId2": "[variables('uiConfigId2')]",
    "dataConnectorContentId2": "MimecastAuditAPI",
    "_dataConnectorContentId2": "[variables('dataConnectorContentId2')]",
    "dataConnectorId2": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
    "_dataConnectorId2": "[variables('dataConnectorId2')]",
    "dataConnectorTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId2'))))]",
    "dataConnectorVersion2": "1.0.0",
    "_dataConnectorcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId2'),'-', variables('dataConnectorVersion2'))))]",
    "uiConfigId3": "MimecastCIAPI",
    "_uiConfigId3": "[variables('uiConfigId3')]",
    "dataConnectorContentId3": "MimecastCIAPI",
    "_dataConnectorContentId3": "[variables('dataConnectorContentId3')]",
    "dataConnectorId3": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId3'))]",
    "_dataConnectorId3": "[variables('dataConnectorId3')]",
    "dataConnectorTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId3'))))]",
    "dataConnectorVersion3": "1.0.0",
    "_dataConnectorcontentProductId3": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId3'),'-', variables('dataConnectorVersion3'))))]",
    "uiConfigId4": "MimecastSEGAPI",
    "_uiConfigId4": "[variables('uiConfigId4')]",
    "dataConnectorContentId4": "MimecastSEGAPI",
    "_dataConnectorContentId4": "[variables('dataConnectorContentId4')]",
    "dataConnectorId4": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId4'))]",
    "_dataConnectorId4": "[variables('dataConnectorId4')]",
    "dataConnectorTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId4'))))]",
    "dataConnectorVersion4": "1.0.0",
    "_dataConnectorcontentProductId4": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId4'),'-', variables('dataConnectorVersion4'))))]",
    "uiConfigId5": "MimecastTTPAPI",
    "_uiConfigId5": "[variables('uiConfigId5')]",
    "dataConnectorContentId5": "MimecastTTPAPI",
    "_dataConnectorContentId5": "[variables('dataConnectorContentId5')]",
    "dataConnectorId5": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId5'))]",
    "_dataConnectorId5": "[variables('dataConnectorId5')]",
    "dataConnectorTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId5'))))]",
    "dataConnectorVersion5": "1.0.0",
    "_dataConnectorcontentProductId5": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId5'),'-', variables('dataConnectorVersion5'))))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Attachment_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects a threat for an unsafe attachment in an email.",
                "displayName": "Mimecast Targeted Threat Protection - Attachment Protect",
                "enabled": false,
                "query": "MimecastTTPAttachment\n| where Result != \"safe\"\n| extend SenderAddress = ['Sender Address'] ,RecipientAddress = ['Recipient Address']\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastTTPAPI",
                    "dataTypes": [
                      "MimecastTTPAttachment"
                    ]
                  }
                ],
                "tactics": [
                  "InitialAccess",
                  "Discovery"
                ],
                "techniques": [
                  "T0865"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderAddress"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "RecipientAddress"
                      },
                      {
                        "identifier": "Subject",
                        "columnName": "Subject"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Targeted Threat Protection - Attachment Protect",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Impersonation_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects a maliciously tagged impersonation.",
                "displayName": "Mimecast Targeted Threat Protection - Impersonation Protect",
                "enabled": false,
                "query": "MimecastTTPImpersonation\n| where ['Tagged Malicious'] == true\n| extend SenderAddress = ['Sender Address'],\n  SenderIPAddress = ['Sender IP Address'],\n  RecipientAddress = ['Recipient Address']\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastTTPAPI",
                    "dataTypes": [
                      "MimecastTTPImpersonation"
                    ]
                  }
                ],
                "tactics": [
                  "Exfiltration",
                  "Collection",
                  "Discovery"
                ],
                "techniques": [
                  "T1114"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderAddress"
                      },
                      {
                        "identifier": "SenderIP",
                        "columnName": "SenderIPAddress"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "RecipientAddress"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Targeted Threat Protection - Impersonation Protect",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject3').analyticRuleTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Url_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject3').analyticRuleVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects malicious scan results and actions which are not allowed.",
                "displayName": "Mimecast Targeted Threat Protection - URL Protect",
                "enabled": false,
                "query": "MimecastTTPUrl\n| where ['Scan Result'] == \"malicious\" and Action != \"allow\"\n| extend  From_User_EmailAddress = ['From User Email Address'],MessageID = ['Message ID'] , User_EmailAddress = ['User Email Address']\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastTTPAPI",
                    "dataTypes": [
                      "MimecastTTPUrl"
                    ]
                  }
                ],
                "tactics": [
                  "InitialAccess",
                  "Discovery"
                ],
                "techniques": [
                  "T0865"
                ],
                "entityMappings": [
                  {
                    "entityType": "IP",
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "SendingIP"
                      }
                    ]
                  },
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "From_User_EmailAddress"
                      },
                      {
                        "identifier": "InternetMessageId",
                        "columnName": "MessageID"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "User_EmailAddress"
                      }
                    ]
                  },
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "Url"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject3').analyticRuleId3,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 3",
                "parentId": "[variables('analyticRuleObject3').analyticRuleId3]",
                "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject3').analyticRuleVersion3]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Targeted Threat Protection - URL Protect",
        "contentProductId": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "id": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject4').analyticRuleTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_Audit_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject4').analyticRuleVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threat when logon authentication failure found in audit",
                "displayName": "Mimecast Audit - Logon Authentication Failed",
                "enabled": false,
                "query": "MimecastAudit \n| where ['Source IP'] !=\"\" and ['Audit Type'] == \"Logon Authentication Failed\"\n| extend   SourceIp = ['Source IP'] \n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 3,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastAuditAPI",
                    "dataTypes": [
                      "MimecastAudit_CL"
                    ]
                  }
                ],
                "tactics": [
                  "Discovery",
                  "InitialAccess",
                  "CredentialAccess"
                ],
                "techniques": [
                  "T1110"
                ],
                "entityMappings": [
                  {
                    "entityType": "IP",
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "SourceIp"
                      }
                    ]
                  },
                  {
                    "entityType": "Mailbox",
                    "fieldMappings": [
                      {
                        "identifier": "MailboxPrimaryAddress",
                        "columnName": "User"
                      }
                    ]
                  },
                  {
                    "entityType": "CloudApplication",
                    "fieldMappings": [
                      {
                        "identifier": "AppId",
                        "columnName": "Application"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject4').analyticRuleId4,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 4",
                "parentId": "[variables('analyticRuleObject4').analyticRuleId4]",
                "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject4').analyticRuleVersion4]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Audit - Logon Authentication Failed",
        "contentProductId": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "id": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject5').analyticRuleTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_Attachment_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject5').analyticRuleVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detect threat for mail attachment under the targeted threat protection.",
                "displayName": "Mimecast Secure Email Gateway - Attachment Protect",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_ttp_ap\"\n| extend  SenderEnvelope = ['Sender Envelope']  , SenderIp = ['Sender IP']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "Collection",
                  "Exfiltration",
                  "Discovery",
                  "InitialAccess",
                  "Execution"
                ],
                "techniques": [
                  "T1114",
                  "T1566",
                  "T0865"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      },
                      {
                        "identifier": "Subject",
                        "columnName": "Subject"
                      }
                    ]
                  },
                  {
                    "entityType": "IP",
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "SenderIp"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject5').analyticRuleId5,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 5",
                "parentId": "[variables('analyticRuleObject5').analyticRuleId5]",
                "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject5').analyticRuleVersion5]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - Attachment Protect",
        "contentProductId": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "id": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject6').analyticRuleTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_AV_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject6').analyticRuleVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threats from email anti virus scan.",
                "displayName": "Mimecast Secure Email Gateway - AV",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_antivirus\"\n| extend  SenderEnvelope = ['Sender Envelope'] \n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "Informational",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "Execution"
                ],
                "techniques": [
                  "T1053"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      },
                      {
                        "identifier": "Subject",
                        "columnName": "Subject"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject6').analyticRuleId6,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 6",
                "parentId": "[variables('analyticRuleObject6').analyticRuleId6]",
                "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject6').analyticRuleVersion6]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - AV",
        "contentProductId": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "id": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject7').analyticRuleTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_Impersonation_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject7').analyticRuleVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threats from impersonation mail under targeted threat protection.",
                "displayName": "Mimecast Secure Email Gateway - Impersonation Protect",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_ttp_impersonation\"\n| extend  SenderEnvelope = ['Sender Envelope'] , SenderIp = ['Sender IP']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "Discovery",
                  "LateralMovement",
                  "Collection"
                ],
                "techniques": [
                  "T1114"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "SenderIP",
                        "columnName": "SenderIp"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject7').analyticRuleId7,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 7",
                "parentId": "[variables('analyticRuleObject7').analyticRuleId7]",
                "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject7').analyticRuleVersion7]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - Impersonation Protect",
        "contentProductId": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "id": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject8').analyticRuleTemplateSpecName8]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_Internal_Mail_Protect_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject8').analyticRuleVersion8]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threats from internal email threat protection.",
                "displayName": "Mimecast Secure Email Gateway - Internal Email Protect",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_iep\"\n| extend  SenderEnvelope = ['Sender Envelope']  , MessageId = ['Message ID']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "LateralMovement",
                  "Persistence",
                  "Exfiltration"
                ],
                "techniques": [
                  "T1534",
                  "T1546"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      },
                      {
                        "identifier": "InternetMessageId",
                        "columnName": "MessageId"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject8').analyticRuleId8,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 8",
                "parentId": "[variables('analyticRuleObject8').analyticRuleId8]",
                "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject8').analyticRuleVersion8]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - Internal Email Protect",
        "contentProductId": "[variables('analyticRuleObject8')._analyticRulecontentProductId8]",
        "id": "[variables('analyticRuleObject8')._analyticRulecontentProductId8]",
        "version": "[variables('analyticRuleObject8').analyticRuleVersion8]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject9').analyticRuleTemplateSpecName9]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_Spam_Event_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject9').analyticRuleVersion9]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threat from spam event thread protection logs.",
                "displayName": "Mimecast Secure Email Gateway - Spam Event Thread",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_spam\"\n| extend  SenderEnvelope = ['Sender Envelope'] \n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "Discovery"
                ],
                "techniques": [
                  "T1083"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      },
                      {
                        "identifier": "Subject",
                        "columnName": "Subject"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject9').analyticRuleId9,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 9",
                "parentId": "[variables('analyticRuleObject9').analyticRuleId9]",
                "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject9').analyticRuleVersion9]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - Spam Event Thread",
        "contentProductId": "[variables('analyticRuleObject9')._analyticRulecontentProductId9]",
        "id": "[variables('analyticRuleObject9')._analyticRulecontentProductId9]",
        "version": "[variables('analyticRuleObject9').analyticRuleVersion9]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject10').analyticRuleTemplateSpecName10]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_Url_Protect_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject10').analyticRuleVersion10]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detect threat when potentially malicious url found.",
                "displayName": "Mimecast Secure Email Gateway - URL Protect",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_ttp_url\"\n| extend  SenderEnvelope = ['Sender Envelope']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "InitialAccess",
                  "Discovery",
                  "Execution"
                ],
                "techniques": [
                  "T1566"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      },
                      {
                        "identifier": "Subject",
                        "columnName": "Subject"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject10').analyticRuleId10,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 10",
                "parentId": "[variables('analyticRuleObject10').analyticRuleId10]",
                "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject10').analyticRuleVersion10]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - URL Protect",
        "contentProductId": "[variables('analyticRuleObject10')._analyticRulecontentProductId10]",
        "id": "[variables('analyticRuleObject10')._analyticRulecontentProductId10]",
        "version": "[variables('analyticRuleObject10').analyticRuleVersion10]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject11').analyticRuleTemplateSpecName11]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastCG_Virus_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject11').analyticRuleVersion11]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detect threat for virus from mail receipt virus event.",
                "displayName": "Mimecast Secure Email Gateway - Virus",
                "enabled": false,
                "query": "MimecastCG\n| where Type == \"email_receipt\" and isnotempty(['Virus Found'])\n| extend  SenderEnvelope = ['Sender Envelope']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "Informational",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastCG"
                    ]
                  }
                ],
                "tactics": [
                  "Execution"
                ],
                "techniques": [
                  "T1053"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderEnvelope"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "Recipients"
                      },
                      {
                        "identifier": "Subject",
                        "columnName": "Subject"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject11').analyticRuleId11,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 11",
                "parentId": "[variables('analyticRuleObject11').analyticRuleId11]",
                "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject11').analyticRuleVersion11]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Secure Email Gateway - Virus",
        "contentProductId": "[variables('analyticRuleObject11')._analyticRulecontentProductId11]",
        "id": "[variables('analyticRuleObject11')._analyticRulecontentProductId11]",
        "version": "[variables('analyticRuleObject11').analyticRuleVersion11]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject12').analyticRuleTemplateSpecName12]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastDLP_hold_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject12').analyticRuleVersion12]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threat for data leak when action is hold",
                "displayName": "Mimecast Data Leak Prevention - Hold",
                "enabled": false,
                "query": "MimecastDLP \n| where Action == \"hold\"\n| extend SenderAddress = ['Sender Address'] ,RecipientAddress = ['Recipient Address']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "Informational",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastDLP"
                    ]
                  }
                ],
                "tactics": [
                  "Exfiltration"
                ],
                "techniques": [
                  "T1030"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderAddress"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "RecipientAddress"
                      },
                      {
                        "identifier": "DeliveryAction",
                        "columnName": "Action"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject12').analyticRuleId12,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 12",
                "parentId": "[variables('analyticRuleObject12').analyticRuleId12]",
                "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject12').analyticRuleVersion12]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Data Leak Prevention - Hold",
        "contentProductId": "[variables('analyticRuleObject12')._analyticRulecontentProductId12]",
        "id": "[variables('analyticRuleObject12')._analyticRulecontentProductId12]",
        "version": "[variables('analyticRuleObject12').analyticRuleVersion12]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject13').analyticRuleTemplateSpecName13]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "MimecastDLP_Notifications_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject13').analyticRuleVersion13]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects threat for data leak when action is notification",
                "displayName": "Mimecast Data Leak Prevention - Notifications",
                "enabled": false,
                "query": "MimecastDLP \n| where Action == \"notification\"\n| extend SenderAddress = ['Sender Address'] ,RecipientAddress = ['Recipient Address']\n",
                "queryFrequency": "PT15M",
                "queryPeriod": "PT15M",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "MimecastSEGAPI",
                    "dataTypes": [
                      "MimecastDLP"
                    ]
                  }
                ],
                "tactics": [
                  "Exfiltration"
                ],
                "techniques": [
                  "T1030"
                ],
                "entityMappings": [
                  {
                    "entityType": "MailMessage",
                    "fieldMappings": [
                      {
                        "identifier": "Sender",
                        "columnName": "SenderAddress"
                      },
                      {
                        "identifier": "Recipient",
                        "columnName": "RecipientAddress"
                      },
                      {
                        "identifier": "DeliveryAction",
                        "columnName": "Action"
                      }
                    ]
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "SingleAlert"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "lookbackDuration": "P7D",
                    "enabled": true
                  },
                  "createIncident": true
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject13').analyticRuleId13,'/'))))]",
              "properties": {
                "description": "Mimecast Analytics Rule 13",
                "parentId": "[variables('analyticRuleObject13').analyticRuleId13]",
                "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject13').analyticRuleVersion13]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
        "contentKind": "AnalyticsRule",
        "displayName": "Mimecast Data Leak Prevention - Notifications",
        "contentProductId": "[variables('analyticRuleObject13')._analyticRulecontentProductId13]",
        "id": "[variables('analyticRuleObject13')._analyticRulecontentProductId13]",
        "version": "[variables('analyticRuleObject13').analyticRuleVersion13]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_Audit_Workbook Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "A workbook providing insights into Mimecast Audit."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"82fedb33-961a-4199-a5ab-16340948ed10\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time_range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":1209600000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Category\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Audit & Authentication Events by Category\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"auditType_s\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"count_\"},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortCriteriaField\":\"auditType_s\",\"size\":\"auto\"},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"auditType_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"count_\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"group\":\"Category\",\"createOtherGroup\":10,\"seriesLabelSettings\":[{\"seriesName\":\"reporting_logs\",\"label\":\"Reporting \"},{\"seriesName\":\"authentication_logs\",\"label\":\"Authentication\"},{\"seriesName\":\"case_review_logs\",\"label\":\"Case Review\"},{\"seriesName\":\"account_logs\",\"label\":\"Account\"},{\"seriesName\":\"profile_group_logs\",\"label\":\"Profile Group\"},{\"seriesName\":\"user_account_and_role_logs\",\"label\":\"User Account and Roles\"},{\"seriesName\":\"mimecast_access_logs\",\"label\":\"Mimecast Acess\"},{\"seriesName\":\"archive_service_logs\",\"label\":\"Archive Service\"},{\"seriesName\":\"policy_logs\",\"label\":\"Policy \"},{\"seriesName\":\"awareness_training_logs\",\"label\":\"Awareness Training\"},{\"seriesName\":\"secure_messaging_logs\",\"label\":\"Secure Messaging\"},{\"seriesName\":\"integrations_and_apis\",\"label\":\"Integrations and API's\"}]}},\"name\":\"query - 18\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| summarize count() by ['Audit Type'] \",\"size\":3,\"showAnalytics\":true,\"title\":\"Audit Events by Type\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 15\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where Category == \\\"account_logs\\\"\\n| summarize count() by ['Audit Type']\",\"size\":3,\"showAnalytics\":true,\"title\":\"Account Events\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 4\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where Category == \\\"authentication_logs\\\"\\n| summarize count() by ['Audit Type']\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Authentication Events\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where Category == \\\"mimecast_access_logs\\\"\\n| summarize count() by ['Audit Type']\",\"size\":3,\"showAnalytics\":true,\"title\":\"Mimecast Support Access Events\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where Category == \\\"archive_service_logs\\\"\\n| summarize count() by ['Audit Type']\",\"size\":3,\"showAnalytics\":true,\"title\":\"Archive Service Events\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 10\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where Category == \\\"user_account_and_role_logs\\\"\\n| summarize count() by ['Audit Type']\",\"size\":3,\"showAnalytics\":true,\"title\":\"User Account and Role Events\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 12\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where Category == \\\"policy_logs\\\"\\n| summarize count() by ['Audit Type']\",\"size\":3,\"showAnalytics\":true,\"title\":\"Policy Events\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Audit Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 14\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where ['Audit Type']  == \\\"User Logged On\\\" and Application !=\\\"\\\"\\n| summarize count() by Application\",\"size\":3,\"showAnalytics\":true,\"title\":\"Successful Logins by Application\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Application\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where ['Source IP'] !=\\\"unknown\\\" and ['Audit Type'] == \\\"User Logged On\\\"\\n| summarize count() by User, Application, ['Source IP'] , [\\\"Event Time\\\"] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Successful Logins by User, App and Source IP\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true,\"labelSettings\":[{\"columnId\":\"count_\",\"label\":\"Successful Logins\"}]},\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"user_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"user_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"count_\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":0},\"mapSettings\":{\"locInfo\":\"AzureResource\",\"locInfoColumn\":\"src_s\",\"sizeAggregation\":\"Count\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"count_\",\"colorAggregation\":\"Sum\",\"type\":\"thresholds\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"representation\":\"blue\"}]}}},\"name\":\"query - 12\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastAudit\\n| where ['Source IP'] !=\\\"unknown\\\" and ['Audit Type'] == \\\"Logon Authentication Failed\\\"\\n| summarize [\\\"Failed Login\\\"] = count() by User, Application, ['Source IP'], ['Event Time']\",\"size\":0,\"showAnalytics\":true,\"title\":\"Failed Logins by User, App and Source IP\",\"timeContextFromParameter\":\"time_range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"User\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"User\",\"sortOrder\":1}]},\"name\":\"query - 14\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"name\":\"group - 5\"},{\"type\":1,\"content\":{\"json\":\"#### 📝***Refresh the web page to fetch details of recently collected events***\\r\\n\"},\"name\":\"text - 4\"}]},\"name\":\"group - 9\"}],\"fromTemplateId\":\"Sentinel-Mimecast-Audit-Workbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=Mimecast_Audit_Workbook; logoFileName=Mimecast.svg; description=A workbook providing insights into Mimecast Audit.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Mimecast Audit Workbook; templateRelativePath=Mimecast_Audit_Workbook.json; subtitle=; provider=Mimecast}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Audit_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "MimecastAuditAPI",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_Awareness_Training_Workbook Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion2')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId2')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "A workbook providing insights into Mimecast Awareness Training."
              },
              "properties": {
                "displayName": "[parameters('workbook2-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"6c07c649-3f3c-4383-ac47-32494f912d63\",\"cellValue\":\"setTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Human Risk Overview\",\"subTarget\":\"HumanRisk\",\"style\":\"link\"},{\"id\":\"5884fe55-37eb-4fb0-8835-61de095259ed\",\"cellValue\":\"setTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Awareness Training\",\"subTarget\":\"AwarenessTraining\",\"style\":\"link\"},{\"id\":\"d69c5034-e10a-4d89-b776-dede3e65da34\",\"cellValue\":\"setTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Phishing Training\",\"subTarget\":\"PhishingTraining\",\"style\":\"link\"}]},\"name\":\"links - 5\"},{\"type\":1,\"content\":{\"json\":\"\\r\\n\\r\\n---\"},\"name\":\"text - 5\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"568f52ad-774c-4bf2-84e2-b0b7d5610797\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}},{\"id\":\"0f645fbe-75ca-4eff-a2ed-c25bacdedfc7\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Email\",\"type\":1,\"query\":\"print tostring('*')\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0 - Copy\"},{\"type\":1,\"content\":{\"json\":\"### Watchlist Panels\\r\\n\\r\\n----\"},\"name\":\"text - 5\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessWatchlist\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') and isnotempty(Email)\\r\\n| summarize Count = count() by ['Watchlist Count']\\r\\n| project tostring(toint(['Watchlist Count'])) , Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Watchlist Count\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Watchlist Count\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"35\",\"name\":\"query - 0\",\"styleSettings\":{\"maxWidth\":\"35%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessWatchlist\\r\\n| project  Email , Name , [\\\"Watchlist Count\\\"] , ['User State'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Watchlist Overview\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"65\",\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"65%\",\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"### Performance Panels\\r\\n\\r\\n\\r\\n----\"},\"name\":\"text - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessPerformanceDetails\\r\\n| project Email , ['Num of Correct'] , ['Num of Incorrect'] , ['Num of Not Watched'] , Name , ['User Details'] , ['User State'] , Department \",\"size\":0,\"showAnalytics\":true,\"title\":\"Performance Overview\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 4\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessPerformanceDetails\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') and isnotempty(Email)\\r\\n| summarize Count = count() by tostring( toint(['Num of Correct']))  \",\"size\":0,\"showAnalytics\":true,\"title\":\"Correct Number by Count\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"chartSettings\":{\"group\":\"Num of Correct\"}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessPerformanceDetails\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') and isnotempty(Email)\\r\\n| summarize Count = count() by  tostring( toint(['Num of Incorrect'])) \\r\\n\\r\\n\\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Incorrect Number by Count\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"33\",\"name\":\"query - 4\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessPerformanceDetails\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') and isnotempty(Email)\\r\\n| sort by ['Num of Not Watched'] \\r\\n| summarize Count = count() by  tostring( toint(['Num of Not Watched'])) \\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Not Watched by Count\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"33\",\"name\":\"query - 0\",\"styleSettings\":{\"maxWidth\":\"33%\"}}]},\"name\":\"group - 8\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"### User Stats Panels\\r\\n\\r\\n----\"},\"name\":\"text - 9\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"994dee73-1b2c-43cd-b3e5-e91e6c3495ab\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Template_Name\",\"label\":\"Template Name\",\"type\":2,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n| where isnotempty(['Template Name'])\\r\\n| distinct ['Template Name']\\r\\n| sort by ['Template Name'] asc\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"*\",\"showDefault\":false},\"timeContext\":{\"durationMs\":2419200000},\"timeContextFromParameter\":\"Time_Range\",\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n|  project  Name , Email , Status, ['Template Name'] , ['Num of Campaigns Clicked'] , ['Num of Campaigns Sent'] , ['Num of Correct Answers'] , ['Num of Incorrect Answers'] , ['Num of Training Modules Assigned'] , ['User State'] , ['Clicked IP'] , ['Reaction Time'] , ['Time Clicked'] , ['Time Opened'] , ['Time Reported'] , ['Time Scheduled']\",\"size\":0,\"showAnalytics\":true,\"title\":\"User Stats Overview\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 9\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n    and  isnotempty(['Template Name'])\\r\\n|  where ( ('{Template_Name}') == \\\"*\\\" or ['Template Name'] == ('{Template_Name}'))\\r\\n| summarize Count = count()  by ['Num of Campaigns Sent']\\r\\n| project tostring(toint(['Num of Campaigns Sent'])) , Count\\r\\n\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Number of Campaigns Sent\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"graphSettings\":{\"type\":0},\"chartSettings\":{\"group\":\"Num of Campaigns Sent\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 0\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n    and isnotempty(['Template Name'])\\r\\n|  where ( ('{Template_Name}') == \\\"*\\\" or ['Template Name'] == ('{Template_Name}'))\\r\\n| summarize Count = count()  by ['Num of Campaigns Clicked']\\r\\n| project tostring(toint(['Num of Campaigns Clicked'])) , Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Number of Campaigns Clicked\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Num of Campaigns Clicked\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n    and isnotempty(['Template Name'])\\r\\n|  where ( ('{Template_Name}') == \\\"*\\\" or ['Template Name'] == ('{Template_Name}'))\\r\\n| summarize Count = count()  by ['Num of Training Modules Assigned']\\r\\n| project tostring(toint(['Num of Training Modules Assigned'])) , Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Number of Training Modules Assigned\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Num of Training Modules Assigned\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n    and isnotempty(['Template Name'])\\r\\n|  where ( ('{Template_Name}') == \\\"*\\\" or ['Template Name'] == ('{Template_Name}'))\\r\\n| summarize Count = count()  by ['Num of Correct Answers']\\r\\n| project tostring(toint(['Num of Correct Answers'])) , Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Number of Correct Answers\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Num of Correct Answers\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n    and isnotempty(['Template Name'])\\r\\n|  where ( ('{Template_Name}') == \\\"*\\\" or ['Template Name'] == ('{Template_Name}'))\\r\\n| summarize Count = count()  by ['Num of Incorrect Answers']\\r\\n| project tostring(toint(['Num of Incorrect Answers'])) , Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Number of Incorrect Answers\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Num of Incorrect Answers\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n    and isnotempty(['Template Name'])\\r\\n|  where ( ('{Template_Name}') == \\\"*\\\" or ['Template Name'] == ('{Template_Name}'))\\r\\n| where isnotempty(['Clicked IP'] )\\r\\n| summarize Count = count()  by ['Clicked IP']\\r\\n| project tostring(['Clicked IP']) , Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Clicked Ip\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Clicked IP\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":1,\"content\":{\"json\":\"#### 📝***Refresh the web page to fetch details of recently collected events***\\r\\n\"},\"name\":\"text - 5 - Copy\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"AwarenessTraining\"},\"name\":\"group - 3\",\"styleSettings\":{\"padding\":\"10px\"}}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"AwarenessTraining\"},\"name\":\"group - 1\",\"styleSettings\":{\"padding\":\"10px\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f9053e40-ba9b-40ed-afe4-8ab6731de894\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}},{\"id\":\"2025c297-a05f-43e6-8af9-f24122e95e81\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Email\",\"type\":1,\"query\":\"print tostring('*')\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"dafsaf\",\"comparison\":\"isNotEqualTo\"},\"name\":\"parameters - 0 - Copy\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"AwarenessTraining\"},\"name\":\"group - 4\",\"styleSettings\":{\"padding\":\"10px\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"6a8902e3-d3e9-4465-9976-aaf29c1db37d\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}},{\"id\":\"316968d2-96df-4bb9-acf7-b04a018c203f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Email\",\"type\":1,\"query\":\"print tostring('*')\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0 - Copy\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by Risk\\r\\n| order by Risk desc\\r\\n| take 1\",\"size\":3,\"title\":\"Highest Risk\",\"timeContextFromParameter\":\"Time_Range\",\"exportFieldName\":\"Risk\",\"exportParameterName\":\"HighestRisk\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Risk\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"rightContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"palette\":\"turquoise\"}},\"showBorder\":false},\"textSettings\":{\"style\":\"bignumber\"}},\"name\":\"query - 5\"},{\"type\":1,\"content\":{\"json\":\"💡 To view Risk details, please click on above tile\"},\"conditionalVisibility\":{\"parameterName\":\"HighestRisk\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n|project [\\\"Email Address\\\"] , Name , Risk , [\\\"Human Error\\\"], Sentiment, Engagement , Knowledge , ['User State']\\r\\n| order by Risk desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Highest Risk Details\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Risk\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false},\"textSettings\":{\"style\":\"bignumber\"}},\"conditionalVisibility\":{\"parameterName\":\"HighestRisk\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 5 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"name\":\"group - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by Risk\\r\\n| project Risk, Count\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Risk\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Risk\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by ['Human Error']\\r\\n| project ['Human Error'], Count\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Human Error\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Human Error\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 1\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by Sentiment\\r\\n\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Sentiment\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Sentiment\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 2\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by Engagement\\r\\n\\r\\n\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Engagement\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Engagement\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 3\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by Knowledge\\r\\n\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by Knowledge\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Knowledge\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 4\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| where ('{Email}' == \\\"*\\\" or ['Email Address'] == '{Email}') and isnotempty(['Email Address'])\\r\\n| summarize Count = count() by ['User State'] \\r\\n\\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Breakdown by User State\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"User State\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 5\",\"styleSettings\":{\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessSafeScore\\r\\n| project [\\\"Email Address\\\"] , Name , Risk , [\\\"Human Error\\\"] , Sentiment, Engagement , Knowledge , ['User State'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Safe Scores Overview\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"#### 📝***Refresh the web page to fetch details of recently collected events***\\r\\n\"},\"name\":\"text - 5 - Copy - Copy\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"HumanRisk\"},\"name\":\"group - 3\",\"styleSettings\":{\"padding\":\"10px\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"03fcf595-8dee-44c7-9d71-c09a88138a32\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}},{\"id\":\"41460584-1c2c-4af8-9aab-086bb8aff8eb\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Email\",\"type\":1,\"query\":\"print tostring('*')\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0 - Copy - Copy\"},{\"type\":1,\"content\":{\"json\":\"### To see an phishing training details , go to the Awareness Training tab and check the User Stats Overview panel.\\r\\n\",\"style\":\"info\"},\"name\":\"text - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') \\r\\n    and isnotempty(Email)\\r\\n| summarize by Email, ['Template Name']\\r\\n| summarize Count = count() by ['Template Name']\\r\\n| order by Count desc\\r\\n| take 10\\r\\n| project ['Template Name'], Count\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Breakdown of Top 10 Template Names \",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\"},\"name\":\"query - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AwarenessUserData\\r\\n| where ('{Email}' == \\\"*\\\" or Email == '{Email}') and isnotempty(Email)\\r\\n| where  Status == \\\"CLICKED\\\"\\r\\n| summarize arg_max(['Reaction Time'], *) by Email, ['Template Name']\\r\\n| project Email, ['Reaction Time'],  ['Time Clicked'] ,  ['Time Opened'], ['Template Name']\\r\\n| order by ['Reaction Time'] asc \\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Users Clicked on Phishing data\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"#### 📝***Refresh the web page to fetch details of recently collected events***\\r\\n\"},\"name\":\"text - 4\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"PhishingTraining\"},\"name\":\"group - 11\"}],\"fromTemplateId\":\"Sentinel-Mimecast-Awareness-Training-Workbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId2'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=Mimecast_Awareness_Training_Workbook; logoFileName=Mimecast.svg; description=A workbook providing insights into Mimecast Awareness Training.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Mimecast Awareness Training Workbook; templateRelativePath=Mimecast_Awareness_Training_Workbook.json; subtitle=; provider=Mimecast}.description",
                "parentId": "[variables('workbookId2')]",
                "contentId": "[variables('_workbookContentId2')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Awareness_Performance_Details_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Awareness_User_Data_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Awareness_Watchlist_Details_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Awareness_SafeScore_Details_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "MimecastATAPI",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId2')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook2-name')]",
        "contentProductId": "[variables('_workbookcontentProductId2')]",
        "id": "[variables('_workbookcontentProductId2')]",
        "version": "[variables('workbookVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_Cloud_Integrated_Workbook Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion3')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId3')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "A workbook providing insights into Mimecast Cloud Integrated."
              },
              "properties": {
                "displayName": "[parameters('workbook3-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"c1d5c69f-05f2-459b-a6ce-f09fe2c4c1c6\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"MALWARE\\\"\\r\\n| count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Malware Tags Count\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportParameterName\":\"Malware\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 1\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"PHISHING\\\"\\r\\n| count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Phishing Tags Count\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportParameterName\":\"Phishing\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"UNTRUSTWORTHY\\\"\\r\\n| count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Untrustworthy Tags Count\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportParameterName\":\"Untrustworthy\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 3\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"SPAM\\\"\\r\\n| count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Spam Tags Count\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportParameterName\":\"Spam\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 4\",\"styleSettings\":{\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on the tiles above to view threat details\"},\"conditionalVisibilities\":[{\"parameterName\":\"Malware\",\"comparison\":\"isEqualTo\"},{\"parameterName\":\"Phishing\",\"comparison\":\"isEqualTo\"},{\"parameterName\":\"Untrustworthy\",\"comparison\":\"isEqualTo\"},{\"parameterName\":\"Spam\",\"comparison\":\"isEqualTo\"}],\"name\":\"text - 5\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"MALWARE\\\"\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| extend Tags = replace_string(Tags,'\\\"','') \\r\\n| extend Tags = replace_string(Tags,',',', ') \\r\\n| extend  Tags = trim(@\\\"[\\\\[\\\\]]\\\",Tags)\\r\\n| extend Attachments = replace_string(Attachments,'\\\"','') \\r\\n| extend Attachments = replace_string(Attachments,',',', ') \\r\\n|extend  Attachments = trim(@\\\"[\\\\[\\\\]]\\\",Attachments)\\r\\n| extend  ['Message ID'] = trim(@\\\"[\\\\<\\\\>]\\\", ['Message ID'] )\\r\\n| project Sender,\\r\\n        ['Sender IP'],\\r\\n        Recipients,\\r\\n        Tags,\\r\\n        ['Policies Applied'],\\r\\n        ['Account ID'],\\r\\n        ['Aggregate ID'],\\r\\n        ['Processing ID'],\\r\\n        ['Message ID'],\\r\\n        ['Threat State'],\\r\\n        ['Threat Type'],\\r\\n        ['Event Time'],\\r\\n        Attachments,\\r\\n        Subject,\\r\\n        Source,\\r\\n        Direction,\\r\\n        ['Sender Header'],\\r\\n        ['Historical Mail'],\\r\\n        Type,\\r\\n        Subtype\\r\\n        \",\"size\":0,\"showAnalytics\":true,\"title\":\"Malware Tags Details\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Malware\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 4\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"PHISHING\\\"\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| extend Tags = replace_string(Tags,'\\\"','') \\r\\n| extend Tags = replace_string(Tags,',',', ') \\r\\n| extend  Tags = trim(@\\\"[\\\\[\\\\]]\\\",Tags)\\r\\n| extend Attachments = replace_string(Attachments,'\\\"','') \\r\\n| extend Attachments = replace_string(Attachments,',',', ') \\r\\n|extend  Attachments = trim(@\\\"[\\\\[\\\\]]\\\",Attachments)\\r\\n| extend  ['Message ID'] = trim(@\\\"[\\\\<\\\\>]\\\", ['Message ID'] )\\r\\n| project Sender,\\r\\n        ['Sender IP'],\\r\\n        Recipients,\\r\\n        Tags,\\r\\n        ['Policies Applied'],\\r\\n        ['Account ID'],\\r\\n        ['Aggregate ID'],\\r\\n        ['Processing ID'],\\r\\n        ['Message ID'],\\r\\n        ['Threat State'],\\r\\n        ['Threat Type'],\\r\\n        ['Event Time'],\\r\\n        Attachments,\\r\\n        Subject,\\r\\n        Source,\\r\\n        Direction,\\r\\n        ['Sender Header'],\\r\\n        ['Historical Mail'],\\r\\n        Type,\\r\\n        Subtype\",\"size\":0,\"showAnalytics\":true,\"title\":\"Phishing Tags Details\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Phishing\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 6\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"UNTRUSTWORTHY\\\"\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| extend Tags = replace_string(Tags,'\\\"','') \\r\\n| extend Tags = replace_string(Tags,',',', ') \\r\\n| extend  Tags = trim(@\\\"[\\\\[\\\\]]\\\",Tags)\\r\\n| extend Attachments = replace_string(Attachments,'\\\"','') \\r\\n| extend Attachments = replace_string(Attachments,',',', ') \\r\\n|extend  Attachments = trim(@\\\"[\\\\[\\\\]]\\\",Attachments)\\r\\n| extend  ['Message ID'] = trim(@\\\"[\\\\<\\\\>]\\\", ['Message ID'] )\\r\\n| project Sender,\\r\\n        ['Sender IP'],\\r\\n        Recipients,\\r\\n        Tags,\\r\\n        ['Policies Applied'],\\r\\n        ['Account ID'],\\r\\n        ['Aggregate ID'],\\r\\n        ['Processing ID'],\\r\\n        ['Message ID'],\\r\\n        ['Threat State'],\\r\\n        ['Threat Type'],\\r\\n         ['Event Time'],\\r\\n        Attachments,\\r\\n        Subject,\\r\\n        Source,\\r\\n        Direction,\\r\\n        ['Sender Header'],\\r\\n        ['Historical Mail'],\\r\\n        Type,\\r\\n        Subtype\",\"size\":0,\"showAnalytics\":true,\"title\":\"Untrustworthy Tags Details\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Untrustworthy\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 7\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Tags contains \\\"SPAM\\\"\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| extend Tags = replace_string(Tags,'\\\"','') \\r\\n| extend Tags = replace_string(Tags,',',', ') \\r\\n| extend  Tags = trim(@\\\"[\\\\[\\\\]]\\\",Tags)\\r\\n| extend Attachments = replace_string(Attachments,'\\\"','') \\r\\n| extend Attachments = replace_string(Attachments,',',', ') \\r\\n|extend  Attachments = trim(@\\\"[\\\\[\\\\]]\\\",Attachments)\\r\\n| extend  ['Message ID'] = trim(@\\\"[\\\\<\\\\>]\\\", ['Message ID'] )\\r\\n| project Sender,\\r\\n        ['Sender IP'],\\r\\n        Recipients,\\r\\n        Tags,\\r\\n        ['Policies Applied'],\\r\\n        ['Account ID'],\\r\\n        ['Aggregate ID'],\\r\\n        ['Processing ID'],\\r\\n        ['Message ID'],\\r\\n        ['Threat State'],\\r\\n        ['Threat Type'],\\r\\n         ['Event Time'],\\r\\n        Attachments,\\r\\n        Subject,\\r\\n        Source,\\r\\n        Direction,\\r\\n        ['Sender Header'],\\r\\n        ['Historical Mail'],\\r\\n        Type,\\r\\n        Subtype\",\"size\":0,\"showAnalytics\":true,\"title\":\"Spam Tags Details\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Spam\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}}]},\"name\":\"group - 22\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where isnotempty(Direction)\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Direction\",\"size\":0,\"showAnalytics\":true,\"title\":\"Email Traffic by Route\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 5\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| parse-kv ['Policies Applied'] as (action: string) with ( kv_delimiter=\\\":\\\", pair_delimiter=\\\",\\\", quote='\\\"')\\r\\n| extend Action = replace_string(trim(@\\\"\\\\s\\\", action),\\\"_\\\",\\\" \\\")\\r\\n| where isnotempty(Action)\\r\\n| summarize count() by Action\",\"size\":0,\"showAnalytics\":true,\"title\":\"Types of Policy Action\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"Action\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"xAxis\":\"Action\",\"yAxis\":[\"count_\"]}},\"name\":\"query - 6\",\"styleSettings\":{\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on 'Types of Policy Action' bar chart to see 'Policy Mode for Action'\"},\"conditionalVisibility\":{\"parameterName\":\"Action\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 1\"}],\"exportParameters\":true},\"name\":\"group - 17\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| parse-kv ['Policies Applied'] as (action: string, mode: string) with ( kv_delimiter=\\\":\\\", pair_delimiter=\\\",\\\", quote='\\\"')\\r\\n| extend Action = replace_string(trim(@\\\"\\\\s\\\", action),\\\"_\\\",\\\" \\\"), Mode = replace_string(trim(@\\\"\\\\s\\\", mode),\\\"_\\\",\\\" \\\")\\r\\n| where Action == '{Action}' and isnotempty(Mode)\\r\\n| summarize count() by Mode\",\"size\":3,\"showAnalytics\":true,\"title\":\"Policy Mode for Action : {Action}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"Mode\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Mode\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"Action\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 7\",\"styleSettings\":{\"padding\":\"69px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on 'Policy Mode for Action: {Action}' pie chart to see 'Details of Emails for Policy Mode and Policy Action'\"},\"conditionalVisibilities\":[{\"parameterName\":\"Mode\",\"comparison\":\"isEqualTo\"},{\"parameterName\":\"Action\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"text - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| parse-kv ['Policies Applied'] as (action: string, mode: string) with ( kv_delimiter=\\\":\\\", pair_delimiter=\\\",\\\", quote='\\\"')\\r\\n| extend Action = replace_string(trim(@\\\"\\\\s\\\", action),\\\"_\\\",\\\" \\\"), Mode = replace_string(trim(@\\\"\\\\s\\\", mode),\\\"_\\\",\\\" \\\")\\r\\n| where Action == '{Action}' and Mode == '{Mode}'\\r\\n| extend ['Threat Type'] = replace_string(['Threat Type'],\\\"_\\\",\\\" \\\"), ['Threat State'] = replace_string(['Threat State'],\\\"_\\\",\\\" \\\")\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| project Sender, Recipients, Subject, ['Threat State'], ['Threat Type']\",\"size\":0,\"showAnalytics\":true,\"title\":\"Details of Emails for Policy Mode: {Mode} and Policy Action: {Action}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"conditionalVisibilities\":[{\"parameterName\":\"Action\",\"comparison\":\"isNotEqualTo\"},{\"parameterName\":\"Mode\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"query - 19\",\"styleSettings\":{\"showBorder\":true}}],\"exportParameters\":true},\"name\":\"group - 21\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend ['Threat Type'] = replace_string(trim(@\\\"\\\\s\\\", ['Threat Type']),\\\"_\\\",\\\" \\\")\\r\\n| where isnotempty(['Threat Type'])\\r\\n| summarize count() by ['Threat Type']\",\"size\":0,\"showAnalytics\":true,\"title\":\"Threat Detection\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"ThreatType\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on 'Threat Detection' bar chart to see 'Threat State for Type'\"},\"conditionalVisibility\":{\"parameterName\":\"ThreatType\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 1\"}],\"exportParameters\":true},\"name\":\"group - 18\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend ['Threat Type'] = replace_string(trim(@\\\"\\\\s\\\", ['Threat Type']),\\\"_\\\",\\\" \\\"),\\r\\n         ['Threat State'] = replace_string(trim(@\\\"\\\\s\\\", ['Threat State']),\\\"_\\\",\\\" \\\")\\r\\n| where ['Threat Type'] == '{ThreatType}' and isnotempty(['Threat State'])\\r\\n| summarize count() by ['Threat State']\",\"size\":3,\"showAnalytics\":true,\"title\":\"Threat State for Type: {ThreatType}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"ThreatState\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"ThreatType\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 9\",\"styleSettings\":{\"padding\":\"69px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on 'Threat State for Type: {ThreatType}' pie chart to see 'Details of Emails for Threat State and Threat Type'\"},\"conditionalVisibilities\":[{\"parameterName\":\"ThreatState\",\"comparison\":\"isEqualTo\"},{\"parameterName\":\"ThreatType\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"text - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend ['Threat Type'] = replace_string(trim(@\\\"\\\\s\\\", ['Threat Type']),\\\"_\\\",\\\" \\\"),\\r\\n         ['Threat State'] = replace_string(trim(@\\\"\\\\s\\\", ['Threat State']),\\\"_\\\",\\\" \\\")\\r\\n| where ['Threat Type'] == '{ThreatType}' and ['Threat State'] == '{ThreatState}'\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| project Sender, Recipients, Subject, ['Threat State'], ['Threat Type']\",\"size\":0,\"showAnalytics\":true,\"title\":\"Details of Emails for Threat State: {ThreatState} and Threat Type: {ThreatType}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"conditionalVisibilities\":[{\"parameterName\":\"ThreatType\",\"comparison\":\"isNotEqualTo\"},{\"parameterName\":\"ThreatState\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"query - 18\",\"styleSettings\":{\"showBorder\":true}}],\"exportParameters\":true},\"name\":\"group - 20\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend senderGeoDetails = geo_info_from_ip_address(['Sender IP'])\\r\\n| extend latitude = senderGeoDetails.latitude, longitude = senderGeoDetails.longitude, country = senderGeoDetails.country, state = senderGeoDetails.state, city = senderGeoDetails.city\\r\\n| where isnotempty(latitude) and isnotempty(longitude)\\r\\n| extend label = strcat(\\r\\n    iif(strlen(city) > 0, strcat(city, \\\", \\\"), \\\"\\\"),\\r\\n    iif(strlen(state) > 0, strcat(state, \\\", \\\"), \\\"\\\"),\\r\\n    country\\r\\n)\\r\\n| extend label = trim(\\\", \\\", label)\\r\\n| extend label = iif(strlen(label) > 0, label, \\\"N/A\\\")\\r\\n| summarize  count() by tostring(latitude), tostring(longitude), label\",\"size\":3,\"showAnalytics\":true,\"title\":\"Messages Sent by Country\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"LatLong\",\"latitude\":\"latitude\",\"longitude\":\"longitude\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"labelSettings\":\"label\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"count_\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"name\":\"query - 15\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Direction == \\\"INBOUND\\\"\\r\\n| extend details = geo_info_from_ip_address(['Sender IP'])\\r\\n| extend Country = trim(@\\\"\\\\s\\\", tostring(details.country))\\r\\n| where isnotempty(Country)\\r\\n| summarize count() by Country\\r\\n| top 10 by count_  \",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Inbound Email Detections by Origin\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Country\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 10\",\"styleSettings\":{\"padding\":\"49px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend Domain = tostring(split(['Sender Envelope'],\\\"@\\\")[1])\\r\\n| where isnotempty(Domain)\\r\\n| summarize count() by Domain\\r\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Sender Domains\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Domain\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 11\",\"styleSettings\":{\"padding\":\"49px\",\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend Subtype = replace_string(trim(@\\\"\\\\s\\\", Subtype),\\\"_\\\",\\\" \\\")\\r\\n| where isnotempty(Subtype)\\r\\n| summarize count() by Subtype\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Threat Sub Types\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"Subtype\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"100\",\"name\":\"query - 12\",\"styleSettings\":{\"padding\":\"49px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on 'Threat Sub Types' pie chart to see 'Details of Emails for Sub Type'\"},\"conditionalVisibility\":{\"parameterName\":\"Subtype\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 1\"}],\"exportParameters\":true},\"customWidth\":\"50\",\"name\":\"group - 19\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where ['Sender Envelope'] contains \\\"@\\\"\\r\\n| summarize count() by ['Sender Envelope']\\r\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Senders\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Sender Envelope\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 13\",\"styleSettings\":{\"padding\":\"49px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend ['Threat Type'] = replace_string(['Threat Type'],\\\"_\\\",\\\" \\\"),\\r\\n         ['Threat State'] = replace_string(['Threat State'],\\\"_\\\",\\\" \\\"),\\r\\n         Subtype = replace_string(trim(@\\\"\\\\s\\\", Subtype),\\\"_\\\",\\\" \\\")\\r\\n| where Subtype == '{Subtype}'\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| project Sender, Recipients, Subject, ['Threat State'], ['Threat Type']\",\"size\":0,\"showAnalytics\":true,\"title\":\"Details of Emails for Sub Type: {Subtype}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Subtype\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 17\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| extend recipients = todynamic(Recipients)\\r\\n| mv-expand recipients\\r\\n| where recipients contains \\\"@\\\"\\r\\n| summarize count() by tostring(recipients)\\r\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Receivers\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"recipients\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 14\",\"styleSettings\":{\"padding\":\"49px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Type == \\\"urlclick\\\"\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| extend Tags = replace_string(Tags,'\\\"','') \\r\\n| extend Tags = replace_string(Tags,',',', ') \\r\\n| extend  Tags = trim(@\\\"[\\\\[\\\\]]\\\",Tags)\\r\\n| extend Attachments = replace_string(Attachments,'\\\"','') \\r\\n| extend Attachments = replace_string(Attachments,',',', ') \\r\\n|extend  Attachments = trim(@\\\"[\\\\[\\\\]]\\\",Attachments)\\r\\n| extend  ['Message ID'] = trim(@\\\"[\\\\<\\\\>]\\\", ['Message ID'] )\\r\\n| project Sender,\\r\\n        ['Sender IP'],\\r\\n        Recipients,\\r\\n        ['Threat State'],\\r\\n        ['Threat Type'],\\r\\n        ['Policies Applied'],\\r\\n        ['Account ID'],\\r\\n        ['Aggregate ID'],\\r\\n        ['Processing ID'],\\r\\n        ['Message ID'],\\r\\n        [\\\"Event Time\\\"],\\r\\n        Attachments,\\r\\n        Tags,\\r\\n        Subject,\\r\\n        Source,\\r\\n        Direction,\\r\\n        ['Sender Header'],\\r\\n        ['Historical Mail'],\\r\\n        Type,\\r\\n        Subtype\",\"size\":0,\"showAnalytics\":true,\"title\":\"Url Protect Overview\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 20\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCloudIntegrated\\r\\n| where Type == \\\"entities\\\"\\r\\n| project-rename Sender = ['Sender Envelope']\\r\\n| extend Recipients = replace_string(Recipients,'\\\"','') \\r\\n| extend Recipients = replace_string(Recipients,',',', ') \\r\\n| extend  Recipients = trim(@\\\"[\\\\[\\\\]]\\\",Recipients)\\r\\n| extend Tags = replace_string(Tags,'\\\"','') \\r\\n| extend Tags = replace_string(Tags,',',', ') \\r\\n| extend  Tags = trim(@\\\"[\\\\[\\\\]]\\\",Tags)\\r\\n| extend Attachments = replace_string(Attachments,'\\\"','') \\r\\n| extend Attachments = replace_string(Attachments,',',', ') \\r\\n|extend  Attachments = trim(@\\\"[\\\\[\\\\]]\\\",Attachments)\\r\\n| extend  ['Message ID'] = trim(@\\\"[\\\\<\\\\>]\\\", ['Message ID'] )\\r\\n| project    Type, Sender,\\r\\n        ['Sender IP'],\\r\\n        Recipients,\\r\\n        ['Threat State'],\\r\\n        ['Threat Type'],\\r\\n        ['Policies Applied'],\\r\\n        ['Account ID'],\\r\\n        ['Aggregate ID'],\\r\\n        ['Processing ID'],\\r\\n        ['Message ID'],\\r\\n        [\\\"Event Time\\\"],\\r\\n        Attachments,\\r\\n        Tags,\\r\\n        Subject,\\r\\n        Source,\\r\\n        Direction,\\r\\n        ['Sender Header'],\\r\\n        ['Historical Mail'],\\r\\n        Subtype\",\"size\":0,\"showAnalytics\":true,\"title\":\"Entities Overview\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 20 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"📝 ***Refresh the web page to fetch details of recently collected events***\"},\"name\":\"text - 16\"}]},\"name\":\"group - 0\"}],\"fromTemplateId\":\"Sentinel-Mimecast-Cloud-Integrated-Workbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId3'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=Mimecast_Cloud_Integrated_Workbook; logoFileName=Mimecast.svg; description=A workbook providing insights into Mimecast Cloud Integrated.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Mimecast Cloud Integrated Workbook; templateRelativePath=Mimecast_Cloud_Integrated_Workbook.json; subtitle=; provider=Mimecast}.description",
                "parentId": "[variables('workbookId3')]",
                "contentId": "[variables('_workbookContentId3')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Cloud_Integrated_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "MimecastCIAPI",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId3')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook3-name')]",
        "contentProductId": "[variables('_workbookcontentProductId3')]",
        "id": "[variables('_workbookcontentProductId3')]",
        "version": "[variables('workbookVersion3')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName4')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_SEG_Workbook Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion4')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId4')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "A workbook providing insights into Mimecast Secure Email Gateway."
              },
              "properties": {
                "displayName": "[parameters('workbook4-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"f951ba63-69db-4e29-b73e-700430a58329\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Email Activity Summary\",\"subTarget\":\"2\",\"style\":\"link\"},{\"id\":\"6cb5e992-de3d-43c4-8b2c-32b56cf33cc1\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Email Receipt\",\"subTarget\":\"1\",\"preText\":\"Email Receipt\",\"style\":\"link\"},{\"id\":\"43335114-8770-48e6-b02f-c9b7ee185cc1\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Email Delivery\",\"subTarget\":\"3\",\"style\":\"link\"},{\"id\":\"ffbb9e0f-8551-4797-b28a-fdda3671f1f5\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"AV / AS\",\"subTarget\":\"7\",\"style\":\"link\"},{\"id\":\"7438a20b-c11b-45b9-8c90-1e69e47fa220\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"TLS\",\"subTarget\":\"4\",\"style\":\"link\"},{\"id\":\"312e014c-a77d-4b0f-8d76-e25c13ed3716\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Email Spam\",\"subTarget\":\"8\",\"style\":\"link\",\"linkIsContextBlade\":true},{\"id\":\"6d11cffc-b20e-42be-95d1-8812a2d876e5\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Internal Email Protect\",\"subTarget\":\"6\",\"style\":\"link\"},{\"id\":\"b2026a8b-8136-4d89-b26c-cffda38fcdee\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Email Journal\",\"subTarget\":\"9\",\"style\":\"link\"},{\"id\":\"8605b3c8-3b53-42ac-9e6c-cbf235909733\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Data Leak Prevention\",\"subTarget\":\"5\",\"style\":\"link\"}]},\"name\":\"links - 1\"},{\"type\":1,\"content\":{\"json\":\"--- \"},\"name\":\"text - 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"b627c016-a002-4b73-a1b6-9c2e30f91d86\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type ==\\\"email_delivery\\\"\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Direction\",\"size\":0,\"showAnalytics\":true,\"title\":\"Email Traffic\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 1\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let min_t = toscalar(\\r\\n    MimecastCG \\r\\n    | where Type == \\\"email_receipt\\\" and isnotempty(['Rejection Type'])\\r\\n    | summarize min_time = min(['Event Time'])\\r\\n    | extend min_t = iff(isempty(min_time),now(),min_time)\\r\\n    | project min_t);\\r\\nMimecastCG \\r\\n| where Type == \\\"email_receipt\\\" and isnotempty(['Rejection Type']) \\r\\n| make-series Trend = count() default = 0 on ['Event Time'] from min_t to now() step 1d by tostring(['Rejection Type']) \\r\\n| project-away ['Event Time'] \\r\\n| extend Count = array_sum(Trend) \\r\\n| project ['Rejection Type'] , Count, ['Spark Line'] = Trend \\r\\n| order by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Rejections\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"lightBlue\"}},{\"columnMatch\":\"Spark Line\",\"formatter\":9,\"formatOptions\":{\"palette\":\"blue\"}}]}},\"customWidth\":\"33\",\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"\\r\\nlet min_t = toscalar(\\r\\n    MimecastCG \\r\\n    | where Type == \\\"email_delivery\\\" and isnotempty(['Rejection Type'])\\r\\n    | summarize min_time = min(['Event Time'])\\r\\n    | extend min_t = iff(isempty(min_time),now(),min_time)\\r\\n    | project min_t);\\r\\nMimecastCG \\r\\n| where Type == \\\"email_delivery\\\" and isnotempty(['Rejection Type'])\\r\\n| make-series Trend = count() default = 0 on ['Event Time'] from min_t to now() step 1d by tostring(['Rejection Type']) \\r\\n| project-away ['Event Time'] \\r\\n| extend Count = array_sum(Trend) \\r\\n| project ['Rejection Type'], Count, ['Spark Line'] = Trend \\r\\n| order by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Delivery Failures\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"lightBlue\"}},{\"columnMatch\":\"Spark Line\",\"formatter\":9,\"formatOptions\":{\"palette\":\"blue\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 2 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let min_t = toscalar(\\r\\n    MimecastCG\\r\\n    | where Type == \\\"email_process\\\" and isnotempty(['Hold Reason'])\\r\\n    | summarize min_time = min(['Event Time'])\\r\\n    | extend min_t = iff(isempty(min_time),now(),min_time)\\r\\n    | project min_t);\\r\\nMimecastCG\\r\\n| where Type == \\\"email_process\\\" and isnotempty(['Hold Reason'])\\r\\n| make-series Trend = count() default = 0 on ['Event Time'] from min_t to now() step 1d by tostring(['Hold Reason'])\\r\\n| project-away ['Event Time']\\r\\n| extend Count=array_sum(Trend)\\r\\n| project ['Hold Reason'], Count,['Spark Line'] = Trend\\r\\n| order by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Held\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"lightBlue\"}},{\"columnMatch\":\"Spark Line\",\"formatter\":9,\"formatOptions\":{\"palette\":\"blue\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 2 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"2\"},\"name\":\"group - 3\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"3eec960e-69f2-487a-986f-e3b495ce6818\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\"\\r\\n| summarize  count() by Direction, Action, ['Sender IP']\\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Received\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"MessagesReceived\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"blue\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\"\\r\\n| where Action in~ (\\\"Acc\\\", \\\"RTY\\\")\\r\\n| summarize  count() by Direction, Action, ['Sender IP']\\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Accepted\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"MessagesAccepted\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"green\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\"\\r\\n| where Action in~ (\\\"REJ\\\", \\\"BNC\\\")\\r\\n| summarize  count() by Direction, Action, ['Sender IP']\\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\\r\\n\\r\\n// Rej and Bnc are considered as blocked\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Rejected\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"MessagesRejected\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"amethyst\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\" and Action in~ (\\\"Acc\\\", \\\"RTY\\\")\\r\\n| where isempty( ['TLS Version'])\\r\\n| summarize  count() by Direction, Action, ['Sender IP']\\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\\r\\n\\r\\n//Acc and Rty are considered as delivered\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Accepted without TLS\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"MessagesAcceptedwithoutTLS\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"orangeDark\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 To view message details, please click on any of the tiles above\"},\"conditionalVisibility\":{\"parameterName\":\"TileAction\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\"\\r\\n| project  ['Aggregate ID'] ,\\r\\n['Processing ID'],\\r\\n['Account ID'] ,\\r\\n['Action'],\\r\\n['Type'],\\r\\n['Sender Envelope'] ,\\r\\n['Message ID'] ,\\r\\n['Subject'],\\r\\n['Recipients'] ,\\r\\n['Sender IP'] ,\\r\\n['Rejection Type'] ,\\r\\n['Rejection Code'] ,\\r\\n['Direction'] ,\\r\\n['Number of Attachments'] ,\\r\\n['Sender Header'] ,\\r\\n['Rejection Info'] ,\\r\\n[\\\"TLS Version\\\"],\\r\\n[\\\"TLS Cipher\\\"],\\r\\n['Spam Info'] ,\\r\\n['Spam Processing Detail'] ,\\r\\n['Virus Found'] ,\\r\\n['Event Time'] ,\\r\\n['Sub Type'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Received\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"MessagesReceived\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\"\\r\\n| where Action in~ (\\\"Acc\\\", \\\"RTY\\\")\\r\\n| project  ['Aggregate ID'] ,\\r\\n['Processing ID'],\\r\\n['Account ID'] ,\\r\\n['Action'],\\r\\n['Type'],\\r\\n['Sender Envelope'] ,\\r\\n['Message ID'] ,\\r\\n['Subject'],\\r\\n['Recipients'] ,\\r\\n['Sender IP'] ,\\r\\n['Rejection Type'] ,\\r\\n['Rejection Code'] ,\\r\\n['Direction'] ,\\r\\n['Number of Attachments'] ,\\r\\n['Sender Header'] ,\\r\\n['Rejection Info'] ,\\r\\n[\\\"TLS Version\\\"],\\r\\n[\\\"TLS Cipher\\\"],\\r\\n['Spam Info'] ,\\r\\n['Spam Processing Detail'] ,\\r\\n['Virus Found'] ,\\r\\n['Event Time'] ,\\r\\n['Sub Type'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Accepted\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"MessagesAccepted\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 2 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\"\\r\\n| where Action in~ (\\\"REJ\\\", \\\"BNC\\\")\\r\\n| project  ['Aggregate ID'] ,\\r\\n['Processing ID'],\\r\\n['Account ID'] ,\\r\\n['Action'],\\r\\n['Type'],\\r\\n['Sender Envelope'] ,\\r\\n['Message ID'] ,\\r\\n['Subject'],\\r\\n['Recipients'] ,\\r\\n['Sender IP'] ,\\r\\n['Rejection Type'] ,\\r\\n['Rejection Code'] ,\\r\\n['Direction'] ,\\r\\n['Number of Attachments'] ,\\r\\n['Sender Header'] ,\\r\\n['Rejection Info'] ,\\r\\n[\\\"TLS Version\\\"],\\r\\n[\\\"TLS Cipher\\\"],\\r\\n['Spam Info'] ,\\r\\n['Spam Processing Detail'] ,\\r\\n['Virus Found'] ,\\r\\n['Event Time'] ,\\r\\n['Sub Type'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Rejected\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"MessagesRejected\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 2 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and Action in~ (\\\"Acc\\\", \\\"RTY\\\")\\r\\n| where isempty([\\\"TLS Version\\\"])\\r\\n| project  \\r\\n['Aggregate ID'] ,\\r\\n['Processing ID'] ,\\r\\n['Account ID'],\\r\\n['Action'],\\r\\n['Type'],\\r\\n['Sender Envelope'],\\r\\n['Message ID'] ,\\r\\n['Subject'] ,\\r\\n['Recipients'] ,\\r\\n['Sender IP'] ,\\r\\n['Rejection Type'] ,\\r\\n['Rejection Code'] ,\\r\\n['Direction'] ,\\r\\n['Number of Attachments'] ,\\r\\n['Sender Header'] ,\\r\\n['Rejection Info'],\\r\\n[\\\"TLS Version\\\"],\\r\\n[\\\"TLS Cipher\\\"],\\r\\n['Spam Info'] ,\\r\\n['Spam Processing Detail'] ,\\r\\n['Virus Found'] ,\\r\\n['Event Time'],\\r\\n['Sub Type']\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Accepted without TLS\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"MessagesAcceptedwithoutTLS\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 2 - Copy - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"name\":\"group - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\" and Action in~ (\\\"Acc\\\", \\\"RTY\\\")\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Direction\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Accepted by Route\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\" and Action in~ (\\\"Acc\\\", \\\"RTY\\\") and isnotempty( ['Sender IP'])\\r\\n| extend senderGeoDetails = geo_info_from_ip_address(['Sender IP'])\\r\\n| extend latitude = senderGeoDetails.latitude, longitude = senderGeoDetails.longitude, country = senderGeoDetails.country, state = senderGeoDetails.state, city = senderGeoDetails.city\\r\\n| where isnotempty(latitude) and isnotempty(longitude)\\r\\n| extend label = strcat(\\r\\n    iif(strlen(city) > 0, strcat(city, \\\", \\\"), \\\"\\\"),\\r\\n    iif(strlen(state) > 0, strcat(state, \\\", \\\"), \\\"\\\"),\\r\\n    country\\r\\n)\\r\\n| extend label = trim(\\\", \\\", label)\\r\\n| extend label = iif(strlen(label) > 0, label, \\\"N/A\\\")\\r\\n| summarize  count() by tostring(latitude), tostring(longitude), label\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Accepted by Source Country\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"LatLong\",\"latitude\":\"latitude\",\"longitude\":\"longitude\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"minData\":-1,\"labelSettings\":\"label\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"count_\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"50\",\"name\":\"query - 3\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type== \\\"email_receipt\\\" and Action in~ (\\\"REJ\\\", \\\"BNC\\\") and isnotempty( ['Sender IP'])\\r\\n| extend senderGeoDetails = geo_info_from_ip_address(['Sender IP'])\\r\\n| extend latitude = senderGeoDetails.latitude, longitude = senderGeoDetails.longitude, country = senderGeoDetails.country, state = senderGeoDetails.state, city = senderGeoDetails.city\\r\\n| where isnotempty(latitude) and isnotempty(longitude)\\r\\n| extend label = strcat(\\r\\n    iif(strlen(city) > 0, strcat(city, \\\", \\\"), \\\"\\\"),\\r\\n    iif(strlen(state) > 0, strcat(state, \\\", \\\"), \\\"\\\"),\\r\\n    country\\r\\n)\\r\\n| extend label = trim(\\\", \\\", label)\\r\\n| extend label = iif(strlen(label) > 0, label, \\\"N/A\\\")\\r\\n| summarize  count() by tostring(latitude), tostring(longitude), label\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Rejected by Source Country\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"LatLong\",\"latitude\":\"latitude\",\"longitude\":\"longitude\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"minData\":-1,\"labelSettings\":\"label\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"count_\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"50\",\"name\":\"query - 3 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"1\"},\"name\":\"group - 0\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"3eec960e-69f2-487a-986f-e3b495ce6818\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"true\\\"\\r\\n| summarize  count() by Direction , Delivered , ['Destination IP'] , ['TLS Used'] \\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Delivered\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"MessageDelivered\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"25%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered ==  \\\"false\\\"  and Direction == \\\"Outbound\\\"\\r\\n| summarize  count() by Direction , Delivered  , ['TLS Used']  \\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Outbound Delivery Failures\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"Outbounddeliveryfailures\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"purple\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"25%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"false\\\" and Direction == \\\"Inbound\\\"\\r\\n| summarize  count() by Direction , Delivered , ['Destination IP'] , ['TLS Used']  \\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Inbound Delivery Failures\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"InboundDeliveryFailures\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"greenDark\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"25%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"true\\\" and ['TLS Used']  == \\\"No\\\"\\r\\n| summarize  count() by Direction , Delivered , ['Destination IP'] , ['TLS Used'] \\r\\n| summarize sum(count_)\\r\\n| project TotalCount = sum_count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Delivered without TLS\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"TotalCount\",\"parameterName\":\"MessagesDeliveredwithoutTLS\"},{\"fieldName\":\"TotalCount\",\"parameterName\":\"TileAction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"orangeDark\"}},\"showBorder\":false}},\"customWidth\":\"25\",\"name\":\"query - 0 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"25%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 To view message details, please click on any of the tiles above\"},\"conditionalVisibility\":{\"parameterName\":\"TileAction\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 9\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"true\\\"\\r\\n| project     \\r\\n    [\\\"Aggregate ID\\\"] ,\\r\\n    [\\\"Processing ID\\\"],\\r\\n    [\\\"Delivered\\\"] ,\\r\\n    [\\\"Destination IP\\\"] ,\\r\\n    [\\\"Host Name\\\"],\\r\\n    [\\\"Delivery Attempts\\\"] ,\\r\\n    [\\\"TLS Used\\\"] ,\\r\\n    [\\\"Route\\\"] ,\\r\\n    [\\\"Account ID\\\"] ,\\r\\n    [\\\"Event Time\\\"] ,\\r\\n    [\\\"Sender Envelope\\\"] ,\\r\\n    [\\\"Message ID\\\"] ,\\r\\n    [\\\"Subject\\\"] ,\\r\\n    [\\\"Total of Size Attachments\\\"] ,\\r\\n    [\\\"Number of Attachments\\\"] ,\\r\\n    [\\\"Email Size\\\"] ,\\r\\n    [\\\"Type\\\"] ,\\r\\n    [\\\"Sub Type\\\"] ,\\r\\n    [\\\"Recipients\\\"] ,\\r\\n    [\\\"Direction\\\"] ,\\r\\n    [\\\"TLS Version\\\"] ,\\r\\n    [\\\"TLS Cipher\\\"]  ,\\r\\n    [\\\"Delivery Errors\\\"] ,\\r\\n    [\\\"Rejection Type\\\"] ,\\r\\n    [\\\"Rejection Code\\\"] ,\\r\\n    [\\\"Rejection Info\\\"] \\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Delivered\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"MessageDelivered\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered ==  \\\"false\\\"  and Direction == \\\"Outbound\\\"\\r\\n| project          \\r\\n    [\\\"Aggregate ID\\\"] ,\\r\\n    [\\\"Processing ID\\\"],\\r\\n    [\\\"Delivered\\\"] ,\\r\\n    [\\\"Destination IP\\\"] ,\\r\\n    [\\\"Host Name\\\"] ,\\r\\n    [\\\"Delivery Attempts\\\"] ,\\r\\n    [\\\"TLS Used\\\"] ,\\r\\n    [\\\"Route\\\"] ,\\r\\n    [\\\"Account ID\\\"] ,\\r\\n    [\\\"Event Time\\\"] ,\\r\\n    [\\\"Sender Envelope\\\"] ,\\r\\n    [\\\"Message ID\\\"] ,\\r\\n    [\\\"Subject\\\"] ,\\r\\n    [\\\"Total of Size Attachments\\\"] ,\\r\\n    [\\\"Number of Attachments\\\"] ,\\r\\n    [\\\"Email Size\\\"] ,\\r\\n    [\\\"Type\\\"] ,\\r\\n    [\\\"Sub Type\\\"] ,\\r\\n    [\\\"Recipients\\\"] ,\\r\\n    [\\\"Direction\\\"] ,\\r\\n    [\\\"TLS Version\\\"] ,\\r\\n    [\\\"TLS Cipher\\\"]  ,\\r\\n    [\\\"Delivery Errors\\\"] ,\\r\\n    [\\\"Rejection Type\\\"] ,\\r\\n    [\\\"Rejection Code\\\"] ,\\r\\n    [\\\"Rejection Info\\\"] \\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Outbound Delivery Failures\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Outbounddeliveryfailures\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"false\\\" and Direction == \\\"Inbound\\\"\\r\\n| project     \\r\\n       [\\\"Aggregate ID\\\"] ,\\r\\n    [\\\"Processing ID\\\"],\\r\\n    [\\\"Delivered\\\"] ,\\r\\n    [\\\"Destination IP\\\"] ,\\r\\n    [\\\"Host Name\\\"] ,\\r\\n    [\\\"Delivery Attempts\\\"] ,\\r\\n    [\\\"TLS Used\\\"] ,\\r\\n    [\\\"Route\\\"] ,\\r\\n    [\\\"Account ID\\\"] ,\\r\\n    [\\\"Event Time\\\"] ,\\r\\n    [\\\"Sender Envelope\\\"] ,\\r\\n    [\\\"Message ID\\\"] ,\\r\\n    [\\\"Subject\\\"] ,\\r\\n    [\\\"Total of Size Attachments\\\"] ,\\r\\n    [\\\"Number of Attachments\\\"] ,\\r\\n    [\\\"Email Size\\\"] ,\\r\\n    [\\\"Type\\\"] ,\\r\\n    [\\\"Sub Type\\\"] ,\\r\\n    [\\\"Recipients\\\"] ,\\r\\n    [\\\"Direction\\\"] ,\\r\\n    [\\\"TLS Version\\\"] ,\\r\\n    [\\\"TLS Cipher\\\"]  ,\\r\\n    [\\\"Delivery Errors\\\"] ,\\r\\n    [\\\"Rejection Type\\\"] ,\\r\\n    [\\\"Rejection Code\\\"] ,\\r\\n    [\\\"Rejection Info\\\"] \\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Inbound Delivery Failures\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"InboundDeliveryFailures\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 8 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"true\\\" and  [\\\"TLS Used\\\"] == \\\"No\\\"\\r\\n| project     \\r\\n        [\\\"Aggregate ID\\\"] ,\\r\\n    [\\\"Processing ID\\\"],\\r\\n    [\\\"Delivered\\\"] ,\\r\\n    [\\\"Destination IP\\\"] ,\\r\\n    [\\\"Host Name\\\"] ,\\r\\n    [\\\"Delivery Attempts\\\"] ,\\r\\n    [\\\"TLS Used\\\"] ,\\r\\n    [\\\"Route\\\"] ,\\r\\n    [\\\"Account ID\\\"] ,\\r\\n    [\\\"Event Time\\\"] ,\\r\\n    [\\\"Sender Envelope\\\"] ,\\r\\n    [\\\"Message ID\\\"] ,\\r\\n    [\\\"Subject\\\"] ,\\r\\n    [\\\"Total of Size Attachments\\\"] ,\\r\\n    [\\\"Number of Attachments\\\"] ,\\r\\n    [\\\"Email Size\\\"] ,\\r\\n    [\\\"Type\\\"] ,\\r\\n    [\\\"Sub Type\\\"] ,\\r\\n    [\\\"Recipients\\\"] ,\\r\\n    [\\\"Direction\\\"] ,\\r\\n    [\\\"TLS Version\\\"] ,\\r\\n    [\\\"TLS Cipher\\\"]  ,\\r\\n    [\\\"Delivery Errors\\\"] ,\\r\\n    [\\\"Rejection Type\\\"] ,\\r\\n    [\\\"Rejection Code\\\"] ,\\r\\n    [\\\"Rejection Info\\\"] \\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Delivered without TLS\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"MessagesDeliveredwithoutTLS\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 8 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered ==  \\\"true\\\"  \\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Direction\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Delivered by Route\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 4\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\"\\r\\n| project     \\r\\n    [\\\"Aggregate ID\\\"] ,\\r\\n    [\\\"Processing ID\\\"],\\r\\n    [\\\"Delivered\\\"] ,\\r\\n    [\\\"Destination IP\\\"] ,\\r\\n    [\\\"Host Name\\\"] ,\\r\\n    [\\\"Delivery Attempts\\\"] ,\\r\\n    [\\\"TLS Used\\\"] ,\\r\\n    [\\\"Route\\\"] ,\\r\\n    [\\\"Account ID\\\"] ,\\r\\n    [\\\"Event Time\\\"] ,\\r\\n    [\\\"Sender Envelope\\\"] ,\\r\\n    [\\\"Message ID\\\"] ,\\r\\n    [\\\"Subject\\\"] ,\\r\\n    [\\\"Total of Size Attachments\\\"] ,\\r\\n    [\\\"Number of Attachments\\\"] ,\\r\\n    [\\\"Email Size\\\"] ,\\r\\n    [\\\"Type\\\"] ,\\r\\n    [\\\"Sub Type\\\"] ,\\r\\n    [\\\"Recipients\\\"] ,\\r\\n    [\\\"Direction\\\"] ,\\r\\n    [\\\"TLS Version\\\"] ,\\r\\n    [\\\"TLS Cipher\\\"]  ,\\r\\n    [\\\"Delivery Errors\\\"] ,\\r\\n    [\\\"Rejection Type\\\"] ,\\r\\n    [\\\"Rejection Code\\\"] ,\\r\\n    [\\\"Rejection Info\\\"] \\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Message Delivery Events\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"true\\\" and Direction == \\\"Outbound\\\"\\r\\n| summarize Count = count() by Direction , Delivered , ['Destination IP'] , ['TLS Used'] \\r\\n| extend geo_info = geo_info_from_ip_address(['Destination IP'])\\r\\n| extend latitude = geo_info.latitude, longitude = geo_info.longitude, country = geo_info.country , state = geo_info.state , city = geo_info.state\\r\\n| where isnotempty(latitude) and isnotempty(longitude)\\r\\n| extend label = strcat(\\r\\n    iif(strlen(city) > 0, strcat(city, \\\", \\\"), \\\"\\\"),\\r\\n    iif(strlen(state) > 0, strcat(state, \\\", \\\"), \\\"\\\"),\\r\\n    country\\r\\n)\\r\\n| extend label = trim(\\\", \\\", label)\\r\\n| extend label = iif(strlen(label) > 0, label, \\\"N/A\\\")\\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Delivered Outbound by Destination Country\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"LatLong\",\"locInfoColumn\":\"DestinationIp\",\"latitude\":\"latitude\",\"longitude\":\"longitude\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"labelSettings\":\"label\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"Count\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"50\",\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"3\"},\"name\":\"group - 3\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"578d7b4c-c261-429f-b39e-a7d3c5ef2d66\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type ==\\\"email_antivirus\\\"\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Route\",\"size\":0,\"showAnalytics\":true,\"title\":\"Anti-Virus Traffic\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 1\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and Action in~ (\\\"Acc\\\", \\\"Rty\\\") and ['Rejection Type'] ==\\\"Virus Signature Detection\\\"\\r\\n| summarize count() \\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Viruses Rejected\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"count_\",\"parameterName\":\"CountTVR\",\"parameterType\":1},{\"fieldName\":\"count_\",\"parameterName\":\"Tileaction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"blue\"}},\"showBorder\":false}},\"customWidth\":\"33\",\"name\":\"query - 0\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and isnotempty( ['Spam Info']) and ['Spam Info'] != \\\"[]\\\"\\r\\n| summarize count() \\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Rejected as Spam\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"count_\",\"parameterName\":\"CountRS\",\"parameterType\":1},{\"fieldName\":\"count_\",\"parameterName\":\"Tileaction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"green\"}},\"showBorder\":false}},\"customWidth\":\"33\",\"name\":\"query - 0 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_process\\\" and ['Hold Reason'] == \\\"Spm\\\"\\r\\n| summarize count() \\r\\n\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Total Messages Held as Spam\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"count_\",\"parameterName\":\"CountHS\",\"parameterType\":1},{\"fieldName\":\"count_\",\"parameterName\":\"Tileaction\",\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"amethyst\"}},\"showBorder\":false}},\"customWidth\":\"33\",\"name\":\"query - 0 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 To view message details, please click on any of the tiles above\"},\"conditionalVisibility\":{\"parameterName\":\"Tileaction\",\"comparison\":\"isEqualTo\"},\"name\":\"text - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and Action in~ (\\\"Acc\\\", \\\"Rty\\\") and [\\\"Rejection Type\\\"] ==\\\"Virus Signature Detection\\\"\\r\\n| project  [\\\"Aggregate ID\\\"], [\\\"Recipients\\\"] , [\\\"Action\\\"] , [\\\"Event Time\\\"] ,[\\\"Sender Envelope\\\"] , [\\\"Message ID\\\"] , [\\\"Subject\\\"] , [\\\"Number of Attachments\\\"] , [\\\"Type\\\"] = Type, [\\\"Sub Type\\\"] ,  [\\\"Sender IP\\\"] , [\\\"Direction\\\"], [\\\"Sender Header\\\"] , [\\\"TLS Version\\\"] , [\\\"TLS Cipher\\\"] , [\\\"Spam Info\\\"] ,[\\\"Virus Found\\\"] , [\\\"Spam Processing Detail\\\"],[\\\"Rejection Type\\\"] ,[\\\"Rejection Code\\\"], [\\\"Rejection Info\\\"] , [\\\"Processing ID\\\"] , [\\\"Account ID\\\"] \\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Viruses Rejected\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"CountTVR\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and isnotempty(['Spam Info']) and ['Spam Info'] != \\\"[]\\\"\\r\\n| project  [\\\"Aggregate ID\\\"], [\\\"Recipients\\\"] , [\\\"Action\\\"] , [\\\"Event Time\\\"] ,[\\\"Sender Envelope\\\"] , [\\\"Message ID\\\"] , [\\\"Subject\\\"] , [\\\"Number of Attachments\\\"] , [\\\"Type\\\"] = Type, [\\\"Sub Type\\\"] ,  [\\\"Sender IP\\\"] , [\\\"Direction\\\"], [\\\"Sender Header\\\"] , [\\\"TLS Version\\\"] , [\\\"TLS Cipher\\\"] , [\\\"Spam Info\\\"] ,[\\\"Virus Found\\\"] , [\\\"Spam Processing Detail\\\"],[\\\"Rejection Type\\\"] ,[\\\"Rejection Code\\\"], [\\\"Rejection Info\\\"] , [\\\"Processing ID\\\"] , [\\\"Account ID\\\"] \\r\\n\\r\\n\\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Rejected as Spam\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true},\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"blue\"}},\"showBorder\":false}},\"conditionalVisibility\":{\"parameterName\":\"CountRS\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 0 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_process\\\" and ['Hold Reason'] == \\\"Spm\\\"\\r\\n| project  [\\\"Aggregate ID\\\"], [\\\"Recipients\\\"] , [\\\"Action\\\"] , [\\\"Event Time\\\"],  ['Hold Reason'] ,[\\\"Sender Envelope\\\"] , [\\\"Message ID\\\"] , [\\\"Subject\\\"] , [\\\"Number of Attachments\\\"] , [\\\"Type\\\"] = Type, [\\\"Sub Type\\\"] ,  [\\\"Sender IP\\\"] , [\\\"Direction\\\"], [\\\"Sender Header\\\"] , [\\\"TLS Version\\\"] , [\\\"TLS Cipher\\\"] , [\\\"Spam Info\\\"] ,[\\\"Virus Found\\\"] , [\\\"Spam Processing Detail\\\"],[\\\"Rejection Type\\\"] ,[\\\"Rejection Code\\\"], [\\\"Rejection Info\\\"] , [\\\"Processing ID\\\"] , [\\\"Account ID\\\"] \\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Held as Spam\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"CountHS\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 9\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and isnotempty(['Virus Found'])\\r\\n| summarize Count = count() by ['Sender Envelope'] , Recipients , ['Sender IP'],['Virus Found'] , ['Event Time']\\r\\n| sort by Count desc\\r\\n| extend Sender = ['Sender Envelope'] , Recipient =  Recipients , [\\\"Source IP\\\"] = ['Sender IP'], [\\\"Virus Name\\\"] = ['Virus Found']\\r\\n| project Sender, Recipient, [\\\"Source IP\\\"], [\\\"Virus Name\\\"], Count , ['Event Time']\\r\\n| extend Count = iff(isnull(Count), 0, Count)\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Rejected Due to Virus\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true},\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"blue\"}},\"showBorder\":false}},\"customWidth\":\"50\",\"name\":\"query - 0 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and isnotempty(['Spam Info'] ) and ['Spam Info'] != \\\"[]\\\"\\r\\n| summarize Count = count() by ['Sender Envelope'] , Recipients , ['Sender IP'],['Spam Info'] , ['Event Time']\\r\\n| sort by Count desc\\r\\n| extend Sender = ['Sender Envelope'] , Recipient =  Recipients , [\\\"Source IP\\\"] = ['Sender IP'], [\\\"Spam Information\\\"]  = ['Spam Info'] \\r\\n| project Sender, Recipient, [\\\"Source IP\\\"], [\\\"Spam Information\\\"], Count ,['Event Time']\\r\\n| extend Count = iff(isnull(Count), 0, Count)\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Messages Rejected as Spam\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true},\"tileSettings\":{\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":-1,\"palette\":\"blue\"}},\"showBorder\":false}},\"customWidth\":\"50\",\"name\":\"query - 0 - Copy - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"7\"},\"name\":\"group - 7\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"02075565-ceae-47c2-ba15-44b2f74313c4\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered == \\\"true\\\" and isnotnull(['TLS Used'])\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by ['TLS Used']\",\"size\":0,\"showAnalytics\":true,\"title\":\"TLS Delivery\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 1\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and Delivered== \\\"true\\\" and isnotempty(['TLS Version'])\\r\\n| summarize Count = count(Recipients) by bin(['Event Time'] , 1d), ['TLS Version']\",\"size\":0,\"showAnalytics\":true,\"title\":\"TLS Versions (Delivery)\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"chartSettings\":{\"group\":\"TLS Version\"}},\"customWidth\":\"50\",\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and isnotempty(['TLS Version'])\\r\\n| summarize Count = count(Recipients) by bin(['Event Time'] , 1d), ['TLS Version']\",\"size\":0,\"showAnalytics\":true,\"title\":\"TLS Versions (Receipt)\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"chartSettings\":{\"group\":\"TLS Version\"}},\"customWidth\":\"50\",\"name\":\"query - 2 - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and isnotempty(['TLS Cipher'])\\r\\n| summarize count() by Cipher = ['TLS Cipher'] \\r\\n| sort by count_ desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Delivery Ciphers\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true},\"chartSettings\":{\"group\":\"Cipher\"}},\"customWidth\":\"50\",\"name\":\"query - 2 - Copy - Copy\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and isnotempty(['TLS Cipher'])\\r\\n| summarize count() by Cipher = ['TLS Cipher'] \\r\\n| sort by count_ desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Receipt Ciphers\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true},\"chartSettings\":{\"group\":\"Cipher\"}},\"customWidth\":\"50\",\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_delivery\\\" and ['TLS Used'] == \\\"No\\\" and Delivered == \\\"true\\\"\\r\\n| extend temp = split(Recipients, \\\"@\\\")\\r\\n| extend [\\\"Recipient Domain\\\"] = tostring(temp[1])\\r\\n| summarize Count = count() by [\\\"Recipient Domain\\\"] \\r\\n| top 10 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 Recipient Domains not Using TLS\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"chartSettings\":{\"group\":\"*\"}},\"customWidth\":\"50\",\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_receipt\\\" and  Action in~ (\\\"Acc\\\", \\\"Rty\\\")  and isempty(['TLS Version'])\\r\\n| extend temp = split(['Sender Envelope'], \\\"@\\\")\\r\\n| extend [\\\"Sending Domain\\\"] = tostring(temp[1])\\r\\n| summarize Count = count() by [\\\"Sending Domain\\\"] \\r\\n| top 10 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 Sending Domains not Using TLS\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"chartSettings\":{\"group\":\"Sending Domain\"}},\"customWidth\":\"50\",\"name\":\"query - 4\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"4\"},\"name\":\"group - 3\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"cbe43313-4782-4061-b7c0-d48e146bfeb1\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 4\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastDLP\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Action\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Data Leak Prevention Events\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"chartSettings\":{\"group\":\"*\",\"createOtherGroup\":25,\"seriesLabelSettings\":[{\"seriesName\":\"data_leak_prevention_notification\",\"label\":\"Notification\"},{\"seriesName\":\"data_leak_prevention_hold\",\"label\":\"Hold\"},{\"seriesName\":\"data_leak_prevention_smart_folder\",\"label\":\"Smart Folder\"},{\"seriesName\":\"data_leak_prevention_secure_messaging\",\"label\":\"Secure Messaging\"},{\"seriesName\":\"data_leak_prevention_secure_delivery\",\"label\":\"Secure Delivery\"},{\"seriesName\":\"data_leak_prevention_bounce\",\"label\":\"Bounce\"},{\"seriesName\":\"data_leak_prevention_stationery\",\"label\":\"Stationary\"},{\"seriesName\":\"data_leak_prevention_delete\",\"label\":\"Delete\"},{\"seriesName\":\"data_leak_prevention_meta_expire\",\"label\":\"Meta Expire\"},{\"seriesName\":\"data_leak_prevention_content_expire\",\"label\":\"Content Expire\"}]}},\"name\":\"query - 23\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastDLP\\n| summarize count() by Route\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"DLP Events by Route\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Route\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 30\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastDLP\\n| summarize count() by Action\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"DLP Events by Actions Triggered\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Action\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 29\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastDLP\\n| summarize count() by Policy\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"DLP Events by Policies Triggered\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Policy\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 27\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"33%\"}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"5\"},\"name\":\"group - 36\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"ba10bbf5-0743-4e41-8555-11302a815979\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_iep\\\"\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Route\",\"size\":0,\"showAnalytics\":true,\"title\":\"Internal Email Protection by Route\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_iep\\\"\\r\\n| project\\r\\n    ['Aggregate ID'],\\r\\n    ['Processing ID'] ,\\r\\n    ['Account ID'] ,\\r\\n    Type,\\r\\n    ['Event Time'],\\r\\n    ['Sender Envelope'] ,\\r\\n    Subject,\\r\\n    Recipients,\\r\\n    ['Url Category'],\\r\\n    ['Scan Results'] ,\\r\\n    Route,\\r\\n    ['Message ID'] ,\\r\\n    ['Monitored Domain Source'] ,\\r\\n    ['Similar Domain'] ,\\r\\n    ['Sub Type'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Internal Event Protection Events\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"6\"},\"name\":\"group - 8\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"ba10bbf5-0743-4e41-8555-11302a815979\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_journal\\\"\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Direction\",\"size\":0,\"showAnalytics\":true,\"title\":\"Journal Messages by Direction\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_journal\\\"\\r\\n| project\\r\\n    ['Aggregate ID'] ,\\r\\n    ['Processing ID'],\\r\\n    ['Account ID'],\\r\\n    Type,\\r\\n    ['Event Time'],\\r\\n    ['Sender Envelope'] ,\\r\\n    Recipients,\\r\\n    Direction,\\r\\n    ['Sub Type'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Journal Message Events\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"9\"},\"name\":\"group - 8 - Copy\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"3301a4a8-8498-43bd-8a9b-fd331320f2a6\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type ==\\\"email_spam\\\" and isnotempty(Route)\\r\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Route\",\"size\":0,\"showAnalytics\":true,\"title\":\"Spam Messages by Route\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"name\":\"query - 1\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_spam\\\"\\r\\n| project\\r\\n    ['Aggregate ID'] ,\\r\\n    ['Processing ID'],\\r\\n    ['Account ID'] ,\\r\\n    Type,\\r\\n    ['Event Time'],\\r\\n    ['Sender Envelope'] ,\\r\\n    Subject,\\r\\n    Recipients,\\r\\n    ['Sender IP'] ,\\r\\n    ['Sender Domain'] ,\\r\\n    ['Sender Header'],\\r\\n    Route,\\r\\n    ['Sub Type'] \",\"size\":0,\"showAnalytics\":true,\"title\":\"Spam Message Events\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastCG\\r\\n| where Type == \\\"email_spam\\\" and isnotempty(['Sender IP'])\\r\\n| extend senderGeoDetails = geo_info_from_ip_address(['Sender IP'])\\r\\n| extend latitude = senderGeoDetails.latitude, longitude = senderGeoDetails.longitude, country = senderGeoDetails.country, state = senderGeoDetails.state, city = senderGeoDetails.city\\r\\n| where isnotempty(latitude) and isnotempty(longitude)\\r\\n| extend label = strcat(\\r\\n    iif(strlen(city) > 0, strcat(city, \\\", \\\"), \\\"\\\"),\\r\\n    iif(strlen(state) > 0, strcat(state, \\\", \\\"), \\\"\\\"),\\r\\n    country\\r\\n)\\r\\n| extend label = trim(\\\", \\\", label)\\r\\n| extend label = iif(strlen(label) > 0, label, \\\"N/A\\\")\\r\\n| summarize  count() by tostring(latitude), tostring(longitude), label\",\"size\":0,\"showAnalytics\":true,\"title\":\"Spam Messages by Source Country\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"LatLong\",\"latitude\":\"latitude\",\"longitude\":\"longitude\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"minData\":-1,\"labelSettings\":\"label\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"count_\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"50\",\"name\":\"query - 3\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"8\"},\"name\":\"group - 10\"},{\"type\":1,\"content\":{\"json\":\"#### 📝 ***Refresh the web page to fetch details of recently collected events***\"},\"name\":\"text - 7\"}],\"fromTemplateId\":\"Sentinel-Mimecast-Secure-Email-Gateway-Workbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId4'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=Mimecast_SEG_Workbook; logoFileName=Mimecast.svg; description=A workbook providing insights into Mimecast Secure Email Gateway.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Mimecast Secure Email Gateway Workbook; templateRelativePath=Mimecast_SEG_Workbook.json; subtitle=; provider=Mimecast}.description",
                "parentId": "[variables('workbookId4')]",
                "contentId": "[variables('_workbookContentId4')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion4')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "SEG_CG_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Seg_Dlp_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "MimecastSEGAPI",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId4')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook4-name')]",
        "contentProductId": "[variables('_workbookcontentProductId4')]",
        "id": "[variables('_workbookcontentProductId4')]",
        "version": "[variables('workbookVersion4')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName5')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Workbook Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion5')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId5')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "A workbook providing insights into Mimecast Targeted Threat Protection."
              },
              "properties": {
                "displayName": "[parameters('workbook5-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"82fedb33-961a-4199-a5ab-16340948ed10\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":1,\"content\":{\"json\":\"# Advanced Threat Detections\"},\"name\":\"text - 17\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let TableMapping = dynamic(\\n  {\\n    \\\"Ttp_Url_CL\\\" : \\\"URL Protect\\\",\\n    \\\"Ttp_Attachment_CL\\\" : \\\"Attachment Protect\\\",\\n    \\\"Ttp_Impersonation_CL\\\" : \\\"Impersonation Protect\\\"\\n  });\\nunion MimecastTTPUrl, MimecastTTPAttachment, MimecastTTPImpersonation\\n| extend Type = tostring(TableMapping[Type])\\n| make-series Count=count() default=0 on ['Event Time'] step 1d by Type\",\"size\":3,\"showAnalytics\":true,\"title\":\"Detection counts for Attachment Protect, URL Protect and Impersonation Protect\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"Type\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"Type\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"Type\",\"sourceIdField\":\"Count\",\"targetIdField\":\"Type\",\"graphOrientation\":3,\"showOrientationToggles\":false,\"staticNodeSize\":100,\"hivesMargin\":5},\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"MimecastTTPUrl\",\"label\":\"URL Protect\"},{\"seriesName\":\"MimecastTTPAttachment\",\"label\":\"Attachment Protect\"},{\"seriesName\":\"MimecastTTPImpersonation\",\"label\":\"Impersonation Protect\"}]},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"name\":\"query - 8\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"0a398a65-91c9-4af5-8a10-c2fd5bdf205a\",\"cellValue\":\"setTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"URL Protect\",\"subTarget\":\"url\",\"preText\":\"\",\"style\":\"link\"},{\"id\":\"f3d459a1-2475-4589-95dd-e614960b82f9\",\"cellValue\":\"setTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Attachment Protect\",\"subTarget\":\"attachment\",\"style\":\"link\"},{\"id\":\"323ca7b8-5d5b-41e1-8d0d-a6cdb385f2e3\",\"cellValue\":\"setTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Impersonation Protect\",\"subTarget\":\"impersonation\",\"style\":\"link\"}]},\"name\":\"links - 7\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\"\\n| make-series Count=count() default=0 on  ['Event Time'] step 1d\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Malicious URL Detections\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"graphSettings\":{\"type\":0},\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"MimecastTTPUrl\",\"label\":\"URL Protect\"}]},\"mapSettings\":{\"locInfo\":\"LatLong\"}},\"name\":\"query - 11\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\"\\n    and ['From User Email Address'] contains \\\"@\\\"\\n| summarize count() by ['From User Email Address']\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Senders of Malicious URLs\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"From User Email Address\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(Url)\\n| summarize count() by Url\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Malicious URLs\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Url\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\"\\n    and ['User Email Address'] contains \\\"@\\\"\\n| summarize count() by ['User Email Address']\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Targeted Recipients\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"User Email Address\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true,\"ySettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"query - 4\"}]},\"name\":\"dounts group 1\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['Advanced Phishing Result Credential Theft Brands'])\\n| summarize count() by ['Advanced Phishing Result Credential Theft Brands']\\n| top 10 by count_\\n\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Advanced Phishing Results - Credential Theft Brands\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"gridSettings\":{\"sortBy\":[{\"itemKey\":\"advancedPhishingResult_CredentialTheftTags_s\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"advancedPhishingResult_CredentialTheftTags_s\",\"sortOrder\":1}],\"chartSettings\":{\"group\":\"Advanced Phishing Result Credential Theft Brands\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty( ['Advanced Phishing Result Credential Theft Evidence'])\\n| summarize count() by  ['Advanced Phishing Result Credential Theft Evidence']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Advanced Phishing Results - Credential Theft Evidence\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false},\"chartSettings\":{\"group\":\"Advanced Phishing Result Credential Theft Evidence\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 12\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['Advanced Phishing Result Credential Theft Tags'])\\n| summarize count() by ['Advanced Phishing Result Credential Theft Tags']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Advanced Phishing Result - Credential Theft Tags\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"gridSettings\":{\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"advancedPhishingResult_CredentialTheftTags_s\"]},\"labelSettings\":[{\"columnId\":\"advancedPhishingResult_CredentialTheftTags_s\",\"label\":\"Credential Theft Tags\"},{\"columnId\":\"url_s\",\"label\":\"URLs\"},{\"columnId\":\"count_\",\"label\":\"Occurences\"}]},\"chartSettings\":{\"group\":\"Advanced Phishing Result Credential Theft Tags\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 14\"}]},\"name\":\"dounts group 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['Ttp Definition'])\\n| summarize count() by ['Ttp Definition']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 URL Protect Definitions\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Ttp Definition\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 16\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['Admin Override'])\\n| summarize count() by ['Admin Override']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Admin Over-rides\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Admin Override\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 19\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(Action)\\n| summarize count() by Action\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 URL Protect Actions\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Action\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 18\"}]},\"name\":\"dounts group 3\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['User Override'])\\n| summarize count() by ['User Override']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 User Over-rides\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"User Override\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 22\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['Sending IP'])\\n| summarize count() by ['Sending IP']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Sending IP Addresses\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Sending IP\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 26\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(Category)\\n| summarize count() by Category\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Categories\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Category\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 24\"}]},\"name\":\"dounts group 4\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(['User Awareness Action'])\\n| summarize count() by ['User Awareness Action']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 User Awareness Action\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"User Awareness Action\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 27\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(Subject)\\n| summarize count() by Subject\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Email Subjects Related To Malicious URLs\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Subject\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 31\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPUrl\\n| where ['Scan Result'] == \\\"malicious\\\" and isnotempty(Actions)\\n| summarize count() by Actions\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Internal Email Protect Mitigations by Actions\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Actions\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 30\"}]},\"name\":\"dounts group 5\"},{\"type\":1,\"content\":{\"json\":\"📝 ***Refresh the web page to fetch details of recently collected events***\"},\"name\":\"text - 6\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"url\"},\"name\":\"group - 8\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment \\n| where Result != \\\"safe\\\"\\n| make-series Count=count() default=0 on ['Event Time'] step 1d\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Malicious Attachment Detections\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"MimecastTTPAttachment\",\"label\":\"Attachment Protect\"}]}},\"name\":\"query - 13\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\"\\n    and ['Recipient Address'] contains \\\"@\\\"\\n| summarize count() by ['Recipient Address']\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Recipients of Malicious Attachments\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Recipient Address\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\" and isnotempty(['Action Triggered'])\\n| summarize count() by ['Action Triggered']\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Protection Actions Triggered\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Action Triggered\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\"\\n    and ['Sender Address'] contains \\\"@\\\"\\n| summarize count() by ['Sender Address']\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Senders of Malicious Attachments\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Sender Address\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 6\"}]},\"name\":\"dounts group 1\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\" and isnotempty(['File Type'])\\n| summarize count() by ['File Type']\\n| top 10 by count_\\n\\n\\n\\n\\n\\n\\n\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Malicious Attachment File Types\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"File Type\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\" and isnotempty(Details)\\n| summarize count() by Details\\n| top 10 by count_\\n\\n\\n\\n\\n\\n\\n\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Attachment Protect Event Details\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Details\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 13\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where isnotempty(Result)\\n| summarize count() by Result\\n\\n\\n\\n\\n\\n\\n\\n\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Attachment Event Results\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Result\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"33\",\"name\":\"query - 12\"}]},\"name\":\"dounts group 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\" and isnotempty(Subject)\\n| summarize count() by Subject\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Subjects for Emails Containing Malicious Attachments\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Subject\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 16\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPAttachment\\n| where Result != \\\"safe\\\" and isnotempty(['File Hash'])\\n| summarize count() by ['File Hash']\\n| top 10 by count_\\n\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Malicious Sha256 File Hashes\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"File Hash\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 18\"}]},\"name\":\"dounts group 3\"},{\"type\":1,\"content\":{\"json\":\"📝 ***Refresh the web page to fetch details of recently collected events***\"},\"name\":\"text - 4\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"attachment\"},\"name\":\"group - 7\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPImpersonation\\n| where ['Tagged Malicious'] == true\\n| make-series Count=count() default=0 on ['Event Time'] step 1d\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Malicious Impersonation Detections\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"count_\",\"label\":\"Impersonation Protect\"}]}},\"name\":\"query - 12\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPImpersonation\\n| where ['Tagged Malicious'] == true\\n    and ['Recipient Address'] contains \\\"@\\\"\\n| summarize count() by ['Recipient Address']\\n| top 10 by count_\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Recipients of Impersonation Emails\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Recipient Address\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 7\",\"styleSettings\":{\"maxWidth\":\"50\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPImpersonation\\n| where  ['Tagged Malicious'] == true\\n    and ['Sender Address'] contains \\\"@\\\"\\n| summarize count() by ['Sender Address']\\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Senders of Impersonation Emails\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Sender Address\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 6\",\"styleSettings\":{\"maxWidth\":\"50\"}}]},\"name\":\"donuts group 1\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Top 10 Impersonation Events\\n\"},\"name\":\"text - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPImpersonation\\n| where  ['Tagged Malicious'] == true and isnotempty(['Impersonation Results'])\\n| summarize count() by ['Impersonation Results']\\n|extend  ['Impersonation Results'] = trim(@\\\"[\\\\[\\\\]]\\\",['Impersonation Results'])\\n|extend  ['Impersonation Results'] = trim(@\\\"[\\\\{\\\\}]\\\",['Impersonation Results'])\\n| extend ['Impersonation Results'] = replace_string(['Impersonation Results'],',',', ') \\n| extend ['Impersonation Results'] = replace_string(['Impersonation Results'],'\\\"','') \\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Grouped by Impersonation Result\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"recipientAddress_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"TenantId\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"hits_d\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"yAxis\":[\"count_\"],\"group\":\"Impersonation Results\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"count_\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"50\",\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"MimecastTTPImpersonation\\n| where  ['Tagged Malicious'] == true and isnotempty(Identifiers)\\n| summarize count() by Identifiers\\n|extend  Identifiers = trim(@\\\"[\\\\[\\\\]]\\\",Identifiers)\\n| extend Identifiers = replace_string(Identifiers,'\\\"','') \\n| top 10 by count_\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Grouped by Impersonation Identifiers\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"group\":\"Identifiers\",\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 10\"}]},\"name\":\"dounts group 2\"},{\"type\":1,\"content\":{\"json\":\"📝 ***Refresh the web page to fetch details of recently collected events***\"},\"name\":\"text - 3\"}]},\"conditionalVisibility\":{\"parameterName\":\"setTab\",\"comparison\":\"isEqualTo\",\"value\":\"impersonation\"},\"name\":\"group - 6\"}],\"fromTemplateId\":\"Sentinel-Mimecast-Targeted-Threat-Protection-Workbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId5'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=Mimecast_TTP_Workbook; logoFileName=Mimecast.svg; description=A workbook providing insights into Mimecast Targeted Threat Protection.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Mimecast Targeted Threat Protection Workbook; templateRelativePath=Mimecast_TTP_Workbook.json; subtitle=; provider=Mimecast}.description",
                "parentId": "[variables('workbookId5')]",
                "contentId": "[variables('_workbookContentId5')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion5')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Ttp_Attachment_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Ttp_Impersonation_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Ttp_Url_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "MimecastTTPAPI",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId5')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook5-name')]",
        "contentProductId": "[variables('_workbookcontentProductId5')]",
        "id": "[variables('_workbookcontentProductId5')]",
        "version": "[variables('workbookVersion5')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast-Data-Connector-Trigger-Sync Playbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion1')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "Mimecast-Data-Connector-Trigger-Sync",
              "type": "string"
            },
            "Client ID": {
              "type": "String",
              "metadata": {
                "description": "Enter the Azure Client ID"
              }
            },
            "Client Secret": {
              "type": "SecureString",
              "metadata": {
                "description": "Enter the Azure Client Secret"
              }
            },
            "Resource Group": {
              "type": "String",
              "metadata": {
                "description": "Enter the Azure Resource Group Name in which your Mimecast data connectors are available"
              }
            },
            "Subscription ID": {
              "type": "SecureString",
              "metadata": {
                "description": "Enter the Azure Subscription ID in which your Mimecast data connectors are available, make sure that the subscription id is as per the Azure portal at all places"
              }
            },
            "Tenant ID": {
              "type": "SecureString",
              "metadata": {
                "description": "Enter the Azure Tenant ID"
              }
            }
          },
          "variables": {
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "provisioningState": "Succeeded",
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "Client ID": {
                      "defaultValue": "[[trim(parameters('Client ID'))]",
                      "type": "String"
                    },
                    "Client Secret": {
                      "defaultValue": "[[trim(parameters('Client Secret'))]",
                      "type": "SecureString"
                    },
                    "Resource Group": {
                      "defaultValue": "[[trim(parameters('Resource Group'))]",
                      "type": "String"
                    },
                    "Subscription ID": {
                      "defaultValue": "[[trim(parameters('Subscription ID'))]",
                      "type": "SecureString"
                    },
                    "Tenant ID": {
                      "defaultValue": "[[trim(parameters('Tenant ID'))]",
                      "type": "SecureString"
                    }
                  },
                  "triggers": {
                    "manual": {
                      "type": "Request",
                      "kind": "Http"
                    }
                  },
                  "actions": {
                    "For_each_app": {
                      "foreach": "@body('Get_all_Mimecast_Function_apps')",
                      "actions": {
                        "Sync_timer_trigger_request": {
                          "type": "Http",
                          "inputs": {
                            "headers": {
                              "Authorization": "Bearer @{body('Parse_Auth_token')?['access_token']} "
                            },
                            "method": "POST",
                            "uri": "https://@{variables('Manage')}.azure.com/subscriptions/@{variables('Subscription Id')}/resourceGroups/@{variables('Resource Group Name')}/providers/Microsoft.Web/sites/@{items('For_each_app')?['name']}/syncfunctiontriggers?api-version=2022-03-01"
                          }
                        }
                      },
                      "runAfter": {
                        "Get_all_Mimecast_Function_apps": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Get_Auth_token": {
                      "runAfter": {
                        "Initialize_Management_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "body": "client_id=@{variables('Client Id')}&\nclient_secret=@{variables('Client Secret')}&\ngrant_type=client_credentials&\nscope=https://@{variables('Manage')}.azure.com/.default",
                        "headers": {
                          "Content-Type": "application/x-www-form-urlencoded"
                        },
                        "method": "POST",
                        "uri": "https://login.@{variables('MicrosoftOnline')}.com/@{variables('Tenant Id')}/oauth2/v2.0/token"
                      }
                    },
                    "Get_all_Mimecast_Function_apps": {
                      "runAfter": {
                        "Get_all_running_function_app": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Get_all_running_function_app')",
                        "where": "@or(startsWith(item()?['name'], 'Mimecast'))"
                      }
                    },
                    "Get_all_running_function_app": {
                      "runAfter": {
                        "Parse_function_app_list": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Parse_function_app_list')?['value']",
                        "where": "@equals(item()?['properties']?['state'], 'Running')"
                      }
                    },
                    "Get_function_app_list": {
                      "runAfter": {
                        "Parse_Auth_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "headers": {
                          "Authorization": "Bearer @{body('Parse_Auth_token')?['access_token']} "
                        },
                        "method": "GET",
                        "uri": "https://@{variables('Manage')}.azure.com/subscriptions/@{variables('Subscription Id')}/resourceGroups/@{variables('Resource Group Name')}/providers/Microsoft.Web/sites?api-version=2022-03-01"
                      }
                    },
                    "Initialize_Client_Id": {
                      "runAfter": {
                        "Initialize_Tenant_Id": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Client Id",
                            "type": "string",
                            "value": "@parameters('Client ID')"
                          }
                        ]
                      }
                    },
                    "Initialize_Client_Secret": {
                      "runAfter": {
                        "Initialize_Client_Id": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Client Secret",
                            "type": "string",
                            "value": "@parameters('Client Secret')"
                          }
                        ]
                      }
                    },
                    "Initialize_Management_variable": {
                      "runAfter": {
                        "Initialize_Microsoftonline_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Manage",
                            "type": "string",
                            "value": "management"
                          }
                        ]
                      }
                    },
                    "Initialize_Microsoftonline_variable": {
                      "runAfter": {
                        "Subscription_Id": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "MicrosoftOnline",
                            "type": "string",
                            "value": "microsoftonline"
                          }
                        ]
                      }
                    },
                    "Initialize_Resource_Group": {
                      "runAfter": {
                        "Initialize_Client_Secret": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Resource Group Name",
                            "type": "string",
                            "value": "@parameters('Resource Group')"
                          }
                        ]
                      }
                    },
                    "Initialize_Tenant_Id": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Tenant Id",
                            "type": "string",
                            "value": "@parameters('Tenant ID')"
                          }
                        ]
                      }
                    },
                    "Parse_Auth_token": {
                      "runAfter": {
                        "Get_Auth_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Get_Auth_token')",
                        "schema": {
                          "properties": {
                            "access_token": {
                              "type": "string"
                            },
                            "expires_in": {
                              "type": "integer"
                            },
                            "ext_expires_in": {
                              "type": "integer"
                            },
                            "token_type": {
                              "type": "string"
                            }
                          },
                          "type": "object"
                        }
                      }
                    },
                    "Parse_function_app_list": {
                      "runAfter": {
                        "Get_function_app_list": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Get_function_app_list')",
                        "schema": {
                          "properties": {
                            "value": {
                              "items": {
                                "properties": {
                                  "id": {
                                    "type": "string"
                                  },
                                  "identity": {
                                    "properties": {
                                      "principalId": {
                                        "type": "string"
                                      },
                                      "tenantId": {
                                        "type": "string"
                                      },
                                      "type": {
                                        "type": "string"
                                      }
                                    },
                                    "type": "object"
                                  },
                                  "kind": {
                                    "type": "string"
                                  },
                                  "location": {
                                    "type": "string"
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "properties": {
                                    "properties": {
                                      "adminEnabled": {
                                        "type": "boolean"
                                      },
                                      "afdEnabled": {
                                        "type": "boolean"
                                      },
                                      "availabilityState": {
                                        "type": "string"
                                      },
                                      "clientAffinityEnabled": {
                                        "type": "boolean"
                                      },
                                      "clientCertEnabled": {
                                        "type": "boolean"
                                      },
                                      "clientCertMode": {
                                        "type": "string"
                                      },
                                      "containerSize": {
                                        "type": "integer"
                                      },
                                      "contentAvailabilityState": {
                                        "type": "string"
                                      },
                                      "csrs": {
                                        "type": "array"
                                      },
                                      "customDomainVerificationId": {
                                        "type": "string"
                                      },
                                      "dailyMemoryTimeQuota": {
                                        "type": "integer"
                                      },
                                      "defaultHostName": {
                                        "type": "string"
                                      },
                                      "defaultHostNameScope": {
                                        "type": "string"
                                      },
                                      "deploymentId": {
                                        "type": "string"
                                      },
                                      "dnsConfiguration": {
                                        "type": "object"
                                      },
                                      "eligibleLogCategories": {
                                        "type": "string"
                                      },
                                      "enabled": {
                                        "type": "boolean"
                                      },
                                      "enabledHostNames": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "endToEndEncryptionEnabled": {
                                        "type": "boolean"
                                      },
                                      "ftpUsername": {
                                        "type": "string"
                                      },
                                      "ftpsHostName": {
                                        "type": "string"
                                      },
                                      "functionsRuntimeAdminIsolationEnabled": {
                                        "type": "boolean"
                                      },
                                      "homeStamp": {
                                        "type": "string"
                                      },
                                      "hostNameSslStates": {
                                        "items": {
                                          "properties": {
                                            "hostType": {
                                              "type": "string"
                                            },
                                            "ipBasedSslState": {
                                              "type": "string"
                                            },
                                            "name": {
                                              "type": "string"
                                            },
                                            "sslState": {
                                              "type": "string"
                                            }
                                          },
                                          "required": [
                                            "name",
                                            "sslState",
                                            "ipBasedSslResult",
                                            "virtualIP",
                                            "virtualIPv6",
                                            "thumbprint",
                                            "certificateResourceId",
                                            "toUpdate",
                                            "toUpdateIpBasedSsl",
                                            "ipBasedSslState",
                                            "hostType"
                                          ],
                                          "type": "object"
                                        },
                                        "type": "array"
                                      },
                                      "hostNames": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "hostNamesDisabled": {
                                        "type": "boolean"
                                      },
                                      "httpsOnly": {
                                        "type": "boolean"
                                      },
                                      "hyperV": {
                                        "type": "boolean"
                                      },
                                      "inboundIpAddress": {
                                        "type": "string"
                                      },
                                      "ipMode": {
                                        "type": "string"
                                      },
                                      "isXenon": {
                                        "type": "boolean"
                                      },
                                      "keyVaultReferenceIdentity": {
                                        "type": "string"
                                      },
                                      "kind": {
                                        "type": "string"
                                      },
                                      "lastModifiedTimeUtc": {
                                        "type": "string"
                                      },
                                      "name": {
                                        "type": "string"
                                      },
                                      "outboundIpAddresses": {
                                        "type": "string"
                                      },
                                      "possibleInboundIpAddresses": {
                                        "type": "string"
                                      },
                                      "possibleOutboundIpAddresses": {
                                        "type": "string"
                                      },
                                      "redundancyMode": {
                                        "type": "string"
                                      },
                                      "repositorySiteName": {
                                        "type": "string"
                                      },
                                      "reserved": {
                                        "type": "boolean"
                                      },
                                      "resourceGroup": {
                                        "type": "string"
                                      },
                                      "runtimeAvailabilityState": {
                                        "type": "string"
                                      },
                                      "scmSiteAlsoStopped": {
                                        "type": "boolean"
                                      },
                                      "secretsCollection": {
                                        "type": "array"
                                      },
                                      "selfLink": {
                                        "type": "string"
                                      },
                                      "serverFarmId": {
                                        "type": "string"
                                      },
                                      "siteConfig": {
                                        "properties": {
                                          "acrUseManagedIdentityCreds": {
                                            "type": "boolean"
                                          },
                                          "alwaysOn": {
                                            "type": "boolean"
                                          },
                                          "functionAppScaleLimit": {
                                            "type": "integer"
                                          },
                                          "http20Enabled": {
                                            "type": "boolean"
                                          },
                                          "linuxFxVersion": {
                                            "type": "string"
                                          },
                                          "minimumElasticInstanceCount": {
                                            "type": "integer"
                                          },
                                          "numberOfWorkers": {
                                            "type": "integer"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "siteDisabledReason": {
                                        "type": "integer"
                                      },
                                      "siteProperties": {
                                        "properties": {
                                          "properties": {
                                            "items": {
                                              "properties": {
                                                "name": {
                                                  "type": "string"
                                                },
                                                "value": {
                                                  "type": [
                                                    "string",
                                                    "null"
                                                  ]
                                                }
                                              },
                                              "required": [
                                                "name",
                                                "value"
                                              ],
                                              "type": "object"
                                            },
                                            "type": "array"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "sku": {
                                        "type": "string"
                                      },
                                      "state": {
                                        "type": "string"
                                      },
                                      "storageAccountRequired": {
                                        "type": "boolean"
                                      },
                                      "storageRecoveryDefaultState": {
                                        "type": "string"
                                      },
                                      "usageState": {
                                        "type": "string"
                                      },
                                      "vnetBackupRestoreEnabled": {
                                        "type": "boolean"
                                      },
                                      "vnetContentShareEnabled": {
                                        "type": "boolean"
                                      },
                                      "vnetImagePullEnabled": {
                                        "type": "boolean"
                                      },
                                      "vnetRouteAllEnabled": {
                                        "type": "boolean"
                                      },
                                      "webSpace": {
                                        "type": "string"
                                      }
                                    },
                                    "type": "object"
                                  },
                                  "tags": {
                                    "properties": {
                                      "Jira": {
                                        "type": "string"
                                      }
                                    },
                                    "type": "object"
                                  },
                                  "type": {
                                    "type": "string"
                                  }
                                },
                                "required": [
                                  "id",
                                  "name",
                                  "type",
                                  "kind",
                                  "location",
                                  "properties"
                                ],
                                "type": "object"
                              },
                              "type": "array"
                            }
                          },
                          "type": "object"
                        }
                      }
                    },
                    "Subscription_Id": {
                      "runAfter": {
                        "Initialize_Resource_Group": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Subscription Id",
                            "type": "string",
                            "value": "@parameters('Subscription ID')"
                          }
                        ]
                      }
                    }
                  }
                }
              },
              "name": "[[parameters('PlaybookName')]",
              "type": "Microsoft.Logic/workflows",
              "location": "[[variables('workspace-location-inline')]",
              "tags": {
                "hidden-SentinelTemplateName": "Mimecast-Data-Connector-Trigger-Sync",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "apiVersion": "2017-07-01",
              "dependsOn": "[variables('TemplateEmptyArray')]"
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId1'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId1')]",
                "contentId": "[variables('_playbookContentId1')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ],
          "metadata": {
            "title": "Mimecast-Data-Connector-Trigger-Sync",
            "description": "Playbook to sync timer trigger of all Mimecast data connectors.",
            "prerequisites": [
              "Users must have a below Microsoft credentials:",
              "1.Tenant ID",
              "2.Client ID",
              "3.Client Secret",
              "4.Resource Group Name",
              "5.Subscription ID"
            ],
            "postDeployment": [
              "Run the playbook to sync timer trigger of all Mimecast data connectors."
            ],
            "tags": [
              "Mimecast",
              "Sync",
              "Timer",
              "Trigger"
            ],
            "lastUpdateTime": "2024-09-24T14:43:22.217Z",
            "releaseNotes": {
              "version": "1.0",
              "title": "[variables('blanks')]",
              "notes": [
                "Initial version"
              ]
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId1')]",
        "contentKind": "Playbook",
        "displayName": "Mimecast-Data-Connector-Trigger-Sync",
        "contentProductId": "[variables('_playbookcontentProductId1')]",
        "id": "[variables('_playbookcontentProductId1')]",
        "version": "[variables('playbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject1').parserTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_AT_Performane_Detail Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject1').parserVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject1')._parserName1]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast Awareness Training Performance Details",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "AwarenessPerformanceDetails",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_Performance_Details_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_Performance_Details_CL\n| extend [\"Email\"] = column_ifexists('email_s', ''),\n    [\"Name\"] = column_ifexists('name_s', ''),\n    [\"Num of Correct\"] = column_ifexists('numCorrect_d', ''),\n    [\"Num of Incorrect\"] = column_ifexists('numIncorrect_d', ''),\n    [\"Num of Not Watched\"] = column_ifexists('numNotWatched_d', ''),\n    [\"User Details\"] = column_ifexists('userDetails_s',''),\n    [\"User State\"] = column_ifexists('userState_s',''),\n    [\"Department\"] = column_ifexists('department_s',''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated','')\n    | summarize arg_max([\"Time Generated\"] , *) by  [\"Email\"] ,[\"Num of Correct\"] , [\"Num of Incorrect\"], [\"Num of Not Watched\"],[\"Name\"]  , [\"User Details\"] , [\"User State\"]  ,  [\"Department\"]\n| project  [\"Email\"] ,[\"Num of Correct\"] , [\"Num of Incorrect\"], [\"Num of Not Watched\"],[\"Name\"]  , [\"User Details\"] ,       [\"User State\"]  ,  [\"Department\"]\n};\nAwareness_Performance_Details_view\n  \n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
              "dependsOn": [
                "[variables('parserObject1')._parserId1]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessPerformanceDetails')]",
                "contentId": "[variables('parserObject1').parserContentId1]",
                "kind": "Parser",
                "version": "[variables('parserObject1').parserVersion1]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast Awareness Training Performance Details",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "version": "[variables('parserObject1').parserVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject1')._parserName1]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast Awareness Training Performance Details",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "AwarenessPerformanceDetails",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_Performance_Details_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_Performance_Details_CL\n| extend [\"Email\"] = column_ifexists('email_s', ''),\n    [\"Name\"] = column_ifexists('name_s', ''),\n    [\"Num of Correct\"] = column_ifexists('numCorrect_d', ''),\n    [\"Num of Incorrect\"] = column_ifexists('numIncorrect_d', ''),\n    [\"Num of Not Watched\"] = column_ifexists('numNotWatched_d', ''),\n    [\"User Details\"] = column_ifexists('userDetails_s',''),\n    [\"User State\"] = column_ifexists('userState_s',''),\n    [\"Department\"] = column_ifexists('department_s',''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated','')\n    | summarize arg_max([\"Time Generated\"] , *) by  [\"Email\"] ,[\"Num of Correct\"] , [\"Num of Incorrect\"], [\"Num of Not Watched\"],[\"Name\"]  , [\"User Details\"] , [\"User State\"]  ,  [\"Department\"]\n| project  [\"Email\"] ,[\"Num of Correct\"] , [\"Num of Incorrect\"], [\"Num of Not Watched\"],[\"Name\"]  , [\"User Details\"] ,       [\"User State\"]  ,  [\"Department\"]\n};\nAwareness_Performance_Details_view\n  \n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
      "dependsOn": [
        "[variables('parserObject1')._parserId1]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessPerformanceDetails')]",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "kind": "Parser",
        "version": "[variables('parserObject1').parserVersion1]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject2').parserTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_AT_Safe_Score Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject2').parserVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject2')._parserName2]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast Awareness Training Safe Score",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "AwarenessSafeScore",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_Safe_Score_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_SafeScore_Details_CL\n| extend [\"Email Address\"] = column_ifexists('emailAddress_s', ''),\n  [\"Name\"] = column_ifexists('name_s', ''),\n  [\"Risk\"] = column_ifexists('risk_s', ''),\n  [\"Human Error\"]= column_ifexists('humanError_s', ''),\n  [\"Sentiment\"] = column_ifexists('sentiment_s', ''),\n  [\"Engagement\"] = column_ifexists('engagement_s', ''),\n  [\"Knowledge\"] = column_ifexists('knowledge_s', ''),\n  [\"User State\"] = column_ifexists('userState_s', ''),\n  [\"Department\"] = column_ifexists('department_s', ''),\n  [\"Time Generated\"] = column_ifexists('TimeGenerated', '')\n| summarize arg_max([\"Time Generated\"] , *) by  [\"Email Address\"]  , [\"Name\"] ,  [\"Risk\"] ,  [\"Human Error\"] ,  [\"Sentiment\"]  ,  [\"Engagement\"] ,  [\"Knowledge\"],  [\"User State\"]  , [\"Department\"] \n| project     [\"Email Address\"]  , [\"Name\"] ,  [\"Risk\"] ,  [\"Human Error\"] ,  [\"Sentiment\"]  ,  [\"Engagement\"] ,  [\"Knowledge\"],  [\"User State\"]  , [\"Department\"] \n};\nAwareness_Safe_Score_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
              "dependsOn": [
                "[variables('parserObject2')._parserId2]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessSafeScore')]",
                "contentId": "[variables('parserObject2').parserContentId2]",
                "kind": "Parser",
                "version": "[variables('parserObject2').parserVersion2]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast Awareness Training Safe Score",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '1.0.0')))]",
        "version": "[variables('parserObject2').parserVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject2')._parserName2]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast Awareness Training Safe Score",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "AwarenessSafeScore",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_Safe_Score_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_SafeScore_Details_CL\n| extend [\"Email Address\"] = column_ifexists('emailAddress_s', ''),\n  [\"Name\"] = column_ifexists('name_s', ''),\n  [\"Risk\"] = column_ifexists('risk_s', ''),\n  [\"Human Error\"]= column_ifexists('humanError_s', ''),\n  [\"Sentiment\"] = column_ifexists('sentiment_s', ''),\n  [\"Engagement\"] = column_ifexists('engagement_s', ''),\n  [\"Knowledge\"] = column_ifexists('knowledge_s', ''),\n  [\"User State\"] = column_ifexists('userState_s', ''),\n  [\"Department\"] = column_ifexists('department_s', ''),\n  [\"Time Generated\"] = column_ifexists('TimeGenerated', '')\n| summarize arg_max([\"Time Generated\"] , *) by  [\"Email Address\"]  , [\"Name\"] ,  [\"Risk\"] ,  [\"Human Error\"] ,  [\"Sentiment\"]  ,  [\"Engagement\"] ,  [\"Knowledge\"],  [\"User State\"]  , [\"Department\"] \n| project     [\"Email Address\"]  , [\"Name\"] ,  [\"Risk\"] ,  [\"Human Error\"] ,  [\"Sentiment\"]  ,  [\"Engagement\"] ,  [\"Knowledge\"],  [\"User State\"]  , [\"Department\"] \n};\nAwareness_Safe_Score_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
      "dependsOn": [
        "[variables('parserObject2')._parserId2]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessSafeScore')]",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "kind": "Parser",
        "version": "[variables('parserObject2').parserVersion2]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject3').parserTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_AT_User_Data Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject3').parserVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject3')._parserName3]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast Awareness Training User Data",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "AwarenessUserData",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_User_Data_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_User_Data_CL\n| extend [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n[\"Time Reported\"] = column_ifexists('timeReported_t', ''),\n[\"Name\"] = column_ifexists('name_s', ''),\n[\"Email\"] = column_ifexists('email_s', ''),\n[\"Template Name\"] = column_ifexists('templateName_s', ''),\n[\"Status\"] = column_ifexists('status_s', ''),\n[\"Num of Campaigns Clicked\"] = column_ifexists('numCampaignsClicked_d', ''),\n[\"Num of Campaigns Sent\"] = column_ifexists('numCampaignsSent_d', ''),\n[\"Num of Correct Answers\"] = column_ifexists('numCorrectAnswers_d', ''),\n[\"Num of Training Modules Assigned\"] = column_ifexists('numTrainingModulesAssigned_d', ''),\n[\"Num of Incorrect Answers\"] = column_ifexists('numIncorrectAnswers_d', ''),\n[\"User State\"] = column_ifexists('userState_s', ''),\n[\"Clicked IP\"] = column_ifexists('clickedIp_s', ''),\n[\"Reaction Time\"] = column_ifexists('reactionTime_d', ''),\n[\"Time Opened\"] = column_ifexists('timeOpened_t', ''),\n[\"Department\"] = column_ifexists('department_s', ''),\n[\"Time Scheduled\"] = column_ifexists('timeScheduled_t',''),\n[\"Time Clicked\"] = column_ifexists('timeClicked_t', '')\n| summarize arg_max([\"Time Generated\"] , *) by [\"Time Reported\"] , [\"Name\"], [\"Email\"] , [\"Template Name\"], [\"Status\"] , [\"Num of Campaigns Clicked\"],  [\"Num of Campaigns Sent\"], [\"Num of Correct Answers\"] ,  [\"Num of Training Modules Assigned\"] , [\"Num of Incorrect Answers\"] , [\"User State\"], [\"Clicked IP\"], [\"Reaction Time\"], [\"Time Opened\"],  [\"Time Clicked\"] , [\"Time Scheduled\"] , [\"Department\"]\n| project  [\"Time Reported\"] , [\"Name\"], [\"Email\"] , [\"Template Name\"], [\"Status\"] , [\"Num of Campaigns Clicked\"],  [\"Num of Campaigns Sent\"], [\"Num of Correct Answers\"] ,  [\"Num of Training Modules Assigned\"] , [\"Num of Incorrect Answers\"] , [\"User State\"], [\"Clicked IP\"], [\"Reaction Time\"], [\"Time Opened\"],  [\"Time Clicked\"] , [\"Time Scheduled\"] , [\"Department\"]\n};\nAwareness_User_Data_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
              "dependsOn": [
                "[variables('parserObject3')._parserId3]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessUserData')]",
                "contentId": "[variables('parserObject3').parserContentId3]",
                "kind": "Parser",
                "version": "[variables('parserObject3').parserVersion3]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast Awareness Training User Data",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "version": "[variables('parserObject3').parserVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject3')._parserName3]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast Awareness Training User Data",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "AwarenessUserData",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_User_Data_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_User_Data_CL\n| extend [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n[\"Time Reported\"] = column_ifexists('timeReported_t', ''),\n[\"Name\"] = column_ifexists('name_s', ''),\n[\"Email\"] = column_ifexists('email_s', ''),\n[\"Template Name\"] = column_ifexists('templateName_s', ''),\n[\"Status\"] = column_ifexists('status_s', ''),\n[\"Num of Campaigns Clicked\"] = column_ifexists('numCampaignsClicked_d', ''),\n[\"Num of Campaigns Sent\"] = column_ifexists('numCampaignsSent_d', ''),\n[\"Num of Correct Answers\"] = column_ifexists('numCorrectAnswers_d', ''),\n[\"Num of Training Modules Assigned\"] = column_ifexists('numTrainingModulesAssigned_d', ''),\n[\"Num of Incorrect Answers\"] = column_ifexists('numIncorrectAnswers_d', ''),\n[\"User State\"] = column_ifexists('userState_s', ''),\n[\"Clicked IP\"] = column_ifexists('clickedIp_s', ''),\n[\"Reaction Time\"] = column_ifexists('reactionTime_d', ''),\n[\"Time Opened\"] = column_ifexists('timeOpened_t', ''),\n[\"Department\"] = column_ifexists('department_s', ''),\n[\"Time Scheduled\"] = column_ifexists('timeScheduled_t',''),\n[\"Time Clicked\"] = column_ifexists('timeClicked_t', '')\n| summarize arg_max([\"Time Generated\"] , *) by [\"Time Reported\"] , [\"Name\"], [\"Email\"] , [\"Template Name\"], [\"Status\"] , [\"Num of Campaigns Clicked\"],  [\"Num of Campaigns Sent\"], [\"Num of Correct Answers\"] ,  [\"Num of Training Modules Assigned\"] , [\"Num of Incorrect Answers\"] , [\"User State\"], [\"Clicked IP\"], [\"Reaction Time\"], [\"Time Opened\"],  [\"Time Clicked\"] , [\"Time Scheduled\"] , [\"Department\"]\n| project  [\"Time Reported\"] , [\"Name\"], [\"Email\"] , [\"Template Name\"], [\"Status\"] , [\"Num of Campaigns Clicked\"],  [\"Num of Campaigns Sent\"], [\"Num of Correct Answers\"] ,  [\"Num of Training Modules Assigned\"] , [\"Num of Incorrect Answers\"] , [\"User State\"], [\"Clicked IP\"], [\"Reaction Time\"], [\"Time Opened\"],  [\"Time Clicked\"] , [\"Time Scheduled\"] , [\"Department\"]\n};\nAwareness_User_Data_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
      "dependsOn": [
        "[variables('parserObject3')._parserId3]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessUserData')]",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "kind": "Parser",
        "version": "[variables('parserObject3').parserVersion3]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject4').parserTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_AT_Watchlist Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject4').parserVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject4')._parserName4]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast Awareness Training Watchlist",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "AwarenessWatchlist",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_Watchlist_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_Watchlist_Details_CL\n| extend [\"Email\" ]= column_ifexists('email_s', ''),\n  [\"Name\"] = column_ifexists('name_s', ''),\n  [\"Watchlist Count\"] = column_ifexists('watchlistCount_d', 0),\n  [\"User State\"] = column_ifexists('userState_s', ''),\n  [\"Department\"] = column_ifexists('department_s', ''),\n  [\"Time Generated\"] = column_ifexists('Time Generated', '')\n| summarize arg_max([\"Time Generated\"], *) by  [\"Email\" ], [\"Name\"] ,  [\"Watchlist Count\"] , [\"User State\"], [\"Department\"]\n| project [\"Time Generated\"],  [\"Email\" ], [\"Name\"] ,  [\"Watchlist Count\"] , [\"User State\"], [\"Department\"]\n};\nAwareness_Watchlist_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject4')._parserId4,'/'))))]",
              "dependsOn": [
                "[variables('parserObject4')._parserId4]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessWatchlist')]",
                "contentId": "[variables('parserObject4').parserContentId4]",
                "kind": "Parser",
                "version": "[variables('parserObject4').parserVersion4]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject4').parserContentId4]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast Awareness Training Watchlist",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject4').parserContentId4,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject4').parserContentId4,'-', '1.0.0')))]",
        "version": "[variables('parserObject4').parserVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject4')._parserName4]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast Awareness Training Watchlist",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "AwarenessWatchlist",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet Awareness_Watchlist_view = view() {\nunion isfuzzy=true dummy_table,\nAwareness_Watchlist_Details_CL\n| extend [\"Email\" ]= column_ifexists('email_s', ''),\n  [\"Name\"] = column_ifexists('name_s', ''),\n  [\"Watchlist Count\"] = column_ifexists('watchlistCount_d', 0),\n  [\"User State\"] = column_ifexists('userState_s', ''),\n  [\"Department\"] = column_ifexists('department_s', ''),\n  [\"Time Generated\"] = column_ifexists('Time Generated', '')\n| summarize arg_max([\"Time Generated\"], *) by  [\"Email\" ], [\"Name\"] ,  [\"Watchlist Count\"] , [\"User State\"], [\"Department\"]\n| project [\"Time Generated\"],  [\"Email\" ], [\"Name\"] ,  [\"Watchlist Count\"] , [\"User State\"], [\"Department\"]\n};\nAwareness_Watchlist_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject4')._parserId4,'/'))))]",
      "dependsOn": [
        "[variables('parserObject4')._parserId4]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'AwarenessWatchlist')]",
        "contentId": "[variables('parserObject4').parserContentId4]",
        "kind": "Parser",
        "version": "[variables('parserObject4').parserVersion4]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject5').parserTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_Audit Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject5').parserVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject5')._parserName5]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for MimecastAudit",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastAudit",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastAudit_view = view() {\nunion isfuzzy=true dummy_table,\nAudit_CL\n| extend [\"Id\"] = column_ifexists('id_s', ''),\n    [\"Audit Type\"] = column_ifexists('auditType_s', ''),\n    [\"User\"] = column_ifexists('user_s', ''),\n    [\"Event Time\"] = column_ifexists('eventTime_t', ''),\n    [\"Event Info\"] = column_ifexists('eventInfo_s', ''),\n    [\"Category\"] = column_ifexists('Category',''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated','')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime( [\"Event Time\"] ))   \n| parse-kv [\"Event Info\"] as (IP: string, Application:string )  with (pair_delimiter=',', kv_delimiter=':') \n| summarize arg_max(TimeGenerated, *) by  [\"Category\"] , [\"Audit Type\"] , [\"User\"] , [\"Event Info\"] , [\"Event Time\"] , [\"Id\"]\n| project [\"Time Generated\"]  ,[\"Source IP\"] = IP ,Application , [\"Category\"] , [\"Audit Type\"] , [\"User\"] , [\"Event Info\"] , [\"Event Time\"] , [\"Id\"]\n};\nMimecastAudit_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject5')._parserId5,'/'))))]",
              "dependsOn": [
                "[variables('parserObject5')._parserId5]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastAudit')]",
                "contentId": "[variables('parserObject5').parserContentId5]",
                "kind": "Parser",
                "version": "[variables('parserObject5').parserVersion5]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject5').parserContentId5]",
        "contentKind": "Parser",
        "displayName": "Parser for MimecastAudit",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject5').parserContentId5,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject5').parserContentId5,'-', '1.0.0')))]",
        "version": "[variables('parserObject5').parserVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject5')._parserName5]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for MimecastAudit",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastAudit",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastAudit_view = view() {\nunion isfuzzy=true dummy_table,\nAudit_CL\n| extend [\"Id\"] = column_ifexists('id_s', ''),\n    [\"Audit Type\"] = column_ifexists('auditType_s', ''),\n    [\"User\"] = column_ifexists('user_s', ''),\n    [\"Event Time\"] = column_ifexists('eventTime_t', ''),\n    [\"Event Info\"] = column_ifexists('eventInfo_s', ''),\n    [\"Category\"] = column_ifexists('Category',''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated','')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime( [\"Event Time\"] ))   \n| parse-kv [\"Event Info\"] as (IP: string, Application:string )  with (pair_delimiter=',', kv_delimiter=':') \n| summarize arg_max(TimeGenerated, *) by  [\"Category\"] , [\"Audit Type\"] , [\"User\"] , [\"Event Info\"] , [\"Event Time\"] , [\"Id\"]\n| project [\"Time Generated\"]  ,[\"Source IP\"] = IP ,Application , [\"Category\"] , [\"Audit Type\"] , [\"User\"] , [\"Event Info\"] , [\"Event Time\"] , [\"Id\"]\n};\nMimecastAudit_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject5')._parserId5,'/'))))]",
      "dependsOn": [
        "[variables('parserObject5')._parserId5]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastAudit')]",
        "contentId": "[variables('parserObject5').parserContentId5]",
        "kind": "Parser",
        "version": "[variables('parserObject5').parserVersion5]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject6').parserTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_Cloud_Integrated Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject6').parserVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject6')._parserName6]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast Cloud Integrated",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastCloudIntegrated",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastCloudIntegrated = view() {\nunion isfuzzy=true dummy_table,\nCloud_Integrated_CL\n| extend Category = column_ifexists('Category', ''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n    [\"Event Time\"] = column_ifexists('timestamp_d', ''),\n    ['Account ID'] = column_ifexists('accountId_s', ''),\n    ['Aggregate ID']  = column_ifexists('aggregateId_s', ''),\n    ['Processing ID']  = column_ifexists('processingId_s', ''),\n    ['Message ID']  = column_ifexists('messageId_s', ''),\n    [\"Attachments\"] = column_ifexists('attachments_s', ''),\n    [\"Recipients\"] = column_ifexists('recipients_s', ''),\n    [\"Tags\"] = column_ifexists('tags_s', ''),\n    ['Policies Applied']  = column_ifexists('policiesApplied_s', ''),\n    ['Historical Mail']  = column_ifexists('historicalMail_b', ''),\n    ['Sender IP']  = column_ifexists('senderIp_s', ''),\n    ['Sender Envelope']  = column_ifexists('senderEnvelope_s', ''),\n    [\"Subject\"]= column_ifexists('subject_s', ''),\n    [\"Source\"] = column_ifexists('source_s', ''),\n    ['Threat State'] = column_ifexists('threatState_s', ''),\n    ['Threat Type']  = column_ifexists('threatType_s', ''),\n    [\"Direction\"] = column_ifexists('direction_s', ''),\n    ['Sender Header'] = column_ifexists('senderHeader_s', ''),\n    [\"Type\"]  = column_ifexists('type_s', ''),\n    [\"Subtype\"]  = column_ifexists('subtype_s', '')\n|  summarize arg_max([\"Time Generated\"] , *) by [\"Event Time\"],\n      [\"Type\"],\n      ['Account ID'],\n      ['Aggregate ID'],\n      ['Processing ID'],\n      ['Message ID'],\n      [\"Attachments\"],\n      [\"Recipients\"],\n      [\"Tags\"],\n      ['Policies Applied'],\n      ['Historical Mail'],\n      ['Sender IP'],\n      ['Sender Envelope'],\n      [\"Subject\"],\n      [\"Source\"],\n      ['Threat State'],\n      ['Threat Type'],\n      [\"Direction\"],\n      ['Sender Header'],\n      [\"Subtype\"]\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(unixtime_milliseconds_todatetime( tolong([\"Event Time\"])) )  )\n| project   [\"Event Time\"] ,\n      [\"Time Generated\"],\n      ['Account ID'],\n      ['Aggregate ID'],\n      ['Processing ID'],\n      ['Message ID'],\n      [\"Attachments\"],\n      [\"Recipients\"],\n      [\"Tags\"],\n      ['Policies Applied'],\n      ['Historical Mail'],\n      ['Sender IP'],\n      ['Sender Envelope'],\n      [\"Subject\"],\n      [\"Source\"],\n      ['Threat State'],\n      ['Threat Type'],\n      [\"Direction\"],\n      ['Sender Header'],\n      [\"Type\"],\n      [\"Subtype\"]\n};\nMimecastCloudIntegrated\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject6')._parserId6,'/'))))]",
              "dependsOn": [
                "[variables('parserObject6')._parserId6]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastCloudIntegrated')]",
                "contentId": "[variables('parserObject6').parserContentId6]",
                "kind": "Parser",
                "version": "[variables('parserObject6').parserVersion6]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject6').parserContentId6]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast Cloud Integrated",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject6').parserContentId6,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject6').parserContentId6,'-', '1.0.0')))]",
        "version": "[variables('parserObject6').parserVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject6')._parserName6]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast Cloud Integrated",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastCloudIntegrated",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastCloudIntegrated = view() {\nunion isfuzzy=true dummy_table,\nCloud_Integrated_CL\n| extend Category = column_ifexists('Category', ''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n    [\"Event Time\"] = column_ifexists('timestamp_d', ''),\n    ['Account ID'] = column_ifexists('accountId_s', ''),\n    ['Aggregate ID']  = column_ifexists('aggregateId_s', ''),\n    ['Processing ID']  = column_ifexists('processingId_s', ''),\n    ['Message ID']  = column_ifexists('messageId_s', ''),\n    [\"Attachments\"] = column_ifexists('attachments_s', ''),\n    [\"Recipients\"] = column_ifexists('recipients_s', ''),\n    [\"Tags\"] = column_ifexists('tags_s', ''),\n    ['Policies Applied']  = column_ifexists('policiesApplied_s', ''),\n    ['Historical Mail']  = column_ifexists('historicalMail_b', ''),\n    ['Sender IP']  = column_ifexists('senderIp_s', ''),\n    ['Sender Envelope']  = column_ifexists('senderEnvelope_s', ''),\n    [\"Subject\"]= column_ifexists('subject_s', ''),\n    [\"Source\"] = column_ifexists('source_s', ''),\n    ['Threat State'] = column_ifexists('threatState_s', ''),\n    ['Threat Type']  = column_ifexists('threatType_s', ''),\n    [\"Direction\"] = column_ifexists('direction_s', ''),\n    ['Sender Header'] = column_ifexists('senderHeader_s', ''),\n    [\"Type\"]  = column_ifexists('type_s', ''),\n    [\"Subtype\"]  = column_ifexists('subtype_s', '')\n|  summarize arg_max([\"Time Generated\"] , *) by [\"Event Time\"],\n      [\"Type\"],\n      ['Account ID'],\n      ['Aggregate ID'],\n      ['Processing ID'],\n      ['Message ID'],\n      [\"Attachments\"],\n      [\"Recipients\"],\n      [\"Tags\"],\n      ['Policies Applied'],\n      ['Historical Mail'],\n      ['Sender IP'],\n      ['Sender Envelope'],\n      [\"Subject\"],\n      [\"Source\"],\n      ['Threat State'],\n      ['Threat Type'],\n      [\"Direction\"],\n      ['Sender Header'],\n      [\"Subtype\"]\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(unixtime_milliseconds_todatetime( tolong([\"Event Time\"])) )  )\n| project   [\"Event Time\"] ,\n      [\"Time Generated\"],\n      ['Account ID'],\n      ['Aggregate ID'],\n      ['Processing ID'],\n      ['Message ID'],\n      [\"Attachments\"],\n      [\"Recipients\"],\n      [\"Tags\"],\n      ['Policies Applied'],\n      ['Historical Mail'],\n      ['Sender IP'],\n      ['Sender Envelope'],\n      [\"Subject\"],\n      [\"Source\"],\n      ['Threat State'],\n      ['Threat Type'],\n      [\"Direction\"],\n      ['Sender Header'],\n      [\"Type\"],\n      [\"Subtype\"]\n};\nMimecastCloudIntegrated\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject6')._parserId6,'/'))))]",
      "dependsOn": [
        "[variables('parserObject6')._parserId6]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastCloudIntegrated')]",
        "contentId": "[variables('parserObject6').parserContentId6]",
        "kind": "Parser",
        "version": "[variables('parserObject6').parserVersion6]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject7').parserTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_SEG_CG Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject7').parserVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject7')._parserName7]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast SEG Cloud Gateway",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastCG",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastCG_view = view() {\nunion isfuzzy=true dummy_table,\nSeg_Cg_CL\n| extend  \n      [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n      [\"Url Category\"] = columnifexists(\"urlCategory_s\", \"\"),\n      [\"Scan Results\"] = columnifexists(\"scanResults_s\", \"\"),\n      [\"File Name\"] = columnifexists(\"fileName_s\", \"\"),\n      [\"Sha256\"] = columnifexists(\"sha256_s\", \"\"),\n      [\"File Extension\"] = columnifexists(\"fileExtension_s\", \"\"),\n      [\"Virus Found\"] = columnifexists(\"virusFound_s\", \"\"),\n      [\"Sha1\"] = columnifexists(\"sha1_s\", \"\"),\n      [\"Sender Domain\"] = columnifexists(\"senderDomain_s\", \"\"),\n      [\"Md5\"] = columnifexists(\"md5_g\", \"\"),\n      [\"Custom Threat Dictionary\"] = columnifexists(\"customThreatDictionary_s\", \"\"),\n      [\"Items Detected\"] = columnifexists(\"itemsDetected_s\", \"\"),\n      [\"Similar Custom External Domain\"] = columnifexists(\"similarCustomExternalDomain_s\", \"\"),\n      [\"Tagged External\"] = columnifexists(\"taggedExternal_s\", \"\"),\n      [\"Similar Internal Domain\"] = columnifexists(\"similarInternalDomain_s\", \"\"),\n      [\"New Domain\"] = columnifexists(\"newDomain_s\", \"\"),\n      [\"Internal User Name\"] = columnifexists(\"internalUserName_s\", \"\"),\n      [\"Mimecast Threat Dictionary\"] = columnifexists(\"mimecastThreatDictionary_s\", \"\"),\n      [\"Similar Mimecast External Domain\"] = columnifexists(\"similarMimecastExternalDomain_s\", \"\"),\n      [\"Custom Name Match\"] = columnifexists(\"customNameMatch_s\", \"\"),\n      [\"Tagged Malicious\"] = columnifexists(\"taggedMalicious_s\", \"\"),\n      [\"Reply Mismatch\"] = columnifexists(\"replyMismatch_s\", \"\"),\n      [\"Aggregate ID S\"] = columnifexists(\"aggregateId_s\", \"\"),\n      [\"Aggregate ID G\"] = columnifexists(\"aggregateId_g\", \"\"),\n      [\"Rejection Type\"] = columnifexists(\"rejectionType_s\", \"\"),\n      [\"Rejection Code\"] = columnifexists(\"rejectionCode_s\", \"\"),\n      [\"Rejection Info\"] = columnifexists(\"rejectionInfo_s\", \"\"),\n      [\"Delivered\"] = columnifexists(\"delivered_s\", \"\"),\n      [\"Destination IP\"] = columnifexists(\"destinationIp_s\", \"\"),\n      [\"Host Name\"] = columnifexists(\"Hostname_s\", \"\"),\n      [\"Delivery Attempts\"] = columnifexists(\"deliveryAttempts_s\", \"\"),\n      [\"TLS Used\"] = columnifexists(\"tlsUsed_s\", \"\"),\n      [\"Delivery Errors\"] = columnifexists(\"deliveryErrors_s\", \"\"),\n      [\"Attachments\"] = columnifexists(\"attachments_s\", \"\"),\n      [\"Route\"] = columnifexists(\"route_s\", \"\"),\n      [\"Processing ID\"] = columnifexists(\"processingId_s\", \"\"),\n      [\"Account ID\"] = columnifexists(\"accountId_s\", \"\"),\n      [\"Action\"] = columnifexists(\"action_s\", \"\"),\n      [\"Event Time\"] = columnifexists(\"timestamp_d\", \"\"),\n      [\"Sender Envelope\"] = columnifexists(\"senderEnvelope_s\", \"\"),\n      [\"Message ID\"] = columnifexists(\"messageId_s\", \"\"),\n      [\"Subject\"] = columnifexists(\"subject_s\", \"\"),\n      [\"Total of Size Attachments\"] = columnifexists(\"totalSizeAttachments_s\", \"\"),\n      [\"Number of Attachments\"] = columnifexists(\"numberAttachments_s\", \"\"),\n      [\"Email Size\"] = columnifexists(\"emailSize_s\", \"\"),\n      [\"Type\"] = columnifexists(\"type_s\", \"\"),\n      [\"Sub Type\"] = columnifexists(\"subtype_s\", \"\"),\n      [\"Monitored Domain Source\"] = columnifexists(\"monitoredDomainSource_s\", \"\"),\n      [\"Similar Domain\"] = columnifexists(\"similarDomain_s\", \"\"),\n      [\"Offset\"] = columnifexists(\"_offset_d\", \"\"),\n      [\"Partition\"] = columnifexists(\"_partition_d\", \"\"),\n      [\"Hold Reason\"] = columnifexists(\"holdReason_s\", \"\"),\n      [\"Recipients\"] = columnifexists(\"recipients_s\", \"\"),\n      [\"Sender IP\"] = columnifexists(\"senderIp_s\", \"\"),\n      [\"Direction\"] = columnifexists(\"direction_s\", \"\"),\n      [\"Sender Header\"] = columnifexists(\"senderHeader_s\", \"\"),\n      [\"TLS Version\"] = columnifexists(\"tlsVersion_s\", \"\"),\n      [\"TLS Cipher\"] = columnifexists(\"tlsCipher_s\", \"\"),\n      [\"Spam Info\"] = columnifexists(\"spamInfo_s\", \"\"),\n      [\"Spam Processing Detail\"] = columnifexists(\"spamProcessingDetail_s\", \"\")\n| summarize arg_max([\"Time Generated\"], *) by \n      [\"Url Category\"],\n      [\"Scan Results\"],\n      [\"File Name\"],\n      [\"Sha256\"],\n      [\"File Extension\"],\n      [\"Virus Found\"],\n      [\"Sha1\"],\n      [\"Sender Domain\"],\n      [\"Md5\"],\n      [\"Custom Threat Dictionary\"],\n      [\"Items Detected\"],\n      [\"Similar Custom External Domain\"],\n      [\"Tagged External\"],\n      [\"Similar Internal Domain\"],\n      [\"New Domain\"],\n      [\"Internal User Name\"],\n      [\"Mimecast Threat Dictionary\"],\n      [\"Similar Mimecast External Domain\"],\n      [\"Custom Name Match\"],\n      [\"Tagged Malicious\"],\n      [\"Reply Mismatch\"],\n      [\"Aggregate ID\"] = coalesce([\"Aggregate ID S\"], [\"Aggregate ID G\"]),\n      [\"Rejection Type\"],\n      [\"Rejection Code\"],\n      [\"Rejection Info\"],\n      [\"Delivered\"],\n      [\"Destination IP\"],\n      [\"Host Name\"],\n      [\"Delivery Attempts\"],\n      [\"TLS Used\"],\n      [\"Delivery Errors\"],\n      [\"Attachments\"],\n      [\"Route\"],\n      [\"Processing ID\"],\n      [\"Account ID\"],\n      [\"Action\"],\n      [\"Event Time\"],\n      [\"Sender Envelope\"],\n      [\"Message ID\"],\n      [\"Subject\"],\n      [\"Total of Size Attachments\"],\n      [\"Number of Attachments\"],\n      [\"Email Size\"],\n      [\"Type\"],\n      [\"Sub Type\"],\n      [\"Monitored Domain Source\"],\n      [\"Similar Domain\"],\n      [\"Hold Reason\"],\n      [\"Recipients\"],\n      [\"Sender IP\"],\n      [\"Direction\"],\n      [\"Sender Header\"],\n      [\"TLS Version\"],\n      [\"TLS Cipher\"],\n      [\"Spam Info\"],\n      [\"Spam Processing Detail\"]\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(unixtime_milliseconds_todatetime( tolong([\"Event Time\"]) ))  )\n| extend  ['Message ID'] = trim(@\"[\\<\\>]\", ['Message ID'] )\n| project \n      [\"Time Generated\"],\n      [\"Url Category\"],\n      [\"Scan Results\"],\n      [\"File Name\"],\n      [\"Sha256\"],\n      [\"File Extension\"],\n      [\"Virus Found\"],\n      [\"Sha1\"],\n      [\"Sender Domain\"],\n      [\"Md5\"],\n      [\"Custom Threat Dictionary\"],\n      [\"Items Detected\"],\n      [\"Similar Custom External Domain\"],\n      [\"Tagged External\"],\n      [\"Similar Internal Domain\"],\n      [\"New Domain\"],\n      [\"Internal User Name\"],\n      [\"Mimecast Threat Dictionary\"],\n      [\"Similar Mimecast External Domain\"],\n      [\"Custom Name Match\"],\n      [\"Tagged Malicious\"],\n      [\"Reply Mismatch\"],\n      [\"Aggregate ID\"] = coalesce([\"Aggregate ID S\"], [\"Aggregate ID G\"]),\n      [\"Rejection Type\"],\n      [\"Rejection Code\"],\n      [\"Rejection Info\"],\n      [\"Delivered\"],\n      [\"Destination IP\"],\n      [\"Host Name\"],\n      [\"Delivery Attempts\"],\n      [\"TLS Used\"],\n      [\"Delivery Errors\"],\n      [\"Attachments\"],\n      [\"Route\"],\n      [\"Processing ID\"],\n      [\"Account ID\"],\n      [\"Action\"],\n      [\"Event Time\"] ,\n      [\"Sender Envelope\"],\n      [\"Message ID\"],\n      [\"Subject\"],\n      [\"Total of Size Attachments\"],\n      [\"Number of Attachments\"],\n      [\"Email Size\"],\n      [\"Type\"],\n      [\"Sub Type\"],\n      [\"Monitored Domain Source\"],\n      [\"Similar Domain\"],\n      [\"Offset\"],\n      [\"Partition\"],\n      [\"Hold Reason\"],\n      [\"Recipients\"],\n      [\"Sender IP\"],\n      [\"Direction\"],\n      [\"Sender Header\"],\n      [\"TLS Version\"],\n      [\"TLS Cipher\"],\n      [\"Spam Info\"],\n      [\"Spam Processing Detail\"]\n};\nMimecastCG_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject7')._parserId7,'/'))))]",
              "dependsOn": [
                "[variables('parserObject7')._parserId7]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastCG')]",
                "contentId": "[variables('parserObject7').parserContentId7]",
                "kind": "Parser",
                "version": "[variables('parserObject7').parserVersion7]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject7').parserContentId7]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast SEG Cloud Gateway",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject7').parserContentId7,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject7').parserContentId7,'-', '1.0.0')))]",
        "version": "[variables('parserObject7').parserVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject7')._parserName7]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast SEG Cloud Gateway",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastCG",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastCG_view = view() {\nunion isfuzzy=true dummy_table,\nSeg_Cg_CL\n| extend  \n      [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n      [\"Url Category\"] = columnifexists(\"urlCategory_s\", \"\"),\n      [\"Scan Results\"] = columnifexists(\"scanResults_s\", \"\"),\n      [\"File Name\"] = columnifexists(\"fileName_s\", \"\"),\n      [\"Sha256\"] = columnifexists(\"sha256_s\", \"\"),\n      [\"File Extension\"] = columnifexists(\"fileExtension_s\", \"\"),\n      [\"Virus Found\"] = columnifexists(\"virusFound_s\", \"\"),\n      [\"Sha1\"] = columnifexists(\"sha1_s\", \"\"),\n      [\"Sender Domain\"] = columnifexists(\"senderDomain_s\", \"\"),\n      [\"Md5\"] = columnifexists(\"md5_g\", \"\"),\n      [\"Custom Threat Dictionary\"] = columnifexists(\"customThreatDictionary_s\", \"\"),\n      [\"Items Detected\"] = columnifexists(\"itemsDetected_s\", \"\"),\n      [\"Similar Custom External Domain\"] = columnifexists(\"similarCustomExternalDomain_s\", \"\"),\n      [\"Tagged External\"] = columnifexists(\"taggedExternal_s\", \"\"),\n      [\"Similar Internal Domain\"] = columnifexists(\"similarInternalDomain_s\", \"\"),\n      [\"New Domain\"] = columnifexists(\"newDomain_s\", \"\"),\n      [\"Internal User Name\"] = columnifexists(\"internalUserName_s\", \"\"),\n      [\"Mimecast Threat Dictionary\"] = columnifexists(\"mimecastThreatDictionary_s\", \"\"),\n      [\"Similar Mimecast External Domain\"] = columnifexists(\"similarMimecastExternalDomain_s\", \"\"),\n      [\"Custom Name Match\"] = columnifexists(\"customNameMatch_s\", \"\"),\n      [\"Tagged Malicious\"] = columnifexists(\"taggedMalicious_s\", \"\"),\n      [\"Reply Mismatch\"] = columnifexists(\"replyMismatch_s\", \"\"),\n      [\"Aggregate ID S\"] = columnifexists(\"aggregateId_s\", \"\"),\n      [\"Aggregate ID G\"] = columnifexists(\"aggregateId_g\", \"\"),\n      [\"Rejection Type\"] = columnifexists(\"rejectionType_s\", \"\"),\n      [\"Rejection Code\"] = columnifexists(\"rejectionCode_s\", \"\"),\n      [\"Rejection Info\"] = columnifexists(\"rejectionInfo_s\", \"\"),\n      [\"Delivered\"] = columnifexists(\"delivered_s\", \"\"),\n      [\"Destination IP\"] = columnifexists(\"destinationIp_s\", \"\"),\n      [\"Host Name\"] = columnifexists(\"Hostname_s\", \"\"),\n      [\"Delivery Attempts\"] = columnifexists(\"deliveryAttempts_s\", \"\"),\n      [\"TLS Used\"] = columnifexists(\"tlsUsed_s\", \"\"),\n      [\"Delivery Errors\"] = columnifexists(\"deliveryErrors_s\", \"\"),\n      [\"Attachments\"] = columnifexists(\"attachments_s\", \"\"),\n      [\"Route\"] = columnifexists(\"route_s\", \"\"),\n      [\"Processing ID\"] = columnifexists(\"processingId_s\", \"\"),\n      [\"Account ID\"] = columnifexists(\"accountId_s\", \"\"),\n      [\"Action\"] = columnifexists(\"action_s\", \"\"),\n      [\"Event Time\"] = columnifexists(\"timestamp_d\", \"\"),\n      [\"Sender Envelope\"] = columnifexists(\"senderEnvelope_s\", \"\"),\n      [\"Message ID\"] = columnifexists(\"messageId_s\", \"\"),\n      [\"Subject\"] = columnifexists(\"subject_s\", \"\"),\n      [\"Total of Size Attachments\"] = columnifexists(\"totalSizeAttachments_s\", \"\"),\n      [\"Number of Attachments\"] = columnifexists(\"numberAttachments_s\", \"\"),\n      [\"Email Size\"] = columnifexists(\"emailSize_s\", \"\"),\n      [\"Type\"] = columnifexists(\"type_s\", \"\"),\n      [\"Sub Type\"] = columnifexists(\"subtype_s\", \"\"),\n      [\"Monitored Domain Source\"] = columnifexists(\"monitoredDomainSource_s\", \"\"),\n      [\"Similar Domain\"] = columnifexists(\"similarDomain_s\", \"\"),\n      [\"Offset\"] = columnifexists(\"_offset_d\", \"\"),\n      [\"Partition\"] = columnifexists(\"_partition_d\", \"\"),\n      [\"Hold Reason\"] = columnifexists(\"holdReason_s\", \"\"),\n      [\"Recipients\"] = columnifexists(\"recipients_s\", \"\"),\n      [\"Sender IP\"] = columnifexists(\"senderIp_s\", \"\"),\n      [\"Direction\"] = columnifexists(\"direction_s\", \"\"),\n      [\"Sender Header\"] = columnifexists(\"senderHeader_s\", \"\"),\n      [\"TLS Version\"] = columnifexists(\"tlsVersion_s\", \"\"),\n      [\"TLS Cipher\"] = columnifexists(\"tlsCipher_s\", \"\"),\n      [\"Spam Info\"] = columnifexists(\"spamInfo_s\", \"\"),\n      [\"Spam Processing Detail\"] = columnifexists(\"spamProcessingDetail_s\", \"\")\n| summarize arg_max([\"Time Generated\"], *) by \n      [\"Url Category\"],\n      [\"Scan Results\"],\n      [\"File Name\"],\n      [\"Sha256\"],\n      [\"File Extension\"],\n      [\"Virus Found\"],\n      [\"Sha1\"],\n      [\"Sender Domain\"],\n      [\"Md5\"],\n      [\"Custom Threat Dictionary\"],\n      [\"Items Detected\"],\n      [\"Similar Custom External Domain\"],\n      [\"Tagged External\"],\n      [\"Similar Internal Domain\"],\n      [\"New Domain\"],\n      [\"Internal User Name\"],\n      [\"Mimecast Threat Dictionary\"],\n      [\"Similar Mimecast External Domain\"],\n      [\"Custom Name Match\"],\n      [\"Tagged Malicious\"],\n      [\"Reply Mismatch\"],\n      [\"Aggregate ID\"] = coalesce([\"Aggregate ID S\"], [\"Aggregate ID G\"]),\n      [\"Rejection Type\"],\n      [\"Rejection Code\"],\n      [\"Rejection Info\"],\n      [\"Delivered\"],\n      [\"Destination IP\"],\n      [\"Host Name\"],\n      [\"Delivery Attempts\"],\n      [\"TLS Used\"],\n      [\"Delivery Errors\"],\n      [\"Attachments\"],\n      [\"Route\"],\n      [\"Processing ID\"],\n      [\"Account ID\"],\n      [\"Action\"],\n      [\"Event Time\"],\n      [\"Sender Envelope\"],\n      [\"Message ID\"],\n      [\"Subject\"],\n      [\"Total of Size Attachments\"],\n      [\"Number of Attachments\"],\n      [\"Email Size\"],\n      [\"Type\"],\n      [\"Sub Type\"],\n      [\"Monitored Domain Source\"],\n      [\"Similar Domain\"],\n      [\"Hold Reason\"],\n      [\"Recipients\"],\n      [\"Sender IP\"],\n      [\"Direction\"],\n      [\"Sender Header\"],\n      [\"TLS Version\"],\n      [\"TLS Cipher\"],\n      [\"Spam Info\"],\n      [\"Spam Processing Detail\"]\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(unixtime_milliseconds_todatetime( tolong([\"Event Time\"]) ))  )\n| extend  ['Message ID'] = trim(@\"[\\<\\>]\", ['Message ID'] )\n| project \n      [\"Time Generated\"],\n      [\"Url Category\"],\n      [\"Scan Results\"],\n      [\"File Name\"],\n      [\"Sha256\"],\n      [\"File Extension\"],\n      [\"Virus Found\"],\n      [\"Sha1\"],\n      [\"Sender Domain\"],\n      [\"Md5\"],\n      [\"Custom Threat Dictionary\"],\n      [\"Items Detected\"],\n      [\"Similar Custom External Domain\"],\n      [\"Tagged External\"],\n      [\"Similar Internal Domain\"],\n      [\"New Domain\"],\n      [\"Internal User Name\"],\n      [\"Mimecast Threat Dictionary\"],\n      [\"Similar Mimecast External Domain\"],\n      [\"Custom Name Match\"],\n      [\"Tagged Malicious\"],\n      [\"Reply Mismatch\"],\n      [\"Aggregate ID\"] = coalesce([\"Aggregate ID S\"], [\"Aggregate ID G\"]),\n      [\"Rejection Type\"],\n      [\"Rejection Code\"],\n      [\"Rejection Info\"],\n      [\"Delivered\"],\n      [\"Destination IP\"],\n      [\"Host Name\"],\n      [\"Delivery Attempts\"],\n      [\"TLS Used\"],\n      [\"Delivery Errors\"],\n      [\"Attachments\"],\n      [\"Route\"],\n      [\"Processing ID\"],\n      [\"Account ID\"],\n      [\"Action\"],\n      [\"Event Time\"] ,\n      [\"Sender Envelope\"],\n      [\"Message ID\"],\n      [\"Subject\"],\n      [\"Total of Size Attachments\"],\n      [\"Number of Attachments\"],\n      [\"Email Size\"],\n      [\"Type\"],\n      [\"Sub Type\"],\n      [\"Monitored Domain Source\"],\n      [\"Similar Domain\"],\n      [\"Offset\"],\n      [\"Partition\"],\n      [\"Hold Reason\"],\n      [\"Recipients\"],\n      [\"Sender IP\"],\n      [\"Direction\"],\n      [\"Sender Header\"],\n      [\"TLS Version\"],\n      [\"TLS Cipher\"],\n      [\"Spam Info\"],\n      [\"Spam Processing Detail\"]\n};\nMimecastCG_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject7')._parserId7,'/'))))]",
      "dependsOn": [
        "[variables('parserObject7')._parserId7]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastCG')]",
        "contentId": "[variables('parserObject7').parserContentId7]",
        "kind": "Parser",
        "version": "[variables('parserObject7').parserVersion7]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject8').parserTemplateSpecName8]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_SEG_DLP Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject8').parserVersion8]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject8')._parserName8]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast SEG Data Leak Prevention",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastDLP",
                "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastSEG_view = view() {\nunion isfuzzy=true dummy_table,\nSeg_Dlp_CL\n| extend [\"Sender Address\"] = column_ifexists('senderAddress_s', ''),\n    [\"Recipient Address\"] = column_ifexists('recipientAddress_s', ''),\n    [\"Subject\"] = column_ifexists('subject_s', ''),\n    [\"Event Time\"] = column_ifexists('eventTime_t', ''),\n    [\"Route\"] = column_ifexists('route_s', ''),\n    [\"Policy\"] = column_ifexists('policy_s', ''),\n    [\"Action\"] = column_ifexists('action_s', ''),\n    [\"Message ID\"] = column_ifexists('messageId_s', ''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated', '')\n| summarize arg_max(TimeGenerated, *) by [\"Sender Address\"], [\"Recipient Address\"], [\"Subject\"], [\"Route\"], [\"Policy\"], [\"Action\"], [\"Event Time\"], [\"Message ID\"]\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime( tolong([\"Event Time\"]) )  )\n| project [\"Time Generated\"], [\"Sender Address\"], [\"Recipient Address\"], [\"Subject\"], [\"Route\"], [\"Policy\"], [\"Action\"], [\"Event Time\"], [\"Message ID\"]\n};\nMimecastSEG_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject8')._parserId8,'/'))))]",
              "dependsOn": [
                "[variables('parserObject8')._parserId8]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastDLP')]",
                "contentId": "[variables('parserObject8').parserContentId8]",
                "kind": "Parser",
                "version": "[variables('parserObject8').parserVersion8]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject8').parserContentId8]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast SEG Data Leak Prevention",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject8').parserContentId8,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject8').parserContentId8,'-', '1.0.0')))]",
        "version": "[variables('parserObject8').parserVersion8]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject8')._parserName8]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast SEG Data Leak Prevention",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastDLP",
        "query": "let dummy_table = datatable(TimeGenerated: datetime) [];\nlet MimecastSEG_view = view() {\nunion isfuzzy=true dummy_table,\nSeg_Dlp_CL\n| extend [\"Sender Address\"] = column_ifexists('senderAddress_s', ''),\n    [\"Recipient Address\"] = column_ifexists('recipientAddress_s', ''),\n    [\"Subject\"] = column_ifexists('subject_s', ''),\n    [\"Event Time\"] = column_ifexists('eventTime_t', ''),\n    [\"Route\"] = column_ifexists('route_s', ''),\n    [\"Policy\"] = column_ifexists('policy_s', ''),\n    [\"Action\"] = column_ifexists('action_s', ''),\n    [\"Message ID\"] = column_ifexists('messageId_s', ''),\n    [\"Time Generated\"] = column_ifexists('TimeGenerated', '')\n| summarize arg_max(TimeGenerated, *) by [\"Sender Address\"], [\"Recipient Address\"], [\"Subject\"], [\"Route\"], [\"Policy\"], [\"Action\"], [\"Event Time\"], [\"Message ID\"]\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime( tolong([\"Event Time\"]) )  )\n| project [\"Time Generated\"], [\"Sender Address\"], [\"Recipient Address\"], [\"Subject\"], [\"Route\"], [\"Policy\"], [\"Action\"], [\"Event Time\"], [\"Message ID\"]\n};\nMimecastSEG_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject8')._parserId8,'/'))))]",
      "dependsOn": [
        "[variables('parserObject8')._parserId8]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastDLP')]",
        "contentId": "[variables('parserObject8').parserContentId8]",
        "kind": "Parser",
        "version": "[variables('parserObject8').parserVersion8]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject9').parserTemplateSpecName9]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Attachment Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject9').parserVersion9]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject9')._parserName9]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast TTP ATTACHMENT",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastTTPAttachment",
                "query": "let dummy_table = datatable(TimeGenerated: datetime, senderAddress_s: string, recipientAddress_s: string, messageId_s: string) [];\nlet MimecastTTPAttachment = view() {\nunion isfuzzy=true dummy_table,\nTtp_Attachment_CL\n| summarize arg_max(TimeGenerated, *) by senderAddress_s, recipientAddress_s, messageId_s\n| extend [\"Time Generated\"]  = column_ifexists('TimeGenerated', ''),\n  [\"Type\"] = column_ifexists('Type', ''),\n  [\"Mimecast Event ID\"] = 'ttp_attachment',\n  [\"Mimecast Event Category\"] = 'ttp_attachment',\n  [\"Action Triggered\"] = column_ifexists('actionTriggered_s', ''),\n  [\"Event Time\"]  = column_ifexists('date_t', ''),\n  [\"Definition\"] = column_ifexists('definition_s', ''),\n  [\"Details\"] = column_ifexists('details_s', ''),\n  [\"File Hash\"] = column_ifexists('fileHash_s', ''),\n  [\"File Name\"] = column_ifexists('fileName_s', ''),\n  [\"File Type\"] = column_ifexists('fileType_s', ''),\n  [\"Message ID\"] = column_ifexists('messageId_s', ''),\n  [\"Recipient Address\"] = column_ifexists('recipientAddress_s', ''),\n  [\"Result\"] = column_ifexists('result_s', ''),\n  [\"Route\"] = column_ifexists('route_s', ''),\n  [\"Sender Address\"] = column_ifexists('senderAddress_s', ''),\n  [\"Subject\"] = column_ifexists('subject_s', '')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(( [\"Event Time\"]) )  )\n| project  [\"Time Generated\"] , [\"Type\"], [\"Mimecast Event ID\"], [\"Mimecast Event Category\"], [\"Action Triggered\"],[\"Event Time\"] , [\"Definition\"], [\"Details\"], [\"File Hash\"], [\"File Name\"], [\"File Type\"], [\"Message ID\"], [\"Recipient Address\"], [\"Result\"], [\"Route\"], [\"Sender Address\"], [\"Subject\"] \n};\nMimecastTTPAttachment\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject9')._parserId9,'/'))))]",
              "dependsOn": [
                "[variables('parserObject9')._parserId9]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPAttachment')]",
                "contentId": "[variables('parserObject9').parserContentId9]",
                "kind": "Parser",
                "version": "[variables('parserObject9').parserVersion9]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject9').parserContentId9]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast TTP ATTACHMENT",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject9').parserContentId9,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject9').parserContentId9,'-', '1.0.0')))]",
        "version": "[variables('parserObject9').parserVersion9]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject9')._parserName9]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast TTP ATTACHMENT",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastTTPAttachment",
        "query": "let dummy_table = datatable(TimeGenerated: datetime, senderAddress_s: string, recipientAddress_s: string, messageId_s: string) [];\nlet MimecastTTPAttachment = view() {\nunion isfuzzy=true dummy_table,\nTtp_Attachment_CL\n| summarize arg_max(TimeGenerated, *) by senderAddress_s, recipientAddress_s, messageId_s\n| extend [\"Time Generated\"]  = column_ifexists('TimeGenerated', ''),\n  [\"Type\"] = column_ifexists('Type', ''),\n  [\"Mimecast Event ID\"] = 'ttp_attachment',\n  [\"Mimecast Event Category\"] = 'ttp_attachment',\n  [\"Action Triggered\"] = column_ifexists('actionTriggered_s', ''),\n  [\"Event Time\"]  = column_ifexists('date_t', ''),\n  [\"Definition\"] = column_ifexists('definition_s', ''),\n  [\"Details\"] = column_ifexists('details_s', ''),\n  [\"File Hash\"] = column_ifexists('fileHash_s', ''),\n  [\"File Name\"] = column_ifexists('fileName_s', ''),\n  [\"File Type\"] = column_ifexists('fileType_s', ''),\n  [\"Message ID\"] = column_ifexists('messageId_s', ''),\n  [\"Recipient Address\"] = column_ifexists('recipientAddress_s', ''),\n  [\"Result\"] = column_ifexists('result_s', ''),\n  [\"Route\"] = column_ifexists('route_s', ''),\n  [\"Sender Address\"] = column_ifexists('senderAddress_s', ''),\n  [\"Subject\"] = column_ifexists('subject_s', '')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(( [\"Event Time\"]) )  )\n| project  [\"Time Generated\"] , [\"Type\"], [\"Mimecast Event ID\"], [\"Mimecast Event Category\"], [\"Action Triggered\"],[\"Event Time\"] , [\"Definition\"], [\"Details\"], [\"File Hash\"], [\"File Name\"], [\"File Type\"], [\"Message ID\"], [\"Recipient Address\"], [\"Result\"], [\"Route\"], [\"Sender Address\"], [\"Subject\"] \n};\nMimecastTTPAttachment\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject9')._parserId9,'/'))))]",
      "dependsOn": [
        "[variables('parserObject9')._parserId9]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPAttachment')]",
        "contentId": "[variables('parserObject9').parserContentId9]",
        "kind": "Parser",
        "version": "[variables('parserObject9').parserVersion9]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject10').parserTemplateSpecName10]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Impersonation Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject10').parserVersion10]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject10')._parserName10]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast TTP Impersonation",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastTTPImpersonation",
                "query": "let dummy_table = datatable(TimeGenerated: datetime, id_s: string) [];\nlet MimecastTTPImpersonation = view() {\nunion isfuzzy=true dummy_table,\nTtp_Impersonation_CL\n| summarize arg_max(TimeGenerated, *) by id_s\n| extend \n    [\"Time Generated\"]  = column_ifexists('TimeGenerated', ''),\n    [\"Type\"] = column_ifexists('Type', ''),\n    [\"Mimecast Event ID\"] = 'ttp_impersonation',\n    [\"Mimecast Event Category\"] = 'ttp_impersonation',\n    [\"Action\"] = column_ifexists('action_s',''),\n    [\"Definition\"] = column_ifexists('definition_s',''),\n    [\"Event Time\"] = column_ifexists('eventTime_t',''),\n    [\"Hits\"] = column_ifexists('hits_d',''),\n    [\"ID\"] = column_ifexists('id_s',''),\n    [\"Identifiers\"] = column_ifexists('identifiers_s',''),\n    [\"Impersonation Results\"] = column_ifexists('impersonationResults_s',''),\n    [\"Message ID\"] = column_ifexists('messageId_s',''),\n    [\"Recipient Address\"] = column_ifexists('recipientAddress_s',''),\n    [\"Sender Address\"] = column_ifexists('senderAddress_s',''),\n    [\"Sender IP Address\"] = column_ifexists('senderIpAddress_s',''),\n    [\"Subject\"] = column_ifexists('subject_s',''),\n    [\"Tagged External\"] = column_ifexists('taggedExternal_b',''),\n    [\"Tagged Malicious\"] = column_ifexists('taggedMalicious_b','')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(( [\"Event Time\"]) )  )\n| project [\"Time Generated\"], [\"ID\"], [\"Mimecast Event ID\"], [\"Mimecast Event Category\"], [\"Action\"], [\"Definition\"], [\"Event Time\"], [\"Hits\"], [\"Identifiers\"], [\"Impersonation Results\"], [\"Message ID\"], [\"Recipient Address\"], [\"Sender Address\"], [\"Sender IP Address\"], [\"Subject\"], [\"Tagged External\"], [\"Tagged Malicious\"],  [\"Type\"] \n};\nMimecastTTPImpersonation\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject10')._parserId10,'/'))))]",
              "dependsOn": [
                "[variables('parserObject10')._parserId10]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPImpersonation')]",
                "contentId": "[variables('parserObject10').parserContentId10]",
                "kind": "Parser",
                "version": "[variables('parserObject10').parserVersion10]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject10').parserContentId10]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast TTP Impersonation",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject10').parserContentId10,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject10').parserContentId10,'-', '1.0.0')))]",
        "version": "[variables('parserObject10').parserVersion10]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject10')._parserName10]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast TTP Impersonation",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastTTPImpersonation",
        "query": "let dummy_table = datatable(TimeGenerated: datetime, id_s: string) [];\nlet MimecastTTPImpersonation = view() {\nunion isfuzzy=true dummy_table,\nTtp_Impersonation_CL\n| summarize arg_max(TimeGenerated, *) by id_s\n| extend \n    [\"Time Generated\"]  = column_ifexists('TimeGenerated', ''),\n    [\"Type\"] = column_ifexists('Type', ''),\n    [\"Mimecast Event ID\"] = 'ttp_impersonation',\n    [\"Mimecast Event Category\"] = 'ttp_impersonation',\n    [\"Action\"] = column_ifexists('action_s',''),\n    [\"Definition\"] = column_ifexists('definition_s',''),\n    [\"Event Time\"] = column_ifexists('eventTime_t',''),\n    [\"Hits\"] = column_ifexists('hits_d',''),\n    [\"ID\"] = column_ifexists('id_s',''),\n    [\"Identifiers\"] = column_ifexists('identifiers_s',''),\n    [\"Impersonation Results\"] = column_ifexists('impersonationResults_s',''),\n    [\"Message ID\"] = column_ifexists('messageId_s',''),\n    [\"Recipient Address\"] = column_ifexists('recipientAddress_s',''),\n    [\"Sender Address\"] = column_ifexists('senderAddress_s',''),\n    [\"Sender IP Address\"] = column_ifexists('senderIpAddress_s',''),\n    [\"Subject\"] = column_ifexists('subject_s',''),\n    [\"Tagged External\"] = column_ifexists('taggedExternal_b',''),\n    [\"Tagged Malicious\"] = column_ifexists('taggedMalicious_b','')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(( [\"Event Time\"]) )  )\n| project [\"Time Generated\"], [\"ID\"], [\"Mimecast Event ID\"], [\"Mimecast Event Category\"], [\"Action\"], [\"Definition\"], [\"Event Time\"], [\"Hits\"], [\"Identifiers\"], [\"Impersonation Results\"], [\"Message ID\"], [\"Recipient Address\"], [\"Sender Address\"], [\"Sender IP Address\"], [\"Subject\"], [\"Tagged External\"], [\"Tagged Malicious\"],  [\"Type\"] \n};\nMimecastTTPImpersonation\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject10')._parserId10,'/'))))]",
      "dependsOn": [
        "[variables('parserObject10')._parserId10]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPImpersonation')]",
        "contentId": "[variables('parserObject10').parserContentId10]",
        "kind": "Parser",
        "version": "[variables('parserObject10').parserVersion10]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject11').parserTemplateSpecName11]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast_TTP_Url Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject11').parserVersion11]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject11')._parserName11]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for Mimecast TTP URL",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "MimecastTTPUrl",
                "query": "let dummy_table = datatable(TimeGenerated: datetime, userEmailAddress_s: string, fromUserEmailAddress_s: string, messageId_s: string, sendingIp_s: string, url_s: string) [];\nlet MimecastTTPUrl = view() {\nunion isfuzzy=true dummy_table,\nTtp_Url_CL\n| summarize arg_max(TimeGenerated, *) by userEmailAddress_s,fromUserEmailAddress_s, sendingIp_s, messageId_s, url_s\n| extend \n    [\"Category\"] = column_ifexists('Category', ''),\n  [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n  [\"Type\"] = column_ifexists('Type', ''),\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Mimetypes Url File Download\"] = column_ifexists('tagMap_DangerousFileExt_ContentCheck_DangerousMimetypesUrlFileDownload_s', ''),\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Exts Url File Download\"] = column_ifexists('tagMap_DangerousFileExt_ContentCheck_DangerousExtsUrlFileDownload_s', ''),\n  [\"Tag Map Advanced Phishing Credential Theft Evidence\"] = column_ifexists('tagMap_AdvancedPhishing_CredentialTheftEvidence_s', ''),\n  [\"Tag Map Advanced Phishing Credential Theft Tags\"] = column_ifexists('tagMap_AdvancedPhishing_CredentialTheftTags_s', ''),\n  [\"Mimecast Event ID\"] = 'ttp_url',\n  [\"Mimecast Event Category\"] = 'ttp_url',\n  [\"Advanced Phishing Result Credential Theft Brands\"] = column_ifexists('advancedPhishingResult_CredentialTheftBrands_s', ''),\n  [\"Advanced Phishing Result Credential Theft Evidence\"] = column_ifexists('advancedPhishingResult_CredentialTheftEvidence_s', ''),\n  [\"Advanced Phishing Result Credential Theft Tags\"] = column_ifexists('advancedPhishingResult_CredentialTheftTags_s', ''),\n  [\"Tag Map Url Reputation Scan Type\"] = column_ifexists('tagMap_UrlReputationScan_Type_s', ''),\n  [\"Tag Map Url Reputation Scan Url\"] = column_ifexists('tagMap_UrlReputationScan_Url_s', ''),\n  [\"Tag Map Dangerous File Ext Inspect File Exts\"] = column_ifexists('tagMap_DangerousFileExt_Inspect_FileExts_s', ''),\n  [\"Tag Map Dangerous File Ext Inspect Mime Types\"] = column_ifexists('tagMap_DangerousFileExt_Inspect_MimeTypes_s', ''),\n  [\"Tag Map Dangerous File Ext Content Check Content Scanners Blocked\"] = column_ifexists('tagMap_DangerousFileExt_ContentCheck_ContentScannersBlocked_s', ''),\n  [\"User Email Address\"] = column_ifexists('userEmailAddress_s', ''),\n  [\"From User Email Address\"] = column_ifexists('fromUserEmailAddress_s', ''),\n  [\"Url\"] = column_ifexists('url_s', ''),\n  [\"Ttp Definition\"] = column_ifexists('ttpDefinition_s', ''),\n  [\"Subject\"] = column_ifexists('subject_s', ''),\n  [\"Action\"] = column_ifexists('action_s', ''),\n  [\"Admin Override\"] = column_ifexists('adminOverride_s', ''),\n  [\"User Override\"] = column_ifexists('userOverride_s', ''),\n  [\"Scan Result\"] = column_ifexists('scanResult_s', ''),\n  [\"Sending IP\"] = column_ifexists('sendingIp_s', ''),\n  [\"User Awareness Action\"] = column_ifexists('userAwarenessAction_s', ''),\n  ['Event Time'] = column_ifexists('date_t', ''),\n  [\"Actions\"] = column_ifexists('actions_s', ''),\n  [\"Route\"] = column_ifexists('route_s', ''),\n  [\"Creation Method\"] = column_ifexists('creationMethod_s', ''),\n  [\"Email Parts Description\"] = column_ifexists('emailPartsDescription_s', ''),\n  [\"Message ID\"] = column_ifexists('messageId_s', ''),\n  [\"Tag Map Url Reputation Scan Url Block\"] = column_ifexists('tagMap_UrlReputationScan_UrlBlock_s', ''),\n  [\"Tag Map Customer Managed Urls Managed Url Entry\"] = column_ifexists('tagMap_CustomerManagedUrls_ManagedUrlEntry_s', ''),\n  [\"Tag Map Customer Managed Urls Blocklisted\"] = column_ifexists('tagMap_CustomerManagedUrls_Blocklisted_s', ''),\n  [\"Tag Map Av Scanning Content Check Av Signature Name\"] = column_ifexists('tagMap_AvScanning_ContentCheck_AvSignatureName_s', ''),\n  [\"Tag Map Av Scanning Scanner Info Category Trigger\"] = column_ifexists('tagMap_AvScanning_ScannerInfo_CategoryTrigger_s', ''),\n  [\"Tag Map Av Scanning Content Check Av Signature File Exts\"] = column_ifexists('tagMap_AvScanning_ContentCheck_AvSignatureFileExts_s', ''),\n  [\"Tag Map Av Scanning Content Check Url File Download Filename\"] = column_ifexists('tagMap_AvScanning_ContentCheck_UrlFileDownloadFilename_s', '')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(( [\"Event Time\"]) ) )\n| project [\"Category\"] ,[\"Time Generated\"] ,\n  [\"Mimecast Event ID\"],\n  [\"Mimecast Event Category\"],\n  [\"User Email Address\"],\n  [\"From User Email Address\"],\n  [\"Url\"],\n  [\"Ttp Definition\"],\n  [\"Subject\"],\n  [\"Action\"],\n  [\"Admin Override\"],\n  [\"User Override\"],\n  [\"Scan Result\"],\n  [\"Sending IP\"],\n  [\"User Awareness Action\"],\n  ['Event Time'],\n  [\"Actions\"],\n  [\"Route\"],\n  [\"Creation Method\"],\n  [\"Email Parts Description\"],\n  [\"Message ID\"],\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Mimetypes Url File Download\"],\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Exts Url File Download\"],\n  [\"Tag Map Advanced Phishing Credential Theft Evidence\"],\n  [\"Tag Map Advanced Phishing Credential Theft Tags\"],\n  [\"Advanced Phishing Result Credential Theft Brands\"],\n  [\"Advanced Phishing Result Credential Theft Evidence\"],\n  [\"Advanced Phishing Result Credential Theft Tags\"],\n  [\"Tag Map Url Reputation Scan Type\"],\n  [\"Tag Map Url Reputation Scan Url\"],\n  [\"Tag Map Dangerous File Ext Inspect File Exts\"],\n  [\"Tag Map Dangerous File Ext Inspect Mime Types\"],\n  [\"Tag Map Dangerous File Ext Content Check Content Scanners Blocked\"],\n  [\"Tag Map Url Reputation Scan Url Block\"],\n  [\"Tag Map Customer Managed Urls Managed Url Entry\"],\n  [\"Tag Map Customer Managed Urls Blocklisted\"],\n  [\"Tag Map Av Scanning Content Check Av Signature Name\"],\n  [\"Tag Map Av Scanning Scanner Info Category Trigger\"],\n  [\"Tag Map Av Scanning Content Check Av Signature File Exts\"],\n  [\"Tag Map Av Scanning Content Check Url File Download Filename\"],\n  [\"Type\"]\n};\nMimecastTTPUrl\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject11')._parserId11,'/'))))]",
              "dependsOn": [
                "[variables('parserObject11')._parserId11]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPUrl')]",
                "contentId": "[variables('parserObject11').parserContentId11]",
                "kind": "Parser",
                "version": "[variables('parserObject11').parserVersion11]",
                "source": {
                  "name": "Mimecast",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject11').parserContentId11]",
        "contentKind": "Parser",
        "displayName": "Parser for Mimecast TTP URL",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject11').parserContentId11,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject11').parserContentId11,'-', '1.0.0')))]",
        "version": "[variables('parserObject11').parserVersion11]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject11')._parserName11]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for Mimecast TTP URL",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "MimecastTTPUrl",
        "query": "let dummy_table = datatable(TimeGenerated: datetime, userEmailAddress_s: string, fromUserEmailAddress_s: string, messageId_s: string, sendingIp_s: string, url_s: string) [];\nlet MimecastTTPUrl = view() {\nunion isfuzzy=true dummy_table,\nTtp_Url_CL\n| summarize arg_max(TimeGenerated, *) by userEmailAddress_s,fromUserEmailAddress_s, sendingIp_s, messageId_s, url_s\n| extend \n    [\"Category\"] = column_ifexists('Category', ''),\n  [\"Time Generated\"] = column_ifexists('TimeGenerated', ''),\n  [\"Type\"] = column_ifexists('Type', ''),\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Mimetypes Url File Download\"] = column_ifexists('tagMap_DangerousFileExt_ContentCheck_DangerousMimetypesUrlFileDownload_s', ''),\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Exts Url File Download\"] = column_ifexists('tagMap_DangerousFileExt_ContentCheck_DangerousExtsUrlFileDownload_s', ''),\n  [\"Tag Map Advanced Phishing Credential Theft Evidence\"] = column_ifexists('tagMap_AdvancedPhishing_CredentialTheftEvidence_s', ''),\n  [\"Tag Map Advanced Phishing Credential Theft Tags\"] = column_ifexists('tagMap_AdvancedPhishing_CredentialTheftTags_s', ''),\n  [\"Mimecast Event ID\"] = 'ttp_url',\n  [\"Mimecast Event Category\"] = 'ttp_url',\n  [\"Advanced Phishing Result Credential Theft Brands\"] = column_ifexists('advancedPhishingResult_CredentialTheftBrands_s', ''),\n  [\"Advanced Phishing Result Credential Theft Evidence\"] = column_ifexists('advancedPhishingResult_CredentialTheftEvidence_s', ''),\n  [\"Advanced Phishing Result Credential Theft Tags\"] = column_ifexists('advancedPhishingResult_CredentialTheftTags_s', ''),\n  [\"Tag Map Url Reputation Scan Type\"] = column_ifexists('tagMap_UrlReputationScan_Type_s', ''),\n  [\"Tag Map Url Reputation Scan Url\"] = column_ifexists('tagMap_UrlReputationScan_Url_s', ''),\n  [\"Tag Map Dangerous File Ext Inspect File Exts\"] = column_ifexists('tagMap_DangerousFileExt_Inspect_FileExts_s', ''),\n  [\"Tag Map Dangerous File Ext Inspect Mime Types\"] = column_ifexists('tagMap_DangerousFileExt_Inspect_MimeTypes_s', ''),\n  [\"Tag Map Dangerous File Ext Content Check Content Scanners Blocked\"] = column_ifexists('tagMap_DangerousFileExt_ContentCheck_ContentScannersBlocked_s', ''),\n  [\"User Email Address\"] = column_ifexists('userEmailAddress_s', ''),\n  [\"From User Email Address\"] = column_ifexists('fromUserEmailAddress_s', ''),\n  [\"Url\"] = column_ifexists('url_s', ''),\n  [\"Ttp Definition\"] = column_ifexists('ttpDefinition_s', ''),\n  [\"Subject\"] = column_ifexists('subject_s', ''),\n  [\"Action\"] = column_ifexists('action_s', ''),\n  [\"Admin Override\"] = column_ifexists('adminOverride_s', ''),\n  [\"User Override\"] = column_ifexists('userOverride_s', ''),\n  [\"Scan Result\"] = column_ifexists('scanResult_s', ''),\n  [\"Sending IP\"] = column_ifexists('sendingIp_s', ''),\n  [\"User Awareness Action\"] = column_ifexists('userAwarenessAction_s', ''),\n  ['Event Time'] = column_ifexists('date_t', ''),\n  [\"Actions\"] = column_ifexists('actions_s', ''),\n  [\"Route\"] = column_ifexists('route_s', ''),\n  [\"Creation Method\"] = column_ifexists('creationMethod_s', ''),\n  [\"Email Parts Description\"] = column_ifexists('emailPartsDescription_s', ''),\n  [\"Message ID\"] = column_ifexists('messageId_s', ''),\n  [\"Tag Map Url Reputation Scan Url Block\"] = column_ifexists('tagMap_UrlReputationScan_UrlBlock_s', ''),\n  [\"Tag Map Customer Managed Urls Managed Url Entry\"] = column_ifexists('tagMap_CustomerManagedUrls_ManagedUrlEntry_s', ''),\n  [\"Tag Map Customer Managed Urls Blocklisted\"] = column_ifexists('tagMap_CustomerManagedUrls_Blocklisted_s', ''),\n  [\"Tag Map Av Scanning Content Check Av Signature Name\"] = column_ifexists('tagMap_AvScanning_ContentCheck_AvSignatureName_s', ''),\n  [\"Tag Map Av Scanning Scanner Info Category Trigger\"] = column_ifexists('tagMap_AvScanning_ScannerInfo_CategoryTrigger_s', ''),\n  [\"Tag Map Av Scanning Content Check Av Signature File Exts\"] = column_ifexists('tagMap_AvScanning_ContentCheck_AvSignatureFileExts_s', ''),\n  [\"Tag Map Av Scanning Content Check Url File Download Filename\"] = column_ifexists('tagMap_AvScanning_ContentCheck_UrlFileDownloadFilename_s', '')\n| extend ['Event Time'] = iff( isempty( ['Event Time']) ,now() , todatetime(( [\"Event Time\"]) ) )\n| project [\"Category\"] ,[\"Time Generated\"] ,\n  [\"Mimecast Event ID\"],\n  [\"Mimecast Event Category\"],\n  [\"User Email Address\"],\n  [\"From User Email Address\"],\n  [\"Url\"],\n  [\"Ttp Definition\"],\n  [\"Subject\"],\n  [\"Action\"],\n  [\"Admin Override\"],\n  [\"User Override\"],\n  [\"Scan Result\"],\n  [\"Sending IP\"],\n  [\"User Awareness Action\"],\n  ['Event Time'],\n  [\"Actions\"],\n  [\"Route\"],\n  [\"Creation Method\"],\n  [\"Email Parts Description\"],\n  [\"Message ID\"],\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Mimetypes Url File Download\"],\n  [\"Tag Map Dangerous File Ext Content Check Dangerous Exts Url File Download\"],\n  [\"Tag Map Advanced Phishing Credential Theft Evidence\"],\n  [\"Tag Map Advanced Phishing Credential Theft Tags\"],\n  [\"Advanced Phishing Result Credential Theft Brands\"],\n  [\"Advanced Phishing Result Credential Theft Evidence\"],\n  [\"Advanced Phishing Result Credential Theft Tags\"],\n  [\"Tag Map Url Reputation Scan Type\"],\n  [\"Tag Map Url Reputation Scan Url\"],\n  [\"Tag Map Dangerous File Ext Inspect File Exts\"],\n  [\"Tag Map Dangerous File Ext Inspect Mime Types\"],\n  [\"Tag Map Dangerous File Ext Content Check Content Scanners Blocked\"],\n  [\"Tag Map Url Reputation Scan Url Block\"],\n  [\"Tag Map Customer Managed Urls Managed Url Entry\"],\n  [\"Tag Map Customer Managed Urls Blocklisted\"],\n  [\"Tag Map Av Scanning Content Check Av Signature Name\"],\n  [\"Tag Map Av Scanning Scanner Info Category Trigger\"],\n  [\"Tag Map Av Scanning Content Check Av Signature File Exts\"],\n  [\"Tag Map Av Scanning Content Check Url File Download Filename\"],\n  [\"Type\"]\n};\nMimecastTTPUrl\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject11')._parserId11,'/'))))]",
      "dependsOn": [
        "[variables('parserObject11')._parserId11]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'MimecastTTPUrl')]",
        "contentId": "[variables('parserObject11').parserContentId11]",
        "kind": "Parser",
        "version": "[variables('parserObject11').parserVersion11]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Mimecast Awareness Training (using Azure Functions)",
                  "publisher": "Mimecast",
                  "descriptionMarkdown": "The data connector for [Mimecast Awareness Training](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- Performance Details \n- Safe Score Details \n- User Data\n- Watchlist Details\n",
                  "graphQueries": [
                    {
                      "metricName": "Total Performance Details data received",
                      "legend": "Awareness_Performance_Details_CL",
                      "baseQuery": "Awareness_Performance_Details_CL"
                    },
                    {
                      "metricName": "Total Safe Score Details data received",
                      "legend": "Awareness_SafeScore_Details_CL",
                      "baseQuery": "Awareness_SafeScore_Details_CL"
                    },
                    {
                      "metricName": "Total User Data received",
                      "legend": "Awareness_User_Data_CL",
                      "baseQuery": "Awareness_User_Data_CL"
                    },
                    {
                      "metricName": "Total Watchlist Details data received",
                      "legend": "Awareness_Watchlist_Details_CL",
                      "baseQuery": "Awareness_Watchlist_Details_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Awareness_Performance_Details_CL",
                      "query": "Awareness_Performance_Details_CL\n| sort by TimeGenerated desc"
                    },
                    {
                      "description": "Awareness_SafeScore_Details_CL",
                      "query": "Awareness_SafeScore_Details_CL\n| sort by TimeGenerated desc"
                    },
                    {
                      "description": "Awareness_User_Data_CL",
                      "query": "Awareness_User_Data_CL\n| sort by TimeGenerated desc"
                    },
                    {
                      "description": "Awareness_Watchlist_Details_CL",
                      "query": "Awareness_User_Data_CL\n| sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Awareness_Performance_Details_CL",
                      "lastDataReceivedQuery": "Awareness_Performance_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Awareness_SafeScore_Details_CL",
                      "lastDataReceivedQuery": "Awareness_SafeScore_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Awareness_User_Data_CL",
                      "lastDataReceivedQuery": "Awareness_User_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Awareness_Watchlist_Details_CL",
                      "lastDataReceivedQuery": "Awareness_Watchlist_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Awareness_Performance_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                        "Awareness_SafeScore_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                        "Awareness_User_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                        "Awareness_Watchlist_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "You need to have a resource group created with a subscription you are going to use.",
                      "title": "Resource group"
                    },
                    {
                      "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret",
                      "title": "Functions app"
                    },
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
                      "title": "Configuration:"
                    },
                    {
                      "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Use this method for automated deployment of the Mimecast Awareness Training Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAT-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 0 */1 * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
                      "title": "Azure Resource Manager (ARM) Template"
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "Mimecast Awareness Training (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Mimecast Awareness Training (using Azure Functions)",
          "publisher": "Mimecast",
          "descriptionMarkdown": "The data connector for [Mimecast Awareness Training](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- Performance Details \n- Safe Score Details \n- User Data\n- Watchlist Details\n",
          "graphQueries": [
            {
              "metricName": "Total Performance Details data received",
              "legend": "Awareness_Performance_Details_CL",
              "baseQuery": "Awareness_Performance_Details_CL"
            },
            {
              "metricName": "Total Safe Score Details data received",
              "legend": "Awareness_SafeScore_Details_CL",
              "baseQuery": "Awareness_SafeScore_Details_CL"
            },
            {
              "metricName": "Total User Data received",
              "legend": "Awareness_User_Data_CL",
              "baseQuery": "Awareness_User_Data_CL"
            },
            {
              "metricName": "Total Watchlist Details data received",
              "legend": "Awareness_Watchlist_Details_CL",
              "baseQuery": "Awareness_Watchlist_Details_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Awareness_Performance_Details_CL",
              "lastDataReceivedQuery": "Awareness_Performance_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Awareness_SafeScore_Details_CL",
              "lastDataReceivedQuery": "Awareness_SafeScore_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Awareness_User_Data_CL",
              "lastDataReceivedQuery": "Awareness_User_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Awareness_Watchlist_Details_CL",
              "lastDataReceivedQuery": "Awareness_Watchlist_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Awareness_Performance_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                "Awareness_SafeScore_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                "Awareness_User_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                "Awareness_Watchlist_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Awareness_Performance_Details_CL",
              "query": "Awareness_Performance_Details_CL\n| sort by TimeGenerated desc"
            },
            {
              "description": "Awareness_SafeScore_Details_CL",
              "query": "Awareness_SafeScore_Details_CL\n| sort by TimeGenerated desc"
            },
            {
              "description": "Awareness_User_Data_CL",
              "query": "Awareness_User_Data_CL\n| sort by TimeGenerated desc"
            },
            {
              "description": "Awareness_Watchlist_Details_CL",
              "query": "Awareness_User_Data_CL\n| sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "You need to have a resource group created with a subscription you are going to use.",
              "title": "Resource group"
            },
            {
              "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret",
              "title": "Functions app"
            },
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
              "title": "Configuration:"
            },
            {
              "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Use this method for automated deployment of the Mimecast Awareness Training Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAT-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 0 */1 * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
              "title": "Azure Resource Manager (ARM) Template"
            }
          ],
          "id": "[variables('_uiConfigId1')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion2')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId2'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId2')]",
                  "title": "Mimecast Audit (using Azure Functions)",
                  "publisher": "Mimecast",
                  "descriptionMarkdown": "The data connector for [Mimecast Audit](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to audit and authentication events within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into user activity, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \nAudit\n ",
                  "graphQueries": [
                    {
                      "metricName": "Total Audit data received",
                      "legend": "MimecastAudit_CL",
                      "baseQuery": "MimecastAudit_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "MimecastAudit_CL",
                      "query": "MimecastAudit_CL\n| sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "MimecastAudit_CL",
                      "lastDataReceivedQuery": "MimecastAudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "MimecastAudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
                      "title": "Configuration:"
                    },
                    {
                      "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Use this method for automated deployment of the Mimecast Audit Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAuditAzureDeploy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tStart Date \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 0 */1 * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
                      "title": "Deploy the Mimecast Audit Data Connector:"
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId2'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
                "contentId": "[variables('_dataConnectorContentId2')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId2')]",
        "contentKind": "DataConnector",
        "displayName": "Mimecast Audit (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId2')]",
        "id": "[variables('_dataConnectorcontentProductId2')]",
        "version": "[variables('dataConnectorVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId2'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId2')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
        "contentId": "[variables('_dataConnectorContentId2')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion2')]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId2'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Mimecast Audit (using Azure Functions)",
          "publisher": "Mimecast",
          "descriptionMarkdown": "The data connector for [Mimecast Audit](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to audit and authentication events within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into user activity, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \nAudit\n ",
          "graphQueries": [
            {
              "metricName": "Total Audit data received",
              "legend": "MimecastAudit_CL",
              "baseQuery": "MimecastAudit_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "MimecastAudit_CL",
              "lastDataReceivedQuery": "MimecastAudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "MimecastAudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "MimecastAudit_CL",
              "query": "MimecastAudit_CL\n| sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
              "title": "Configuration:"
            },
            {
              "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Use this method for automated deployment of the Mimecast Audit Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAuditAzureDeploy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tStart Date \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 0 */1 * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
              "title": "Deploy the Mimecast Audit Data Connector:"
            }
          ],
          "id": "[variables('_uiConfigId2')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion3')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId3'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId3')]",
                  "title": "Mimecast Cloud Integrated (using Azure Functions)",
                  "publisher": "Mimecast",
                  "descriptionMarkdown": "The data connector for [Mimecast Cloud Integrated](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to the Cloud Integrated inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.",
                  "graphQueries": [
                    {
                      "metricName": "Total Cloud Integrated data received",
                      "legend": "Cloud_Integrated_CL",
                      "baseQuery": "Cloud_Integrated_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Cloud_Integrated_CL",
                      "query": "Cloud_Integrated_CL\n| sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Cloud_Integrated_CL",
                      "lastDataReceivedQuery": "Cloud_Integrated_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Cloud_Integrated_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "You need to have a resource group created with a subscription you are going to use.",
                      "title": "Resource group"
                    },
                    {
                      "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret",
                      "title": "Functions app"
                    },
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
                      "title": "Configuration:"
                    },
                    {
                      "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Use this method for automated deployment of the Mimecast Cloud Integrated Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastCI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 */30 * * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
                      "title": "Azure Resource Manager (ARM) Template"
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId3'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId3'))]",
                "contentId": "[variables('_dataConnectorContentId3')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId3')]",
        "contentKind": "DataConnector",
        "displayName": "Mimecast Cloud Integrated (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId3')]",
        "id": "[variables('_dataConnectorcontentProductId3')]",
        "version": "[variables('dataConnectorVersion3')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId3'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId3')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId3'))]",
        "contentId": "[variables('_dataConnectorContentId3')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion3')]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId3'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Mimecast Cloud Integrated (using Azure Functions)",
          "publisher": "Mimecast",
          "descriptionMarkdown": "The data connector for [Mimecast Cloud Integrated](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to the Cloud Integrated inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.",
          "graphQueries": [
            {
              "metricName": "Total Cloud Integrated data received",
              "legend": "Cloud_Integrated_CL",
              "baseQuery": "Cloud_Integrated_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Cloud_Integrated_CL",
              "lastDataReceivedQuery": "Cloud_Integrated_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Cloud_Integrated_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Cloud_Integrated_CL",
              "query": "Cloud_Integrated_CL\n| sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "You need to have a resource group created with a subscription you are going to use.",
              "title": "Resource group"
            },
            {
              "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret",
              "title": "Functions app"
            },
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
              "title": "Configuration:"
            },
            {
              "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Use this method for automated deployment of the Mimecast Cloud Integrated Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastCI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 */30 * * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
              "title": "Azure Resource Manager (ARM) Template"
            }
          ],
          "id": "[variables('_uiConfigId3')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName4')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion4')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId4'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId4')]",
                  "title": "Mimecast Secure Email Gateway (using Azure Functions)",
                  "publisher": "Mimecast",
                  "descriptionMarkdown": "The data connector for [Mimecast Secure Email Gateway](https://community.mimecast.com/s/article/Azure-Sentinel) allows easy log collection from the Secure Email Gateway to surface email insight and user activity within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities. Mimecast products and features required: \n- Mimecast Cloud Gateway \n- Mimecast Data Leak Prevention\n ",
                  "graphQueries": [
                    {
                      "metricName": "Total Cloud Gateway data received",
                      "legend": "Seg_Cg_CL",
                      "baseQuery": "Seg_Cg_CL"
                    },
                    {
                      "metricName": "Total Data Leak Prevention data received",
                      "legend": "Seg_Dlp_CL",
                      "baseQuery": "Seg_Dlp_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Seg_Cg_CL",
                      "query": "Seg_Cg_CL\n| sort by TimeGenerated desc"
                    },
                    {
                      "description": "Seg_Dlp_CL",
                      "query": "Seg_Dlp_CL\n| sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Seg_Cg_CL",
                      "lastDataReceivedQuery": "Seg_Cg_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Seg_Dlp_CL",
                      "lastDataReceivedQuery": "Seg_Dlp_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Seg_Cg_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                        "Seg_Dlp_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
                      "title": "Configuration:"
                    },
                    {
                      "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Use this method for automated deployment of the Mimecast Secure Email Gateway Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastSEGAzureDeploy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tSchedule (0 */30 * * * *) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tLog Level (Default: INFO) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
                      "title": "Deploy the Mimecast Secure Email Gateway Data Connector:"
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId4'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId4'))]",
                "contentId": "[variables('_dataConnectorContentId4')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion4')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId4')]",
        "contentKind": "DataConnector",
        "displayName": "Mimecast Secure Email Gateway (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId4')]",
        "id": "[variables('_dataConnectorcontentProductId4')]",
        "version": "[variables('dataConnectorVersion4')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId4'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId4')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId4'))]",
        "contentId": "[variables('_dataConnectorContentId4')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion4')]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId4'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Mimecast Secure Email Gateway (using Azure Functions)",
          "publisher": "Mimecast",
          "descriptionMarkdown": "The data connector for [Mimecast Secure Email Gateway](https://community.mimecast.com/s/article/Azure-Sentinel) allows easy log collection from the Secure Email Gateway to surface email insight and user activity within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities. Mimecast products and features required: \n- Mimecast Cloud Gateway \n- Mimecast Data Leak Prevention\n ",
          "graphQueries": [
            {
              "metricName": "Total Cloud Gateway data received",
              "legend": "Seg_Cg_CL",
              "baseQuery": "Seg_Cg_CL"
            },
            {
              "metricName": "Total Data Leak Prevention data received",
              "legend": "Seg_Dlp_CL",
              "baseQuery": "Seg_Dlp_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Seg_Cg_CL",
              "lastDataReceivedQuery": "Seg_Cg_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Seg_Dlp_CL",
              "lastDataReceivedQuery": "Seg_Dlp_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Seg_Cg_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                "Seg_Dlp_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Seg_Cg_CL",
              "query": "Seg_Cg_CL\n| sort by TimeGenerated desc"
            },
            {
              "description": "Seg_Dlp_CL",
              "query": "Seg_Dlp_CL\n| sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
              "title": "Configuration:"
            },
            {
              "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Use this method for automated deployment of the Mimecast Secure Email Gateway Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastSEGAzureDeploy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tSchedule (0 */30 * * * *) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tLog Level (Default: INFO) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
              "title": "Deploy the Mimecast Secure Email Gateway Data Connector:"
            }
          ],
          "id": "[variables('_uiConfigId4')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName5')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Mimecast data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion5')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId5'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId5')]",
                  "title": "Mimecast Targeted Threat Protection (using Azure Functions)",
                  "publisher": "Mimecast",
                  "descriptionMarkdown": "The data connector for [Mimecast Targeted Threat Protection](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- URL Protect \n- Impersonation Protect \n- Attachment Protect\n",
                  "graphQueries": [
                    {
                      "metricName": "Total URL Protect data received",
                      "legend": "Ttp_Url_CL",
                      "baseQuery": "Ttp_Url_CL"
                    },
                    {
                      "metricName": "Total Attachment Protect data received",
                      "legend": "Ttp_Attachment_CL",
                      "baseQuery": "Ttp_Attachment_CL"
                    },
                    {
                      "metricName": "Total Impersonation Protect data received",
                      "legend": "Ttp_Impersonation_CL",
                      "baseQuery": "Ttp_Impersonation_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Ttp_Url_CL",
                      "query": "Ttp_Url_CL\n| sort by TimeGenerated desc"
                    },
                    {
                      "description": "Ttp_Attachment_CL",
                      "query": "Ttp_Attachment_CL\n| sort by TimeGenerated desc"
                    },
                    {
                      "description": "Ttp_Impersonation_CL",
                      "query": "Ttp_Impersonation_CL\n| sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Ttp_Url_CL",
                      "lastDataReceivedQuery": "Ttp_Url_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Ttp_Attachment_CL",
                      "lastDataReceivedQuery": "Ttp_Attachment_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Ttp_Impersonation_CL",
                      "lastDataReceivedQuery": "Ttp_Impersonation_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Ttp_Url_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                        "Ttp_Attachment_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                        "Ttp_Impersonation_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "You need to have a resource group created with a subscription you are going to use.",
                      "title": "Resource group"
                    },
                    {
                      "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret",
                      "title": "Functions app"
                    },
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
                      "title": "Configuration:"
                    },
                    {
                      "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Use this method for automated deployment of the Mimecast Targeted Threat Protection Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastTTPAzureDeploy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tStart Date \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 0 */1 * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
                      "title": "Azure Resource Manager (ARM) Template"
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId5'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId5'))]",
                "contentId": "[variables('_dataConnectorContentId5')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion5')]",
                "source": {
                  "kind": "Solution",
                  "name": "Mimecast",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Mimecast",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Mimecast",
                  "email": "support@mimecast.com",
                  "tier": "Partner",
                  "link": "https://community.mimecast.com/s/contactsupport"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId5')]",
        "contentKind": "DataConnector",
        "displayName": "Mimecast Targeted Threat Protection (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId5')]",
        "id": "[variables('_dataConnectorcontentProductId5')]",
        "version": "[variables('dataConnectorVersion5')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId5'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId5')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId5'))]",
        "contentId": "[variables('_dataConnectorContentId5')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion5')]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId5'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Mimecast Targeted Threat Protection (using Azure Functions)",
          "publisher": "Mimecast",
          "descriptionMarkdown": "The data connector for [Mimecast Targeted Threat Protection](https://community.mimecast.com/s/article/Azure-Sentinel) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- URL Protect \n- Impersonation Protect \n- Attachment Protect\n",
          "graphQueries": [
            {
              "metricName": "Total URL Protect data received",
              "legend": "Ttp_Url_CL",
              "baseQuery": "Ttp_Url_CL"
            },
            {
              "metricName": "Total Attachment Protect data received",
              "legend": "Ttp_Attachment_CL",
              "baseQuery": "Ttp_Attachment_CL"
            },
            {
              "metricName": "Total Impersonation Protect data received",
              "legend": "Ttp_Impersonation_CL",
              "baseQuery": "Ttp_Impersonation_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Ttp_Url_CL",
              "lastDataReceivedQuery": "Ttp_Url_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Ttp_Attachment_CL",
              "lastDataReceivedQuery": "Ttp_Attachment_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Ttp_Impersonation_CL",
              "lastDataReceivedQuery": "Ttp_Impersonation_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Ttp_Url_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                "Ttp_Attachment_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
                "Ttp_Impersonation_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Ttp_Url_CL",
              "query": "Ttp_Url_CL\n| sort by TimeGenerated desc"
            },
            {
              "description": "Ttp_Attachment_CL",
              "query": "Ttp_Attachment_CL\n| sort by TimeGenerated desc"
            },
            {
              "description": "Ttp_Impersonation_CL",
              "query": "Ttp_Impersonation_CL\n| sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "You need to have a resource group created with a subscription you are going to use.",
              "title": "Resource group"
            },
            {
              "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret",
              "title": "Functions app"
            },
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)",
              "title": "Configuration:"
            },
            {
              "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Use this method for automated deployment of the Mimecast Targeted Threat Protection Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastTTPAzureDeploy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBase URL (Default: https://api.services.mimecast.com) \n\t\tStart Date \n\t\tMimecast Client ID \n\t\tMimecast Client Secret \n\t\tLog Level (Default: INFO) \n\t\tSchedule (0 0 */1 * * *) \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
              "title": "Azure Resource Manager (ARM) Template"
            }
          ],
          "id": "[variables('_uiConfigId5')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.0",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Mimecast",
        "publisherDisplayName": "Mimecast",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Mimecast/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>An Azure app to enable Mimecast data to be viewed using analytical tables and charts which are brought into Azure.</p>\n<p><strong>Data Connectors:</strong> 5, <strong>Parsers:</strong> 11, <strong>Workbooks:</strong> 5, <strong>Analytic Rules:</strong> 13, <strong>Playbooks:</strong> 1</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Mimecast.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Mimecast",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Mimecast",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Mimecast",
          "email": "support@mimecast.com",
          "tier": "Partner",
          "link": "https://community.mimecast.com/s/contactsupport"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
              "version": "[variables('analyticRuleObject8').analyticRuleVersion8]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
              "version": "[variables('analyticRuleObject9').analyticRuleVersion9]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
              "version": "[variables('analyticRuleObject10').analyticRuleVersion10]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
              "version": "[variables('analyticRuleObject11').analyticRuleVersion11]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
              "version": "[variables('analyticRuleObject12').analyticRuleVersion12]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
              "version": "[variables('analyticRuleObject13').analyticRuleVersion13]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId2')]",
              "version": "[variables('workbookVersion2')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId3')]",
              "version": "[variables('workbookVersion3')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId4')]",
              "version": "[variables('workbookVersion4')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId5')]",
              "version": "[variables('workbookVersion5')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_Mimecast Data Connector Trigger Sync')]",
              "version": "[variables('playbookVersion1')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject1').parserContentId1]",
              "version": "[variables('parserObject1').parserVersion1]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject2').parserContentId2]",
              "version": "[variables('parserObject2').parserVersion2]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject3').parserContentId3]",
              "version": "[variables('parserObject3').parserVersion3]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject4').parserContentId4]",
              "version": "[variables('parserObject4').parserVersion4]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject5').parserContentId5]",
              "version": "[variables('parserObject5').parserVersion5]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject6').parserContentId6]",
              "version": "[variables('parserObject6').parserVersion6]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject7').parserContentId7]",
              "version": "[variables('parserObject7').parserVersion7]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject8').parserContentId8]",
              "version": "[variables('parserObject8').parserVersion8]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject9').parserContentId9]",
              "version": "[variables('parserObject9').parserVersion9]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject10').parserContentId10]",
              "version": "[variables('parserObject10').parserVersion10]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject11').parserContentId11]",
              "version": "[variables('parserObject11').parserVersion11]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId2')]",
              "version": "[variables('dataConnectorVersion2')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId3')]",
              "version": "[variables('dataConnectorVersion3')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId4')]",
              "version": "[variables('dataConnectorVersion4')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId5')]",
              "version": "[variables('dataConnectorVersion5')]"
            }
          ]
        },
        "firstPublishDate": "2024-09-10",
        "lastPublishDate": "2024-09-10",
        "providers": [
          "Mimecast"
        ],
        "categories": {
          "domains": [
            "Security - Network"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
