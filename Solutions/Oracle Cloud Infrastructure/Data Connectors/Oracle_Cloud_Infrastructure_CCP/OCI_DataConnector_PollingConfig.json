{
  "type": "Microsoft.SecurityInsights/dataConnectors",
  "apiVersion": "2024-09-01",
  "name": "[[concat('parameters('workspace')','/Microsoft.SecurityInsights/', base64(concat( parameters('tenantId'), parameters('streamId'),'#' , parameters('partitions'))) )]",
  "location": "{{location}}",
  "kind": "OCI",
  "properties": {
    "auth": {
      "type": "Oracle",
      "pemFile": "[[parameters('pemFile')]",
      "publicFingerprint": "[[parameters('publicFingerprint')]",
      "tenantId": "[[parameters('tenantId')]",
      "userId": "[[parameters('userId')]",
      "passPhrase": "[[parameters('passPhrase')]"
    },
    "request": {
      "streamId": "[[parameters('streamId')]",
      "rateLimitQPS": 1,
      "partitions": "[[parameters('partitions')]",
      "serviceEndpointBaseUrl": "[[parameters('serviceEndpointBaseUrl')]",
      "queryWindowInMin": 5,
      "cursorType": "[[parameters('cursorType')[0]]",
      "type": "OCI"
    },
    "response": {
      "eventsJsonPaths": [
        "$"
      ],
      "format": "json"
    },
    "Paging": {
      "pageSize": 100
    },
    "connectorDefinitionName": "OCI-Connector-CCP-Definition",
    "dataType": "OCI_LogsV2",
    "dcrConfig": {
      "streamName": "Custom-OCI_LogsV2_CL",
      "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
      "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
    },
    "addOnAttributes": {
      "stream": "[[parameters('streamId')]",
      "EventVendor": "Oracle",
      "EventProduct": "Oracle Cloud Infrastructure"
    }
  }
}