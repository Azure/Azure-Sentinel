{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "customApis_CiscoUmbrellaInvestigateAPIConnector_name": {
            "defaultValue": "CiscoUmbrellaInvestigateAPI",
            "type": "String"
        }
    },
    "variables": {},
    "resources": [
        {
            "type": "Microsoft.Web/customApis",
            "apiVersion": "2016-06-01",
            "name": "[parameters('customApis_CiscoUmbrellaInvestigateAPIConnector_name')]",
            "location": "[resourceGroup().location]",
            "properties": {
                "connectionParameters": {
                    "api_key": {
                        "type": "securestring",
                        "uiDefinition": {
                            "displayName": "API Key",
                            "description": "The API Key for this api",
                            "tooltip": "Provide your API Key in format: Bearer YOUR_API_KEY",
                            "constraints": {
                                "tabIndex": 2,
                                "clearText": false,
                                "required": "true"
                            }
                        }
                    }
                },
                "brandColor": "#FFFFFF",
                "description": "Connector for Cisco Umbrella Investigate API",
                "displayName": "[parameters('customApis_CiscoUmbrellaInvestigateAPIConnector_name')]",
                "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAABdFBMVEUAAAAA//8AgP8Aqv8AgL8AmcwAmeYAotEAldUAn98AntsAodkAnNYAn9cIotgIntoHoNsHnNwHodcHndgGotoGoNsGnNYGn9cFn9sEoNgEndkEoNoEntsEntgEoNsEn9gDn9kDoNoDn9gDoNgDn9kFn9gFntgFn9kFn9oFoNoFn9gEn9kEoNkEn9oEoNgEn9kEntkEoNoEoNkEn9kEn9kEntkEoNgEntgEn9kEn9oEntoEn9gEoNgEntkEn9kEoNkEn9oEn9oEntgDn9kDn9gDoNkDn9kFn9oFn9gFn9kFntkFn9oEn9kEntoEn9gEoNkEn9kEoNkEn9oEn9gEn9kEn9kEn9kEn9kEn9kEn9kEn9kEn9kEn9kEntkEn9kEn9kEn9kEn9oDn9kFn9kEoNkEn9kEn9kEn9kEn9kEn9oEn9kEn9kEn9kEn9kEoNkEn9kEn9gEn9kEn9kEn9kEn9kEn9kEoNkEn9kEn9kEn9kEn9n///940Z2XAAAAenRSTlMAAQIDBAUKCwwQFRsfICEiIyQmJykrLC04Ozw+P0JGSEpTVVtdaGlqbW5wcnN1dnh5e35/gIGDhIeIiYqLjI2Oj5CRkpibnKSlp6mqsLGys7q7v8DCxMfKz9DS1NXW19jZ2t7g4+To6u3u7/Dx8vP09fb3+Pn6+/z9/h6/P2sAAAABYktHRHtP0rX8AAACB0lEQVRYw+2WaVPTYBRGb9SK4oI7dd+tAiqCra1FqKIoKu4bUFQQtJY2SUna2vPr/VCSafKmpONkHMfJ86m5OXOmN3Pfm4jEiRMnTtQZKadCkfWRHkTrlMKRcg8iIALkvxRlKsM+yq10RTLVW6qohuETuZWuSA1zi7+r/uiKBLb4z4jyxt0wUd5Ih4jyRlps7DCRjRUisrG26khpoOsdIDqR5bRmUvPhTsVFan7EKdjYMq5n2zdHK/5H6lRcJF31IU4hZ2TjNfJHolL4Qi71tLMv/xyOAInzV3LgftE0vjz1zMnRZz/qa28GAgg5PrtmrTw8onqG6oBvPQzqAJxQCe1eC4C68jExBKroOWA2NkUe4rZzwVWvZ78NzGeuZJc6RWW4qCUG+xXicBMac4X3gLXXI5oCHu0QkW2dogpcCCSmYeOkiKSACY+oCN93KofyHbReJgOIJWi/e17DgkdkwJx6uk83AWa2K4QJZ9rLE99rXQ8UyblvADcUwoCzIiJyB6pKa30B+yZx/iMsK0QR8iIi2gdY9IgKwEzC/7BFRPp+saEQD8A6JSLXgYJ3rG1g/mZq4mun6NKx/j2jsKIQh5rQfJF/CzQO9jCQm6VJlRh3B3LMP9rX7G6ihd0qoeXaR6SV05TDtm9y0dQ/z3aKXi1X9U9ju4IIST5ZtVYfJ+NlFydOnKjyG0KNPhWovN8UAAAAAElFTkSuQmCC",
                "backendService": {
                    "serviceUrl": "https://investigate.api.umbrella.com"
                },
                "apiType": "Rest",
                "swagger": {
                    "swagger": "2.0",
                    "info": {
                        "title": "Default title",
                        "description": "Connector for Cisco Umbrella Investigate API",
                        "version": "1.0"
                    },
                    "host": "investigate.api.umbrella.com",
                    "basePath": "/",
                    "schemes": [
                        "https"
                    ],
                    "consumes": [],
                    "produces": [],
                    "paths": {
                        "/security/name/{Domain}": {
                            "get": {
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "dga_score": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Domain Generation Algorithm. This score is generated based on the likeliness of the domain name being generated by an algorithm rather than a human. This algorithm is designed to identify domains which have been created using an automated randomization strategy, which is a common evasion technique in malware kits or botnets. This score ranges from -100 (suspicious) to 0 (benign)."
                                                },
                                                "perplexity": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "A second score on the likeliness of the name to be algorithmically generated, on a scale from 0 to 100. This score is to be used in conjunction with DGA."
                                                },
                                                "entropy": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "The number of bits required to encode the domain name, as a score. This score is to be used in conjunction with DGA and Perplexity."
                                                },
                                                "securerank2": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "Suspicious rank for a domain that reviews based on the lookup behavior of client IP for the domain. Securerank is designed to identify hostnames requested by known infected clients but never requested by clean clients, assuming these domains are more likely to be bad. Scores returned range from -100 (suspicious) to 100 (benign)."
                                                },
                                                "pagerank": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "Popularity according to Google's pagerank algorithm"
                                                },
                                                "asn_score": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "ASN reputation score, ranges from -100 to 0 with -100 being very suspicious."
                                                },
                                                "prefix_score": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "Prefix ranks domains given their IP prefixes (an IP prefix is the first three octets in an IP address) and the reputation score of these prefixes. Ranges from -100 to 0, -100 being very suspicious."
                                                },
                                                "rip_score": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "description": "RIP ranks domains given their IP addresses and the reputation score of these IP addresses. Ranges from -100 to 0, -100 being very suspicious."
                                                },
                                                "popularity": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "The number of unique client IPs visiting this site, relative to the all requests to all sites. A score of how many different client/unique IPs go to this domain compared to others."
                                                },
                                                "fastflux": {
                                                    "type": "boolean",
                                                    "description": "fastflux",
                                                    "x-ms-visibility": "internal"
                                                },
                                                "geodiversity": {
                                                    "type": "array",
                                                    "description": "array of geodiversity tuples",
                                                    "x-ms-summary": "geodiversity array",
                                                    "items": {
                                                        "x-ms-summary": "geodiversity tuple",
                                                        "description": "Tuple [\"country code\", \"score\"]. A score representing the number of queries from clients visiting the domain, broken down by country. Score is a non-normalized ratio between 0 and 1.",
                                                        "type": "array",
                                                        "items": {}
                                                    }
                                                },
                                                "geodiversity_normalized": {
                                                    "type": "array",
                                                    "description": "array of geodiversity_normalized tuples",
                                                    "x-ms-summary": "geodiversity_normalized array",
                                                    "items": {
                                                        "x-ms-summary": "geodiversity_normalized tuple",
                                                        "description": "Tuple [\"country code\", \"score\"]. A score representing the amount of queries for clients visiting the domain, broken down by country. Score is a normalized ratio between 0 and 1.",
                                                        "type": "array",
                                                        "items": {}
                                                    }
                                                },
                                                "tld_geodiversity": {
                                                    "type": "array",
                                                    "description": "array of tld_geodiversity tuples",
                                                    "x-ms-summary": "tld_geodiversity array",
                                                    "items": {
                                                        "x-ms-summary": "tld_geodiversity tuple",
                                                        "description": "Tuple [\"country code\", \"score\"]. A score that represents the TLD country code geodiversity as a percentage of clients visiting the domain. Occurs most often with domains that have a ccTLD. Score is normalized ratio between 0 and 1.",
                                                        "type": "array",
                                                        "items": {}
                                                    }
                                                },
                                                "geoscore": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "A score that represents how far the different physical locations serving this name are from each other."
                                                },
                                                "ks_test": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Kolmogorovâ€“Smirnov test on geodiversity. 0 means that the client traffic matches what is expected for this TLD."
                                                },
                                                "attack": {
                                                    "type": "string",
                                                    "description": "The name of any known attacks associated with this domain. Returns blank if no known threat associated with domain."
                                                },
                                                "threat_type": {
                                                    "type": "string",
                                                    "description": "The type of the known attack, such as botnet or APT. Returns blank if no known threat associated with domain."
                                                },
                                                "found": {
                                                    "type": "boolean",
                                                    "description": "Returns true if results available. Returns blank if no known threat associated with domain."
                                                }
                                            }
                                        }
                                    }
                                },
                                "summary": "Get domain security data",
                                "description": "Security Information for a Domain",
                                "operationId": "GetDomainSecurityData",
                                "parameters": [
                                    {
                                        "name": "Domain",
                                        "in": "path",
                                        "required": true,
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "/domains/risk-score/{DomainName}": {
                            "get": {
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "indicators": {
                                                    "type": "array",
                                                    "x-ms-summary": "indicators",
                                                    "description": "array of indicator objects",
                                                    "items": {
                                                        "x-ms-summary": "indicator",
                                                        "description": "indicator object",
                                                        "type": "object",
                                                        "properties": {
                                                            "indicator": {
                                                                "type": "string",
                                                                "description": "indicator name",
                                                                "title": "name"
                                                            },
                                                            "normalized_score": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "indicator normalized score"
                                                            },
                                                            "score": {
                                                                "type": "boolean",
                                                                "description": "indicator score"
                                                            }
                                                        }
                                                    }
                                                },
                                                "risk_score": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "risk score"
                                                }
                                            }
                                        }
                                    }
                                },
                                "summary": "Get Risk score for a domain",
                                "description": "Get Risk score for a domain",
                                "operationId": "GetDomainRiskScore",
                                "parameters": [
                                    {
                                        "name": "DomainName",
                                        "in": "path",
                                        "required": true,
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "/domains/categorization/{Domain}": {
                            "get": {
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "additionalProperties": {
                                                "type": "object",
                                                "description": "Domain object",
                                                "title": "Domain object",
                                                "x-ms-summary": "Domain object",
                                                "properties": {
                                                    "status": {
                                                        "type": "integer",
                                                        "format": "int32",
                                                        "description": "The status will be \"-1\" if the domain is believed to be malicious, \"1\" if the domain is believed to be benign, \"0\" if it hasn't been classified yet."
                                                    },
                                                    "security_categories": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "The Umbrella security category, or categories, that match this domain or that this domain is associated with. If none match, the return will be blank."
                                                    },
                                                    "content_categories": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "The Umbrella content category or categories that match this domain. If none match, the return will be blank."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                "summary": "Get Domain Status and Categorization",
                                "description": "Get Domain Status and Categorization",
                                "operationId": "GetDomainStatusAndCategorization",
                                "parameters": [
                                    {
                                        "name": "Domain",
                                        "in": "path",
                                        "required": true,
                                        "type": "string"
                                    },
                                    {
                                        "name": "showLabels",
                                        "in": "query",
                                        "required": true,
                                        "type": "string",
                                        "default": 1,
                                        "x-ms-visibility": "internal"
                                    }
                                ]
                            }
                        },
                        "/recommendations/name/{Domain}": {
                            "get": {
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "pfs2": {
                                                    "type": "array",
                                                    "x-ms-summary": "pfs2 array",
                                                    "description": "Array of [domain name, scores] tuples. The values range between 0 and 1 and should not exceed 1. All co-occurences of requests from client IPs are returned for the previous seven days whether the co-occurence is suspicious or not.",
                                                    "items": {
                                                        "x-ms-summary": "pfs2 tuple",
                                                        "description": "[domain name, scores] tuple. The values range between 0 and 1 and should not exceed 1. All co-occurences of requests from client IPs are returned for the previous seven days whether the co-occurence is suspicious or not.",
                                                        "type": "array",
                                                        "items": {}
                                                    }
                                                },
                                                "found": {
                                                    "type": "boolean",
                                                    "description": "Returns true if results available. Nothing is returned if no results available."
                                                }
                                            }
                                        }
                                    }
                                },
                                "summary": "Get Co-Occurrences for a Domain",
                                "description": "Get Co-Occurrences for a Domain",
                                "operationId": "GetCoOccurrencesForDomain",
                                "parameters": [
                                    {
                                        "name": "Domain",
                                        "in": "path",
                                        "required": true,
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "/links/name/{Domain}": {
                            "get": {
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "tb1": {
                                                    "type": "array",
                                                    "x-ms-summary": "tb1 array",
                                                    "description": "Array of [domain name, scores] tuples where score is the number of client IP requests to the site around the same time as the site being looked up. This is a score reflecting the number of client IPs looking up related sites within 60 seconds of the original request.",
                                                    "items": {
                                                        "x-ms-summary": "tb1 tuple",
                                                        "description": "[domain name, scores] tuples where score is the number of client IP requests to the site around the same time as the site being looked up. This is a score reflecting the number of client IPs looking up related sites within 60 seconds of the original request.",
                                                        "type": "array",
                                                        "items": {}
                                                    }
                                                },
                                                "found": {
                                                    "type": "boolean",
                                                    "description": "Returns true if results available. Nothing is returned if no results available."
                                                }
                                            }
                                        }
                                    }
                                },
                                "summary": "Get a list of domain names requested the same time as a specified domain",
                                "description": "Get a list of domain names requested the same time as a specified domain",
                                "operationId": "GetRelatedDomains",
                                "parameters": [
                                    {
                                        "name": "Domain",
                                        "in": "path",
                                        "required": true,
                                        "type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "definitions": {},
                    "parameters": {},
                    "responses": {},
                    "securityDefinitions": {
                        "API Key": {
                            "type": "apiKey",
                            "in": "header",
                            "name": "Authorization"
                        }
                    },
                    "security": [
                        {
                            "API Key": []
                        }
                    ],
                    "tags": []
                }
            }
        }
    ]
}