{
  "type": "Microsoft.SecurityInsights/dataConnectors",
  "apiVersion": "2022-10-01-preview",
  "name": "illumioInsightsSummaryPoller",
  "location": "{{location}}",
  "kind": "RestApiPoller",
  "properties": {
    "connectorDefinitionName": "IllumioInsightsSummaryCCP",
    "dataType": "IllumioInsightsSummary",
    "auth": {
      "type": "APIKey",
      "ApiKey": "[[parameters('apiToken')]",
      "ApiKeyName": "X-api-secret"
    },
    "request": {
      "apiEndpoint": "https://gw.console.illum.io/api/v1/insights-summary",
      "httpMethod": "GET",
      "rateLimitQPS": 10,
      "queryWindowInMin": 360,
      "retryCount": 3,
      "timeoutInSeconds": 60,
      "headers": {
        "Accept": "application/json",
        "User-Agent": "MS-Sentinel-CCP-IllumioInsightsSummary",
        "x-illumio-tenant-id": "[[parameters('illumioTenantId')]",
        "X-api-key": "[[parameters('apiKey')]"
      },
      "queryParameters": {
        "persona": "threat_hunter",
        "report_interval": "daily"
      }
    },
    "response": {
      "eventsJsonPaths": [
        "$"
      ],
      "format": "json"
    },
    "dcrConfig": {
      "streamName": "Custom-IllumioInsightsSummary_CL",
      "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
      "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
    }
  }
}