[
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2023-04-01-preview",
    "name": "MorphisecApiThreatsPoller",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "MorphisecCCF",
      "dataType": "Morphisec",
      "dcrConfig": {
        "streamName": "Custom-MorphisecAlerts_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "clientId": "{{clientId}}",
        "clientSecret": "{{secret}}",
        "TokenEndpoint": "{{baseUrl}}/api/v1/oauth/token",
        "grantType": "client_credentials",
        "tokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        }
      },
      "request": {
        "httpMethod": "GET",
        "apiEndpoint": "{{baseUrl}}/api/v1/threats/list-by-time",
        "headers": {
          "Content-Type": "application/json",
          "Accept": "application/json",
          "User-Agent": "scuba"
        },
        "queryParameters": {
          "tenantId": "{{tenantId}}",
          "from": "{_QueryWindowStartTime}",
          "to": "{_QueryWindowEndTime}"
        },
        "isPostPayloadJson": true,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "rateLimitQPS": 15,
        "queryWindowInMin": 5,
        "timeoutInSeconds": 45,
        "logResponseContent": true
      },
      "response": {
        "eventsJsonPaths": [
          "$.threats"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageParaName": "page",
        "PageSize": 50,
        "PageSizeParameterName": "pageSize",
        "nextPageTokenJsonPath": "$.nextPage"
      }
    }
  }
]