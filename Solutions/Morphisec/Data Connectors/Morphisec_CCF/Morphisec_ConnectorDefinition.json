{
  "apiVersion": "2023-04-01-preview",
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "name": "MorphisecCCF",
  "location": "{{location}}",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "MorphisecCCF",
      "title": "Morphisec API Data Connector (via Codeless Connector Framework)",
      "publisher": "Morphisec",
      "descriptionMarkdown": "The [Morphisec](https://www.morphisec.com/) solution for Microsoft Sentinel enables you to seamlessly ingest security alerts directly from the Morphisec API. By leveraging Morphisec's proactive breach prevention and moving target defense capabilities, this integration enriches your security operations with high-fidelity, low-noise alerts on evasive threats.\nThis solution provides more than just data ingestion; it equips your security team with a full suite of ready-to-use content, including: Data Connector, ASIM Parser, Analytic Rule Templates and Workbook.\nWith this solution, you can empower your SOC to leverage Morphisec's powerful threat prevention within a unified investigation and response workflow in Microsoft Sentinel.",
      "graphQueriesTableName": "MorphisecAlerts_CL",
      "graphQueries": [
        {
          "metricName": "Total Vulnerability logs received",
          "legend": "Morphisec Vulnerability Logs",
          "baseQuery": "{{graphQueriesTableName}}"
        }
      ],
      "sampleQueries": [
        {
          "description": "Get all Morphisec alerts",
          "query": "{{graphQueriesTableName}} | take 10"
        }
      ],
      "dataTypes": [
        {
          "name": "{{graphQueriesTableName}}",
          "lastDataReceivedQuery": "{{graphQueriesTableName}} | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors"
        }
      ],
      "availability": {
        "isPreview": false
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "Read and Write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "write": true,
              "read": true,
              "delete": true
            }
          }
        ]
      },
      "instructionSteps": [
        {
          "title": "Configure Morphisec Connector",
          "description": "1. Create an API key client in Morphisec Console with read permissions to fetch alerts. \n2. Provide the Client ID and Client Secret in the connector configuration.",
          "instructions": [
            {
              "type": "Textbox",
              "parameters": {
                "label": "Morphisec Base URL",
                "placeholder": "https://<your-morphisec-region>.morphisec.cloud",
                "type": "text",
                "name": "baseUrl"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Client ID",
                "placeholder": "Enter the Client ID",
                "type": "text",
                "name": "clientId"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Client Secret",
                "placeholder": "Enter the Client Secret",
                "type": "password",
                "name": "secret"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Tenant ID",
                "placeholder": "Enter your Morphisec Tenant ID",
                "type": "text",
                "name": "tenantId"
              }
            },
            {
              "type": "ConnectionToggleButton",
              "parameters": {
                "connectLabel": "Connect to Morphisec",
                "name": "toggle"
              }
            }
          ]
        }
      ]
    }
  }
}