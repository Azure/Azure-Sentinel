id: 3fa85f64-5717-4562-b3fc-2c963f66afa6
name: Process-Level Anomaly
description: |
  'Triggers an incident when the same process name appears in 50 or more alerts across multiple devices, suggesting widespread activity.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: MorphisecCCF
    dataTypes:
      - Morphisec
queryFrequency: 1d
queryPeriod: 1d
triggerOperator: gt
triggerThreshold: 0
suppressionDuration: 5h
suppressionEnabled: false
tactics:
  - Execution
  - DefenseEvasion
relevantTechniques:
  - T1059
  - T1204
query: |
  MorphisecAlerts_CL
  | where threatMessageArrivalTime >= ago(24h)
  | summarize 
      AlertCount = dcount(id),
      DeviceCount = dcount(hostname)
      by application
  | where AlertCount >= 50 and DeviceCount > 1
customDetails:
  ProcessName: application
eventGroupingSettings:
  aggregationKind: SingleAlert
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: 5h
    matchingMethod: AllEntities
version: 1.0.0
kind: Scheduled

