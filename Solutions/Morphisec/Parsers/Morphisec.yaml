id: a68a352c-7f90-49ca-b5a0-36178788f43c
Function:
  Title: Parser for Morphisec
  Version: '3.1.0'
  LastUpdated: '2025-09-15'
Category: Microsoft Sentinel Parser
FunctionName: Morphisec
FunctionAlias: Morphisec
FunctionQuery: |
  MorphisecAlerts_CL
  | extend
  AlertDisplayName = tostring(name),
  AlertDescription = tostring(description),
  AlertProduct = "Morphisec",
  AlertVendor = "Morphisec",
  AlertSchemaVersion = "0.1",
  AlertType = tostring(threatType),
  TimeGenerated = todatetime(threatMessageArrivalTime),
  EventStartTime = todatetime(threatTime),
  AlertSeverity = case(
  attackSeverity == "CRITICAL", "High",
  attackSeverity == "HIGH", "High",
  attackSeverity == "MEDIUM", "Medium",
  attackSeverity == "LOW", "Low",
  "Informational"
  ),
  ConfidenceLevel = case(
  attackSeverity == "CRITICAL", "High",
  attackSeverity == "HIGH", "High",
  attackSeverity == "MEDIUM", "Medium",
  attackSeverity == "LOW", "Low",
  "Informational"
  ),
  Status = tostring(reviewStatus),
  ThreatCategory = tostring(classification),
  ThreatSubCategory = tostring(subClassification),
  ThreatName = tostring(name),
  ThreatOriginalConfidence = tostring(attackSeverity),
  Host = tostring(hostname),
  HostOS = tostring(operatingSystem),
  Process = tostring(application),
  TargetProcessName = tostring(application),
  TargetProcessCommandLine = tostring(processCommandLine),
  TargetProcessFilePath = tostring(filePath),
  TargetProcessFileHashSha256 = tostring(processSignature),
  ActingProcessCommandLine = tostring(parentProcessCommandLine),
  ActingProcessFileHashSha256 = tostring(parentProcessSignature),
  UserName = tostring(user),
  UserType = case(
  user contains "NT AUTHORITY", "System",
  "User"
  )
