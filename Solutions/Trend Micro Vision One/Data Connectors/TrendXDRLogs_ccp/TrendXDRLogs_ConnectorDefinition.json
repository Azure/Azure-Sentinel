{
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "apiVersion": "2025-03-01",
    "name": "TrendXDRLogsCCPDefinition",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
        "connectorUiConfig": {
            "id": "TrendXDRLogsCCPDefinition",
            "title": "Trend Micro Vision One XDR",
            "publisher": "Microsoft",
            "descriptionMarkdown": "The [Trend Vision One](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html) connector allows you to easily connect your Workbench alert data and OAT event data with Microsoft Sentinel to view dashboards, create custom alerts, and to improve monitoring and investigation capabilities. This gives you more insight into your organization's networks/systems and improves your security operation capabilities.",
            "graphQueriesTableName": "TrendMicroXDROATV2_CL",
            "graphQueries": [
                {
                    "metricName": "Total OAT events received",
                    "legend": "Trend Micro Vision One XDR OAT Logs",
                    "baseQuery": "{{graphQueriesTableName}}"
                }
            ],
            "sampleQueries": [
                {
                    "description": "Get Sample OAT Events",
                    "query": "{{graphQueriesTableName}}\n | take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "{{graphQueriesTableName}}",
                    "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors"
                }
            ],
            "availability": {
                "status": 1,
                "isPreview": false
            },
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "read": true,
                            "write": true,
                            "delete": true,
                            "action": false
                        }
                    }
                ]
            },
            "instructionSteps": [
                {
                    "title": "Connect Trend Micro Vision One XDR to Microsoft Sentinel",
                    "instructions": [
                        {
                            "type": "Markdown",
                            "parameters": {
                                "content": "To gather data from Trend Micro Vision One XDR, you need to provide the following resources"
                            }
                        },
                        {
                            "type": "Markdown",
                            "parameters": {
                                "content": "#### 1. API Key \n To gather data from Trend Micro Vision One XDR, an API key is required. [Click Here](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-api-keys-third-party-apps) for detailed instructions to obtain API key from Trend Vision One platform"
                            }
                        },
                        {
                            "type": "Markdown",
                            "parameters": {
                                "content": "#### 2. Platform Region Domain \n To gather data from Trend Micro Vision One XDR, region domain of your platform is required. [Click Here](https://automation.trendmicro.com/xdr/Guides/Regional-domains/) to find the exact Regional Domains."
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Trend Vision One API Key",
                                "placeholder": "Enter API key",
                                "type": "password",
                                "name": "apikey",
                                "required": true
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Trend Vision One Region Domain",
                                "placeholder": "Enter Region Domain",
                                "type": "string",
                                "name": "domain",
                                "required": true
                            }
                        },
                        {
                            "type": "ConnectionToggleButton",
                            "parameters": {
                                "connectLabel": "Connect",
                                "name": "toggle"
                            }
                        }
                    ]
                }
            ]
        }
    }
}