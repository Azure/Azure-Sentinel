{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "SpecterOps - support@specterops.io",
    "comments": "Solution template for BloodHound"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "BloodHound Enterprise Attack Path Details",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook2-name": {
      "type": "string",
      "defaultValue": "BloodHound Enterprise Attack Path Overview",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook3-name": {
      "type": "string",
      "defaultValue": "BloodHound Enterprise Audit Logs",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook4-name": {
      "type": "string",
      "defaultValue": "BloodHound Enterprise Domain Posture",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook5-name": {
      "type": "string",
      "defaultValue": "BloodHound Enterprise Tier Zero Search",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook6-name": {
      "type": "string",
      "defaultValue": "BloodHound Finding Trends",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "workbook7-name": {
      "type": "string",
      "defaultValue": "BloodHound Posture History",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "email": "support@specterops.io",
    "_email": "[variables('email')]",
    "_solutionName": "BloodHound",
    "_solutionVersion": "3.1.2",
    "solutionId": "azurehoundenterprise.bloodhoundenterprise-azuresentinel",
    "_solutionId": "[variables('solutionId')]",
    "workbookVersion1": "2.0",
    "workbookContentId1": "BloodHoundEnterpriseAttackPathDetails",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "workbookVersion2": "2.0",
    "workbookContentId2": "BloodHoundEnterpriseAttackPathOverview",
    "workbookId2": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId2'))]",
    "workbookTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId2'))))]",
    "_workbookContentId2": "[variables('workbookContentId2')]",
    "_workbookcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId2'),'-', variables('workbookVersion2'))))]",
    "workbookVersion3": "2.0",
    "workbookContentId3": "BloodHoundEnterpriseAuditLogs",
    "workbookId3": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId3'))]",
    "workbookTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId3'))))]",
    "_workbookContentId3": "[variables('workbookContentId3')]",
    "_workbookcontentProductId3": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId3'),'-', variables('workbookVersion3'))))]",
    "workbookVersion4": "2.0",
    "workbookContentId4": "BloodHoundEnterprisePosture",
    "workbookId4": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId4'))]",
    "workbookTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId4'))))]",
    "_workbookContentId4": "[variables('workbookContentId4')]",
    "_workbookcontentProductId4": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId4'),'-', variables('workbookVersion4'))))]",
    "workbookVersion5": "1.0",
    "workbookContentId5": "BloodHoundEnterpriseTierZeroSearch",
    "workbookId5": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId5'))]",
    "workbookTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId5'))))]",
    "_workbookContentId5": "[variables('workbookContentId5')]",
    "_workbookcontentProductId5": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId5'),'-', variables('workbookVersion5'))))]",
    "workbookVersion6": "1.0",
    "workbookContentId6": "BloodHoundFindingsTrends",
    "workbookId6": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId6'))]",
    "workbookTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId6'))))]",
    "_workbookContentId6": "[variables('workbookContentId6')]",
    "_workbookcontentProductId6": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId6'),'-', variables('workbookVersion6'))))]",
    "workbookVersion7": "1.0",
    "workbookContentId7": "BloodHoundPostureHistory",
    "workbookId7": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId7'))]",
    "workbookTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId7'))))]",
    "_workbookContentId7": "[variables('workbookContentId7')]",
    "_workbookcontentProductId7": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId7'),'-', variables('workbookVersion7'))))]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.2.0",
      "_analyticRulecontentId1": "17c3d3b1-42f1-4bbd-bcbd-6ab7621448c9",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '17c3d3b1-42f1-4bbd-bcbd-6ab7621448c9')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('17c3d3b1-42f1-4bbd-bcbd-6ab7621448c9')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','17c3d3b1-42f1-4bbd-bcbd-6ab7621448c9','-', '1.2.0')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.2.0",
      "_analyticRulecontentId2": "357d3dee-3b61-4de9-9084-fb245ba23d81",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '357d3dee-3b61-4de9-9084-fb245ba23d81')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('357d3dee-3b61-4de9-9084-fb245ba23d81')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','357d3dee-3b61-4de9-9084-fb245ba23d81','-', '1.2.0')))]"
    },
    "analyticRuleObject3": {
      "analyticRuleVersion3": "1.2.0",
      "_analyticRulecontentId3": "3d6fa984-a989-4742-bcc2-099d2a995ef7",
      "analyticRuleId3": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '3d6fa984-a989-4742-bcc2-099d2a995ef7')]",
      "analyticRuleTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('3d6fa984-a989-4742-bcc2-099d2a995ef7')))]",
      "_analyticRulecontentProductId3": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','3d6fa984-a989-4742-bcc2-099d2a995ef7','-', '1.2.0')))]"
    },
    "analyticRuleObject4": {
      "analyticRuleVersion4": "1.2.0",
      "_analyticRulecontentId4": "58c70f97-543b-4116-8624-12ee7ad8a13d",
      "analyticRuleId4": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '58c70f97-543b-4116-8624-12ee7ad8a13d')]",
      "analyticRuleTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('58c70f97-543b-4116-8624-12ee7ad8a13d')))]",
      "_analyticRulecontentProductId4": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','58c70f97-543b-4116-8624-12ee7ad8a13d','-', '1.2.0')))]"
    },
    "analyticRuleObject5": {
      "analyticRuleVersion5": "1.2.0",
      "_analyticRulecontentId5": "01ee9ec6-ca69-478d-8830-8fa598ae73d9",
      "analyticRuleId5": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '01ee9ec6-ca69-478d-8830-8fa598ae73d9')]",
      "analyticRuleTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('01ee9ec6-ca69-478d-8830-8fa598ae73d9')))]",
      "_analyticRulecontentProductId5": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','01ee9ec6-ca69-478d-8830-8fa598ae73d9','-', '1.2.0')))]"
    },
    "analyticRuleObject6": {
      "analyticRuleVersion6": "1.2.0",
      "_analyticRulecontentId6": "f2e24dac-37a2-493d-a8d7-5b7f6bea438c",
      "analyticRuleId6": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'f2e24dac-37a2-493d-a8d7-5b7f6bea438c')]",
      "analyticRuleTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('f2e24dac-37a2-493d-a8d7-5b7f6bea438c')))]",
      "_analyticRulecontentProductId6": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','f2e24dac-37a2-493d-a8d7-5b7f6bea438c','-', '1.2.0')))]"
    },
    "analyticRuleObject7": {
      "analyticRuleVersion7": "1.2.0",
      "_analyticRulecontentId7": "b0b747f2-938a-4f13-b7d1-9def60a719bd",
      "analyticRuleId7": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'b0b747f2-938a-4f13-b7d1-9def60a719bd')]",
      "analyticRuleTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('b0b747f2-938a-4f13-b7d1-9def60a719bd')))]",
      "_analyticRulecontentProductId7": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','b0b747f2-938a-4f13-b7d1-9def60a719bd','-', '1.2.0')))]"
    },
    "analyticRuleObject8": {
      "analyticRuleVersion8": "1.2.0",
      "_analyticRulecontentId8": "77d9d959-e899-4a43-a376-d2e4059ca8f4",
      "analyticRuleId8": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '77d9d959-e899-4a43-a376-d2e4059ca8f4')]",
      "analyticRuleTemplateSpecName8": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('77d9d959-e899-4a43-a376-d2e4059ca8f4')))]",
      "_analyticRulecontentProductId8": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','77d9d959-e899-4a43-a376-d2e4059ca8f4','-', '1.2.0')))]"
    },
    "analyticRuleObject9": {
      "analyticRuleVersion9": "1.2.0",
      "_analyticRulecontentId9": "234ba956-2361-4db2-a9d4-c4c89fb2ed55",
      "analyticRuleId9": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '234ba956-2361-4db2-a9d4-c4c89fb2ed55')]",
      "analyticRuleTemplateSpecName9": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('234ba956-2361-4db2-a9d4-c4c89fb2ed55')))]",
      "_analyticRulecontentProductId9": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','234ba956-2361-4db2-a9d4-c4c89fb2ed55','-', '1.2.0')))]"
    },
    "analyticRuleObject10": {
      "analyticRuleVersion10": "1.2.0",
      "_analyticRulecontentId10": "ba785c29-37f7-469b-b437-495bfdf136eb",
      "analyticRuleId10": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'ba785c29-37f7-469b-b437-495bfdf136eb')]",
      "analyticRuleTemplateSpecName10": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('ba785c29-37f7-469b-b437-495bfdf136eb')))]",
      "_analyticRulecontentProductId10": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','ba785c29-37f7-469b-b437-495bfdf136eb','-', '1.2.0')))]"
    },
    "analyticRuleObject11": {
      "analyticRuleVersion11": "1.2.0",
      "_analyticRulecontentId11": "9bd607bf-a64c-4917-913e-e9a33f4ea28e",
      "analyticRuleId11": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '9bd607bf-a64c-4917-913e-e9a33f4ea28e')]",
      "analyticRuleTemplateSpecName11": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('9bd607bf-a64c-4917-913e-e9a33f4ea28e')))]",
      "_analyticRulecontentProductId11": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','9bd607bf-a64c-4917-913e-e9a33f4ea28e','-', '1.2.0')))]"
    },
    "analyticRuleObject12": {
      "analyticRuleVersion12": "1.2.0",
      "_analyticRulecontentId12": "ca509c4b-d30f-4bad-b59c-4d0ddd0fc822",
      "analyticRuleId12": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'ca509c4b-d30f-4bad-b59c-4d0ddd0fc822')]",
      "analyticRuleTemplateSpecName12": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('ca509c4b-d30f-4bad-b59c-4d0ddd0fc822')))]",
      "_analyticRulecontentProductId12": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','ca509c4b-d30f-4bad-b59c-4d0ddd0fc822','-', '1.2.0')))]"
    },
    "analyticRuleObject13": {
      "analyticRuleVersion13": "1.2.0",
      "_analyticRulecontentId13": "e9ef6adb-6fa3-49ff-b105-c4cbd4f37808",
      "analyticRuleId13": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'e9ef6adb-6fa3-49ff-b105-c4cbd4f37808')]",
      "analyticRuleTemplateSpecName13": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('e9ef6adb-6fa3-49ff-b105-c4cbd4f37808')))]",
      "_analyticRulecontentProductId13": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','e9ef6adb-6fa3-49ff-b105-c4cbd4f37808','-', '1.2.0')))]"
    },
    "analyticRuleObject14": {
      "analyticRuleVersion14": "1.2.0",
      "_analyticRulecontentId14": "39984923-f74a-45ea-b321-b1dd45ba04e2",
      "analyticRuleId14": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '39984923-f74a-45ea-b321-b1dd45ba04e2')]",
      "analyticRuleTemplateSpecName14": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('39984923-f74a-45ea-b321-b1dd45ba04e2')))]",
      "_analyticRulecontentProductId14": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','39984923-f74a-45ea-b321-b1dd45ba04e2','-', '1.2.0')))]"
    },
    "analyticRuleObject15": {
      "analyticRuleVersion15": "1.2.0",
      "_analyticRulecontentId15": "bdfa4b55-e385-4035-8af8-ea77df4a81c3",
      "analyticRuleId15": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'bdfa4b55-e385-4035-8af8-ea77df4a81c3')]",
      "analyticRuleTemplateSpecName15": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('bdfa4b55-e385-4035-8af8-ea77df4a81c3')))]",
      "_analyticRulecontentProductId15": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','bdfa4b55-e385-4035-8af8-ea77df4a81c3','-', '1.2.0')))]"
    },
    "analyticRuleObject16": {
      "analyticRuleVersion16": "1.2.0",
      "_analyticRulecontentId16": "7b2cc2d2-052f-4ac9-9be0-fb6f22cbca33",
      "analyticRuleId16": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '7b2cc2d2-052f-4ac9-9be0-fb6f22cbca33')]",
      "analyticRuleTemplateSpecName16": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('7b2cc2d2-052f-4ac9-9be0-fb6f22cbca33')))]",
      "_analyticRulecontentProductId16": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','7b2cc2d2-052f-4ac9-9be0-fb6f22cbca33','-', '1.2.0')))]"
    },
    "analyticRuleObject17": {
      "analyticRuleVersion17": "1.2.0",
      "_analyticRulecontentId17": "04a117f0-ff6e-464b-984d-119e33fb0dd5",
      "analyticRuleId17": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '04a117f0-ff6e-464b-984d-119e33fb0dd5')]",
      "analyticRuleTemplateSpecName17": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('04a117f0-ff6e-464b-984d-119e33fb0dd5')))]",
      "_analyticRulecontentProductId17": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','04a117f0-ff6e-464b-984d-119e33fb0dd5','-', '1.2.0')))]"
    },
    "analyticRuleObject18": {
      "analyticRuleVersion18": "1.2.0",
      "_analyticRulecontentId18": "36191460-f26a-4c4e-8492-71e6049e6bbb",
      "analyticRuleId18": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '36191460-f26a-4c4e-8492-71e6049e6bbb')]",
      "analyticRuleTemplateSpecName18": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('36191460-f26a-4c4e-8492-71e6049e6bbb')))]",
      "_analyticRulecontentProductId18": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','36191460-f26a-4c4e-8492-71e6049e6bbb','-', '1.2.0')))]"
    },
    "analyticRuleObject19": {
      "analyticRuleVersion19": "1.2.0",
      "_analyticRulecontentId19": "c322a41b-c759-4aca-ac9a-25b00791c397",
      "analyticRuleId19": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c322a41b-c759-4aca-ac9a-25b00791c397')]",
      "analyticRuleTemplateSpecName19": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c322a41b-c759-4aca-ac9a-25b00791c397')))]",
      "_analyticRulecontentProductId19": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c322a41b-c759-4aca-ac9a-25b00791c397','-', '1.2.0')))]"
    },
    "analyticRuleObject20": {
      "analyticRuleVersion20": "1.2.0",
      "_analyticRulecontentId20": "e426256f-eb14-4b05-9aad-f630944e7012",
      "analyticRuleId20": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'e426256f-eb14-4b05-9aad-f630944e7012')]",
      "analyticRuleTemplateSpecName20": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('e426256f-eb14-4b05-9aad-f630944e7012')))]",
      "_analyticRulecontentProductId20": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','e426256f-eb14-4b05-9aad-f630944e7012','-', '1.2.0')))]"
    },
    "analyticRuleObject21": {
      "analyticRuleVersion21": "1.2.0",
      "_analyticRulecontentId21": "5ae4f7e1-b14c-45fe-8d38-f409e148c1da",
      "analyticRuleId21": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '5ae4f7e1-b14c-45fe-8d38-f409e148c1da')]",
      "analyticRuleTemplateSpecName21": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('5ae4f7e1-b14c-45fe-8d38-f409e148c1da')))]",
      "_analyticRulecontentProductId21": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','5ae4f7e1-b14c-45fe-8d38-f409e148c1da','-', '1.2.0')))]"
    },
    "analyticRuleObject22": {
      "analyticRuleVersion22": "1.2.0",
      "_analyticRulecontentId22": "20d7a85c-6af9-4471-a403-961445c0e49e",
      "analyticRuleId22": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '20d7a85c-6af9-4471-a403-961445c0e49e')]",
      "analyticRuleTemplateSpecName22": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('20d7a85c-6af9-4471-a403-961445c0e49e')))]",
      "_analyticRulecontentProductId22": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','20d7a85c-6af9-4471-a403-961445c0e49e','-', '1.2.0')))]"
    },
    "analyticRuleObject23": {
      "analyticRuleVersion23": "1.2.0",
      "_analyticRulecontentId23": "21d458a0-b0d5-47bb-9fd1-fdda31f3b7f1",
      "analyticRuleId23": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '21d458a0-b0d5-47bb-9fd1-fdda31f3b7f1')]",
      "analyticRuleTemplateSpecName23": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('21d458a0-b0d5-47bb-9fd1-fdda31f3b7f1')))]",
      "_analyticRulecontentProductId23": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','21d458a0-b0d5-47bb-9fd1-fdda31f3b7f1','-', '1.2.0')))]"
    },
    "analyticRuleObject24": {
      "analyticRuleVersion24": "1.2.0",
      "_analyticRulecontentId24": "fbeabff4-fad7-4458-8098-c6426388cf3d",
      "analyticRuleId24": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'fbeabff4-fad7-4458-8098-c6426388cf3d')]",
      "analyticRuleTemplateSpecName24": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('fbeabff4-fad7-4458-8098-c6426388cf3d')))]",
      "_analyticRulecontentProductId24": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','fbeabff4-fad7-4458-8098-c6426388cf3d','-', '1.2.0')))]"
    },
    "analyticRuleObject25": {
      "analyticRuleVersion25": "1.2.0",
      "_analyticRulecontentId25": "cd3e607c-8ab4-4799-a27e-7ff63ae401af",
      "analyticRuleId25": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'cd3e607c-8ab4-4799-a27e-7ff63ae401af')]",
      "analyticRuleTemplateSpecName25": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('cd3e607c-8ab4-4799-a27e-7ff63ae401af')))]",
      "_analyticRulecontentProductId25": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','cd3e607c-8ab4-4799-a27e-7ff63ae401af','-', '1.2.0')))]"
    },
    "analyticRuleObject26": {
      "analyticRuleVersion26": "1.2.0",
      "_analyticRulecontentId26": "008a74e7-ad90-4855-87e6-6bdb86eed127",
      "analyticRuleId26": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '008a74e7-ad90-4855-87e6-6bdb86eed127')]",
      "analyticRuleTemplateSpecName26": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('008a74e7-ad90-4855-87e6-6bdb86eed127')))]",
      "_analyticRulecontentProductId26": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','008a74e7-ad90-4855-87e6-6bdb86eed127','-', '1.2.0')))]"
    },
    "analyticRuleObject27": {
      "analyticRuleVersion27": "1.2.0",
      "_analyticRulecontentId27": "2f770ce2-97cb-4afc-8dce-28114c3ad66e",
      "analyticRuleId27": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '2f770ce2-97cb-4afc-8dce-28114c3ad66e')]",
      "analyticRuleTemplateSpecName27": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('2f770ce2-97cb-4afc-8dce-28114c3ad66e')))]",
      "_analyticRulecontentProductId27": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','2f770ce2-97cb-4afc-8dce-28114c3ad66e','-', '1.2.0')))]"
    },
    "analyticRuleObject28": {
      "analyticRuleVersion28": "1.2.0",
      "_analyticRulecontentId28": "7b7347d2-3efb-47d9-a329-5b7ae4357d70",
      "analyticRuleId28": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '7b7347d2-3efb-47d9-a329-5b7ae4357d70')]",
      "analyticRuleTemplateSpecName28": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('7b7347d2-3efb-47d9-a329-5b7ae4357d70')))]",
      "_analyticRulecontentProductId28": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','7b7347d2-3efb-47d9-a329-5b7ae4357d70','-', '1.2.0')))]"
    },
    "analyticRuleObject29": {
      "analyticRuleVersion29": "1.2.0",
      "_analyticRulecontentId29": "141b9381-50fe-4beb-a91a-799da4f466fc",
      "analyticRuleId29": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '141b9381-50fe-4beb-a91a-799da4f466fc')]",
      "analyticRuleTemplateSpecName29": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('141b9381-50fe-4beb-a91a-799da4f466fc')))]",
      "_analyticRulecontentProductId29": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','141b9381-50fe-4beb-a91a-799da4f466fc','-', '1.2.0')))]"
    },
    "analyticRuleObject30": {
      "analyticRuleVersion30": "1.2.0",
      "_analyticRulecontentId30": "25ffa891-4832-485d-9461-f8c90df1d3ff",
      "analyticRuleId30": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '25ffa891-4832-485d-9461-f8c90df1d3ff')]",
      "analyticRuleTemplateSpecName30": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('25ffa891-4832-485d-9461-f8c90df1d3ff')))]",
      "_analyticRulecontentProductId30": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','25ffa891-4832-485d-9461-f8c90df1d3ff','-', '1.2.0')))]"
    },
    "analyticRuleObject31": {
      "analyticRuleVersion31": "1.2.0",
      "_analyticRulecontentId31": "cf22c2f4-fdc6-465f-8d71-561af44bd475",
      "analyticRuleId31": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'cf22c2f4-fdc6-465f-8d71-561af44bd475')]",
      "analyticRuleTemplateSpecName31": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('cf22c2f4-fdc6-465f-8d71-561af44bd475')))]",
      "_analyticRulecontentProductId31": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','cf22c2f4-fdc6-465f-8d71-561af44bd475','-', '1.2.0')))]"
    },
    "analyticRuleObject32": {
      "analyticRuleVersion32": "1.2.0",
      "_analyticRulecontentId32": "1eb72567-2785-44d0-81dd-6a2b08803cdf",
      "analyticRuleId32": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '1eb72567-2785-44d0-81dd-6a2b08803cdf')]",
      "analyticRuleTemplateSpecName32": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('1eb72567-2785-44d0-81dd-6a2b08803cdf')))]",
      "_analyticRulecontentProductId32": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','1eb72567-2785-44d0-81dd-6a2b08803cdf','-', '1.2.0')))]"
    },
    "analyticRuleObject33": {
      "analyticRuleVersion33": "1.2.0",
      "_analyticRulecontentId33": "9fe3e89b-fd57-4df1-a6e7-8a875966dada",
      "analyticRuleId33": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '9fe3e89b-fd57-4df1-a6e7-8a875966dada')]",
      "analyticRuleTemplateSpecName33": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('9fe3e89b-fd57-4df1-a6e7-8a875966dada')))]",
      "_analyticRulecontentProductId33": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','9fe3e89b-fd57-4df1-a6e7-8a875966dada','-', '1.2.0')))]"
    },
    "analyticRuleObject34": {
      "analyticRuleVersion34": "1.2.0",
      "_analyticRulecontentId34": "cc168d7f-59d1-4472-be98-854869e62907",
      "analyticRuleId34": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'cc168d7f-59d1-4472-be98-854869e62907')]",
      "analyticRuleTemplateSpecName34": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('cc168d7f-59d1-4472-be98-854869e62907')))]",
      "_analyticRulecontentProductId34": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','cc168d7f-59d1-4472-be98-854869e62907','-', '1.2.0')))]"
    },
    "analyticRuleObject35": {
      "analyticRuleVersion35": "1.2.0",
      "_analyticRulecontentId35": "d902d7c1-8a9c-469a-9899-7222214a0663",
      "analyticRuleId35": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd902d7c1-8a9c-469a-9899-7222214a0663')]",
      "analyticRuleTemplateSpecName35": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d902d7c1-8a9c-469a-9899-7222214a0663')))]",
      "_analyticRulecontentProductId35": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d902d7c1-8a9c-469a-9899-7222214a0663','-', '1.2.0')))]"
    },
    "analyticRuleObject36": {
      "analyticRuleVersion36": "1.2.0",
      "_analyticRulecontentId36": "4dcc4d52-947b-4680-89be-b08a71def3d4",
      "analyticRuleId36": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '4dcc4d52-947b-4680-89be-b08a71def3d4')]",
      "analyticRuleTemplateSpecName36": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('4dcc4d52-947b-4680-89be-b08a71def3d4')))]",
      "_analyticRulecontentProductId36": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','4dcc4d52-947b-4680-89be-b08a71def3d4','-', '1.2.0')))]"
    },
    "analyticRuleObject37": {
      "analyticRuleVersion37": "1.2.0",
      "_analyticRulecontentId37": "0eefbca4-0dde-4e72-afaa-dbacc131d07a",
      "analyticRuleId37": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '0eefbca4-0dde-4e72-afaa-dbacc131d07a')]",
      "analyticRuleTemplateSpecName37": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('0eefbca4-0dde-4e72-afaa-dbacc131d07a')))]",
      "_analyticRulecontentProductId37": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','0eefbca4-0dde-4e72-afaa-dbacc131d07a','-', '1.2.0')))]"
    },
    "analyticRuleObject38": {
      "analyticRuleVersion38": "1.2.0",
      "_analyticRulecontentId38": "d738e45b-472b-4d6b-a1a0-258c4fe9eb26",
      "analyticRuleId38": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd738e45b-472b-4d6b-a1a0-258c4fe9eb26')]",
      "analyticRuleTemplateSpecName38": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d738e45b-472b-4d6b-a1a0-258c4fe9eb26')))]",
      "_analyticRulecontentProductId38": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d738e45b-472b-4d6b-a1a0-258c4fe9eb26','-', '1.2.0')))]"
    },
    "analyticRuleObject39": {
      "analyticRuleVersion39": "1.2.0",
      "_analyticRulecontentId39": "7874ea85-ec86-4519-9aa6-7b7d8c8c4a21",
      "analyticRuleId39": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '7874ea85-ec86-4519-9aa6-7b7d8c8c4a21')]",
      "analyticRuleTemplateSpecName39": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('7874ea85-ec86-4519-9aa6-7b7d8c8c4a21')))]",
      "_analyticRulecontentProductId39": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','7874ea85-ec86-4519-9aa6-7b7d8c8c4a21','-', '1.2.0')))]"
    },
    "analyticRuleObject40": {
      "analyticRuleVersion40": "1.2.0",
      "_analyticRulecontentId40": "8844495b-1d05-4080-9fc2-28621f744a4b",
      "analyticRuleId40": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '8844495b-1d05-4080-9fc2-28621f744a4b')]",
      "analyticRuleTemplateSpecName40": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('8844495b-1d05-4080-9fc2-28621f744a4b')))]",
      "_analyticRulecontentProductId40": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','8844495b-1d05-4080-9fc2-28621f744a4b','-', '1.2.0')))]"
    },
    "analyticRuleObject41": {
      "analyticRuleVersion41": "1.2.0",
      "_analyticRulecontentId41": "64ba60b8-67d4-4356-8b88-0dfbf98e454a",
      "analyticRuleId41": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '64ba60b8-67d4-4356-8b88-0dfbf98e454a')]",
      "analyticRuleTemplateSpecName41": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('64ba60b8-67d4-4356-8b88-0dfbf98e454a')))]",
      "_analyticRulecontentProductId41": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','64ba60b8-67d4-4356-8b88-0dfbf98e454a','-', '1.2.0')))]"
    },
    "analyticRuleObject42": {
      "analyticRuleVersion42": "1.2.0",
      "_analyticRulecontentId42": "94e4114f-acd5-48d9-8b5e-07d08b809541",
      "analyticRuleId42": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '94e4114f-acd5-48d9-8b5e-07d08b809541')]",
      "analyticRuleTemplateSpecName42": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('94e4114f-acd5-48d9-8b5e-07d08b809541')))]",
      "_analyticRulecontentProductId42": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','94e4114f-acd5-48d9-8b5e-07d08b809541','-', '1.2.0')))]"
    },
    "analyticRuleObject43": {
      "analyticRuleVersion43": "1.2.0",
      "_analyticRulecontentId43": "70e09635-9787-41af-9973-87d22ca15292",
      "analyticRuleId43": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '70e09635-9787-41af-9973-87d22ca15292')]",
      "analyticRuleTemplateSpecName43": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('70e09635-9787-41af-9973-87d22ca15292')))]",
      "_analyticRulecontentProductId43": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','70e09635-9787-41af-9973-87d22ca15292','-', '1.2.0')))]"
    },
    "analyticRuleObject44": {
      "analyticRuleVersion44": "1.2.0",
      "_analyticRulecontentId44": "8e1df707-a242-42ba-a0aa-68b61f1e620d",
      "analyticRuleId44": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '8e1df707-a242-42ba-a0aa-68b61f1e620d')]",
      "analyticRuleTemplateSpecName44": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('8e1df707-a242-42ba-a0aa-68b61f1e620d')))]",
      "_analyticRulecontentProductId44": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','8e1df707-a242-42ba-a0aa-68b61f1e620d','-', '1.2.0')))]"
    },
    "analyticRuleObject45": {
      "analyticRuleVersion45": "1.2.0",
      "_analyticRulecontentId45": "146f6a92-d11a-4728-b66d-6d4dc359ff59",
      "analyticRuleId45": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '146f6a92-d11a-4728-b66d-6d4dc359ff59')]",
      "analyticRuleTemplateSpecName45": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('146f6a92-d11a-4728-b66d-6d4dc359ff59')))]",
      "_analyticRulecontentProductId45": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','146f6a92-d11a-4728-b66d-6d4dc359ff59','-', '1.2.0')))]"
    },
    "analyticRuleObject46": {
      "analyticRuleVersion46": "1.2.0",
      "_analyticRulecontentId46": "4f431f88-ada9-4a20-bbe5-fddc7add942e",
      "analyticRuleId46": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '4f431f88-ada9-4a20-bbe5-fddc7add942e')]",
      "analyticRuleTemplateSpecName46": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('4f431f88-ada9-4a20-bbe5-fddc7add942e')))]",
      "_analyticRulecontentProductId46": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','4f431f88-ada9-4a20-bbe5-fddc7add942e','-', '1.2.0')))]"
    },
    "analyticRuleObject47": {
      "analyticRuleVersion47": "1.2.0",
      "_analyticRulecontentId47": "93a17e41-1504-4ef3-8a1e-7ad15a32ce98",
      "analyticRuleId47": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '93a17e41-1504-4ef3-8a1e-7ad15a32ce98')]",
      "analyticRuleTemplateSpecName47": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('93a17e41-1504-4ef3-8a1e-7ad15a32ce98')))]",
      "_analyticRulecontentProductId47": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','93a17e41-1504-4ef3-8a1e-7ad15a32ce98','-', '1.2.0')))]"
    },
    "analyticRuleObject48": {
      "analyticRuleVersion48": "1.2.0",
      "_analyticRulecontentId48": "d6bf4db8-f2f3-4738-9051-bb892b268da3",
      "analyticRuleId48": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd6bf4db8-f2f3-4738-9051-bb892b268da3')]",
      "analyticRuleTemplateSpecName48": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d6bf4db8-f2f3-4738-9051-bb892b268da3')))]",
      "_analyticRulecontentProductId48": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d6bf4db8-f2f3-4738-9051-bb892b268da3','-', '1.2.0')))]"
    },
    "analyticRuleObject49": {
      "analyticRuleVersion49": "1.2.0",
      "_analyticRulecontentId49": "bc26d218-89a4-40ba-88b6-76e5141b5731",
      "analyticRuleId49": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'bc26d218-89a4-40ba-88b6-76e5141b5731')]",
      "analyticRuleTemplateSpecName49": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('bc26d218-89a4-40ba-88b6-76e5141b5731')))]",
      "_analyticRulecontentProductId49": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','bc26d218-89a4-40ba-88b6-76e5141b5731','-', '1.2.0')))]"
    },
    "analyticRuleObject50": {
      "analyticRuleVersion50": "1.2.0",
      "_analyticRulecontentId50": "d817dc53-1787-4b02-b8cf-d6254eec5ddb",
      "analyticRuleId50": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd817dc53-1787-4b02-b8cf-d6254eec5ddb')]",
      "analyticRuleTemplateSpecName50": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d817dc53-1787-4b02-b8cf-d6254eec5ddb')))]",
      "_analyticRulecontentProductId50": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d817dc53-1787-4b02-b8cf-d6254eec5ddb','-', '1.2.0')))]"
    },
    "analyticRuleObject51": {
      "analyticRuleVersion51": "1.2.0",
      "_analyticRulecontentId51": "ccd94d43-3d74-4928-93bf-eb9bfe7924ca",
      "analyticRuleId51": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'ccd94d43-3d74-4928-93bf-eb9bfe7924ca')]",
      "analyticRuleTemplateSpecName51": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('ccd94d43-3d74-4928-93bf-eb9bfe7924ca')))]",
      "_analyticRulecontentProductId51": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','ccd94d43-3d74-4928-93bf-eb9bfe7924ca','-', '1.2.0')))]"
    },
    "analyticRuleObject52": {
      "analyticRuleVersion52": "1.2.0",
      "_analyticRulecontentId52": "f1334bfc-7cdd-4655-b8de-e1398158f4b5",
      "analyticRuleId52": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'f1334bfc-7cdd-4655-b8de-e1398158f4b5')]",
      "analyticRuleTemplateSpecName52": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('f1334bfc-7cdd-4655-b8de-e1398158f4b5')))]",
      "_analyticRulecontentProductId52": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','f1334bfc-7cdd-4655-b8de-e1398158f4b5','-', '1.2.0')))]"
    },
    "analyticRuleObject53": {
      "analyticRuleVersion53": "1.2.0",
      "_analyticRulecontentId53": "6356d718-5a61-4f74-b8a4-f93b0b721e9a",
      "analyticRuleId53": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '6356d718-5a61-4f74-b8a4-f93b0b721e9a')]",
      "analyticRuleTemplateSpecName53": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('6356d718-5a61-4f74-b8a4-f93b0b721e9a')))]",
      "_analyticRulecontentProductId53": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','6356d718-5a61-4f74-b8a4-f93b0b721e9a','-', '1.2.0')))]"
    },
    "analyticRuleObject54": {
      "analyticRuleVersion54": "1.2.0",
      "_analyticRulecontentId54": "a1052a3e-d955-4a0b-9f96-179393e7741a",
      "analyticRuleId54": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'a1052a3e-d955-4a0b-9f96-179393e7741a')]",
      "analyticRuleTemplateSpecName54": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('a1052a3e-d955-4a0b-9f96-179393e7741a')))]",
      "_analyticRulecontentProductId54": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','a1052a3e-d955-4a0b-9f96-179393e7741a','-', '1.2.0')))]"
    },
    "analyticRuleObject55": {
      "analyticRuleVersion55": "1.2.0",
      "_analyticRulecontentId55": "f1a667b2-91a8-4a9b-8d31-9a54bb5f0cd5",
      "analyticRuleId55": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'f1a667b2-91a8-4a9b-8d31-9a54bb5f0cd5')]",
      "analyticRuleTemplateSpecName55": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('f1a667b2-91a8-4a9b-8d31-9a54bb5f0cd5')))]",
      "_analyticRulecontentProductId55": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','f1a667b2-91a8-4a9b-8d31-9a54bb5f0cd5','-', '1.2.0')))]"
    },
    "analyticRuleObject56": {
      "analyticRuleVersion56": "1.2.0",
      "_analyticRulecontentId56": "c09d3a9d-47da-4bd8-a14d-ea51b447d75d",
      "analyticRuleId56": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c09d3a9d-47da-4bd8-a14d-ea51b447d75d')]",
      "analyticRuleTemplateSpecName56": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c09d3a9d-47da-4bd8-a14d-ea51b447d75d')))]",
      "_analyticRulecontentProductId56": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c09d3a9d-47da-4bd8-a14d-ea51b447d75d','-', '1.2.0')))]"
    },
    "analyticRuleObject57": {
      "analyticRuleVersion57": "1.2.0",
      "_analyticRulecontentId57": "b64ee057-94a4-42a5-a769-430a2943f764",
      "analyticRuleId57": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'b64ee057-94a4-42a5-a769-430a2943f764')]",
      "analyticRuleTemplateSpecName57": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('b64ee057-94a4-42a5-a769-430a2943f764')))]",
      "_analyticRulecontentProductId57": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','b64ee057-94a4-42a5-a769-430a2943f764','-', '1.2.0')))]"
    },
    "uiConfigId1": "bloodhound",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "bloodhound",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))))]",
    "dataConnectorVersion1": "1.0.0",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundEnterpriseAttackPathDetails Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Gain insights into BloodHound Enterprise attack path details."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f0dfd85a-6c9c-4dab-91d7-d67cb23b1fb2\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAttackPathsData_CL\\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"390213b5-e0d3-476c-99ca-89c76f417e7a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"domain_name\",\"label\":\"Domain\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAttackPathsData_CL\\n| where isnotempty(domain_name)\\n| where tenant_url in~ ({bhe_tenant})\\n| distinct domain_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},{\"id\":\"3d301840-15be-455d-bb48-d2ca8e3d4c2f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"finding_type\",\"label\":\"Attack Path Types\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAttackPathsData_CL \\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| extend CleanPathTitle = trim(\\\" \\\", replace_string(replace_string(PathTitle, \\\"\\\\n\\\", \\\"\\\"), \\\"\\\\'\\\", \\\"\\\"))\\n| distinct CleanPathTitle\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"7e02e873-7550-447e-88aa-fc99dc923c14\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsData_CL\\n| summarize arg_max(TimeGenerated, *) by id, domain_name\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| extend CleanPathTitle = trim(\\\" \\\", replace_string(PathTitle, \\\"\\\\n\\\", \\\"\\\"))\\n| where CleanPathTitle in~ ({finding_type})\\n| extend \\n    NonTierZeroPrincipalDistinguishedName = tostring(parse_json(NonTierZeroPrincipalProps).distinguishedname),\\n    NonTierZeroPrincipalSAMAccountName = tostring(parse_json(NonTierZeroPrincipalProps).samaccountname),\\n    NonTierZeroPrincipalLastLogon = todatetime(unixtime_seconds_todatetime(tolong(parse_json(NonTierZeroPrincipalProps).lastlogon))),\\n    NonTierZeroPrincipalLastLogonTimestamp = todatetime(unixtime_seconds_todatetime(tolong(parse_json(NonTierZeroPrincipalProps).lastlogontimestamp))),\\n    NonTierZeroPrincipalCreated = todatetime(unixtime_seconds_todatetime(tolong(parse_json(NonTierZeroPrincipalProps).whencreated))),\\n    IsTierZero = case(\\n        tostring(parse_json(ImpactedPrincipalProps).system_tags) contains \\\"admin_tier_0\\\", true,\\n        false\\n    )\\n| project \\n    [\\\"Non Tier Zero Principal\\\"] = NonTierZeroPrincipalName,\\n    [\\\"Impacted Principal\\\"] = ImpactedPrincipalName,\\n    [\\\"Path Title\\\"] = PathTitle,\\n    [\\\"Distinguished Name\\\"] = NonTierZeroPrincipalDistinguishedName,\\n    [\\\"Severity Level\\\"] = Severity,\\n    [\\\"Impact %\\\"] = todouble(ImpactPercentage),\\n    [\\\"Impact Count\\\"] = toint(ImpactCount),\\n    [\\\"Exposure %\\\"] = todouble(ExposurePercentage),\\n    [\\\"Exposure Count\\\"] = toint(ExposureCount),\\n    [\\\"SAM Account Name\\\"] = NonTierZeroPrincipalSAMAccountName,\\n    [\\\"Sensitive\\\"] = IsTierZero,\\n    [\\\"Last Logon\\\"] = NonTierZeroPrincipalLastLogon,\\n    [\\\"Last Logon Timestamp\\\"] = NonTierZeroPrincipalLastLogonTimestamp,\\n    [\\\"Created Timestamp\\\"] = NonTierZeroPrincipalCreated,\\n    [\\\"First Seen\\\"] = todatetime(created_at),\\n    [\\\"Last Updated\\\"] = todatetime(updated_at),\\n    Finding = Finding,\\n    DomainName = domain_name,\\n    Environment = Environment\\n| order by [\\\"Last Updated\\\"] desc\\n\\n\\n\\n\\n\\n\",\"size\":1,\"title\":\"Principals\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsTimelineData_CL\\n| where isnotempty(domain_name)\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| extend CleanPathTitle = trim(\\\" \\\", replace_string(path_title, \\\"\\\\n\\\", \\\"\\\"))\\n| where CleanPathTitle in~ ({finding_type})\\n| summarize arg_max(TimeGenerated, *) by id, domain_name, tenant_url\\n| extend event_day = format_datetime(todatetime(updated_at), 'yyyy-MM-dd')\\n| summarize arg_max(updated_at, *) by event_day, domain_name\\n| extend _time = todatetime(event_day)\\n| extend ExposureCount = round(todouble(ExposureCount), 4)\\n| summarize LatestCompositeRisk = max(ExposureCount) by bin(_time, 2d)\\n| order by _time asc\",\"size\":0,\"aggregation\":2,\"title\":\"Maximum Exposure Percentage\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"areachart\",\"tileSettings\":{\"showBorder\":false}},\"name\":\"query - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsTimelineData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| extend CleanPathTitle = trim(\\\" \\\", replace_string(path_title, \\\"\\\\n\\\", \\\"\\\"))\\n| where CleanPathTitle in~ ({finding_type})\\n| extend _time = todatetime(updated_at)\\n| where isnotnull(_time)\\n| summarize arg_max(TimeGenerated,*) by id, domain_name, tenant_url\\n| summarize SumFindingCount = sum(toint(FindingCount)) by bin(_time, 1d)\\n| order by _time asc\",\"size\":0,\"title\":\"Total Number of Findings\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"areachart\"},\"name\":\"query - 6\"}],\"fallbackResourceIds\":[\"/subscriptions/8487150a-2b54-4945-9a15-7aae2d005a3d/resourcegroups/specterops/providers/microsoft.operationalinsights/workspaces/specterops-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundEnterpriseAttackPathDetails; logoFileName=BHE_Logo.svg; description=Gain insights into BloodHound Enterprise attack path details.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=2.0; title=BloodHound Enterprise Attack Path Details; templateRelativePath=BloodHoundEnterpriseAttackPathDetails.json; subtitle=Detailed View; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundLogs_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundEnterprise",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundEnterpriseAttackPathOverview Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion2')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId2')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Gain insights into BloodHound Enterprise attack path."
              },
              "properties": {
                "displayName": "[parameters('workbook2-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"6de26de7-0eec-4312-b568-9fbbaf5c7f71\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAttackPathsData_CL \\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":172800000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"https://maplesyrup.bloodhoundenterprise.io/\"]},{\"id\":\"cb118fcd-4473-4470-ac89-28c6ea644d5d\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"domain_name\",\"label\":\"Domain\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAttackPathsData_CL \\n| where isnotempty(domain_name)\\n| where tenant_url in~ ({bhe_tenant})\\n| distinct domain_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},{\"id\":\"dafad90f-2d00-41cd-9463-efbe87d3888f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":259200000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize arg_max(TimeGenerated, *) by id, domain_name, tenant_url\\n| summarize TotalAttackPathsFindings = dcount(id) by DomainName = domain_name\\n| sort by TotalAttackPathsFindings desc\",\"size\":1,\"title\":\"Total Attack Paths Findings per Domain\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"DomainName\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"TotalAttackPathsFindings\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"showLegend\":true}},\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize arg_max(TimeGenerated, *) by id, domain_name, tenant_url\\n| summarize Count = dcount(id) by Severity\\n| sort by Count desc\\n\",\"size\":0,\"title\":\"Severity Breakdown\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"query - 5\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize arg_max(TimeGenerated, *) by id\\n| where isnotempty(NonTierZeroPrincipalName)\\n| summarize FindingsCount = count() by NonTierZeroPrincipalName, domain_name\\n| sort by FindingsCount desc\\n| take 5\\n\",\"size\":1,\"aggregation\":2,\"title\":\"Top 5 Non-Tier Zero Principals Involved in Findings\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"chartSettings\":{\"xAxis\":\"FindingsCount\",\"yAxis\":[\"FindingsCount\"],\"showLegend\":true}},\"name\":\"query - 7\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize arg_max(TimeGenerated, *) by id, domain_name, tenant_url\\n| summarize Occurrence = dcount(id) by Finding\\n| sort by Occurrence desc\\n| take 5\\n\",\"size\":0,\"title\":\"Top 5 Most Common Findings\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"showLegend\":true}},\"name\":\"query - 9\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAttackPathsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize arg_max(TimeGenerated, *) by id, domain_name, tenant_url\\n| extend exposure_val = toreal(ExposurePercentage),\\n         impact_val = toreal(ImpactPercentage)\\n| extend exposure_pct = iif(isnull(exposure_val), round(impact_val, 2), round(exposure_val, 2))\\n| extend impact_pct = round(impact_val, 2)\\n| summarize \\n    ExposurePercent = max(exposure_pct),\\n    ImpactPercent = max(impact_pct),\\n    Remediation = any(Remediation),  \\n    Count = count()\\n    by Domain = domain_name, AttackPath = PathTitle, Severity\\n| project Domain, AttackPath, Severity, Count, ['Exposure (%)'] = ExposurePercent, ['Impact (%)'] = ImpactPercent, Remediation\\n| sort by ['Exposure (%)'] desc\",\"size\":0,\"title\":\"All Attack Paths List\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":500}},\"name\":\"query - 11\"}],\"fallbackResourceIds\":[\"/subscriptions/9ccf51b3-d707-424d-a466-75b7ea8f9050/resourcegroups/specterops-qa/providers/microsoft.operationalinsights/workspaces/specterops-qa-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId2'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundEnterpriseAttackPathOverview; logoFileName=BHE_Logo.svg; description=Gain insights into BloodHound Enterprise attack path.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=2.0; title=BloodHound Enterprise Attack Path Overview; templateRelativePath=BloodHoundEnterpriseAttackPathOverview.json; subtitle=Overview; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId2')]",
                "contentId": "[variables('_workbookContentId2')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundLogs_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundEnterprise",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId2')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook2-name')]",
        "contentProductId": "[variables('_workbookcontentProductId2')]",
        "id": "[variables('_workbookcontentProductId2')]",
        "version": "[variables('workbookVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundEnterpriseAuditLogs Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion3')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId3')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Gain insights into BloodHound Enterprise audit logs."
              },
              "properties": {
                "displayName": "[parameters('workbook3-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"b8d3205b-b903-4db7-8c7a-f82bacd94242\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAuditLogsData_CL\\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"752a2195-64fc-402e-b80f-c7c4fb9b49bd\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"event_type\",\"label\":\"Event Type\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAuditLogsData_CL\\n| where isnotempty(action)\\n| where tenant_url in~ ({bhe_tenant})\\n| distinct action\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"5de91703-b999-47c1-98e3-648bb4724abf\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"actor_name\",\"label\":\"Actor name\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEAuditLogsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where action in~ ({event_type})\\n| distinct actor_email\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"705413e9-2968-4485-975f-a782991db8df\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEAuditLogsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where action in~ ({event_type})\\n| where actor_email in~ ({actor_name})\",\"size\":1,\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"query - 2\"}],\"fallbackResourceIds\":[\"/subscriptions/8487150a-2b54-4945-9a15-7aae2d005a3d/resourcegroups/specterops/providers/microsoft.operationalinsights/workspaces/specterops-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId3'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundEnterpriseAuditLogs; logoFileName=BHE_Logo.svg; description=Gain insights into BloodHound Enterprise audit logs.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=2.0; title=BloodHound Enterprise Audit Logs; templateRelativePath=BloodHoundEnterpriseAuditLogs.json; subtitle=; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId3')]",
                "contentId": "[variables('_workbookContentId3')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundLogs_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundEnterprise",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId3')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook3-name')]",
        "contentProductId": "[variables('_workbookcontentProductId3')]",
        "id": "[variables('_workbookcontentProductId3')]",
        "version": "[variables('workbookVersion3')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName4')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundEnterprisePosture Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion4')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId4')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Gain insights into BloodHound Enterprise domain posture."
              },
              "properties": {
                "displayName": "[parameters('workbook4-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f589d987-9e0a-4655-a467-94872a600db9\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":3600000}},{\"id\":\"7b2610f8-46b2-4b21-ba57-3988c0b79e46\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEPostureStatsData_CL \\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\\n\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"time\",\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEPostureStatsData_CL \\n| summarize arg_max(TimeGenerated, *) by id\\n| where tenant_url in~ ({bhe_tenant})\\n| where isnotempty(domain_name)\\n| extend domain = domain_name\\n| extend created_at_dt = todatetime(created_at)\\n| extend exposure = round(todouble(exposure_index) * 100, 0)\\n| summarize max_exposure = max(exposure) by created_at_dt, domain\\n| order by created_at_dt asc\\n\\n\",\"size\":0,\"aggregation\":5,\"title\":\"Domain Exposure\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"domain\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"max_exposure\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"domain\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"max_exposure\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"xAxis\":\"created_at_dt\",\"yAxis\":[\"max_exposure\"],\"group\":\"domain\",\"showLegend\":true},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"max_exposure\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"max_exposure\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"max_exposure\",\"heatmapPalette\":\"greenRed\"}}},\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEPostureStatsData_CL \\n| summarize arg_max(TimeGenerated, *) by id\\n| where tenant_url in~ ({bhe_tenant})\\n| where isnotempty(domain_name)\\n| extend domain = domain_name\\n| extend created_at_dt = todatetime(created_at)\\n| summarize max_critical_risk_count = max(tolong(critical_risk_count)) by created_at_dt, domain\\n| order by created_at_dt asc\\n\",\"size\":1,\"aggregation\":5,\"title\":\"Critical Attack Paths\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"domain\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"max_critical_risk_count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"xAxis\":\"created_at_dt\",\"yAxis\":[\"max_critical_risk_count\"],\"group\":\"domain\",\"showLegend\":true}},\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEPostureStatsData_CL \\n| summarize arg_max(TimeGenerated, *) by id\\n| where tenant_url in~ ({bhe_tenant})\\n| where isnotempty(domain_name)\\n| extend domain = domain_name\\n| extend created_at_dt = todatetime(created_at)\\n| summarize max_tier_zero_count = max(tolong(tier_zero_count)) by created_at_dt, domain\\n| order by created_at_dt asc\\n\",\"size\":0,\"aggregation\":5,\"title\":\"Tier Zero count\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"chartSettings\":{\"showLegend\":true}},\"name\":\"query - 4\"}],\"fallbackResourceIds\":[\"/subscriptions/8487150a-2b54-4945-9a15-7aae2d005a3d/resourcegroups/specterops/providers/microsoft.operationalinsights/workspaces/specterops-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId4'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundEnterprisePosture; logoFileName=BHE_Logo.svg; description=Gain insights into BloodHound Enterprise domain posture.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=2.0; title=BloodHound Enterprise Domain Posture; templateRelativePath=BloodHoundEnterprisePosture.json; subtitle=; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId4')]",
                "contentId": "[variables('_workbookContentId4')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion4')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundLogs_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundEnterprise",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId4')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook4-name')]",
        "contentProductId": "[variables('_workbookcontentProductId4')]",
        "id": "[variables('_workbookcontentProductId4')]",
        "version": "[variables('workbookVersion4')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName5')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundEnterpriseTierZeroSearch Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion5')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId5')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Search BloodHound Enterprise Tier Zero data."
              },
              "properties": {
                "displayName": "[parameters('workbook5-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"87db674f-0507-4481-a57b-0bf202e968b2\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHETierZeroAssetsData_CL  \\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"\",\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"a4cadb58-5551-4279-9a60-3b4e46b3ddf9\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"domain_name\",\"label\":\"Domain\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHETierZeroAssetsData_CL  \\n| where isnotempty(domain_name)\\n| where tenant_url in~ ({bhe_tenant})\\n| distinct domain_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"98c37fb8-534d-4661-b8cf-2ce60a74b67a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"kind_type\",\"label\":\"Type\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHETierZeroAssetsData_CL \\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| where isnotempty(kindType)\\n| distinct kindType\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"a690087b-1129-4142-9926-531db2e33204\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHETierZeroAssetsData_CL  \\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| where kindType in~ ({kind_type})\\n| summarize arg_max(TimeGenerated, *) by objectId,owner_objectid\\n| project name, domain_name, kindType, objectId\\n\",\"size\":1,\"title\":\"Search Result Table\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHETierZeroAssetsData_CL \\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| where kindType in~ ({kind_type})\\n| where isnotempty(objectId)        \\n| extend domain_name = toupper(domain_name)\\n| summarize arg_max(TimeGenerated, *) by objectId\\n| summarize Count = count() by kindType, domain_name, tenant_url\\n| project [\\\"kind\\\"] = kindType, domain_name, Count, tenant_url\\n\",\"size\":0,\"title\":\"Chart For Count For Each Type\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"kind\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"kind\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"rightContent\":{\"columnMatch\":\"domain_name\"},\"bottomContent\":{\"columnMatch\":\"tenant_url\"},\"nodeIdField\":\"kind\",\"sourceIdField\":\"domain_name\",\"targetIdField\":\"Count\",\"graphOrientation\":3,\"showOrientationToggles\":false,\"staticNodeSize\":100,\"hivesMargin\":5},\"chartSettings\":{\"xAxis\":\"kind\",\"group\":\"domain_name\",\"showLegend\":true,\"xSettings\":{\"label\":\"Kind Type\"},\"ySettings\":{\"label\":\"Count\"}},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"name\":\"query - 4\"}],\"fallbackResourceIds\":[\"/subscriptions/8487150a-2b54-4945-9a15-7aae2d005a3d/resourcegroups/specterops/providers/microsoft.operationalinsights/workspaces/specterops-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId5'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundEnterpriseTierZeroSearch; logoFileName=BHE_Logo.svg; description=Search BloodHound Enterprise Tier Zero data.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0; title=BloodHound Enterprise Tier Zero Search; templateRelativePath=BloodHoundEnterpriseTierZeroSearch.json; subtitle=; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId5')]",
                "contentId": "[variables('_workbookContentId5')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion5')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundLogs_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundEnterprise",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId5')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook5-name')]",
        "contentProductId": "[variables('_workbookcontentProductId5')]",
        "id": "[variables('_workbookcontentProductId5')]",
        "version": "[variables('workbookVersion5')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName6')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundFindingTrends Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion6')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId6')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Search BloodHound Frinding Trends."
              },
              "properties": {
                "displayName": "[parameters('workbook6-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"b5affbc4-b123-4844-bab6-a352911dcd05\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEFindingTrendsData_CL \\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"511679f9-e193-414d-9d06-c778e0372a69\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"domain_name\",\"label\":\"Domain Name\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEFindingTrendsData_CL\\n| where isnotempty(domain_name)\\n| where tenant_url in~ ({bhe_tenant})\\n| distinct domain_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"15a988b5-5d82-4b23-8231-7bfb434ed02a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEFindingTrendsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize arg_max(TimeGenerated, *) by display_title, domain_name, tenant_url\\n| summarize MaxRisk = max(todouble(composite_risk)) by display_title\\n| order by MaxRisk desc\\n\",\"size\":2,\"title\":\"Max Composite Risk per Display Title\",\"noDataMessageStyle\":2,\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\",\"tileSettings\":{\"showBorder\":false},\"graphSettings\":{\"type\":0},\"chartSettings\":{\"createOtherGroup\":20,\"showLegend\":true},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"TotalImpactCount\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"TotalImpactCount\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"TotalImpactCount\",\"heatmapPalette\":\"greenRed\"}}},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEFindingTrendsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| summarize \\n    TotalImpact = sum(toint(impact_count)), \\n    TotalExposure = sum(toint(exposure_count)), \\n    MaxRisk = max(todouble(composite_risk))\\n    by display_title\",\"size\":0,\"title\":\"Impact vs. Exposure per Finding\",\"noDataMessageStyle\":4,\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"display_title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"TotalImpact\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"display_title\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"TotalImpact\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"TotalImpact\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"TotalImpact\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"TotalImpact\",\"heatmapPalette\":\"greenRed\"}}},\"name\":\"query - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEFindingTrendsData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| extend StartTime = todatetime(start_date), EndTime = todatetime(end_date)\\n| mv-expand TimeBin = range(StartTime, EndTime, 1d)\\n| extend TimeBin = todatetime(TimeBin)\\n| summarize ActiveFindings = count() by TimeBin\\n| order by TimeBin asc\\n\",\"size\":1,\"aggregation\":2,\"title\":\"Active Findings Timeline (per day)\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"areachart\",\"gridSettings\":{\"rowLimit\":10000}},\"name\":\"query - 3\"}],\"fallbackResourceIds\":[\"/subscriptions/8487150a-2b54-4945-9a15-7aae2d005a3d/resourcegroups/specterops/providers/microsoft.operationalinsights/workspaces/specterops-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId6'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundFindingsTrends; logoFileName=BHE_Logo.svg; description=Search BloodHound Frinding Trends.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0; title=BloodHound Finding Trends; templateRelativePath=BloodHoundFindingTrends.json; subtitle=; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId6')]",
                "contentId": "[variables('_workbookContentId6')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion6')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundFindingsTrendsDetails_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundFunction",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId6')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook6-name')]",
        "contentProductId": "[variables('_workbookcontentProductId6')]",
        "id": "[variables('_workbookcontentProductId6')]",
        "version": "[variables('workbookVersion6')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName7')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHoundPostureHistory Workbook with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion7')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId7')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Search BloodHound Posture History."
              },
              "properties": {
                "displayName": "[parameters('workbook7-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"a4422263-5b38-4e1b-96bf-010956675fe7\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"bhe_tenant\",\"label\":\"BHE Tenant\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEPostureHistoryData_CL\\n| where isnotempty(tenant_url)\\n| summarize arg_max(TimeGenerated, *) by tenant_url\\n| extend display_name = replace_string(tenant_url, @\\\"https://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"http://\\\", \\\"\\\")\\n| extend display_name = replace_string(display_name, @\\\"/\\\", \\\"\\\") \\n| project tenant_url, display_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"627c2e6a-326c-479e-a0aa-9a5c0354c719\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"domain_name\",\"label\":\"Domain\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"BHEPostureHistoryData_CL\\n| where isnotempty(domain_name)\\n| where tenant_url in~ ({bhe_tenant})\\n| distinct domain_name\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"]},{\"id\":\"2318e21e-11ac-4959-8c09-8e2f0cce91c7\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time\",\"label\":\"Time Range Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"value\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEPostureHistoryData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| where data_type == \\\"findings\\\"\\n| summarize arg_max(TimeGenerated, *) by domain_name,tenant_url\\n| summarize avg(todouble(value)) by bin(metric_date, 12h), domain_name, tenant_url\\n| order by metric_date asc\",\"size\":1,\"aggregation\":2,\"title\":\"Findings Trend Over Time\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"chartSettings\":{\"showLegend\":true}},\"name\":\"Findings Trend Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEPostureHistoryData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| where data_type == \\\"exposure\\\"\\n| summarize arg_max(TimeGenerated, *) by domain_name,tenant_url\\n| summarize avg(todouble(value)) by bin(metric_date, 12h), domain_name, tenant_url\\n| order by metric_date asc\",\"size\":0,\"title\":\"Exposure Trend Over Time\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"chartSettings\":{\"showLegend\":true}},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BHEPostureHistoryData_CL\\n| where tenant_url in~ ({bhe_tenant})\\n| where domain_name in~ ({domain_name})\\n| where data_type == \\\"assets\\\"\\n| summarize arg_max(TimeGenerated, *) by domain_name,tenant_url\\n| summarize avg(todouble(value)) by bin(metric_date, 12h), domain_name, tenant_url\\n| order by metric_date asc\",\"size\":0,\"aggregation\":2,\"title\":\"Assets Trend Over Time\",\"timeContextFromParameter\":\"time\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"chartSettings\":{\"showLegend\":true}},\"name\":\"query - 4\"}],\"fallbackResourceIds\":[\"/subscriptions/8487150a-2b54-4945-9a15-7aae2d005a3d/resourcegroups/specterops/providers/microsoft.operationalinsights/workspaces/specterops-log-analytics-workspace\"],\"fromTemplateId\":\"sentinel-UserWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId7'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=BloodHoundPostureHistory; logoFileName=BHE_Logo.svg; description=Search BloodHound Posture History.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0; title=BloodHound Posture History; templateRelativePath=BloodHoundPostureHistory.json; subtitle=; provider=SpecterOps}.description",
                "parentId": "[variables('workbookId7')]",
                "contentId": "[variables('_workbookContentId7')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion7')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "BloodHoundPostureHistory_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "BloodHoundFunction",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId7')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook7-name')]",
        "contentProductId": "[variables('_workbookcontentProductId7')]",
        "id": "[variables('_workbookcontentProductId7')]",
        "version": "[variables('workbookVersion7')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AddMemberPrivilegesOnTierZeroSecurityGroups_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Add Member Privileges on Tier Zero Security Groups",
                "displayName": "BloodHound Attack Path Finding - Add Member Privileges on Tier Zero Security Groups",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0AddMember\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Add Member Privileges on Tier Zero Security Groups",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AddMembersToTierZeroGroup_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Add Members to Tier Zero Group",
                "displayName": "BloodHound Attack Path Finding - Add Members to Tier Zero Group",
                "enabled": false,
                "query": "BHEAttackPathsData_CL\n| where Finding == \"AzureT0AddMembers\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Add Members to Tier Zero Group",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject3').analyticRuleTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AddownerRoleOnTierZeroResource_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject3').analyticRuleVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - AddOwner Role on Tier Zero Resource",
                "displayName": "BloodHound Attack Path Finding - AddOwner Role on Tier Zero Resource",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0AddOwner\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject3').analyticRuleId3,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 3",
                "parentId": "[variables('analyticRuleObject3').analyticRuleId3]",
                "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject3').analyticRuleVersion3]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - AddOwner Role on Tier Zero Resource",
        "contentProductId": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "id": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject4').analyticRuleTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AddOwnerToTierZeroObjectViaMsGraphAppRole_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject4').analyticRuleVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Add Owner to Tier Zero Object via MS Graph App Role",
                "displayName": "BloodHound Attack Path Finding - Add Owner to Tier Zero Object via MS Graph App Role",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0MGAddOwner\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject4').analyticRuleId4,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 4",
                "parentId": "[variables('analyticRuleObject4').analyticRuleId4]",
                "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject4').analyticRuleVersion4]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Add Owner to Tier Zero Object via MS Graph App Role",
        "contentProductId": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "id": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject5').analyticRuleTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AddSecretToTierZeroPrincipal_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject5').analyticRuleVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Add Secret to Tier Zero Principal",
                "displayName": "BloodHound Attack Path Finding - Add Secret to Tier Zero Principal",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0AddSecret\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject5').analyticRuleId5,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 5",
                "parentId": "[variables('analyticRuleObject5').analyticRuleId5]",
                "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject5').analyticRuleVersion5]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Add Secret to Tier Zero Principal",
        "contentProductId": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "id": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject6').analyticRuleTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AddselfPrivilegeOnTierZeroSecurityGroups_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject6').analyticRuleVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - AddSelf Privilege on Tier Zero Security Groups",
                "displayName": "BloodHound Attack Path Finding - AddSelf Privilege on Tier Zero Security Groups",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0AddSelf\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject6').analyticRuleId6,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 6",
                "parentId": "[variables('analyticRuleObject6').analyticRuleId6]",
                "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject6').analyticRuleVersion6]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - AddSelf Privilege on Tier Zero Security Groups",
        "contentProductId": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "id": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject7').analyticRuleTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AdminsOnTierZeroComputers_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject7').analyticRuleVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Admins on Tier Zero Computers",
                "displayName": "BloodHound Attack Path Finding - Admins on Tier Zero Computers",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0Admins\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject7').analyticRuleId7,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 7",
                "parentId": "[variables('analyticRuleObject7').analyticRuleId7]",
                "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject7').analyticRuleVersion7]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Admins on Tier Zero Computers",
        "contentProductId": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "id": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject8').analyticRuleTemplateSpecName8]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AksContributorRoleOnTierZeroManagedCluster_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject8').analyticRuleVersion8]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - AKS Contributor Role on Tier Zero Managed Cluster",
                "displayName": "BloodHound Attack Path Finding - AKS Contributor Role on Tier Zero Managed Cluster",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0AKSContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject8').analyticRuleId8,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 8",
                "parentId": "[variables('analyticRuleObject8').analyticRuleId8]",
                "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject8').analyticRuleVersion8]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - AKS Contributor Role on Tier Zero Managed Cluster",
        "contentProductId": "[variables('analyticRuleObject8')._analyticRulecontentProductId8]",
        "id": "[variables('analyticRuleObject8')._analyticRulecontentProductId8]",
        "version": "[variables('analyticRuleObject8').analyticRuleVersion8]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject9').analyticRuleTemplateSpecName9]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AllextendedPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject9').analyticRuleVersion9]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - AllExtended Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - AllExtended Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0AllExtendedRights\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject9').analyticRuleId9,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 9",
                "parentId": "[variables('analyticRuleObject9').analyticRuleId9]",
                "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject9').analyticRuleVersion9]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - AllExtended Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject9')._analyticRulecontentProductId9]",
        "id": "[variables('analyticRuleObject9')._analyticRulecontentProductId9]",
        "version": "[variables('analyticRuleObject9').analyticRuleVersion9]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject10').analyticRuleTemplateSpecName10]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AppAdminControlOfTierZeroPrincipal_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject10').analyticRuleVersion10]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - App Admin Control of Tier Zero Principal",
                "displayName": "BloodHound Attack Path Finding - App Admin Control of Tier Zero Principal",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0AppAdmin\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject10').analyticRuleId10,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 10",
                "parentId": "[variables('analyticRuleObject10').analyticRuleId10]",
                "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject10').analyticRuleVersion10]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - App Admin Control of Tier Zero Principal",
        "contentProductId": "[variables('analyticRuleObject10')._analyticRulecontentProductId10]",
        "id": "[variables('analyticRuleObject10')._analyticRulecontentProductId10]",
        "version": "[variables('analyticRuleObject10').analyticRuleVersion10]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject11').analyticRuleTemplateSpecName11]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "AvereContributorRoleOnTierZeroVirtualMachine_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject11').analyticRuleVersion11]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Avere Contributor Role on Tier Zero Virtual Machine",
                "displayName": "BloodHound Attack Path Finding - Avere Contributor Role on Tier Zero Virtual Machine",
                "enabled": false,
                "query": "BHEAttackPathsData_CL\n| where Finding == \"AzureT0AvereContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject11').analyticRuleId11,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 11",
                "parentId": "[variables('analyticRuleObject11').analyticRuleId11]",
                "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject11').analyticRuleVersion11]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Avere Contributor Role on Tier Zero Virtual Machine",
        "contentProductId": "[variables('analyticRuleObject11')._analyticRulecontentProductId11]",
        "id": "[variables('analyticRuleObject11')._analyticRulecontentProductId11]",
        "version": "[variables('analyticRuleObject11').analyticRuleVersion11]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject12').analyticRuleTemplateSpecName12]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BasedConstrainedDelegationPrivilegesOnTierZeroComputers_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject12').analyticRuleVersion12]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Add Resource-Based Constrained Delegation Privileges on Tier Zero Computers",
                "displayName": "BloodHound Attack Path Finding - Add Resource-Based Constrained Delegation Privileges on Tier Zero Computers",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0AddAllowedToAct\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject12').analyticRuleId12,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 12",
                "parentId": "[variables('analyticRuleObject12').analyticRuleId12]",
                "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject12').analyticRuleVersion12]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Add Resource-Based Constrained Delegation Privileges on Tier Zero Computers",
        "contentProductId": "[variables('analyticRuleObject12')._analyticRulecontentProductId12]",
        "id": "[variables('analyticRuleObject12')._analyticRulecontentProductId12]",
        "version": "[variables('analyticRuleObject12').analyticRuleVersion12]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject13').analyticRuleTemplateSpecName13]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BasedNtlmRelayToSmbAttack_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject13').analyticRuleVersion13]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Computers Vulnerable to Coercion-Based NTLM Relay to SMB Attack",
                "displayName": "BloodHound Attack Path Finding - Computers Vulnerable to Coercion-Based NTLM Relay to SMB Attack",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"LargeDefaultGroupsCoerceAndRelayNTLMToSMB\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject13').analyticRuleId13,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 13",
                "parentId": "[variables('analyticRuleObject13').analyticRuleId13]",
                "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject13').analyticRuleVersion13]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Computers Vulnerable to Coercion-Based NTLM Relay to SMB Attack",
        "contentProductId": "[variables('analyticRuleObject13')._analyticRulecontentProductId13]",
        "id": "[variables('analyticRuleObject13')._analyticRulecontentProductId13]",
        "version": "[variables('analyticRuleObject13').analyticRuleVersion13]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject14').analyticRuleTemplateSpecName14]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CloudAppAdminOverTierZeroPrincipal_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject14').analyticRuleVersion14]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Cloud App Admin Over Tier Zero Principal",
                "displayName": "BloodHound Attack Path Finding - Cloud App Admin Over Tier Zero Principal",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0CloudAppAdmin\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject14').analyticRuleId14,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 14",
                "parentId": "[variables('analyticRuleObject14').analyticRuleId14]",
                "contentId": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject14').analyticRuleVersion14]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Cloud App Admin Over Tier Zero Principal",
        "contentProductId": "[variables('analyticRuleObject14')._analyticRulecontentProductId14]",
        "id": "[variables('analyticRuleObject14')._analyticRulecontentProductId14]",
        "version": "[variables('analyticRuleObject14').analyticRuleVersion14]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject15').analyticRuleTemplateSpecName15]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CommandExecutionOnTierZeroVirtualMachine_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject15').analyticRuleVersion15]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Command Execution on Tier Zero Virtual Machine",
                "displayName": "BloodHound Attack Path Finding - Command Execution on Tier Zero Virtual Machine",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0ExecuteCommand\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject15').analyticRuleId15,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 15",
                "parentId": "[variables('analyticRuleObject15').analyticRuleId15]",
                "contentId": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject15').analyticRuleVersion15]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Command Execution on Tier Zero Virtual Machine",
        "contentProductId": "[variables('analyticRuleObject15')._analyticRulecontentProductId15]",
        "id": "[variables('analyticRuleObject15')._analyticRulecontentProductId15]",
        "version": "[variables('analyticRuleObject15').analyticRuleVersion15]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject16').analyticRuleTemplateSpecName16]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "ConstrainedDelegationOnTierZeroComputers_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject16').analyticRuleVersion16]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Constrained Delegation on Tier Zero Computers",
                "displayName": "BloodHound Attack Path Finding - Constrained Delegation on Tier Zero Computers",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0AllowedToDelegate\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject16').analyticRuleId16,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 16",
                "parentId": "[variables('analyticRuleObject16').analyticRuleId16]",
                "contentId": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject16').analyticRuleVersion16]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Constrained Delegation on Tier Zero Computers",
        "contentProductId": "[variables('analyticRuleObject16')._analyticRulecontentProductId16]",
        "id": "[variables('analyticRuleObject16')._analyticRulecontentProductId16]",
        "version": "[variables('analyticRuleObject16').analyticRuleVersion16]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject17').analyticRuleTemplateSpecName17]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "ContributorRoleOnTierZeroAutomationAccount_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject17').analyticRuleVersion17]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Contributor Role on Tier Zero Automation Account",
                "displayName": "BloodHound Attack Path Finding - Contributor Role on Tier Zero Automation Account",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0AutomationContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject17').analyticRuleId17,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 17",
                "parentId": "[variables('analyticRuleObject17').analyticRuleId17]",
                "contentId": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject17').analyticRuleVersion17]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Contributor Role on Tier Zero Automation Account",
        "contentProductId": "[variables('analyticRuleObject17')._analyticRulecontentProductId17]",
        "id": "[variables('analyticRuleObject17')._analyticRulecontentProductId17]",
        "version": "[variables('analyticRuleObject17').analyticRuleVersion17]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject18').analyticRuleTemplateSpecName18]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "ContributorRoleOnTierZeroResource_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject18').analyticRuleVersion18]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Contributor Role on Tier Zero Resource",
                "displayName": "BloodHound Attack Path Finding - Contributor Role on Tier Zero Resource",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0Contributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject18').analyticRuleId18,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 18",
                "parentId": "[variables('analyticRuleObject18').analyticRuleId18]",
                "contentId": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject18').analyticRuleVersion18]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Contributor Role on Tier Zero Resource",
        "contentProductId": "[variables('analyticRuleObject18')._analyticRulecontentProductId18]",
        "id": "[variables('analyticRuleObject18')._analyticRulecontentProductId18]",
        "version": "[variables('analyticRuleObject18').analyticRuleVersion18]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject19').analyticRuleTemplateSpecName19]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "DcomUsersOnTierZeroComputers_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject19').analyticRuleVersion19]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - DCOM Users on Tier Zero Computers",
                "displayName": "BloodHound Attack Path Finding - DCOM Users on Tier Zero Computers",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0DCOM\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject19').analyticRuleId19,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 19",
                "parentId": "[variables('analyticRuleObject19').analyticRuleId19]",
                "contentId": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject19').analyticRuleVersion19]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - DCOM Users on Tier Zero Computers",
        "contentProductId": "[variables('analyticRuleObject19')._analyticRulecontentProductId19]",
        "id": "[variables('analyticRuleObject19')._analyticRulecontentProductId19]",
        "version": "[variables('analyticRuleObject19').analyticRuleVersion19]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject20').analyticRuleTemplateSpecName20]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "ForcechangepasswordPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject20').analyticRuleVersion20]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - ForceChangePassword Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - ForceChangePassword Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0ForceChangePassword\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject20').analyticRuleId20,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 20",
                "parentId": "[variables('analyticRuleObject20').analyticRuleId20]",
                "contentId": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject20').analyticRuleVersion20]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - ForceChangePassword Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject20')._analyticRulecontentProductId20]",
        "id": "[variables('analyticRuleObject20')._analyticRulecontentProductId20]",
        "version": "[variables('analyticRuleObject20').analyticRuleVersion20]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject21').analyticRuleTemplateSpecName21]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "GenericallPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject21').analyticRuleVersion21]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - GenericAll Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - GenericAll Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0GenericAll\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject21').analyticRuleId21,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 21",
                "parentId": "[variables('analyticRuleObject21').analyticRuleId21]",
                "contentId": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject21').analyticRuleVersion21]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - GenericAll Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject21')._analyticRulecontentProductId21]",
        "id": "[variables('analyticRuleObject21')._analyticRulecontentProductId21]",
        "version": "[variables('analyticRuleObject21').analyticRuleVersion21]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject22').analyticRuleTemplateSpecName22]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "GenericwritePrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject22').analyticRuleVersion22]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - GenericWrite Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - GenericWrite Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0GenericWrite\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject22').analyticRuleId22,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 22",
                "parentId": "[variables('analyticRuleObject22').analyticRuleId22]",
                "contentId": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject22').analyticRuleVersion22]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - GenericWrite Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject22')._analyticRulecontentProductId22]",
        "id": "[variables('analyticRuleObject22')._analyticRulecontentProductId22]",
        "version": "[variables('analyticRuleObject22').analyticRuleVersion22]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject23').analyticRuleTemplateSpecName23]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "GetCertifcatesOnTierZeroKeyVault_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject23').analyticRuleVersion23]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Get Certifcates on Tier Zero Key Vault",
                "displayName": "BloodHound Attack Path Finding - Get Certifcates on Tier Zero Key Vault",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0GetCerts\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject23').analyticRuleId23,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 23",
                "parentId": "[variables('analyticRuleObject23').analyticRuleId23]",
                "contentId": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject23').analyticRuleVersion23]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Get Certifcates on Tier Zero Key Vault",
        "contentProductId": "[variables('analyticRuleObject23')._analyticRulecontentProductId23]",
        "id": "[variables('analyticRuleObject23')._analyticRulecontentProductId23]",
        "version": "[variables('analyticRuleObject23').analyticRuleVersion23]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject24').analyticRuleTemplateSpecName24]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "GetKeysOnTierZeroKeyVault_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject24').analyticRuleVersion24]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Get Keys on Tier Zero Key Vault",
                "displayName": "BloodHound Attack Path Finding - Get Keys on Tier Zero Key Vault",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0GetKeys\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject24').analyticRuleId24,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 24",
                "parentId": "[variables('analyticRuleObject24').analyticRuleId24]",
                "contentId": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject24').analyticRuleVersion24]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Get Keys on Tier Zero Key Vault",
        "contentProductId": "[variables('analyticRuleObject24')._analyticRulecontentProductId24]",
        "id": "[variables('analyticRuleObject24')._analyticRulecontentProductId24]",
        "version": "[variables('analyticRuleObject24').analyticRuleVersion24]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject25').analyticRuleTemplateSpecName25]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "GetSecretsOnTierZeroKeyVault_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject25').analyticRuleVersion25]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Get Secrets on Tier Zero Key Vault",
                "displayName": "BloodHound Attack Path Finding - Get Secrets on Tier Zero Key Vault",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0GetSecrets\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject25').analyticRuleId25,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 25",
                "parentId": "[variables('analyticRuleObject25').analyticRuleId25]",
                "contentId": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject25').analyticRuleVersion25]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Get Secrets on Tier Zero Key Vault",
        "contentProductId": "[variables('analyticRuleObject25')._analyticRulecontentProductId25]",
        "id": "[variables('analyticRuleObject25')._analyticRulecontentProductId25]",
        "version": "[variables('analyticRuleObject25').analyticRuleVersion25]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject26').analyticRuleTemplateSpecName26]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "KerberoastableUserAccounts_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject26').analyticRuleVersion26]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Kerberoastable User Accounts",
                "displayName": "BloodHound Attack Path Finding - Kerberoastable User Accounts",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"Kerberoasting\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject26').analyticRuleId26,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 26",
                "parentId": "[variables('analyticRuleObject26').analyticRuleId26]",
                "contentId": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject26').analyticRuleVersion26]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Kerberoastable User Accounts",
        "contentProductId": "[variables('analyticRuleObject26')._analyticRulecontentProductId26]",
        "id": "[variables('analyticRuleObject26')._analyticRulecontentProductId26]",
        "version": "[variables('analyticRuleObject26').analyticRuleVersion26]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject27').analyticRuleTemplateSpecName27]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "KerberosDelegationOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject27').analyticRuleVersion27]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Kerberos Delegation on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - Kerberos Delegation on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0MarkSensitive\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject27').analyticRuleId27,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 27",
                "parentId": "[variables('analyticRuleObject27').analyticRuleId27]",
                "contentId": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject27').analyticRuleVersion27]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Kerberos Delegation on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject27')._analyticRulecontentProductId27]",
        "id": "[variables('analyticRuleObject27')._analyticRulecontentProductId27]",
        "version": "[variables('analyticRuleObject27').analyticRuleVersion27]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject28').analyticRuleTemplateSpecName28]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "KeyVaultContributorRoleOnTierZeroResource_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject28').analyticRuleVersion28]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Key Vault Contributor Role on Tier Zero Resource",
                "displayName": "BloodHound Attack Path Finding - Key Vault Contributor Role on Tier Zero Resource",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0KeyVaultContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject28').analyticRuleId28,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 28",
                "parentId": "[variables('analyticRuleObject28').analyticRuleId28]",
                "contentId": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject28').analyticRuleVersion28]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Key Vault Contributor Role on Tier Zero Resource",
        "contentProductId": "[variables('analyticRuleObject28')._analyticRulecontentProductId28]",
        "id": "[variables('analyticRuleObject28')._analyticRulecontentProductId28]",
        "version": "[variables('analyticRuleObject28').analyticRuleVersion28]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject29').analyticRuleTemplateSpecName29]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "LargeDefaultGroupsInLocalAdministratorGroups_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject29').analyticRuleVersion29]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Large Default Groups in Local Administrator Groups",
                "displayName": "BloodHound Attack Path Finding - Large Default Groups in Local Administrator Groups",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"LargeDefaultGroupsAdmins\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject29').analyticRuleId29,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 29",
                "parentId": "[variables('analyticRuleObject29').analyticRuleId29]",
                "contentId": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject29').analyticRuleVersion29]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Large Default Groups in Local Administrator Groups",
        "contentProductId": "[variables('analyticRuleObject29')._analyticRulecontentProductId29]",
        "id": "[variables('analyticRuleObject29')._analyticRulecontentProductId29]",
        "version": "[variables('analyticRuleObject29').analyticRuleVersion29]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject30').analyticRuleTemplateSpecName30]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "LogicAppContributorRoleOnTierZeroLogicApp_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject30').analyticRuleVersion30]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Logic App Contributor Role on Tier Zero Logic App",
                "displayName": "BloodHound Attack Path Finding - Logic App Contributor Role on Tier Zero Logic App",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0LogicAppContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject30').analyticRuleId30,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 30",
                "parentId": "[variables('analyticRuleObject30').analyticRuleId30]",
                "contentId": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject30').analyticRuleVersion30]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Logic App Contributor Role on Tier Zero Logic App",
        "contentProductId": "[variables('analyticRuleObject30')._analyticRulecontentProductId30]",
        "id": "[variables('analyticRuleObject30')._analyticRulecontentProductId30]",
        "version": "[variables('analyticRuleObject30').analyticRuleVersion30]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject31').analyticRuleTemplateSpecName31]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "LogonsFromTierZeroUsers_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject31').analyticRuleVersion31]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Logons From Tier Zero Users",
                "displayName": "BloodHound Attack Path Finding - Logons From Tier Zero Users",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0Logins\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject31').analyticRuleId31,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 31",
                "parentId": "[variables('analyticRuleObject31').analyticRuleId31]",
                "contentId": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject31').analyticRuleVersion31]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Logons From Tier Zero Users",
        "contentProductId": "[variables('analyticRuleObject31')._analyticRulecontentProductId31]",
        "id": "[variables('analyticRuleObject31')._analyticRulecontentProductId31]",
        "version": "[variables('analyticRuleObject31').analyticRuleVersion31]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject32').analyticRuleTemplateSpecName32]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "NonTierZeroPrincipalsWithAdcsEsc1Privileges_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject32').analyticRuleVersion32]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non Tier Zero Principals With ADCS ESC1 Privileges",
                "displayName": "BloodHound Attack Path Finding - Non Tier Zero Principals With ADCS ESC1 Privileges",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0ADCSESC1\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject32').analyticRuleId32,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 32",
                "parentId": "[variables('analyticRuleObject32').analyticRuleId32]",
                "contentId": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject32').analyticRuleVersion32]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non Tier Zero Principals With ADCS ESC1 Privileges",
        "contentProductId": "[variables('analyticRuleObject32')._analyticRulecontentProductId32]",
        "id": "[variables('analyticRuleObject32')._analyticRulecontentProductId32]",
        "version": "[variables('analyticRuleObject32').analyticRuleVersion32]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject33').analyticRuleTemplateSpecName33]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "NonTierZeroResourceAssignedToTierZeroServicePrincipal_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject33').analyticRuleVersion33]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non Tier Zero Resource Assigned to Tier Zero Service Principal",
                "displayName": "BloodHound Attack Path Finding - Non Tier Zero Resource Assigned to Tier Zero Service Principal",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureNonT0ManagedIdentityAssignment\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject33').analyticRuleId33,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 33",
                "parentId": "[variables('analyticRuleObject33').analyticRuleId33]",
                "contentId": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject33').analyticRuleVersion33]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non Tier Zero Resource Assigned to Tier Zero Service Principal",
        "contentProductId": "[variables('analyticRuleObject33')._analyticRulecontentProductId33]",
        "id": "[variables('analyticRuleObject33')._analyticRulecontentProductId33]",
        "version": "[variables('analyticRuleObject33').analyticRuleVersion33]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject34').analyticRuleTemplateSpecName34]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "OwnerRoleOnTierZeroResource_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject34').analyticRuleVersion34]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Owner Role on Tier Zero Resource",
                "displayName": "BloodHound Attack Path Finding - Owner Role on Tier Zero Resource",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0Owner\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject34').analyticRuleId34,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 34",
                "parentId": "[variables('analyticRuleObject34').analyticRuleId34]",
                "contentId": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject34').analyticRuleVersion34]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Owner Role on Tier Zero Resource",
        "contentProductId": "[variables('analyticRuleObject34')._analyticRulecontentProductId34]",
        "id": "[variables('analyticRuleObject34')._analyticRulecontentProductId34]",
        "version": "[variables('analyticRuleObject34').analyticRuleVersion34]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject35').analyticRuleTemplateSpecName35]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "OwnershipOfTierZeroPrincipal_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject35').analyticRuleVersion35]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Ownership of Tier Zero Principal",
                "displayName": "BloodHound Attack Path Finding - Ownership of Tier Zero Principal",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0Owns\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject35').analyticRuleId35,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 35",
                "parentId": "[variables('analyticRuleObject35').analyticRuleId35]",
                "contentId": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject35').analyticRuleVersion35]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Ownership of Tier Zero Principal",
        "contentProductId": "[variables('analyticRuleObject35')._analyticRulecontentProductId35]",
        "id": "[variables('analyticRuleObject35')._analyticRulecontentProductId35]",
        "version": "[variables('analyticRuleObject35').analyticRuleVersion35]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject36').analyticRuleTemplateSpecName36]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "OwnershipPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject36').analyticRuleVersion36]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Ownership Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - Ownership Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0Owns\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject36').analyticRuleId36,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 36",
                "parentId": "[variables('analyticRuleObject36').analyticRuleId36]",
                "contentId": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject36').analyticRuleVersion36]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Ownership Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject36')._analyticRulecontentProductId36]",
        "id": "[variables('analyticRuleObject36')._analyticRulecontentProductId36]",
        "version": "[variables('analyticRuleObject36').analyticRuleVersion36]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject37').analyticRuleTemplateSpecName37]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "RdpUsersOnTierZeroComputers_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject37').analyticRuleVersion37]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - RDP Users on Tier Zero Computers",
                "displayName": "BloodHound Attack Path Finding - RDP Users on Tier Zero Computers",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0RDP\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject37').analyticRuleId37,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 37",
                "parentId": "[variables('analyticRuleObject37').analyticRuleId37]",
                "contentId": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject37').analyticRuleVersion37]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - RDP Users on Tier Zero Computers",
        "contentProductId": "[variables('analyticRuleObject37')._analyticRulecontentProductId37]",
        "id": "[variables('analyticRuleObject37')._analyticRulecontentProductId37]",
        "version": "[variables('analyticRuleObject37').analyticRuleVersion37]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject38').analyticRuleTemplateSpecName38]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "ReadGmsaPasswordPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject38').analyticRuleVersion38]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Read GMSA Password Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - Read GMSA Password Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"T0ReadGMSA\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject38').analyticRuleId38,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 38",
                "parentId": "[variables('analyticRuleObject38').analyticRuleId38]",
                "contentId": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject38').analyticRuleVersion38]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Read GMSA Password Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject38')._analyticRulecontentProductId38]",
        "id": "[variables('analyticRuleObject38')._analyticRulecontentProductId38]",
        "version": "[variables('analyticRuleObject38').analyticRuleVersion38]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject39').analyticRuleTemplateSpecName39]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "ResetATierZeroUser_sPassword_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject39').analyticRuleVersion39]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Reset a Tier Zero User's Password",
                "displayName": "BloodHound Attack Path Finding - Reset a Tier Zero User's Password",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0ResetPassword\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject39').analyticRuleId39,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 39",
                "parentId": "[variables('analyticRuleObject39').analyticRuleId39]",
                "contentId": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject39').analyticRuleVersion39]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Reset a Tier Zero User's Password",
        "contentProductId": "[variables('analyticRuleObject39')._analyticRulecontentProductId39]",
        "id": "[variables('analyticRuleObject39')._analyticRulecontentProductId39]",
        "version": "[variables('analyticRuleObject39').analyticRuleVersion39]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject40').analyticRuleTemplateSpecName40]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroAdUserSyncedToTierZeroEntraUser_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject40').analyticRuleVersion40]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero AD User Synced to Tier Zero Entra User",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero AD User Synced to Tier Zero Entra User",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0SyncedToEntraUser\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject40').analyticRuleId40,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 40",
                "parentId": "[variables('analyticRuleObject40').analyticRuleId40]",
                "contentId": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject40').analyticRuleVersion40]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero AD User Synced to Tier Zero Entra User",
        "contentProductId": "[variables('analyticRuleObject40')._analyticRulecontentProductId40]",
        "id": "[variables('analyticRuleObject40')._analyticRulecontentProductId40]",
        "version": "[variables('analyticRuleObject40').analyticRuleVersion40]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject41').analyticRuleTemplateSpecName41]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroComputerHostingEnterprisecaTrustedForNtAuthentication_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject41').analyticRuleVersion41]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Computer Hosting EnterpriseCA Trusted for NT Authentication",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Computer Hosting EnterpriseCA Trusted for NT Authentication",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0GoldenCert\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject41').analyticRuleId41,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 41",
                "parentId": "[variables('analyticRuleObject41').analyticRuleId41]",
                "contentId": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject41').analyticRuleVersion41]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Computer Hosting EnterpriseCA Trusted for NT Authentication",
        "contentProductId": "[variables('analyticRuleObject41')._analyticRulecontentProductId41]",
        "id": "[variables('analyticRuleObject41')._analyticRulecontentProductId41]",
        "version": "[variables('analyticRuleObject41').analyticRuleVersion41]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject42').analyticRuleTemplateSpecName42]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroEntraUserSyncedToTierZeroAdUser_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject42').analyticRuleVersion42]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Entra User Synced to Tier Zero AD User",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Entra User Synced to Tier Zero AD User",
                "enabled": false,
                "query": "BHEAttackPathsData_CL\n| where Finding == \"T0SyncedToADUser\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject42').analyticRuleId42,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 42",
                "parentId": "[variables('analyticRuleObject42').analyticRuleId42]",
                "contentId": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject42').analyticRuleVersion42]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Entra User Synced to Tier Zero AD User",
        "contentProductId": "[variables('analyticRuleObject42')._analyticRulecontentProductId42]",
        "id": "[variables('analyticRuleObject42')._analyticRulecontentProductId42]",
        "version": "[variables('analyticRuleObject42').analyticRuleVersion42]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject43').analyticRuleTemplateSpecName43]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroGroupControlViaMsGraphAppRole_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject43').analyticRuleVersion43]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Tier Zero Group Control via MS Graph App Role",
                "displayName": "BloodHound Attack Path Finding - Tier Zero Group Control via MS Graph App Role",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0MGAddMember\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject43').analyticRuleId43,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 43",
                "parentId": "[variables('analyticRuleObject43').analyticRuleId43]",
                "contentId": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject43').analyticRuleVersion43]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Tier Zero Group Control via MS Graph App Role",
        "contentProductId": "[variables('analyticRuleObject43')._analyticRulecontentProductId43]",
        "id": "[variables('analyticRuleObject43')._analyticRulecontentProductId43]",
        "version": "[variables('analyticRuleObject43').analyticRuleVersion43]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject44').analyticRuleTemplateSpecName44]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroPrincipalCanGrantTierZeroAppRoles_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject44').analyticRuleVersion44]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject44')._analyticRulecontentId44]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Principal Can Grant Tier Zero App Roles",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principal Can Grant Tier Zero App Roles",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0MGGrantAppRoles\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject44').analyticRuleId44,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 44",
                "parentId": "[variables('analyticRuleObject44').analyticRuleId44]",
                "contentId": "[variables('analyticRuleObject44')._analyticRulecontentId44]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject44').analyticRuleVersion44]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject44')._analyticRulecontentId44]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principal Can Grant Tier Zero App Roles",
        "contentProductId": "[variables('analyticRuleObject44')._analyticRulecontentProductId44]",
        "id": "[variables('analyticRuleObject44')._analyticRulecontentProductId44]",
        "version": "[variables('analyticRuleObject44').analyticRuleVersion44]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject45').analyticRuleTemplateSpecName45]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroPrincipalCanGrantTierZeroEntraIdRole_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject45').analyticRuleVersion45]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject45')._analyticRulecontentId45]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Principal Can Grant Tier Zero Entra ID Role",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principal Can Grant Tier Zero Entra ID Role",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0MGGrantRole\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject45').analyticRuleId45,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 45",
                "parentId": "[variables('analyticRuleObject45').analyticRuleId45]",
                "contentId": "[variables('analyticRuleObject45')._analyticRulecontentId45]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject45').analyticRuleVersion45]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject45')._analyticRulecontentId45]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principal Can Grant Tier Zero Entra ID Role",
        "contentProductId": "[variables('analyticRuleObject45')._analyticRulecontentProductId45]",
        "id": "[variables('analyticRuleObject45')._analyticRulecontentProductId45]",
        "version": "[variables('analyticRuleObject45').analyticRuleVersion45]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject46').analyticRuleTemplateSpecName46]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroPrincipalsWithAdcsEsc9ScenarioAPrivileges_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject46').analyticRuleVersion46]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject46')._analyticRulecontentId46]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Principals With ADCS ESC9 Scenario A Privileges",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principals With ADCS ESC9 Scenario A Privileges",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0ADCSESC9a\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject46').analyticRuleId46,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 46",
                "parentId": "[variables('analyticRuleObject46').analyticRuleId46]",
                "contentId": "[variables('analyticRuleObject46')._analyticRulecontentId46]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject46').analyticRuleVersion46]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject46')._analyticRulecontentId46]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principals With ADCS ESC9 Scenario A Privileges",
        "contentProductId": "[variables('analyticRuleObject46')._analyticRulecontentProductId46]",
        "id": "[variables('analyticRuleObject46')._analyticRulecontentProductId46]",
        "version": "[variables('analyticRuleObject46').analyticRuleVersion46]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject47').analyticRuleTemplateSpecName47]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroPrincipalsWithAdcsEsc9ScenarioBPrivileges_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject47').analyticRuleVersion47]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject47')._analyticRulecontentId47]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Principals With ADCS ESC9 Scenario B Privileges",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principals With ADCS ESC9 Scenario B Privileges",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0ADCSESC9b\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject47').analyticRuleId47,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 47",
                "parentId": "[variables('analyticRuleObject47').analyticRuleId47]",
                "contentId": "[variables('analyticRuleObject47')._analyticRulecontentId47]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject47').analyticRuleVersion47]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject47')._analyticRulecontentId47]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principals With ADCS ESC9 Scenario B Privileges",
        "contentProductId": "[variables('analyticRuleObject47')._analyticRulecontentProductId47]",
        "id": "[variables('analyticRuleObject47')._analyticRulecontentProductId47]",
        "version": "[variables('analyticRuleObject47').analyticRuleVersion47]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject48').analyticRuleTemplateSpecName48]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroPrincipalsWithDcsyncPrivileges_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject48').analyticRuleVersion48]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject48')._analyticRulecontentId48]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Principals With DCSync Privileges",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principals With DCSync Privileges",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"NonT0DCSyncers\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject48').analyticRuleId48,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 48",
                "parentId": "[variables('analyticRuleObject48').analyticRuleId48]",
                "contentId": "[variables('analyticRuleObject48')._analyticRulecontentId48]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject48').analyticRuleVersion48]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject48')._analyticRulecontentId48]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principals With DCSync Privileges",
        "contentProductId": "[variables('analyticRuleObject48')._analyticRulecontentProductId48]",
        "id": "[variables('analyticRuleObject48')._analyticRulecontentProductId48]",
        "version": "[variables('analyticRuleObject48').analyticRuleVersion48]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject49').analyticRuleTemplateSpecName49]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroPrincipalTrustedForUnconstrainedDelegation_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject49').analyticRuleVersion49]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject49')._analyticRulecontentId49]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Non-Tier Zero Principal Trusted for Unconstrained Delegation",
                "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principal Trusted for Unconstrained Delegation",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0CoerceToTGT\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject49').analyticRuleId49,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 49",
                "parentId": "[variables('analyticRuleObject49').analyticRuleId49]",
                "contentId": "[variables('analyticRuleObject49')._analyticRulecontentId49]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject49').analyticRuleVersion49]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject49')._analyticRulecontentId49]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Non-Tier Zero Principal Trusted for Unconstrained Delegation",
        "contentProductId": "[variables('analyticRuleObject49')._analyticRulecontentProductId49]",
        "id": "[variables('analyticRuleObject49')._analyticRulecontentProductId49]",
        "version": "[variables('analyticRuleObject49').analyticRuleVersion49]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject50').analyticRuleTemplateSpecName50]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "TierZeroServicePrincipalControlViaMsGraphAppRole_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject50').analyticRuleVersion50]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject50')._analyticRulecontentId50]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Tier Zero Service Principal Control via MS Graph App Role",
                "displayName": "BloodHound Attack Path Finding - Tier Zero Service Principal Control via MS Graph App Role",
                "enabled": false,
                "query": "BHEAttackPathsData_CL \n| where Finding == \"AzureT0MGAddSecret\"",
                "queryFrequency": "PP1D",
                "queryPeriod": "PP1D",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject50').analyticRuleId50,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 50",
                "parentId": "[variables('analyticRuleObject50').analyticRuleId50]",
                "contentId": "[variables('analyticRuleObject50')._analyticRulecontentId50]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject50').analyticRuleVersion50]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject50')._analyticRulecontentId50]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Tier Zero Service Principal Control via MS Graph App Role",
        "contentProductId": "[variables('analyticRuleObject50')._analyticRulecontentProductId50]",
        "id": "[variables('analyticRuleObject50')._analyticRulecontentProductId50]",
        "version": "[variables('analyticRuleObject50').analyticRuleVersion50]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject51').analyticRuleTemplateSpecName51]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "UserAccessAdminRoleOnTierZeroResource_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject51').analyticRuleVersion51]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject51')._analyticRulecontentId51]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - User Access Admin Role on Tier Zero Resource",
                "displayName": "BloodHound Attack Path Finding - User Access Admin Role on Tier Zero Resource",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0UserAccessAdministrator\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject51').analyticRuleId51,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 51",
                "parentId": "[variables('analyticRuleObject51').analyticRuleId51]",
                "contentId": "[variables('analyticRuleObject51')._analyticRulecontentId51]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject51').analyticRuleVersion51]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject51')._analyticRulecontentId51]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - User Access Admin Role on Tier Zero Resource",
        "contentProductId": "[variables('analyticRuleObject51')._analyticRulecontentProductId51]",
        "id": "[variables('analyticRuleObject51')._analyticRulecontentProductId51]",
        "version": "[variables('analyticRuleObject51').analyticRuleVersion51]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject52').analyticRuleTemplateSpecName52]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "VmAdminLoginRoleOnTierZeroSystem_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject52').analyticRuleVersion52]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject52')._analyticRulecontentId52]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - VM Admin Login Role on Tier Zero System",
                "displayName": "BloodHound Attack Path Finding - VM Admin Login Role on Tier Zero System",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0VMAdminLogin\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject52').analyticRuleId52,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 52",
                "parentId": "[variables('analyticRuleObject52').analyticRuleId52]",
                "contentId": "[variables('analyticRuleObject52')._analyticRulecontentId52]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject52').analyticRuleVersion52]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject52')._analyticRulecontentId52]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - VM Admin Login Role on Tier Zero System",
        "contentProductId": "[variables('analyticRuleObject52')._analyticRulecontentProductId52]",
        "id": "[variables('analyticRuleObject52')._analyticRulecontentProductId52]",
        "version": "[variables('analyticRuleObject52').analyticRuleVersion52]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject53').analyticRuleTemplateSpecName53]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "VmContributorRoleOnTierZeroSystem_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject53').analyticRuleVersion53]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject53')._analyticRulecontentId53]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - VM Contributor Role on Tier Zero System",
                "displayName": "BloodHound Attack Path Finding - VM Contributor Role on Tier Zero System",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0VMContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject53').analyticRuleId53,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 53",
                "parentId": "[variables('analyticRuleObject53').analyticRuleId53]",
                "contentId": "[variables('analyticRuleObject53')._analyticRulecontentId53]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject53').analyticRuleVersion53]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject53')._analyticRulecontentId53]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - VM Contributor Role on Tier Zero System",
        "contentProductId": "[variables('analyticRuleObject53')._analyticRulecontentProductId53]",
        "id": "[variables('analyticRuleObject53')._analyticRulecontentProductId53]",
        "version": "[variables('analyticRuleObject53').analyticRuleVersion53]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject54').analyticRuleTemplateSpecName54]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "WebsiteContributorRoleOnTierZeroResource_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject54').analyticRuleVersion54]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject54')._analyticRulecontentId54]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Website Contributor Role on Tier Zero Resource",
                "displayName": "BloodHound Attack Path Finding - Website Contributor Role on Tier Zero Resource",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"AzureT0WebsiteContributor\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject54').analyticRuleId54,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 54",
                "parentId": "[variables('analyticRuleObject54').analyticRuleId54]",
                "contentId": "[variables('analyticRuleObject54')._analyticRulecontentId54]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject54').analyticRuleVersion54]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject54')._analyticRulecontentId54]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Website Contributor Role on Tier Zero Resource",
        "contentProductId": "[variables('analyticRuleObject54')._analyticRulecontentProductId54]",
        "id": "[variables('analyticRuleObject54')._analyticRulecontentProductId54]",
        "version": "[variables('analyticRuleObject54').analyticRuleVersion54]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject55').analyticRuleTemplateSpecName55]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "WriteAccountRestrictionsPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject55').analyticRuleVersion55]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject55')._analyticRulecontentId55]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - Write Account Restrictions Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - Write Account Restrictions Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0WriteAccountRestrictions\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject55').analyticRuleId55,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 55",
                "parentId": "[variables('analyticRuleObject55').analyticRuleId55]",
                "contentId": "[variables('analyticRuleObject55')._analyticRulecontentId55]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject55').analyticRuleVersion55]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject55')._analyticRulecontentId55]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - Write Account Restrictions Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject55')._analyticRulecontentProductId55]",
        "id": "[variables('analyticRuleObject55')._analyticRulecontentProductId55]",
        "version": "[variables('analyticRuleObject55').analyticRuleVersion55]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject56').analyticRuleTemplateSpecName56]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "WritedaclPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject56').analyticRuleVersion56]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject56')._analyticRulecontentId56]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - WriteDacl Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - WriteDacl Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0WriteDACL\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject56').analyticRuleId56,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 56",
                "parentId": "[variables('analyticRuleObject56').analyticRuleId56]",
                "contentId": "[variables('analyticRuleObject56')._analyticRulecontentId56]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject56').analyticRuleVersion56]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject56')._analyticRulecontentId56]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - WriteDacl Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject56')._analyticRulecontentProductId56]",
        "id": "[variables('analyticRuleObject56')._analyticRulecontentProductId56]",
        "version": "[variables('analyticRuleObject56').analyticRuleVersion56]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject57').analyticRuleTemplateSpecName57]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "WritegplinkPrivilegesOnTierZeroObjects_AnalyticalRules Analytics Rule with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject57').analyticRuleVersion57]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject57')._analyticRulecontentId57]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "BloodHound Attack Path Finding - WriteGpLink Privileges on Tier Zero Objects",
                "displayName": "BloodHound Attack Path Finding - WriteGpLink Privileges on Tier Zero Objects",
                "enabled": false,
                "query": "BHEAttackPathsData_CL | where Finding == \"T0WriteGPLink\"",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "BHEAttackPathsData_CL"
                    ],
                    "connectorId": "BloodHound"
                  }
                ],
                "entityMappings": [
                  {
                    "entityType": "URL",
                    "fieldMappings": [
                      {
                        "identifier": "Url",
                        "columnName": "domain_name"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Remediation": "ShortRemediation",
                  "Description": "ShortDescription"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject57').analyticRuleId57,'/'))))]",
              "properties": {
                "description": "BloodHound Analytics Rule 57",
                "parentId": "[variables('analyticRuleObject57').analyticRuleId57]",
                "contentId": "[variables('analyticRuleObject57')._analyticRulecontentId57]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject57').analyticRuleVersion57]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject57')._analyticRulecontentId57]",
        "contentKind": "AnalyticsRule",
        "displayName": "BloodHound Attack Path Finding - WriteGpLink Privileges on Tier Zero Objects",
        "contentProductId": "[variables('analyticRuleObject57')._analyticRulecontentProductId57]",
        "id": "[variables('analyticRuleObject57')._analyticRulecontentProductId57]",
        "version": "[variables('analyticRuleObject57').analyticRuleVersion57]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "BloodHound data connector with template version 3.1.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Bloodhound",
                  "publisher": "SpecterOps",
                  "descriptionMarkdown": "The solution is designed to test bloodhound package creation process.",
                  "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
                  "graphQueries": [
                    {
                      "metricName": "Total Attack Paths Details",
                      "legend": "Bloodhound Attack Paths Details",
                      "baseQuery": "BloodHoundAttackPathsDetails_CL "
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Top 10 Bloodhound Attack Path Details",
                      "query": "BloodHoundAttackPathsDetails_CL  | top 10 by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "BloodHoundAttackPathsDetails_CL ",
                      "lastDataReceivedQuery": "BloodHoundAttackPathsDetails_CL "
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "BloodHoundAttackPathsDetails_CL "
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "**BloodHound Enterprise API key & Id** is required.  See the documentation to learn more about API on the `https://bloodhound.specterops.io/integrations/bloodhound-api/working-with-api`."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to a 'BloodHound Enterprise' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": "**STEP 1 - Retrieve BloodHound Enterprise API Key and ID**\n\nTo enable the Azure Function to authenticate successfully and pull logs into Microsoft Sentinel, you must first obtain the API Key and ID from your BloodHound Enterprise instance. See the documentation to learn more about API on the `https://bloodhound.specterops.io/integrations/bloodhound-api/working-with-api`."
                    },
                    {
                      "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 'BloodHound Enterprise' connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the 'BloodHound Enterprise' API authorization key(s) or Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'BloodHound Enterprise' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)]()\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Tenant URL**, **API Key**, **API ID** 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                    },
                    {
                      "description": "**Option 2 - Manual Deployment of Azure Functions**\n\n Use the following step-by-step instructions to deploy the 'BloodHound Enterprise' connector manually with Azure Functions."
                    },
                    {
                      "description": "1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, ensure Runtime stack is set to **python 3.11**. \n4. In the **Hosting** tab, ensure **Plan type** is set to **'Consumption (Serverless)'**.\n5.select Storage account\n6. 'Add other required configurations'. \n5. 'Make other preferable configuration changes', if needed, then click **Create**.",
                      "title": "1. Create a Function App"
                    },
                    {
                      "description": "1. Install Azure CLI\n2. From terminal type **az functionapp deployment source config-zip -g <ResourceGroup> -n <FunctionApp> --src <Zip File>** and hit enter. Set the `ResourceGroup` value to: your resource group name. Set the `FunctionApp` value to: your newly created function app name. Set the `Zip File` value to: `digitalshadowsConnector.zip`(path to your zip file). Note:- Download the zip file from the link - [Function App Code](https://github.com/metron-labs/Azure-Sentinel/blob/bloodhound/Solutions/BloodHound/Data%20Connectors/BloodHoundAzureFunction.zip)",
                      "title": "2. Import Function App Code(Zip deployment)"
                    },
                    {
                      "description": "1. In the Function App screen, click the Function App name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following 'x (number of)' application settings individually, under Name, with their respective string values (case-sensitive) under Value: \n\t\tDigitalShadowsAccountID\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tDigitalShadowsKey\n\t\tDigitalShadowsSecret\n\t\tHistoricalDays\n\t\tDigitalShadowsURL\n\t\tClassificationFilterOperation\n\t\tHighVariabilityClassifications\n\t\tFUNCTION_NAME\n\t\tlogAnalyticsUri (optional)\n(add any other settings required by the Function App)\nSet the `DigitalShadowsURL` value to: `https://api.searchlight.app/v1`\nSet the `HighVariabilityClassifications` value to: `exposed-credential,marked-document`\nSet the `ClassificationFilterOperation` value to: `exclude` for exclude function app or `include` for include function app \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Azure Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: https://<CustomerId>.ods.opinsights.azure.us. \n4. Once all application settings have been entered, click **Save**.",
                      "title": "3. Configure the Function App"
                    }
                  ],
                  "metadata": {
                    "version": "1.0.0",
                    "kind": "dataConnector"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "BloodHound",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "SpecterOps",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "SpecterOps",
                  "email": "support@specterops.io",
                  "tier": "Partner",
                  "link": "https://bloodhoundenterprise.io/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "Bloodhound",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "BloodHound",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "SpecterOps",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "SpecterOps",
          "email": "support@specterops.io",
          "tier": "Partner",
          "link": "https://bloodhoundenterprise.io/"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Bloodhound",
          "publisher": "SpecterOps",
          "descriptionMarkdown": "The solution is designed to test bloodhound package creation process.",
          "graphQueries": [
            {
              "metricName": "Total Attack Paths Details",
              "legend": "Bloodhound Attack Paths Details",
              "baseQuery": "BloodHoundAttackPathsDetails_CL "
            }
          ],
          "dataTypes": [
            {
              "name": "BloodHoundAttackPathsDetails_CL ",
              "lastDataReceivedQuery": "BloodHoundAttackPathsDetails_CL "
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "BloodHoundAttackPathsDetails_CL "
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Top 10 Bloodhound Attack Path Details",
              "query": "BloodHoundAttackPathsDetails_CL  | top 10 by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "**BloodHound Enterprise API key & Id** is required.  See the documentation to learn more about API on the `https://bloodhound.specterops.io/integrations/bloodhound-api/working-with-api`."
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to a 'BloodHound Enterprise' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": "**STEP 1 - Retrieve BloodHound Enterprise API Key and ID**\n\nTo enable the Azure Function to authenticate successfully and pull logs into Microsoft Sentinel, you must first obtain the API Key and ID from your BloodHound Enterprise instance. See the documentation to learn more about API on the `https://bloodhound.specterops.io/integrations/bloodhound-api/working-with-api`."
            },
            {
              "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 'BloodHound Enterprise' connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the 'BloodHound Enterprise' API authorization key(s) or Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'BloodHound Enterprise' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)]()\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Tenant URL**, **API Key**, **API ID** 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
            },
            {
              "description": "**Option 2 - Manual Deployment of Azure Functions**\n\n Use the following step-by-step instructions to deploy the 'BloodHound Enterprise' connector manually with Azure Functions."
            },
            {
              "description": "1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, ensure Runtime stack is set to **python 3.11**. \n4. In the **Hosting** tab, ensure **Plan type** is set to **'Consumption (Serverless)'**.\n5.select Storage account\n6. 'Add other required configurations'. \n5. 'Make other preferable configuration changes', if needed, then click **Create**.",
              "title": "1. Create a Function App"
            },
            {
              "description": "1. Install Azure CLI\n2. From terminal type **az functionapp deployment source config-zip -g <ResourceGroup> -n <FunctionApp> --src <Zip File>** and hit enter. Set the `ResourceGroup` value to: your resource group name. Set the `FunctionApp` value to: your newly created function app name. Set the `Zip File` value to: `digitalshadowsConnector.zip`(path to your zip file). Note:- Download the zip file from the link - [Function App Code](https://github.com/metron-labs/Azure-Sentinel/blob/bloodhound/Solutions/BloodHound/Data%20Connectors/BloodHoundAzureFunction.zip)",
              "title": "2. Import Function App Code(Zip deployment)"
            },
            {
              "description": "1. In the Function App screen, click the Function App name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following 'x (number of)' application settings individually, under Name, with their respective string values (case-sensitive) under Value: \n\t\tDigitalShadowsAccountID\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tDigitalShadowsKey\n\t\tDigitalShadowsSecret\n\t\tHistoricalDays\n\t\tDigitalShadowsURL\n\t\tClassificationFilterOperation\n\t\tHighVariabilityClassifications\n\t\tFUNCTION_NAME\n\t\tlogAnalyticsUri (optional)\n(add any other settings required by the Function App)\nSet the `DigitalShadowsURL` value to: `https://api.searchlight.app/v1`\nSet the `HighVariabilityClassifications` value to: `exposed-credential,marked-document`\nSet the `ClassificationFilterOperation` value to: `exclude` for exclude function app or `include` for include function app \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Azure Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: https://<CustomerId>.ods.opinsights.azure.us. \n4. Once all application settings have been entered, click **Save**.",
              "title": "3. Configure the Function App"
            }
          ],
          "id": "[variables('_uiConfigId1')]",
          "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution."
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.1.2",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "BloodHound",
        "publisherDisplayName": "SpecterOps",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/BloodHound/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The BloodHound Enterprise Microsoft Sentinel solution ingests your BloodHound Enterprise posture and attack paths into Microsoft Sentinel. Use the dashboards to track the Active Directory and Azure attack paths of your environment. Create alerts to detect when new attack paths emerge or new the exposure increases.</p>\n<p><strong>Data Connectors:</strong> 1, <strong>Workbooks:</strong> 7, <strong>Analytic Rules:</strong> 57</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://specterops.io/wp-content/uploads/sites/3/2022/03/favicon-light.png?w=156\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "BloodHound",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "SpecterOps",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "SpecterOps",
          "email": "support@specterops.io",
          "tier": "Partner",
          "link": "https://bloodhoundenterprise.io/"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId2')]",
              "version": "[variables('workbookVersion2')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId3')]",
              "version": "[variables('workbookVersion3')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId4')]",
              "version": "[variables('workbookVersion4')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId5')]",
              "version": "[variables('workbookVersion5')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId6')]",
              "version": "[variables('workbookVersion6')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId7')]",
              "version": "[variables('workbookVersion7')]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
              "version": "[variables('analyticRuleObject8').analyticRuleVersion8]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
              "version": "[variables('analyticRuleObject9').analyticRuleVersion9]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
              "version": "[variables('analyticRuleObject10').analyticRuleVersion10]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
              "version": "[variables('analyticRuleObject11').analyticRuleVersion11]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
              "version": "[variables('analyticRuleObject12').analyticRuleVersion12]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
              "version": "[variables('analyticRuleObject13').analyticRuleVersion13]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
              "version": "[variables('analyticRuleObject14').analyticRuleVersion14]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
              "version": "[variables('analyticRuleObject15').analyticRuleVersion15]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
              "version": "[variables('analyticRuleObject16').analyticRuleVersion16]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
              "version": "[variables('analyticRuleObject17').analyticRuleVersion17]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
              "version": "[variables('analyticRuleObject18').analyticRuleVersion18]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
              "version": "[variables('analyticRuleObject19').analyticRuleVersion19]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
              "version": "[variables('analyticRuleObject20').analyticRuleVersion20]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
              "version": "[variables('analyticRuleObject21').analyticRuleVersion21]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
              "version": "[variables('analyticRuleObject22').analyticRuleVersion22]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
              "version": "[variables('analyticRuleObject23').analyticRuleVersion23]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
              "version": "[variables('analyticRuleObject24').analyticRuleVersion24]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
              "version": "[variables('analyticRuleObject25').analyticRuleVersion25]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
              "version": "[variables('analyticRuleObject26').analyticRuleVersion26]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
              "version": "[variables('analyticRuleObject27').analyticRuleVersion27]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
              "version": "[variables('analyticRuleObject28').analyticRuleVersion28]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
              "version": "[variables('analyticRuleObject29').analyticRuleVersion29]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
              "version": "[variables('analyticRuleObject30').analyticRuleVersion30]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
              "version": "[variables('analyticRuleObject31').analyticRuleVersion31]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
              "version": "[variables('analyticRuleObject32').analyticRuleVersion32]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
              "version": "[variables('analyticRuleObject33').analyticRuleVersion33]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
              "version": "[variables('analyticRuleObject34').analyticRuleVersion34]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
              "version": "[variables('analyticRuleObject35').analyticRuleVersion35]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
              "version": "[variables('analyticRuleObject36').analyticRuleVersion36]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
              "version": "[variables('analyticRuleObject37').analyticRuleVersion37]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
              "version": "[variables('analyticRuleObject38').analyticRuleVersion38]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
              "version": "[variables('analyticRuleObject39').analyticRuleVersion39]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
              "version": "[variables('analyticRuleObject40').analyticRuleVersion40]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
              "version": "[variables('analyticRuleObject41').analyticRuleVersion41]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
              "version": "[variables('analyticRuleObject42').analyticRuleVersion42]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
              "version": "[variables('analyticRuleObject43').analyticRuleVersion43]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject44')._analyticRulecontentId44]",
              "version": "[variables('analyticRuleObject44').analyticRuleVersion44]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject45')._analyticRulecontentId45]",
              "version": "[variables('analyticRuleObject45').analyticRuleVersion45]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject46')._analyticRulecontentId46]",
              "version": "[variables('analyticRuleObject46').analyticRuleVersion46]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject47')._analyticRulecontentId47]",
              "version": "[variables('analyticRuleObject47').analyticRuleVersion47]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject48')._analyticRulecontentId48]",
              "version": "[variables('analyticRuleObject48').analyticRuleVersion48]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject49')._analyticRulecontentId49]",
              "version": "[variables('analyticRuleObject49').analyticRuleVersion49]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject50')._analyticRulecontentId50]",
              "version": "[variables('analyticRuleObject50').analyticRuleVersion50]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject51')._analyticRulecontentId51]",
              "version": "[variables('analyticRuleObject51').analyticRuleVersion51]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject52')._analyticRulecontentId52]",
              "version": "[variables('analyticRuleObject52').analyticRuleVersion52]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject53')._analyticRulecontentId53]",
              "version": "[variables('analyticRuleObject53').analyticRuleVersion53]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject54')._analyticRulecontentId54]",
              "version": "[variables('analyticRuleObject54').analyticRuleVersion54]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject55')._analyticRulecontentId55]",
              "version": "[variables('analyticRuleObject55').analyticRuleVersion55]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject56')._analyticRulecontentId56]",
              "version": "[variables('analyticRuleObject56').analyticRuleVersion56]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject57')._analyticRulecontentId57]",
              "version": "[variables('analyticRuleObject57').analyticRuleVersion57]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            }
          ]
        },
        "firstPublishDate": "2023-05-04",
        "lastPublishDate": "2021-05-04",
        "providers": [
          "SpecterOps"
        ],
        "categories": {
          "domains": [
            "Security - Network"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
