id: a5526ba9-5997-47c6-bf2e-60a08b681e9b
name: Alerts for a new breach
description: |
  'Creates an incident new beaches.''
severity: High
status: Available
requiredDataConnectors:
  - connectorId: BitSight
    dataTypes:
      - BitSightBreaches
queryFrequency: 1d
queryPeriod: 14d
triggerOperator: GreaterThan
triggerThreshold: 0
query: |
    let timeframe = 24h;
    BitSightBreaches
    | where ingestion_time() > ago(timeframe)
    | project DateCreated, Companyname, Severity, PreviwURL, GUID
incidentConfiguration:
    createIncident: true
    groupingConfiguration:
      enabled: false
      reopenClosedIncident: false
      lookbackDuration: 5h
      matchingMethod: AllEntities
      groupByEntities: []
      groupByAlertDetails: []
      groupByCustomDetails: []
eventGroupingSettings:
    aggregationKind: AlertPerResult
alertDetailsOverride:
    alertDisplayNameFormat: 'BitSight: Alert for new breach in {{Companyname}}.'
    alertDescriptionFormat: 'Alert is generated on {{DateCreated}} at BitSight.\n\nGUID: {{GUID}}\nPreview URL: {{PreviwURL}}'
    alertSeverityColumnName: Severity
    alertDynamicProperties: []
version: 1.0.1
kind: Scheduled