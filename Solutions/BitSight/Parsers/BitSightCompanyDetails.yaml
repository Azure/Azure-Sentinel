id: 25fcb934-4665-48c3-a4ce-2dd6c0874beb
Function:
  Title: Parser for BitSightCompanyDetails
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: BitSightCompanyDetails
FunctionAlias: BitSightCompanyDetails
FunctionQuery: |
    let CompanyDetails_view  = view () {
        BitsightCompany_details_CL
        | extend
                    EventVendor ="BitSight",
                    EventProduct ="CompanyDetails",
                    PrimaryCompanyGUID = column_ifexists('primary_company_guid', ''),
                    PrimaryCompanyName = column_ifexists('primary_company_name', ''),
                    AvailableUpgradeTypes = column_ifexists('available_upgrade_types', ''),
                    BulkEmailSenderStatus = column_ifexists('bulk_email_sender_status', ''),
                    CompanyFeatures = column_ifexists('company_features', ''),
                    CustomerMonitoringCount = column_ifexists('customer_monitoring_count', ''),
                    Description = column_ifexists('description', ''),
                    DisplayURL = column_ifexists('display_url', ''),
                    GUID = column_ifexists('guid', ''),
                    HasCompanyTree = column_ifexists('has_company_tree', ''),
                    HasPreferredContact = column_ifexists('has_preferred_contact', ''),
                    Hompage = column_ifexists('homepage', ''),
                    InSpmPortfolio = column_ifexists('in_spm_portfolio', ''),
                    Industry = column_ifexists('industry', ''),
                    IndustrySlug = column_ifexists('industry_slug', ''),
                    Ipv4Count = column_ifexists('ipv4_count', ''),
                    IsBundle = column_ifexists('is_bundle', ''),
                    IsCsp = column_ifexists('is_csp', ''),
                    IsMycompMysubsBundle = column_ifexists('is_mycomp_mysubs_bundle', ''),
                    IsPrimary = column_ifexists('is_primary', ''),
                    IsUnsampledAllowed = column_ifexists('is_unsampled_allowed', ''),
                    Name = column_ifexists('name', ''),
                    PeopleCount = column_ifexists('people_count', ''),
                    PermissionCanAnnotate = column_ifexists('permissions_can_annotate', ''),
                    PermissionCanDownloadCompanyReport = column_ifexists('permissions_can_download_company_report', ''),
                    PermissionCanEnableVendorAccess = column_ifexists('permissions_can_enable_vendor_access', ''),
                    PermissionCanViewCompanyReports = column_ifexists('permissions_can_view_company_reports', ''),
                    PermissionCanViewForensics = column_ifexists('permissions_can_view_forensics', ''),
                    PermissionCanViewInfrastructure = column_ifexists('permissions_can_view_infrastructure', ''),
                    PermissionCanViewIpAttributions = column_ifexists('permissions_can_view_ip_attributions', ''),
                    PermissionCanViewServiceProviders = column_ifexists('permissions_can_view_service_providers', ''),
                    PermissionsHasControl = column_ifexists('permissions_has_control', ''),
                    PrimaryDomain = column_ifexists('primary_domain', ''),
                    RatingIndustryMedian = column_ifexists('rating_industry_median', ''),
                    Ratings = column_ifexists('ratings', ''),
                    RelatedCompanies = column_ifexists('related_companies', ''),
                    SearchCount = column_ifexists('search_count', ''),
                    ServiceProvider = column_ifexists('service_provider', ''),
                    Shortname = column_ifexists('shortname', ''),
                    Sparkline = column_ifexists('sparkline', ''),
                    SubIndustry = column_ifexists('sub_industry', ''),
                    SubIndustrySlug = column_ifexists('sub_industry_slug', ''),
                    SubscriptionType = column_ifexists('subscription_type', ''),
                    SubscriptionTypeKey = column_ifexists('subscription_type_key', ''),
                    ComplianceClaimCertifications = column_ifexists('compliance_claim_certifications', ''),
                    ComplianceClaimTrustPage = column_ifexists('compliance_claim_trust_page', ''),
                    type = column_ifexists('type', '')
        | project
                    TimeGenerated,
    				EventVendor,
                    EventProduct,
                    PrimaryCompanyGUID,
                    PrimaryCompanyName,
                    AvailableUpgradeTypes,
                    BulkEmailSenderStatus,
                    CompanyFeatures,
                    CustomerMonitoringCount,
                    Description,
                    DisplayURL,
                    GUID,
                    HasCompanyTree,
                    HasPreferredContact,
                    Hompage,
                    InSpmPortfolio,
                    Industry,
                    IndustrySlug,
                    Ipv4Count,
                    IsBundle,
                    IsCsp,
                    IsMycompMysubsBundle,
                    IsPrimary,
                    IsUnsampledAllowed,
                    Name,
                    PeopleCount,
                    PermissionCanAnnotate,
                    PermissionCanDownloadCompanyReport,
                    PermissionCanEnableVendorAccess,
                    PermissionCanViewCompanyReports,
                    PermissionCanViewForensics,
                    PermissionCanViewInfrastructure,
                    PermissionCanViewIpAttributions,
                    PermissionCanViewServiceProviders,
                    PermissionsHasControl,
                    PrimaryDomain,
                    RatingIndustryMedian,
                    Ratings,
                    RelatedCompanies,
                    SearchCount,
                    ServiceProvider,
                    Shortname,
                    Sparkline,
                    SubIndustry,
                    SubIndustrySlug,
                    SubscriptionType,
                    SubscriptionTypeKey,
                    ComplianceClaimCertifications,
                    ComplianceClaimTrustPage,
                    type
    };
    CompanyDetails_view