id: 1280e2d5-9d9a-4455-8aec-3e340a3ffeb2
Function:
  Title: Parser for BitSightCompanyRatings
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: BitSightCompanyRatings
FunctionAlias: BitSightCompanyRatings
FunctionQuery: |
    let CompanyRatings_view  = view () {
        BitsightCompany_rating_details_CL
        | extend
                    EventVendor ="BitSight",
                    EventProduct ="CompanyRating",
                    CompanyName = column_ifexists('Company_name', ''),
                    Beta = column_ifexists('beta', ''),
                    Category = column_ifexists('category', ''),
                    CategoryOrder = column_ifexists('category_order', ''),
                    DisplayURL = column_ifexists('display_url', ''),
                    Grade = column_ifexists('grade', ''),
                    GradeColor = column_ifexists('grade_color', ''),
                    Name = column_ifexists('name', ''),
                    Order = column_ifexists('order', ''),
                    Percentile = column_ifexists('percentile', ''),
                    Rating = column_ifexists('rating', '')
        | project
                    TimeGenerated,
                    EventVendor,
                    EventProduct,
                    CompanyName,
                    Beta,
                    Category,
                    CategoryOrder,
                    DisplayURL,
                    Grade,
                    GradeColor,
                    Name,
                    Order,
                    Percentile,
                    Rating
    };
    CompanyRatings_view