{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "config": {
      "isWizard": false,
      "basics": {
        "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/ZscalerLogo.svg\" width=\"358px\" height=\"221px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Zscaler%20Internet%20Access/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe [Zscaler Internet Access](https://www.zscaler.com/products-and-solutions/zscaler-internet-access) solution for Microsoft Sentinel enables you to ingest [Zscaler Internet Access Logs](https://help.zscaler.com/zia/nanolog-streaming-service) into Microsoft Sentinel using the Microsoft Sentinel Analytics Workspace.\n\n**Data Connectors:** 15, **Workbooks:** 17\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
        "subscription": {
          "resourceProviders": [
            "Microsoft.OperationsManagement/solutions",
            "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "Microsoft.Insights/workbooks",
            "Microsoft.Logic/workflows"
          ]
        },
        "location": {
          "metadata": {
            "hidden": "Hiding location, we get it from the log analytics workspace"
          },
          "visible": false
        },
        "resourceGroup": {
          "allowExisting": true
        }
      }
    },
    "basics": [
      {
        "name": "getLAWorkspace",
        "type": "Microsoft.Solutions.ArmApiControl",
        "toolTip": "This filters by workspaces that exist in the Resource Group selected",
        "condition": "[greater(length(resourceGroup().name),0)]",
        "request": {
          "method": "GET",
          "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
        }
      },
      {
        "name": "workspace",
        "type": "Microsoft.Common.DropDown",
        "label": "Workspace",
        "placeholder": "Select a workspace",
        "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
        "constraints": {
          "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
          "required": true
        },
        "visible": true
      }
    ],
    "steps": [
      {
        "name": "dataconnectors",
        "label": "Data Connectors",
        "bladeTitle": "Data Connectors",
        "elements": [
          {
            "name": "dataconnectors1-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS Web Log Push Connector. You can get Zscaler Internet Access Cloud NSS Web Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link1",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors2-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS Firewall Log Push Connector. You can get Zscaler Internet Access Cloud NSS Firewall Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link2",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors3-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS DNS Log Push Connector. You can get Zscaler Internet Access Cloud NSS DNS Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link3",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors4-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS Tunnel Log Push Connector. You can get Zscaler Internet Access Cloud NSS Tunnel Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link4",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors5-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS Endpoint DLP Log Push Connector. You can get Zscaler Internet Access Cloud NSS Endpoint DLP Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link5",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors6-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS Email DLP Log Push Connector. You can get Zscaler Internet Access Cloud NSS Email DLP Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link6",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors7-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB Repo Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB Repo Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link7",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors8-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB ITSM Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB ITSM Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link8",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors9-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB File Sharing Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB File Sharing Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link9",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors10-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB Email Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB Email Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link10",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors11-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB CRM Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB CRM Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link11",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors12-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB Collaboration Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB Collaboration Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link12",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors13-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB Cloud Storage Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB Cloud Storage Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link13",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors14-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS CASB Activity Log Push Connector. You can get Zscaler Internet Access Cloud NSS CASB Activity Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link14",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          },
          {
            "name": "dataconnectors15-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This Solution installs the data connector for Zscaler Internet Access Cloud NSS Audit Log Push Connector. You can get Zscaler Internet Access Cloud NSS Audit Log Push Connector data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."
            }
          },
          {
            "name": "dataconnectors-link15",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more about connecting data sources",
                "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"
              }
            }
          }
        ]
      },
      {
        "name": "workbooks",
        "label": "Workbooks",
        "subLabel": {
          "preValidation": "Configure the workbooks",
          "postValidation": "Done"
        },
        "bladeTitle": "Workbooks",
        "elements": [
          {
            "name": "workbooks-text",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "text": "This solution installs workbook(s) to help you gain insights into the telemetry collected in Microsoft Sentinel. After installing the solution, start using the workbook in Manage solution view."
            }
          },
          {
            "name": "workbooks-link",
            "type": "Microsoft.Common.TextBlock",
            "options": {
              "link": {
                "label": "Learn more",
                "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-monitor-your-data"
              }
            }
          },
          {
            "name": "workbook1",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook1-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook2",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook2-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook3",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook3-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook4",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook4-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook5",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook5-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook6",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook6-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook7",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook7-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook8",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook8-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook9",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook9-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook10",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook10-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook11",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook11-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook12",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook12-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook13",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook13-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook14",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook14-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook15",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook15-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook16",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook16-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          },
          {
            "name": "workbook17",
            "type": "Microsoft.Common.Section",
            "label": null,
            "elements": [
              {
                "name": "workbook17-text",
                "type": "Microsoft.Common.TextBlock",
                "options": {
                  "text": null
                }
              }
            ]
          }
        ]
      }
    ],
    "outputs": {
      "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
      "location": "[location()]",
      "workspace": "[basics('workspace')]"
    }
  }
}
