id: 8a3c7e91-4b2d-5f6a-9c8d-1e2f3a4b5c6d
Function:
  Title: Parser for NetskopeWebTransactions
  Version: "1.0.0"
  LastUpdated: "2026-02-09"
Category: Microsoft Sentinel Parser
FunctionName: NetskopeWebtx
FunctionAlias: NetskopeWebtx
FunctionQuery: |
  let NetskopeWebTransactions_View = view (){
    NetskopeWebTransactions_CL
    | extend 
        TenantId = column_ifexists('TenantId', ''),
        SourceSystem = column_ifexists('SourceSystem', ''),
        MG = column_ifexists('MG', ''),
        ManagementGroupName = column_ifexists('ManagementGroupName', ''),
        TimeGenerated = column_ifexists('TimeGenerated', ''),
        Computer = column_ifexists('Computer', ''),
        RawData = column_ifexists('RawData', ''),
        _ResourceId = column_ifexists('_ResourceId', ''),
        Type = column_ifexists('Type', ''),
        EventDate = column_ifexists('date', ''),
        EventTime = column_ifexists('time', ''),
        TimeTaken = column_ifexists('time-taken', ''),
        ClientToServerBytes = column_ifexists('cs-bytes', ''),
        ServerToClientBytes = column_ifexists('sc-bytes', ''),
        TotalBytes = column_ifexists('bytes', ''),
        ClientIP = column_ifexists('c-ip', ''),
        ServerIP = column_ifexists('s-ip', ''),
        Username = column_ifexists('cs-username', ''),
        HttpMethod = column_ifexists('cs-method', ''),
        UriScheme = column_ifexists('cs-uri-scheme', ''),
        UriQuery = column_ifexists('cs-uri-query', ''),
        UserAgent = column_ifexists('cs-user-agent', ''),
        RequestContentType = column_ifexists('cs-content-type', ''),
        ResponseStatus = column_ifexists('sc-status', ''),
        ResponseContentType = column_ifexists('sc-content-type', ''),
        DnsName = column_ifexists('cs-dns', ''),
        HostName = column_ifexists('cs-host', ''),
        Uri = column_ifexists('cs-uri', ''),
        UriPort = column_ifexists('cs-uri-port', ''),
        Referer = column_ifexists('cs-referer', ''),
        SessionId = column_ifexists('x-cs-session-id', ''),
        AccessMethod = column_ifexists('x-cs-access-method', ''),
        App = column_ifexists('x-cs-app', ''),
        ServerCountry = column_ifexists('x-s-country', ''),
        ServerLatitude = column_ifexists('x-s-latitude', ''),
        ServerLongitude = column_ifexists('x-s-longitude', ''),
        ServerLocation = column_ifexists('x-s-location', ''),
        ServerRegion = column_ifexists('x-s-region', ''),
        ServerZipcode = column_ifexists('x-s-zipcode', ''),
        ClientCountry = column_ifexists('x-c-country', ''),
        ClientLatitude = column_ifexists('x-c-latitude', ''),
        ClientLongitude = column_ifexists('x-c-longitude', ''),
        ClientLocation = column_ifexists('x-c-location', ''),
        ClientRegion = column_ifexists('x-c-region', ''),
        ClientZipcode = column_ifexists('x-c-zipcode', ''),
        ClientOS = column_ifexists('x-c-os', ''),
        ClientBrowser = column_ifexists('x-c-browser', ''),
        ClientBrowserVersion = column_ifexists('x-c-browser-version', ''),
        ClientDevice = column_ifexists('x-c-device', ''),
        Site = column_ifexists('x-cs-site', ''),
        EventTimestamp = column_ifexists('x-cs-timestamp', ''),
        PageId = column_ifexists('x-cs-page-id', ''),
        UserIP = column_ifexists('x-cs-userip', ''),
        TrafficType = column_ifexists('x-cs-traffic-type', ''),
        TunnelId = column_ifexists('x-cs-tunnel-id', ''),
        Category = column_ifexists('x-category', ''),
        OtherCategory = column_ifexists('x-other-category', ''),
        EventType = column_ifexists('x-type', ''),
        ServerSSLError = column_ifexists('x-server-ssl-err', ''),
        ClientSSLError = column_ifexists('x-client-ssl-err', ''),
        TransactionId = column_ifexists('x-transaction-id', ''),
        RequestId = column_ifexists('x-request-id', ''),
        SNI = column_ifexists('x-cs-sni', ''),
        DomainFrontedSNI = column_ifexists('x-cs-domain-fronted-sni', ''),
        CategoryId = column_ifexists('x-category-id', ''),
        OtherCategoryId = column_ifexists('x-other-category-id', ''),
        ResponseHeadersName = column_ifexists('x-sr-headers-name', ''),
        ResponseHeadersValue = column_ifexists('x-sr-headers-value', ''),
        SSLJA3 = column_ifexists('x-cs-ssl-ja3', ''),
        SSLJA3S = column_ifexists('x-sr-ssl-ja3s', ''),
        SSLBypass = column_ifexists('x-ssl-bypass', ''),
        SSLBypassReason = column_ifexists('x-ssl-bypass-reason', ''),
        RemoteCertSubjectCN = column_ifexists('x-r-cert-subject-cn', ''),
        RemoteCertIssuerCN = column_ifexists('x-r-cert-issuer-cn', ''),
        RemoteCertStartDate = column_ifexists('x-r-cert-startdate', ''),
        RemoteCertEndDate = column_ifexists('x-r-cert-enddate', ''),
        RemoteCertValid = column_ifexists('x-r-cert-valid', ''),
        RemoteCertExpired = column_ifexists('x-r-cert-expired', ''),
        RemoteCertUntrustedRoot = column_ifexists('x-r-cert-untrusted-root', ''),
        RemoteCertIncompleteChain = column_ifexists('x-r-cert-incomplete-chain', ''),
        RemoteCertSelfSigned = column_ifexists('x-r-cert-self-signed', ''),
        RemoteCertRevoked = column_ifexists('x-r-cert-revoked', ''),
        RemoteCertRevocationCheck = column_ifexists('x-r-cert-revocation-check', ''),
        RemoteCertMismatch = column_ifexists('x-r-cert-mismatch', ''),
        ClientSSLFrontingError = column_ifexists('x-cs-ssl-fronting-error', ''),
        ClientSSLHandshakeError = column_ifexists('x-cs-ssl-handshake-error', ''),
        ServerSSLHandshakeError = column_ifexists('x-sr-ssl-handshake-error', ''),
        ServerSSLClientCertError = column_ifexists('x-sr-ssl-client-certificate-error', ''),
        ServerSSLMalformedSSL = column_ifexists('x-sr-ssl-malformed-ssl', ''),
        CustomSigningCAError = column_ifexists('x-s-custom-signing-ca-error', ''),
        ClientSSLEngineAction = column_ifexists('x-cs-ssl-engine-action', ''),
        ClientSSLEngineActionReason = column_ifexists('x-cs-ssl-engine-action-reason', ''),
        ServerSSLEngineAction = column_ifexists('x-sr-ssl-engine-action', ''),
        ServerSSLEngineActionReason = column_ifexists('x-sr-ssl-engine-action-reason', ''),
        SSLPolicySrcIP = column_ifexists('x-ssl-policy-src-ip', ''),
        SSLPolicyDstIP = column_ifexists('x-ssl-policy-dst-ip', ''),
        SSLPolicyDstHost = column_ifexists('x-ssl-policy-dst-host', ''),
        SSLPolicyDstHostSource = column_ifexists('x-ssl-policy-dst-host-source', ''),
        SSLPolicyCategories = column_ifexists('x-ssl-policy-categories', ''),
        SSLPolicyAction = column_ifexists('x-ssl-policy-action', ''),
        SSLPolicyName = column_ifexists('x-ssl-policy-name', ''),
        ClientSSLVersion = column_ifexists('x-cs-ssl-version', ''),
        ClientSSLCipher = column_ifexists('x-cs-ssl-cipher', ''),
        ServerSSLVersion = column_ifexists('x-sr-ssl-version', ''),
        ServerSSLCipher = column_ifexists('x-sr-ssl-cipher', ''),
        ClientSrcIPEgress = column_ifexists('x-cs-src-ip-egress', ''),
        DataPlaneName = column_ifexists('x-s-dp-name', ''),
        ClientSrcIP = column_ifexists('x-cs-src-ip', ''),
        ClientSrcPort = column_ifexists('x-cs-src-port', ''),
        ClientDstIP = column_ifexists('x-cs-dst-ip', ''),
        ClientDstPort = column_ifexists('x-cs-dst-port', ''),
        ServerSrcIP = column_ifexists('x-sr-src-ip', ''),
        ServerSrcPort = column_ifexists('x-sr-src-port', ''),
        ServerDstIP = column_ifexists('x-sr-dst-ip', ''),
        ServerDstPort = column_ifexists('x-sr-dst-port', ''),
        ConnectXFF = column_ifexists('x-cs-ip-connect-xff', ''),
        XFF = column_ifexists('x-cs-ip-xff', ''),
        ConnectHost = column_ifexists('x-cs-connect-host', ''),
        ConnectPort = column_ifexists('x-cs-connect-port', ''),
        ConnectUserAgent = column_ifexists('x-cs-connect-user-agent', ''),
        FullUrl = column_ifexists('x-cs-url', ''),
        UriPath = column_ifexists('x-cs-uri-path', ''),
        HttpVersion = column_ifexists('x-cs-http-version', ''),
        RealServerStatus = column_ifexists('rs-status', ''),
        AppCategory = column_ifexists('x-cs-app-category', ''),
        AppCCI = column_ifexists('x-cs-app-cci', ''),
        AppCCL = column_ifexists('x-cs-app-ccl', ''),
        AppTags = column_ifexists('x-cs-app-tags', ''),
        AppSuite = column_ifexists('x-cs-app-suite', ''),
        AppInstanceId = column_ifexists('x-cs-app-instance-id', ''),
        AppInstanceName = column_ifexists('x-cs-app-instance-name', ''),
        AppInstanceTag = column_ifexists('x-cs-app-instance-tag', ''),
        AppActivity = column_ifexists('x-cs-app-activity', ''),
        AppFromUser = column_ifexists('x-cs-app-from-user', ''),
        AppToUser = column_ifexists('x-cs-app-to-user', ''),
        AppObjectType = column_ifexists('x-cs-app-object-type', ''),
        AppObjectName = column_ifexists('x-cs-app-object-name', ''),
        AppObjectId = column_ifexists('x-cs-app-object-id', ''),
        FileType = column_ifexists('x-rs-file-type', ''),
        FileCategory = column_ifexists('x-rs-file-category', ''),
        FileLanguage = column_ifexists('x-rs-file-language', ''),
        FileSize = column_ifexists('x-rs-file-size', ''),
        FileMD5 = column_ifexists('x-rs-file-md5', ''),
        FileSHA256 = column_ifexists('x-rs-file-sha256', ''),
        Error = column_ifexists('x-error', ''),
        ClientLocalTime = column_ifexists('x-c-local-time', ''),
        PolicyAction = column_ifexists('x-policy-action', ''),
        PolicyName = column_ifexists('x-policy-name', ''),
        PolicySrcIP = column_ifexists('x-policy-src-ip', ''),
        PolicyDstIP = column_ifexists('x-policy-dst-ip', ''),
        PolicyDstHost = column_ifexists('x-policy-dst-host', ''),
        PolicyDstHostSource = column_ifexists('x-policy-dst-host-source', ''),
        PolicyJustificationType = column_ifexists('x-policy-justification-type', ''),
        PolicyJustificationReason = column_ifexists('x-policy-justification-reason', ''),
        NotificationName = column_ifexists('x-sc-notification-name', '')
    | project TenantId,
        SourceSystem,
        MG,
        ManagementGroupName,
        TimeGenerated,
        Computer,
        RawData,
        _ResourceId,
        Type,
        EventDate,
        EventTime,
        TimeTaken,
        ClientToServerBytes,
        ServerToClientBytes,
        TotalBytes,
        ClientIP,
        ServerIP,
        Username,
        HttpMethod,
        UriScheme,
        UriQuery,
        UserAgent,
        RequestContentType,
        ResponseStatus,
        ResponseContentType,
        DnsName,
        HostName,
        Uri,
        UriPort,
        Referer,
        SessionId,
        AccessMethod,
        App,
        ServerCountry,
        ServerLatitude,
        ServerLongitude,
        ServerLocation,
        ServerRegion,
        ServerZipcode,
        ClientCountry,
        ClientLatitude,
        ClientLongitude,
        ClientLocation,
        ClientRegion,
        ClientZipcode,
        ClientOS,
        ClientBrowser,
        ClientBrowserVersion,
        ClientDevice,
        Site,
        EventTimestamp,
        PageId,
        UserIP,
        TrafficType,
        TunnelId,
        Category,
        OtherCategory,
        EventType,
        ServerSSLError,
        ClientSSLError,
        TransactionId,
        RequestId,
        SNI,
        DomainFrontedSNI,
        CategoryId,
        OtherCategoryId,
        ResponseHeadersName,
        ResponseHeadersValue,
        SSLJA3,
        SSLJA3S,
        SSLBypass,
        SSLBypassReason,
        RemoteCertSubjectCN,
        RemoteCertIssuerCN,
        RemoteCertStartDate,
        RemoteCertEndDate,
        RemoteCertValid,
        RemoteCertExpired,
        RemoteCertUntrustedRoot,
        RemoteCertIncompleteChain,
        RemoteCertSelfSigned,
        RemoteCertRevoked,
        RemoteCertRevocationCheck,
        RemoteCertMismatch,
        ClientSSLFrontingError,
        ClientSSLHandshakeError,
        ServerSSLHandshakeError,
        ServerSSLClientCertError,
        ServerSSLMalformedSSL,
        CustomSigningCAError,
        ClientSSLEngineAction,
        ClientSSLEngineActionReason,
        ServerSSLEngineAction,
        ServerSSLEngineActionReason,
        SSLPolicySrcIP,
        SSLPolicyDstIP,
        SSLPolicyDstHost,
        SSLPolicyDstHostSource,
        SSLPolicyCategories,
        SSLPolicyAction,
        SSLPolicyName,
        ClientSSLVersion,
        ClientSSLCipher,
        ServerSSLVersion,
        ServerSSLCipher,
        ClientSrcIPEgress,
        DataPlaneName,
        ClientSrcIP,
        ClientSrcPort,
        ClientDstIP,
        ClientDstPort,
        ServerSrcIP,
        ServerSrcPort,
        ServerDstIP,
        ServerDstPort,
        ConnectXFF,
        XFF,
        ConnectHost,
        ConnectPort,
        ConnectUserAgent,
        FullUrl,
        UriPath,
        HttpVersion,
        RealServerStatus,
        AppCategory,
        AppCCI,
        AppCCL,
        AppTags,
        AppSuite,
        AppInstanceId,
        AppInstanceName,
        AppInstanceTag,
        AppActivity,
        AppFromUser,
        AppToUser,
        AppObjectType,
        AppObjectName,
        AppObjectId,
        FileType,
        FileCategory,
        FileLanguage,
        FileSize,
        FileMD5,
        FileSHA256,
        Error,
        ClientLocalTime,
        PolicyAction,
        PolicyName,
        PolicySrcIP,
        PolicyDstIP,
        PolicyDstHost,
        PolicyDstHostSource,
        PolicyJustificationType,
        PolicyJustificationReason,
        NotificationName
  };
  NetskopeWebTransactions_View
