[{
    "name": "ProofpointTAPClicksBlocked",
    "apiVersion": "2022-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "ProofpointTAPv2",
        "dataType": "ProofPointTAPClicksBlockedV2_CL",
        "dcrConfig": {
            "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
            "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
            "streamName": "Custom-ProofPointTAPClicksBlockedV2_CL"
        },
        "auth": {
            "type": "Basic",
            "UserName": "{{username}}",
            "Password": "{{password}}"
        },
        "request": {
            "apiEndpoint": "https://tap-api-v2.proofpoint.com/v2/siem/clicks/blocked",
            "rateLimitQPS": 10,
            "queryWindowInMin": 5,
            "httpMethod": "GET",
            "retryCount": 3,
            "timeoutInSeconds": 60,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
            "queryParameters": {
                "interval": "{_QueryWindowStartTime}/{_QueryWindowEndTime}",
                "format": "json"
            },
            "headers": {
                "Accept": "application/json",
                "Authorization": "[[concat('Basic ', base64(concat(parameters('username'),':',parameters('password'))))]"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.clicksBlocked"
            ],
         "format": "json"
        },
        "isActive": true
    }
},
{
    "name": "ProofpointTAPMessagesBlocked",
    "apiVersion": "2022-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "ProofpointTAPv2",
        "dataType": "ProofPointTAPMessagesBlockedV2_CL",
        "dcrConfig": {
            "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
            "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
            "streamName": "Custom-ProofPointTAPMessagesBlockedV2_CL"
        },
        "auth": {
            "type": "Basic",
            "UserName": "{{username}}",
            "Password": "{{password}}"
        },
        "request": {
            "apiEndpoint": "https://tap-api-v2.proofpoint.com/v2/siem/messages/blocked",
            "rateLimitQPS": 10,
            "queryWindowInMin": 5,
            "httpMethod": "GET",
            "retryCount": 3,
            "timeoutInSeconds": 60,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
            "queryParameters": {
                "interval": "{_QueryWindowStartTime}/{_QueryWindowEndTime}",
                "format": "json"
            },
            "headers": {
                "Accept": "application/json",
                "Authorization": "[[concat('Basic ', base64(concat(parameters('username'),':',parameters('password'))))]"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.messagesBlocked"
            ],
         "format": "json"
        },
        "isActive": true
    }
},
{
    "name": "ProofpointTAPClicksPermitted",
    "apiVersion": "2022-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "ProofpointTAPv2",
        "dataType": "ProofPointTAPClicksPermittedV2_CL",
        "dcrConfig": {
            "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
            "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
            "streamName": "Custom-ProofPointTAPClicksPermittedV2_CL"
        },
        "auth": {
            "type": "Basic",
            "UserName": "{{username}}",
            "Password": "{{password}}"
        },
        "request": {
            "apiEndpoint": "https://tap-api-v2.proofpoint.com/v2/siem/clicks/permitted",
            "rateLimitQPS": 10,
            "queryWindowInMin": 5,
            "httpMethod": "GET",
            "retryCount": 3,
            "timeoutInSeconds": 60,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
            "queryParameters": {
                "interval": "{_QueryWindowStartTime}/{_QueryWindowEndTime}",
                "format": "json"
            },
            "headers": {
                "Accept": "application/json",
                "Authorization": "[[concat('Basic ', base64(concat(parameters('username'),':',parameters('password'))))]"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.clicksPermitted"
            ],
         "format": "json"
        },
        "isActive": true
    }
},
{
    "name": "ProofpointTAPMessagesDelivered",
    "apiVersion": "2022-12-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "ProofpointTAPv2",
        "dataType": "ProofPointTAPMessagesDeliveredV2_CL",
        "dcrConfig": {
            "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
            "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
            "streamName": "Custom-ProofPointTAPMessagesDeliveredV2_CL"
        },
        "auth": {
            "type": "Basic",
            "UserName": "{{username}}",
            "Password": "{{password}}"
        },
        "request": {
            "apiEndpoint": "https://tap-api-v2.proofpoint.com/v2/siem/messages/delivered",
            "rateLimitQPS": 10,
            "queryWindowInMin": 5,
            "httpMethod": "GET",
            "retryCount": 3,
            "timeoutInSeconds": 60,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
            "queryParameters": {
                "interval": "{_QueryWindowStartTime}/{_QueryWindowEndTime}",
                "format": "json"
            },
            "headers": {
                "Accept": "application/json",
                "Authorization": "[[concat('Basic ', base64(concat(parameters('username'),':',parameters('password'))))]"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.messagesDelivered"
            ],
         "format": "json"
        },
        "isActive": true
    }
}
]
