[
    {
    "name": "ProofpointTAPDCR",
    "apiVersion": "2021-09-01-preview",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
        "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
        "streamDeclarations": {
            "Custom-ProofPointTAPClicksBlockedV2_CL": {
                "columns": [
                    {
                        "name": "url",
                        "type": "string"
                    },
                    {
                        "name": "classification",
                        "type": "string"
                    },
                    {
                        "name": "clickTime",
                        "type": "datetime"
                    },
                    {
                        "name": "threatTime",
                        "type": "datetime"
                    },
                    {
                        "name": "userAgent",
                        "type": "string"
                    },
                    {
                        "name": "campaignId",
                        "type": "string"
                    },
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "clickIP",
                        "type": "string"
                    },
                    {
                        "name": "sender",
                        "type": "string"
                    },
                    {
                        "name": "recipient",
                        "type": "string"
                    },
                    {
                        "name": "senderIP",
                        "type": "string"
                    },
                    {
                        "name": "GUID",
                        "type": "string"
                    },
                    {
                        "name": "threatID",
                        "type": "string"
                    },
                    {
                        "name": "threatURL",
                        "type": "string"
                    },
                    {
                        "name": "threatStatus",
                        "type": "string"
                    },
                    {
                        "name": "messageID",
                        "type": "string"
                    }
                ]
            },
            "Custom-ProofPointTAPMessagesBlockedV2_CL": {
                "columns": [
                    {
                        "name": "spamScore",
                        "type": "int"
                    },
                    {
                        "name": "phishScore",
                        "type": "int"
                    },
                    {
                        "name": "threatsInfoMap",
                        "type": "dynamic"
                    },
                    {
                        "name": "messageTime",
                        "type": "datetime"
                    },
                    {
                        "name": "impostorScore",
                        "type": "int"
                    },
                    {
                        "name": "malwareScore",
                        "type": "int"
                    },
                    {
                        "name": "cluster",
                        "type": "string"
                    },
                    {
                        "name": "subject",
                        "type": "string"
                    },
                    {
                        "name": "quarantineFolder",
                        "type": "string"
                    },
                    {
                        "name": "quarantineRule",
                        "type": "string"
                    },
                    {
                        "name": "policyRoutes",
                        "type": "dynamic"
                    },
                    {
                        "name": "modulesRun",
                        "type": "dynamic"
                    },
                    {
                        "name": "messageSize",
                        "type": "int"
                    },
                    {
                        "name": "headerFrom",
                        "type": "string"
                    },
                    {
                        "name": "headerReplyTo",
                        "type": "string"
                    },
                    {
                        "name": "fromAddress",
                        "type": "dynamic"
                    },
                    {
                        "name": "ccAddresses",
                        "type": "dynamic"
                    },
                    {
                        "name": "replyToAddress",
                        "type": "dynamic"
                    },
                    {
                        "name": "toAddresses",
                        "type": "dynamic"
                    },
                    {
                        "name": "xmailer",
                        "type": "dynamic"
                    },
                    {
                        "name": "messageParts",
                        "type": "dynamic"
                    },
                    {
                        "name": "completelyRewritten",
                        "type": "boolean"
                    },
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "QID",
                        "type": "string"
                    },
                    {
                        "name": "GUID",
                        "type": "string"
                    },
                    {
                        "name": "sender",
                        "type": "string"
                    },
                    {
                        "name": "recipient",
                        "type": "dynamic"
                    },
                    {
                        "name": "senderIP",
                        "type": "string"
                    },
                    {
                        "name": "messageID",
                        "type": "string"
                    }
                ]
            },
            "Custom-ProofPointTAPMessagesDeliveredV2_CL": {
                "columns": [
                    {
                        "name": "spamScore",
                        "type": "int"
                    },
                    {
                        "name": "phishScore",
                        "type": "int"
                    },
                    {
                        "name": "threatsInfoMap",
                        "type": "dynamic"
                    },
                    {
                        "name": "messageTime",
                        "type": "datetime"
                    },
                    {
                        "name": "impostorScore",
                        "type": "int"
                    },
                    {
                        "name": "malwareScore",
                        "type": "int"
                    },
                    {
                        "name": "cluster",
                        "type": "string"
                    },
                    {
                        "name": "subject",
                        "type": "string"
                    },
                    {
                        "name": "quarantineFolder",
                        "type": "string"
                    },
                    {
                        "name": "quarantineRule",
                        "type": "string"
                    },
                    {
                        "name": "policyRoutes",
                        "type": "dynamic"
                    },
                    {
                        "name": "modulesRun",
                        "type": "dynamic"
                    },
                    {
                        "name": "messageSize",
                        "type": "int"
                    },
                    {
                        "name": "headerFrom",
                        "type": "string"
                    },
                    {
                        "name": "headerReplyTo",
                        "type": "string"
                    },
                    {
                        "name": "fromAddress",
                        "type": "dynamic"
                    },
                    {
                        "name": "ccAddresses",
                        "type": "dynamic"
                    },
                    {
                        "name": "replyToAddress",
                        "type": "dynamic"
                    },
                    {
                        "name": "toAddresses",
                        "type": "dynamic"
                    },
                    {
                        "name": "xmailer",
                        "type": "dynamic"
                    },
                    {
                        "name": "messageParts",
                        "type": "dynamic"
                    },
                    {
                        "name": "completelyRewritten",
                        "type": "boolean"
                    },
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "QID",
                        "type": "string"
                    },
                    {
                        "name": "GUID",
                        "type": "string"
                    },
                    {
                        "name": "sender",
                        "type": "string"
                    },
                    {
                        "name": "recipient",
                        "type": "dynamic"
                    },
                    {
                        "name": "senderIP",
                        "type": "string"
                    },
                    {
                        "name": "messageID",
                        "type": "string"
                    }
                ]
            },
            "Custom-ProofPointTAPClicksPermittedV2_CL": {
                "columns": [
                    {
                        "name": "url",
                        "type": "string"
                    },
                    {
                        "name": "classification",
                        "type": "string"
                    },
                    {
                        "name": "clickTime",
                        "type": "datetime"
                    },
                    {
                        "name": "threatTime",
                        "type": "datetime"
                    },
                    {
                        "name": "userAgent",
                        "type": "string"
                    },
                    {
                        "name": "campaignId",
                        "type": "string"
                    },
                    {
                        "name": "id",
                        "type": "string"
                    },
                    {
                        "name": "clickIP",
                        "type": "string"
                    },
                    {
                        "name": "sender",
                        "type": "string"
                    },
                    {
                        "name": "recipient",
                        "type": "string"
                    },
                    {
                        "name": "senderIP",
                        "type": "string"
                    },
                    {
                        "name": "GUID",
                        "type": "string"
                    },
                    {
                        "name": "threatID",
                        "type": "string"
                    },
                    {
                        "name": "threatURL",
                        "type": "string"
                    },
                    {
                        "name": "threatStatus",
                        "type": "string"
                    },
                    {
                        "name": "messageID",
                        "type": "string"
                    }
                ]
            }
        },
        "dataSources": {},
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "clv2ws1"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-ProofPointTAPClicksBlockedV2_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated = now()\n",
                "outputStream": "Custom-ProofPointTAPClicksBlockedV2_CL"
            },
            {
                "streams": [
                    "Custom-ProofPointTAPMessagesBlockedV2_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated = now()\n",
                "outputStream": "Custom-ProofPointTAPMessagesBlockedV2_CL"
            },
            {
                "streams": [
                    "Custom-ProofPointTAPMessagesDeliveredV2_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated = now()\n",
                "outputStream": "Custom-ProofPointTAPMessagesDeliveredV2_CL"
            },
            {
                "streams": [
                    "Custom-ProofPointTAPClicksPermittedV2_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated = now()\n",
                "outputStream": "Custom-ProofPointTAPClicksPermittedV2_CL"
            }
        ]
    }
}
]