{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "title": "Team Cymru Scout Live Investigation",
        "description": "This playbook will fetch and ingest IP or Domain Indicator data based on input parameters given in the live investigation dashboard.",
        "prerequisites": [
            "1. Make sure that the TeamCymruScoutCreateIncidentAndNotify playbook is deployed before deploying the TeamCymruScoutLiveInvestigation playbook."
        ],
        "postDeployment": [
            "**a. Authorize connections**",
            "Once deployment is complete, authorize each connection.",
            "1. Go to your logic app → API connections → Select azureloganalyticsdatacollector connection resource",
            "2. Go to General → Edit API connection",
            "3. Enter Workspace ID and Workspace Key of your log analytics workspace.",
            "4. Click Authorize",
            "5. Sign in",
            "6. Click Save",
            "7. Repeat steps for other connections"
        ],
        "lastUpdateTime": "2024-08-13T11:30:09.145Z",
        "entities": ["IP"],
        "tags": [
            "Team Cymru Scout",
            "Live Investigation",
            "IP",
            "Domain"
        ],
        "support": {
            "tier": "community",
            "armtemplate": "Generated from https://github.com/Azure/Azure-Sentinel/tree/master/Tools/Playbook-ARM-Template-Generator"
        },
        "author": {
            "name": "Team Cymru"
        }
    },
    "parameters": {
        "PlaybookName": {
            "defaultValue": "TeamCymruScoutLiveInvestigation",
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Please do not change the playbook name, else you will not get any data for the live investigation dashboard."
            }
        },
        "UserName": {
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Enter username of your Team Cymru Scout account."
            }
        },
        "Password": {
            "minLength": 1,
            "type": "securestring",
            "metadata": {
                "description": "Enter password of your Team Cymru Scout account."
            }
        },
        "BaseURL": {
            "type": "string",
            "minLength": 1,
            "metadata": {
                "description": "Enter Base URL of your Team Cymru Scout account.(e.g. https://scout.cymru.com)"
            }
        },
        "CreateIncidentAndNotifyPlaybookName": {
            "defaultValue": "TeamCymruScoutCreateIncidentAndNotify",
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Enter a playbook name that you have given while the deployment of playbook TeamCymruScoutCreateIncidentAndNotify(e.g. TeamCymruScoutCreateIncidentAndNotify)"
            }
        }
    },
    "variables": {
        "AzureloganalyticsdatacollectorConnectionName": "[concat('Azureloganalyticsdatacollector-', parameters('PlaybookName'))]",
        "RegexmatchingipConnectionName": "[concat('Regexmatchingip-', parameters('PlaybookName'))]"
    },
    "resources": [
        {
            "properties": {
                "provisioningState": "Succeeded",
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        },
                        "password": {
                            "defaultValue": "[trim(parameters('Password'))]",
                            "type": "SecureString"
                        },
                        "username": {
                            "defaultValue": "[trim(parameters('UserName'))]",
                            "type": "String"
                        }
                    },
                    "triggers": {
                        "manual": {
                            "type": "Request",
                            "kind": "Http",
                            "inputs": {
                                "schema": {
                                    "properties": {
                                        "indicator_type": {
                                            "type": "string"
                                        },
                                        "indicator_value": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "actions": {
                        "Condition_To_Verify_Indicator_Type_Is_IP": {
                            "actions": {
                                "Condition_To_Verify_IP_Indicator_Details_Data_Fetched_Successfully": {
                                    "actions": {
                                        "Compose_Identity_Object_To_Add_IP_Address_Property": {
                                            "runAfter": {
                                                "Condition_To_Ingest_Top_Fingerprints_Data_If_It_Is_Not_Null": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Compose",
                                            "inputs": "@setProperty(body('Parse_JSON_For_IP_Indicator_Details_Data')?['identity'], 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                        },
                                        "Compose_Whois_Object_To_Add_IP_Address_Property": {
                                            "runAfter": {
                                                "Send_Identity_Data_To_Log_Analytics_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Compose",
                                            "inputs": "@setProperty(body('Parse_JSON_For_IP_Indicator_Details_Data')?['whois'], 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                        },
                                        "Condition_To_Execute_Sub_Playbook_For_Malicious_IP": {
                                            "actions": {
                                                "Condition_To_Perform_Next_Actions_If_Sub_Playbook_Executes_Successfully": {
                                                    "actions": {},
                                                    "runAfter": {
                                                        "CreateIncidentAndMailForMaliciousIP": [
                                                            "Succeeded",
                                                            "TimedOut",
                                                            "Failed"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Terminate_Due_To_Failure_While_Executing_Sub_Playbook_For_Malicious_IP": {
                                                                "runAfter": {},
                                                                "type": "Terminate",
                                                                "inputs": {
                                                                    "runError": {
                                                                        "code": "400",
                                                                        "message": "@{body('CreateIncidentAndMailForMaliciousIP')}"
                                                                    },
                                                                    "runStatus": "Failed"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "equals": [
                                                                    "@body('CreateIncidentAndMailForMaliciousIP')?['status']",
                                                                    "success"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "CreateIncidentAndMailForMaliciousIP": {
                                                    "runAfter": {},
                                                    "type": "Workflow",
                                                    "inputs": {
                                                        "body": {
                                                            "country_code": "@{body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['geo_ip_cc']}",
                                                            "indicator_value": "@variables('indicator_value')",
                                                            "insights": "@body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['insights']",
                                                            "open_ports": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['top_open_ports']",
                                                            "pdns": "@body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['pdns']?['top_pdns']"
                                                        },
                                                        "host": {
                                                            "triggerName": "manual",
                                                            "workflow": {
                                                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/',resourceGroup().name,'/providers/Microsoft.Logic/workflows/',parameters('CreateIncidentAndNotifyPlaybookName'))]"
                                                            }
                                                        },
                                                        "retryPolicy": {
                                                            "type": "none"
                                                        }
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "Condition_To_Ingest_Proto_By_IP_Sections_Data_If_It_is_Fetched_Successfully": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ],
                                                "Condition_To_Ingest_Top_Asns_By_IP_Sections_Data_If_It_is_Fetched_Successfully": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ],
                                                "Condition_To_Ingest_Top_Country_Codes_By_IP_Data_If_It_is_Fetched_Successfully": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ],
                                                "Condition_To_Ingest_Top_Services_By_IP_Data_If_It_is_Fetched_Successfully": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ],
                                                "Condition_To_Ingest_Top_Tags_By_IP_Sections_Data_If_It_is_Fetched_Successfully": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@toLower(body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['overall_rating'])",
                                                            "malicious"
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Proto_By_IP_Sections_Data_If_It_is_Fetched_Successfully": {
                                            "actions": {
                                                "Parse_JSON_For_Proto_By_IP_Sections_Data": {
                                                    "runAfter": {},
                                                    "type": "ParseJson",
                                                    "inputs": {
                                                        "content": "@body('HTTP_Request_To_Fetch_Proto_By_IP_Sections_Data')",
                                                        "schema": {
                                                            "properties": {
                                                                "end_date": {
                                                                    "type": "string"
                                                                },
                                                                "ip": {
                                                                    "type": "string"
                                                                },
                                                                "proto_by_ip": {
                                                                    "properties": {
                                                                        "data": {
                                                                            "properties": {
                                                                                "dates": {
                                                                                    "items": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "proto_by_date": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "data": {
                                                                                                "items": {
                                                                                                    "properties": {
                                                                                                        "count": {
                                                                                                            "type": "integer"
                                                                                                        },
                                                                                                        "date": {
                                                                                                            "type": "string"
                                                                                                        }
                                                                                                    },
                                                                                                    "required": [
                                                                                                        "count",
                                                                                                        "date"
                                                                                                    ],
                                                                                                    "type": "object"
                                                                                                },
                                                                                                "type": "array"
                                                                                            },
                                                                                            "keyword": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "proto": {
                                                                                                "type": "integer"
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "proto",
                                                                                            "keyword",
                                                                                            "data"
                                                                                        ],
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "protocols": {
                                                                                    "items": {
                                                                                        "type": "integer"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "end_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "ip": {
                                                                            "type": "string"
                                                                        },
                                                                        "request_id": {
                                                                            "type": "string"
                                                                        },
                                                                        "size": {
                                                                            "type": "integer"
                                                                        },
                                                                        "start_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "total": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "request_id": {
                                                                    "type": "string"
                                                                },
                                                                "sections": {
                                                                    "items": {
                                                                        "type": "string"
                                                                    },
                                                                    "type": "array"
                                                                },
                                                                "size": {
                                                                    "type": "integer"
                                                                },
                                                                "start_date": {
                                                                    "type": "string"
                                                                },
                                                                "usage": {
                                                                    "properties": {
                                                                        "foundation_api_usage": {
                                                                            "properties": {
                                                                                "query_limit": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "remaining_queries": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "used_queries": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "query_limit": {
                                                                            "type": "integer"
                                                                        },
                                                                        "remaining_queries": {
                                                                            "type": "integer"
                                                                        },
                                                                        "used_queries": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    }
                                                },
                                                "Send_Proto_By_IP_Sections_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Parse_JSON_For_Proto_By_IP_Sections_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{body('Parse_JSON_For_Proto_By_IP_Sections_Data')?['proto_by_ip']}",
                                                        "headers": {
                                                            "Log-Type": "@variables('proto_by_ip_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "HTTP_Request_To_Fetch_Proto_By_IP_Sections_Data": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "else": {
                                                "actions": {
                                                    "Terminate_Due_To_Failure_While_Fetching_Proto_By_IP_Sections_Data": {
                                                        "runAfter": {},
                                                        "type": "Terminate",
                                                        "inputs": {
                                                            "runError": {
                                                                "code": "@{outputs('HTTP_Request_To_Fetch_Proto_By_IP_Sections_Data')['statusCode']}",
                                                                "message": "@{body('HTTP_Request_To_Fetch_Proto_By_IP_Sections_Data')}"
                                                            },
                                                            "runStatus": "Failed"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@outputs('HTTP_Request_To_Fetch_Proto_By_IP_Sections_Data')['statusCode']",
                                                            200
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Asns_By_IP_Sections_Data_If_It_is_Fetched_Successfully": {
                                            "actions": {
                                                "For_Each_Dataset_Of_Asns": {
                                                    "foreach": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['data']?['datasets']",
                                                    "actions": {
                                                        "Append_Dataset_Object_To_Top_Asns_Data_Array": {
                                                            "runAfter": {
                                                                "Compose_Each_Asns_Dataset_Object_To_Add_Dates_Array_In_It": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "top_asns_data",
                                                                "value": "@outputs('Compose_Each_Asns_Dataset_Object_To_Add_Dates_Array_In_It')"
                                                            }
                                                        },
                                                        "Compose_Each_Asns_Dataset_Object_To_Add_Dates_Array_In_It": {
                                                            "runAfter": {},
                                                            "type": "Compose",
                                                            "inputs": "@setProperty(items('For_Each_Dataset_Of_Asns'), 'dates', body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['data']?['dates'])"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Parse_JSON_For_Top_Asns_By_IP_Sections_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach",
                                                    "runtimeConfiguration": {
                                                        "concurrency": {
                                                            "repetitions": 1
                                                        }
                                                    }
                                                },
                                                "Parse_JSON_For_Top_Asns_By_IP_Sections_Data": {
                                                    "runAfter": {},
                                                    "type": "ParseJson",
                                                    "inputs": {
                                                        "content": "@body('HTTP_Request_To_Fetch_Top_Asns_By_IP_Sections_Data')",
                                                        "schema": {
                                                            "properties": {
                                                                "end_date": {
                                                                    "type": "string"
                                                                },
                                                                "ip": {
                                                                    "type": "string"
                                                                },
                                                                "request_id": {
                                                                    "type": "string"
                                                                },
                                                                "sections": {
                                                                    "items": {
                                                                        "type": "string"
                                                                    },
                                                                    "type": "array"
                                                                },
                                                                "size": {
                                                                    "type": "integer"
                                                                },
                                                                "start_date": {
                                                                    "type": "string"
                                                                },
                                                                "top_asns_by_ip": {
                                                                    "properties": {
                                                                        "data": {
                                                                            "properties": {
                                                                                "datasets": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "css_color": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "data": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "label": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "tag_id": {
                                                                                                "type": "integer"
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "label",
                                                                                            "tag_id",
                                                                                            "data",
                                                                                            "css_color"
                                                                                        ],
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "dates": {
                                                                                    "items": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "end_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "ip": {
                                                                            "type": "string"
                                                                        },
                                                                        "request_id": {
                                                                            "type": "string"
                                                                        },
                                                                        "size": {
                                                                            "type": "integer"
                                                                        },
                                                                        "start_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "total": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "usage": {
                                                                    "properties": {
                                                                        "foundation_api_usage": {
                                                                            "properties": {
                                                                                "query_limit": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "remaining_queries": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "used_queries": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "query_limit": {
                                                                            "type": "integer"
                                                                        },
                                                                        "remaining_queries": {
                                                                            "type": "integer"
                                                                        },
                                                                        "used_queries": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    }
                                                },
                                                "Send_Top_Asns_By_IP_Sections_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Set_Top_Asns_Data_Object": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{variables('top_asns_data_obj')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('top_asns_by_ip_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                },
                                                "Set_Top_Asns_Data_Object": {
                                                    "runAfter": {
                                                        "For_Each_Dataset_Of_Asns": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "top_asns_data_obj",
                                                        "value": {
                                                            "data": {
                                                                "datasets": "@variables('top_asns_data')",
                                                                "dates": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['data']?['dates']"
                                                            },
                                                            "end_date": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['end_date']",
                                                            "ip": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['ip']",
                                                            "request_id": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['request_id']",
                                                            "size": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['size']",
                                                            "start_date": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['start_date']",
                                                            "total": "@body('Parse_JSON_For_Top_Asns_By_IP_Sections_Data')?['top_asns_by_ip']?['total']"
                                                        }
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "HTTP_Request_To_Fetch_Top_Asns_By_IP_Sections_Data": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "else": {
                                                "actions": {
                                                    "Terminate_Due_To_Failure_While_Fetching_Top_Asns_By_IP_Sections_Data": {
                                                        "runAfter": {},
                                                        "type": "Terminate",
                                                        "inputs": {
                                                            "runError": {
                                                                "code": "@{outputs('HTTP_Request_To_Fetch_Top_Asns_By_IP_Sections_Data')['statusCode']}",
                                                                "message": "@{body('HTTP_Request_To_Fetch_Top_Asns_By_IP_Sections_Data')}"
                                                            },
                                                            "runStatus": "Failed"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@outputs('HTTP_Request_To_Fetch_Top_Asns_By_IP_Sections_Data')['statusCode']",
                                                            200
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Certs_Data_If_It_Is_Not_Null": {
                                            "actions": {
                                                "Compose_Object_From_Top_Certs_Data": {
                                                    "runAfter": {
                                                        "For_Each_Top_Certs": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": "@variables('certs_data')"
                                                },
                                                "For_Each_Top_Certs": {
                                                    "foreach": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['certs']?['top_certs']",
                                                    "actions": {
                                                        "Append_IP_Address_To_Top_Certs_Data": {
                                                            "runAfter": {},
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "certs_data",
                                                                "value": "@setProperty(items('For_Each_Top_Certs'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "type": "Foreach"
                                                },
                                                "Send_Top_Certs_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Compose_Object_From_Top_Certs_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{outputs('Compose_Object_From_Top_Certs_Data')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('certs_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "Condition_To_Ingest_Top_Open_Ports_Data_If_It_Is_Not_Null": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "not": {
                                                            "equals": [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['certs']?['top_certs']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Country_Codes_By_IP_Data_If_It_is_Fetched_Successfully": {
                                            "actions": {
                                                "For_Each_Dataset_Of_Country_Codes": {
                                                    "foreach": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['data']?['datasets']",
                                                    "actions": {
                                                        "Append_Dataset_Object_To_Top_Country_Codes_Data_Array": {
                                                            "runAfter": {
                                                                "Compose_Each_Country_Codes_Dataset_Object_To_Add_Dates_Array_In_It": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "top_country_codes_data",
                                                                "value": "@outputs('Compose_Each_Country_Codes_Dataset_Object_To_Add_Dates_Array_In_It')"
                                                            }
                                                        },
                                                        "Compose_Each_Country_Codes_Dataset_Object_To_Add_Dates_Array_In_It": {
                                                            "runAfter": {},
                                                            "type": "Compose",
                                                            "inputs": "@setProperty(items('For_Each_Dataset_Of_Country_Codes'), 'dates', body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['data']?['dates'])"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Parse_JSON_For_Top_Country_Codes_Sections_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach",
                                                    "runtimeConfiguration": {
                                                        "concurrency": {
                                                            "repetitions": 1
                                                        }
                                                    }
                                                },
                                                "Parse_JSON_For_Top_Country_Codes_Sections_Data": {
                                                    "runAfter": {},
                                                    "type": "ParseJson",
                                                    "inputs": {
                                                        "content": "@body('HTTP_Request_To_Fetch_Top_Country_Codes_By_IP_Sections_Data')",
                                                        "schema": {
                                                            "properties": {
                                                                "end_date": {
                                                                    "type": "string"
                                                                },
                                                                "ip": {
                                                                    "type": "string"
                                                                },
                                                                "request_id": {
                                                                    "type": "string"
                                                                },
                                                                "sections": {
                                                                    "items": {
                                                                        "type": "string"
                                                                    },
                                                                    "type": "array"
                                                                },
                                                                "size": {
                                                                    "type": "integer"
                                                                },
                                                                "start_date": {
                                                                    "type": "string"
                                                                },
                                                                "top_country_codes_by_ip": {
                                                                    "properties": {
                                                                        "data": {
                                                                            "properties": {
                                                                                "datasets": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "country": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "css_color": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "data": {
                                                                                                "items": {
                                                                                                    "type": "number"
                                                                                                },
                                                                                                "type": "array"
                                                                                            },
                                                                                            "label": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "tag_id": {
                                                                                                "type": "integer"
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "label",
                                                                                            "tag_id",
                                                                                            "data",
                                                                                            "country",
                                                                                            "css_color"
                                                                                        ],
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "dates": {
                                                                                    "items": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "end_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "ip": {
                                                                            "type": "string"
                                                                        },
                                                                        "request_id": {
                                                                            "type": "string"
                                                                        },
                                                                        "size": {
                                                                            "type": "integer"
                                                                        },
                                                                        "start_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "total": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "usage": {
                                                                    "properties": {
                                                                        "foundation_api_usage": {
                                                                            "properties": {
                                                                                "query_limit": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "remaining_queries": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "used_queries": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "query_limit": {
                                                                            "type": "integer"
                                                                        },
                                                                        "remaining_queries": {
                                                                            "type": "integer"
                                                                        },
                                                                        "used_queries": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    }
                                                },
                                                "Send_Top_Country_Codes_Sections_Data_To_Log_Analytics_Table_Name": {
                                                    "runAfter": {
                                                        "Set_Top_Country_Codes_Data_Object": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{variables('top_country_codes_data_obj')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('top_country_codes_by_ip_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                },
                                                "Set_Top_Country_Codes_Data_Object": {
                                                    "runAfter": {
                                                        "For_Each_Dataset_Of_Country_Codes": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "top_country_codes_data_obj",
                                                        "value": {
                                                            "data": {
                                                                "datasets": "@variables('top_country_codes_data')",
                                                                "dates": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['data']?['dates']"
                                                            },
                                                            "end_date": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['end_date']",
                                                            "ip": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['ip']",
                                                            "request_id": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['request_id']",
                                                            "size": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['size']",
                                                            "start_date": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['start_date']",
                                                            "total": "@body('Parse_JSON_For_Top_Country_Codes_Sections_Data')?['top_country_codes_by_ip']?['total']"
                                                        }
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "HTTP_Request_To_Fetch_Top_Country_Codes_By_IP_Sections_Data": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "else": {
                                                "actions": {
                                                    "Terminate_Due_To_Failure_While_Fetching_Top_Country_Codes_By_IP_Data": {
                                                        "runAfter": {},
                                                        "type": "Terminate",
                                                        "inputs": {
                                                            "runError": {
                                                                "code": "@{outputs('HTTP_Request_To_Fetch_Top_Country_Codes_By_IP_Sections_Data')['statusCode']}",
                                                                "message": "@{body('HTTP_Request_To_Fetch_Top_Country_Codes_By_IP_Sections_Data')}"
                                                            },
                                                            "runStatus": "Failed"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@outputs('HTTP_Request_To_Fetch_Top_Country_Codes_By_IP_Sections_Data')['statusCode']",
                                                            200
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Fingerprints_Data_If_It_Is_Not_Null": {
                                            "actions": {
                                                "Compose_Object_From_Fingerprints_Data": {
                                                    "runAfter": {
                                                        "For_Each_Fingerprint_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": "@variables('fingerprints_data')"
                                                },
                                                "For_Each_Fingerprint_Data": {
                                                    "foreach": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['fingerprints']?['top_fingerprints']",
                                                    "actions": {
                                                        "Append_IP_Address_To_Fingerprints_Data": {
                                                            "runAfter": {},
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "fingerprints_data",
                                                                "value": "@setProperty(items('For_Each_Fingerprint_Data'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "type": "Foreach"
                                                },
                                                "Send_Top_Fingerprints_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Compose_Object_From_Fingerprints_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{outputs('Compose_Object_From_Fingerprints_Data')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('fingerprints_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "Condition_To_Ingest_Top_Certs_Data_If_It_Is_Not_Null": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "not": {
                                                            "equals": [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['fingerprints']?['top_fingerprints']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Open_Ports_Data_If_It_Is_Not_Null": {
                                            "actions": {
                                                "Compose_An_Object_From_Top_Open_Ports_Data": {
                                                    "runAfter": {
                                                        "For_Each_Top_Open_Ports_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": "@variables('open_ports_data')"
                                                },
                                                "For_Each_Top_Open_Ports_Data": {
                                                    "foreach": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['top_open_ports']",
                                                    "actions": {
                                                        "Append_IP_Address_To_Top_Open_Ports_Data": {
                                                            "runAfter": {},
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "open_ports_data",
                                                                "value": "@setProperty(items('For_Each_Top_Open_Ports_Data'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "type": "Foreach"
                                                },
                                                "Send_Open_Ports_Section_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Compose_An_Object_From_Top_Open_Ports_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{outputs('Compose_An_Object_From_Top_Open_Ports_Data')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('open_ports_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "Condition_To_Ingest_Top_Pdns_Data_If_It_Is_Not_Null": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "not": {
                                                            "equals": [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['top_open_ports']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Pdns_Data_If_It_Is_Not_Null": {
                                            "actions": {
                                                "Compose_An_Object_From_Top_Pdns_Data": {
                                                    "runAfter": {
                                                        "For_Each_Pdns": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": "@variables('pdns_data')"
                                                },
                                                "For_Each_Pdns": {
                                                    "foreach": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['pdns']?['top_pdns']",
                                                    "actions": {
                                                        "Append_IP_Address_To_Every_Pdns_Object": {
                                                            "runAfter": {},
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "pdns_data",
                                                                "value": "@setProperty(items('For_Each_Pdns'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "type": "Foreach"
                                                },
                                                "Send_Top_Pdns_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Compose_An_Object_From_Top_Pdns_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{outputs('Compose_An_Object_From_Top_Pdns_Data')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('pdns_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "Parse_JSON_For_IP_Indicator_Details_Data": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "not": {
                                                            "equals": [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['pdns']?['top_pdns']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Services_By_IP_Data_If_It_is_Fetched_Successfully": {
                                            "actions": {
                                                "For_Each_Dataset_Of_Services": {
                                                    "foreach": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['data']?['datasets']",
                                                    "actions": {
                                                        "Append_Dataset_Object_To_Top_Services_Data_Array": {
                                                            "runAfter": {
                                                                "Compose_Each_Services_Dataset_Object_To_Add_Dates_Array_In_It": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "top_services_data",
                                                                "value": "@outputs('Compose_Each_Services_Dataset_Object_To_Add_Dates_Array_In_It')"
                                                            }
                                                        },
                                                        "Compose_Each_Services_Dataset_Object_To_Add_Dates_Array_In_It": {
                                                            "runAfter": {},
                                                            "type": "Compose",
                                                            "inputs": "@setProperty(items('For_Each_Dataset_Of_Services'), 'dates', body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['data']?['dates'])"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Parse_JSON_For_Top_Services_By_IP_Sections_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach",
                                                    "runtimeConfiguration": {
                                                        "concurrency": {
                                                            "repetitions": 1
                                                        }
                                                    }
                                                },
                                                "Parse_JSON_For_Top_Services_By_IP_Sections_Data": {
                                                    "runAfter": {},
                                                    "type": "ParseJson",
                                                    "inputs": {
                                                        "content": "@body('HTTP_Request_To_Fetch_Top_Services_By_IP_Sections_Data')",
                                                        "schema": {
                                                            "properties": {
                                                                "end_date": {
                                                                    "type": "string"
                                                                },
                                                                "ip": {
                                                                    "type": "string"
                                                                },
                                                                "request_id": {
                                                                    "type": "string"
                                                                },
                                                                "sections": {
                                                                    "items": {
                                                                        "type": "string"
                                                                    },
                                                                    "type": "array"
                                                                },
                                                                "size": {
                                                                    "type": "integer"
                                                                },
                                                                "start_date": {
                                                                    "type": "string"
                                                                },
                                                                "top_services_by_ip": {
                                                                    "properties": {
                                                                        "data": {
                                                                            "properties": {
                                                                                "datasets": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "css_color": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "data": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "label": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "tag_id": {
                                                                                                "type": "integer"
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "label",
                                                                                            "tag_id",
                                                                                            "data",
                                                                                            "css_color"
                                                                                        ],
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "dates": {
                                                                                    "items": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "end_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "ip": {
                                                                            "type": "string"
                                                                        },
                                                                        "request_id": {
                                                                            "type": "string"
                                                                        },
                                                                        "size": {
                                                                            "type": "integer"
                                                                        },
                                                                        "start_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "total": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "usage": {
                                                                    "properties": {
                                                                        "foundation_api_usage": {
                                                                            "properties": {
                                                                                "query_limit": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "remaining_queries": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "used_queries": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "query_limit": {
                                                                            "type": "integer"
                                                                        },
                                                                        "remaining_queries": {
                                                                            "type": "integer"
                                                                        },
                                                                        "used_queries": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    }
                                                },
                                                "Send_Top_Services_By_IP_Sections_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Set_Top_Services_Data_Object": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{variables('top_services_data_obj')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('top_services_by_ip_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                },
                                                "Set_Top_Services_Data_Object": {
                                                    "runAfter": {
                                                        "For_Each_Dataset_Of_Services": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "top_services_data_obj",
                                                        "value": {
                                                            "data": {
                                                                "datasets": "@variables('top_services_data')",
                                                                "dates": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['data']?['dates']"
                                                            },
                                                            "end_date": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['end_date']",
                                                            "ip": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['ip']",
                                                            "request_id": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['request_id']",
                                                            "size": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['size']",
                                                            "start_date": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['start_date']",
                                                            "total": "@body('Parse_JSON_For_Top_Services_By_IP_Sections_Data')?['top_services_by_ip']?['total']"
                                                        }
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "HTTP_Request_To_Fetch_Top_Services_By_IP_Sections_Data": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "else": {
                                                "actions": {
                                                    "Terminate_Due_To_Failure_While_Fetching_Top_Services_By_IP_Sections_Data": {
                                                        "runAfter": {},
                                                        "type": "Terminate",
                                                        "inputs": {
                                                            "runError": {
                                                                "code": "@{outputs('HTTP_Request_To_Fetch_Top_Services_By_IP_Sections_Data')['statusCode']}",
                                                                "message": "@{body('HTTP_Request_To_Fetch_Top_Services_By_IP_Sections_Data')}"
                                                            },
                                                            "runStatus": "Failed"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@outputs('HTTP_Request_To_Fetch_Top_Services_By_IP_Sections_Data')['statusCode']",
                                                            200
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Condition_To_Ingest_Top_Tags_By_IP_Sections_Data_If_It_is_Fetched_Successfully": {
                                            "actions": {
                                                "For_Each_Dataset_Of_Tags": {
                                                    "foreach": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['data']?['datasets']",
                                                    "actions": {
                                                        "Append_Dataset_Object_To_Top_Tags_Data_Array": {
                                                            "runAfter": {
                                                                "Compose_Each_Tags_Dataset_Object_To_Add_Dates_Array_In_It": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "top_tags_data",
                                                                "value": "@outputs('Compose_Each_Tags_Dataset_Object_To_Add_Dates_Array_In_It')"
                                                            }
                                                        },
                                                        "Compose_Each_Tags_Dataset_Object_To_Add_Dates_Array_In_It": {
                                                            "runAfter": {},
                                                            "type": "Compose",
                                                            "inputs": "@setProperty(items('For_Each_Dataset_Of_Tags'), 'dates', body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['data']?['dates'])"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Parse_JSON_For_Top_Tags_By_IP_Sections_Data": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach",
                                                    "runtimeConfiguration": {
                                                        "concurrency": {
                                                            "repetitions": 1
                                                        }
                                                    }
                                                },
                                                "Parse_JSON_For_Top_Tags_By_IP_Sections_Data": {
                                                    "runAfter": {},
                                                    "type": "ParseJson",
                                                    "inputs": {
                                                        "content": "@body('HTTP_Request_To_Fetch_Top_Tags_By_IP_Sections_Data')",
                                                        "schema": {
                                                            "properties": {
                                                                "end_date": {
                                                                    "type": "string"
                                                                },
                                                                "ip": {
                                                                    "type": "string"
                                                                },
                                                                "request_id": {
                                                                    "type": "string"
                                                                },
                                                                "sections": {
                                                                    "items": {
                                                                        "type": "string"
                                                                    },
                                                                    "type": "array"
                                                                },
                                                                "size": {
                                                                    "type": "integer"
                                                                },
                                                                "start_date": {
                                                                    "type": "string"
                                                                },
                                                                "top_tags_by_ip": {
                                                                    "properties": {
                                                                        "data": {
                                                                            "properties": {
                                                                                "datasets": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "css_color": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "data": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "label": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "tag_id": {
                                                                                                "type": "integer"
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "label",
                                                                                            "tag_id",
                                                                                            "data",
                                                                                            "css_color"
                                                                                        ],
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "dates": {
                                                                                    "items": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "end_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "ip": {
                                                                            "type": "string"
                                                                        },
                                                                        "request_id": {
                                                                            "type": "string"
                                                                        },
                                                                        "size": {
                                                                            "type": "integer"
                                                                        },
                                                                        "start_date": {
                                                                            "type": "string"
                                                                        },
                                                                        "total": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "usage": {
                                                                    "properties": {
                                                                        "foundation_api_usage": {
                                                                            "properties": {
                                                                                "query_limit": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "remaining_queries": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "used_queries": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "query_limit": {
                                                                            "type": "integer"
                                                                        },
                                                                        "remaining_queries": {
                                                                            "type": "integer"
                                                                        },
                                                                        "used_queries": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    }
                                                },
                                                "Send_Top_Tags_By_IP_Sections_Data_To_Log_Analytics_Table": {
                                                    "runAfter": {
                                                        "Set_Top_Tags_Data_Object": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": "@{variables('top_tags_data_obj')}",
                                                        "headers": {
                                                            "Log-Type": "@variables('top_tags_by_ip_table_name')"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/api/logs"
                                                    }
                                                },
                                                "Set_Top_Tags_Data_Object": {
                                                    "runAfter": {
                                                        "For_Each_Dataset_Of_Tags": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "top_tags_data_obj",
                                                        "value": {
                                                            "data": {
                                                                "datasets": "@variables('top_tags_data')",
                                                                "dates": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['data']?['dates']"
                                                            },
                                                            "end_date": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['end_date']",
                                                            "ip": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['ip']",
                                                            "request_id": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['request_id']",
                                                            "size": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['size']",
                                                            "start_date": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['start_date']",
                                                            "total": "@body('Parse_JSON_For_Top_Tags_By_IP_Sections_Data')?['top_tags_by_ip']?['total']"
                                                        }
                                                    }
                                                }
                                            },
                                            "runAfter": {
                                                "HTTP_Request_To_Fetch_Top_Tags_By_IP_Sections_Data": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "else": {
                                                "actions": {
                                                    "Terminate_Due_To_Failure_While_Fetching_Top_Tags_By_IP_Sections_Data": {
                                                        "runAfter": {},
                                                        "type": "Terminate",
                                                        "inputs": {
                                                            "runError": {
                                                                "code": "@{outputs('HTTP_Request_To_Fetch_Top_Tags_By_IP_Sections_Data')['statusCode']}",
                                                                "message": "@{body('HTTP_Request_To_Fetch_Top_Tags_By_IP_Sections_Data')}"
                                                            },
                                                            "runStatus": "Failed"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@outputs('HTTP_Request_To_Fetch_Top_Tags_By_IP_Sections_Data')['statusCode']",
                                                            200
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "HTTP_Request_To_Fetch_Proto_By_IP_Sections_Data": {
                                            "runAfter": {
                                                "Send_IP_Indicator_Data_To_IP_Details_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "authentication": {
                                                    "password": "@parameters('password')",
                                                    "type": "Basic",
                                                    "username": "@variables('username')"
                                                },
                                                "method": "GET",
                                                "queries": {
                                                    "sections": "proto_by_ip"
                                                },
                                                "uri": "@{variables('base_url')}/api/scout/ip/@{variables('indicator_value')}/details"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs",
                                                        "outputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "HTTP_Request_To_Fetch_Top_Asns_By_IP_Sections_Data": {
                                            "runAfter": {
                                                "Send_IP_Indicator_Data_To_IP_Details_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "authentication": {
                                                    "password": "@parameters('password')",
                                                    "type": "Basic",
                                                    "username": "@variables('username')"
                                                },
                                                "method": "GET",
                                                "queries": {
                                                    "sections": "top_asns_by_ip"
                                                },
                                                "uri": "@{variables('base_url')}/api/scout/ip/@{variables('indicator_value')}/details"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs",
                                                        "outputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "HTTP_Request_To_Fetch_Top_Country_Codes_By_IP_Sections_Data": {
                                            "runAfter": {
                                                "Send_IP_Indicator_Data_To_IP_Details_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "authentication": {
                                                    "password": "@parameters('password')",
                                                    "type": "Basic",
                                                    "username": "@variables('username')"
                                                },
                                                "method": "GET",
                                                "queries": {
                                                    "sections": "top_country_codes_by_ip"
                                                },
                                                "uri": "@{variables('base_url')}/api/scout/ip/@{variables('indicator_value')}/details"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs",
                                                        "outputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "HTTP_Request_To_Fetch_Top_Services_By_IP_Sections_Data": {
                                            "runAfter": {
                                                "Send_IP_Indicator_Data_To_IP_Details_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "authentication": {
                                                    "password": "@parameters('password')",
                                                    "type": "Basic",
                                                    "username": "@variables('username')"
                                                },
                                                "method": "GET",
                                                "queries": {
                                                    "sections": "top_services_by_ip"
                                                },
                                                "uri": "@{variables('base_url')}/api/scout/ip/@{variables('indicator_value')}/details"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs",
                                                        "outputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "HTTP_Request_To_Fetch_Top_Tags_By_IP_Sections_Data": {
                                            "runAfter": {
                                                "Send_IP_Indicator_Data_To_IP_Details_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "authentication": {
                                                    "password": "@parameters('password')",
                                                    "type": "Basic",
                                                    "username": "@variables('username')"
                                                },
                                                "method": "GET",
                                                "queries": {
                                                    "sections": "top_tags_by_ip"
                                                },
                                                "uri": "@{variables('base_url')}/api/scout/ip/@{variables('indicator_value')}/details"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs",
                                                        "outputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "Parse_JSON_For_IP_Indicator_Details_Data": {
                                            "runAfter": {},
                                            "type": "ParseJson",
                                            "inputs": {
                                                "content": "@body('HTTP_Request_To_Fetch_Details_Of_IP_Indicator')",
                                                "schema": {
                                                    "properties": {
                                                        "communications": {
                                                            "properties": {
                                                                "event_count": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "peers": {
                                                                    "items": {
                                                                        "properties": {
                                                                            "event_count": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "local": {
                                                                                "properties": {
                                                                                    "as_info": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "as_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "asn": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "asn",
                                                                                                "as_name"
                                                                                            ],
                                                                                            "type": [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "country_codes": {
                                                                                        "items": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "ip": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "max_port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "min_port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "tags": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "children": {
                                                                                                    "items": {
                                                                                                        "properties": {
                                                                                                            "children": {},
                                                                                                            "id": {
                                                                                                                "type": [
                                                                                                                    "integer",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            },
                                                                                                            "name": {
                                                                                                                "type": [
                                                                                                                    "string",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            }
                                                                                                        },
                                                                                                        "required": [
                                                                                                            "id",
                                                                                                            "name",
                                                                                                            "children"
                                                                                                        ],
                                                                                                        "type": [
                                                                                                            "object",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "type": [
                                                                                                        "array",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "id": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "id",
                                                                                                "name",
                                                                                                "children"
                                                                                            ],
                                                                                            "type": [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "top_services": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "description": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "port": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "proto_number": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "service_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "service_name",
                                                                                                "port",
                                                                                                "proto_number",
                                                                                                "description"
                                                                                            ],
                                                                                            "type": [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "unique_ports": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "peer": {
                                                                                "properties": {
                                                                                    "as_info": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "as_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "asn": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "asn",
                                                                                                "as_name"
                                                                                            ],
                                                                                            "type": [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "country_codes": {
                                                                                        "items": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "ip": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "max_port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "min_port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "tags": {},
                                                                                    "top_services": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "description": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "port": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "proto_number": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "service_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "service_name",
                                                                                                "port",
                                                                                                "proto_number",
                                                                                                "description"
                                                                                            ],
                                                                                            "type": [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type": [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "unique_ports": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "proto": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "proto_text": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "proto",
                                                                            "proto_text",
                                                                            "local",
                                                                            "peer",
                                                                            "event_count",
                                                                            "first_seen",
                                                                            "last_seen"
                                                                        ],
                                                                        "type": [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type": [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "end_date": {
                                                            "type": [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "fingerprints": {
                                                            "properties": {
                                                                "event_count": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "fingerprints": {
                                                                    "items": {
                                                                        "properties": {
                                                                            "active_days": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "distinct_ips": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "event_count": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "fingerprint": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "port": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "ip",
                                                                            "type",
                                                                            "fingerprint",
                                                                            "port",
                                                                            "first_seen",
                                                                            "last_seen",
                                                                            "distinct_ips",
                                                                            "active_days",
                                                                            "event_count"
                                                                        ],
                                                                        "type": [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type": [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "identity": {
                                                            "properties": {
                                                                "as_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "asn": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "net_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "reverse_hostnames": {},
                                                                "tags": {}
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "ip": {
                                                            "type": [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "open_ports": {
                                                            "properties": {
                                                                "event_count": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "open_ports": {
                                                                    "items": {
                                                                        "properties": {
                                                                            "as_info": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "as_name": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "asn": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "asn",
                                                                                        "as_name"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "banner": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "banner_sha1": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "country_codes": {
                                                                                "items": {
                                                                                    "type": [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "event_count": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "port": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "protocol": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "protocol_text": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "service": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "tags": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "children": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "children": {},
                                                                                                    "id": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "name": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "id",
                                                                                                    "name",
                                                                                                    "children"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "id": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "name": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "id",
                                                                                        "name",
                                                                                        "children"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "ip",
                                                                            "port",
                                                                            "protocol",
                                                                            "protocol_text",
                                                                            "service",
                                                                            "banner",
                                                                            "banner_sha1",
                                                                            "first_seen",
                                                                            "last_seen",
                                                                            "country_codes",
                                                                            "as_info",
                                                                            "tags",
                                                                            "event_count"
                                                                        ],
                                                                        "type": [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type": [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "unique_ports": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "pdns": {
                                                            "properties": {
                                                                "event_count": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "pdns": {
                                                                    "items": {
                                                                        "properties": {
                                                                            "active_days": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "as_info": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "as_name": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "asn": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "asn",
                                                                                        "as_name"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "country_codes": {
                                                                                "items": {
                                                                                    "type": [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "distinct_ips": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "domain": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "domain_created": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "domain_expires": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "event_count": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "nameservers": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "nameservers": {
                                                                                            "items": {
                                                                                                "type": [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "root": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "root",
                                                                                        "nameservers"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "registrar": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "root": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "tags": {},
                                                                            "tld": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "ip",
                                                                            "domain",
                                                                            "root",
                                                                            "tld",
                                                                            "type",
                                                                            "registrar",
                                                                            "domain_created",
                                                                            "domain_expires",
                                                                            "nameservers",
                                                                            "country_codes",
                                                                            "as_info",
                                                                            "tags",
                                                                            "distinct_ips",
                                                                            "active_days",
                                                                            "event_count",
                                                                            "first_seen",
                                                                            "last_seen"
                                                                        ],
                                                                        "type": [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type": [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "request_id": {
                                                            "type": [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "sections": {
                                                            "items": {
                                                                "type": [
                                                                    "string",
                                                                    "null"
                                                                ]
                                                            },
                                                            "type": [
                                                                "array",
                                                                "null"
                                                            ]
                                                        },
                                                        "size": {
                                                            "type": [
                                                                "integer",
                                                                "null"
                                                            ]
                                                        },
                                                        "start_date": {
                                                            "type": [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "summary": {
                                                            "properties": {
                                                                "bgp_asn": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "bgp_asname": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "certs": {
                                                                    "properties": {
                                                                        "top_certs": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "common_name": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "css_color": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "issuer": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "issuer_common_name": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "md5": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "not_after": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "not_before": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "self_signed": {
                                                                                        "type": "boolean"
                                                                                    },
                                                                                    "sha1": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "sha256": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "subject": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "valid_days": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required": [
                                                                                    "issuer",
                                                                                    "issuer_common_name",
                                                                                    "common_name",
                                                                                    "subject",
                                                                                    "port",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "self_signed",
                                                                                    "not_before",
                                                                                    "not_after",
                                                                                    "valid_days",
                                                                                    "md5",
                                                                                    "sha1",
                                                                                    "sha256",
                                                                                    "css_color"
                                                                                ],
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "end_date": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "fingerprints": {
                                                                    "properties": {
                                                                        "top_fingerprints": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "count": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "signature": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "type": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required": [
                                                                                    "type",
                                                                                    "signature",
                                                                                    "port",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "count"
                                                                                ],
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "geo_ip_cc": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "insights": {
                                                                    "properties": {
                                                                        "insights": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "message": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "rating": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required": [
                                                                                    "rating",
                                                                                    "message"
                                                                                ],
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "overall_rating": {
                                                                            "type": [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "total": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "ip": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "open_ports": {
                                                                    "properties": {
                                                                        "top_open_ports": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "css_color": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "event_count": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "inferred_service_name": {},
                                                                                    "last_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "port": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "protocol": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "protocol_text": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "service": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required": [
                                                                                    "event_count",
                                                                                    "port",
                                                                                    "protocol",
                                                                                    "protocol_text",
                                                                                    "service",
                                                                                    "inferred_service_name",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "css_color"
                                                                                ],
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "total": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "unique_ports": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "pdns": {
                                                                    "properties": {
                                                                        "top_pdns": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "css_color": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "domain": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "event_count": {
                                                                                        "type": [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required": [
                                                                                    "event_count",
                                                                                    "domain",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "css_color"
                                                                                ],
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "total": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "reverse_hostnames": {},
                                                                "start_date": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tag_timeline": {
                                                                    "properties": {
                                                                        "data": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "first_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "tag": {
                                                                                        "properties": {
                                                                                            "css_color": {
                                                                                                "type": [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "description": {
                                                                                                "type": [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "id": {
                                                                                                "type": [
                                                                                                    "integer",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "name": {
                                                                                                "type": [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "parent_ids": {},
                                                                                            "parents": {}
                                                                                        },
                                                                                        "type": [
                                                                                            "object",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required": [
                                                                                    "tag",
                                                                                    "first_seen",
                                                                                    "last_seen"
                                                                                ],
                                                                                "type": [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type": [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tags": {
                                                                    "items": {
                                                                        "properties": {
                                                                            "children": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "children": {},
                                                                                        "id": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "name": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "id",
                                                                                        "name",
                                                                                        "children"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "id": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "name": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "id",
                                                                            "name",
                                                                            "children"
                                                                        ],
                                                                        "type": [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type": [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "total": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "whois": {
                                                                    "properties": {
                                                                        "as_name": {
                                                                            "type": [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "asn": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "net_name": {
                                                                            "type": [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "org_name": {
                                                                            "type": [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "usage": {
                                                            "properties": {
                                                                "foundation_api_usage": {
                                                                    "properties": {
                                                                        "query_limit": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "remaining_queries": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "used_queries": {
                                                                            "type": [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type": [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "query_limit": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "remaining_queries": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "used_queries": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "whois": {
                                                            "properties": {
                                                                "about_contact_address": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_city": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_country": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_person": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_phone": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_role": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "abuse_contact_id": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "address": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_address": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_city": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_country": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_id": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_person": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_phone": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_role": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "as_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "asn": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "bgp_asn": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "bgp_asn_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "cc": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "cidr": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "city": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "description": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "mnt_by_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "mnt_lower_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "mnt_router_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "modified": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "net_handle": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "net_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_address": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_city": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_country": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_id": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_name": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_phone": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_address": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_city": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_country": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_email": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_id": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_person": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_phone": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_role": {
                                                                    "type": [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "x509": {
                                                            "properties": {
                                                                "event_count": {
                                                                    "type": [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "x509": {
                                                                    "items": {
                                                                        "properties": {
                                                                            "altnames": {
                                                                                "items": {
                                                                                    "type": [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "as_info": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "as_name": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "asn": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "asn",
                                                                                        "as_name"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "common_name": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "count": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "country_codes": {
                                                                                "items": {
                                                                                    "type": [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "issuer": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "issuer_common_name": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "md5": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "not_after": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "not_before": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "port": {
                                                                                "type": [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "self_signed": {
                                                                                "type": "boolean"
                                                                            },
                                                                            "serial": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "sha1": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "sha256": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "subject": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "tags": {
                                                                                "items": {
                                                                                    "properties": {
                                                                                        "children": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "children": {},
                                                                                                    "id": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "name": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "id",
                                                                                                    "name",
                                                                                                    "children"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "id": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "name": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required": [
                                                                                        "id",
                                                                                        "name",
                                                                                        "children"
                                                                                    ],
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type": [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "validity_period": {
                                                                                "type": [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "ip",
                                                                            "issuer",
                                                                            "issuer_common_name",
                                                                            "common_name",
                                                                            "altnames",
                                                                            "serial",
                                                                            "subject",
                                                                            "not_after",
                                                                            "not_before",
                                                                            "validity_period",
                                                                            "md5",
                                                                            "sha1",
                                                                            "sha256",
                                                                            "first_seen",
                                                                            "last_seen",
                                                                            "port",
                                                                            "self_signed",
                                                                            "country_codes",
                                                                            "as_info",
                                                                            "tags",
                                                                            "count"
                                                                        ],
                                                                        "type": [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type": [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type": [
                                                                "object",
                                                                "null"
                                                            ]
                                                        }
                                                    },
                                                    "type": [
                                                        "object",
                                                        "null"
                                                    ]
                                                }
                                            }
                                        },
                                        "Send_IP_Indicator_Data_To_IP_Details_Table": {
                                            "runAfter": {
                                                "Set_Summary_Details_Data_Object": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": "@{variables('summary_table_data')}",
                                                "headers": {
                                                    "Log-Type": "@variables('summary_details_table_name')"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/api/logs"
                                            }
                                        },
                                        "Send_Identity_Data_To_Log_Analytics_Table": {
                                            "runAfter": {
                                                "Compose_Identity_Object_To_Add_IP_Address_Property": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": "@{outputs('Compose_Identity_Object_To_Add_IP_Address_Property')}",
                                                "headers": {
                                                    "Log-Type": "@variables('identity_table_name')"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/api/logs"
                                            }
                                        },
                                        "Send_Whois_Data_To_Log_Analytics_Workspace": {
                                            "runAfter": {
                                                "Compose_Whois_Object_To_Add_IP_Address_Property": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": "@{outputs('Compose_Whois_Object_To_Add_IP_Address_Property')}",
                                                "headers": {
                                                    "Log-Type": "@variables('whois_table_name')"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/api/logs"
                                            }
                                        },
                                        "Set_Summary_Details_Data_Object": {
                                            "runAfter": {
                                                "Send_Whois_Data_To_Log_Analytics_Workspace": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "summary_table_data",
                                                "value": {
                                                    "bgp_asn": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['bgp_asn']",
                                                    "bgp_asname": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['bgp_asname']",
                                                    "certs": {
                                                        "top_certs": "@null"
                                                    },
                                                    "end_date": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['end_date']",
                                                    "fingerprints": {
                                                        "top_fingerprints": "@null"
                                                    },
                                                    "geo_ip_cc": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['geo_ip_cc']",
                                                    "insights": {
                                                        "insights": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['insights']",
                                                        "overall_rating": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['overall_rating']",
                                                        "total": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['total']"
                                                    },
                                                    "ip": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip']",
                                                    "open_ports": {
                                                        "top_open_ports": "@null",
                                                        "total": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['total']",
                                                        "unique_ports": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['unique_ports']"
                                                    },
                                                    "pdns": {
                                                        "top_pdns": "@null",
                                                        "total": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['pdns']?['total']"
                                                    },
                                                    "reverse_hostnames": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['reverse_hostnames']",
                                                    "start_date": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['start_date']",
                                                    "tag_timeline": {
                                                        "data": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['tag_timeline']?['data']"
                                                    },
                                                    "tags": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['tags']",
                                                    "total": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['total']",
                                                    "whois": {
                                                        "as_name": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['whois']?['as_name']",
                                                        "asn": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['whois']?['asn']",
                                                        "net_name": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['whois']?['net_name']",
                                                        "org_name": "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['whois']?['org_name']"
                                                    }
                                                }
                                            }
                                        },
                                        "Terminate_Due_To_Successfully_Ingested_Data_Into_Log_Analytics_Workspace": {
                                            "runAfter": {
                                                "Condition_To_Execute_Sub_Playbook_For_Malicious_IP": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Terminate",
                                            "inputs": {
                                                "runStatus": "Succeeded"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "HTTP_Request_To_Fetch_Details_Of_IP_Indicator": [
                                            "Succeeded",
                                            "TimedOut",
                                            "Failed"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Terminate_Due_To_Error_While_Fetching_IP_Indicator_Details_Data": {
                                                "runAfter": {},
                                                "type": "Terminate",
                                                "inputs": {
                                                    "runError": {
                                                        "code": "@{outputs('HTTP_Request_To_Fetch_Details_Of_IP_Indicator')['statusCode']}",
                                                        "message": "@{body('HTTP_Request_To_Fetch_Details_Of_IP_Indicator')}"
                                                    },
                                                    "runStatus": "Failed"
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "and": [
                                            {
                                                "equals": [
                                                    "@outputs('HTTP_Request_To_Fetch_Details_Of_IP_Indicator')['statusCode']",
                                                    200
                                                ]
                                            }
                                        ]
                                    },
                                    "type": "If"
                                },
                                "HTTP_Request_To_Fetch_Details_Of_IP_Indicator": {
                                    "runAfter": {},
                                    "type": "Http",
                                    "inputs": {
                                        "authentication": {
                                            "password": "@parameters('password')",
                                            "type": "Basic",
                                            "username": "@variables('username')"
                                        },
                                        "method": "GET",
                                        "uri": "@{variables('base_url')}/api/scout/ip/@{variables('indicator_value')}/details"
                                    },
                                    "runtimeConfiguration": {
                                        "secureData": {
                                            "properties": [
                                                "inputs",
                                                "outputs"
                                            ]
                                        }
                                    }
                                }
                            },
                            "runAfter": {
                                "Initialize_Top_Tags_By_IP_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "else": {
                                "actions": {
                                    "Condition_To_Fetch_Data_If_Domain_is_Valid": {
                                        "actions": {
                                            "Condition_To_Verify_Domain_Indicator_Details_Data_Fetched_Successfully": {
                                                "actions": {
                                                    "Compose_An_Object_From_Array_Of_Ips": {
                                                        "runAfter": {
                                                            "For_Each_IPs": [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type": "Compose",
                                                        "inputs": "@variables('domain_data')"
                                                    },
                                                    "Condition_To_Terminate_If_No_Data_Found_For_Domain": {
                                                        "actions": {
                                                            "Terminate_Due_To_No_Data_Found_For_Domain": {
                                                                "runAfter": {},
                                                                "type": "Terminate",
                                                                "inputs": {
                                                                    "runStatus": "Succeeded"
                                                                }
                                                            }
                                                        },
                                                        "runAfter": {
                                                            "Parse_JSON_For_Domain_Data": [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "expression": {
                                                            "and": [
                                                                {
                                                                    "equals": [
                                                                        "@body('Parse_JSON_For_Domain_Data')?['ips']",
                                                                        "@null"
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        "type": "If"
                                                    },
                                                    "For_Each_IPs": {
                                                        "foreach": "@body('Parse_JSON_For_Domain_Data')?['ips']",
                                                        "actions": {
                                                            "Append_Query_To_Each_IPs_Data": {
                                                                "runAfter": {},
                                                                "type": "AppendToArrayVariable",
                                                                "inputs": {
                                                                    "name": "domain_data",
                                                                    "value": "@setProperty(items('For_Each_IPs'), 'query', body('Parse_JSON_For_Domain_Data')?['query'])"
                                                                }
                                                            }
                                                        },
                                                        "runAfter": {
                                                            "Condition_To_Terminate_If_No_Data_Found_For_Domain": [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type": "Foreach"
                                                    },
                                                    "Parse_JSON_For_Domain_Data": {
                                                        "runAfter": {},
                                                        "type": "ParseJson",
                                                        "inputs": {
                                                            "content": "@body('HTTP_Request_To_Fetch_Details_Of_Domain_Indicator')",
                                                            "schema": {
                                                                "properties": {
                                                                    "end_date": {
                                                                        "type": [
                                                                            "string",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "ips": {
                                                                        "items": {
                                                                            "properties": {
                                                                                "as_info": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "as_name": {
                                                                                                "type": [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "asn": {
                                                                                                "type": [
                                                                                                    "integer",
                                                                                                    "null"
                                                                                                ]
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "asn",
                                                                                            "as_name"
                                                                                        ],
                                                                                        "type": [
                                                                                            "object",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "type": [
                                                                                        "array",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "country_codes": {
                                                                                    "items": {
                                                                                        "type": [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "type": [
                                                                                        "array",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "event_count": {
                                                                                    "type": [
                                                                                        "integer",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "ip": {
                                                                                    "type": [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "summary": {
                                                                                    "properties": {
                                                                                        "certs": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "common_name": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "event_count": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "ip": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "issuer": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "issuer_common_name": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "port": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "ip",
                                                                                                    "issuer",
                                                                                                    "issuer_common_name",
                                                                                                    "common_name",
                                                                                                    "port",
                                                                                                    "event_count"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "comms_total": {
                                                                                            "type": [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "fingerprints": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "event_count": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "ip": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "signature": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "type": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "ip",
                                                                                                    "type",
                                                                                                    "signature",
                                                                                                    "event_count"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "last_seen": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "open_ports": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "event_count": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "ip": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "port": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "protocol": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "protocol_text": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "service": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "ip",
                                                                                                    "port",
                                                                                                    "protocol",
                                                                                                    "protocol_text",
                                                                                                    "service",
                                                                                                    "event_count"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "pdns": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "domain": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "event_count": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "ip": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "ip",
                                                                                                    "domain",
                                                                                                    "event_count"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "service_counts": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "event_count": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "port": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "proto": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "proto_text": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "service": {
                                                                                                        "properties": {
                                                                                                            "description": {
                                                                                                                "type": [
                                                                                                                    "string",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            },
                                                                                                            "port": {
                                                                                                                "type": [
                                                                                                                    "integer",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            },
                                                                                                            "proto_number": {
                                                                                                                "type": [
                                                                                                                    "integer",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            },
                                                                                                            "service_name": {
                                                                                                                "type": [
                                                                                                                    "string",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            }
                                                                                                        },
                                                                                                        "type": [
                                                                                                            "object",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "proto",
                                                                                                    "proto_text",
                                                                                                    "port",
                                                                                                    "event_count",
                                                                                                    "service"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "top_peers": {
                                                                                            "items": {
                                                                                                "properties": {
                                                                                                    "event_count": {
                                                                                                        "type": [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "ip": {
                                                                                                        "type": [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required": [
                                                                                                    "ip",
                                                                                                    "event_count"
                                                                                                ],
                                                                                                "type": [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type": [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "whois": {
                                                                                            "properties": {
                                                                                                "as_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "asn": {
                                                                                                    "type": [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "net_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "org_name": {
                                                                                                    "type": [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "type": [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "tags": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "children": {
                                                                                                "items": {
                                                                                                    "properties": {
                                                                                                        "children": {},
                                                                                                        "id": {
                                                                                                            "type": [
                                                                                                                "integer",
                                                                                                                "null"
                                                                                                            ]
                                                                                                        },
                                                                                                        "name": {
                                                                                                            "type": [
                                                                                                                "string",
                                                                                                                "null"
                                                                                                            ]
                                                                                                        }
                                                                                                    },
                                                                                                    "required": [
                                                                                                        "id",
                                                                                                        "name",
                                                                                                        "children"
                                                                                                    ],
                                                                                                    "type": [
                                                                                                        "object",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "type": [
                                                                                                    "array",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "id": {
                                                                                                "type": [
                                                                                                    "integer",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "name": {
                                                                                                "type": [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            }
                                                                                        },
                                                                                        "required": [
                                                                                            "id",
                                                                                            "name",
                                                                                            "children"
                                                                                        ],
                                                                                        "type": [
                                                                                            "object",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "type": [
                                                                                        "array",
                                                                                        "null"
                                                                                    ]
                                                                                }
                                                                            },
                                                                            "required": [
                                                                                "ip",
                                                                                "country_codes",
                                                                                "as_info",
                                                                                "tags",
                                                                                "event_count",
                                                                                "summary"
                                                                            ],
                                                                            "type": [
                                                                                "object",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "type": [
                                                                            "array",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "query": {
                                                                        "type": [
                                                                            "string",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "request_id": {
                                                                        "type": [
                                                                            "string",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "size": {
                                                                        "type": [
                                                                            "integer",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "start_date": {
                                                                        "type": [
                                                                            "string",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "total": {
                                                                        "type": [
                                                                            "integer",
                                                                            "null"
                                                                        ]
                                                                    }
                                                                },
                                                                "type": "object"
                                                            }
                                                        }
                                                    },
                                                    "Send_Domain_Data_To_Log_Analytics_Table": {
                                                        "runAfter": {
                                                            "Compose_An_Object_From_Array_Of_Ips": [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type": "ApiConnection",
                                                        "inputs": {
                                                            "body": "@{outputs('Compose_An_Object_From_Array_Of_Ips')}",
                                                            "headers": {
                                                                "Log-Type": "@variables('domain_details_table_name')"
                                                            },
                                                            "host": {
                                                                "connection": {
                                                                    "name": "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                                }
                                                            },
                                                            "method": "post",
                                                            "path": "/api/logs"
                                                        }
                                                    },
                                                    "Terminate_Due_To_Successfully_Ingested_Domain_Data": {
                                                        "runAfter": {
                                                            "Send_Domain_Data_To_Log_Analytics_Table": [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type": "Terminate",
                                                        "inputs": {
                                                            "runStatus": "Succeeded"
                                                        }
                                                    }
                                                },
                                                "runAfter": {
                                                    "HTTP_Request_To_Fetch_Details_Of_Domain_Indicator": [
                                                        "Succeeded",
                                                        "TimedOut",
                                                        "Failed"
                                                    ]
                                                },
                                                "else": {
                                                    "actions": {
                                                        "Terminate_Due_To_Failure_While_Fetching_Domain_Indicator_Data": {
                                                            "runAfter": {},
                                                            "type": "Terminate",
                                                            "inputs": {
                                                                "runError": {
                                                                    "code": "@{outputs('HTTP_Request_To_Fetch_Details_Of_Domain_Indicator')['statusCode']}",
                                                                    "message": "@{body('HTTP_Request_To_Fetch_Details_Of_Domain_Indicator')}"
                                                                },
                                                                "runStatus": "Failed"
                                                            }
                                                        }
                                                    }
                                                },
                                                "expression": {
                                                    "and": [
                                                        {
                                                            "equals": [
                                                                "@outputs('HTTP_Request_To_Fetch_Details_Of_Domain_Indicator')['statusCode']",
                                                                200
                                                            ]
                                                        }
                                                    ]
                                                },
                                                "type": "If"
                                            },
                                            "HTTP_Request_To_Fetch_Details_Of_Domain_Indicator": {
                                                "runAfter": {},
                                                "type": "Http",
                                                "inputs": {
                                                    "authentication": {
                                                        "password": "@parameters('password')",
                                                        "type": "Basic",
                                                        "username": "@variables('username')"
                                                    },
                                                    "method": "GET",
                                                    "queries": {
                                                        "query": "@variables('indicator_value')"
                                                    },
                                                    "uri": "@{variables('base_url')}/api/scout/search"
                                                },
                                                "runtimeConfiguration": {
                                                    "secureData": {
                                                        "properties": [
                                                            "inputs",
                                                            "outputs"
                                                        ]
                                                    }
                                                }
                                            }
                                        },
                                        "runAfter": {
                                            "Verify_User_Has_Entered_Valid_Domain": [
                                                "Succeeded"
                                            ]
                                        },
                                        "else": {
                                            "actions": {
                                                "Terminate_Due_To_Invalid_Domain_Input": {
                                                    "runAfter": {},
                                                    "type": "Terminate",
                                                    "inputs": {
                                                        "runError": {
                                                            "code": "400",
                                                            "message": "Please provide valid domain indicator value."
                                                        },
                                                        "runStatus": "Failed"
                                                    }
                                                }
                                            }
                                        },
                                        "expression": {
                                            "and": [
                                                {
                                                    "equals": [
                                                        "@body('Verify_User_Has_Entered_Valid_Domain')?['match_found']",
                                                        "@true"
                                                    ]
                                                }
                                            ]
                                        },
                                        "type": "If"
                                    },
                                    "Verify_User_Has_Entered_Valid_Domain": {
                                        "runAfter": {},
                                        "type": "ApiConnection",
                                        "inputs": {
                                            "host": {
                                                "connection": {
                                                    "name": "@parameters('$connections')['regexmatchingip']['connectionId']"
                                                }
                                            },
                                            "method": "get",
                                            "path": "/api/regexPattern/",
                                            "queries": {
                                                "pattern": "^(?:[a-zA-Z0-9-]+(?:\\[\\.\\]|\\.))+[a-zA-Z]{2,}(?:\\s*,\\s*(?:[a-zA-Z0-9-]+(?:\\[\\.\\]|\\.))+[a-zA-Z]{2,})*$",
                                                "text": "@variables('indicator_value')"
                                            }
                                        }
                                    }
                                }
                            },
                            "expression": {
                                "and": [
                                    {
                                        "equals": [
                                            "@toLower(triggerBody()?['indicator_type'])",
                                            "ip"
                                        ]
                                    }
                                ]
                            },
                            "type": "If"
                        },
                        "Initialize_Base_URL": {
                            "runAfter": {},
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "base_url",
                                        "type": "string",
                                        "value": "[parameters('BaseURL')]"
                                    }
                                ]
                            }
                        },
                        "Initialize_Data_To_Be_Ingested_Into_Summary_Details_Table": {
                            "runAfter": {
                                "Initialize_Top_Fingerprints_Data": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "summary_table_data",
                                        "type": "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Domain_Data": {
                            "runAfter": {
                                "Initialize_Data_To_Be_Ingested_Into_Summary_Details_Table": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "domain_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Domain_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Country_Codes_Data_Object": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "domain_details_table_name",
                                        "type": "string",
                                        "value": "Domain_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Identity_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Certs_Section_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "identity_table_name",
                                        "type": "string",
                                        "value": "Identity_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Proto_By_IP_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Whois_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "proto_by_ip_table_name",
                                        "type": "string",
                                        "value": "Proto_By_IP_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Summary_Details_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Domain_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "summary_details_table_name",
                                        "type": "string",
                                        "value": "Summary_Details"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Asns_By_IP_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Proto_By_IP_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_asns_by_ip_table_name",
                                        "type": "string",
                                        "value": "Top_Asns_By_IP_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Asns_Data_Array": {
                            "runAfter": {
                                "Initialize_Top_Tags_Data_Array": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_asns_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Asns_Data_Object": {
                            "runAfter": {
                                "Initialize_Top_Tags_Data_Object": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_asns_data_obj",
                                        "type": "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Certs_Data": {
                            "runAfter": {
                                "Initialize_Top_Open_Ports_Data": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "certs_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Certs_Section_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Open_Ports_Section_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "certs_table_name",
                                        "type": "string",
                                        "value": "@{concat(variables('summary_details_table_name'),'_Top_Certs_Data')}"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Country_Codes_By_IP_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Asns_By_IP_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_country_codes_by_ip_table_name",
                                        "type": "string",
                                        "value": "Top_Country_Codes_By_IP_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Country_Codes_Data_Array": {
                            "runAfter": {
                                "Initialize_Top_Asns_Data_Array": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_country_codes_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Country_Codes_Data_Object": {
                            "runAfter": {
                                "Initialize_Top_Asns_Data_Object": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_country_codes_data_obj",
                                        "type": "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Fingerprints_Data": {
                            "runAfter": {
                                "Initialize_Top_Certs_Data": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "fingerprints_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Fingerprints_Section_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Pdns_Section_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "fingerprints_table_name",
                                        "type": "string",
                                        "value": "@{concat(variables('summary_details_table_name'),'_Top_Fingerprints_Data')}"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Open_Ports_Data": {
                            "runAfter": {
                                "Initialize_Top_Pdns_Data": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "open_ports_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Open_Ports_Section_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Fingerprints_Section_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "open_ports_table_name",
                                        "type": "string",
                                        "value": "@{concat(variables('summary_details_table_name'),'_Top_Open_Ports_Data')}"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Pdns_Data": {
                            "runAfter": {
                                "Update_Indicator_Value_For_Refang_And_Defang": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "pdns_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Pdns_Section_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Summary_Details_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "pdns_table_name",
                                        "type": "string",
                                        "value": "@{concat(variables('summary_details_table_name'),'_Top_Pdns_Data')}"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Services_By_IP_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Country_Codes_By_IP_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_services_by_ip_table_name",
                                        "type": "string",
                                        "value": "Top_Services_By_IP_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Services_Data_Array": {
                            "runAfter": {
                                "Initialize_Domain_Data": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_services_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Services_Data_Object": {
                            "runAfter": {
                                "Initialize_Top_Country_Codes_Data_Array": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_services_data_obj",
                                        "type": "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Tags_By_IP_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Top_Services_By_IP_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_tags_by_ip_table_name",
                                        "type": "string",
                                        "value": "Top_Tags_By_IP_Data"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Tags_Data_Array": {
                            "runAfter": {
                                "Initialize_Top_Services_Data_Array": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_tags_data",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Tags_Data_Object": {
                            "runAfter": {
                                "Initialize_Top_Services_Data_Object": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "top_tags_data_obj",
                                        "type": "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_User_Name": {
                            "runAfter": {
                                "Initialize_Base_URL": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "username",
                                        "type": "string",
                                        "value": "@parameters('username')"
                                    }
                                ]
                            }
                        },
                        "Initialize_Whois_Sections_Data_Table_Name": {
                            "runAfter": {
                                "Initialize_Identity_Sections_Data_Table_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "whois_table_name",
                                        "type": "string",
                                        "value": "Whois_Data"
                                    }
                                ]
                            }
                        },
                        "Update_Indicator_Value_For_Refang_And_Defang": {
                            "runAfter": {
                                "Initialize_User_Name": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "indicator_value",
                                        "type": "string",
                                        "value": "@{replace(replace(triggerBody()?['indicator_value'], '[', ''), ']', '')}"
                                    }
                                ]
                            }
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
                    "$connections": {
                        "value": {
                            "azureloganalyticsdatacollector": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('AzureloganalyticsdatacollectorConnectionName'))]",
                                "connectionName": "[variables('AzureloganalyticsdatacollectorConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azureloganalyticsdatacollector')]"
                            },
                            "regexmatchingip": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('RegexmatchingipConnectionName'))]",
                                "connectionName": "[variables('RegexmatchingipConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Regexmatchingip')]"
                            }
                        }
                    }
                }
            },
            "name": "[parameters('PlaybookName')]",
            "type": "Microsoft.Logic/workflows",
            "location": "[resourceGroup().location]",
            "tags": {
                "hidden-SentinelTemplateName": "CymruScoutLiveInvestigation",
                "hidden-SentinelTemplateVersion": "1.0"
            },
            "identity": {
                "type": "SystemAssigned"
            },
            "apiVersion": "2017-07-01",
            "dependsOn": [
                "[resourceId('Microsoft.Web/connections', variables('AzureloganalyticsdatacollectorConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('RegexmatchingipConnectionName'))]"
            ]
        },
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('AzureloganalyticsdatacollectorConnectionName')]",
            "location": "[resourceGroup().location]",
            "kind": "V1",
            "properties": {
                "displayName": "[variables('AzureloganalyticsdatacollectorConnectionName')]",
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azureloganalyticsdatacollector')]"
                }
            }
        },
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('RegexmatchingipConnectionName')]",
            "location": "[resourceGroup().location]",
            "kind": "V1",
            "properties": {
                "displayName": "[variables('RegexmatchingipConnectionName')]",
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Regexmatchingip')]"
                }
            }
        }
    ]
}
