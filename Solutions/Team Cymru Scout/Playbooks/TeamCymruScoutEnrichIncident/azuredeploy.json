{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "title": "Team Cymru Scout Enrich Incident",
        "description": "This playbook will fetch and ingest IP or Domain Indicator data based on Entity mapped in Microsoft Sentinel Incident and notify to pre-defined or user customizable email id.",
        "prerequisites": [
            "1. User should have an outlook mail account in order to use this playbook."
        ],
        "postDeployment": [
            "**a. Authorize connections**",
            "Once deployment is complete, authorize each connection.",
            "1. Go to your logic app → API connections → Select azureloganalyticsdatacollector connection resource",
            "2. Go to General → Edit API connection",
            "3. Enter Workspace ID and Workspace Key of your log analytics workspace.",
            "4. Click Authorize",
            "5. Sign in",
            "6. Click Save",
            "7. Repeat steps for other connections",
            "**b. Assign Role to add comment in incident**",
            "Assign role to this playbook.",
            "1. Go to Log Analytics Workspace → <your workspace> → Access Control → Add",
            "2.Add role assignment",
            "3.Assignment type: Job function roles",
            "4.Role: Microsoft Sentinel Contributor",
            "5.Members: select managed identity for assigned access to and add your logic app as member",
            "6.Click on review+assign"
        ],
        "lastUpdateTime": "2025-05-09T00:00:00Z",
        "entities": ["IP", "Domain"],
        "tags": [
            "Team Cymru Scout",
            "Live Investigation",
            "IP",
            "Domain"
        ],
        "support": {
            "tier": "community",
            "armtemplate": "Generated from https://github.com/Azure/Azure-Sentinel/tree/master/Tools/Playbook-ARM-Template-Generator"
        },
        "author": {
            "name": "Team Cymru"
        }
    },
    "parameters": {
        "PlaybookName": {
            "defaultValue": "TeamCymruScoutEnrichIncident",
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Enter the playbook name here."
            }
        },
        "UserName": {
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Enter username of your Team Cymru Scout account."
            }
        },
        "Password": {
            "minLength": 1,
            "type": "securestring",
            "metadata": {
                "description": "Enter password of your Team Cymru Scout account."
            }
        },
        "BaseURL": {
            "type": "string",
            "minLength": 1,
            "metadata": {
                "description": "Enter Base URL of your Team Cymru Scout account.(e.g. https://scout.cymru.com)"
            }
        },
        "EmailId": {
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Enter valid comma separated email ID(s) of receiver without space. (e.g. person1@gmail.com,person2@gmail.com)"
            }
        },
        "WorkspaceName": {
            "minLength": 1,
            "type": "string",
            "metadata": {
                "description": "Enter the log analytics workspace name in which data will be stored for incident enrichment."
            }
        }
    },
    "variables":  {
        "MicrosoftSentinelConnectionName":  "[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
        "AzureloganalyticsdatacollectorConnectionName":  "[concat('Azureloganalyticsdatacollector-', parameters('PlaybookName'))]",
        "AzuremonitorlogsConnectionName":  "[concat('Azuremonitorlogs-', parameters('PlaybookName'))]",
        "OutlookConnectionName":  "[concat('Outlook-', parameters('PlaybookName'))]"
    },
    "resources":  [
        {
            "properties":  {
                "provisioningState":  "Succeeded",
                "state":  "Enabled",
                "definition":  {
                    "$schema":  "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion":  "1.0.0.0",
                    "parameters":  {
                        "$connections":  {
                            "defaultValue":  {
                            },
                            "type":  "Object"
                        },
                        "password":  {
                            "defaultValue":  "[trim(parameters('Password'))]",
                            "type":  "SecureString"
                        },
                        "username":  {
                            "defaultValue":  "[trim(parameters('UserName'))]",
                            "type":  "String"
                        },
                        "email_id": {
                            "defaultValue": "[trim(parameters('EmailId'))]",
                            "type": "String"
                        }
                    },
                    "triggers":  {
                        "Microsoft_Sentinel_incident":  {
                            "type":  "ApiConnectionWebhook",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "body":  {
                                    "callback_url":  "@listCallbackUrl()"
                                },
                                "path":  "/incident-creation"
                            }
                        }
                    },
                    "actions":  {
                        "Initialize_Top_Certs_Data":  {
                            "runAfter":  {
                                "Initialize_User_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "certs_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Certs_Section_Data_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Domain_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "certs_table_name",
                                        "type":  "string",
                                        "value":  "Summary_Details_Top_Certs_Data_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Fingerprints_Data":  {
                            "runAfter":  {
                                "Initialize_User_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "fingerprints_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Fingerprints_Section_Data_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Domain_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "fingerprints_table_name",
                                        "type":  "string",
                                        "value":  "Summary_Details_Top_Fingerprints_Data_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Open_Ports_Data":  {
                            "runAfter":  {
                                "Initialize_User_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "open_ports_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Open_Ports_Section_Data_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Domain_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "open_ports_table_name",
                                        "type":  "string",
                                        "value":  "Summary_Details_Top_Open_Ports_Data_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Pdns_Data":  {
                            "runAfter":  {
                                "Initialize_User_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "pdns_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Pdns_Section_Data_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Domain_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "pdns_table_name",
                                        "type":  "string",
                                        "value":  "Summary_Details_Top_Pdns_Data_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_IP_List":  {
                            "runAfter":  {
                                "Initialize_Scout_Link":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "ip_list",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Domain_List":  {
                            "runAfter":  {
                                "Initialize_Scout_Link":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "domain_list",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "For_Each_Entity":  {
                            "foreach":  "@triggerBody()?['object']?['properties']?['relatedEntities']",
                            "actions":  {
                                "Cases_for_Entity_Kind":  {
                                    "cases":  {
                                        "Case_When_Kind_Is_IP":  {
                                            "case":  "Ip",
                                            "actions":  {
                                                "For_Each_IP":  {
                                                    "foreach":  "@variables('temp_list')",
                                                    "actions":  {
                                                        "Check_IP_List_Contain_Current_IP":  {
                                                            "actions":  {
                                                            },
                                                            "else":  {
                                                                "actions":  {
                                                                    "Append_IP_Into_List":  {
                                                                        "type":  "AppendToArrayVariable",
                                                                        "inputs":  {
                                                                            "name":  "ip_list",
                                                                            "value":  "@items('For_Each_IP')"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression":  {
                                                                "and":  [
                                                                    {
                                                                        "contains":  [
                                                                            "@variables('ip_list')",
                                                                            "@items('For_Each_IP')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type":  "If"
                                                        }
                                                    },
                                                    "runAfter":  {
                                                        "Set_Temporary_List_For_IP":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Foreach",
                                                    "runtimeConfiguration":  {
                                                        "concurrency":  {
                                                            "repetitions":  1
                                                        }
                                                    }
                                                },
                                                "Set_Temporary_List_For_IP":  {
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "temp_list",
                                                        "value":  "@split(replace(replace(replace(items('For_Each_Entity')?['properties']?['address'], '[\"', ''), '\"]', ''), '\",\"', ','), ',')"
                                                    }
                                                }
                                            }
                                        },
                                        "Case_When_Kind_Is_DNS_Resolution":  {
                                            "case":  "DnsResolution",
                                            "actions":  {
                                                "For_Each_Domain":  {
                                                    "foreach":  "@variables('temp_list')",
                                                    "actions":  {
                                                        "Check_Domain_List_Contain_Current_Domain":  {
                                                            "actions":  {
                                                            },
                                                            "else":  {
                                                                "actions":  {
                                                                    "Append_Domain_Into_List":  {
                                                                        "type":  "AppendToArrayVariable",
                                                                        "inputs":  {
                                                                            "name":  "domain_list",
                                                                            "value":  "@items('For_Each_Domain')"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression":  {
                                                                "and":  [
                                                                    {
                                                                        "contains":  [
                                                                            "@variables('domain_list')",
                                                                            "@items('For_Each_Domain')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type":  "If"
                                                        }
                                                    },
                                                    "runAfter":  {
                                                        "Set_Temporary_List_For_Domain":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Foreach",
                                                    "runtimeConfiguration":  {
                                                        "concurrency":  {
                                                            "repetitions":  1
                                                        }
                                                    }
                                                },
                                                "Set_Temporary_List_For_Domain":  {
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "temp_list",
                                                        "value":  "@split(replace(replace(replace(items('For_Each_Entity')?['properties']?['domainName'], '[', ''), ']', ''), '\"', ''), ',')"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "default":  {
                                        "actions":  {
                                        }
                                    },
                                    "expression":  "@items('For_Each_Entity')?['kind']",
                                    "type":  "Switch"
                                }
                            },
                            "runAfter":  {
                                "Initialize_Domain_List":  [
                                    "Succeeded"
                                ],
                                "Initialize_Temporary_List":  [
                                    "Succeeded"
                                ],
                                "Initialize_IP_List":  [
                                    "Succeeded"
                                ],
                                "Initialize_IP_List_Associated_With_Domain":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach"
                        },
                        "For_Each_IP_Address":  {
                            "foreach":  "@variables('ip_list')",
                            "actions":  {
                                "HTTP_Request_To_Fetch_Details_Of_IP_Indicator":  {
                                    "type":  "Http",
                                    "inputs":  {
                                        "uri":  "@{variables('base_url')}/api/scout/ip/@{items('For_Each_IP_Address')}/details",
                                        "method":  "GET",
                                        "authentication":  {
                                            "password":  "@parameters('password')",
                                            "type":  "Basic",
                                            "username":  "@variables('username')"
                                        }
                                    },
                                    "runtimeConfiguration":  {
                                        "secureData":  {
                                            "properties":  [
                                                "inputs",
                                                "outputs"
                                            ]
                                        }
                                    }
                                },
                                "Condition_To_Verify_IP_Indicator_Details_Data_Fetched_Successfully":  {
                                    "actions":  {
                                        "Compose_Whois_Object_To_Add_IP_Address_Property":  {
                                            "runAfter":  {
                                                "Set_Whois_API_Data":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "Compose",
                                            "inputs":  "@setProperty(body('Parse_JSON_For_IP_Indicator_Details_Data')?['whois'], 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                        },
                                        "Condition_To_Ingest_Top_Fingerprints_Data_If_It_Is_Not_Null":  {
                                            "actions":  {
                                                "Compose_Object_From_Fingerprints_Data":  {
                                                    "runAfter":  {
                                                        "For_Each_Fingerprint_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Compose",
                                                    "inputs":  "@variables('fingerprints_api_data')"
                                                },
                                                "For_Each_Fingerprint_Data":  {
                                                    "foreach":  "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['fingerprints']?['top_fingerprints']",
                                                    "actions":  {
                                                        "Append_IP_Address_To_Fingerprints_Data":  {
                                                            "type":  "AppendToArrayVariable",
                                                            "inputs":  {
                                                                "name":  "fingerprints_api_data",
                                                                "value":  "@setProperty(items('For_Each_Fingerprint_Data'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Send_Top_Fingerprints_Data_To_Log_Analytics_Table":  {
                                                    "runAfter":  {
                                                        "Compose_Object_From_Fingerprints_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{outputs('Compose_Object_From_Fingerprints_Data')}",
                                                        "headers":  {
                                                            "Log-Type":  "@variables('fingerprints_table_name')"
                                                        },
                                                        "path":  "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Condition_To_Ingest_Top_Open_Ports_Data_If_It_Is_Not_Null":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['fingerprints']?['top_fingerprints']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Ingest_Top_Open_Ports_Data_If_It_Is_Not_Null":  {
                                            "actions":  {
                                                "Compose_An_Object_From_Top_Open_Ports_Data":  {
                                                    "runAfter":  {
                                                        "For_Each_Top_Open_Ports_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Compose",
                                                    "inputs":  "@variables('open_ports_api_data')"
                                                },
                                                "For_Each_Top_Open_Ports_Data":  {
                                                    "foreach":  "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['top_open_ports']",
                                                    "actions":  {
                                                        "Append_IP_Address_To_Top_Open_Ports_Data":  {
                                                            "type":  "AppendToArrayVariable",
                                                            "inputs":  {
                                                                "name":  "open_ports_api_data",
                                                                "value":  "@setProperty(items('For_Each_Top_Open_Ports_Data'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Send_Open_Ports_Section_Data_To_Log_Analytics_Table":  {
                                                    "runAfter":  {
                                                        "Compose_An_Object_From_Top_Open_Ports_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{outputs('Compose_An_Object_From_Top_Open_Ports_Data')}",
                                                        "headers":  {
                                                            "Log-Type":  "@variables('open_ports_table_name')"
                                                        },
                                                        "path":  "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Condition_To_Ingest_Insights_Data_If_It_Is_Not_Null":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['open_ports']?['top_open_ports']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Ingest_Top_Pdns_Data_If_It_Is_Not_Null":  {
                                            "actions":  {
                                                "Compose_An_Object_From_Top_Pdns_Data":  {
                                                    "runAfter":  {
                                                        "For_Each_Pdns":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Compose",
                                                    "inputs":  "@variables('pdns_api_data')"
                                                },
                                                "For_Each_Pdns":  {
                                                    "foreach":  "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['pdns']?['top_pdns']",
                                                    "actions":  {
                                                        "Append_IP_Address_To_Every_Pdns_Object":  {
                                                            "type":  "AppendToArrayVariable",
                                                            "inputs":  {
                                                                "name":  "pdns_api_data",
                                                                "value":  "@setProperty(items('For_Each_Pdns'), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Send_Top_Pdns_Data_To_Log_Analytics_Table":  {
                                                    "runAfter":  {
                                                        "Compose_An_Object_From_Top_Pdns_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{outputs('Compose_An_Object_From_Top_Pdns_Data')}",
                                                        "headers":  {
                                                            "Log-Type":  "@variables('pdns_table_name')"
                                                        },
                                                        "path":  "/api/logs"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Parse_JSON_For_IP_Indicator_Details_Data":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['pdns']?['top_pdns']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Parse_JSON_For_IP_Indicator_Details_Data":  {
                                            "type":  "ParseJson",
                                            "inputs":  {
                                                "content":  "@body('HTTP_Request_To_Fetch_Details_Of_IP_Indicator')",
                                                "schema":  {
                                                    "properties":  {
                                                        "communications":  {
                                                            "properties":  {
                                                                "event_count":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "peers":  {
                                                                    "items":  {
                                                                        "properties":  {
                                                                            "event_count":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "local":  {
                                                                                "properties":  {
                                                                                    "as_info":  {
                                                                                        "items":  {
                                                                                            "properties":  {
                                                                                                "as_name":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "asn":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required":  [
                                                                                                "asn",
                                                                                                "as_name"
                                                                                            ],
                                                                                            "type":  [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "country_codes":  {
                                                                                        "items":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "ip":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "max_port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "min_port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "tags":  {
                                                                                        "items":  {
                                                                                            "properties":  {
                                                                                                "children":  {
                                                                                                    "items":  {
                                                                                                        "properties":  {
                                                                                                            "id":  {
                                                                                                                "type":  [
                                                                                                                    "integer",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            },
                                                                                                            "name":  {
                                                                                                                "type":  [
                                                                                                                    "string",
                                                                                                                    "null"
                                                                                                                ]
                                                                                                            }
                                                                                                        },
                                                                                                        "required":  [
                                                                                                            "id",
                                                                                                            "name",
                                                                                                            "children"
                                                                                                        ],
                                                                                                        "type":  [
                                                                                                            "object",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "type":  [
                                                                                                        "array",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "id":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "name":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required":  [
                                                                                                "id",
                                                                                                "name",
                                                                                                "children"
                                                                                            ],
                                                                                            "type":  [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "top_services":  {
                                                                                        "items":  {
                                                                                            "properties":  {
                                                                                                "description":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "port":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "proto_number":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "service_name":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required":  [
                                                                                                "service_name",
                                                                                                "port",
                                                                                                "proto_number",
                                                                                                "description"
                                                                                            ],
                                                                                            "type":  [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "unique_ports":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "peer":  {
                                                                                "properties":  {
                                                                                    "as_info":  {
                                                                                        "items":  {
                                                                                            "properties":  {
                                                                                                "as_name":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "asn":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required":  [
                                                                                                "asn",
                                                                                                "as_name"
                                                                                            ],
                                                                                            "type":  [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "country_codes":  {
                                                                                        "items":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "ip":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "max_port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "min_port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "top_services":  {
                                                                                        "items":  {
                                                                                            "properties":  {
                                                                                                "description":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "port":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "proto_number":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "service_name":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "required":  [
                                                                                                "service_name",
                                                                                                "port",
                                                                                                "proto_number",
                                                                                                "description"
                                                                                            ],
                                                                                            "type":  [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  [
                                                                                            "array",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "unique_ports":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "proto":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "proto_text":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required":  [
                                                                            "proto",
                                                                            "proto_text",
                                                                            "local",
                                                                            "peer",
                                                                            "event_count",
                                                                            "first_seen",
                                                                            "last_seen"
                                                                        ],
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type":  [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "end_date":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "fingerprints":  {
                                                            "properties":  {
                                                                "event_count":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "fingerprints":  {
                                                                    "items":  {
                                                                        "properties":  {
                                                                            "active_days":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "distinct_ips":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "event_count":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "fingerprint":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "port":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required":  [
                                                                            "ip",
                                                                            "type",
                                                                            "fingerprint",
                                                                            "port",
                                                                            "first_seen",
                                                                            "last_seen",
                                                                            "distinct_ips",
                                                                            "active_days",
                                                                            "event_count"
                                                                        ],
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type":  [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "identity":  {
                                                            "properties":  {
                                                                "as_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "asn":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "net_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "ip":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "open_ports":  {
                                                            "properties":  {
                                                                "event_count":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "open_ports":  {
                                                                    "items":  {
                                                                        "properties":  {
                                                                            "as_info":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "as_name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "asn":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "asn",
                                                                                        "as_name"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "banner":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "banner_sha1":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "country_codes":  {
                                                                                "items":  {
                                                                                    "type":  [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "event_count":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "port":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "protocol":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "protocol_text":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "service":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "tags":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "children":  {
                                                                                            "items":  {
                                                                                                "properties":  {
                                                                                                    "id":  {
                                                                                                        "type":  [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "name":  {
                                                                                                        "type":  [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required":  [
                                                                                                    "id",
                                                                                                    "name",
                                                                                                    "children"
                                                                                                ],
                                                                                                "type":  [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type":  [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "id":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "id",
                                                                                        "name",
                                                                                        "children"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required":  [
                                                                            "ip",
                                                                            "port",
                                                                            "protocol",
                                                                            "protocol_text",
                                                                            "service",
                                                                            "banner",
                                                                            "banner_sha1",
                                                                            "first_seen",
                                                                            "last_seen",
                                                                            "country_codes",
                                                                            "as_info",
                                                                            "tags",
                                                                            "event_count"
                                                                        ],
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type":  [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "unique_ports":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "pdns":  {
                                                            "properties":  {
                                                                "event_count":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "pdns":  {
                                                                    "items":  {
                                                                        "properties":  {
                                                                            "active_days":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "as_info":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "as_name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "asn":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "asn",
                                                                                        "as_name"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "country_codes":  {
                                                                                "items":  {
                                                                                    "type":  [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "distinct_ips":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "domain":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "domain_created":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "domain_expires":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "event_count":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "nameservers":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "nameservers":  {
                                                                                            "items":  {
                                                                                                "type":  [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type":  [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "root":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "root",
                                                                                        "nameservers"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "registrar":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "root":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "tld":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required":  [
                                                                            "ip",
                                                                            "domain",
                                                                            "root",
                                                                            "tld",
                                                                            "type",
                                                                            "registrar",
                                                                            "domain_created",
                                                                            "domain_expires",
                                                                            "nameservers",
                                                                            "country_codes",
                                                                            "as_info",
                                                                            "tags",
                                                                            "distinct_ips",
                                                                            "active_days",
                                                                            "event_count",
                                                                            "first_seen",
                                                                            "last_seen"
                                                                        ],
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type":  [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "request_id":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "sections":  {
                                                            "items":  {
                                                                "type":  [
                                                                    "string",
                                                                    "null"
                                                                ]
                                                            },
                                                            "type":  [
                                                                "array",
                                                                "null"
                                                            ]
                                                        },
                                                        "size":  {
                                                            "type":  [
                                                                "integer",
                                                                "null"
                                                            ]
                                                        },
                                                        "start_date":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "summary":  {
                                                            "properties":  {
                                                                "bgp_asn":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "bgp_asname":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "certs":  {
                                                                    "properties":  {
                                                                        "top_certs":  {
                                                                            "items":  {
                                                                                "properties":  {
                                                                                    "common_name":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "css_color":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "issuer":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "issuer_common_name":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "md5":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "not_after":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "not_before":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "self_signed":  {
                                                                                        "type":  "boolean"
                                                                                    },
                                                                                    "sha1":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "sha256":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "subject":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "valid_days":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required":  [
                                                                                    "issuer",
                                                                                    "issuer_common_name",
                                                                                    "common_name",
                                                                                    "subject",
                                                                                    "port",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "self_signed",
                                                                                    "not_before",
                                                                                    "not_after",
                                                                                    "valid_days",
                                                                                    "md5",
                                                                                    "sha1",
                                                                                    "sha256",
                                                                                    "css_color"
                                                                                ],
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "end_date":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "fingerprints":  {
                                                                    "properties":  {
                                                                        "top_fingerprints":  {
                                                                            "items":  {
                                                                                "properties":  {
                                                                                    "count":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "signature":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "type":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required":  [
                                                                                    "type",
                                                                                    "signature",
                                                                                    "port",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "count"
                                                                                ],
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "geo_ip_cc":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "insights":  {
                                                                    "properties":  {
                                                                        "insights":  {
                                                                            "items":  {
                                                                                "properties":  {
                                                                                    "message":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "rating":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required":  [
                                                                                    "rating",
                                                                                    "message"
                                                                                ],
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "overall_rating":  {
                                                                            "type":  [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "total":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "ip":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "open_ports":  {
                                                                    "properties":  {
                                                                        "top_open_ports":  {
                                                                            "items":  {
                                                                                "properties":  {
                                                                                    "css_color":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "event_count":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "port":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "protocol":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "protocol_text":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "service":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required":  [
                                                                                    "event_count",
                                                                                    "port",
                                                                                    "protocol",
                                                                                    "protocol_text",
                                                                                    "service",
                                                                                    "inferred_service_name",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "css_color"
                                                                                ],
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "total":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "unique_ports":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "pdns":  {
                                                                    "properties":  {
                                                                        "top_pdns":  {
                                                                            "items":  {
                                                                                "properties":  {
                                                                                    "css_color":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "domain":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "event_count":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "first_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required":  [
                                                                                    "event_count",
                                                                                    "domain",
                                                                                    "first_seen",
                                                                                    "last_seen",
                                                                                    "css_color"
                                                                                ],
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "total":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "start_date":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tag_timeline":  {
                                                                    "properties":  {
                                                                        "data":  {
                                                                            "items":  {
                                                                                "properties":  {
                                                                                    "first_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "last_seen":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "tag":  {
                                                                                        "properties":  {
                                                                                            "css_color":  {
                                                                                                "type":  [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "description":  {
                                                                                                "type":  [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "id":  {
                                                                                                "type":  [
                                                                                                    "integer",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "name":  {
                                                                                                "type":  [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            }
                                                                                        },
                                                                                        "type":  [
                                                                                            "object",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "required":  [
                                                                                    "tag",
                                                                                    "first_seen",
                                                                                    "last_seen"
                                                                                ],
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "type":  [
                                                                                "array",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tags":  {
                                                                    "items":  {
                                                                        "properties":  {
                                                                            "children":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "id":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "id",
                                                                                        "name",
                                                                                        "children"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "id":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "name":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required":  [
                                                                            "id",
                                                                            "name",
                                                                            "children"
                                                                        ],
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type":  [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "total":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "whois":  {
                                                                    "properties":  {
                                                                        "as_name":  {
                                                                            "type":  [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "asn":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "net_name":  {
                                                                            "type":  [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "org_name":  {
                                                                            "type":  [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "usage":  {
                                                            "properties":  {
                                                                "foundation_api_usage":  {
                                                                    "properties":  {
                                                                        "query_limit":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "remaining_queries":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "used_queries":  {
                                                                            "type":  [
                                                                                "integer",
                                                                                "null"
                                                                            ]
                                                                        }
                                                                    },
                                                                    "type":  [
                                                                        "object",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "query_limit":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "remaining_queries":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "used_queries":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "whois":  {
                                                            "properties":  {
                                                                "about_contact_address":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_city":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_country":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_person":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_phone":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "about_contact_role":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "abuse_contact_id":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "address":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_address":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_city":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_country":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_id":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_person":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_phone":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "admin_contact_role":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "as_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "asn":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "bgp_asn":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "bgp_asn_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "cc":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "cidr":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "city":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "description":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "mnt_by_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "mnt_lower_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "mnt_router_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "modified":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "net_handle":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "net_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_address":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_city":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_country":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_id":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_name":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "org_phone":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_address":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_city":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_country":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_email":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_id":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_person":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_phone":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "tech_contact_role":  {
                                                                    "type":  [
                                                                        "string",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        },
                                                        "x509":  {
                                                            "properties":  {
                                                                "event_count":  {
                                                                    "type":  [
                                                                        "integer",
                                                                        "null"
                                                                    ]
                                                                },
                                                                "x509":  {
                                                                    "items":  {
                                                                        "properties":  {
                                                                            "altnames":  {
                                                                                "items":  {
                                                                                    "type":  [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "as_info":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "as_name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "asn":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "asn",
                                                                                        "as_name"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "common_name":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "count":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "country_codes":  {
                                                                                "items":  {
                                                                                    "type":  [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "first_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "ip":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "issuer":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "issuer_common_name":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "md5":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "not_after":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "not_before":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "port":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "self_signed":  {
                                                                                "type":  "boolean"
                                                                            },
                                                                            "serial":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "sha1":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "sha256":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "subject":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "tags":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "children":  {
                                                                                            "items":  {
                                                                                                "properties":  {
                                                                                                    "id":  {
                                                                                                        "type":  [
                                                                                                            "integer",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    },
                                                                                                    "name":  {
                                                                                                        "type":  [
                                                                                                            "string",
                                                                                                            "null"
                                                                                                        ]
                                                                                                    }
                                                                                                },
                                                                                                "required":  [
                                                                                                    "id",
                                                                                                    "name",
                                                                                                    "children"
                                                                                                ],
                                                                                                "type":  [
                                                                                                    "object",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "type":  [
                                                                                                "array",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "id":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "id",
                                                                                        "name",
                                                                                        "children"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "validity_period":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required":  [
                                                                            "ip",
                                                                            "issuer",
                                                                            "issuer_common_name",
                                                                            "common_name",
                                                                            "altnames",
                                                                            "serial",
                                                                            "subject",
                                                                            "not_after",
                                                                            "not_before",
                                                                            "validity_period",
                                                                            "md5",
                                                                            "sha1",
                                                                            "sha256",
                                                                            "first_seen",
                                                                            "last_seen",
                                                                            "port",
                                                                            "self_signed",
                                                                            "country_codes",
                                                                            "as_info",
                                                                            "tags",
                                                                            "count"
                                                                        ],
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "type":  [
                                                                        "array",
                                                                        "null"
                                                                    ]
                                                                }
                                                            },
                                                            "type":  [
                                                                "object",
                                                                "null"
                                                            ]
                                                        }
                                                    },
                                                    "type":  [
                                                        "object",
                                                        "null"
                                                    ]
                                                }
                                            }
                                        },
                                        "Send_Whois_Data_To_Log_Analytics_Workspace":  {
                                            "runAfter":  {
                                                "Compose_Whois_Object_To_Add_IP_Address_Property":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "ApiConnection",
                                            "inputs":  {
                                                "host":  {
                                                    "connection":  {
                                                        "name":  "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                    }
                                                },
                                                "method":  "post",
                                                "body":  "@{outputs('Compose_Whois_Object_To_Add_IP_Address_Property')}",
                                                "headers":  {
                                                    "Log-Type":  "@variables('whois_table_name')"
                                                },
                                                "path":  "/api/logs"
                                            }
                                        },
                                        "Condition_To_Ingest_Insights_Data_If_It_Is_Not_Null":  {
                                            "actions":  {
                                                "For_Each_Insight":  {
                                                    "foreach":  "@body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['insights']",
                                                    "actions":  {
                                                        "Switch_Case_For_Summary_Overall_Rating":  {
                                                            "cases":  {
                                                                "Case_When_Overall_Rating_Is_Malicious":  {
                                                                    "case":  "malicious",
                                                                    "actions":  {
                                                                        "Append_Rank_And_IP_For_Malicious_To_Every_Insight_Object_":  {
                                                                            "type":  "AppendToArrayVariable",
                                                                            "inputs":  {
                                                                                "name":  "insights_api_data",
                                                                                "value":  "@setProperty(setProperty(items('For_Each_Insight'), 'rank', 3), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                                            }
                                                                        }
                                                                    }
                                                                },
                                                                "Case_When_Overall_Rating_Is_Suspicious":  {
                                                                    "case":  "suspicious",
                                                                    "actions":  {
                                                                        "Append_Rank_And_IP_For_Suspicious_To_Every_Insight_Object_":  {
                                                                            "type":  "AppendToArrayVariable",
                                                                            "inputs":  {
                                                                                "name":  "insights_api_data",
                                                                                "value":  "@setProperty(setProperty(items('For_Each_Insight'), 'rank', 2), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "default":  {
                                                                "actions":  {
                                                                    "Append_Rank_And_IP_For_Other_To_Every_Insight_Object_":  {
                                                                        "type":  "AppendToArrayVariable",
                                                                        "inputs":  {
                                                                            "name":  "insights_api_data",
                                                                            "value":  "@setProperty(setProperty(items('For_Each_Insight'), 'rank', 1), 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression":  "@toLower(body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['overall_rating'])",
                                                            "type":  "Switch"
                                                        }
                                                    },
                                                    "type":  "Foreach",
                                                    "runtimeConfiguration":  {
                                                        "concurrency":  {
                                                            "repetitions":  1
                                                        }
                                                    }
                                                },
                                                "Compose_An_Object_From_Insights_Data":  {
                                                    "runAfter":  {
                                                        "Set_Overall_Rating_From_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Compose",
                                                    "inputs":  "@variables('insights_api_data')"
                                                },
                                                "Send_Insights_Data_To_Log_Analytics_Table":  {
                                                    "runAfter":  {
                                                        "Compose_An_Object_From_Insights_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{outputs('Compose_An_Object_From_Insights_Data')}",
                                                        "headers":  {
                                                            "Log-Type":  "@variables('insights_table_name')"
                                                        },
                                                        "path":  "/api/logs"
                                                    }
                                                },
                                                "Set_Country_Code_From_Data":  {
                                                    "runAfter":  {
                                                        "For_Each_Insight":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "country_code",
                                                        "value":  "@if(empty(body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['geo_ip_cc']), 'No Country Code Found', body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['geo_ip_cc'])"
                                                    }
                                                },
                                                "Set_Overall_Rating_From_Data":  {
                                                    "runAfter":  {
                                                        "Set_Country_Code_From_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "overall_rating",
                                                        "value":  "@if(empty(body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['overall_rating']), 'suspicious', body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['overall_rating'])"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Condition_To_Ingest_Top_Pdns_Data_If_It_Is_Not_Null":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@body('parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['insights']?['insights']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Send_IP_Indicator_To_Live_Investigation_Indicators_Table":  {
                                            "runAfter":  {
                                                "Send_An_Email_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "ApiConnection",
                                            "inputs":  {
                                                "host":  {
                                                    "connection":  {
                                                        "name":  "@parameters('$connections')['azureloganalyticsdatacollector']['connectionId']"
                                                    }
                                                },
                                                "method":  "post",
                                                "body":  "@{variables('indicator_object')}",
                                                "headers":  {
                                                    "Log-Type":  "@variables('indicators_table_name')"
                                                },
                                                "path":  "/api/logs"
                                            }
                                        },
                                        "Set_Indicator_Object_Value_For_IP":  {
                                            "runAfter":  {
                                                "Set_Top_Certs_Data":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "indicator_object",
                                                "value":  {
                                                    "type":  "IP",
                                                    "value":  "@items('For_Each_IP_Address')"
                                                }
                                            }
                                        },
                                        "Condition_To_Check_Tables_Already_Exist_Or_Not":  {
                                            "actions":  {
                                                "Run_Query_and_List_Results_for_Top_PDNS":  {
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{variables('pdns_table_name')}_CL\n| where ip_s == \"@{items('For_Each_IP_Address')}\"\n| summarize arg_max(TimeGenerated, *) by ip_s, domain_s\n| project-rename domain=domain_s, event_count=event_count_d\n| sort by event_count\n| take 10",
                                                        "path":  "/queryData",
                                                        "queries":  {
                                                            "resourcegroups": "[resourceGroup().name]",
                                                            "resourcename": "[trim(parameters('WorkspaceName'))]",
                                                            "resourcetype": "Log Analytics Workspace",
                                                            "subscriptions": "[subscription().subscriptionId]",
                                                            "timerange":  "Last 90 days"
                                                        }
                                                    }
                                                },
                                                "Set_PDNS_Data_From_Query_Data":  {
                                                    "runAfter":  {
                                                        "Run_Query_and_List_Results_for_Top_PDNS":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "pdns_data",
                                                        "value":  "@body('Run_Query_and_List_Results_for_Top_PDNS')?['value']"
                                                    }
                                                },
                                                "Run_Query_and_List_Results_for_Top_Open_Ports":  {
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{variables('open_ports_table_name')}_CL\n| where ip_s == \"@{items('For_Each_IP_Address')}\"\n| summarize arg_max(TimeGenerated, *) by service_s, port_d, protocol_d, protocol_text_s\n| project-rename port=port_d, protocol=protocol_d, protocol_text=protocol_text_s, event_count=event_count_d\n| sort by event_count\n| take 10 ",
                                                        "path":  "/queryData",
                                                        "queries":  {
                                                            "resourcegroups": "[resourceGroup().name]",
                                                            "resourcename": "[trim(parameters('WorkspaceName'))]",
                                                            "resourcetype": "Log Analytics Workspace",
                                                            "subscriptions": "[subscription().subscriptionId]",
                                                            "timerange":  "Last 90 days"
                                                        }
                                                    }
                                                },
                                                "Set_Open_Ports_Data_From_Query_Data":  {
                                                    "runAfter":  {
                                                        "Run_Query_and_List_Results_for_Top_Open_Ports":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "open_ports_data",
                                                        "value":  "@body('Run_Query_and_List_Results_for_Top_Open_Ports')?['value']"
                                                    }
                                                },
                                                "Run_Query_and_List_Results_for_Top_Fingerprints":  {
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{variables('fingerprints_table_name')}_CL\n| where ip_s == \"@{items('For_Each_IP_Address')}\"\n| extend SignatureG = column_ifexists('signature_g', '')\n| extend SignatureS = column_ifexists('signature_s', '')\n| extend Signature = coalesce(SignatureG, SignatureS)\n| summarize arg_max(TimeGenerated, *) by type_s, Signature, port_d\n| project-rename type=type_s, port=port_d, first_seen=first_seen_s, last_seen=last_seen_s, signature=Signature, count=count_d\n| sort by count\n| take 10 ",
                                                        "path":  "/queryData",
                                                        "queries":  {
                                                            "resourcegroups": "[resourceGroup().name]",
                                                            "resourcename": "[trim(parameters('WorkspaceName'))]",
                                                            "resourcetype": "Log Analytics Workspace",
                                                            "subscriptions": "[subscription().subscriptionId]",
                                                            "timerange":  "Last 90 days"
                                                        }
                                                    }
                                                },
                                                "Set_Fingerprints_Data_From_Query_Data":  {
                                                    "runAfter":  {
                                                        "Run_Query_and_List_Results_for_Top_Fingerprints":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "fingerprints_data",
                                                        "value":  "@body('Run_Query_and_List_Results_for_Top_Fingerprints')?['value']"
                                                    }
                                                },
                                                "Run_Query_and_List_Results_for_Whois":  {
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body": "@{variables('whois_table_name')}_CL\n| where ip_s == \"@{items('For_Each_IP_Address')}\"\n| summarize arg_max(TimeGenerated, *) by ip_s\n| project-rename modified=modified_s, asn=asn_d, cidr=cidr_s, as_name=as_name_s, bgp_asn=bgp_asn_d, bgp_asn_name=bgp_asn_name_s, net_name=net_name_s, cc=cc_s, description=description_s, admin_contact_id=admin_contact_id_s, admin_contact_role=admin_contact_role_s, admin_contact_email=admin_contact_email_s, \nadmin_contact_phone=admin_contact_phone_s,\nadmin_contact_country=admin_contact_country_s, admin_contact_address=admin_contact_address_s, tech_contact_id=tech_contact_id_s, tech_contact_role=tech_contact_role_s, tech_contact_email=tech_contact_email_s, tech_contact_phone=tech_contact_phone_s, tech_contact_country=tech_contact_country_s, tech_contact_address=tech_contact_address_s, org_id=org_id_s, org_name=org_name_s, org_email=org_email_s, org_phone=org_phone_s, org_country=org_country_s, org_address=org_address_s, mnt_by_email=mnt_by_email_s, mnt_router_email=mnt_router_email_s",
                                                        "path":  "/queryData",
                                                        "queries":  {
                                                            "resourcegroups": "[resourceGroup().name]",
                                                            "resourcename": "[trim(parameters('WorkspaceName'))]",
                                                            "resourcetype": "Log Analytics Workspace",
                                                            "subscriptions": "[subscription().subscriptionId]",
                                                            "timerange":  "Last 90 days"
                                                        }
                                                    }
                                                },
                                                "Set_Whois_Data_From_Query_Data":  {
                                                    "runAfter":  {
                                                        "Run_Query_and_List_Results_for_Whois":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "whois_data",
                                                        "value":  "@if(empty(body('Run_Query_and_List_Results_for_Whois')?['value'][0]), variables('whois_api_data') , body('Run_Query_and_List_Results_for_Whois')?['value'][0])"
                                                    }
                                                },
                                                "Run_Query_And_List_Insights_Data_And_Country_Code_For_Indicator":  {
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  "@{variables('insights_table_name')}_CL\n| where ip_s == \"@{items('For_Each_IP_Address')}\"\n| summarize arg_max(TimeGenerated, *) by rank_d, Message\n| top 10 by rank_d\n| project-rename rating=rating_s, message=Message",
                                                        "path":  "/queryData",
                                                        "queries":  {
                                                            "resourcegroups": "[resourceGroup().name]",
                                                            "resourcename": "[trim(parameters('WorkspaceName'))]",
                                                            "resourcetype": "Log Analytics Workspace",
                                                            "subscriptions": "[subscription().subscriptionId]",
                                                            "timerange":  "Last 90 days"
                                                        }
                                                    }
                                                },
                                                "Set_Insights_Data_From_Query_Results":  {
                                                    "runAfter":  {
                                                        "Run_Query_And_List_Insights_Data_And_Country_Code_For_Indicator":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "insights_data",
                                                        "value":  "@body('Run_Query_And_List_Insights_Data_And_Country_Code_For_Indicator')?['value']"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Run_Query_And_Check_Whether_This_is_First_Execution_Or_Not":  [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Skipped",
                                                    "Failed"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_PDNS_Data_From_Request_Body":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "pdns_data",
                                                            "value":  "@chunk(variables('pdns_api_data'), 10)[0]"
                                                        }
                                                    },
                                                    "Set_Open_Ports_Data_From_Request_Body":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "open_ports_data",
                                                            "value":  "@chunk(variables('open_ports_api_data'), 10)[0]"
                                                        }
                                                    },
                                                    "Set_Fingerprints_Data_From_Request_Data":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "fingerprints_data",
                                                            "value":  "@chunk(variables('fingerprints_api_data'), 10)[0]"
                                                        }
                                                    },
                                                    "Set_Insights_Data_From_Request_Body":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "insights_data",
                                                            "value":  "@chunk(variables('insights_api_data'), 10)[0]"
                                                        }
                                                    },
                                                    "Set_Whois_Data_From_Request_Body": {
                                                        "type": "SetVariable",
                                                        "inputs": {
                                                            "name": "whois_data",
                                                            "value": "@variables('whois_api_data')"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "equals":  [
                                                            "@outputs('Run_Query_And_Check_Whether_This_is_First_Execution_Or_Not')?['statusCode']",
                                                            200
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Run_Query_And_Check_Whether_This_is_First_Execution_Or_Not":  {
                                            "runAfter":  {
                                                "Send_Whois_Data_To_Log_Analytics_Workspace":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "ApiConnection",
                                            "inputs":  {
                                                "host":  {
                                                    "connection":  {
                                                        "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                    }
                                                },
                                                "method":  "post",
                                                "body":  "@{variables('indicators_table_name')}_CL\n| where TimeGenerated \u003e= ago(90d)",
                                                "path":  "/queryData",
                                                "queries":  {
                                                    "resourcegroups": "[resourceGroup().name]",
                                                    "resourcename": "[trim(parameters('WorkspaceName'))]",
                                                    "resourcetype": "Log Analytics Workspace",
                                                    "subscriptions": "[subscription().subscriptionId]",
                                                    "timerange":  "Last 90 days"
                                                }
                                            }
                                        },
                                        "Set_Whois_API_Data":  {
                                            "runAfter":  {
                                                "Condition_To_Ingest_Top_Fingerprints_Data_If_It_Is_Not_Null":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "whois_api_data",
                                                "value":  "@setProperty(body('Parse_JSON_For_IP_Indicator_Details_Data')?['whois'], 'ip', body('Parse_JSON_For_IP_Indicator_Details_Data')?['ip'])"
                                            }
                                        },
                                        "Set_Open_Ports_HTML_Table":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "open_ports_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003ePort\u003c/th\u003e\u003cth\u003eProtocol\u003c/th\u003e\u003cth\u003eProtocol Name\u003c/th\u003e\u003cth\u003eEvents\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_Insights_HTML_Table":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "insights_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eRating\u003c/th\u003e\u003cth\u003eMessage\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_PDNS_HTML_Table":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "pdns_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eDomain\u003c/th\u003e\u003cth\u003eEvents\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set__Certs_HTML_Table":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "certs_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eIssuer\u003c/th\u003e\u003cth\u003eSubject\u003c/th\u003e\u003cth\u003eFirst Seen\u003c/th\u003e\u003cth\u003eLast Seen\u003c/th\u003e\u003cth\u003eValid Days\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_Fingerprints_HTML_Table":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "fingerprints_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eType\u003c/th\u003e\u003cth\u003eSignature\u003c/th\u003e\u003cth\u003ePort\u003c/th\u003e\u003cth\u003eFirst Seen\u003c/th\u003e\u003cth\u003eLast Seen\u003c/th\u003e\u003cth\u003eCount\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_HTML_Table_For_Whois_General":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "whois_general_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eModified\u003c/th\u003e\u003cth\u003eASN\u003c/th\u003e\u003cth\u003eCIDR\u003c/th\u003e\u003cth\u003eAs Name\u003c/th\u003e\u003cth\u003eBGP ASN\u003c/th\u003e\u003cth\u003eBGP AS Name\u003c/th\u003e\u003cth\u003eNet Name\u003c/th\u003e\u003cth\u003eCC\u003c/th\u003e\u003cth\u003eDescription\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_HTML_Table_For_Whois_Admin":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "whois_admin_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eAdmin Contact ID\u003c/th\u003e\u003cth\u003eAdmin Contact Role\u003c/th\u003e\u003cth\u003eAdmin Contact Email\u003c/th\u003e\u003cth\u003eAdmin Contact Phone\u003c/th\u003e\u003cth\u003eAdmin Contact Country\u003c/th\u003e\u003cth\u003eAdmin Contact Address\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_HTML_Table_For_Whois_Tech":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "whois_tech_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eTech Contact ID\u003c/th\u003e\u003cth\u003eTech Contact Role\u003c/th\u003e\u003cth\u003eTech Contact Email\u003c/th\u003e\u003cth\u003eTech Contact Phone\u003c/th\u003e\u003cth\u003eTech Contact Country\u003c/th\u003e\u003cth\u003eTech Contact Address\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Set_HTML_Table_For_Whois_Organization":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Tables_Already_Exist_Or_Not":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "whois_organization_html_table",
                                                "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eOrganization ID\u003c/th\u003e\u003cth\u003eOrganization Name\u003c/th\u003e\u003cth\u003eOrganization Email\u003c/th\u003e\u003cth\u003eOrganization Phone\u003c/th\u003e\u003cth\u003eOrganization Country\u003c/th\u003e\u003cth\u003eOrganization Address\u003c/th\u003e\u003cth\u003eMaintained By Email\u003c/th\u003e\u003cth\u003eMaintained Router Email\u003c/th\u003e\u003c/tr\u003e"
                                            }
                                        },
                                        "Condition_To_Add_Insights_Data_In_HTML_Table_If_It_Is_Available_In_Logs":  {
                                            "actions":  {
                                                "For_Each_Insights_Data":  {
                                                    "foreach":  "@variables('insights_data')",
                                                    "actions":  {
                                                        "Append_Insight_Information_To_Insights_HTML_Table":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "insights_html_table",
                                                                "value":  "\u003ctr\u003e\u003ctd\u003e@{items('For_Each_Insights_Data')?['rating']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Insights_Data')?['message']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Complete_HTML_Table_For_Insights_Data":  {
                                                    "runAfter":  {
                                                        "For_Each_Insights_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "insights_html_table",
                                                        "value":  "\u003c/table\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Indicator_Object_Value_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_Insights_HTML_Table_For_No_Insights_Record_Found":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "insights_html_table",
                                                            "value":  "\u003cb\u003e No Insights Data Found in Logs. \u003c/b\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@empty(variables('insights_data'))",
                                                                "@true"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Add_PDNS_Data_To_HTML_Table_If_It_Is_Available":  {
                                            "actions":  {
                                                "For_Each_PDNS_Data":  {
                                                    "foreach":  "@variables('pdns_data')",
                                                    "actions":  {
                                                        "Append_PDNS_Information_To_PDNS_HTML_Table":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "pdns_html_table",
                                                                "value":  "\u003ctr\u003e\u003ctd\u003e@{items('For_Each_PDNS_Data')?['domain']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_PDNS_Data')?['event_count']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Complete_PDNS_HTML_Table":  {
                                                    "runAfter":  {
                                                        "For_Each_PDNS_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "pdns_html_table",
                                                        "value":  "\u003c/table\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Indicator_Object_Value_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_PDNS_HTML_Table_Data_For_No_PDNS_Found":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "pdns_html_table",
                                                            "value":  "\u003cb\u003e No PDNS Details Found. \u003c/b\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@empty(variables('pdns_data'))",
                                                                "@true"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Add_Certs_Data_To_HTML_Table_If_It_Is_Available":  {
                                            "actions":  {
                                                "For_Each_Certs_Data":  {
                                                    "foreach":  "@variables('certs_data')",
                                                    "actions":  {
                                                        "Append_Certs_Information_To_Certs_HTML_Table":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "certs_html_table",
                                                                "value":  "\u003ctr\u003e\u003ctd\u003e@{items('For_Each_Certs_Data')?['issuer']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Certs_Data')?['subject']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Certs_Data')?['first_seen']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Certs_Data')?['last_seen']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Certs_Data')?['valid_days']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Complete_Certs_HTML_Table":  {
                                                    "runAfter":  {
                                                        "For_Each_Certs_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "certs_html_table",
                                                        "value":  "\u003c/table\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Indicator_Object_Value_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_Certs_HTML_Table_Data_For_No_Certs_Data_Found":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "certs_html_table",
                                                            "value":  "\u003cb\u003e No Certs Data Found. \u003c/b\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@empty(variables('certs_data'))",
                                                                "@true"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Add_Open_Ports_Data_To_HTML_Table_If_It_Is_Available":  {
                                            "actions":  {
                                                "For_Each_Open_Port_Data":  {
                                                    "foreach":  "@variables('open_ports_data')",
                                                    "actions":  {
                                                        "Append_Each_Port_Details_To_HTML_Table":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "open_ports_html_table",
                                                                "value":  "\u003ctr\u003e\u003ctd\u003e@{items('For_Each_Open_Port_Data')?['port']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Open_Port_Data')?['protocol']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Open_Port_Data')?['protocol_text']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Open_Port_Data')?['event_count']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Complete_Open_Ports_HTML_Table":  {
                                                    "runAfter":  {
                                                        "For_Each_Open_Port_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "open_ports_html_table",
                                                        "value":  "\u003c/table\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Indicator_Object_Value_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_Open_Ports_HTML_Table_Data_For_No_Data_Found":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "open_ports_html_table",
                                                            "value":  "\u003cb\u003e No Open Ports Details Found. \u003c/b\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@empty(variables('open_ports_data'))",
                                                                "@true"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Add_Fingerprints_Data_To_HTML_Table_If_It_Is_Available":  {
                                            "actions":  {
                                                "For_Each_Fingerprints_Data":  {
                                                    "foreach":  "@variables('fingerprints_data')",
                                                    "actions":  {
                                                        "Append_Fingerprints_Information_To_Fingerprints_HTML_Table":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "fingerprints_html_table",
                                                                "value":  "\u003ctr\u003e\u003ctd\u003e@{items('For_Each_Fingerprints_Data')?['type']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Fingerprints_Data')?['signature']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Fingerprints_Data')?['port']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Fingerprints_Data')?['first_seen']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Fingerprints_Data')?['last_seen']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Fingerprints_Data')?['count']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "type":  "Foreach"
                                                },
                                                "Complete_Fingerprints_HTML_Table":  {
                                                    "runAfter":  {
                                                        "For_Each_Fingerprints_Data":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "fingerprints_html_table",
                                                        "value":  "\u003c/table\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Indicator_Object_Value_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_Fingerprints_HTML_Table_Data_For_No_Fingerprints_Data_Found":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "fingerprints_html_table",
                                                            "value":  "\u003cb\u003e No Fingerprints Data Found. \u003c/b\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@empty(variables('fingerprints_data'))",
                                                                "@true"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Condition_To_Add_Whois_Data_To_HTML_Table_If_It_Is_Available":  {
                                            "actions":  {
                                                "Append_Whois_General_Information_To_Whois_General_HTML_Table":  {
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "whois_general_html_table",
                                                        "value":  "\u003ctr\u003e\u003ctd\u003e@{variables('whois_data')?['modified']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['asn']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['cidr']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['as_name']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['bgp_asn']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['bgp_asn_name']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['net_name']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['cc']}\u003c/td\u003e\u003ctd\u003e@{replace(replace(replace(variables('whois_data')?['description'], '[\"', ''), '\"]', ''), '\",\"', '\n')}\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e"
                                                    }
                                                },
                                                "Append_Whois_Admin_Information_To_Whois_Admin_HTML_Table":  {
                                                    "runAfter":  {
                                                        "Append_Whois_General_Information_To_Whois_General_HTML_Table":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "whois_admin_html_table",
                                                        "value":  "\u003ctr\u003e\u003ctd\u003e@{variables('whois_data')?['admin_contact_id']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['admin_contact_role']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['admin_contact_email']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['admin_contact_phone']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['admin_contact_country']}\u003c/td\u003e\u003ctd\u003e@{replace(replace(variables('whois_data')?['admin_contact_address'], '[\"', ''), '\"]', '')}\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e"
                                                    }
                                                },
                                                "Append_Whois_Tech_Information_To_Whois_Tech_HTML_Table":  {
                                                    "runAfter":  {
                                                        "Append_Whois_Admin_Information_To_Whois_Admin_HTML_Table":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "whois_tech_html_table",
                                                        "value":  "\u003ctr\u003e\u003ctd\u003e@{variables('whois_data')?['tech_contact_id']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['tech_contact_role']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['tech_contact_email']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['tech_contact_phone']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['tech_contact_country']}\u003c/td\u003e\u003ctd\u003e@{replace(replace(variables('whois_data')?['tech_contact_address'], '[\"', ''), '\"]', '')}\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e"
                                                    }
                                                },
                                                "Append_Whois_Organization_Information_To_Whois_Organization_HTML_Table":  {
                                                    "runAfter":  {
                                                        "Append_Whois_Tech_Information_To_Whois_Tech_HTML_Table":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "whois_organization_html_table",
                                                        "value":  "\u003ctr\u003e\u003ctd\u003e@{variables('whois_data')?['org_id']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['org_name']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['org_email']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['org_phone']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['org_country']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['org_address']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['mnt_by_email']}\u003c/td\u003e\u003ctd\u003e@{variables('whois_data')?['mnt_router_email']}\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Indicator_Object_Value_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Set_Whois_HTML_Table_Data_For_No_Whois_General_Data_Found":  {
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "whois_general_html_table",
                                                            "value":  "\u003cb\u003e No Whois General Data Found. \u003c/b\u003e"
                                                        }
                                                    },
                                                    "Set_Whois_HTML_Table_Data_For_No_Whois_Admin_Data_Found":  {
                                                        "runAfter":  {
                                                            "Set_Whois_HTML_Table_Data_For_No_Whois_General_Data_Found":  [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "whois_admin_html_table",
                                                            "value":  "\u003cb\u003e No Whois Admin Data Found. \u003c/b\u003e"
                                                        }
                                                    },
                                                    "Set_Whois_HTML_Table_Data_For_No_Whois_Tech_Data_Found":  {
                                                        "runAfter":  {
                                                            "Set_Whois_HTML_Table_Data_For_No_Whois_Admin_Data_Found":  [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "whois_tech_html_table",
                                                            "value":  "\u003cb\u003e No Whois Tech Data Found. \u003c/b\u003e"
                                                        }
                                                    },
                                                    "Set_Whois_HTML_Table_Data_For_No_Whois_Org_Data_Found":  {
                                                        "runAfter":  {
                                                            "Set_Whois_HTML_Table_Data_For_No_Whois_Tech_Data_Found":  [
                                                                "Succeeded"
                                                            ]
                                                        },
                                                        "type":  "SetVariable",
                                                        "inputs":  {
                                                            "name":  "whois_organization_html_table",
                                                            "value":  "\u003cb\u003e No Whois Organization Data Found. \u003c/b\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@empty(variables('whois_data'))",
                                                                "@true"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Set_Scout_Link_For_IP":  {
                                            "runAfter":  {
                                                "Condition_To_Add_Insights_Data_In_HTML_Table_If_It_Is_Available_In_Logs":  [
                                                    "Succeeded"
                                                ],
                                                "Condition_To_Add_PDNS_Data_To_HTML_Table_If_It_Is_Available":  [
                                                    "Succeeded"
                                                ],
                                                "Condition_To_Add_Certs_Data_To_HTML_Table_If_It_Is_Available":  [
                                                    "Succeeded"
                                                ],
                                                "Condition_To_Add_Open_Ports_Data_To_HTML_Table_If_It_Is_Available":  [
                                                    "Succeeded"
                                                ],
                                                "Condition_To_Add_Fingerprints_Data_To_HTML_Table_If_It_Is_Available":  [
                                                    "Succeeded"
                                                ],
                                                "Condition_To_Add_Whois_Data_To_HTML_Table_If_It_Is_Available":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "scout_link",
                                                "value":  "\u003ca href=\"@{variables('base_url')}/scout/details?query=@{items('For_Each_IP_Address')}\"\u003e@{variables('base_url')}/scout/details?query=@{items('For_Each_IP_Address')}\u003c/a\u003e"
                                            }
                                        },
                                        "Send_An_Email_For_IP":  {
                                            "runAfter":  {
                                                "Condition_To_Check_Comment_Count_Is_Less_Than_99":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "ApiConnection",
                                            "inputs":  {
                                                "host":  {
                                                    "connection":  {
                                                        "name":  "@parameters('$connections')['outlook']['connectionId']"
                                                    }
                                                },
                                                "method":  "post",
                                                "body":  {
                                                    "To":  "@variables('email_recipient')",
                                                    "Subject":  "A @{variables('overall_rating')} IP address has been identified, and an incident has been created for it in Sentinel.\nIP: @{items('For_Each_IP_Address')}",
                                                    "Body":  "\u003cp class=\"editor-paragraph\"\u003eA @{variables('overall_rating')} IP address has been identified, and an incident has been created for it in Sentinel.\u003c/p\u003e\u003cbr\u003e\u003cp class=\"editor-paragraph\"\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eIncident URL:\u003c/strong\u003e\u003c/b\u003e @{triggerBody()?['object']?['properties']?['incidentUrl']}\u003c/p\u003e\u003cp class=\"editor-paragraph\"\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eIP: \u003c/strong\u003e\u003c/b\u003e@{items('For_Each_IP_Address')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eCountry Code: \u003c/strong\u003e\u003c/b\u003e@{variables('country_code')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTeam Cymru Scout link for more information: \u003c/strong\u003e\u003c/b\u003e@{variables('scout_link')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Insights:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('insights_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Open Ports:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('open_ports_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop PDNS:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('pdns_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Certificates:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('certs_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Fingerprints:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('fingerprints_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - General:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_general_html_table')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - Admin:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_admin_html_table')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - Tech:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_tech_html_table')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - Organization:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_organization_html_table')}\u003c/p\u003e\u003cbr\u003e",
                                                    "Importance":  "Normal"
                                                },
                                                "path":  "/v2/Mail"
                                            }
                                        },
                                        "Condition_To_Check_Comment_Count_Is_Less_Than_99":  {
                                            "actions":  {
                                                "Add_IP_Data_Into_Incident_Comment":  {
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  {
                                                            "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                            "message":  "\u003cp class=\"editor-paragraph\"\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eIP:\u003c/strong\u003e\u003c/b\u003e @{items('For_Each_IP_Address')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eCountry Code:\u003c/strong\u003e\u003c/b\u003e @{variables('country_code')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTeam Cymru Scout link for more information:\u003c/strong\u003e\u003c/b\u003e @{variables('scout_link')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Insights:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('insights_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Open Ports:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('open_ports_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop PDNS:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('pdns_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Certificates:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('certs_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTop Fingerprints:\u003c/strong\u003e\u003c/b\u003e\u003cbr\u003e@{variables('fingerprints_html_table')}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - General:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_general_html_table')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - Admin:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_admin_html_table')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - Tech:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_tech_html_table')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eWhois - Organization:\u003c/strong\u003e\u003c/b\u003e @{variables('whois_organization_html_table')}\u003cbr\u003e\u003c/p\u003e\u003cbr\u003e"
                                                        },
                                                        "path":  "/Incidents/Comment"
                                                    }
                                                },
                                                "Increment_Comment_Count":  {
                                                    "runAfter":  {
                                                        "Add_IP_Data_Into_Incident_Comment":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "IncrementVariable",
                                                    "inputs":  {
                                                        "name":  "comment_count",
                                                        "value":  1
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Set_Scout_Link_For_IP":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Condition_To_Check_Comment_Count_Is_99":  {
                                                        "actions":  {
                                                            "Add_Comment_Limit_Has_Been_Exceeded_To_100_For_Incident_":  {
                                                                "type":  "ApiConnection",
                                                                "inputs":  {
                                                                    "host":  {
                                                                        "connection":  {
                                                                            "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                                                        }
                                                                    },
                                                                    "method":  "post",
                                                                    "body":  {
                                                                        "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                                        "message":  "\u003cp class=\"editor-paragraph\"\u003eComment limit to an incident has been breached.\u003c/p\u003e"
                                                                    },
                                                                    "path":  "/Incidents/Comment"
                                                                }
                                                            },
                                                            "Increment_Comment_Count_To_100":  {
                                                                "runAfter":  {
                                                                    "Add_Comment_Limit_Has_Been_Exceeded_To_100_For_Incident_":  [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "type":  "IncrementVariable",
                                                                "inputs":  {
                                                                    "name":  "comment_count",
                                                                    "value":  1
                                                                }
                                                            }
                                                        },
                                                        "else":  {
                                                            "actions":  {
                                                            }
                                                        },
                                                        "expression":  {
                                                            "and":  [
                                                                {
                                                                    "equals":  [
                                                                        "@variables('comment_count')",
                                                                        99
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        "type":  "If"
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "less":  [
                                                            "@variables('comment_count')",
                                                            99
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Set_Top_Certs_Data":  {
                                            "runAfter":  {
                                                "Set_Open_Ports_HTML_Table":  [
                                                    "Succeeded"
                                                ],
                                                "Set_Insights_HTML_Table":  [
                                                    "Succeeded"
                                                ],
                                                "Set_PDNS_HTML_Table":  [
                                                    "Succeeded"
                                                ],
                                                "Set__Certs_HTML_Table":  [
                                                    "Succeeded"
                                                ],
                                                "Set_Fingerprints_HTML_Table":  [
                                                    "Succeeded"
                                                ],
                                                "Set_HTML_Table_For_Whois_General":  [
                                                    "Succeeded"
                                                ],
                                                "Set_HTML_Table_For_Whois_Admin":  [
                                                    "Succeeded"
                                                ],
                                                "Set_HTML_Table_For_Whois_Tech":  [
                                                    "Succeeded"
                                                ],
                                                "Set_HTML_Table_For_Whois_Organization":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "SetVariable",
                                            "inputs":  {
                                                "name":  "certs_data",
                                                "value":  "@if(empty(body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['certs']?['top_certs']), null, take(sort(body('Parse_JSON_For_IP_Indicator_Details_Data')?['summary']?['certs']?['top_certs'], 'valid_days'), 10))"
                                            }
                                        }
                                    },
                                    "runAfter":  {
                                        "HTTP_Request_To_Fetch_Details_Of_IP_Indicator":  [
                                            "Succeeded",
                                            "TimedOut",
                                            "Failed",
                                            "Skipped"
                                        ]
                                    },
                                    "else":  {
                                        "actions":  {
                                        }
                                    },
                                    "expression":  {
                                        "and":  [
                                            {
                                                "equals":  [
                                                    "@outputs('HTTP_Request_To_Fetch_Details_Of_IP_Indicator')['statusCode']",
                                                    200
                                                ]
                                            }
                                        ]
                                    },
                                    "type":  "If"
                                }
                            },
                            "runAfter":  {
                                "For_Each_Domain_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach",
                            "runtimeConfiguration":  {
                                "concurrency":  {
                                    "repetitions":  1
                                }
                            }
                        },
                        "Initialize_IP_List_Associated_With_Domain":  {
                            "runAfter":  {
                                "Initialize_Scout_Link":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "ip_list_associated_with_domain",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "For_Each_Domain_Name":  {
                            "foreach":  "@variables('domain_list')",
                            "actions":  {
                                "HTTP_Request_To_Fetch_Details_Of_Domain_Indicator":  {
                                    "type":  "Http",
                                    "inputs":  {
                                        "uri":  "@{variables('base_url')}/api/scout/search",
                                        "method":  "GET",
                                        "queries":  {
                                            "query":  "@{items('For_Each_Domain_Name')}"
                                        },
                                        "authentication":  {
                                            "password":  "@parameters('password')",
                                            "type":  "Basic",
                                            "username":  "@variables('username')"
                                        }
                                    },
                                    "runtimeConfiguration":  {
                                        "secureData":  {
                                            "properties":  [
                                                "inputs",
                                                "outputs"
                                            ]
                                        }
                                    }
                                },
                                "Condition_To_Verify_Domain_Indicator_Details_Data_Fetched_Successfully":  {
                                    "actions":  {
                                        "Condition_To_Check_Data_Found_For_Domain":  {
                                            "actions":  {
                                                "Condition_To_Verify_Comment_Count_Is_Less_Than_99":  {
                                                    "actions":  {
                                                        "Add_Domain_Data_Into_Incident_Comment":  {
                                                            "runAfter":  {
                                                                "Set_Scout_Link_For_Domain":  [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type":  "ApiConnection",
                                                            "inputs":  {
                                                                "host":  {
                                                                    "connection":  {
                                                                        "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                                                    }
                                                                },
                                                                "method":  "post",
                                                                "body":  {
                                                                    "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                                    "message":  "\u003cp class=\"editor-paragraph\"\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eDomain:\u003c/strong\u003e\u003c/b\u003e @{items('For_Each_Domain_Name')}\u003c/p\u003e\u003cp class=\"editor-paragraph\"\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eList of Associated IPs: \u003c/strong\u003e\u003c/b\u003e@{variables('domain_html_table')}\u003c/p\u003e\u003cp class=\"editor-paragraph\"\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eTeam Cymru Scout link for more information:\u003c/strong\u003e\u003c/b\u003e @{variables('scout_link')}\u003c/p\u003e\u003cbr\u003e"
                                                                },
                                                                "path":  "/Incidents/Comment"
                                                            }
                                                        },
                                                        "Set_Scout_Link_For_Domain":  {
                                                            "type":  "SetVariable",
                                                            "inputs":  {
                                                                "name":  "scout_link",
                                                                "value":  "\u003ca href=\"@{variables('base_url')}/scout?query=@{items('For_Each_Domain_Name')}\"\u003e@{variables('base_url')}/scout?query=@{items('For_Each_Domain_Name')}\u003c/a\u003e"
                                                            }
                                                        },
                                                        "Increase_Comment_Count_For_Adding_Domain_Data":  {
                                                            "runAfter":  {
                                                                "Add_Domain_Data_Into_Incident_Comment":  [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type":  "IncrementVariable",
                                                            "inputs":  {
                                                                "name":  "comment_count",
                                                                "value":  1
                                                            }
                                                        }
                                                    },
                                                    "runAfter":  {
                                                        "Complete_Domain_HTML_Table":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else":  {
                                                        "actions":  {
                                                            "Condition_To_Verify_Comment_Count_Is_99":  {
                                                                "actions":  {
                                                                    "Add_Comment_Limit_Has_Been_Exceeded_For_Incident":  {
                                                                        "type":  "ApiConnection",
                                                                        "inputs":  {
                                                                            "host":  {
                                                                                "connection":  {
                                                                                    "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                                                                }
                                                                            },
                                                                            "method":  "post",
                                                                            "body":  {
                                                                                "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                                                "message":  "\u003cp class=\"editor-paragraph\"\u003eComment limit to an incident has been breached.\u003c/p\u003e"
                                                                            },
                                                                            "path":  "/Incidents/Comment"
                                                                        }
                                                                    },
                                                                    "Increment_Comment_Count_To_Limit":  {
                                                                        "runAfter":  {
                                                                            "Add_Comment_Limit_Has_Been_Exceeded_For_Incident":  [
                                                                                "Succeeded"
                                                                            ]
                                                                        },
                                                                        "type":  "IncrementVariable",
                                                                        "inputs":  {
                                                                            "name":  "comment_count",
                                                                            "value":  1
                                                                        }
                                                                    }
                                                                },
                                                                "else":  {
                                                                    "actions":  {
                                                                    }
                                                                },
                                                                "expression":  {
                                                                    "and":  [
                                                                        {
                                                                            "equals":  [
                                                                                "@variables('comment_count')",
                                                                                99
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                "type":  "If"
                                                            }
                                                        }
                                                    },
                                                    "expression":  {
                                                        "and":  [
                                                            {
                                                                "less":  [
                                                                    "@variables('comment_count')",
                                                                    99
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type":  "If"
                                                },
                                                "Set_Top_10_IP_By_Event_Count_Into_Associated_IP_List":  {
                                                    "runAfter":  {
                                                        "Set_Domain_HTML_Table":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "ip_list_associated_with_domain",
                                                        "value":  "@if(empty(body('Parse_JSON_For_Domain_Data')?['ips']), null, take(reverse(sort(body('Parse_JSON_For_Domain_Data')?['ips'], 'event_count')), 10))"
                                                    }
                                                },
                                                "For_Each_Top_IP":  {
                                                    "foreach":  "@variables('ip_list_associated_with_domain')",
                                                    "actions":  {
                                                        "Append_Domain_Information_To_Domain_HTML_Table":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "domain_html_table",
                                                                "value":  "\u003ctr\u003e\u003ctd\u003e@{items('For_Each_Top_IP')?['ip']}\u003c/td\u003e\u003ctd\u003e@{items('For_Each_Top_IP')?['event_count']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "runAfter":  {
                                                        "Set_Top_10_IP_By_Event_Count_Into_Associated_IP_List":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Foreach",
                                                    "runtimeConfiguration":  {
                                                        "concurrency":  {
                                                            "repetitions":  1
                                                        }
                                                    }
                                                },
                                                "Complete_Domain_HTML_Table":  {
                                                    "runAfter":  {
                                                        "For_Each_Top_IP":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "domain_html_table",
                                                        "value":  "\u003c/table\u003e"
                                                    }
                                                },
                                                "Send_An_Email_For_Domain":  {
                                                    "runAfter":  {
                                                        "Condition_To_Verify_Comment_Count_Is_Less_Than_99":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "ApiConnection",
                                                    "inputs":  {
                                                        "host":  {
                                                            "connection":  {
                                                                "name":  "@parameters('$connections')['outlook']['connectionId']"
                                                            }
                                                        },
                                                        "method":  "post",
                                                        "body":  {
                                                            "To":  "@variables('email_recipient')",
                                                            "Subject":  "A Domain has been identified, and comment has been added for it in Sentinel Incident.\nDomain Name: @{items('For_Each_Domain_Name')} ",
                                                            "Body":  "\u003cp class=\"editor-paragraph\"\u003eA Domain has been identified, and comment has been added for it in Sentinel Incident.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eIncident URL:\u003c/strong\u003e\u003c/b\u003e @{triggerBody()?['object']?['properties']?['incidentUrl']}\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eDomain Name:\u003c/strong\u003e\u003c/b\u003e @{items('For_Each_Domain_Name')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eFor More Information:\u003c/strong\u003e\u003c/b\u003e @{variables('scout_link')}\u003cbr\u003e\u003cb\u003e\u003cstrong class=\"editor-text-bold\"\u003eList of Associated IPs:\u003c/strong\u003e\u003c/b\u003e @{variables('domain_html_table')}\u003c/p\u003e",
                                                            "Importance":  "Normal"
                                                        },
                                                        "path":  "/v2/Mail"
                                                    }
                                                },
                                                "Set_Domain_HTML_Table":  {
                                                    "type":  "SetVariable",
                                                    "inputs":  {
                                                        "name":  "domain_html_table",
                                                        "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eIP\u003c/th\u003e\u003cth\u003eEvent\u003c/th\u003e\u003c/tr\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Parse_JSON_For_Domain_Data":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "not":  {
                                                            "equals":  [
                                                                "@body('Parse_JSON_For_Domain_Data')?['ips']",
                                                                "@null"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        },
                                        "Parse_JSON_For_Domain_Data":  {
                                            "type":  "ParseJson",
                                            "inputs":  {
                                                "content":  "@body('HTTP_Request_To_Fetch_Details_Of_Domain_Indicator')",
                                                "schema":  {
                                                    "properties":  {
                                                        "end_date":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "ips":  {
                                                            "items":  {
                                                                "properties":  {
                                                                    "as_info":  {
                                                                        "items":  {
                                                                            "properties":  {
                                                                                "as_name":  {
                                                                                    "type":  [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "asn":  {
                                                                                    "type":  [
                                                                                        "integer",
                                                                                        "null"
                                                                                    ]
                                                                                }
                                                                            },
                                                                            "required":  [
                                                                                "asn",
                                                                                "as_name"
                                                                            ],
                                                                            "type":  [
                                                                                "object",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "type":  [
                                                                            "array",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "country_codes":  {
                                                                        "items":  {
                                                                            "type":  [
                                                                                "string",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "type":  [
                                                                            "array",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "event_count":  {
                                                                        "type":  [
                                                                            "integer",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "ip":  {
                                                                        "type":  [
                                                                            "string",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "summary":  {
                                                                        "properties":  {
                                                                            "certs":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "common_name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "event_count":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "ip":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "issuer":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "issuer_common_name":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "port":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "ip",
                                                                                        "issuer",
                                                                                        "issuer_common_name",
                                                                                        "common_name",
                                                                                        "port",
                                                                                        "event_count"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "comms_total":  {
                                                                                "type":  [
                                                                                    "integer",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "fingerprints":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "event_count":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "ip":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "signature":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "type":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "ip",
                                                                                        "type",
                                                                                        "signature",
                                                                                        "event_count"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "last_seen":  {
                                                                                "type":  [
                                                                                    "string",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "open_ports":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "event_count":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "ip":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "port":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "protocol":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "protocol_text":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "service":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "ip",
                                                                                        "port",
                                                                                        "protocol",
                                                                                        "protocol_text",
                                                                                        "service",
                                                                                        "event_count"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "pdns":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "domain":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "event_count":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "ip":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "ip",
                                                                                        "domain",
                                                                                        "event_count"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "service_counts":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "event_count":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "port":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "proto":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "proto_text":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "service":  {
                                                                                            "properties":  {
                                                                                                "description":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "port":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "proto_number":  {
                                                                                                    "type":  [
                                                                                                        "integer",
                                                                                                        "null"
                                                                                                    ]
                                                                                                },
                                                                                                "service_name":  {
                                                                                                    "type":  [
                                                                                                        "string",
                                                                                                        "null"
                                                                                                    ]
                                                                                                }
                                                                                            },
                                                                                            "type":  [
                                                                                                "object",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "proto",
                                                                                        "proto_text",
                                                                                        "port",
                                                                                        "event_count",
                                                                                        "service"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "top_peers":  {
                                                                                "items":  {
                                                                                    "properties":  {
                                                                                        "event_count":  {
                                                                                            "type":  [
                                                                                                "integer",
                                                                                                "null"
                                                                                            ]
                                                                                        },
                                                                                        "ip":  {
                                                                                            "type":  [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "required":  [
                                                                                        "ip",
                                                                                        "event_count"
                                                                                    ],
                                                                                    "type":  [
                                                                                        "object",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "type":  [
                                                                                    "array",
                                                                                    "null"
                                                                                ]
                                                                            },
                                                                            "whois":  {
                                                                                "properties":  {
                                                                                    "as_name":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "asn":  {
                                                                                        "type":  [
                                                                                            "integer",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "net_name":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "org_name":  {
                                                                                        "type":  [
                                                                                            "string",
                                                                                            "null"
                                                                                        ]
                                                                                    }
                                                                                },
                                                                                "type":  [
                                                                                    "object",
                                                                                    "null"
                                                                                ]
                                                                            }
                                                                        },
                                                                        "type":  [
                                                                            "object",
                                                                            "null"
                                                                        ]
                                                                    },
                                                                    "tags":  {
                                                                        "items":  {
                                                                            "properties":  {
                                                                                "children":  {
                                                                                    "items":  {
                                                                                        "properties":  {
                                                                                            "id":  {
                                                                                                "type":  [
                                                                                                    "integer",
                                                                                                    "null"
                                                                                                ]
                                                                                            },
                                                                                            "name":  {
                                                                                                "type":  [
                                                                                                    "string",
                                                                                                    "null"
                                                                                                ]
                                                                                            }
                                                                                        },
                                                                                        "required":  [
                                                                                            "id",
                                                                                            "name",
                                                                                            "children"
                                                                                        ],
                                                                                        "type":  [
                                                                                            "object",
                                                                                            "null"
                                                                                        ]
                                                                                    },
                                                                                    "type":  [
                                                                                        "array",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "id":  {
                                                                                    "type":  [
                                                                                        "integer",
                                                                                        "null"
                                                                                    ]
                                                                                },
                                                                                "name":  {
                                                                                    "type":  [
                                                                                        "string",
                                                                                        "null"
                                                                                    ]
                                                                                }
                                                                            },
                                                                            "required":  [
                                                                                "id",
                                                                                "name",
                                                                                "children"
                                                                            ],
                                                                            "type":  [
                                                                                "object",
                                                                                "null"
                                                                            ]
                                                                        },
                                                                        "type":  [
                                                                            "array",
                                                                            "null"
                                                                        ]
                                                                    }
                                                                },
                                                                "required":  [
                                                                    "ip",
                                                                    "country_codes",
                                                                    "as_info",
                                                                    "tags",
                                                                    "event_count",
                                                                    "summary"
                                                                ],
                                                                "type":  [
                                                                    "object",
                                                                    "null"
                                                                ]
                                                            },
                                                            "type":  [
                                                                "array",
                                                                "null"
                                                            ]
                                                        },
                                                        "query":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "request_id":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "size":  {
                                                            "type":  [
                                                                "integer",
                                                                "null"
                                                            ]
                                                        },
                                                        "start_date":  {
                                                            "type":  [
                                                                "string",
                                                                "null"
                                                            ]
                                                        },
                                                        "total":  {
                                                            "type":  [
                                                                "integer",
                                                                "null"
                                                            ]
                                                        }
                                                    },
                                                    "type":  "object"
                                                }
                                            }
                                        }
                                    },
                                    "runAfter":  {
                                        "HTTP_Request_To_Fetch_Details_Of_Domain_Indicator":  [
                                            "Succeeded",
                                            "TimedOut",
                                            "Skipped",
                                            "Failed"
                                        ]
                                    },
                                    "else":  {
                                        "actions":  {
                                        }
                                    },
                                    "expression":  {
                                        "and":  [
                                            {
                                                "equals":  [
                                                    "@outputs('HTTP_Request_To_Fetch_Details_Of_Domain_Indicator')['statusCode']",
                                                    200
                                                ]
                                            }
                                        ]
                                    },
                                    "type":  "If"
                                }
                            },
                            "runAfter":  {
                                "For_Each_Entity":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach",
                            "runtimeConfiguration":  {
                                "concurrency":  {
                                    "repetitions":  1
                                }
                            }
                        },
                        "Initialize_Count_Of_Incident_Comment":  {
                            "runAfter":  {
                                "Initialize_Insights_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Certs_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Fingerprints_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Open_Ports_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Pdns_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Whois_Data":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "comment_count",
                                        "type":  "integer",
                                        "value":  "@length(triggerBody()?['object']?['properties']?['Comments'])"
                                    }
                                ]
                            }
                        },
                        "Initialize_Domain_HTML_Table":  {
                            "runAfter":  {
                                "Initialize_Indicators_Table_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "domain_html_table",
                                        "type":  "string",
                                        "value":  "\u003ctable border=\"1\"\u003e\u003ctr\u003e\u003cth\u003eIP\u003c/th\u003e\u003cth\u003eEvent\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Initialize_Base_URL":  {
                            "runAfter":  {
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "base_url",
                                        "type":  "string",
                                        "value":  "[parameters('BaseURL')]"
                                    }
                                ]
                            }
                        },
                        "Initialize_User_Name":  {
                            "runAfter":  {
                                "Initialize_Top_Certs_API_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Fingerprints_API_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Open_Ports_API_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Pdns_API_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Insights_API_Data":  [
                                    "Succeeded"
                                ],
                                "Initialize_Whois_API_Data":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "username",
                                        "type":  "string",
                                        "value":  "@parameters('username')"
                                    }
                                ]
                            }
                        },
                        "Initialize_Temporary_List":  {
                            "runAfter":  {
                                "Initialize_Scout_Link":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "temp_list",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Insights_Data_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Domain_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "insights_table_name",
                                        "type":  "string",
                                        "value":  "Insights_Data_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_Insights_Data":  {
                            "runAfter":  {
                                "Initialize_User_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "insights_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Whois_Sections_Data_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Domain_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_table_name",
                                        "type":  "string",
                                        "value":  "Whois_Data_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_Scout_Link":  {
                            "runAfter":  {
                                "Initialize_Open_Ports_HTML_Table":  [
                                    "Succeeded"
                                ],
                                "Initialize_PDNS_HTML_Table":  [
                                    "Succeeded"
                                ],
                                "Initialize_Certs_HTML_Table":  [
                                    "Succeeded"
                                ],
                                "Initialize_Fingerprints_HTML_Table":  [
                                    "Succeeded"
                                ],
                                "Initialize_HTML_Table_For_Whois_General":  [
                                    "Succeeded"
                                ],
                                "Initialize_HTML_Table_For_Whois_Admin":  [
                                    "Succeeded"
                                ],
                                "Initialize_HTML_Table_For_Whois_Tech":  [
                                    "Succeeded"
                                ],
                                "Initialize_HTML_Table_For_Whois_Organization":  [
                                    "Succeeded"
                                ],
                                "Initialize_Insights_HTML_Table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "scout_link",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_Indicator_Object":  {
                            "runAfter":  {
                                "Initialize_Top_Certs_Section_Data_Table_Name":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Fingerprints_Section_Data_Table_Name":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Open_Ports_Section_Data_Table_Name":  [
                                    "Succeeded"
                                ],
                                "Initialize_Top_Pdns_Section_Data_Table_Name":  [
                                    "Succeeded"
                                ],
                                "Initialize_Whois_Sections_Data_Table_Name":  [
                                    "Succeeded"
                                ],
                                "Initialize_Insights_Data_Table_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "indicator_object",
                                        "type":  "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Email_ID":  {
                            "runAfter":  {
                                "Initialize_Base_URL":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "email_recipient",
                                        "type":  "string",
                                        "value":  "@{parameters('email_id')}"
                                    }
                                ]
                            }
                        },
                        "Initialize_Indicators_Table_Name":  {
                            "runAfter":  {
                                "Initialize_Overall_Rating":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "indicators_table_name",
                                        "type":  "string",
                                        "value":  "Investigated_IPs_Incident_Based"
                                    }
                                ]
                            }
                        },
                        "Initialize_Whois_Data":  {
                            "runAfter":  {
                                "Initialize_User_Name":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_data",
                                        "type":  "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Certs_API_Data":  {
                            "runAfter":  {
                                "Initialize_Email_ID":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "certs_api_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Fingerprints_API_Data":  {
                            "runAfter":  {
                                "Initialize_Email_ID":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "fingerprints_api_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Open_Ports_API_Data":  {
                            "runAfter":  {
                                "Initialize_Email_ID":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "open_ports_api_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Top_Pdns_API_Data":  {
                            "runAfter":  {
                                "Initialize_Email_ID":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "pdns_api_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Insights_API_Data":  {
                            "runAfter":  {
                                "Initialize_Email_ID":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "insights_api_data",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_Whois_API_Data":  {
                            "runAfter":  {
                                "Initialize_Email_ID":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_api_data",
                                        "type":  "object"
                                    }
                                ]
                            }
                        },
                        "Initialize_Open_Ports_HTML_Table":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "open_ports_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_PDNS_HTML_Table":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "pdns_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_Certs_HTML_Table":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "certs_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_Fingerprints_HTML_Table":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "fingerprints_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_HTML_Table_For_Whois_General":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_general_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_HTML_Table_For_Whois_Admin":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_admin_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_HTML_Table_For_Whois_Tech":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_tech_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_HTML_Table_For_Whois_Organization":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "whois_organization_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_Insights_HTML_Table":  {
                            "runAfter":  {
                                "Initialize_Indicator_Object":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "insights_html_table",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_Country_Code":  {
                            "runAfter":  {
                                "Initialize_Count_Of_Incident_Comment":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "country_code",
                                        "type":  "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_Overall_Rating":  {
                            "runAfter":  {
                                "Initialize_Country_Code":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "overall_rating",
                                        "type":  "string"
                                    }
                                ]
                            }
                        }
                    },
                    "outputs":  {
                    }
                },
                "parameters":  {
                    "password":  {
                    },
                    "$connections":  {
                        "value":  {
                            "azuresentinel":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                                "connectionName":  "[variables('MicrosoftSentinelConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel')]",
                                "connectionProperties":  {
                                    "authentication":  {
                                        "type":  "ManagedServiceIdentity"
                                    }
                                }
                            },
                            "azureloganalyticsdatacollector":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('AzureloganalyticsdatacollectorConnectionName'))]",
                                "connectionName":  "[variables('AzureloganalyticsdatacollectorConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azureloganalyticsdatacollector')]"
                            },
                            "azuremonitorlogs":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]",
                                "connectionName":  "[variables('AzuremonitorlogsConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuremonitorlogs')]"
                            },
                            "outlook":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('OutlookConnectionName'))]",
                                "connectionName":  "[variables('OutlookConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Outlook')]"
                            }
                        }
                    }
                }
            },
            "name":  "[parameters('PlaybookName')]",
            "type":  "Microsoft.Logic/workflows",
            "location":  "[resourceGroup().location]",
            "tags":  {
                "environment":  "Production",
                "hidden-SentinelTemplateName":  "TeamCymruScoutEnrichIncident",
                "hidden-SentinelTemplateVersion":  "1.0"
            },
            "identity":  {
                "type":  "SystemAssigned"
            },
            "apiVersion":  "2017-07-01",
            "dependsOn":  [
                "[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('AzureloganalyticsdatacollectorConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('OutlookConnectionName'))]"
            ]
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('MicrosoftSentinelConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('MicrosoftSentinelConnectionName')]",
                "customParameterValues":  {
                },
                "parameterValueType": "Alternative",
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('AzureloganalyticsdatacollectorConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('AzureloganalyticsdatacollectorConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azureloganalyticsdatacollector')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('AzuremonitorlogsConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('AzuremonitorlogsConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuremonitorlogs')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('OutlookConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('OutlookConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Outlook')]"
                }
            }
        }
    ]
}
