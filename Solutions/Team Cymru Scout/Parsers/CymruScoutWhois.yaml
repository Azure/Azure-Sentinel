id: de724888-764f-4cfb-9882-804269deb40b
Function:
  Title: Parser for CymruScoutWhois
  Version: "1.0.0"
  LastUpdated: "2024-07-08"
Category: Microsoft Sentinel Parser
FunctionName: CymruScoutWhois
FunctionAlias: CymruScoutWhois
FunctionQuery: |
  let CymruScoutWhois = view(){
  Whois_Data_CL
  | extend
      IP = column_ifexists("ip_s", ""),
      Asn = column_ifexists("asn_d", ""),
      Cidr = column_ifexists("cidr_s", ""),
      CC = column_ifexists("cc_s", ""),
      City = column_ifexists("city_s", ""),
      Address = column_ifexists("address_s", ""),
      Modified = column_ifexists("modified_s", ""),
      ['As Name'] = column_ifexists("as_name_s", ""),
      ['Bgp Asn'] = column_ifexists("bgp_asn_d", ""),
      ['Bgp Asn Name'] = column_ifexists("bgp_asn_name_s", ""),
      ['Net Name'] = column_ifexists("net_name_s", ""),
      ['Net Handle'] = column_ifexists("net_handle_s", ""),
      ['Description'] = column_ifexists("description_s", ""),
      ['Abuse Contact Id'] = column_ifexists("abuse_contact_id_s", ""),
      ['About Contact Role'] = column_ifexists("about_contact_role_s", ""),
      ['About Contact Person'] = column_ifexists("about_contact_person_s", ""),
      ['About Contact Email'] = column_ifexists("about_contact_email_s", ""),
      ['About Contact Phone'] = column_ifexists("about_contact_phone_s", ""),
      ['About Contact Country'] = column_ifexists("about_contact_country_s", ""),
      ['About Contact City'] = column_ifexists("about_contact_city_s", ""),
      ['About Contact Address'] = column_ifexists("about_contact_address_s", ""),
      ['Admin Contact Id'] = column_ifexists("admin_contact_id_s", ""),
      ['Admin Contact Role'] = column_ifexists("admin_contact_role_s", ""),
      ['Admin Contact Person'] = column_ifexists("admin_contact_person_s", ""),
      ['Admin Contact Email'] = column_ifexists("admin_contact_email_s", ""),
      ['Admin Contact Phone'] = column_ifexists("admin_contact_phone_s", ""),
      ['Admin Contact Country'] = column_ifexists("admin_contact_country_s", ""),
      ['Admin Contact City'] = column_ifexists("admin_contact_city_s", ""),
      ['Admin Contact Address'] = column_ifexists("admin_contact_address_s", ""),
      ['Tech Contact Id'] = column_ifexists("tech_contact_id_s", ""),
      ['Tech Contact Role'] = column_ifexists("tech_contact_role_s", ""),
      ['Tech Contact Person'] = column_ifexists("tech_contact_person_s", ""),
      ['Tech Contact Email'] = column_ifexists("tech_contact_email_s", ""),
      ['Tech Contact Phone'] = column_ifexists("tech_contact_phone_s", ""),
      ['Tech Contact Country'] = column_ifexists("tech_contact_country_s", ""),
      ['Tech Contact City'] = column_ifexists("tech_contact_city_s", ""),
      ['Tech Contact Address'] = column_ifexists("tech_contact_address_s", ""),
      ['Org Id'] = column_ifexists("org_id_s", ""),
      ['Org Name'] = column_ifexists("org_name_s", ""),
      ['Org Email'] = column_ifexists("org_email_s", ""),
      ['Org Phone'] = column_ifexists("org_phone_s", ""),
      ['Org Country'] = column_ifexists("org_country_s", ""),
      ['Org City'] = column_ifexists("org_city_s", ""),
      ['Org Address'] = column_ifexists("org_address_s", ""),
      ['Mnt By Email'] = column_ifexists("mnt_by_email_s", ""),
      ['Mnt Lower Email'] = column_ifexists("mnt_lower_email_s", ""),
      ['Mnt Router Email'] = column_ifexists("mnt_router_email_s", "")
  | project
      IP,
      Asn,
      Cidr,
      CC,
      City,
      Address,
      Modified,
      TimeGenerated,
      ['As Name'],
      ['Bgp Asn'],
      ['Bgp Asn Name'],
      ['Net Name'],
      ['Net Handle'],
      ['Description'],
      ['Abuse Contact Id'],
      ['About Contact Role'],
      ['About Contact Person'],
      ['About Contact Email'],
      ['About Contact Phone'],
      ['About Contact Country'],
      ['About Contact City'],
      ['About Contact Address'],
      ['Admin Contact Id'],
      ['Admin Contact Role'],
      ['Admin Contact Person'],
      ['Admin Contact Email'],
      ['Admin Contact Phone'],
      ['Admin Contact Country'],
      ['Admin Contact City'],
      ['Admin Contact Address'],
      ['Tech Contact Id'],
      ['Tech Contact Role'],
      ['Tech Contact Person'],
      ['Tech Contact Email'],
      ['Tech Contact Phone'],
      ['Tech Contact Country'],
      ['Tech Contact City'],
      ['Tech Contact Address'],
      ['Org Id'],
      ['Org Name'],
      ['Org Email'],
      ['Org Phone'],
      ['Org Country'],
      ['Org City'],
      ['Org Address'],
      ['Mnt By Email'],
      ['Mnt Lower Email'],
      ['Mnt Router Email']
  };
  CymruScoutWhois