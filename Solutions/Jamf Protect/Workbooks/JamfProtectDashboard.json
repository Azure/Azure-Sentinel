{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "b608e714-b3ec-4380-b666-1aa781513ab4",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "value": [],
            "typeSettings": {
              "additionalResourceOptions": [],
              "includeAll": false
            },
            "label": "‚òÅÔ∏è Subscription"
          },
          {
            "id": "f408f1cf-dbcb-4f57-9409-272374bd3cd4",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "query": "Resources | where type =~ \"microsoft.operationalinsights/workspaces\" | order by name | project id, name, selected=row_number()==1, group=resourceGroup",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "label": "üóÇÔ∏è Workspace",
            "value": ""
          },
          {
            "id": "397d983f-ea80-4aa5-8c65-547d40cb312b",
            "version": "KqlParameterItem/1.0",
            "name": "_timetoken",
            "label": "‚è±Ô∏è Time Range",
            "type": 4,
            "isRequired": true,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "value": {
              "durationMs": 172800000
            }
          },
          {
            "id": "d716fb1e-0d71-4e99-9406-18ae7df6e037",
            "version": "KqlParameterItem/1.0",
            "name": "changelog",
            "label": "üìñ Changelog",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n { \"value\": \"Yes\", \"label\": \"Yes\"},\r\n {\"value\": \"No\", \"label\": \"No\", \"selected\":true }\r\n]"
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameters Picker"
    },
    {
      "type": 1,
      "content": {
        "json": "## Jamf Protect for Microsoft Sentinel!\n\nThe [Jamf Protect](https://www.jamf.com/solutions/threat-prevention-remediation/) for Microsoft Sentinel solution creates detailed event data from macOS endpoints into a Microsoft Sentinel workspace in a simple and easy workflow. The solution provides you with full visibility into Apple Endpoint Security by leveraging Workbooks containing [Alert](https://docs.jamf.com/jamf-protect/documentation/Alerts.html) and [Unified Logging](https://docs.jamf.com/jamf-protect/documentation/Unified_Logging.html) events captured by Jamf Protect and the [macOS built-in security events](https://support.apple.com/en-gb/guide/security/sec469d47bd8/web) that occurred across the protected organisational endpoints\n\n\n#### Changelog\n\n**v2.2.0**\n\n***Workbook***\n - Added System Performance Metrics\n    - Includes Energy Impact\n - Added Network Traffic Stream\n - Updated Workbook to make use of the newly added parser\n - Added and tweaked querys and graphs\n\n ***Parser***\n - Added JamfProtect parser for parsing and mapping all incoming raw data.\n\n ***Analytic Rules***\n - Updated Analytic Rules to make use of the newly added parser. \n\t\n**v2.1**\n\n***Workbook***\n - Added Endpoint Telemetry\n    - Includes graphs and visualisations\n\t- Includes Endpoint Information\n\t- Includes Jamf Pro log parser\n- Added Network Threat Events\n \t- Includes graphs and visualisations\n- Added new Pickers\n    - Allows selecting different Log Analytic Workspaces\n    - Changed TimeRanger picker\n- Added Changelog\n\n**Analytic Rules**\n\n- Added Analytic Rules\n\t- Jamf Protect - Alerts\n\t- Jamf Protect - Unified Logs\n\t- Jamf Protect - Network Threat Events\n\n\n **v2.0**\n \n- Initial release of the solution containing a basic Workbook\n"
      },
      "conditionalVisibility": {
        "parameterName": "changelog",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "Text - Changelog"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Threat Hunting {_timetoken:value}",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 1,
            "content": {
              "json": "Set an type and provide values to search on File hash, CVE numbers or report on Alerts mapped to the MITRE framework or display latest alerts for a single endpoint.",
              "style": "info"
            },
            "name": "Text - Threat Hunting",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "5f5886d0-e83e-4ffc-a48c-bfed7370aa66",
                  "version": "KqlParameterItem/1.0",
                  "name": "_type",
                  "label": "Type",
                  "type": 2,
                  "description": "Please choose the type",
                  "isGlobal": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\n    { \"value\":\"filehash\", \"label\":\"File Hash\" },\n    { \"value\":\"CVE\", \"label\":\"CVE\" },\n    { \"value\":\"mitre\", \"label\":\"Framework: MITRE\" },\n    { \"value\":\"endpointalerts\", \"label\":\"Latest alerts for a single endpoint\" }\n]",
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "15",
            "name": "Picker - Threat Hunting Type"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "49255f47-8f93-4746-8260-aad07befdb06",
                  "version": "KqlParameterItem/1.0",
                  "name": "_hostnamealert",
                  "label": "Hostname",
                  "type": 2,
                  "query": "JamfProtect\n| where isnotempty(DvcHostname)\n   | project-keep DvcHostname\n| project-rename Hostname = DvcHostname\n| summarize by Hostname",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "_timetoken",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibilities": [
              {
                "parameterName": "_type",
                "comparison": "isNotEqualTo",
                "value": "null"
              },
              {
                "parameterName": "_type",
                "comparison": "isEqualTo",
                "value": "endpointalerts"
              }
            ],
            "name": "Picker - Threat Hunting Hostname"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "bcdd945e-4dfe-47d6-9489-f76ce012c224",
                  "version": "KqlParameterItem/1.0",
                  "name": "_filehash",
                  "label": "File Hash",
                  "type": 1,
                  "description": "Thish value can be used for searching all alerts for a certain hash",
                  "isRequired": true,
                  "isGlobal": true,
                  "value": "5e54bccbd4d93447e79cda0558b0b308a186c2be571c739e5460a3cb6ef665c0"
                }
              ],
              "style": "formHorizontal",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "_type",
              "comparison": "isEqualTo",
              "value": "filehash"
            },
            "name": "Search - Threat Hunting Hash"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "0344768b-16c4-44ec-a4ac-73a8bc83d0e2",
                  "version": "KqlParameterItem/1.0",
                  "name": "_CVE",
                  "label": "CVE Number",
                  "type": 1,
                  "description": "Please search on the CVE number",
                  "isRequired": true,
                  "isGlobal": true,
                  "value": "T15"
                }
              ],
              "style": "formHorizontal",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "_type",
              "comparison": "isEqualTo",
              "value": "CVE"
            },
            "name": "Search - Threat Hunting CVE"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"ProcessPrevented\" or EventType == \"ProcessCreated\"\n| where TargetProcessSHA1 has \"{_filehash:value}\" or TargetBinarySHA256 has \"{_filehash:value}\"\n| project-keep\n    TimeGenerated,\n    EventStartTime,\n    EventMatch,\n    EventSeverity,\n    EventMatchType,\n    TargetProcessCommandLine,\n    DvcHostname,\n    EventReportUrl\n| project-reorder\n    TimeGenerated,\n    EventStartTime,\n    EventMatch,\n    EventSeverity,\n    EventMatchType,\n    TargetProcessCommandLine,\n    DvcHostname,\n    EventReportUrl\n| sort by TimeGenerated",
              "size": 4,
              "title": "Matches on FileHash",
              "noDataMessage": "No matches found based on the hash value",
              "timeContextFromParameter": "_timetoken",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "EventReportUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Click to navigate to original event in Jamf Protect"
                    }
                  }
                ]
              }
            },
            "conditionalVisibilities": [
              {
                "parameterName": "_filehash",
                "comparison": "isNotEqualTo",
                "value": "null"
              },
              {
                "parameterName": "_type",
                "comparison": "isEqualTo",
                "value": "filehash"
              }
            ],
            "name": "Query - Threat Hunting Hash"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where Match_tags contains \"{_CVE:value}\"\n| project-keep\n    TimeGenerated,\n    EventStartTime,\n    EventMatch,\n    Match_tags,\n    EventSeverity,\n    EventMatchType,\n    TargetProcessCommandLine,\n    DvcHostname,\n    EventReportUrl\n| project-reorder\n    TimeGenerated,\n    EventStartTime,\n    EventMatch,\n    Match_tags,\n    EventSeverity,\n    EventMatchType,\n    TargetProcessCommandLine,\n    DvcHostname,\n    EventReportUrl\n| sort by TimeGenerated",
              "size": 1,
              "title": "Matches on CVE",
              "noDataMessage": "No matches found based on the _CVE:value CVE number",
              "timeContextFromParameter": "_timetoken",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "EventReportUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Click to nagivate to original event in Jamf Protect"
                    }
                  }
                ]
              }
            },
            "conditionalVisibilities": [
              {
                "parameterName": "_cve",
                "comparison": "isNotEqualTo",
                "value": "null"
              },
              {
                "parameterName": "_type",
                "comparison": "isEqualTo",
                "value": "CVE"
              }
            ],
            "name": "Query - Threat Hunting CVE"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where Match_tags contains \"MITREattack\"\n| extend\n    Tactics = case(Match_tags has \"Execution\", \"Execution\", Match_tags has \"Visibility\", \"Visibility\", Match_tags has \"Persistence\", \"Persistence\", Match_tags has \"LateralMovement\", \"Lateral Movement\", Match_tags has \"CredentialAccess\", \"Credential Acccess\", Match_tags has \"DefenseEvasion\", \"Defense Evasion\", Match_tags has \"PrivilegeEscalation\", \"Privilege Escalation\", Match_tags has \"Impact\", \"Impact\", Match_tags has \"CommandAndControl\", \"Command and Control\", Match_tags has \"Discovery\", \"Discovery\", Match_tags has \"InitialAccess\", \"Initial Access\", \"\"),\n      Techniques = extract(@\"[A-Za-z]\\d{4}\", 0, tostring(Match_tags))\n| project-keep\n    TimeGenerated,\n    EventStartTime,\n    EventType,\n    EventMessage,\n    EventDescription,\n    Tactics,\n    Techniques,\n    Match_tags,\n    EventSeverity,\n    DvcHostname,\n    EventReportUrl\n| project-reorder\n    TimeGenerated,\n    EventStartTime,\n    EventType,\n    EventMessage,\n    EventDescription,\n    Tactics,\n    Techniques,\n    Match_tags,\n    EventSeverity,\n    DvcHostname,\n    EventReportUrl\n| sort by TimeGenerated",
              "size": 1,
              "title": "Alerts mapped to MITRE",
              "noDataMessage": "No alerts found that are mapped to the MITRE framework",
              "timeContextFromParameter": "_timetoken",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "EventReportUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Click to navigate to original event in Jamf Protect"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "TimeGenerated",
                    "sortOrder": 1
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "TimeGenerated",
                  "sortOrder": 1
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "_type",
                "comparison": "isNotEqualTo",
                "value": "null"
              },
              {
                "parameterName": "_type",
                "comparison": "isEqualTo",
                "value": "mitre"
              }
            ],
            "name": "Query - Threat Hunting MITRE"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where DvcHostname contains \"{_hostnamealert:value}\"\n| where EventProduct == \"Jamf Protect - Alerts\" and isnotempty(EventType)\n| project-keep\n    TimeGenerated,\n    EventStartTime,\n    EventType,\n    EventMessage,\n    EventDescription,\n    Match_tags,\n    EventSeverity,\n    DvcHostname,\n    EventReportUrl\n| project-reorder\n    TimeGenerated,\n    EventStartTime,\n    EventType,\n    EventMessage,\n    EventDescription,\n    Match_tags,\n    EventSeverity,\n    DvcHostname,\n    EventReportUrl\n| sort by TimeGenerated\n| limit 10",
              "size": 1,
              "title": "Recent 10 alerts in the past {_timetoken:value} for {_hostnamealert:value}",
              "noDataMessage": "No alerts found",
              "timeContextFromParameter": "_timetoken",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "EventReportUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Click to nagivage to original event in Jamf Protect"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "TimeGenerated",
                    "sortOrder": 1
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "TimeGenerated",
                  "sortOrder": 1
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "_type",
                "comparison": "isNotEqualTo",
                "value": "null"
              },
              {
                "parameterName": "_type",
                "comparison": "isEqualTo",
                "value": "endpointalerts"
              },
              {
                "parameterName": "_hostnamealert",
                "comparison": "isNotEqualTo",
                "value": ""
              }
            ],
            "name": "Query - Threat Hunting 10 Recent Alerts Endpoint"
          }
        ]
      },
      "customWidth": "100",
      "name": "Group - Threat Hunting",
      "styleSettings": {
        "margin": "200",
        "padding": "200",
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\"\n| where isnotempty(EventType)\n| where EventSeverity != \"Informational\"\n| sort by EventStartTime\n| limit 10",
        "size": 0,
        "title": "Recent 10 alerts in the past {_timetoken:value}",
        "noDataMessage": "No alerts found",
        "timeContextFromParameter": "_timetoken",
        "showExportToExcel": true,
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "EventReportUrl",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Click to navigate to Alert in Jamf Protect"
              }
            },
            {
              "columnMatch": "AlertURL",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url"
              }
            }
          ],
          "filter": true,
          "sortBy": [
            {
              "itemKey": "TimeGenerated",
              "sortOrder": 1
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "TimeGenerated",
            "sortOrder": 1
          }
        ]
      },
      "name": "Query - 10 Recent Alerts"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "datatable (Count: long, severity: string) [\n    0, \"Informational\",\n    0, \"Low\",\n    0, \"Medium\",\n    0, \"High\"\n]\n| union\n    (\n    JamfProtect\n    | where EventProduct == \"Jamf Protect - Alerts\" \n        and isnotempty(EventType)\n        and EventSeverity != \"True\"\n    | summarize Count = count() by EventSeverity\n    )\n| where isnotempty(EventSeverity)\n| summarize Count=sum(Count) by EventSeverity",
        "size": 3,
        "title": "All Alerts {_timetoken:value}",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "EventSeverity",
            "formatter": 18,
            "formatOptions": {
              "thresholdsOptions": "colors",
              "thresholdsGrid": [
                {
                  "operator": "==",
                  "thresholdValue": "Informational",
                  "representation": "green",
                  "text": "{0}{1}"
                },
                {
                  "operator": "==",
                  "thresholdValue": "Low",
                  "representation": "yellow",
                  "text": "{0}{1}"
                },
                {
                  "operator": "==",
                  "thresholdValue": "Medium",
                  "representation": "orange",
                  "text": "{0}{1}"
                },
                {
                  "operator": "==",
                  "thresholdValue": "High",
                  "representation": "redBright",
                  "text": "{0}{1}"
                },
                {
                  "operator": "Default",
                  "thresholdValue": null,
                  "representation": "green",
                  "text": "{0}{1}"
                }
              ],
              "compositeBarSettings": {
                "labelText": "",
                "columnSettings": []
              }
            }
          },
          "leftContent": {
            "columnMatch": "Count",
            "formatter": 1,
            "numberFormat": {
              "unit": 0,
              "options": {
                "style": "decimal",
                "useGrouping": true,
                "minimumSignificantDigits": 1,
                "maximumSignificantDigits": 3
              },
              "emptyValCustomText": "0"
            }
          },
          "showBorder": true,
          "sortCriteriaField": "Count",
          "sortOrderField": 2
        }
      },
      "name": "Datatable - Alerts per Severity"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\"\n    and isnotempty(EventType)\n| where EventSeverity != \"True\"\n| summarize count() by EventSeverity, bin(TimeGenerated,{_timetoken:grain})\n| render areachart ",
        "size": 0,
        "title": "Events Detected (Count By Severity) {_timetoken:value}",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "chartSettings": {
          "showLegend": true,
          "seriesLabelSettings": [
            {
              "seriesName": "0",
              "label": "Informational"
            },
            {
              "seriesName": "1",
              "label": "Low"
            },
            {
              "seriesName": "2",
              "label": "Medium"
            },
            {
              "seriesName": "3",
              "label": "High"
            }
          ]
        }
      },
      "customWidth": "50",
      "name": "Query - Events detected by Severity"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventType == \"UnifiedLog\"\n| summarize count() by tostring(EventDescription), bin(TimeGenerated,{_timetoken:grain})\n| render areachart ",
        "size": 0,
        "title": "Unified Logging Events {_timetoken:value}",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ]
      },
      "customWidth": "50",
      "name": "Query - Unified Logs",
      "styleSettings": {
        "maxWidth": "50"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\" \n    and isnotempty(EventType)\n    and isnotempty(DvcHostname)\n| summarize Event = count() by DvcHostname\n| sort by Event desc",
        "size": 3,
        "title": "Most Active Endpoints (Total, last {_timetoken:value})",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "visualization": "table",
        "tileSettings": {
          "showBorder": false,
          "titleContent": {
            "columnMatch": "HostName",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "Event",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        },
        "graphSettings": {
          "type": 0,
          "topContent": {
            "columnMatch": "HostName",
            "formatter": 1
          },
          "centerContent": {
            "columnMatch": "Event",
            "formatter": 1,
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        }
      },
      "customWidth": "100",
      "name": "Query - Most active endpoints with Alerts",
      "styleSettings": {
        "maxWidth": "100"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\"\n    and isnotempty(EventType)\n| summarize Events = count() by EventProduct, bin(TimeGenerated,{_timetoken:grain})\n| render columnchart   ",
        "size": 0,
        "title": "Events detected (Total by date, {_timetoken:value})",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "chartSettings": {
          "seriesLabelSettings": [
            {
              "seriesName": "jamfprotect_CL",
              "label": "Jamf Protect"
            }
          ]
        }
      },
      "customWidth": "50",
      "name": "Query - Total events detected",
      "styleSettings": {
        "maxWidth": "50"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\"\n| where isnotempty(EventType)\n| summarize Events = count() by EventType, bin(EventStartTime,{_timetoken:grain})\n| render areachart with(kind=stacked)\n",
        "size": 0,
        "title": "Events Detected (Count by Type, {_timetoken:value})",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "visualization": "areachart",
        "gridSettings": {
          "sortBy": [
            {
              "itemKey": "Events",
              "sortOrder": 2
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "Events",
            "sortOrder": 2
          }
        ]
      },
      "customWidth": "50",
      "name": "Query - Events detected counted by Type",
      "styleSettings": {
        "maxWidth": "50"
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Event Types",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\"\n| where isnotempty(EventType)\n| summarize Events = count() by EventType\n| render piechart",
              "size": 3,
              "showAnalytics": true,
              "title": "Event Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "33",
            "name": "Query - Events by Type",
            "styleSettings": {
              "maxWidth": "100"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"FileSystem\"\n| summarize count() by tostring(EventMessage)\n| render piechart ",
              "size": 3,
              "showAnalytics": true,
              "title": "File System Event Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "33",
            "name": "Query - File System Events"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"Process\"\n| summarize count() by tostring(EventMessage)\n| render piechart \n",
              "size": 3,
              "showAnalytics": true,
              "title": "Process Event Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "33",
            "name": "Query - Process Event Types"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"USB\"\nor EventType == \"UsbBlock\" and EventMessage == \"USBWrite\"\n| summarize count() by tostring(EventMessage)\n| render piechart ",
              "size": 3,
              "showAnalytics": true,
              "title": "USB Event Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "33",
            "name": "Query - USB Event Types"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"Gatekeeper\"\n| summarize count() by tostring(EventMessage)\n| render piechart ",
              "size": 3,
              "showAnalytics": true,
              "title": "Gatekeeper Event Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "GatekeeperBlockedSigned",
                    "label": "Signed"
                  },
                  {
                    "seriesName": "GatekeeperBlockedRevoked",
                    "label": "Revoked"
                  },
                  {
                    "seriesName": "GatekeeperBlockedUnsignedOrUnknown",
                    "label": "UnsignedOrUnknown"
                  }
                ]
              }
            },
            "customWidth": "33",
            "name": "Query - GateKeeper Events"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"ProcessPrevented\"\n| summarize Threat = count() by EventMatch\n| render piechart ",
              "size": 3,
              "showAnalytics": true,
              "title": "Threat Prevention Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "33",
            "name": "Query - Threat Prevention Types"
          }
        ]
      },
      "name": "Group - Event Types"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Alerts\"\n| where isnotempty(EventType)\n| summarize count() by tostring(EventType), tostring(EventMessage)\n| project-rename Count = count_\n| sort by Count desc\n| limit 10\n",
        "size": 3,
        "showAnalytics": true,
        "title": "Top 10 Event Types {_timetoken:value}",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ]
      },
      "customWidth": "50",
      "name": "Query - Top 10 Events",
      "styleSettings": {
        "maxWidth": "50"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "JamfProtect\n| where EventType == \"ProcessDenied\"\n| where isnotempty(DvcHostname)\n| summarize Count= count() by TargetProcessName, EventMatch, TargetBinarySigningAppID, TargetBinarySigningTeamID\n| sort by Count asc nulls first\n| limit 25",
        "size": 0,
        "showAnalytics": true,
        "title": "Process Blocked by Custom Prevent List {_timetoken:value}",
        "timeContextFromParameter": "_timetoken",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ]
      },
      "customWidth": "50",
      "name": "Query - Process Blocked by Custom Prevent List"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "macOS Built-In Security Tools",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"Gatekeeper\"\n| summarize count() by tostring(EventMessage), TargetFilePath\n| project-rename BlockType = EventMessage, Count = count_\n| sort by Count desc\n| limit 10",
              "size": 3,
              "showAnalytics": true,
              "title": "Top Gatekeeper Blocked Items {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "Count",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "Count",
                  "sortOrder": 2
                }
              ]
            },
            "customWidth": "50",
            "name": "Query - Top Blocked GateKeepers events"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Unified Log\"\n| where input_match_event_subsystem_s == \"com.apple.XProtectFramework.PluginAPI\"\n| where tostring(parse_json(input_match_event_composedMessage_s).status_message) <> \"[]\"\n| extend status_message_ = tostring(parse_json(input_match_event_composedMessage_s).status_message)\n| extend execution_duration_ = tostring(parse_json(input_match_event_composedMessage_s).execution_duration)\n| project \n    EventStartTime, \n    DvcHostname, \n    Status=status_message_, \n    Module=input_match_event_process_s, \n    Execution_Duration=execution_duration_\n| sort by EventStartTime desc\n| limit 25",
              "size": 0,
              "showAnalytics": true,
              "title": "XProtect Remediator Scans {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - XProtect Remediator Activity"
          }
        ]
      },
      "name": "macOS Built-In Security Tools Group"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Device Controls",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"UsbBlock\"\n| where EventMessage == \"EnforcedRemovableDevicePolicy\"\n| extend EventMessage = replace_string(tostring(EventMessage), \"EnforcedRemovableDevicePolicy\", \"Blocked\")\n| summarize count() by tostring(EventMessage)\n\n",
              "size": 2,
              "title": "Device Controls Blocked {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "titleContent": {
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "icons",
                    "thresholdsGrid": [
                      {
                        "thresholdValue": "Alerts",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "Notifications",
                        "text": "Devices Blocked"
                      }
                    ]
                  }
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": true,
                "sortOrderField": 2
              },
              "graphSettings": {
                "type": 0,
                "topContent": {},
                "centerContent": {
                  "columnMatch": "count_",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "chartSettings": {
                "showMetrics": false
              },
              "mapSettings": {
                "locInfo": "LatLong",
                "sizeSettings": "count_",
                "sizeAggregation": "Sum",
                "legendMetric": "count_",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "type": "heatmap",
                  "colorAggregation": "Sum",
                  "nodeColorField": "count_",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "customWidth": "25",
            "name": "Query - Blocked USB Events",
            "styleSettings": {
              "maxWidth": "25"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventType == \"UsbBlock\"\n| where EventMessage == \"EnforcedRemovableDevicePolicy\"\n| extend device_ = strcat(input_match_event_device_vendorName_s, \" \",input_match_event_device_productName_s)\n| summarize count() by DvcHostname, device_\n| project-rename Hostname = DvcHostname, Device = device_, Count = count_\n| sort by Count desc\n\n",
              "size": 0,
              "title": "Device Controls Endpoint {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "65",
            "name": "Query - Blocked USB Devices",
            "styleSettings": {
              "maxWidth": "100"
            }
          }
        ]
      },
      "name": "Group - Device Controls",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Endpoint Telemetry",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where identity_signer_id_s == \"com.apple.sudo\"\n    and ParentProcessName == \"/usr/bin/sudo\"\n    and ActorUsername == \"root\"\n    and ActorUserId != \"-1\"\n| extend Compiled_Arguments = replace_string(TargetProcessCommandLine, \",\", \" \")\n| project-keep\n    TimeGenerated,\n    EventStartTime,\n    DvcHostname,\n    ActorUserId,\n    Compiled_Arguments\n| project-rename Hostname = DvcHostname, Elevated_User = ActorUserId\n| limit 50\n| sort by EventStartTime",
              "size": 0,
              "title": "Succesful sudo events {_timetoken:value}",
              "noDataMessage": "No events occured",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Compiled_Arguments",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "69.5714ch"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "EventStartTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "EventStartTime",
                  "sortOrder": 2
                }
              ]
            },
            "name": "Query - Successful sudo events"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n//| where SrcIpAddr != \"0.0.0.0\" and EventType != \"AUE_SESSION_START\" and EventType != \"PLAINTEXT_LOG_COLLECTION_EVENT\" and EventType != \"BIOS_FIRMWARE_VERSIONS\" and EventType != \"SYSTEM_PERFORMANCE_METRICS\" and EventType != \"RATE_LIMITING_APPLIED\"\n| where SrcIpAddr != \"0.0.0.0\" and EventType == \"ProcessCreated\"\n    or SrcIpAddr != \"0.0.0.0\" and EventType == \"Logoff\"\n    or SrcIpAddr != \"0.0.0.0\" and EventType == \"SshInitiated\"\n| where isnotempty(DvcHostname)\n| where isnotempty(EventType)\n| where EventProduct != \"Jamf Protect - Alerts\"\n//| extend binary=parse_json(path_s)[0]\n| extend Compiled_Arguments = replace_string(TargetProcessCommandLine, \",\", \" \")\n| project-keep\n    TimeGenerated,\n    EventStartTime,\n    EventType,\n    return_description_s,\n    TargetProcessName,\n    DvcHostname,\n    SrcIpAddr,\n    ActorUsername,\n    ActorUserId,\n    Compiled_Arguments\n| project-rename\n    EventName = EventType,\n    Description = return_description_s,\n    Hostname = DvcHostname,\n    Process_Name = TargetProcessName,\n    IP_Adress = SrcIpAddr,\n    Elevated_User = ActorUserId\n| limit 15\n| sort by EventStartTime",
              "size": 0,
              "title": "Remotely Controlled Commands (Outbound) {_timetoken:value}",
              "noDataMessage": "No events occured",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "sortBy": []
            },
            "name": "Query - Remotely Controlled Commands"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where isnotempty(DvcHostname)\n| where isnotempty(TargetProcessName)\n| project-keep TimeGenerated, ParentProcessName, TargetProcessName\n| summarize Rare_Process_Count = count() by TargetProcessName, ParentProcessName\n| sort by Rare_Process_Count asc nulls first\n| limit 200",
              "size": 0,
              "title": "Rare Process Executions (All Executions) {_timetoken:value}",
              "noDataMessage": "No events occured",
              "timeContextFromParameter": "_timetoken",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "Rare_Process_Count",
                    "sortOrder": 1
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "Rare_Process_Count",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "100",
            "name": "Query - Rare Process Executions"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where isnotempty(DvcHostname)\n    and isnotempty(ParentProcessName)\n| project\n    DvcHostname,\n    TargetProcessName,\n    ParentProcessName,\n    ParentProcessGuid,\n    exec_chain_thread_uuid_g\n| summarize\n    thread_uuid = make_set(exec_chain_thread_uuid_g, 128),\n    Hostnames = make_set(DvcHostname, 128),\n    process = make_set(TargetProcessName, 128)\n    by ParentProcessName\n| project \n    Hostnames,\n    process,\n    parent_process=ParentProcessName,\n    thread_uuid",
              "size": 0,
              "title": "Parent/child process with thread uuid {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "100",
            "name": "Query - Parent and Child Process UUID"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Endpoint Information",
              "expandable": true,
              "expanded": true,
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "JamfProtect\n| where EventType == \"SystemPerformanceMetrics\"\n| extend metrics = parse_json(metrics_tasks_s)\n| project-keep DvcHostname, metrics, TimeGenerated\n| project-reorder DvcHostname, metrics\n| mv-expand metrics\n| extend energy_impact = metrics.energy_impact\n| extend process_name = metrics.name\n| project-rename\n    Hostname = DvcHostname\n| extend avg = toreal(energy_impact)\n| summarize Average = avg(avg) by tostring(process_name), bin(TimeGenerated,{_timetoken:grain})\n| render timechart\n\n\n\n",
                    "size": 0,
                    "aggregation": 3,
                    "title": "Overall System Energy Impact on all endpoints {_timetoken:value}",
                    "timeContextFromParameter": "_timetoken",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "sortBy": [],
                    "tileSettings": {
                      "showBorder": false
                    },
                    "graphSettings": {
                      "type": 0,
                      "topContent": {},
                      "nodeIdField": "Hostname",
                      "sourceIdField": "Hostname",
                      "targetIdField": "Hostname",
                      "graphOrientation": 3,
                      "showOrientationToggles": false,
                      "nodeSize": null,
                      "staticNodeSize": 100,
                      "colorSettings": null,
                      "hivesMargin": 5
                    },
                    "chartSettings": {
                      "group": "process_name",
                      "createOtherGroup": 15,
                      "showLegend": true
                    },
                    "mapSettings": {
                      "locInfo": "LatLong"
                    }
                  },
                  "customWidth": "100",
                  "name": "Query - System Performance Metrics - Energy Impact"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Log Parser {_timetoken:value}",
                    "expandable": true,
                    "expanded": true,
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Please select a hostname in order to show the collected plain-text log files.",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "_hostnamelogparser",
                          "comparison": "isEqualTo"
                        },
                        "name": "Text - Jamf Log Parser Note",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "parameters": [
                            {
                              "id": "f747e125-851e-45f7-b500-5d22049da6a6",
                              "version": "KqlParameterItem/1.0",
                              "name": "_hostnamelogparser",
                              "label": "Hostname",
                              "type": 2,
                              "isRequired": true,
                              "query": "JamfProtect\n| where isnotempty(DvcHostname)\n    and EventType == \"LogFileCollected\"\n| project-keep DvcHostname\n| project-rename Hostname = DvcHostname\n| summarize by Hostname",
                              "crossComponentResources": [
                                "{Workspace}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "_timetoken",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces",
                              "value": null
                            },
                            {
                              "id": "7d123ad2-1768-4d22-b438-565ab483c044",
                              "version": "KqlParameterItem/1.0",
                              "name": "_logselectlogparser",
                              "label": "Available Log File",
                              "type": 2,
                              "isRequired": true,
                              "query": "JamfProtect\n| where EventType == \"LogFileCollected\"\n    and DvcHostname == \"{_hostnamelogparser:value}\"\n| project-keep TargetFilePath\n| project-keep TargetFilePath\n| extend TargetFilePath = replace_string(TargetFilePath, \"[\", \"\")\n| extend TargetFilePath = replace_string(TargetFilePath, \"]\", \"\")\n| extend TargetFilePath = replace_string(TargetFilePath, '\"', \"\")\n| summarize by TargetFilePath",
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 7776000000
                              },
                              "timeContextFromParameter": "_timetoken",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces",
                              "value": "/var/log/jamf.log"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "40",
                        "name": "Picker - Hostname"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "JamfProtect\n| where EventType == \"LogFileCollected\"\n    and DvcHostname == \"{_hostnamelogparser:value}\"\n| extend TargetFilePath = replace_string(TargetFilePath, \"[\", \"\")\n| extend TargetFilePath = replace_string(TargetFilePath, \"]\", \"\")\n| extend TargetFilePath = replace_string(TargetFilePath, '\"', \"\")\n| where  TargetFilePath == \"{_logselectlogparser:escapejson}\"\n| project EventResult, EventStartTime\n| project-rename Logs = EventResult\n| project-reorder EventStartTime, Logs\n| mv-expand parse_json(Logs)\n| sort by EventStartTime desc\n| limit 50",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Log File Collection on \"{_hostnamelogparser:value}\"",
                          "noDataMessage": "No matches found based on the hostname",
                          "timeContextFromParameter": "_timetoken",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Logs",
                                "formatter": 0,
                                "formatOptions": {
                                  "customColumnWidthSetting": "150ch"
                                }
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "_hostnamelogparser",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Query - Parse Logs"
                      }
                    ]
                  },
                  "customWidth": "100",
                  "name": "Group - Log Parser",
                  "styleSettings": {
                    "margin": "200",
                    "padding": "200",
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Endpoint System Performance {_timetoken:value}",
                    "expandable": true,
                    "expanded": true,
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Please select a hostname in order to show the system performance metrics.",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "_hostnamelogparser",
                          "comparison": "isEqualTo"
                        },
                        "name": "Text - Jamf Log Parser Note",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "parameters": [
                            {
                              "id": "f747e125-851e-45f7-b500-5d22049da6a6",
                              "version": "KqlParameterItem/1.0",
                              "name": "_hostname",
                              "label": "Hostname",
                              "type": 2,
                              "query": "JamfProtect\n| where isnotempty(DvcHostname)\n    and EventType == \"SystemPerformanceMetrics\"\n| project-keep DvcHostname\n| project-rename Hostname = DvcHostname\n| summarize by Hostname",
                              "crossComponentResources": [
                                "{Workspace}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "_timetoken",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces",
                              "value": "LMAC-ZW0GTLVDL"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "40",
                        "name": "Picker - Hostname"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "JamfProtect\n| where EventType == \"SystemPerformanceMetrics\"\n    and DvcHostname == \"{_hostname:value}\"\n| extend metrics = parse_json(metrics_tasks_s)\n| project-keep DvcHostname, metrics, TimeGenerated\n| project-reorder DvcHostname, metrics\n| mv-expand metrics\n| extend energy_impact = metrics.energy_impact\n| extend process_name = metrics.name\n| project-rename\n    Hostname = DvcHostname\n| extend avg = toreal(energy_impact)\n| summarize Average = avg(avg) by tostring(process_name), bin(TimeGenerated,{_timetoken:grain})\n| render timechart",
                          "size": 0,
                          "aggregation": 3,
                          "title": "Energy Impact on {_hostname:value}",
                          "noDataMessage": "No metrics found based on the hostname",
                          "timeContextFromParameter": "_timetoken",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "TimeGenerated",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "JamfLogs",
                                "formatter": 1,
                                "formatOptions": {
                                  "customColumnWidthSetting": "100ch"
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "group": "process_name",
                            "createOtherGroup": 15,
                            "showLegend": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "_hostname",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "Query - Endpoint System Performance - Energy Impact"
                      }
                    ]
                  },
                  "customWidth": "100",
                  "name": "Group - Endpoint System Performance",
                  "styleSettings": {
                    "margin": "200",
                    "padding": "200",
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "Group - Endpoint Information"
          }
        ]
      },
      "name": "Group - Telemetry",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Network Threat Events",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\"\n    and EventResult == \"Blocked\"\n| extend blocks = case(EventResult == \"Blocked\", \"Blocked\", \"True\")\n| summarize arg_max(EventResult, *) by EventStartTime\n| summarize Count = count() by blocks\n\n",
              "size": 4,
              "title": "Threats blocked by NTP {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "Count",
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "colors",
                    "thresholdsGrid": [
                      {
                        "operator": "==",
                        "thresholdValue": "0",
                        "representation": "green",
                        "text": "Threats blocked by NTP"
                      },
                      {
                        "operator": "<",
                        "thresholdValue": "15",
                        "representation": "gray",
                        "text": "Threats blocked by NTP"
                      },
                      {
                        "operator": "<",
                        "thresholdValue": "30",
                        "representation": "orange",
                        "text": "Threats blocked by NTP"
                      },
                      {
                        "operator": ">",
                        "thresholdValue": "50",
                        "representation": "redBright",
                        "text": "Threats blocked by NTP"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "gray",
                        "text": "Threats blocked by NTP"
                      }
                    ],
                    "compositeBarSettings": {
                      "labelText": "",
                      "columnSettings": []
                    }
                  }
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true,
                      "minimumSignificantDigits": 1,
                      "maximumSignificantDigits": 3
                    },
                    "emptyValCustomText": "0"
                  }
                },
                "showBorder": true,
                "sortCriteriaField": "blocks",
                "sortOrderField": 1,
                "size": "auto"
              }
            },
            "name": "Query - Threats blocked by NTP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\"\n| where isnotempty(EventSeverity)\n| summarize arg_max(EventSeverity, *) by EventStartTime\n| summarize count() by EventSeverity, bin(TimeGenerated,{_timetoken:grain})\n| render areachart",
              "size": 0,
              "title": "Network Events Detected (Count By Severity) {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Network Events by Severity"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\"\n    and isnotempty(DvcHostname)\n| summarize arg_max(DvcHostname, *) by EventStartTime\n| summarize Event = count() by DvcHostname\n| sort by Event desc",
              "size": 0,
              "title": "Most Active Endpoints (Total, last {_timetoken:value})",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Most Active Endoints with Alerts"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\"\n    and isnotempty(ThreatCategory)\n| summarize arg_max(ThreatCategory, *) by EventStartTime\n| summarize Events = count() by ThreatCategory, bin(EventStartTime, {_timetoken:grain})\n| render areachart with(kind=stacked)",
              "size": 0,
              "title": "Network Events Detected (Count by Type, {_timetoken:value})",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Network Events by Category"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\"\n    and isnotempty(ThreatCategory)\n| summarize arg_max(ThreatCategory, *) by EventStartTime\n| summarize Events = count() by ThreatCategory\n| render piechart",
              "size": 0,
              "title": "Event Types {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Network Events by Description"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\" \n    and notempty(ThreatCategory) and notempty(DnsQueryName)\n| extend name_ = ThreatCategory\n| summarize arg_max(DnsQueryName, *) by EventStartTime\n| summarize count() by DnsQueryName, ThreatCategory\n| project-rename\n    Count = count_\n| sort by Count desc\n| limit 10",
              "size": 0,
              "title": "Top 10 Blocked destinations {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Top 10 blocked destinations"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Threat Events Stream\" \n    and notempty(ThreatCategory)\n    and notempty(DstIpAddr)\n| extend name_ = ThreatCategory\n| summarize arg_max(DstIpAddr, *) by EventStartTime\n| summarize count() by DstIpAddr\n| project-rename\n    Count = count_\n| sort by Count desc\n| limit 10",
              "size": 0,
              "title": "Top 10 Blocked IPs {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Top 10 Blocked IPs"
          }
        ]
      },
      "name": "Network Threat Events - Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Network Traffic",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Network Traffic Stream\"\n    and isnotempty(DnsQuery)\n| summarize arg_max(DnsQuery, *) by EventStartTime\n| summarize count() by DnsQuery, DnsQueryTypeName\n| project-rename\n    Count = count_\n| sort by Count desc\n| limit 10",
              "size": 0,
              "title": "Top 10 resolved destinations {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Top 10 resolved destinations"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "JamfProtect\n| where EventProduct == \"Jamf Protect - Network Traffic Stream\"\n    and isnotempty(DstIpAddr) and DstIpAddr != \"[]\"\n| summarize arg_max(DstIpAddr, *) by EventStartTime\n| summarize count() by DstIpAddr\n| project-rename\n    Count = count_\n| sort by Count desc\n| limit 10",
              "size": 0,
              "title": "Top 10 Resolved IPs {_timetoken:value}",
              "timeContextFromParameter": "_timetoken",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "name": "Query - Top 10 Resolved IPs"
          }
        ]
      },
      "name": "Network Traffic - Group",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fromTemplateId": "sentinel-JamfProtectDashboard",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}