[
  {
    "name": "Filewall-Exchange-Connector",
    "apiVersion": "2022-10-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{effectiveWorkspaceLocation}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "FilewallM365",
      "dataType": "FilewallExchange_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{apiKey}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "token"
      },
      "request": {
        "apiEndpoint": "{{apiEndpoint}}",
        "httpMethod": "GET",
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "rateLimitQPS": 10,
        "queryWindowInMin": 5,
        "queryTimeFormat": "yyyy-MM-dd HH:mm:ss",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Filewall-Sentinel-Connector"
        },
        "queryParameters": {
          "pageSize": "100",
          "platform": "exchange",
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        }
      },
      "paging": {
        "pagingType": "CountBasedPaging",
        "pageNumberParaName": "page",
        "pageSize": 100,
        "zeroBasedIndexing": false
      },
      "response": {
        "eventsJsonPaths": [
          "$"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "streamName": "Custom-FilewallExchange_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"        
      }
    }
  },
  {
    "name": "Filewall-Sharepoint-Connector",
    "apiVersion": "2022-10-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{effectiveWorkspaceLocation}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "FilewallM365",
      "dataType": "FilewallFile_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{apiKey}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "token"
      },
      "request": {
        "apiEndpoint": "{{apiEndpoint}}",
        "httpMethod": "GET",
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "rateLimitQPS": 10,
        "queryWindowInMin": 5,
        "queryTimeFormat": "yyyy-MM-dd HH:mm:ss",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Filewall-Sentinel-Files-Connector"
        },
        "queryParameters": {
          "pageSize": "100",
          "platform": "sharepoint",
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        }
      },
      "paging": {
        "pagingType": "CountBasedPaging",
        "pageNumberParaName": "page",
        "pageSize": 100,
        "zeroBasedIndexing": false
      },
      "response": {
        "eventsJsonPaths": [
          "$"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "streamName": "Custom-FilewallFile_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"        
      }
    }
  },
  {
    "name": "Filewall-Onedrive-Connector",
    "apiVersion": "2022-10-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{effectiveWorkspaceLocation}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "FilewallM365",
      "dataType": "FilewallFile_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{apiKey}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "token"
      },
      "request": {
        "apiEndpoint": "{{apiEndpoint}}",
        "httpMethod": "GET",
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "rateLimitQPS": 10,
        "queryWindowInMin": 5,
        "queryTimeFormat": "yyyy-MM-dd HH:mm:ss",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Filewall-Sentinel-Files-Connector"
        },
        "queryParameters": {
          "pageSize": "100",
          "platform": "onedrive",
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        }
      },
      "paging": {
        "pagingType": "CountBasedPaging",
        "pageNumberParaName": "page",
        "pageSize": 100,
        "zeroBasedIndexing": false
      },
      "response": {
        "eventsJsonPaths": [
          "$"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "streamName": "Custom-FilewallFile_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"        
      }
    }
  },
  {
    "name": "Filewall-Teams-Connector",
    "apiVersion": "2022-10-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{effectiveWorkspaceLocation}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "FilewallM365",
      "dataType": "FilewallFile_CL",
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{apiKey}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "token"
      },
      "request": {
        "apiEndpoint": "{{apiEndpoint}}",
        "httpMethod": "GET",
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "rateLimitQPS": 10,
        "queryWindowInMin": 5,
        "queryTimeFormat": "yyyy-MM-dd HH:mm:ss",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Filewall-Sentinel-Files-Connector"
        },
        "queryParameters": {
          "pageSize": "100",
          "platform": "teams",
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        }
      },
      "paging": {
        "pagingType": "CountBasedPaging",
        "pageNumberParaName": "page",
        "pageSize": 100,
        "zeroBasedIndexing": false
      },
      "response": {
        "eventsJsonPaths": [
          "$"
        ],
        "format": "json"
      },
      "dcrConfig": {
        "streamName": "Custom-FilewallFile_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"        
      }
    }
  }
]