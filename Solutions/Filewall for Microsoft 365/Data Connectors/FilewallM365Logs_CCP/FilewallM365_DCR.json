[
  {
    "name": "FilewallM365-DCR",
    "apiVersion": "2024-03-11",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{effectiveWorkspaceLocation}}",
    "properties": {
      "streamDeclarations": {
        "Custom-FilewallExchange_CL": {
          "columns": [
            {
              "name": "TimeGenerated",
              "type": "datetime"
            },
            {
              "name": "application",
              "type": "string"
            },
            {
              "name": "event_type",
              "type": "string"
            },
            {
              "name": "event_id",
              "type": "string"
            },
            {
              "name": "timestamp",
              "type": "string"
            },
            {
              "name": "state",
              "type": "string"
            },
            {
              "name": "status",
              "type": "string"
            },
            {
              "name": "subject",
              "type": "string"
            },
            {
              "name": "sender",
              "type": "string"
            },
            {
              "name": "recipient",
              "type": "string"
            },
            {
              "name": "mail_id",
              "type": "string"
            },
            {
              "name": "summary",
              "type": "string"
            },
            {
              "name": "policy_name",
              "type": "string"
            },
            {
              "name": "policy_id",
              "type": "string"
            },
            {
              "name": "release_timestamp",
              "type": "string"
            },
            {
              "name": "release_by_admin",
              "type": "string"
            },
            {
              "name": "release_reason",
              "type": "string"
            },
            {
              "name": "attachments",
              "type": "dynamic"
            }
          ]
        },
        "Custom-FilewallFile_CL": {
          "columns": [
            {
              "name": "TimeGenerated",
              "type": "datetime"
            },
            {
              "name": "application",
              "type": "string"
            },
            {
              "name": "event_type",
              "type": "string"
            },
            {
              "name": "event_id",
              "type": "string"
            },
            {
              "name": "timestamp",
              "type": "string"
            },
            {
              "name": "state",
              "type": "string"
            },
            {
              "name": "status",
              "type": "string"
            },
            {
              "name": "owner",
              "type": "string"
            },
            {
              "name": "drive_name",
              "type": "string"
            },
            {
              "name": "policy_id",
              "type": "string"
            },
            {
              "name": "policy_name",
              "type": "string"
            },
            {
              "name": "release_by_admin",
              "type": "string"
            },
            {
              "name": "release_reason",
              "type": "string"
            },
            {
              "name": "release_timestamp",
              "type": "string"
            },
            {
              "name": "name",
              "type": "string"
            },
            {
              "name": "path",
              "type": "string"
            },
            {
              "name": "type",
              "type": "string"
            },
            {
              "name": "version",
              "type": "string"
            },
            {
              "name": "new_sha1",
              "type": "string"
            },
            {
              "name": "original_sha1",
              "type": "string"
            },
            {
              "name": "new_sha256",
              "type": "string"
            },
            {
              "name": "original_sha256",
              "type": "string"
            },
            {
              "name": "size",
              "type": "string"
            },
            {
              "name": "block_reason",
              "type": "string"
            },
            {
              "name": "summary",
              "type": "string"
            },
            {
              "name": "site_name",
              "type": "string"
            }
          ]
        }
      },
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "filewallWs"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Custom-FilewallExchange_CL"
          ],
          "destinations": [
            "filewallWs"
          ],
          "transformKql": "source",
          "outputStream": "Custom-FilewallExchange_CL"
        },
        {
          "streams": [
            "Custom-FilewallFile_CL"
          ],
          "destinations": [
            "filewallWs"
          ],
          "transformKql": "source | extend file_type = tostring(type) | project-away type",
          "outputStream": "Custom-FilewallFile_CL"
        }
      ],
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}"
    }
  }
]