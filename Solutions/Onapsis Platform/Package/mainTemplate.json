{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Onapsis",
    "comments": "Solution template for Onapsis Platform"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Onapsis Alarms Overview",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "solutionId": "onapsis.Onapsis_MSS",
    "_solutionId": "[variables('solutionId')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "uiConfigId1": "OnapsisPlatform",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "OnapsisPlatform",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1')))]",
    "dataConnectorVersion1": "1.0.0",
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "OnapsisAlarmsWorkbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1')))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "parserVersion1": "1.0.0",
    "parserContentId1": "OnapsisLookup-Parser",
    "_parserContentId1": "[variables('parserContentId1')]",
    "parserName1": "OnapsisLookup",
    "_parserName1": "[concat(parameters('workspace'),'/',variables('parserName1'))]",
    "parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
    "_parserId1": "[variables('parserId1')]",
    "parserTemplateSpecName1": "[concat(parameters('workspace'),'-pr-',uniquestring(variables('_parserContentId1')))]"
  },
  "resources": [
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2021-05-01",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "DataConnector"
      },
      "properties": {
        "description": "Onapsis Platform data connector with template",
        "displayName": "Onapsis Platform template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2021-05-01",
      "name": "[concat(variables('dataConnectorTemplateSpecName1'),'/',variables('dataConnectorVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "DataConnector"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('dataConnectorTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "Onapsis Platform data connector with template version 2.0.1",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Onapsis Platform",
                  "publisher": "Onapsis",
                  "descriptionMarkdown": "The Onapsis Connector allows you to export the alarms triggered in the Onapsis Platform into Microsoft Sentinel in real-time. This gives you the ability to monitor the activity on your SAP systems, identify incidents and respond to them quickly.",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "OnapsisAlarms",
                      "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\""
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Total Alarms by Asset",
                      "query": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| summarize count() by DeviceCustomString1 | take 10"
                    },
                    {
                      "description": "List of Incidents occurring in SAP Systems",
                      "query": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| parse kind = regex AdditionalExtensions with \"sev=\" Criticality\n| summarize Count = count() by Message, Criticality | order by Criticality, Count\n| project Incident_Name=Message, Criticality, Count"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CommonSecurityLog (OnapsisAlarms)",
                      "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "read": true,
                          "write": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
                      "innerSteps": [
                        {
                          "title": "1.1 Select or create a Linux machine",
                          "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your Onapsis Console and Microsoft Sentinel. This machine can be on your on-prem environment, Azure or other clouds."
                        },
                        {
                          "title": "1.2 Install the CEF collector on the Linux machine",
                          "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                          "instructions": [
                            {
                              "parameters": {
                                "fillWith": [
                                  "WorkspaceId",
                                  "PrimaryKey"
                                ],
                                "label": "Run the following command to install and apply the CEF collector:",
                                "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                              },
                              "type": "CopyableLabel"
                            }
                          ]
                        }
                      ],
                      "title": "1. Linux Syslog agent configuration"
                    },
                    {
                      "description": "Refer to the Onapsis in-product help to set up log forwarding to the Syslog agent.\n\n> 1. Go to Setup > Third-party integrations > Defend Alarms and follow the instructions for Microsoft Sentinel.\n\n> 2. Make sure your Onapsis Console can reach the proxy machine where the agent is installed - logs should be sent to port 514 using TCP.",
                      "title": "2. Forward Common Event Format (CEF) logs to Syslog agent"
                    },
                    {
                      "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Run the following command to validate your connectivity:",
                            "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                          },
                          "type": "CopyableLabel"
                        }
                      ],
                      "title": "3. Validate connection"
                    },
                    {
                      "description": "[Follow these steps to get this Kusto function](https://aka.ms/sentinel-Onapsis-parser)",
                      "title": "4. Create Onapsis lookup function for incident enrichment"
                    },
                    {
                      "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
                      "title": "5. Secure your machine "
                    }
                  ],
                  "metadata": {
                    "id": "81ae314e-2c7c-40d0-87fe-812ffda0b60c",
                    "version": "1.0.0",
                    "kind": "dataConnector",
                    "source": {
                      "kind": "community"
                    },
                    "author": {
                      "name": "Onapsis"
                    },
                    "support": {
                      "name": "Onapsis",
                      "link": "https://onapsis.force.com/s/login/",
                      "tier": "developer"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Onapsis Platform",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Onapsis"
                },
                "support": {
                  "name": "Onapsis",
                  "tier": "Partner",
                  "link": "https://onapsis.com/company/contact-us"
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Onapsis Platform",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Onapsis"
        },
        "support": {
          "name": "Onapsis",
          "tier": "Partner",
          "link": "https://onapsis.com/company/contact-us"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Onapsis Platform",
          "publisher": "Onapsis",
          "descriptionMarkdown": "The Onapsis Connector allows you to export the alarms triggered in the Onapsis Platform into Microsoft Sentinel in real-time. This gives you the ability to monitor the activity on your SAP systems, identify incidents and respond to them quickly.",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "OnapsisAlarms",
              "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\""
            }
          ],
          "dataTypes": [
            {
              "name": "CommonSecurityLog (OnapsisAlarms)",
              "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Total Alarms by Asset",
              "query": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| summarize count() by DeviceCustomString1 | take 10"
            },
            {
              "description": "List of Incidents occurring in SAP Systems",
              "query": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| parse kind = regex AdditionalExtensions with \"sev=\" Criticality\n| summarize Count = count() by Message, Criticality | order by Criticality, Count\n| project Incident_Name=Message, Criticality, Count"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "read": true,
                  "write": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
              "innerSteps": [
                {
                  "title": "1.1 Select or create a Linux machine",
                  "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your Onapsis Console and Microsoft Sentinel. This machine can be on your on-prem environment, Azure or other clouds."
                },
                {
                  "title": "1.2 Install the CEF collector on the Linux machine",
                  "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                  "instructions": [
                    {
                      "parameters": {
                        "fillWith": [
                          "WorkspaceId",
                          "PrimaryKey"
                        ],
                        "label": "Run the following command to install and apply the CEF collector:",
                        "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ],
              "title": "1. Linux Syslog agent configuration"
            },
            {
              "description": "Refer to the Onapsis in-product help to set up log forwarding to the Syslog agent.\n\n> 1. Go to Setup > Third-party integrations > Defend Alarms and follow the instructions for Microsoft Sentinel.\n\n> 2. Make sure your Onapsis Console can reach the proxy machine where the agent is installed - logs should be sent to port 514 using TCP.",
              "title": "2. Forward Common Event Format (CEF) logs to Syslog agent"
            },
            {
              "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Run the following command to validate your connectivity:",
                    "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                  },
                  "type": "CopyableLabel"
                }
              ],
              "title": "3. Validate connection"
            },
            {
              "description": "[Follow these steps to get this Kusto function](https://aka.ms/sentinel-Onapsis-parser)",
              "title": "4. Create Onapsis lookup function for incident enrichment"
            },
            {
              "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
              "title": "5. Secure your machine "
            }
          ],
          "id": "[variables('_uiConfigId1')]"
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2021-05-01",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Workbook"
      },
      "properties": {
        "description": "Onapsis Platform Workbook with template",
        "displayName": "Onapsis Platform workbook template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2021-05-01",
      "name": "[concat(variables('workbookTemplateSpecName1'),'/',variables('workbookVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Workbook"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('workbookTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "OnapsisAlarmsOverviewWorkbook Workbook with template version 2.0.1",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Gain insights into what is going on in your SAP Systems with this overview of the alarms triggered in the Onapsis Platform. Incidents are enriched with context and next steps to help your Security team respond effectively."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"3448d079-06d5-493b-8769-0a54a0309367\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time_range\",\"label\":\"Time Range\",\"type\":4,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":86400000},{\"durationMs\":604800000},{\"durationMs\":2592000000}],\"allowCustom\":true,\"defaultValue\":86400000},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":2592000000}},{\"id\":\"73dba27b-6754-4b81-a3fe-254d8d03f2b6\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"category\",\"label\":\"Category\",\"type\":2,\"multiSelect\":true,\"quote\":\"\",\"delimiter\":\",\",\"typeSettings\":{\"showDefault\":false},\"jsonData\":\"[\\r\\n    { \\\"value\\\":1, \\\"label\\\":\\\"User Activity\\\", \\\"selected\\\":true },\\r\\n    { \\\"value\\\":2, \\\"label\\\":\\\"Exploitation\\\", \\\"selected\\\":true },\\r\\n    { \\\"value\\\":3, \\\"label\\\":\\\"Vulnerable Access\\\", \\\"selected\\\":true },\\r\\n    { \\\"value\\\":4, \\\"label\\\":\\\"Sensitive Access\\\", \\\"selected\\\":true }\\r\\n]\",\"value\":[\"1\",\"4\"]},{\"id\":\"9a5ccc66-29a2-473a-b93d-a1e0a1442815\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"asset\",\"label\":\"Asset\",\"type\":2,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" | distinct DeviceCustomString1\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"time_range\",\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and DeviceCustomString1 in ({asset}) and DeviceEventClassID in ({category}) | summarize count=count() by DeviceEventClassID | extend Category=case(DeviceEventClassID==1,\\\"User Activity\\\", DeviceEventClassID==2,\\\"Exploitation\\\",DeviceEventClassID==3,\\\"Vulnerable Access\\\",\\\"Sensitive Access\\\")\",\"size\":0,\"title\":\"Alarm breakdown by category\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"incident_type_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"incident_type_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"count_\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"yAxis\":[\"count\"],\"group\":\"Category\"},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"count_\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"30\",\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and DeviceCustomString1 in ({asset}) and DeviceEventClassID in ({category}) | summarize Count=count() by bin(TimeGenerated, 1d)\",\"size\":0,\"title\":\"Alarm volume over time\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\"},\"customWidth\":\"40\",\"name\":\"query - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and DeviceCustomString1 in ({asset}) and DeviceEventClassID in ({category}) | summarize count() by DeviceCustomString1 | take 10\",\"size\":0,\"title\":\"Assets triggering the most alarms\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"asset_name_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"count_\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"30\",\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and DeviceCustomString1 in ({asset}) and DeviceEventClassID in ({category}) | summarize Count=count() by SourceUserName | order by Count | take 10 | project Username=SourceUserName, Count\",\"size\":1,\"title\":\"Users triggering the most alarms\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Username\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"50%\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"50%\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 5\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and DeviceCustomString1 in ({asset}) and DeviceEventClassID in ({category}) | summarize Count=count() by SourceIP | order by Count | take 10 | project Source=SourceIP, Count\",\"size\":1,\"title\":\"Sources triggering the most alarms\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Source\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"50%\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"50%\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and DeviceCustomString1 in ({asset}) and DeviceEventClassID in ({category}) | parse kind = regex AdditionalExtensions with \\\"sev=\\\" Criticality |summarize Count = count() by Message, Criticality | order by Criticality, Count | project Incident_Name=Message, Criticality, Count\",\"size\":1,\"title\":\"Incident Report\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"exportFieldName\":\"Incident_Name\",\"exportParameterName\":\"incident_name\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"query - 7\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"incident_lookup | where IncidentName == '{incident_name}'\",\"size\":0,\"title\":\"Incident Details\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"sortBy\":[{\"itemKey\":\"RootCause\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"RootCause\",\"sortOrder\":1}],\"tileSettings\":{\"showBorder\":false},\"graphSettings\":{\"type\":0},\"mapSettings\":{\"locInfo\":\"LatLong\"}},\"conditionalVisibility\":{\"parameterName\":\"incident_name\",\"comparison\":\"isNotEqualTo\"},\"customWidth\":\"50\",\"name\":\"query - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog | where DeviceVendor==\\\"Onapsis\\\" and Message == '{incident_name}' and DeviceCustomString1 in ({asset}) | project Time=TimeGenerated, Asset=DeviceCustomString1, Client=DeviceCustomString2, Username=SourceUserName, Source=SourceIP, Logline=DeviceCustomString5 | order by Time\",\"size\":0,\"title\":\"Incident Occurrences\",\"timeContext\":{\"durationMs\":2592000000},\"timeContextFromParameter\":\"time_range\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"incident_name\",\"comparison\":\"isNotEqualTo\"},\"customWidth\":\"50\",\"name\":\"query - 8\"}],\"fromTemplateId\":\"sentinel-OnapsisAlarms\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=OnapsisAlarmsWorkbook; logoFileName=onapsis_logo.svg; description=Gain insights into what is going on in your SAP Systems with this overview of the alarms triggered in the Onapsis Platform. Incidents are enriched with context and next steps to help your Security team respond effectively.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Onapsis Alarms Overview; templateRelativePath=OnapsisAlarmsOverview.json; subtitle=; provider=Onapsis}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Onapsis Platform",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Onapsis"
                },
                "support": {
                  "name": "Onapsis",
                  "tier": "Partner",
                  "link": "https://onapsis.com/company/contact-us"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "CommonSecurityLog",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "OnapsisPlatform",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2021-05-01",
      "name": "[variables('parserTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Parser"
      },
      "properties": {
        "description": "OnapsisLookup Data Parser with template",
        "displayName": "OnapsisLookup Data Parser template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2021-05-01",
      "name": "[concat(variables('parserTemplateSpecName1'),'/',variables('parserVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Parser"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('parserTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "OnapsisLookup Data Parser with template version 2.0.1",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('_parserName1')]",
              "apiVersion": "2020-08-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "OnapsisLookup",
                "category": "Samples",
                "functionAlias": "OnapsisLookup",
                "query": "\n\r\nlet IncidentLookup = datatable(IncidentName:string, RootCause:string, Solution:string)\r\n[\r\n\"Access to authenticated URL without credentials\",\"This incident triggered because a vulnerable authenticated HANA URL was accessed without credentials. \\n\\nThe URI is vulnerable because it allows the corresponding (backend) SAP software component to be accessed without providing any credentials. This unauthenticated access provides an attacker with the privilege level of that functionality. The consequences will depend on the associated functionality, but they can range from reading or modifying sensitive data, access to administrative or other privileged functionality, or possibly even execution of arbitrary code.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Code Injection vulnerability in Visual Composer 04s iViews\",\"This incident triggered because a URI vulnerable to code injection was accessed with malicious looking parameters. \\n\\nThe vulnerability allows attackers to inject malicious code into the back-end application by sending a web request by means of a specially crafted URL. By fooling end users to access this URL, unwanted applications could potentially be started on the client machine by an attacker, resulting in remote code execution.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Cross-Site Scripting (XSS) vulnerability in backup function of SAP HANA cockpit\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Dangerous Report Execution\",\"This incident triggered because a vulnerable report was executed. \\n\\nAn SAP report is an executable program that reads data from the database and generates output based on the filter criteria selected by the end user. \\n\\nThe fact that a vulnerable report was run may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Dangerous RFC Execution\",\"This incident triggered because a vulnerable Remote Function Call (RFC) was executed. \\n\\nA Remote Function Call (RFC) is the call or remote execution of a Remote Function Module in an external system. In the SAP system, these functions are provided by the RFC interface system. The RFC interface system enables function calls between two SAP systems. Communication between applications of different systems in the SAP environment includes connections between SAP systems as well as between SAP systems and non-SAP systems. \\n\\nThe fact that a vulnerable RFC was performed may indicate, but not necessarily confirm, that an attacker is abusing a vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Dangerous Transaction Execution\",\"This incident triggered because a vulnerable transaction code was executed. \\n\\nEach function in the SAP system has a transaction code (t-code) associated with it. A transaction code consists of letters, numbers, or both. A transaction code is used to access functions or running programs in the SAP application more rapidly. By entering a t-code instead of using the menu, navigation and execution are combined into a single step. \\n\\nThe fact that a vulnerable transaction code was run may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Hardcoded Credential in Report\",\"This incident triggered because a vulnerable report was called with a suspicious username. \\n\\nA report is a presentation of data in an organized structure. The report interface allows users to call reports from other SAP application components. \\n\\nIn this case the called report's program code contains a hard-coded credential. By calling the report with the hard-coded username, malicious users can be successfully authenticated and access parts of the systems not intended for them. \\n\\nThe fact that the report was called with a hard-coded username may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Host Header injection in SAP HANA\",\"This incident triggered because an URI vulnerable to SQL injection was accessed. \\n\\nThe vulnerability concerns one of several vulnerabilities in the HANA User Self Service (USS) functionality. Through successful exploitation of these vulnerabilities, an unauthenticated attacker would be able to impersonate other users, even those of high privileged accounts. If exploited, these vulnerabilities allow an attacker, whether inside or outside the organization, to take full control of the SAP HANA platform remotely, without the need of a username and password. This level of access allows an attacker to take over business information and processes supported by HANA. This included creating, stealing, altering, and/or deleting sensitive information. If this risk is exploited, organizations may face severe business consequences. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Information disclosure using the 'Download Snapshot' service of HANA cockpit for offline administration\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can discover information relating to the system. This information may be used by an attacker to specialize their attack and target security-relevant data. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"J2EE Invoker Servlet\",\"This incident triggered because the Invoker Servlet was accessed. \\n\\nThe SAP Java 2 Platform Enterprise Edition (J2EE) Application Server has a wide set of built-in functionality, providing a comprehensive framework of libraries and services to support the development and deployment of Java applications. One of these functionalities is the Invoker Servlet, which is part of the standard J2EE specification of Sun (now Oracle). It was conceived as a rapid development instrument, allowing developers to test their custom Java applications very quickly. \\n\\nWhen enabled, this feature allows anyone to call specific applications without requiring authentication, which implies a security risk. The Invoker Servlet attack (sometimes referred to as the Invoker Servlet Detour) is the vulnerability caused by the previously mentioned feature and allows remote malicious hackers to bypass authentication mechanisms and perform unauthorized business activities via the vulnerable SAP applications. The potential impact of its exploitation is the complete compromise of the SAP system.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Missing XML Validation in Composite Application Framework Authorization Tool\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nThe vulnerable component which is accessed through the URI does not sufficiently validate an XML document coming from a possibly untrusted source. This programming error allows malicious users to submit XML files containing content that can cause harm to the system, for instance by disrupting service(s) or disclosing information that is is intended to remain private. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Missing XML Validation vulnerability in TranslationSupport application\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nThe vulnerable component which is accessed through the URI does not sufficiently validate an XML document coming from a possibly untrusted source. This programming error allows malicious users to submit XML files containing content that can cause harm to the system, for instance by disrupting service(s) or disclosing information that is is intended to remain private. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"OS Command Injection vulnerability in Report for Terminology Export\",\"This incident triggered because a report vulnerable to OS command injection was accessed. \\n\\nThe system contains code that permits the execution of (possibly arbitrary) operating system commands of the user's choice. An attacker can therefore control the behavior of the system, or can potentially escalate privileges by executing malicious code, without having their own legitimate credentials.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Path traversal using the 'Download Snapshot' service of HANA cockpit for offline administration\", \"This incident triggered because a URI was accessed which is vulnerable to directory traversal. \\n\\nThe vulnerability allows an attacker to exploit the insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file access APIs. This allows a malicious user to potentially read, write and delete arbitrary files on the remote server, possibly disclosing confidential information, corrupting data or altering system behavior. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential Directory Traversal in a UserAdmin Application\",\"This incident triggered because a URI was accessed which is vulnerable to directory traversal. \\n\\nThe vulnerability allows an attacker to exploit the insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file access APIs. This allows a malicious user to potentially read, write and delete arbitrary files on the remote server, possibly disclosing confidential information, corrupting data or altering system behavior. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential Directory Traversal or XML Validation vulnerability in Log Viewer\",\"This incident triggered because a URI was accessed which is vulnerable to directory traversal. \\n\\nThe vulnerability allows an attacker to exploit the insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file access APIs. This allows a malicious user to potentially read, write and delete arbitrary files on the remote server, possibly disclosing confidential information, corrupting data or altering system behavior. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential execution of buffer overflow attack in EXECUTE_SEARCH_RULESET stored procedure\",\"This incident triggered because a stored procedure containing a buffer overflow vulnerability was called. \\n\\nA stored procedure is prepared SQL code that can be called and therefore reused repeatedly on the system. A remote authenticated attacker could exploit a vulnerability existing in a stored procedure by overwriting the memory buffer out of its bounds, thereby rendering the SAP HANA Platform unavailable to other users until the next process restart.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential exploitation of Buffer overflow vulnerability with a long username to SAP HANA\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can overwrite the memory buffer of the system. By doing this, the attacker can access and/or manipulate parts of system that should be restricted. This can allow the attacker to execute malicious code or cause the system to crash. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential information disclosure relating to Real Time Collaboration Chat\",\"This incident triggered because a vulnerable Web Dynpro URI was accessed. \\n\\nWeb Dynpro is the SAP standard UI technology for developing web applications in the ABAP environment. Certain components of Web Dynpro have been found to be vulnerable. By approaching Web Dynpro through certain URI's attackers can access information which should otherwise be restricted. \\n\\nThe fact that a vulnerable Web Dynpro URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential information disclosure relating to Transaction SCI (Code Inspector)\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can discover information relating to the system. This information may be used by an attacker to specialize their attack and target security-relevant data. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential log injection in SAP HANA\",\"This incident triggered because an attempt to exploit a log injection vulnerability was detected. \\n\\nDuring an attempted user login an attacker can inject information into the system log. Inserting events into the log could disrupt (forensic) analysis of the log or otherwise cause confusion.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential Log injection in SAP HANA XS\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can inject information into the system log. Inserting events into the log could disrupt (forensic) analysis of the log or otherwise cause confusion. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential modif./disclosure of persisted data in BC-ESI-UDDI\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential XSRF attack\",\"This incident triggered because a URI vulnerable to Cross-site Request Forgery (XSRF) was accessed. \\n\\nEnd users may be fooled by an attacker to access a specially crafted URL, consisting of the vulnerable URL with certain added parameters. If they do, certain system functions may be executed with the executing user's rights. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential XSS attack\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential XSS attack in PI Message Display Tool\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"PotentialXXE vulnerability in SAP UDDI\",\"This incident triggered because a URI with an XML eXternal Entity type vulnerability was accessed. \\n\\nUntrusted XML input parsing is possible in SAP UDDI (Universal Description, Discovery and Integration). The vulnerability allows a malicious user to send specially crafted XML content to perform a Denial of Service or retrieve data from the affected SAP System..\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Reflected File Download attempt in AFPServlet\",\"This incident triggered because a URI vulnerable to Reflected File Download attacks was accessed with malicious looking parameters. \\n\\nThe vulnerability allows attackers to inject malicious code into a specially crafted URL. By fooling end users to access this URL, a seemingly trusted file is offered for download coming from a trusted domain. Once downloaded and opened by the client, unwanted applications could potentially be started on the client machine by an attacker, resulting in remote code execution.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA Daemon Execution of Administrative Method\",\"This incident triggered because a vulnerable HANA daemon administrative method was executed. \\n\\nThe daemon service in a SAP HANA landscape is used to start, stop and restart all SAP HANA services. It was reported by SAP that communication encryption was not being enabled for the daemon service on unpatched systems. This means potential attackers could cause denial of service by stopping/restarting the instance if they either gain access to the operating system of the SAP HANA system with an authorized user or can access the network configured for SAP HANA internal network configuration. \\n\\nThe fact that a vulnerable HANA daemon administrative method was executed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA global.ini settings SQL Injection\",\"This incident triggered because a URI was accessed which is vulnerable to an SQL-injection attack. \\n\\nThe vulnerability allows an attacker to execute crafted database queries, giving him the ability to execute admin level operations on database and thereby exposing the backend database. Some well-known effects of an SQL injection vulnerability are the ability to read, modify or delete sensitive data from the database. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA User Self Service SQL Injection in ACTIVATE USER query\",\"This incident triggered because an URI vulnerable to SQL injection was accessed. \\n\\nThe vulnerability concerns one of several vulnerabilities in the HANA User Self Service (USS) functionality. Through successful exploitation of these vulnerabilities, an unauthenticated attacker would be able to impersonate other users, even those of high privileged accounts. If exploited, these vulnerabilities allow an attacker, whether inside or outside the organization, to take full control of the SAP HANA platform remotely, without the need of a username and password. This level of access allows an attacker to take over business information and processes supported by HANA. This included creating, stealing, altering, and/or deleting sensitive information. If this risk is exploited, organizations may face severe business consequences. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA User Self Service SQL Injection in SET PASSWORD query\",\"This incident triggered because a URI was accessed which is vulnerable to an SQL-injection attack. \\n\\nThe vulnerability allows an attacker to execute crafted database queries, giving him the ability to execute admin level operations on database and thereby exposing the backend database. Some well-known effects of an SQL injection vulnerability are the ability to read, modify or delete sensitive data from the database. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP J2EE Verb tampering\",\"This incident triggered because a vulnerable URI was accessed with an unexpected HTTP method. \\n\\nThe HTTP specification includes request methods other than the standard GET and POST requests. A standards compliant web server may respond to these alternative methods (verbs) in ways not anticipated by developers. An attacker may subsequently leverage these methods for malicious objectives, for example by obtaining unauthorized access to restricted resources from arbitrary network locations. \\n\\nCertain URI's have been found to be vulnerable to these verb tampering attacks.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Security vulnerabilities in an ICF service belonging to SAP ITS Mobile\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login of EARLYWATCH user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login with DDIC user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login with SAPCPIC user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login, via RFC, with TMSADM user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"System Landscape Directory Information Disclosure\",\"This incident triggered because a vulnerable Web Dynpro URI was accessed. \\n\\nWeb Dynpro is the SAP standard UI technology for developing web applications in the ABAP environment. Certain components of Web Dynpro have been found to be vulnerable. By approaching Web Dynpro through certain URI's attackers can access information which should otherwise be restricted. \\n\\nThe fact that a vulnerable Web Dynpro URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"TrexNet Method Execution From Untrusted Host\",\"This incident triggered because a TrexNet method was executed from a possibly untrusted host \\n\\nUsing the multiple methods available in the TrexNet protocol, a remote unauthenticated attacker could execute arbitrary operating system commands, python modules, read, write and delete files and directories, read environment information and also completely shut down the SAP HANA instance. Furthermore, the attacker could send TMS queries to the NameSever component, which could allow him to retrieve technical information about the remote system such as configuration files. \\n\\nAlthough OSP cannot determine if the host is malicious or not, it is important to validate its origin and purpose.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Web Dynpro JAVA Guided Procedures Information Disclosure\",\"This incident triggered because a vulnerable Web Dynpro URI was accessed. \\n\\nWeb Dynpro is the SAP standard UI technology for developing web applications in the ABAP environment. Certain components of Web Dynpro have been found to be vulnerable. By approaching Web Dynpro through certain URI's attackers can access information which should otherwise be restricted. \\n\\nThe fact that a vulnerable Web Dynpro URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in Enterprise Portal - GenericSemanticTest component\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in LogPortalComponent\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in NavigationRequestSniffer\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in NavigationURLTester\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in Notification Topic Creation\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in PI Message Display Tool\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP Java Web Application saml2_sp\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP NetWeaver Central Technical Configuration\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP NetWeaver Composite Application Framework and Business Warehouse Test Integration\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP NetWeaver Java Archiving Framework\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP Netweaver Portal Error section\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in UpdateVersionPortalComponent\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Access to SOAP RFC service\",\"This incident gets triggered when OSP detects users attempting to access the SOAP RFC service. The SOAP RFC service has been marked as dangerous by SAP and should be deactivated.\",\"Disable the SOAP RFC service in transaction SICM if not required.\",\r\n\"Assignment of S_DEVELOP authorization object to single role\",\"This incident gets triggered when OSP detects the assignment of S_DEVELOP authorization object. Using this object, you can assign access authorizations for all the workbench components. This should never occur on production systems\",\"1. Remove the S_DEVELOP privilege from the user. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate. 3. Investigate who assigned that privilege to the user and why.\",\r\n\"Assignment of SAP_ALL profile to user\",\"This incident gets triggered when OSP detects the assignment of SAP_ALL profile to a user. This should happen only under extraordinary circumstances.\",\"1. Remove the SAP_ALL privilege from the user. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate. 3. Investigate who assigned that privilege to the user and why.\",\r\n\"Dangerous execution of j2ee CTC servlet administrative method\",\"This incident gets triggered when OSP detects potentially dangerous administrative requests being made to Central Technical Configuration servlet.\",\"Work with the BASIS team to prioritize applying the applicable note.\",\r\n\"Potential exploitation of Buffer overflow vulnerability with a long username\",\"This incident gets triggered when OSP detects an attacker using HTTP buffer overrun authentication request that attempts to exploit a vulnerability in SAP HANA.\",\"Work with the BASIS team to prioritize applying the applicable note.\",\r\n\"Potential information disclosure trough SQL command IMPORT FROM\",\"This incident gets triggered when OSP detects a SQL IMPORT FROM command that could result in being able to gain unauthorized access to data.\",\"Work with the BASIS team to prioritize applying the applicable note.\",\r\n\"Potential untrusted application server registered in the SAP Message Server\",\"This incident gets triggered when OSP detects the registration of an unknown application server in the SAP Message Server. This should happen only under extraordinary circumstances.\",\"Make sure your Message Server ACL is properly configured. The path of the ACL file can be found in profile parameter ms/acl info. Make sure the SAP Message Server internal port is only accessible from the corresponding sources.\",\r\n\"Registering of Potential Dangerous RFC Server\",\"This incident gets triggered when OSP detects the registration of sensitive programs in the SAP Gateway. These programs should never be accessed over RFC.\",\"Make sure your reg info ACL is properly configured. The path of the ACL file can be found in profile parameter gw/reg_info. Make sure the registered server is only accessible from the corresponding sources.\",\r\n\"Starting of Potentially dangerous RFCEXEC server from untrusted host\",\"This incident gets triggered when OSP detects execution of RFCEXEC from a remote machine.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info. Make sure the program can only be executed from the corresponding sources.\",\r\n\"Starting of Potentially dangerous SAPXPG server from untrusted host\",\"This incident gets triggered when OSP detects execution of SAPXGP from a remote machine.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info Make sure the program can only be executed from the corresponding sources.\",\r\n\"Successful login via RFC with SAP* user and default password\",\"This incident gets triggered when OSP detects an RFClogin by the SAP* user using the default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Successful login with (SAP*:PASS) in a client with users already configured\",\"This incident gets triggered when OSP detects a login by the SAP* user using the default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Successful login with (SAP*:PASS) in a client without users configured\",\"This incident gets triggered when OSP detects a login by the SAP* user using the default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Successful login with SAP* user and a non-default password\",\"This incident gets triggered when OSP detects a login by the SAP* user using a non-default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Unlocking of User DDIC\",\"This incident gets triggered when OSP detects the DDIC user account being unlocked. DDIC is a default user with high privilege authorizations.\",\"1. Lock the DDIC user account. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate.\",\r\n\"Unlocking of User EARLYWATCH\",\"This incident gets triggered when OSP detects the EARLYWATCH user account being unlocked. EARLYWATCH is a default user with high privileges.\",\"1. Lock the EARLYWATCH user account. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate.\",\r\n\"Unlocking of User SAP*\",\"This incident gets triggered when OSP detects the SAP* user account being unlocked. SAP* is a default user with SAP_ALL authorizations.\",\"Block the SAP* user. If necessary, use the corresponding emergency super user.\",\r\n\"User SAP* deleted and profile parameter login/no_automatic_sap_star set to 0\",\"This incident gets triggered when OSP detects the SAP* deleted while a profile parameter preventing login with the default password is disabled. In this case, if the user master record of the user SAP* is deleted, it is possible to log on with SAP* using the default password.\",\"1. Create an emergency super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"10KBLAZE Public Exploit Used to Started SAPXPG server\",\"This incident gets triggered when OSP detects execution of SAPXGP from a remote machine.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info Make sure the program can only be executed from the corresponding sources.\",\r\n\"Assignment of high privilege profile to user\",\"This incident gets triggered when OSP detects the addition of high privileges to an SAP users. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Assignment of SAP_NEW profile to user\",\"This incident gets triggered when OSP detects the addition of high privileges to an SAP users. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Attempt to disable authorization objects globally\",\"This incident gets triggered when OSP detects an attempt to change a critical SAP parameter that could be used to elevate privileges. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Attempt to set insecure configuration blocked\",\"This incident gets triggered when OSP detects a user trying to change a critical configuration that the organization is protecting using Onapsis Enforce and Protect\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Deactivation of Security Audit Log (SAL) in SAP system\",\"This incident gets triggered when OSP detects an attempt to change a critical SAP parameter that could be used by an attacker to evade detection. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Debugging in non-production system by a non-developer user\",\"This incident gets triggered when OSP detects a non developer SAP user activating debug - this could be used by an attacker as reconaissance for an attack. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Debugging in production system\",\"This incident gets triggered when OSP detects an SAP user activating debug in a production system - this could be used by an attacker as reconaissance for an attack. This is an unusual developer activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Field content changed in debugging in production system\",\"This incident gets triggered when OSP detects an SAP user activating debug in a production system - this could be used by an attacker as reconaissance for an attack. This is an unusual developer activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Jump to ABAP debugging in production system\",\"This incident gets triggered when OSP detects an SAP user activating debug in a production system - this could be used by an attacker as reconaissance for an attack. This is an unusual developer activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Non existing users login failed\",\"This inincdent gets triggered when OSP detects a new SAP user failing t logon to the system. This could be indicative of an attacker trying to take advantage of administrative process failures\",\"Follow up with the triggering user to understand the business intent of the activity\",\r\n\"OSP Unauthenticated Scan or Audit Started RFCEXEC server\",\"This incident gets triggered when OSP detects execution of RFCEXEC as part of an Onapsis Security Platform unauthenticated scan\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info. Make sure the program can only be executed from the corresponding sources.\",\r\n\"OSP Unauthenticated Scan or Audit Started SAPXPG server\",\"This incident gets triggered when OSP detects execution of SAPXPG from as part of an Onapsis Security Platform unauthenticated scan.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info. Make sure the program can only be executed from the corresponding sources.\",\r\n\"Parameter set to an insecure configuration\",\"This incident gets triggered when OSP detects a user changing a critical configuration that the organization is monitoring using Onapsis Enforce and Protect\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Parameter set to an insecure configuration approved by OSP User\",\"This incident gets triggered when OSP detects an approved user changing a critical configuration that the organization is monitoring using Onapsis Enforce and Protect\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Removed standard user from SUPER group\",\"This incident gets triggered when OSP detects the removal of a user from a highly privileged group. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Successful login of a Solution Manager default user with standard password\",\"This incident gets triggered when OSP login to a crtiical SAP administrative function using a default user with a default password. This is an unusual administrative activity that needs follow up. Also review processes around disabling and changing default users and passwords\",\"Follow up with the triggering user to understand the business intent of the activity\",\r\n\"Successful login of a user with SAP_ALL profile in production client\",\"This incident gets triggered when OSP login to an SAP production system by a highly privileged user. This is an unusual administrative activity that needs follow up. Also review processes around disabling and changing default users and passwords\",\"Follow up with the triggering user to understand the business intent of the activity\",\r\n\"XSS in Java Web Application tc~sec~saml~ssodemoapp\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack.\\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP Netweaver Portal Download section\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack.\\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Onapsis OSP_Test for ACD (Authorization Change Documents) extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for HANA - Audit Trail extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for HANA - HTTP Access Log extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for ICM Access Log extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for JAVA_HTTP extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for login extraction from SAL\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for Message Server (MsgServer) extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for STAD extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis Zero Day Incident test rule\",\"This is a test rule.\",\" Take no action.\",\r\n\"OP_Shipped_Sec_SAP_ALL / SAP_NEW assigned\",\"This alarm, provided by Onapsis, alerts when SAP_ALL or SAP_NEW user is assigned. SAP_ALL/SAP_NEW are highly privileged roles within an SAP System and should be managed with the utmost care.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_ABAP T-Code Permission Denied\",\"This alarm, provided by Onapsis, alerts when transaction SU01 has been denied. SU01 is an SAP transaction for managing users and profiles. Someone trying and failing to use this transaction could be indicative of an attacker trying to gain high privilege within the system.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_Attempt to Open Client\",\"This alarm, provided by Onapsis, alerts when there was an attempt to open client. A client is an independent logical database that stores all the business database separately. Any major system change needs to be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_Attempt to Close Client\",\"This alarm, provided by Onapsis, alerts when there was an attempt to close client. A client is an independent logical database that stores all the business database separately. Any major system change needs to be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_RFC Destination Deleted\",\"This alarm, provided by Onapsis, alerts when an RFC Destination is deleted. RFC Destination is connectivity between SAP and an internal/external system. These systems are often sources of attacks, and changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_RFC Destination Created\",\"This alarm, provided by Onapsis, alerts when an RFC Destination is created. RFC Destination is connectivity between SAP and an internal/external system. These systems are often sources of attacks, and changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_RFC Destination Changed\",\"This alarm, provided by Onapsis, alerts when an RFC Destination is changed. RFC Destination is connectivity between SAP and an internal/external system. These systems are often sources of attacks, and changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_Deletion of a T-Code\",\"This alarm, provided by Onapsis, alerts when a transaction code is deleted. Transaction code is a command, and each function in SAP has an associated transaction code. By cloning transaction codes, you can evade detection. These changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_ Sec_Changes/Creation_of_T-Code\",\"This alarm, provided by Onapsis, alerts when a transaction code is changed. Transaction code is a command, and each function in SAP has an associated transaction code. By cloning transaction codes, you can evade detection. These changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\"\r\n];\r\nIncidentLookup",
                "version": 1,
                "tags": [
                  {
                    "name": "description",
                    "value": "OnapsisLookup"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('_parserId1'),'/'))))]",
              "dependsOn": [
                "[variables('_parserName1')]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
                "contentId": "[variables('_parserContentId1')]",
                "kind": "Parser",
                "version": "[variables('parserVersion1')]",
                "source": {
                  "name": "Onapsis Platform",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Onapsis"
                },
                "support": {
                  "name": "Onapsis",
                  "tier": "Partner",
                  "link": "https://onapsis.com/company/contact-us"
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2021-06-01",
      "name": "[variables('_parserName1')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "OnapsisLookup",
        "category": "Samples",
        "functionAlias": "OnapsisLookup",
        "query": "\n\r\nlet IncidentLookup = datatable(IncidentName:string, RootCause:string, Solution:string)\r\n[\r\n\"Access to authenticated URL without credentials\",\"This incident triggered because a vulnerable authenticated HANA URL was accessed without credentials. \\n\\nThe URI is vulnerable because it allows the corresponding (backend) SAP software component to be accessed without providing any credentials. This unauthenticated access provides an attacker with the privilege level of that functionality. The consequences will depend on the associated functionality, but they can range from reading or modifying sensitive data, access to administrative or other privileged functionality, or possibly even execution of arbitrary code.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Code Injection vulnerability in Visual Composer 04s iViews\",\"This incident triggered because a URI vulnerable to code injection was accessed with malicious looking parameters. \\n\\nThe vulnerability allows attackers to inject malicious code into the back-end application by sending a web request by means of a specially crafted URL. By fooling end users to access this URL, unwanted applications could potentially be started on the client machine by an attacker, resulting in remote code execution.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Cross-Site Scripting (XSS) vulnerability in backup function of SAP HANA cockpit\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Dangerous Report Execution\",\"This incident triggered because a vulnerable report was executed. \\n\\nAn SAP report is an executable program that reads data from the database and generates output based on the filter criteria selected by the end user. \\n\\nThe fact that a vulnerable report was run may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Dangerous RFC Execution\",\"This incident triggered because a vulnerable Remote Function Call (RFC) was executed. \\n\\nA Remote Function Call (RFC) is the call or remote execution of a Remote Function Module in an external system. In the SAP system, these functions are provided by the RFC interface system. The RFC interface system enables function calls between two SAP systems. Communication between applications of different systems in the SAP environment includes connections between SAP systems as well as between SAP systems and non-SAP systems. \\n\\nThe fact that a vulnerable RFC was performed may indicate, but not necessarily confirm, that an attacker is abusing a vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Dangerous Transaction Execution\",\"This incident triggered because a vulnerable transaction code was executed. \\n\\nEach function in the SAP system has a transaction code (t-code) associated with it. A transaction code consists of letters, numbers, or both. A transaction code is used to access functions or running programs in the SAP application more rapidly. By entering a t-code instead of using the menu, navigation and execution are combined into a single step. \\n\\nThe fact that a vulnerable transaction code was run may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Hardcoded Credential in Report\",\"This incident triggered because a vulnerable report was called with a suspicious username. \\n\\nA report is a presentation of data in an organized structure. The report interface allows users to call reports from other SAP application components. \\n\\nIn this case the called report's program code contains a hard-coded credential. By calling the report with the hard-coded username, malicious users can be successfully authenticated and access parts of the systems not intended for them. \\n\\nThe fact that the report was called with a hard-coded username may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Host Header injection in SAP HANA\",\"This incident triggered because an URI vulnerable to SQL injection was accessed. \\n\\nThe vulnerability concerns one of several vulnerabilities in the HANA User Self Service (USS) functionality. Through successful exploitation of these vulnerabilities, an unauthenticated attacker would be able to impersonate other users, even those of high privileged accounts. If exploited, these vulnerabilities allow an attacker, whether inside or outside the organization, to take full control of the SAP HANA platform remotely, without the need of a username and password. This level of access allows an attacker to take over business information and processes supported by HANA. This included creating, stealing, altering, and/or deleting sensitive information. If this risk is exploited, organizations may face severe business consequences. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Information disclosure using the 'Download Snapshot' service of HANA cockpit for offline administration\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can discover information relating to the system. This information may be used by an attacker to specialize their attack and target security-relevant data. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"J2EE Invoker Servlet\",\"This incident triggered because the Invoker Servlet was accessed. \\n\\nThe SAP Java 2 Platform Enterprise Edition (J2EE) Application Server has a wide set of built-in functionality, providing a comprehensive framework of libraries and services to support the development and deployment of Java applications. One of these functionalities is the Invoker Servlet, which is part of the standard J2EE specification of Sun (now Oracle). It was conceived as a rapid development instrument, allowing developers to test their custom Java applications very quickly. \\n\\nWhen enabled, this feature allows anyone to call specific applications without requiring authentication, which implies a security risk. The Invoker Servlet attack (sometimes referred to as the Invoker Servlet Detour) is the vulnerability caused by the previously mentioned feature and allows remote malicious hackers to bypass authentication mechanisms and perform unauthorized business activities via the vulnerable SAP applications. The potential impact of its exploitation is the complete compromise of the SAP system.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Missing XML Validation in Composite Application Framework Authorization Tool\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nThe vulnerable component which is accessed through the URI does not sufficiently validate an XML document coming from a possibly untrusted source. This programming error allows malicious users to submit XML files containing content that can cause harm to the system, for instance by disrupting service(s) or disclosing information that is is intended to remain private. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Missing XML Validation vulnerability in TranslationSupport application\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nThe vulnerable component which is accessed through the URI does not sufficiently validate an XML document coming from a possibly untrusted source. This programming error allows malicious users to submit XML files containing content that can cause harm to the system, for instance by disrupting service(s) or disclosing information that is is intended to remain private. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"OS Command Injection vulnerability in Report for Terminology Export\",\"This incident triggered because a report vulnerable to OS command injection was accessed. \\n\\nThe system contains code that permits the execution of (possibly arbitrary) operating system commands of the user's choice. An attacker can therefore control the behavior of the system, or can potentially escalate privileges by executing malicious code, without having their own legitimate credentials.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Path traversal using the 'Download Snapshot' service of HANA cockpit for offline administration\", \"This incident triggered because a URI was accessed which is vulnerable to directory traversal. \\n\\nThe vulnerability allows an attacker to exploit the insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file access APIs. This allows a malicious user to potentially read, write and delete arbitrary files on the remote server, possibly disclosing confidential information, corrupting data or altering system behavior. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential Directory Traversal in a UserAdmin Application\",\"This incident triggered because a URI was accessed which is vulnerable to directory traversal. \\n\\nThe vulnerability allows an attacker to exploit the insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file access APIs. This allows a malicious user to potentially read, write and delete arbitrary files on the remote server, possibly disclosing confidential information, corrupting data or altering system behavior. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential Directory Traversal or XML Validation vulnerability in Log Viewer\",\"This incident triggered because a URI was accessed which is vulnerable to directory traversal. \\n\\nThe vulnerability allows an attacker to exploit the insufficient validation of path information provided by users, thus characters representing 'traverse to parent directory' are passed through to the file access APIs. This allows a malicious user to potentially read, write and delete arbitrary files on the remote server, possibly disclosing confidential information, corrupting data or altering system behavior. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential execution of buffer overflow attack in EXECUTE_SEARCH_RULESET stored procedure\",\"This incident triggered because a stored procedure containing a buffer overflow vulnerability was called. \\n\\nA stored procedure is prepared SQL code that can be called and therefore reused repeatedly on the system. A remote authenticated attacker could exploit a vulnerability existing in a stored procedure by overwriting the memory buffer out of its bounds, thereby rendering the SAP HANA Platform unavailable to other users until the next process restart.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential exploitation of Buffer overflow vulnerability with a long username to SAP HANA\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can overwrite the memory buffer of the system. By doing this, the attacker can access and/or manipulate parts of system that should be restricted. This can allow the attacker to execute malicious code or cause the system to crash. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential information disclosure relating to Real Time Collaboration Chat\",\"This incident triggered because a vulnerable Web Dynpro URI was accessed. \\n\\nWeb Dynpro is the SAP standard UI technology for developing web applications in the ABAP environment. Certain components of Web Dynpro have been found to be vulnerable. By approaching Web Dynpro through certain URI's attackers can access information which should otherwise be restricted. \\n\\nThe fact that a vulnerable Web Dynpro URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential information disclosure relating to Transaction SCI (Code Inspector)\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can discover information relating to the system. This information may be used by an attacker to specialize their attack and target security-relevant data. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential log injection in SAP HANA\",\"This incident triggered because an attempt to exploit a log injection vulnerability was detected. \\n\\nDuring an attempted user login an attacker can inject information into the system log. Inserting events into the log could disrupt (forensic) analysis of the log or otherwise cause confusion.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential Log injection in SAP HANA XS\",\"This incident triggered because a vulnerable URI was accessed. \\n\\nBy accessing the URI in a specialized way, an attacker can inject information into the system log. Inserting events into the log could disrupt (forensic) analysis of the log or otherwise cause confusion. \\n\\nThe fact that a vulnerable URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential modif./disclosure of persisted data in BC-ESI-UDDI\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential XSRF attack\",\"This incident triggered because a URI vulnerable to Cross-site Request Forgery (XSRF) was accessed. \\n\\nEnd users may be fooled by an attacker to access a specially crafted URL, consisting of the vulnerable URL with certain added parameters. If they do, certain system functions may be executed with the executing user's rights. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential XSS attack\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Potential XSS attack in PI Message Display Tool\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"PotentialXXE vulnerability in SAP UDDI\",\"This incident triggered because a URI with an XML eXternal Entity type vulnerability was accessed. \\n\\nUntrusted XML input parsing is possible in SAP UDDI (Universal Description, Discovery and Integration). The vulnerability allows a malicious user to send specially crafted XML content to perform a Denial of Service or retrieve data from the affected SAP System..\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Reflected File Download attempt in AFPServlet\",\"This incident triggered because a URI vulnerable to Reflected File Download attacks was accessed with malicious looking parameters. \\n\\nThe vulnerability allows attackers to inject malicious code into a specially crafted URL. By fooling end users to access this URL, a seemingly trusted file is offered for download coming from a trusted domain. Once downloaded and opened by the client, unwanted applications could potentially be started on the client machine by an attacker, resulting in remote code execution.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA Daemon Execution of Administrative Method\",\"This incident triggered because a vulnerable HANA daemon administrative method was executed. \\n\\nThe daemon service in a SAP HANA landscape is used to start, stop and restart all SAP HANA services. It was reported by SAP that communication encryption was not being enabled for the daemon service on unpatched systems. This means potential attackers could cause denial of service by stopping/restarting the instance if they either gain access to the operating system of the SAP HANA system with an authorized user or can access the network configured for SAP HANA internal network configuration. \\n\\nThe fact that a vulnerable HANA daemon administrative method was executed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA global.ini settings SQL Injection\",\"This incident triggered because a URI was accessed which is vulnerable to an SQL-injection attack. \\n\\nThe vulnerability allows an attacker to execute crafted database queries, giving him the ability to execute admin level operations on database and thereby exposing the backend database. Some well-known effects of an SQL injection vulnerability are the ability to read, modify or delete sensitive data from the database. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA User Self Service SQL Injection in ACTIVATE USER query\",\"This incident triggered because an URI vulnerable to SQL injection was accessed. \\n\\nThe vulnerability concerns one of several vulnerabilities in the HANA User Self Service (USS) functionality. Through successful exploitation of these vulnerabilities, an unauthenticated attacker would be able to impersonate other users, even those of high privileged accounts. If exploited, these vulnerabilities allow an attacker, whether inside or outside the organization, to take full control of the SAP HANA platform remotely, without the need of a username and password. This level of access allows an attacker to take over business information and processes supported by HANA. This included creating, stealing, altering, and/or deleting sensitive information. If this risk is exploited, organizations may face severe business consequences. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP HANA User Self Service SQL Injection in SET PASSWORD query\",\"This incident triggered because a URI was accessed which is vulnerable to an SQL-injection attack. \\n\\nThe vulnerability allows an attacker to execute crafted database queries, giving him the ability to execute admin level operations on database and thereby exposing the backend database. Some well-known effects of an SQL injection vulnerability are the ability to read, modify or delete sensitive data from the database. \\n\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"SAP J2EE Verb tampering\",\"This incident triggered because a vulnerable URI was accessed with an unexpected HTTP method. \\n\\nThe HTTP specification includes request methods other than the standard GET and POST requests. A standards compliant web server may respond to these alternative methods (verbs) in ways not anticipated by developers. An attacker may subsequently leverage these methods for malicious objectives, for example by obtaining unauthorized access to restricted resources from arbitrary network locations. \\n\\nCertain URI's have been found to be vulnerable to these verb tampering attacks.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Security vulnerabilities in an ICF service belonging to SAP ITS Mobile\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login of EARLYWATCH user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login with DDIC user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login with SAPCPIC user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Successful login, via RFC, with TMSADM user using default password\",\"This incident triggered because a successful login of a privileged user with a default password was detected. \\n\\nCertain users in the system may be configured with a default well-known password. This situation allows a remote unauthorized party to access the SAP system with high privileges and perform sensitive business and technical operations.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"System Landscape Directory Information Disclosure\",\"This incident triggered because a vulnerable Web Dynpro URI was accessed. \\n\\nWeb Dynpro is the SAP standard UI technology for developing web applications in the ABAP environment. Certain components of Web Dynpro have been found to be vulnerable. By approaching Web Dynpro through certain URI's attackers can access information which should otherwise be restricted. \\n\\nThe fact that a vulnerable Web Dynpro URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"TrexNet Method Execution From Untrusted Host\",\"This incident triggered because a TrexNet method was executed from a possibly untrusted host \\n\\nUsing the multiple methods available in the TrexNet protocol, a remote unauthenticated attacker could execute arbitrary operating system commands, python modules, read, write and delete files and directories, read environment information and also completely shut down the SAP HANA instance. Furthermore, the attacker could send TMS queries to the NameSever component, which could allow him to retrieve technical information about the remote system such as configuration files. \\n\\nAlthough OSP cannot determine if the host is malicious or not, it is important to validate its origin and purpose.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Web Dynpro JAVA Guided Procedures Information Disclosure\",\"This incident triggered because a vulnerable Web Dynpro URI was accessed. \\n\\nWeb Dynpro is the SAP standard UI technology for developing web applications in the ABAP environment. Certain components of Web Dynpro have been found to be vulnerable. By approaching Web Dynpro through certain URI's attackers can access information which should otherwise be restricted. \\n\\nThe fact that a vulnerable Web Dynpro URI was accessed may indicate, but not necessarily confirm, that an attacker is abusing the vulnerability.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in Enterprise Portal - GenericSemanticTest component\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in LogPortalComponent\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in NavigationRequestSniffer\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in NavigationURLTester\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in Notification Topic Creation\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in PI Message Display Tool\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP Java Web Application saml2_sp\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP NetWeaver Central Technical Configuration\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP NetWeaver Composite Application Framework and Business Warehouse Test Integration\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP NetWeaver Java Archiving Framework\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP Netweaver Portal Error section\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in UpdateVersionPortalComponent\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack. \\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Access to SOAP RFC service\",\"This incident gets triggered when OSP detects users attempting to access the SOAP RFC service. The SOAP RFC service has been marked as dangerous by SAP and should be deactivated.\",\"Disable the SOAP RFC service in transaction SICM if not required.\",\r\n\"Assignment of S_DEVELOP authorization object to single role\",\"This incident gets triggered when OSP detects the assignment of S_DEVELOP authorization object. Using this object, you can assign access authorizations for all the workbench components. This should never occur on production systems\",\"1. Remove the S_DEVELOP privilege from the user. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate. 3. Investigate who assigned that privilege to the user and why.\",\r\n\"Assignment of SAP_ALL profile to user\",\"This incident gets triggered when OSP detects the assignment of SAP_ALL profile to a user. This should happen only under extraordinary circumstances.\",\"1. Remove the SAP_ALL privilege from the user. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate. 3. Investigate who assigned that privilege to the user and why.\",\r\n\"Dangerous execution of j2ee CTC servlet administrative method\",\"This incident gets triggered when OSP detects potentially dangerous administrative requests being made to Central Technical Configuration servlet.\",\"Work with the BASIS team to prioritize applying the applicable note.\",\r\n\"Potential exploitation of Buffer overflow vulnerability with a long username\",\"This incident gets triggered when OSP detects an attacker using HTTP buffer overrun authentication request that attempts to exploit a vulnerability in SAP HANA.\",\"Work with the BASIS team to prioritize applying the applicable note.\",\r\n\"Potential information disclosure trough SQL command IMPORT FROM\",\"This incident gets triggered when OSP detects a SQL IMPORT FROM command that could result in being able to gain unauthorized access to data.\",\"Work with the BASIS team to prioritize applying the applicable note.\",\r\n\"Potential untrusted application server registered in the SAP Message Server\",\"This incident gets triggered when OSP detects the registration of an unknown application server in the SAP Message Server. This should happen only under extraordinary circumstances.\",\"Make sure your Message Server ACL is properly configured. The path of the ACL file can be found in profile parameter ms/acl info. Make sure the SAP Message Server internal port is only accessible from the corresponding sources.\",\r\n\"Registering of Potential Dangerous RFC Server\",\"This incident gets triggered when OSP detects the registration of sensitive programs in the SAP Gateway. These programs should never be accessed over RFC.\",\"Make sure your reg info ACL is properly configured. The path of the ACL file can be found in profile parameter gw/reg_info. Make sure the registered server is only accessible from the corresponding sources.\",\r\n\"Starting of Potentially dangerous RFCEXEC server from untrusted host\",\"This incident gets triggered when OSP detects execution of RFCEXEC from a remote machine.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info. Make sure the program can only be executed from the corresponding sources.\",\r\n\"Starting of Potentially dangerous SAPXPG server from untrusted host\",\"This incident gets triggered when OSP detects execution of SAPXGP from a remote machine.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info Make sure the program can only be executed from the corresponding sources.\",\r\n\"Successful login via RFC with SAP* user and default password\",\"This incident gets triggered when OSP detects an RFClogin by the SAP* user using the default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Successful login with (SAP*:PASS) in a client with users already configured\",\"This incident gets triggered when OSP detects a login by the SAP* user using the default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Successful login with (SAP*:PASS) in a client without users configured\",\"This incident gets triggered when OSP detects a login by the SAP* user using the default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Successful login with SAP* user and a non-default password\",\"This incident gets triggered when OSP detects a login by the SAP* user using a non-default password. SAP* is a default user with SAP_ALL authorizations.\",\"1. Create a super user with SAP_ALL and make sure it has a secret strong password 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"Unlocking of User DDIC\",\"This incident gets triggered when OSP detects the DDIC user account being unlocked. DDIC is a default user with high privilege authorizations.\",\"1. Lock the DDIC user account. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate.\",\r\n\"Unlocking of User EARLYWATCH\",\"This incident gets triggered when OSP detects the EARLYWATCH user account being unlocked. EARLYWATCH is a default user with high privileges.\",\"1. Lock the EARLYWATCH user account. 2. Analyze SAP logs to verify that any actions performed by that user are legitimate.\",\r\n\"Unlocking of User SAP*\",\"This incident gets triggered when OSP detects the SAP* user account being unlocked. SAP* is a default user with SAP_ALL authorizations.\",\"Block the SAP* user. If necessary, use the corresponding emergency super user.\",\r\n\"User SAP* deleted and profile parameter login/no_automatic_sap_star set to 0\",\"This incident gets triggered when OSP detects the SAP* deleted while a profile parameter preventing login with the default password is disabled. In this case, if the user master record of the user SAP* is deleted, it is possible to log on with SAP* using the default password.\",\"1. Create an emergency super user with SAP_ALL and make sure it has a secret strong password. 2. Create user SAP* without any privileges, assign it to group SUPER. 3. Block the user SAP*. 4. Change parameter login/no_automatic_user_sapstar to 1.\",\r\n\"10KBLAZE Public Exploit Used to Started SAPXPG server\",\"This incident gets triggered when OSP detects execution of SAPXGP from a remote machine.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info Make sure the program can only be executed from the corresponding sources.\",\r\n\"Assignment of high privilege profile to user\",\"This incident gets triggered when OSP detects the addition of high privileges to an SAP users. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Assignment of SAP_NEW profile to user\",\"This incident gets triggered when OSP detects the addition of high privileges to an SAP users. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Attempt to disable authorization objects globally\",\"This incident gets triggered when OSP detects an attempt to change a critical SAP parameter that could be used to elevate privileges. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Attempt to set insecure configuration blocked\",\"This incident gets triggered when OSP detects a user trying to change a critical configuration that the organization is protecting using Onapsis Enforce and Protect\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Deactivation of Security Audit Log (SAL) in SAP system\",\"This incident gets triggered when OSP detects an attempt to change a critical SAP parameter that could be used by an attacker to evade detection. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Debugging in non-production system by a non-developer user\",\"This incident gets triggered when OSP detects a non developer SAP user activating debug - this could be used by an attacker as reconaissance for an attack. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Debugging in production system\",\"This incident gets triggered when OSP detects an SAP user activating debug in a production system - this could be used by an attacker as reconaissance for an attack. This is an unusual developer activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Field content changed in debugging in production system\",\"This incident gets triggered when OSP detects an SAP user activating debug in a production system - this could be used by an attacker as reconaissance for an attack. This is an unusual developer activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Jump to ABAP debugging in production system\",\"This incident gets triggered when OSP detects an SAP user activating debug in a production system - this could be used by an attacker as reconaissance for an attack. This is an unusual developer activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Non existing users login failed\",\"This inincdent gets triggered when OSP detects a new SAP user failing t logon to the system. This could be indicative of an attacker trying to take advantage of administrative process failures\",\"Follow up with the triggering user to understand the business intent of the activity\",\r\n\"OSP Unauthenticated Scan or Audit Started RFCEXEC server\",\"This incident gets triggered when OSP detects execution of RFCEXEC as part of an Onapsis Security Platform unauthenticated scan\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info. Make sure the program can only be executed from the corresponding sources.\",\r\n\"OSP Unauthenticated Scan or Audit Started SAPXPG server\",\"This incident gets triggered when OSP detects execution of SAPXPG from as part of an Onapsis Security Platform unauthenticated scan.\",\"Make sure your sec_info ACL is properly configured. The path of the ACL file can be found in parameter gw/sec_info. Make sure the program can only be executed from the corresponding sources.\",\r\n\"Parameter set to an insecure configuration\",\"This incident gets triggered when OSP detects a user changing a critical configuration that the organization is monitoring using Onapsis Enforce and Protect\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Parameter set to an insecure configuration approved by OSP User\",\"This incident gets triggered when OSP detects an approved user changing a critical configuration that the organization is monitoring using Onapsis Enforce and Protect\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Removed standard user from SUPER group\",\"This incident gets triggered when OSP detects the removal of a user from a highly privileged group. This is an unusual administrative activity that needs follow up\",\"Follow up with the triggering user to understand the business intent of the change\",\r\n\"Successful login of a Solution Manager default user with standard password\",\"This incident gets triggered when OSP login to a crtiical SAP administrative function using a default user with a default password. This is an unusual administrative activity that needs follow up. Also review processes around disabling and changing default users and passwords\",\"Follow up with the triggering user to understand the business intent of the activity\",\r\n\"Successful login of a user with SAP_ALL profile in production client\",\"This incident gets triggered when OSP login to an SAP production system by a highly privileged user. This is an unusual administrative activity that needs follow up. Also review processes around disabling and changing default users and passwords\",\"Follow up with the triggering user to understand the business intent of the activity\",\r\n\"XSS in Java Web Application tc~sec~saml~ssodemoapp\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack.\\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"XSS in SAP Netweaver Portal Download section\",\"This incident triggered because a URI was accessed which is vulnerable to a Cross-Site Scripting (XSS) attack.\\n\\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. \\n\\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.\",\"To protect the system, please refer to the SAP note(s) referenced. The note(s) will contain the prerequisites and instructions necessary to patch the system.\",\r\n\"Onapsis OSP_Test for ACD (Authorization Change Documents) extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for HANA - Audit Trail extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for HANA - HTTP Access Log extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for ICM Access Log extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for JAVA_HTTP extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for login extraction from SAL\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for Message Server (MsgServer) extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis OSP_Test for STAD extractor validation\",\"This is a test rule.\",\" Take no action.\",\r\n\"Onapsis Zero Day Incident test rule\",\"This is a test rule.\",\" Take no action.\",\r\n\"OP_Shipped_Sec_SAP_ALL / SAP_NEW assigned\",\"This alarm, provided by Onapsis, alerts when SAP_ALL or SAP_NEW user is assigned. SAP_ALL/SAP_NEW are highly privileged roles within an SAP System and should be managed with the utmost care.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_ABAP T-Code Permission Denied\",\"This alarm, provided by Onapsis, alerts when transaction SU01 has been denied. SU01 is an SAP transaction for managing users and profiles. Someone trying and failing to use this transaction could be indicative of an attacker trying to gain high privilege within the system.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_Attempt to Open Client\",\"This alarm, provided by Onapsis, alerts when there was an attempt to open client. A client is an independent logical database that stores all the business database separately. Any major system change needs to be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_Attempt to Close Client\",\"This alarm, provided by Onapsis, alerts when there was an attempt to close client. A client is an independent logical database that stores all the business database separately. Any major system change needs to be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_RFC Destination Deleted\",\"This alarm, provided by Onapsis, alerts when an RFC Destination is deleted. RFC Destination is connectivity between SAP and an internal/external system. These systems are often sources of attacks, and changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_RFC Destination Created\",\"This alarm, provided by Onapsis, alerts when an RFC Destination is created. RFC Destination is connectivity between SAP and an internal/external system. These systems are often sources of attacks, and changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_RFC Destination Changed\",\"This alarm, provided by Onapsis, alerts when an RFC Destination is changed. RFC Destination is connectivity between SAP and an internal/external system. These systems are often sources of attacks, and changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_Sec_Deletion of a T-Code\",\"This alarm, provided by Onapsis, alerts when a transaction code is deleted. Transaction code is a command, and each function in SAP has an associated transaction code. By cloning transaction codes, you can evade detection. These changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\",\r\n\"OP_Shipped_ Sec_Changes/Creation_of_T-Code\",\"This alarm, provided by Onapsis, alerts when a transaction code is changed. Transaction code is a command, and each function in SAP has an associated transaction code. By cloning transaction codes, you can evade detection. These changes should be monitored carefully.\",\"Follow up with the user specified in the alarm to understand the business intent behind this action.\"\r\n];\r\nIncidentLookup",
        "version": 1
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('_parserId1'),'/'))))]",
      "dependsOn": [
        "[variables('_parserId1')]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
        "contentId": "[variables('_parserContentId1')]",
        "kind": "Parser",
        "version": "[variables('parserVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Onapsis Platform",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Onapsis"
        },
        "support": {
          "name": "Onapsis",
          "tier": "Partner",
          "link": "https://onapsis.com/company/contact-us"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "2.0.1",
        "kind": "Solution",
        "contentSchemaVersion": "2.0.0",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Onapsis Platform",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Onapsis"
        },
        "support": {
          "name": "Onapsis",
          "tier": "Partner",
          "link": "https://onapsis.com/company/contact-us"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('_parserContentId1')]",
              "version": "[variables('parserVersion1')]"
            }
          ]
        },
        "firstPublishDate": "2022-05-11",
        "providers": [
          "Onapsis"
        ],
        "categories": {
          "domains": [
            "Security - Vulnerability Management"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
