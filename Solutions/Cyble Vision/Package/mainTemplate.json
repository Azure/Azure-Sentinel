{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Cyble Inc",
    "comments": "Solution template for Cyble Vision"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Cyble Vision Alerts Workbook  (Preview)",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "_solutionName": "Cyble Vision",
    "_solutionVersion": "3.0.2",
    "solutionId": "cybleinc1737472004964.cybleinc1737472004964-azure-sentinel-offerid",
    "_solutionId": "[variables('solutionId')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "dataConnectorCCPVersion": "1.0.0",
    "_dataConnectorContentIdConnectorDefinition1": "CybleVisionAlerts",
    "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
    "_dataConnectorContentIdConnections1": "CybleVisionAlertsConnections",
    "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
    "dataCollectionEndpointId1": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "blanks": "[replace('b', 'b', '')]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.0",
      "_analyticRulecontentId1": "0012714c-c595-4dcd-8949-4a5c1d49aaa8",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '0012714c-c595-4dcd-8949-4a5c1d49aaa8')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('0012714c-c595-4dcd-8949-4a5c1d49aaa8')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','0012714c-c595-4dcd-8949-4a5c1d49aaa8','-', '1.0.0')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.0.0",
      "_analyticRulecontentId2": "f3c25011-4509-41c8-be27-35d891531c39",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'f3c25011-4509-41c8-be27-35d891531c39')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('f3c25011-4509-41c8-be27-35d891531c39')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','f3c25011-4509-41c8-be27-35d891531c39','-', '1.0.0')))]"
    },
    "analyticRuleObject3": {
      "analyticRuleVersion3": "1.0.0",
      "_analyticRulecontentId3": "db417cee-529c-4eac-b7b9-36eb0166800a",
      "analyticRuleId3": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'db417cee-529c-4eac-b7b9-36eb0166800a')]",
      "analyticRuleTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('db417cee-529c-4eac-b7b9-36eb0166800a')))]",
      "_analyticRulecontentProductId3": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','db417cee-529c-4eac-b7b9-36eb0166800a','-', '1.0.0')))]"
    },
    "analyticRuleObject4": {
      "analyticRuleVersion4": "1.0.0",
      "_analyticRulecontentId4": "33B07EAA-F451-4C38-AC9F-8AF3F7E99F0E",
      "analyticRuleId4": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '33B07EAA-F451-4C38-AC9F-8AF3F7E99F0E')]",
      "analyticRuleTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('33B07EAA-F451-4C38-AC9F-8AF3F7E99F0E')))]",
      "_analyticRulecontentProductId4": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','33B07EAA-F451-4C38-AC9F-8AF3F7E99F0E','-', '1.0.0')))]"
    },
    "analyticRuleObject5": {
      "analyticRuleVersion5": "1.0.0",
      "_analyticRulecontentId5": "0f6a8287-09ee-4f82-b8c3-e35c4ac6212e",
      "analyticRuleId5": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '0f6a8287-09ee-4f82-b8c3-e35c4ac6212e')]",
      "analyticRuleTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('0f6a8287-09ee-4f82-b8c3-e35c4ac6212e')))]",
      "_analyticRulecontentProductId5": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','0f6a8287-09ee-4f82-b8c3-e35c4ac6212e','-', '1.0.0')))]"
    },
    "analyticRuleObject6": {
      "analyticRuleVersion6": "1.0.0",
      "_analyticRulecontentId6": "b78c4641-cc16-48e0-9d05-c9b36a55d214",
      "analyticRuleId6": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'b78c4641-cc16-48e0-9d05-c9b36a55d214')]",
      "analyticRuleTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('b78c4641-cc16-48e0-9d05-c9b36a55d214')))]",
      "_analyticRulecontentProductId6": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','b78c4641-cc16-48e0-9d05-c9b36a55d214','-', '1.0.0')))]"
    },
    "analyticRuleObject7": {
      "analyticRuleVersion7": "1.0.0",
      "_analyticRulecontentId7": "588a2ee5-978a-43f7-9c10-6d76d82026ef",
      "analyticRuleId7": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '588a2ee5-978a-43f7-9c10-6d76d82026ef')]",
      "analyticRuleTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('588a2ee5-978a-43f7-9c10-6d76d82026ef')))]",
      "_analyticRulecontentProductId7": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','588a2ee5-978a-43f7-9c10-6d76d82026ef','-', '1.0.0')))]"
    },
    "analyticRuleObject8": {
      "analyticRuleVersion8": "1.0.0",
      "_analyticRulecontentId8": "e80eedb4-cbae-45cc-b1be-a2a8dc31af3b",
      "analyticRuleId8": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'e80eedb4-cbae-45cc-b1be-a2a8dc31af3b')]",
      "analyticRuleTemplateSpecName8": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('e80eedb4-cbae-45cc-b1be-a2a8dc31af3b')))]",
      "_analyticRulecontentProductId8": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','e80eedb4-cbae-45cc-b1be-a2a8dc31af3b','-', '1.0.0')))]"
    },
    "analyticRuleObject9": {
      "analyticRuleVersion9": "1.0.0",
      "_analyticRulecontentId9": "6deaf986-a25b-47b4-afbe-667901aa313b",
      "analyticRuleId9": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '6deaf986-a25b-47b4-afbe-667901aa313b')]",
      "analyticRuleTemplateSpecName9": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('6deaf986-a25b-47b4-afbe-667901aa313b')))]",
      "_analyticRulecontentProductId9": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','6deaf986-a25b-47b4-afbe-667901aa313b','-', '1.0.0')))]"
    },
    "analyticRuleObject10": {
      "analyticRuleVersion10": "1.0.0",
      "_analyticRulecontentId10": "91a00e4f-3edb-49e9-ba6f-cec87a5bd2f8",
      "analyticRuleId10": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '91a00e4f-3edb-49e9-ba6f-cec87a5bd2f8')]",
      "analyticRuleTemplateSpecName10": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('91a00e4f-3edb-49e9-ba6f-cec87a5bd2f8')))]",
      "_analyticRulecontentProductId10": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','91a00e4f-3edb-49e9-ba6f-cec87a5bd2f8','-', '1.0.0')))]"
    },
    "analyticRuleObject11": {
      "analyticRuleVersion11": "1.0.0",
      "_analyticRulecontentId11": "754dbb50-8dc2-4b8b-86d8-a890a020ddc3",
      "analyticRuleId11": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '754dbb50-8dc2-4b8b-86d8-a890a020ddc3')]",
      "analyticRuleTemplateSpecName11": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('754dbb50-8dc2-4b8b-86d8-a890a020ddc3')))]",
      "_analyticRulecontentProductId11": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','754dbb50-8dc2-4b8b-86d8-a890a020ddc3','-', '1.0.0')))]"
    },
    "analyticRuleObject12": {
      "analyticRuleVersion12": "1.0.0",
      "_analyticRulecontentId12": "1dabe566-a0f1-4c27-8307-aea5a79eb5e9",
      "analyticRuleId12": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '1dabe566-a0f1-4c27-8307-aea5a79eb5e9')]",
      "analyticRuleTemplateSpecName12": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('1dabe566-a0f1-4c27-8307-aea5a79eb5e9')))]",
      "_analyticRulecontentProductId12": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','1dabe566-a0f1-4c27-8307-aea5a79eb5e9','-', '1.0.0')))]"
    },
    "analyticRuleObject13": {
      "analyticRuleVersion13": "1.0.0",
      "_analyticRulecontentId13": "601a5859-0dc2-452d-8d1e-66dc651c16d5",
      "analyticRuleId13": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '601a5859-0dc2-452d-8d1e-66dc651c16d5')]",
      "analyticRuleTemplateSpecName13": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('601a5859-0dc2-452d-8d1e-66dc651c16d5')))]",
      "_analyticRulecontentProductId13": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','601a5859-0dc2-452d-8d1e-66dc651c16d5','-', '1.0.0')))]"
    },
    "analyticRuleObject14": {
      "analyticRuleVersion14": "1.0.0",
      "_analyticRulecontentId14": "47dee28d-fa74-49cd-b5fb-397b047a73c0",
      "analyticRuleId14": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '47dee28d-fa74-49cd-b5fb-397b047a73c0')]",
      "analyticRuleTemplateSpecName14": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('47dee28d-fa74-49cd-b5fb-397b047a73c0')))]",
      "_analyticRulecontentProductId14": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','47dee28d-fa74-49cd-b5fb-397b047a73c0','-', '1.0.0')))]"
    },
    "analyticRuleObject15": {
      "analyticRuleVersion15": "1.0.0",
      "_analyticRulecontentId15": "81404e99-ce27-45aa-aa19-a276a3d4c645",
      "analyticRuleId15": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '81404e99-ce27-45aa-aa19-a276a3d4c645')]",
      "analyticRuleTemplateSpecName15": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('81404e99-ce27-45aa-aa19-a276a3d4c645')))]",
      "_analyticRulecontentProductId15": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','81404e99-ce27-45aa-aa19-a276a3d4c645','-', '1.0.0')))]"
    },
    "analyticRuleObject16": {
      "analyticRuleVersion16": "1.0.0",
      "_analyticRulecontentId16": "0a54dc90-9a9d-4300-af21-feb5136e81da",
      "analyticRuleId16": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '0a54dc90-9a9d-4300-af21-feb5136e81da')]",
      "analyticRuleTemplateSpecName16": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('0a54dc90-9a9d-4300-af21-feb5136e81da')))]",
      "_analyticRulecontentProductId16": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','0a54dc90-9a9d-4300-af21-feb5136e81da','-', '1.0.0')))]"
    },
    "analyticRuleObject17": {
      "analyticRuleVersion17": "1.0.0",
      "_analyticRulecontentId17": "2c86652a-bbbe-4a32-8b1c-4b53aad0750e",
      "analyticRuleId17": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '2c86652a-bbbe-4a32-8b1c-4b53aad0750e')]",
      "analyticRuleTemplateSpecName17": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('2c86652a-bbbe-4a32-8b1c-4b53aad0750e')))]",
      "_analyticRulecontentProductId17": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','2c86652a-bbbe-4a32-8b1c-4b53aad0750e','-', '1.0.0')))]"
    },
    "analyticRuleObject18": {
      "analyticRuleVersion18": "1.0.0",
      "_analyticRulecontentId18": "117e8f7c-8f44-4061-bcc2-b444b98a3838",
      "analyticRuleId18": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '117e8f7c-8f44-4061-bcc2-b444b98a3838')]",
      "analyticRuleTemplateSpecName18": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('117e8f7c-8f44-4061-bcc2-b444b98a3838')))]",
      "_analyticRulecontentProductId18": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','117e8f7c-8f44-4061-bcc2-b444b98a3838','-', '1.0.0')))]"
    },
    "analyticRuleObject19": {
      "analyticRuleVersion19": "1.0.0",
      "_analyticRulecontentId19": "6649e5a0-0365-452f-84b3-448a0aec7a59",
      "analyticRuleId19": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '6649e5a0-0365-452f-84b3-448a0aec7a59')]",
      "analyticRuleTemplateSpecName19": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('6649e5a0-0365-452f-84b3-448a0aec7a59')))]",
      "_analyticRulecontentProductId19": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','6649e5a0-0365-452f-84b3-448a0aec7a59','-', '1.0.0')))]"
    },
    "analyticRuleObject20": {
      "analyticRuleVersion20": "1.0.0",
      "_analyticRulecontentId20": "d1cdfb8d-12cd-4a29-8caf-ef4a35ad67ed",
      "analyticRuleId20": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd1cdfb8d-12cd-4a29-8caf-ef4a35ad67ed')]",
      "analyticRuleTemplateSpecName20": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d1cdfb8d-12cd-4a29-8caf-ef4a35ad67ed')))]",
      "_analyticRulecontentProductId20": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d1cdfb8d-12cd-4a29-8caf-ef4a35ad67ed','-', '1.0.0')))]"
    },
    "analyticRuleObject21": {
      "analyticRuleVersion21": "1.0.0",
      "_analyticRulecontentId21": "c8cf42d5-8684-435f-9c4d-9dd0cc47eaec",
      "analyticRuleId21": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c8cf42d5-8684-435f-9c4d-9dd0cc47eaec')]",
      "analyticRuleTemplateSpecName21": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c8cf42d5-8684-435f-9c4d-9dd0cc47eaec')))]",
      "_analyticRulecontentProductId21": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c8cf42d5-8684-435f-9c4d-9dd0cc47eaec','-', '1.0.0')))]"
    },
    "analyticRuleObject22": {
      "analyticRuleVersion22": "1.0.0",
      "_analyticRulecontentId22": "1e7c8d9f-1d42-42b3-b6ce-12a637e05f16",
      "analyticRuleId22": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '1e7c8d9f-1d42-42b3-b6ce-12a637e05f16')]",
      "analyticRuleTemplateSpecName22": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('1e7c8d9f-1d42-42b3-b6ce-12a637e05f16')))]",
      "_analyticRulecontentProductId22": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','1e7c8d9f-1d42-42b3-b6ce-12a637e05f16','-', '1.0.0')))]"
    },
    "analyticRuleObject23": {
      "analyticRuleVersion23": "1.0.0",
      "_analyticRulecontentId23": "224a63ae-e278-4a11-b7c2-02ec3e17b56c",
      "analyticRuleId23": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '224a63ae-e278-4a11-b7c2-02ec3e17b56c')]",
      "analyticRuleTemplateSpecName23": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('224a63ae-e278-4a11-b7c2-02ec3e17b56c')))]",
      "_analyticRulecontentProductId23": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','224a63ae-e278-4a11-b7c2-02ec3e17b56c','-', '1.0.0')))]"
    },
    "analyticRuleObject24": {
      "analyticRuleVersion24": "1.0.0",
      "_analyticRulecontentId24": "cf0a9691-5716-42e0-bfa1-49b35d3a7892",
      "analyticRuleId24": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'cf0a9691-5716-42e0-bfa1-49b35d3a7892')]",
      "analyticRuleTemplateSpecName24": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('cf0a9691-5716-42e0-bfa1-49b35d3a7892')))]",
      "_analyticRulecontentProductId24": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','cf0a9691-5716-42e0-bfa1-49b35d3a7892','-', '1.0.0')))]"
    },
    "analyticRuleObject25": {
      "analyticRuleVersion25": "1.0.0",
      "_analyticRulecontentId25": "6d55fefc-b334-4b79-b11c-667746b5bdde",
      "analyticRuleId25": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '6d55fefc-b334-4b79-b11c-667746b5bdde')]",
      "analyticRuleTemplateSpecName25": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('6d55fefc-b334-4b79-b11c-667746b5bdde')))]",
      "_analyticRulecontentProductId25": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','6d55fefc-b334-4b79-b11c-667746b5bdde','-', '1.0.0')))]"
    },
    "analyticRuleObject26": {
      "analyticRuleVersion26": "1.0.0",
      "_analyticRulecontentId26": "e52f36dd-7d4f-4aa8-a095-3b6fa2b28b8d",
      "analyticRuleId26": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'e52f36dd-7d4f-4aa8-a095-3b6fa2b28b8d')]",
      "analyticRuleTemplateSpecName26": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('e52f36dd-7d4f-4aa8-a095-3b6fa2b28b8d')))]",
      "_analyticRulecontentProductId26": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','e52f36dd-7d4f-4aa8-a095-3b6fa2b28b8d','-', '1.0.0')))]"
    },
    "analyticRuleObject27": {
      "analyticRuleVersion27": "1.0.0",
      "_analyticRulecontentId27": "d205a93f-b2e3-4708-a359-5e0c88ee3e59",
      "analyticRuleId27": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'd205a93f-b2e3-4708-a359-5e0c88ee3e59')]",
      "analyticRuleTemplateSpecName27": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('d205a93f-b2e3-4708-a359-5e0c88ee3e59')))]",
      "_analyticRulecontentProductId27": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','d205a93f-b2e3-4708-a359-5e0c88ee3e59','-', '1.0.0')))]"
    },
    "analyticRuleObject28": {
      "analyticRuleVersion28": "1.0.0",
      "_analyticRulecontentId28": "9ff985d8-57a8-4302-a8e6-34fa96c3c505",
      "analyticRuleId28": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '9ff985d8-57a8-4302-a8e6-34fa96c3c505')]",
      "analyticRuleTemplateSpecName28": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('9ff985d8-57a8-4302-a8e6-34fa96c3c505')))]",
      "_analyticRulecontentProductId28": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','9ff985d8-57a8-4302-a8e6-34fa96c3c505','-', '1.0.0')))]"
    },
    "analyticRuleObject29": {
      "analyticRuleVersion29": "1.0.0",
      "_analyticRulecontentId29": "c1ebc79d-7f46-429e-bf2c-8bb0b75ba6b2",
      "analyticRuleId29": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c1ebc79d-7f46-429e-bf2c-8bb0b75ba6b2')]",
      "analyticRuleTemplateSpecName29": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c1ebc79d-7f46-429e-bf2c-8bb0b75ba6b2')))]",
      "_analyticRulecontentProductId29": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c1ebc79d-7f46-429e-bf2c-8bb0b75ba6b2','-', '1.0.0')))]"
    },
    "analyticRuleObject30": {
      "analyticRuleVersion30": "1.0.0",
      "_analyticRulecontentId30": "dd37e041-3973-482a-aa8c-f484b4178940",
      "analyticRuleId30": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'dd37e041-3973-482a-aa8c-f484b4178940')]",
      "analyticRuleTemplateSpecName30": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('dd37e041-3973-482a-aa8c-f484b4178940')))]",
      "_analyticRulecontentProductId30": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','dd37e041-3973-482a-aa8c-f484b4178940','-', '1.0.0')))]"
    },
    "analyticRuleObject31": {
      "analyticRuleVersion31": "1.0.0",
      "_analyticRulecontentId31": "eb1d45fe-1b19-4b54-b146-971f282a6fd9",
      "analyticRuleId31": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'eb1d45fe-1b19-4b54-b146-971f282a6fd9')]",
      "analyticRuleTemplateSpecName31": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('eb1d45fe-1b19-4b54-b146-971f282a6fd9')))]",
      "_analyticRulecontentProductId31": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','eb1d45fe-1b19-4b54-b146-971f282a6fd9','-', '1.0.0')))]"
    },
    "analyticRuleObject32": {
      "analyticRuleVersion32": "1.0.0",
      "_analyticRulecontentId32": "88db8505-1889-46aa-a4e2-4e866262dcb9",
      "analyticRuleId32": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '88db8505-1889-46aa-a4e2-4e866262dcb9')]",
      "analyticRuleTemplateSpecName32": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('88db8505-1889-46aa-a4e2-4e866262dcb9')))]",
      "_analyticRulecontentProductId32": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','88db8505-1889-46aa-a4e2-4e866262dcb9','-', '1.0.0')))]"
    },
    "analyticRuleObject33": {
      "analyticRuleVersion33": "1.0.0",
      "_analyticRulecontentId33": "99ca8956-5aad-4542-9fbc-8254182b424d",
      "analyticRuleId33": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '99ca8956-5aad-4542-9fbc-8254182b424d')]",
      "analyticRuleTemplateSpecName33": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('99ca8956-5aad-4542-9fbc-8254182b424d')))]",
      "_analyticRulecontentProductId33": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','99ca8956-5aad-4542-9fbc-8254182b424d','-', '1.0.0')))]"
    },
    "analyticRuleObject34": {
      "analyticRuleVersion34": "1.0.0",
      "_analyticRulecontentId34": "c360341e-6ba6-472a-ae00-7be85967e240",
      "analyticRuleId34": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c360341e-6ba6-472a-ae00-7be85967e240')]",
      "analyticRuleTemplateSpecName34": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c360341e-6ba6-472a-ae00-7be85967e240')))]",
      "_analyticRulecontentProductId34": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c360341e-6ba6-472a-ae00-7be85967e240','-', '1.0.0')))]"
    },
    "analyticRuleObject35": {
      "analyticRuleVersion35": "1.0.0",
      "_analyticRulecontentId35": "231c2c16-3742-4cfb-a8e1-c1a7d09f080a",
      "analyticRuleId35": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '231c2c16-3742-4cfb-a8e1-c1a7d09f080a')]",
      "analyticRuleTemplateSpecName35": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('231c2c16-3742-4cfb-a8e1-c1a7d09f080a')))]",
      "_analyticRulecontentProductId35": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','231c2c16-3742-4cfb-a8e1-c1a7d09f080a','-', '1.0.0')))]"
    },
    "analyticRuleObject36": {
      "analyticRuleVersion36": "1.0.0",
      "_analyticRulecontentId36": "A667D635-D2A7-47E7-8827-8FB243AF2AFD",
      "analyticRuleId36": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'A667D635-D2A7-47E7-8827-8FB243AF2AFD')]",
      "analyticRuleTemplateSpecName36": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('A667D635-D2A7-47E7-8827-8FB243AF2AFD')))]",
      "_analyticRulecontentProductId36": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','A667D635-D2A7-47E7-8827-8FB243AF2AFD','-', '1.0.0')))]"
    },
    "analyticRuleObject37": {
      "analyticRuleVersion37": "1.0.0",
      "_analyticRulecontentId37": "e0bf55c2-35ef-47ab-8846-5087618ae805",
      "analyticRuleId37": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'e0bf55c2-35ef-47ab-8846-5087618ae805')]",
      "analyticRuleTemplateSpecName37": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('e0bf55c2-35ef-47ab-8846-5087618ae805')))]",
      "_analyticRulecontentProductId37": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','e0bf55c2-35ef-47ab-8846-5087618ae805','-', '1.0.0')))]"
    },
    "analyticRuleObject38": {
      "analyticRuleVersion38": "1.0.0",
      "_analyticRulecontentId38": "7a0f79cc-8d28-44b5-ac1e-6176565bb7b8",
      "analyticRuleId38": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '7a0f79cc-8d28-44b5-ac1e-6176565bb7b8')]",
      "analyticRuleTemplateSpecName38": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('7a0f79cc-8d28-44b5-ac1e-6176565bb7b8')))]",
      "_analyticRulecontentProductId38": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','7a0f79cc-8d28-44b5-ac1e-6176565bb7b8','-', '1.0.0')))]"
    },
    "analyticRuleObject39": {
      "analyticRuleVersion39": "1.0.0",
      "_analyticRulecontentId39": "c56fcb78-b708-4a92-bad4-d50b1e15c42c",
      "analyticRuleId39": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'c56fcb78-b708-4a92-bad4-d50b1e15c42c')]",
      "analyticRuleTemplateSpecName39": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('c56fcb78-b708-4a92-bad4-d50b1e15c42c')))]",
      "_analyticRulecontentProductId39": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','c56fcb78-b708-4a92-bad4-d50b1e15c42c','-', '1.0.0')))]"
    },
    "analyticRuleObject40": {
      "analyticRuleVersion40": "1.0.0",
      "_analyticRulecontentId40": "4238f545-8b6f-4f7c-80b5-14cca2cebc99",
      "analyticRuleId40": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '4238f545-8b6f-4f7c-80b5-14cca2cebc99')]",
      "analyticRuleTemplateSpecName40": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('4238f545-8b6f-4f7c-80b5-14cca2cebc99')))]",
      "_analyticRulecontentProductId40": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','4238f545-8b6f-4f7c-80b5-14cca2cebc99','-', '1.0.0')))]"
    },
    "analyticRuleObject41": {
      "analyticRuleVersion41": "1.0.0",
      "_analyticRulecontentId41": "b9df1ec4-a572-4448-8da1-1bc4b7e1687f",
      "analyticRuleId41": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'b9df1ec4-a572-4448-8da1-1bc4b7e1687f')]",
      "analyticRuleTemplateSpecName41": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('b9df1ec4-a572-4448-8da1-1bc4b7e1687f')))]",
      "_analyticRulecontentProductId41": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','b9df1ec4-a572-4448-8da1-1bc4b7e1687f','-', '1.0.0')))]"
    },
    "analyticRuleObject42": {
      "analyticRuleVersion42": "1.0.0",
      "_analyticRulecontentId42": "0e0cdda9-4536-4cc9-91cf-736e8957ed26",
      "analyticRuleId42": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '0e0cdda9-4536-4cc9-91cf-736e8957ed26')]",
      "analyticRuleTemplateSpecName42": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('0e0cdda9-4536-4cc9-91cf-736e8957ed26')))]",
      "_analyticRulecontentProductId42": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','0e0cdda9-4536-4cc9-91cf-736e8957ed26','-', '1.0.0')))]"
    },
    "analyticRuleObject43": {
      "analyticRuleVersion43": "1.0.0",
      "_analyticRulecontentId43": "359ddb25-eab1-4ef5-8303-ed3a9b680690",
      "analyticRuleId43": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '359ddb25-eab1-4ef5-8303-ed3a9b680690')]",
      "analyticRuleTemplateSpecName43": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('359ddb25-eab1-4ef5-8303-ed3a9b680690')))]",
      "_analyticRulecontentProductId43": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','359ddb25-eab1-4ef5-8303-ed3a9b680690','-', '1.0.0')))]"
    },
    "parserObject1": {
      "_parserName1": "[concat(parameters('workspace'),'/','Alerts_advisory')]",
      "_parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_advisory')]",
      "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_advisory-Parser')))]",
      "parserVersion1": "1.0.0",
      "parserContentId1": "Alerts_advisory-Parser"
    },
    "parserObject2": {
      "_parserName2": "[concat(parameters('workspace'),'/','Alerts_assets')]",
      "_parserId2": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_assets')]",
      "parserTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_assets-Parser')))]",
      "parserVersion2": "1.0.0",
      "parserContentId2": "Alerts_assets-Parser"
    },
    "parserObject3": {
      "_parserName3": "[concat(parameters('workspace'),'/','Alerts_bit_bucket')]",
      "_parserId3": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_bit_bucket')]",
      "parserTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_bit_bucket-Parser')))]",
      "parserVersion3": "1.0.0",
      "parserContentId3": "Alerts_bit_bucket-Parser"
    },
    "parserObject4": {
      "_parserName4": "[concat(parameters('workspace'),'/','Alerts_cloud_storage')]",
      "_parserId4": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_cloud_storage')]",
      "parserTemplateSpecName4": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_cloud_storage-Parser')))]",
      "parserVersion4": "1.0.0",
      "parserContentId4": "Alerts_cloud_storage-Parser"
    },
    "parserObject5": {
      "_parserName5": "[concat(parameters('workspace'),'/','Alerts_compromised_endpoints_cookies')]",
      "_parserId5": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_compromised_endpoints_cookies')]",
      "parserTemplateSpecName5": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_compromised_endpoints_cookies-Parser')))]",
      "parserVersion5": "1.0.0",
      "parserContentId5": "Alerts_compromised_endpoints_cookies-Parser"
    },
    "parserObject6": {
      "_parserName6": "[concat(parameters('workspace'),'/','Alerts_compromised_files')]",
      "_parserId6": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_compromised_files')]",
      "parserTemplateSpecName6": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_compromised_files-Parser')))]",
      "parserVersion6": "1.0.0",
      "parserContentId6": "Alerts_compromised_files-Parser"
    },
    "parserObject7": {
      "_parserName7": "[concat(parameters('workspace'),'/','Alerts_cyber_crime_forums')]",
      "_parserId7": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_cyber_crime_forums')]",
      "parserTemplateSpecName7": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_cyber_crime_forums-Parser')))]",
      "parserVersion7": "1.0.0",
      "parserContentId7": "Alerts_cyber_crime_forums-Parser"
    },
    "parserObject8": {
      "_parserName8": "[concat(parameters('workspace'),'/','Alerts_darkweb_data_breaches')]",
      "_parserId8": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_data_breaches')]",
      "parserTemplateSpecName8": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_darkweb_data_breaches-Parser')))]",
      "parserVersion8": "1.0.0",
      "parserContentId8": "Alerts_darkweb_data_breaches-Parser"
    },
    "parserObject9": {
      "_parserName9": "[concat(parameters('workspace'),'/','Alerts_darkweb_marketplaces')]",
      "_parserId9": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_marketplaces')]",
      "parserTemplateSpecName9": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_darkweb_marketplaces-Parser')))]",
      "parserVersion9": "1.0.0",
      "parserContentId9": "Alerts_darkweb_marketplaces-Parser"
    },
    "parserObject10": {
      "_parserName10": "[concat(parameters('workspace'),'/','Alerts_darkweb_ransomware')]",
      "_parserId10": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_ransomware')]",
      "parserTemplateSpecName10": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_darkweb_ransomware-Parser')))]",
      "parserVersion10": "1.0.0",
      "parserContentId10": "Alerts_darkweb_ransomware-Parser"
    },
    "parserObject11": {
      "_parserName11": "[concat(parameters('workspace'),'/','Alerts_defacement_content')]",
      "_parserId11": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_content')]",
      "parserTemplateSpecName11": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_defacement_content-Parser')))]",
      "parserVersion11": "1.0.0",
      "parserContentId11": "Alerts_defacement_content-Parser"
    },
    "parserObject12": {
      "_parserName12": "[concat(parameters('workspace'),'/','Alerts_defacement_keyword')]",
      "_parserId12": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_keyword')]",
      "parserTemplateSpecName12": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_defacement_keyword-Parser')))]",
      "parserVersion12": "1.0.0",
      "parserContentId12": "Alerts_defacement_keyword-Parser"
    },
    "parserObject13": {
      "_parserName13": "[concat(parameters('workspace'),'/','Alerts_defacement_url')]",
      "_parserId13": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_url')]",
      "parserTemplateSpecName13": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_defacement_url-Parser')))]",
      "parserVersion13": "1.0.0",
      "parserContentId13": "Alerts_defacement_url-Parser"
    },
    "parserObject14": {
      "_parserName14": "[concat(parameters('workspace'),'/','Alerts_discord')]",
      "_parserId14": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_discord')]",
      "parserTemplateSpecName14": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_discord-Parser')))]",
      "parserVersion14": "1.0.0",
      "parserContentId14": "Alerts_discord-Parser"
    },
    "parserObject15": {
      "_parserName15": "[concat(parameters('workspace'),'/','Alerts_docker')]",
      "_parserId15": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_docker')]",
      "parserTemplateSpecName15": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_docker-Parser')))]",
      "parserVersion15": "1.0.0",
      "parserContentId15": "Alerts_docker-Parser"
    },
    "parserObject16": {
      "_parserName16": "[concat(parameters('workspace'),'/','Alerts_domain_expiry')]",
      "_parserId16": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_domain_expiry')]",
      "parserTemplateSpecName16": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_domain_expiry-Parser')))]",
      "parserVersion16": "1.0.0",
      "parserContentId16": "Alerts_domain_expiry-Parser"
    },
    "parserObject17": {
      "_parserName17": "[concat(parameters('workspace'),'/','Alerts_domain_watchlist')]",
      "_parserId17": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_domain_watchlist')]",
      "parserTemplateSpecName17": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_domain_watchlist-Parser')))]",
      "parserVersion17": "1.0.0",
      "parserContentId17": "Alerts_domain_watchlist-Parser"
    },
    "parserObject18": {
      "_parserName18": "[concat(parameters('workspace'),'/','Alerts_flash_report')]",
      "_parserId18": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_flash_report')]",
      "parserTemplateSpecName18": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_flash_report-Parser')))]",
      "parserVersion18": "1.0.0",
      "parserContentId18": "Alerts_flash_report-Parser"
    },
    "parserObject19": {
      "_parserName19": "[concat(parameters('workspace'),'/','Alerts_github')]",
      "_parserId19": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_github')]",
      "parserTemplateSpecName19": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_github-Parser')))]",
      "parserVersion19": "1.0.0",
      "parserContentId19": "Alerts_github-Parser"
    },
    "parserObject20": {
      "_parserName20": "[concat(parameters('workspace'),'/','Alerts_hacktivism')]",
      "_parserId20": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_hacktivism')]",
      "parserTemplateSpecName20": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_hacktivism-Parser')))]",
      "parserVersion20": "1.0.0",
      "parserContentId20": "Alerts_hacktivism-Parser"
    },
    "parserObject21": {
      "_parserName21": "[concat(parameters('workspace'),'/','Alerts_i2p')]",
      "_parserId21": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_i2p')]",
      "parserTemplateSpecName21": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_i2p-Parser')))]",
      "parserVersion21": "1.0.0",
      "parserContentId21": "Alerts_i2p-Parser"
    },
    "parserObject22": {
      "_parserName22": "[concat(parameters('workspace'),'/','Alerts_iocs')]",
      "_parserId22": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_iocs')]",
      "parserTemplateSpecName22": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_iocs-Parser')))]",
      "parserVersion22": "1.0.0",
      "parserContentId22": "Alerts_iocs-Parser"
    },
    "parserObject23": {
      "_parserName23": "[concat(parameters('workspace'),'/','Alerts_ip_risk_score')]",
      "_parserId23": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ip_risk_score')]",
      "parserTemplateSpecName23": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_ip_risk_score-Parser')))]",
      "parserVersion23": "1.0.0",
      "parserContentId23": "Alerts_ip_risk_score-Parser"
    },
    "parserObject24": {
      "_parserName24": "[concat(parameters('workspace'),'/','Alerts_leaked_credentials')]",
      "_parserId24": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_leaked_credentials')]",
      "parserTemplateSpecName24": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_leaked_credentials-Parser')))]",
      "parserVersion24": "1.0.0",
      "parserContentId24": "Alerts_leaked_credentials-Parser"
    },
    "parserObject25": {
      "_parserName25": "[concat(parameters('workspace'),'/','Alerts_malicious_ads')]",
      "_parserId25": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_malicious_ads')]",
      "parserTemplateSpecName25": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_malicious_ads-Parser')))]",
      "parserVersion25": "1.0.0",
      "parserContentId25": "Alerts_malicious_ads-Parser"
    },
    "parserObject26": {
      "_parserName26": "[concat(parameters('workspace'),'/','Alerts_mobile_apps')]",
      "_parserId26": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_mobile_apps')]",
      "parserTemplateSpecName26": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_mobile_apps-Parser')))]",
      "parserVersion26": "1.0.0",
      "parserContentId26": "Alerts_mobile_apps-Parser"
    },
    "parserObject27": {
      "_parserName27": "[concat(parameters('workspace'),'/','Alerts_new_vulnerability')]",
      "_parserId27": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_new_vulnerability')]",
      "parserTemplateSpecName27": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_new_vulnerability-Parser')))]",
      "parserVersion27": "1.0.0",
      "parserContentId27": "Alerts_new_vulnerability-Parser"
    },
    "parserObject28": {
      "_parserName28": "[concat(parameters('workspace'),'/','Alerts_news_feed')]",
      "_parserId28": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_news_feed')]",
      "parserTemplateSpecName28": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_news_feed-Parser')))]",
      "parserVersion28": "1.0.0",
      "parserContentId28": "Alerts_news_feed-Parser"
    },
    "parserObject29": {
      "_parserName29": "[concat(parameters('workspace'),'/','Alerts_osint')]",
      "_parserId29": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_osint')]",
      "parserTemplateSpecName29": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_osint-Parser')))]",
      "parserVersion29": "1.0.0",
      "parserContentId29": "Alerts_osint-Parser"
    },
    "parserObject30": {
      "_parserName30": "[concat(parameters('workspace'),'/','Alerts_ot_ics')]",
      "_parserId30": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ot_ics')]",
      "parserTemplateSpecName30": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_ot_ics-Parser')))]",
      "parserVersion30": "1.0.0",
      "parserContentId30": "Alerts_ot_ics-Parser"
    },
    "parserObject31": {
      "_parserName31": "[concat(parameters('workspace'),'/','Alerts_pastebin')]",
      "_parserId31": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_pastebin')]",
      "parserTemplateSpecName31": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_pastebin-Parser')))]",
      "parserVersion31": "1.0.0",
      "parserContentId31": "Alerts_pastebin-Parser"
    },
    "parserObject32": {
      "_parserName32": "[concat(parameters('workspace'),'/','Alerts_phishing')]",
      "_parserId32": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_phishing')]",
      "parserTemplateSpecName32": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_phishing-Parser')))]",
      "parserVersion32": "1.0.0",
      "parserContentId32": "Alerts_phishing-Parser"
    },
    "parserObject33": {
      "_parserName33": "[concat(parameters('workspace'),'/','Alerts_physical_threats')]",
      "_parserId33": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_physical_threats')]",
      "parserTemplateSpecName33": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_physical_threats-Parser')))]",
      "parserVersion33": "1.0.0",
      "parserContentId33": "Alerts_physical_threats-Parser"
    },
    "parserObject34": {
      "_parserName34": "[concat(parameters('workspace'),'/','Alerts_postman')]",
      "_parserId34": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_postman')]",
      "parserTemplateSpecName34": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_postman-Parser')))]",
      "parserVersion34": "1.0.0",
      "parserContentId34": "Alerts_postman-Parser"
    },
    "parserObject35": {
      "_parserName35": "[concat(parameters('workspace'),'/','Alerts_product_vulnerability')]",
      "_parserId35": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_product_vulnerability')]",
      "parserTemplateSpecName35": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_product_vulnerability-Parser')))]",
      "parserVersion35": "1.0.0",
      "parserContentId35": "Alerts_product_vulnerability-Parser"
    },
    "parserObject36": {
      "_parserName36": "[concat(parameters('workspace'),'/','Alerts_ransomware_updates')]",
      "_parserId36": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ransomware_updates')]",
      "parserTemplateSpecName36": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_ransomware_updates-Parser')))]",
      "parserVersion36": "1.0.0",
      "parserContentId36": "Alerts_ransomware_updates-Parser"
    },
    "parserObject37": {
      "_parserName37": "[concat(parameters('workspace'),'/','Alerts_social_media_monitoring')]",
      "_parserId37": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_social_media_monitoring')]",
      "parserTemplateSpecName37": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_social_media_monitoring-Parser')))]",
      "parserVersion37": "1.0.0",
      "parserContentId37": "Alerts_social_media_monitoring-Parser"
    },
    "parserObject38": {
      "_parserName38": "[concat(parameters('workspace'),'/','Alerts_ssl_expiry')]",
      "_parserId38": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ssl_expiry')]",
      "parserTemplateSpecName38": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_ssl_expiry-Parser')))]",
      "parserVersion38": "1.0.0",
      "parserContentId38": "Alerts_ssl_expiry-Parser"
    },
    "parserObject39": {
      "_parserName39": "[concat(parameters('workspace'),'/','Alerts_stealer_logs')]",
      "_parserId39": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_stealer_logs')]",
      "parserTemplateSpecName39": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_stealer_logs-Parser')))]",
      "parserVersion39": "1.0.0",
      "parserContentId39": "Alerts_stealer_logs-Parser"
    },
    "parserObject40": {
      "_parserName40": "[concat(parameters('workspace'),'/','Alerts_subdomains')]",
      "_parserId40": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_subdomains')]",
      "parserTemplateSpecName40": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_subdomains-Parser')))]",
      "parserVersion40": "1.0.0",
      "parserContentId40": "Alerts_subdomains-Parser"
    },
    "parserObject41": {
      "_parserName41": "[concat(parameters('workspace'),'/','Alerts_suspicious_domains')]",
      "_parserId41": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_suspicious_domains')]",
      "parserTemplateSpecName41": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_suspicious_domains-Parser')))]",
      "parserVersion41": "1.0.0",
      "parserContentId41": "Alerts_suspicious_domains-Parser"
    },
    "parserObject42": {
      "_parserName42": "[concat(parameters('workspace'),'/','Alerts_telegram_mentions')]",
      "_parserId42": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_telegram_mentions')]",
      "parserTemplateSpecName42": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_telegram_mentions-Parser')))]",
      "parserVersion42": "1.0.0",
      "parserContentId42": "Alerts_telegram_mentions-Parser"
    },
    "parserObject43": {
      "_parserName43": "[concat(parameters('workspace'),'/','Alerts_tor_links')]",
      "_parserId43": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_tor_links')]",
      "parserTemplateSpecName43": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_tor_links-Parser')))]",
      "parserVersion43": "1.0.0",
      "parserContentId43": "Alerts_tor_links-Parser"
    },
    "parserObject44": {
      "_parserName44": "[concat(parameters('workspace'),'/','Alerts_vulnerability')]",
      "_parserId44": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_vulnerability')]",
      "parserTemplateSpecName44": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_vulnerability-Parser')))]",
      "parserVersion44": "1.0.0",
      "parserContentId44": "Alerts_vulnerability-Parser"
    },
    "parserObject45": {
      "_parserName45": "[concat(parameters('workspace'),'/','Alerts_web_applications')]",
      "_parserId45": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_web_applications')]",
      "parserTemplateSpecName45": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('Alerts_web_applications-Parser')))]",
      "parserVersion45": "1.0.0",
      "parserContentId45": "Alerts_web_applications-Parser"
    },
    "IoC-Enrichment": "IoC-Enrichment",
    "_IoC-Enrichment": "[variables('IoC-Enrichment')]",
    "TemplateEmptyArray": "[json('[]')]",
    "playbookVersion1": "1.0",
    "playbookContentId1": "IoC-Enrichment",
    "_playbookContentId1": "[variables('playbookContentId1')]",
    "playbookId1": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId1'))]",
    "playbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId1'))))]",
    "_playbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId1'),'-', variables('playbookVersion1'))))]",
    "TI-Ingest": "TI-Ingest",
    "_TI-Ingest": "[variables('TI-Ingest')]",
    "playbookVersion2": "1.0",
    "playbookContentId2": "TI-Ingest",
    "_playbookContentId2": "[variables('playbookContentId2')]",
    "playbookId2": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId2'))]",
    "playbookTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId2'))))]",
    "_playbookcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId2'),'-', variables('playbookVersion2'))))]",
    "CybleVisionAlert_Status_Update": "CybleVisionAlert_Status_Update",
    "_CybleVisionAlert_Status_Update": "[variables('CybleVisionAlert_Status_Update')]",
    "playbookVersion3": "1.0",
    "playbookContentId3": "CybleVisionAlert_Status_Update",
    "_playbookContentId3": "[variables('playbookContentId3')]",
    "playbookId3": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId3'))]",
    "playbookTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId3'))))]",
    "_playbookcontentProductId3": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId3'),'-', variables('playbookVersion3'))))]",
    "workbookVersion1": "1.0.1",
    "workbookContentId1": "CybleVisionAlertsWorkbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "displayName": "Cyble Vision Alerts",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "title": "Cyble Vision Alerts",
                  "publisher": "Cyble",
                  "id": "CybleVisionAlerts",
                  "descriptionMarkdown": "The **Cyble Vision Alerts** CCF Data Connector enables Ingestion of Threat Alerts from Cyble Vision into Microsoft Sentinel using the Codeless Connector Framework Connector. It collects alert data via API, normalizes it, and stores it in a custom table for advanced detection, correlation, and response.",
                  "graphQueriesTableName": "CybleVisionAlerts_CL",
                  "graphQueries": [
                    {
                      "metricName": "Total Alerts received",
                      "legend": "Alerts",
                      "baseQuery": "{{graphQueriesTableName}}"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Get Sample of Cyble Vision Alerts",
                      "query": "{{graphQueriesTableName}}\n | take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CybleVisionAlerts_CL",
                      "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Cyble Vision API token",
                        "description": "An API Token from Cyble Vision Platform is required."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "Step 1 - Generating API Token from Cyble Platform",
                      "description": "Navigate to [Cyble Platform](https://cyble.ai/utilities/access-apis) and log in using your Cyble Vision credentials.\n\nOnce logged in, go to the left-hand panel and scroll down to **Utilities**. Click on **Access APIs**. On the top-right corner of the page, click the **+ (Add)** icon to generate a new API key. Provide an alias (a friendly name for your key) and click **Generate**. Copy the generated API token and store it securely."
                    },
                    {
                      "title": "STEP 2 - Configure the Data Connector",
                      "description": "Return to Microsoft Sentinel and open the **Cyble Vision Alerts** data connector configuration page. Paste your Cyble API Token into the **API Token** field under 'API Details'.",
                      "instructions": [
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "API Token",
                            "placeholder": "Enter your API Token",
                            "type": "password",
                            "name": "ApiToken"
                          }
                        },
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "Query Interval (in minutes)",
                            "placeholder": "Enter Time in Minutes (e.g., 10)",
                            "type": "Textbox",
                            "name": "querywindow"
                          }
                        },
                        {
                          "type": "ConnectionToggleButton",
                          "parameters": {
                            "connectLabel": "Connect",
                            "name": "toggle"
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "CybleVisionAlertsDCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId1')]",
                "streamDeclarations": {
                  "Custom-CybleVisionAlerts_CL": {
                    "columns": [
                      {
                        "name": "created_at",
                        "type": "datetime"
                      },
                      {
                        "name": "updated_at",
                        "type": "datetime"
                      },
                      {
                        "name": "deleted_at",
                        "type": "string"
                      },
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "data_id",
                        "type": "string"
                      },
                      {
                        "name": "entity_id",
                        "type": "int"
                      },
                      {
                        "name": "keyword_name",
                        "type": "string"
                      },
                      {
                        "name": "entity_type",
                        "type": "int"
                      },
                      {
                        "name": "service",
                        "type": "string"
                      },
                      {
                        "name": "company_id",
                        "type": "int"
                      },
                      {
                        "name": "description",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "assignee_id",
                        "type": "string"
                      },
                      {
                        "name": "assignment_date",
                        "type": "string"
                      },
                      {
                        "name": "archive_date",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "updated_by_id",
                        "type": "string"
                      },
                      {
                        "name": "created_by",
                        "type": "string"
                      },
                      {
                        "name": "user_severity",
                        "type": "string"
                      },
                      {
                        "name": "bucket_id",
                        "type": "int"
                      },
                      {
                        "name": "asset",
                        "type": "string"
                      },
                      {
                        "name": "last_detected_at",
                        "type": "string"
                      },
                      {
                        "name": "filename",
                        "type": "string"
                      },
                      {
                        "name": "repository_name",
                        "type": "string"
                      },
                      {
                        "name": "owner_name",
                        "type": "string"
                      },
                      {
                        "name": "extension",
                        "type": "string"
                      },
                      {
                        "name": "compromised_date",
                        "type": "string"
                      },
                      {
                        "name": "article_name",
                        "type": "string"
                      },
                      {
                        "name": "breach_source",
                        "type": "string"
                      },
                      {
                        "name": "breach_date",
                        "type": "string"
                      },
                      {
                        "name": "channel_name",
                        "type": "string"
                      },
                      {
                        "name": "server_name",
                        "type": "string"
                      },
                      {
                        "name": "content_updated_on",
                        "type": "string"
                      },
                      {
                        "name": "discussion_date",
                        "type": "string"
                      },
                      {
                        "name": "discussion_by",
                        "type": "string"
                      },
                      {
                        "name": "source_name",
                        "type": "string"
                      },
                      {
                        "name": "topic_name",
                        "type": "string"
                      },
                      {
                        "name": "source",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "content_added_on",
                        "type": "string"
                      },
                      {
                        "name": "ioc",
                        "type": "string"
                      },
                      {
                        "name": "first_seen_on",
                        "type": "string"
                      },
                      {
                        "name": "last_seen_on",
                        "type": "string"
                      },
                      {
                        "name": "old_risk_score",
                        "type": "string"
                      },
                      {
                        "name": "new_risk_score",
                        "type": "string"
                      },
                      {
                        "name": "ip",
                        "type": "dynamic"
                      },
                      {
                        "name": "host",
                        "type": "string"
                      },
                      {
                        "name": "port",
                        "type": "int"
                      },
                      {
                        "name": "application_name",
                        "type": "string"
                      },
                      {
                        "name": "market_source",
                        "type": "string"
                      },
                      {
                        "name": "uploaded_at",
                        "type": "string"
                      },
                      {
                        "name": "cve",
                        "type": "string"
                      },
                      {
                        "name": "subdomain",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "chat_title",
                        "type": "string"
                      },
                      {
                        "name": "username",
                        "type": "string"
                      },
                      {
                        "name": "search_engine",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "sentiment",
                        "type": "string"
                      },
                      {
                        "name": "name",
                        "type": "string"
                      },
                      {
                        "name": "true_positive",
                        "type": "boolean"
                      },
                      {
                        "name": "llm_processed",
                        "type": "boolean"
                      },
                      {
                        "name": "llm_explanation",
                        "type": "string"
                      },
                      {
                        "name": "bucket_name",
                        "type": "string"
                      },
                      {
                        "name": "tags",
                        "type": "dynamic"
                      },
                      {
                        "name": "risk_score",
                        "type": "dynamic"
                      },
                      {
                        "name": "marketplace",
                        "type": "string"
                      },
                      {
                        "name": "stealer",
                        "type": "string"
                      },
                      {
                        "name": "data",
                        "type": "dynamic"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-CybleVisionAlerts_CL"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = now(), Created_At = todatetime(created_at), Updated_At = todatetime(updated_at), Deleted_At = deleted_at, DataID = data_id, EntityID = entity_id, KeywordName = keyword_name, EntityType = entity_type, Service = service, CompanyID = company_id, Description = description, Status = status, AssigneeID = assignee_id, AssignmentDate = assignment_date, ArchiveDate = archive_date, Severity = severity, UpdatedBy = updated_by_id, CreatedBy = created_by, UserSeverity = user_severity, BucketID = bucket_id, Filename = filename, RepositoryName = repository_name, OwnerName = owner_name, BucketName = bucket_name, TruePositive = true_positive, LLMProcessed = llm_processed, LLMExplanation = llm_explanation, Tags = tags, ID = id, Asset = asset, Last_Detected_At = last_detected_at, Extension = extension, Compromised_Date = compromised_date, Article_Name = article_name, Breach_Source = breach_source, Breach_Date = breach_date, Channel_Name = channel_name, Server_Name = server_name, Content_Updated_On = content_updated_on, Discussion_Date = discussion_date, Discussion_By = discussion_by, Source_Name = source_name, Topic_Name = topic_name, Source = source, Alert_Type = type, Content_Added_On = content_added_on, IOC = ioc, First_Seen_On = first_seen_on, Last_Seen_On = last_seen_on, Old_Risk_Score = old_risk_score, New_Risk_Score = new_risk_score, IP = ip, Host = host, Port = port, Application_Name = application_name, Market_Source = market_source, Uploaded_At = uploaded_at, CVE = cve, Subdomain = subdomain, Domain = domain, Chat_Title = chat_title, Username = username, Search_Engine = search_engine, Category = category, Sentiment = sentiment, Name = name, RiskScore_s = tostring(risk_score.s), RiskScore_e = tostring(risk_score.e), RiskScore_c = tostring(risk_score.c), Data = tostring(data), Marketplace = tostring(marketplace), Stealer = tostring(stealer)",
                    "outputStream": "Custom-CybleVisionAlerts_CL"
                  }
                ]
              }
            },
            {
              "name": "CybleVisionAlerts_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CybleVisionAlerts_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "Created_At",
                      "type": "datetime"
                    },
                    {
                      "name": "Updated_At",
                      "type": "datetime"
                    },
                    {
                      "name": "Deleted_At",
                      "type": "string"
                    },
                    {
                      "name": "DataID",
                      "type": "string"
                    },
                    {
                      "name": "EntityID",
                      "type": "int"
                    },
                    {
                      "name": "KeywordName",
                      "type": "string"
                    },
                    {
                      "name": "EntityType",
                      "type": "int"
                    },
                    {
                      "name": "Service",
                      "type": "string"
                    },
                    {
                      "name": "CompanyID",
                      "type": "int"
                    },
                    {
                      "name": "Description",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "AssigneeID",
                      "type": "string"
                    },
                    {
                      "name": "AssignmentDate",
                      "type": "string"
                    },
                    {
                      "name": "ArchiveDate",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "UpdatedBy",
                      "type": "string"
                    },
                    {
                      "name": "CreatedBy",
                      "type": "string"
                    },
                    {
                      "name": "UserSeverity",
                      "type": "string"
                    },
                    {
                      "name": "BucketID",
                      "type": "int"
                    },
                    {
                      "name": "Filename",
                      "type": "string"
                    },
                    {
                      "name": "RepositoryName",
                      "type": "string"
                    },
                    {
                      "name": "OwnerName",
                      "type": "string"
                    },
                    {
                      "name": "BucketName",
                      "type": "string"
                    },
                    {
                      "name": "TruePositive",
                      "type": "boolean"
                    },
                    {
                      "name": "LLMProcessed",
                      "type": "boolean"
                    },
                    {
                      "name": "LLMExplanation",
                      "type": "string"
                    },
                    {
                      "name": "Tags",
                      "type": "dynamic"
                    },
                    {
                      "name": "ID",
                      "type": "string"
                    },
                    {
                      "name": "Asset",
                      "type": "string"
                    },
                    {
                      "name": "Last_Detected_At",
                      "type": "string"
                    },
                    {
                      "name": "Extension",
                      "type": "string"
                    },
                    {
                      "name": "Compromised_Date",
                      "type": "string"
                    },
                    {
                      "name": "Article_Name",
                      "type": "string"
                    },
                    {
                      "name": "Breach_Source",
                      "type": "string"
                    },
                    {
                      "name": "Breach_Date",
                      "type": "string"
                    },
                    {
                      "name": "Channel_Name",
                      "type": "string"
                    },
                    {
                      "name": "Server_Name",
                      "type": "string"
                    },
                    {
                      "name": "Content_Updated_On",
                      "type": "string"
                    },
                    {
                      "name": "Discussion_Date",
                      "type": "string"
                    },
                    {
                      "name": "Discussion_By",
                      "type": "string"
                    },
                    {
                      "name": "Source_Name",
                      "type": "string"
                    },
                    {
                      "name": "Topic_Name",
                      "type": "string"
                    },
                    {
                      "name": "Source",
                      "type": "string"
                    },
                    {
                      "name": "Alert_Type",
                      "type": "string"
                    },
                    {
                      "name": "Content_Added_On",
                      "type": "string"
                    },
                    {
                      "name": "IOC",
                      "type": "string"
                    },
                    {
                      "name": "First_Seen_On",
                      "type": "string"
                    },
                    {
                      "name": "Last_Seen_On",
                      "type": "string"
                    },
                    {
                      "name": "Old_Risk_Score",
                      "type": "string"
                    },
                    {
                      "name": "New_Risk_Score",
                      "type": "string"
                    },
                    {
                      "name": "IP",
                      "type": "dynamic"
                    },
                    {
                      "name": "Host",
                      "type": "string"
                    },
                    {
                      "name": "Port",
                      "type": "int"
                    },
                    {
                      "name": "Application_Name",
                      "type": "string"
                    },
                    {
                      "name": "Market_Source",
                      "type": "string"
                    },
                    {
                      "name": "Uploaded_At",
                      "type": "string"
                    },
                    {
                      "name": "CVE",
                      "type": "string"
                    },
                    {
                      "name": "Subdomain",
                      "type": "string"
                    },
                    {
                      "name": "Domain",
                      "type": "string"
                    },
                    {
                      "name": "Chat_Title",
                      "type": "string"
                    },
                    {
                      "name": "Username",
                      "type": "string"
                    },
                    {
                      "name": "Search_Engine",
                      "type": "string"
                    },
                    {
                      "name": "Category",
                      "type": "string"
                    },
                    {
                      "name": "Sentiment",
                      "type": "string"
                    },
                    {
                      "name": "Name",
                      "type": "string"
                    },
                    {
                      "name": "RiskScore_s",
                      "type": "String"
                    },
                    {
                      "name": "RiskScore_e",
                      "type": "String"
                    },
                    {
                      "name": "RiskScore_c",
                      "type": "String"
                    },
                    {
                      "name": "Marketplace",
                      "type": "String"
                    },
                    {
                      "name": "Stealer",
                      "type": "String"
                    },
                    {
                      "name": "Data",
                      "type": "String"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "title": "Cyble Vision Alerts",
          "publisher": "Cyble",
          "id": "CybleVisionAlerts",
          "descriptionMarkdown": "The **Cyble Vision Alerts** CCF Data Connector enables Ingestion of Threat Alerts from Cyble Vision into Microsoft Sentinel using the Codeless Connector Framework Connector. It collects alert data via API, normalizes it, and stores it in a custom table for advanced detection, correlation, and response.",
          "graphQueriesTableName": "CybleVisionAlerts_CL",
          "graphQueries": [
            {
              "metricName": "Total Alerts received",
              "legend": "Alerts",
              "baseQuery": "{{graphQueriesTableName}}"
            }
          ],
          "sampleQueries": [
            {
              "description": "Get Sample of Cyble Vision Alerts",
              "query": "{{graphQueriesTableName}}\n | take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "CybleVisionAlerts_CL",
              "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              }
            ],
            "customs": [
              {
                "name": "Cyble Vision API token",
                "description": "An API Token from Cyble Vision Platform is required."
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Step 1 - Generating API Token from Cyble Platform",
              "description": "Navigate to [Cyble Platform](https://cyble.ai/utilities/access-apis) and log in using your Cyble Vision credentials.\n\nOnce logged in, go to the left-hand panel and scroll down to **Utilities**. Click on **Access APIs**. On the top-right corner of the page, click the **+ (Add)** icon to generate a new API key. Provide an alias (a friendly name for your key) and click **Generate**. Copy the generated API token and store it securely."
            },
            {
              "title": "STEP 2 - Configure the Data Connector",
              "description": "Return to Microsoft Sentinel and open the **Cyble Vision Alerts** data connector configuration page. Paste your Cyble API Token into the **API Token** field under 'API Details'.",
              "instructions": [
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "API Token",
                    "placeholder": "Enter your API Token",
                    "type": "password",
                    "name": "ApiToken"
                  }
                },
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "Query Interval (in minutes)",
                    "placeholder": "Enter Time in Minutes (e.g., 10)",
                    "type": "Textbox",
                    "name": "querywindow"
                  }
                },
                {
                  "type": "ConnectionToggleButton",
                  "parameters": {
                    "connectLabel": "Connect",
                    "name": "toggle"
                  }
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
        "displayName": "Cyble Vision Alerts",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "connectorDefinitionName": {
              "defaultValue": "Cyble Vision Alerts",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "ApiToken": {
              "defaultValue": "ApiToken",
              "type": "securestring",
              "minLength": 1
            },
            "querywindow": {
              "defaultValue": "querywindow",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections1": "[variables('_dataConnectorContentIdConnections1')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CybleVisionPoller', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "CybleVisionAlerts",
                "dataType": "CybleVisionAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-CybleVisionAlerts_CL",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKey": "[[parameters('ApiToken')]",
                  "ApiKeyName": "Authorization",
                  "ApiKeyIdentifier": "Bearer"
                },
                "request": {
                  "apiEndpoint": "https://bifrost.cyble.ai/ar-apollo-v2/api/v2/y/alerts",
                  "httpMethod": "POST",
                  "queryWindowInMin": "[[parameters('querywindow')]",
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "rateLimitQps": 1,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Content-Type": "application/json",
                    "Accept": "application/json"
                  },
                  "isPostPayloadJson": true,
                  "queryParametersTemplate": "{ \"orderBy\": [ { \"created_at\": \"desc\" }, { \"updated_at\": \"desc\" } ], \"filters\": { \"updated_at\": { \"gte\": \"2025-12-05T04:55:32.000Z\", \"lte\": \"2025-12-09T04:55:32.000Z\" }, \"user_severity\": [ \"LOW\", \"MEDIUM\", \"HIGH\" ] }, \"excludes\": { \"status\": [ \"FALSE_POSITIVE\" ] }, \"skip\": 0, \"take\": 10,\"countOnly\": false, \"taggedAlert\": false, \"withDataMessage\": true }"
                },
                "response": {
                  "format": "json",
                  "eventsJsonPaths": [
                    "$.data.*"
                  ]
                },
                "paging": {
                  "pagingType": "Offset",
                  "pageSizeParameterName": "take",
                  "pageSize": 10,
                  "offsetParaName": "skip"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Assets_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Scheduled rule that creates incidents for asset alerts using saved parser Alerts_assets. Mandatory custom details: MappedSeverity, Status, AlertID, Service.",
                "displayName": "Cyble Vision Alerts Assets",
                "enabled": false,
                "query": "Alerts_assets\n| where Service == \"assets\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1592"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "AA_Value",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "AA_Value",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "AA_LastDetected": "AA_LastDetected",
                  "Status": "Status",
                  "Service": "Service",
                  "AA_KeywordID": "AA_KeywordID",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "AA_Value": "AA_Value"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Assets",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_BitBucket_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects exposed secrets in Bitbucket repositories using the Alerts_bit_bucket parser. Creates one incident per matched secret. Includes decoder, detector, commit, file, and repository context for SOC triage.",
                "displayName": "Cyble Vision Alerts Bitbucket",
                "enabled": false,
                "query": "Alerts_bit_bucket \n| where Service == \"bit_bucket\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "CredentialAccess",
                  "Exfiltration",
                  "Discovery"
                ],
                "techniques": [
                  "T1552",
                  "T1537",
                  "T1083"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "BB_Repository",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "BB_Link",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "BB_File",
                        "identifier": "Name"
                      },
                      {
                        "columnName": "KeywordName",
                        "identifier": "Directory"
                      }
                    ],
                    "entityType": "File"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "BB_Email": "BB_Email",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "BB_RotationGuide": "BB_RotationGuide",
                  "MappedSeverity": "Severity",
                  "BB_Verified": "BB_Verified",
                  "Status": "Status",
                  "BB_Repository": "BB_Repository",
                  "BB_Link": "BB_Link",
                  "BB_DetectorName": "BB_DetectorName",
                  "BB_Line": "BB_Line",
                  "BB_File": "BB_File",
                  "BB_Raw": "BB_Raw",
                  "BB_Commit": "BB_Commit"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A sensitive secret was detected in Bitbucket repository {{BB_Repository}}. File {{BB_File}}:{{BB_Line}}. Investigator should verify exposure, rotate credentials and remediate impacted systems.\n",
                  "alertDisplayNameFormat": "Secret Exposure in Bitbucket {{BB_File}} ({{BB_DetectorName}})"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Bitbucket",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject3').analyticRuleTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Cloud_Storage_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject3').analyticRuleVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects cloud storage objects/paths discovered in ingestion (uses Alerts_cloud_storage parser). Creates incidents for discovered S3/GCS/Azure blob objects, includes bucket/object/url, size and workflow metadata. Mandatory custom details: MappedSeverity, Status, AlertID, Service.",
                "displayName": "Cyble Vision Alerts Cloud Storage",
                "enabled": false,
                "query": "Alerts_cloud_storage  \n| where Service == \"cloud_storage\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Exfiltration",
                  "Discovery"
                ],
                "techniques": [
                  "T1537",
                  "T1083"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CS_Url",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CS_Bucket",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "CS_BucketId": "CS_BucketId",
                  "CS_FullPath": "CS_FullPath",
                  "CS_Url": "CS_Url",
                  "CS_Size": "CS_Size",
                  "Status": "Status",
                  "CS_ObjectId": "CS_ObjectId",
                  "CS_AgenticAIStatus": "CS_AgenticAIStatus",
                  "CS_WorkflowID": "CS_WorkflowID",
                  "CS_Bucket": "CS_Bucket",
                  "ProcessedByAgenticAI": "CS_ProcessedByAgenticAI",
                  "CS_Filename": "CS_Filename",
                  "MappedSeverity": "Severity"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A cloud storage object was discovered by ingestion. (ID {{CS_BucketId}}). Object {{CS_FullPath}} (ID {{CS_ObjectId}}). Review and remediate access if required.\n",
                  "alertDisplayNameFormat": "Exposed cloud object  {{CS_Filename}} in {{CS_Bucket}}."
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject3').analyticRuleId3,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 3",
                "parentId": "[variables('analyticRuleObject3').analyticRuleId3]",
                "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject3').analyticRuleVersion3]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Cloud Storage",
        "contentProductId": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "id": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject4').analyticRuleTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Compromised_Endpoints_Cookies_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject4').analyticRuleVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects compromised browser cookies associated with monitored entities. Identifies exposed authentication cookies with future expiry, enabling potential session hijacking or persistent unauthorized access.",
                "displayName": "Cyble Vision Alerts Compromised Endpoint Cookies",
                "enabled": false,
                "query": "Alerts_compromised_endpoints_cookies\n| where Service == \"compromised_endpoints_cookies\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "CredentialAccess",
                  "DefenseEvasion"
                ],
                "techniques": [
                  "T1539",
                  "T1550"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CEC_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CEC_Email",
                        "identifier": "FullName"
                      }
                    ],
                    "entityType": "Account"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "CookieURL": "CEC_URL",
                  "CookieDomain": "CEC_EmailDomain",
                  "Status": "Status",
                  "Service": "Service",
                  "CookieEmail": "CEC_Email",
                  "CookieSessionID": "CEC_SessionID",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "CookieExpiry": "CEC_Expiry"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A compromised browser session cookie associated with {{CEC_EmailDomain}} was detected for service {{CEC_URL}}. The cookie has not expired and may allow session hijacking. Session ID {{CEC_SessionID}}.\n",
                  "alertDisplayNameFormat": "Compromised Session Cookie {{CEC_Email}} {{CEC_URL}}"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject4').analyticRuleId4,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 4",
                "parentId": "[variables('analyticRuleObject4').analyticRuleId4]",
                "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject4').analyticRuleVersion4]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Compromised Endpoint Cookies",
        "contentProductId": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "id": "[variables('analyticRuleObject4')._analyticRulecontentProductId4]",
        "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject5').analyticRuleTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Compromised_Files_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject5').analyticRuleVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects compromised files containing credential or logon data (stealer logs) related to monitored entities. Uses Alerts_compromised_files parser to expose file paths, log objects, and extracted email identifiers.",
                "displayName": "Cyble Vision Alerts Compromised Files",
                "enabled": false,
                "query": "Alerts_compromised_files  \n| where Service == \"compromised_files\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "CredentialAccess",
                  "Exfiltration"
                ],
                "techniques": [
                  "T1552",
                  "T1041"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CF_PrimaryEmail",
                        "identifier": "FullName"
                      }
                    ],
                    "entityType": "Account"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "CF_FileObjPath": "CF_FileObjPath",
                  "Status": "Status",
                  "Service": "Service",
                  "CF_PrimaryEmail": "CF_PrimaryEmail",
                  "CF_Filename": "CF_Filename",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "CF_LogObjPath": "CF_LogObjPath"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A compromised file containing potential credential or logon data was discovered. Relative path {{CF_RelativePath}}. Log object path {{CF_LogObjPath}}. Primary email (if found) {{CF_PrimaryEmail}}.\n",
                  "alertDisplayNameFormat": "Compromised Credentials File {{CF_Filename}}"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject5').analyticRuleId5,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 5",
                "parentId": "[variables('analyticRuleObject5').analyticRuleId5]",
                "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject5').analyticRuleVersion5]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Compromised Files",
        "contentProductId": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "id": "[variables('analyticRuleObject5')._analyticRulecontentProductId5]",
        "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject6').analyticRuleTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Cyber_Crime_Forum_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject6').analyticRuleVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects discussions, marketplace posts, threat actor activity, and intelligence mentions from cybercrime forums. Extracts discussion metadata, topic details, URLs, emails, phone numbers, and content using Alerts_CyberCrimeForums parser.",
                "displayName": "CybleVision Alerts Cyber Crime Forum Alerts",
                "enabled": false,
                "query": "Alerts_cyber_crime_forums \n| where Service == \"cyber_crime_forums\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "ResourceDevelopment",
                  "Exfiltration"
                ],
                "techniques": [
                  "T1598",
                  "T1585",
                  "T1589",
                  "T1646"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CF_Emails",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CF_Urls",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "CF_SourceName",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DiscussionDate": "CF_DiscussionDate",
                  "Likes": "CF_Likes",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "TopicID": "CF_TopicID",
                  "TopicURL": "CF_TopicURL",
                  "MappedSeverity": "Severity",
                  "TopicCreatedBy": "CF_TopicCreatedBy",
                  "DiscussionBy": "CF_DiscussionBy",
                  "Tags": "CF_Tags",
                  "Reputation": "CF_Reputation",
                  "Phones": "CF_Phones",
                  "Content": "CF_Content",
                  "Status": "Status",
                  "TopicName": "CF_TopicName"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Forum Mention {{CF_TopicName}}",
                  "alertDescriptionFormat": "A mention was detected on a cybercrime forum. Source {{CF_SourceName}} By {{CF_DiscussionBy}} Content {{CF_Content}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject6').analyticRuleId6,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 6",
                "parentId": "[variables('analyticRuleObject6').analyticRuleId6]",
                "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject6').analyticRuleVersion6]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
        "contentKind": "AnalyticsRule",
        "displayName": "CybleVision Alerts Cyber Crime Forum Alerts",
        "contentProductId": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "id": "[variables('analyticRuleObject6')._analyticRulecontentProductId6]",
        "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject7').analyticRuleTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Darkweb_Data_Breaches_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject7').analyticRuleVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects darkweb credential leakage and data breach records from CybleVision. Extracts leaked username, email, password hashes, registration dates, and metadata using the Alerts_DarkwebDataBreaches parser. Incidents grouped per service.",
                "displayName": "Cyble Vision Alerts Darkweb Data Breaches",
                "enabled": false,
                "query": "Alerts_darkweb_data_breaches \n| where Service == \"darkweb_data_breaches\" \n| extend  MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "InitialAccess",
                  "Exfiltration",
                  "Collection"
                ],
                "techniques": [
                  "T1589",
                  "T1078",
                  "T1048",
                  "T1530"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DB_Username",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DB_Email",
                        "identifier": "MailboxPrimaryAddress"
                      }
                    ],
                    "entityType": "Mailbox"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "BreachSource": "Breach_Source",
                  "S3Key": "DB_S3Key",
                  "AlertID": "AlertID",
                  "RegistrationDate": "DB_RegistrationDate",
                  "Service": "Service",
                  "Structured": "DB_Structured",
                  "MappedSeverity": "Severity",
                  "PasswordHash": "DB_PasswordHash",
                  "LeakedEmail": "DB_Email",
                  "Tags": "DB_Tags",
                  "DisplayName": "DB_DisplayName",
                  "BreachDate": "DB_Date",
                  "UserName": "DB_Username",
                  "Status": "Status"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Darkweb Breach for {{DB_Email}}",
                  "alertDescriptionFormat": "Username {{DB_Username}} Registration date {{DB_RegistrationDate}} Breach source {{Breach_Source}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject7').analyticRuleId7,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 7",
                "parentId": "[variables('analyticRuleObject7').analyticRuleId7]",
                "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject7').analyticRuleVersion7]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Darkweb Data Breaches",
        "contentProductId": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "id": "[variables('analyticRuleObject7')._analyticRulecontentProductId7]",
        "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject8').analyticRuleTemplateSpecName8]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Darkweb_Marketplace_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject8').analyticRuleVersion8]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects stolen credentials, financial information, stealer logs, and related payloads listed on Darkweb marketplaces such as RussianMarket. Extracts card data, victim info, metadata, and marketplace context via Alerts_DarkwebMarketplaces.",
                "displayName": "CybleVision Alerts Darkweb Marketplace Alerts",
                "enabled": false,
                "query": "Alerts_darkweb_marketplaces \n| where Service == \"darkweb_marketplaces\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "CredentialAccess",
                  "Collection",
                  "Exfiltration",
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1555",
                  "T1005",
                  "T1041",
                  "T1589",
                  "T1646"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DW_Links",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DW_Bank_BIN",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "File"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DW_IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "RawData": "DW_RawData",
                  "Marketplace": "DW_Marketplace",
                  "AlertID": "AlertID",
                  "Info": "DW_Info",
                  "Service": "Service",
                  "BankBrand": "DW_Bank_Brand",
                  "Date": "DW_Date",
                  "MappedSeverity": "Severity",
                  "Stealer": "DW_StealerName",
                  "Region": "DW_Region",
                  "RealName": "DW_Bank_RealName",
                  "Tags": "DW_Tags",
                  "BankExpiry": "DW_Bank_Expiry",
                  "Links": "DW_Links",
                  "Price": "DW_Price",
                  "UpdatedDate": "DW_UpdatedDate",
                  "Vendor": "DW_Vendor",
                  "Status": "Status",
                  "BankCard": "DW_Bank_CardNo",
                  "Country": "DW_Country"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Darkweb Listing Found ({{DW_Marketplace}})",
                  "alertDescriptionFormat": "A darkweb marketplace listing referencing your monitored assets was discovered. Vendor {{DW_Vendor}} Region {{DW_Region}} Links {{DW_Links}}\\n\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject8').analyticRuleId8,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 8",
                "parentId": "[variables('analyticRuleObject8').analyticRuleId8]",
                "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject8').analyticRuleVersion8]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
        "contentKind": "AnalyticsRule",
        "displayName": "CybleVision Alerts Darkweb Marketplace Alerts",
        "contentProductId": "[variables('analyticRuleObject8')._analyticRulecontentProductId8]",
        "id": "[variables('analyticRuleObject8')._analyticRulecontentProductId8]",
        "version": "[variables('analyticRuleObject8').analyticRuleVersion8]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject9').analyticRuleTemplateSpecName9]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_darkweb_ransomware_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject9').analyticRuleVersion9]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "A ransomware threat actor has posted victim data on the dark web. This alert includes leaked documents, threat actor name, victim organization, timestamps, and extracted text content for SOC triage.",
                "displayName": "Cyble Vision Alerts Darkweb Ransomware Leak",
                "enabled": false,
                "query": "Alerts_darkweb_ransomware\n| where Service == \"darkweb_ransomware\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Impact",
                  "Exfiltration",
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1486",
                  "T1657"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DW_Victim_Nested",
                        "identifier": "Name"
                      },
                      {
                        "columnName": "DW_ThreatActor_Nested",
                        "identifier": "FullName"
                      }
                    ],
                    "entityType": "Account"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "UpdatedDate": "DW_UpdatedDate_Nested",
                  "CompanyLeak": "DW_CompanyLeak",
                  "ContentText": "DW_Text",
                  "Status": "Status",
                  "Victim": "DW_Victim_Nested",
                  "ThreatActor": "DW_ThreatActor_Nested",
                  "FileName": "DW_FileName",
                  "Service": "Service",
                  "DocumentYear": "DW_DocumentYear",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "OriginalFileName": "DW_OriginalFileName"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A ransomware group has posted data belonging on the dark web. A document leak has been detected, including text extracted from the file.\n**Victim:** {{Victim}}\n**Threat Actor:** {{ThreatActor}}\n**Leaked File:** {{FileName}}\n",
                  "alertDisplayNameFormat": "Darkweb Ransomware Leak {{Victim}} by {{ThreatActor}}"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject9').analyticRuleId9,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 9",
                "parentId": "[variables('analyticRuleObject9').analyticRuleId9]",
                "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject9').analyticRuleVersion9]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Darkweb Ransomware Leak",
        "contentProductId": "[variables('analyticRuleObject9')._analyticRulecontentProductId9]",
        "id": "[variables('analyticRuleObject9')._analyticRulecontentProductId9]",
        "version": "[variables('analyticRuleObject9').analyticRuleVersion9]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject10').analyticRuleTemplateSpecName10]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Defacement_Content_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject10').analyticRuleVersion10]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when monitored websites show new or suspicious content referencing known defacement patterns. Supports investigation into potential web compromise incidents.",
                "displayName": "Cyble Vision Alerts Website Defacement Content",
                "enabled": false,
                "query": "Alerts_defacement_content  \n| where Service == \"defacement_content\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Impact"
                ],
                "techniques": [
                  "T1491"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DC_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DC_DomainName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DC_URL": "DC_URL",
                  "Status": "Status",
                  "DC_DomainName": "DC_DomainName",
                  "Service": "Service",
                  "DC_RecordID": "DC_RecordID",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DC_Keywords": "DC_Keywords"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Defacement Activity Detected {{DC_DomainName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "New or modified content was detected on website {{DC_DomainName}}. URL {{DC_URL}}. This may indicate unauthorized website updates or defacement activity.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject10').analyticRuleId10,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 10",
                "parentId": "[variables('analyticRuleObject10').analyticRuleId10]",
                "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject10').analyticRuleVersion10]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Website Defacement Content",
        "contentProductId": "[variables('analyticRuleObject10')._analyticRulecontentProductId10]",
        "id": "[variables('analyticRuleObject10')._analyticRulecontentProductId10]",
        "version": "[variables('analyticRuleObject10').analyticRuleVersion10]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject11').analyticRuleTemplateSpecName11]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_defacement_keyword_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject11').analyticRuleVersion11]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when monitored defacement keywords appear on a website, indicating potential early signs of website compromise or defacement-related activity.",
                "displayName": "Cyble Vision Alerts Website Defacement Keyword",
                "enabled": false,
                "query": "Alerts_defacement_keyword  \n| where Service == \"defacement_keyword\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Impact",
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1491",
                  "T1598"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DK_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DK_DomainName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DK_URL": "DK_URL",
                  "Status": "Status",
                  "DK_Keyword": "DK_Keyword",
                  "DK_DomainName": "DK_DomainName",
                  "Service": "Service",
                  "DK_RecordID": "DK_RecordID",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DK_Frequency": "DK_Frequency"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Defacement Keyword Detected {{DK_Keyword}} on {{DK_DomainName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A defacement-related keyword was observed on the website. URL {{DK_URL}}. Frequency count {{DK_Frequency}}. This may indicate early-stage defacement activity.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject11').analyticRuleId11,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 11",
                "parentId": "[variables('analyticRuleObject11').analyticRuleId11]",
                "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject11').analyticRuleVersion11]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Website Defacement Keyword",
        "contentProductId": "[variables('analyticRuleObject11')._analyticRulecontentProductId11]",
        "id": "[variables('analyticRuleObject11')._analyticRulecontentProductId11]",
        "version": "[variables('analyticRuleObject11').analyticRuleVersion11]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject12').analyticRuleTemplateSpecName12]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_defacement_url_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject12').analyticRuleVersion12]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects suspicious or unexpected changes to monitored URLs which may indicate website tampering or defacement.",
                "displayName": "Cyble Vision Alerts Website Defacement URL",
                "enabled": false,
                "query": "Alerts_defacement_url  \n| where Service == \"defacement_url\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Impact"
                ],
                "techniques": [
                  "T1491"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DU_Description",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DU_DomainName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DU_Keywords": "DU_Keywords",
                  "Status": "Status",
                  "DU_RecordID": "DU_RecordID",
                  "DU_description": "DU_Description",
                  "Service": "Service",
                  "DU_Type": "DU_Type",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DU_DomainName": "DU_DomainName"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "URL Content Change Detected {{DU_DomainName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A monitored URL for domain {{DU_DomainName}} has changed {{DU_Description}}. This may indicate unauthorized modification consistent with website defacement activity.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject12').analyticRuleId12,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 12",
                "parentId": "[variables('analyticRuleObject12').analyticRuleId12]",
                "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject12').analyticRuleVersion12]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Website Defacement URL",
        "contentProductId": "[variables('analyticRuleObject12')._analyticRulecontentProductId12]",
        "id": "[variables('analyticRuleObject12')._analyticRulecontentProductId12]",
        "version": "[variables('analyticRuleObject12').analyticRuleVersion12]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject13').analyticRuleTemplateSpecName13]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_discord_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject13').analyticRuleVersion13]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when monitored keywords or risky content appear in Discord channels. Useful for detecting data leakage, impersonation, abuse or reputational threats originating from social platforms.",
                "displayName": "Cyble Vision Alerts Discord Keyword",
                "enabled": false,
                "query": "Alerts_discord  \n| where Service == \"discord\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "InitialAccess"
                ],
                "techniques": [
                  "T1598",
                  "T1664"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DC_AuthorID",
                        "identifier": "AadUserId"
                      },
                      {
                        "columnName": "DC_AuthorUsername",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DC_ServerName",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "CloudApplication"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DC_MessageID": "DC_MessageID",
                  "Status": "Status",
                  "Service": "Service",
                  "DC_Content": "DC_Content",
                  "DC_ServerName": "DC_ServerName",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DC_ChannelName": "DC_ChannelName",
                  "DC_AuthorUsername": "DC_AuthorUsername"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Discord Alert Risky Content by {{DC_AuthorUsername}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A monitored keyword or harmful content was detected in Discord.\n**Server:** {{DC_ServerName}}\n**Channel:** {{DC_ChannelName}}\n**Message:** {{DC_Content}}\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject13').analyticRuleId13,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 13",
                "parentId": "[variables('analyticRuleObject13').analyticRuleId13]",
                "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject13').analyticRuleVersion13]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Discord Keyword",
        "contentProductId": "[variables('analyticRuleObject13')._analyticRulecontentProductId13]",
        "id": "[variables('analyticRuleObject13')._analyticRulecontentProductId13]",
        "version": "[variables('analyticRuleObject13').analyticRuleVersion13]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject14').analyticRuleTemplateSpecName14]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Docker_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject14').analyticRuleVersion14]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects Docker Hub container entries related to monitored keywords. Uses Alerts_docker parser. Includes metadata such as developer, stars, downloads, and image URL. Raises one incident per alert.",
                "displayName": "Cyble Vision Alerts Docker",
                "enabled": false,
                "query": "Alerts_docker  \n| where Service == \"docker\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Exfiltration",
                  "Execution",
                  "Discovery"
                ],
                "techniques": [
                  "T1537",
                  "T1610",
                  "T1083"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DK_Url",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "KeywordName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DK_Url": "DK_Url",
                  "DK_DeveloperUrl": "DK_DeveloperUrl",
                  "Status": "Status",
                  "DK_Developer": "DK_Developer",
                  "DK_description": "DK_Description",
                  "DK_Stars": "DK_Stars",
                  "Service": "Service",
                  "DK_Title": "DK_Title",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DK_Downloads": "DK_Downloads"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Docker Image Identified {{DK_Title}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A Docker Hub image related to monitored entity {{KeywordName}} was discovered. Developer {{DK_Developer}}. Downloads {{DK_Downloads}}. Review metadata and verify if the image poses supply chain or impersonation risk.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject14').analyticRuleId14,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 14",
                "parentId": "[variables('analyticRuleObject14').analyticRuleId14]",
                "contentId": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject14').analyticRuleVersion14]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Docker",
        "contentProductId": "[variables('analyticRuleObject14')._analyticRulecontentProductId14]",
        "id": "[variables('analyticRuleObject14')._analyticRulecontentProductId14]",
        "version": "[variables('analyticRuleObject14').analyticRuleVersion14]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject15').analyticRuleTemplateSpecName15]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_domain_expiry_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject15').analyticRuleVersion15]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when a monitored domain is about to expire. Expired domains risk service disruption, takeover, or misuse by adversaries.",
                "displayName": "Cyble Vision Alerts Domain Expiry Alert",
                "enabled": false,
                "query": "Alerts_domain_expiry  \n| where Service == \"domain_expiry\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Impact"
                ],
                "techniques": [
                  "T1499"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DE_Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DE_ExpiryDate": "DE_ExpiryDate",
                  "Status": "Status",
                  "DE_Domain": "DE_Domain",
                  "Service": "Service",
                  "DE_TypeText": "DE_TypeText",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DE_DueDays": "DE_DueDays"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Domain Expiration Imminent {{DE_Domain}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "The monitored domain is expiring soon. Expiry Date {{DE_ExpiryDate}}. Due in {{DE_DueDays}} days. Alert Type {{DE_TypeText}}. Immediate renewal is recommended to avoid service disruption or domain hijacking.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject15').analyticRuleId15,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 15",
                "parentId": "[variables('analyticRuleObject15').analyticRuleId15]",
                "contentId": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject15').analyticRuleVersion15]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Domain Expiry Alert",
        "contentProductId": "[variables('analyticRuleObject15')._analyticRulecontentProductId15]",
        "id": "[variables('analyticRuleObject15')._analyticRulecontentProductId15]",
        "version": "[variables('analyticRuleObject15').analyticRuleVersion15]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject16').analyticRuleTemplateSpecName16]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_domain_watchlist_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject16').analyticRuleVersion16]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when monitored domain DNS records change (A, NS, MX, TXT, SOA). DNS record changes may indicate misconfiguration, domain takeover attempts, or infrastructure shifts requiring review.",
                "displayName": "Cyble Vision Alerts Domain Watchlist",
                "enabled": false,
                "query": "Alerts_domain_watchlist  \n| where Service == \"domain_watchlist\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1584"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "DW_New_Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Status": "Status",
                  "DW_Old_Domain": "DW_Old_Domain",
                  "Service": "Service",
                  "DW_UpdatedFields": "DW_UpdatedFields",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DW_New_Domain": "DW_New_Domain"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "DNS Record Change Detected for {{DW_New_Domain}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "Domain Watchlist Alert: DNS records for {{DW_New_Domain}} have changed. Updated fields {{DW_UpdatedFields}}. Review differences between old and new DNS records to determine if this is a legitimate update or a potential hijack attempt.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject16').analyticRuleId16,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 16",
                "parentId": "[variables('analyticRuleObject16').analyticRuleId16]",
                "contentId": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject16').analyticRuleVersion16]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Domain Watchlist",
        "contentProductId": "[variables('analyticRuleObject16')._analyticRulecontentProductId16]",
        "id": "[variables('analyticRuleObject16')._analyticRulecontentProductId16]",
        "version": "[variables('analyticRuleObject16').analyticRuleVersion16]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject17').analyticRuleTemplateSpecName17]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Flash_Report_Alerts_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject17').analyticRuleVersion17]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects new threat intelligence flash reports from CybleVision. Extracts company-level context and report identifiers for triage.",
                "displayName": "Cyble Vision Alerts Flash Report",
                "enabled": false,
                "query": "Alerts_flash_report \n| where Service == \"flash_report\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1598",
                  "T1589"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "FR_ReportID",
                        "identifier": "ObjectGuid"
                      }
                    ],
                    "entityType": "Account"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Status": "Status",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "ForCompany": "FR_ForCompany",
                  "Tags": "FR_Tags",
                  "MappedSeverity": "Severity",
                  "FlashReportID": "FR_ReportID"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Flash Report {{KeywordName}}",
                  "alertDescriptionFormat": "A flash threat report has been published. Report ID {{FR_ReportID}} For Company {{FR_ForCompany}} Description {{Description}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject17').analyticRuleId17,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 17",
                "parentId": "[variables('analyticRuleObject17').analyticRuleId17]",
                "contentId": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject17').analyticRuleVersion17]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Flash Report",
        "contentProductId": "[variables('analyticRuleObject17')._analyticRulecontentProductId17]",
        "id": "[variables('analyticRuleObject17')._analyticRulecontentProductId17]",
        "version": "[variables('analyticRuleObject17').analyticRuleVersion17]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject18').analyticRuleTemplateSpecName18]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_github_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject18').analyticRuleVersion18]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "This alert generates incidents for Github",
                "displayName": "Cyble Vision Alerts Github",
                "enabled": false,
                "query": "Alerts_github\n| where Service contains \"github\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Collection",
                  "CredentialAccess"
                ],
                "techniques": [
                  "T1213",
                  "T1530",
                  "T1552"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "owner_login",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "html_url",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "file_name",
                        "identifier": "Name"
                      },
                      {
                        "columnName": "file_path",
                        "identifier": "Directory"
                      }
                    ],
                    "entityType": "File"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "SHA": "sha",
                  "Score": "score",
                  "Repository": "repo_full_name",
                  "Status": "Status",
                  "FileName": "file_name",
                  "OriginalSeverity": "Severity",
                  "GitURl": "git_url",
                  "Owner": "owner_login",
                  "Service": "Service",
                  "HTMLURL": "html_url",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "Cyble Vision ALert for Github",
                  "alertDescriptionFormat": "This Rule generate incidents for Serviec Github"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject18').analyticRuleId18,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 18",
                "parentId": "[variables('analyticRuleObject18').analyticRuleId18]",
                "contentId": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject18').analyticRuleVersion18]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Github",
        "contentProductId": "[variables('analyticRuleObject18')._analyticRulecontentProductId18]",
        "id": "[variables('analyticRuleObject18')._analyticRulecontentProductId18]",
        "version": "[variables('analyticRuleObject18').analyticRuleVersion18]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject19').analyticRuleTemplateSpecName19]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_hacktivism_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject19').analyticRuleVersion19]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects hacktivist activity (Telegram posts, defacements, site takedowns, etc.) using the Alerts_Hacktivism parser. Extracts post content, attacker/team,domains, links, IPs, media and metadata for triage.",
                "displayName": "Cyble Vision Alerts Hacktivism",
                "enabled": false,
                "query": "Alerts_hacktivism \n| where Service contains \"hacktivism\" \n| extend Mappedseverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "Impact",
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1595",
                  "T1491",
                  "T1498",
                  "T1585"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "HK_AttackerTeam",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "HK_All_URLs",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "HK_All_Domains",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "HK_IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "WebsiteURL": "HK_WebsiteURL",
                  "TargetDomain": "HK_Domain",
                  "ChannelLink": "HK_ChannelLink",
                  "AlertID": "AlertID",
                  "PostID": "HK_PostID",
                  "Service": "Service",
                  "PostedAt": "HK_PostedAt",
                  "Server": "HK_Server",
                  "Source": "HK_SourceWebsite",
                  "MappedSeverity": "Severity",
                  "Tags": "HK_Tags",
                  "ChannelName": "HK_ChannelName",
                  "PostText": "HK_PostData",
                  "Attacker": "HK_Attacker",
                  "Phones": "HK_Phones",
                  "Status": "Status",
                  "SourceWebsite": "HK_SourceWebsite",
                  "Emails": "HK_Emails"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Hacktivism {{HK_ChannelName}} / {{HK_AttackerTeam}}",
                  "alertDescriptionFormat": "Hacktivism activity detected. Attacker/Team {{HK_AttackerTeam}} Post excerpt {{HK_PostData}} Domains/Links {{HK_All_Domains}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject19').analyticRuleId19,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 19",
                "parentId": "[variables('analyticRuleObject19').analyticRuleId19]",
                "contentId": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject19').analyticRuleVersion19]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Hacktivism",
        "contentProductId": "[variables('analyticRuleObject19')._analyticRulecontentProductId19]",
        "id": "[variables('analyticRuleObject19')._analyticRulecontentProductId19]",
        "version": "[variables('analyticRuleObject19').analyticRuleVersion19]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject20').analyticRuleTemplateSpecName20]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_i2p_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject20').analyticRuleVersion20]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when I2P content is detected related to monitored keywords. Useful for identifying extremist narratives, radicalization indicators, or harmful ideological campaigns spreading through I2P hidden services.",
                "displayName": "Cyble Vision Alerts I2P Monitoring",
                "enabled": false,
                "query": "Alerts_i2p  \n| where Service == \"i2p\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1585"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "I2P_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Status": "Status",
                  "I2P_SearchKeyword": "I2P_SearchKeyword",
                  "Service": "Service",
                  "I2P_UpdatedOn": "I2P_UpdatedOn",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "I2P_URL": "I2P_URL"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "I2P Content Alert Hidden Service Activity for Keyword {{I2P_SearchKeyword}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "Potentially sensitive or harmful content has been detected on the I2P network. URL {{I2P_URL}}. Content updated on {{I2P_UpdatedOn}}. The captured content may involve extremist ideology, radical discussions, or harmful narratives that require SOC review.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject20').analyticRuleId20,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 20",
                "parentId": "[variables('analyticRuleObject20').analyticRuleId20]",
                "contentId": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject20').analyticRuleVersion20]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts I2P Monitoring",
        "contentProductId": "[variables('analyticRuleObject20')._analyticRulecontentProductId20]",
        "id": "[variables('analyticRuleObject20')._analyticRulecontentProductId20]",
        "version": "[variables('analyticRuleObject20').analyticRuleVersion20]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject21').analyticRuleTemplateSpecName21]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_IOC'S_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject21').analyticRuleVersion21]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects malicious Indicators of Compromise such as IPs, domains, URLs, and hashes. Extracts IOC type, behaviour tags, risk rating, and timestamps using Alerts_IOCs parser. Triggers an incident with mapped entities, severity, and details.",
                "displayName": "Cyble Vision Alerts IOC'S",
                "enabled": false,
                "query": "Alerts_iocs \n| where Service == \"iocs\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "InitialAccess",
                  "Discovery",
                  "CommandAndControl",
                  "Impact"
                ],
                "techniques": [
                  "T1595",
                  "T1133",
                  "T1046",
                  "T1071",
                  "T1486"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "IOC_Value",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "IOC": "IOC_Value",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "IOCRiskRating": "IOC_RiskRating",
                  "MappedSeverity": "Severity",
                  "IOCConfidentRating": "IOC_ConfidentRating",
                  "Tags": "IOC_Tags",
                  "IOCAttackName": "IOC_AttackName",
                  "LastSeen": "IOC_LastSeen",
                  "UUID": "IOC_UUID",
                  "IOCBehaviour": "IOC_BehaviourTags",
                  "FirstSeen": "IOC_FirstSeen",
                  "IOCType": "IOC_Type",
                  "Status": "Status",
                  "Reference": "IOC_ReferenceLink"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision IOC Detected {{IOC_Value}}",
                  "alertDescriptionFormat": "Type {{IOC_Type}} Behaviour {{IOC_BehaviourTags}} Risk Rating {{IOC_RiskRating}}'\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject21').analyticRuleId21,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 21",
                "parentId": "[variables('analyticRuleObject21').analyticRuleId21]",
                "contentId": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject21').analyticRuleVersion21]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts IOC'S",
        "contentProductId": "[variables('analyticRuleObject21')._analyticRulecontentProductId21]",
        "id": "[variables('analyticRuleObject21')._analyticRulecontentProductId21]",
        "version": "[variables('analyticRuleObject21').analyticRuleVersion21]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject22').analyticRuleTemplateSpecName22]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ip_risk_score_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject22').analyticRuleVersion22]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when the risk score for a monitored IP increases significantly. This may indicate new malicious behavior or updated threat intelligence classification.",
                "displayName": "Cyble Vision Alerts IP Risk Score",
                "enabled": false,
                "query": "Alerts_ip_risk_score  \n| where Service == \"ip_risk_score\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1595"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "IPRS_IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Status": "Status",
                  "IPRS_OldScore": "IPRS_OldScore",
                  "IPRS_IP": "IPRS_IP",
                  "Service": "Service",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "IPRS_NewScore": "IPRS_NewScore"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Risk Score Increased for IP {{IPRS_IP}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "The risk score for IP {{IPRS_IP}} has increased. Previous score {{IPRS_OldScore}}. New score {{IPRS_NewScore}}. This may represent newly observed malicious activity or updated threat intelligence.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject22').analyticRuleId22,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 22",
                "parentId": "[variables('analyticRuleObject22').analyticRuleId22]",
                "contentId": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject22').analyticRuleVersion22]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts IP Risk Score",
        "contentProductId": "[variables('analyticRuleObject22')._analyticRulecontentProductId22]",
        "id": "[variables('analyticRuleObject22')._analyticRulecontentProductId22]",
        "version": "[variables('analyticRuleObject22').analyticRuleVersion22]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject23').analyticRuleTemplateSpecName23]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Leaked_Credentials_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject23').analyticRuleVersion23]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects leaked credentials identified by CybleVision ingestion and triggers an incident with mapped entities, severity, and details.",
                "displayName": "Cyble Vision Alerts Leaked Credentials",
                "enabled": false,
                "query": "Alerts_leaked_credentials\n| where Service == \"leaked_credentials\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "CredentialAccess",
                  "Discovery",
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1552",
                  "T1082"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "LC_Username",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "LC_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "LC_Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Leak_Data": "LC_Data",
                  "Leak_Tags": "LC_Tags",
                  "Status": "Status",
                  "Leak_Date": "LC_Date",
                  "Leak_Username": "LC_Username",
                  "Service": "Service",
                  "Leak_Url": "LC_URL",
                  "MappedSeveritry": "MappedSeverity",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "Leaked Credentials Detected {{LC_Username}}",
                  "alertDescriptionFormat": "A leaked set of credentials associated with {{LC_Username}} was detected. Domain {{LC_Domain}} Source URL {{LC_URL}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject23').analyticRuleId23,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 23",
                "parentId": "[variables('analyticRuleObject23').analyticRuleId23]",
                "contentId": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject23').analyticRuleVersion23]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Leaked Credentials",
        "contentProductId": "[variables('analyticRuleObject23')._analyticRulecontentProductId23]",
        "id": "[variables('analyticRuleObject23')._analyticRulecontentProductId23]",
        "version": "[variables('analyticRuleObject23').analyticRuleVersion23]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject24').analyticRuleTemplateSpecName24]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Malicious_ads_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject24').analyticRuleVersion24]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Generates an incident when Cyble Intelligence detects a malicious advertisement, malvertising activity, or redirect attempting to impersonate a legitimate brand.",
                "displayName": "Cyble Vision Alerts Malicious Ads Detected",
                "enabled": false,
                "query": "Alerts_malicious_ads\n| where Service == \"malicious_ads\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "InitialAccess",
                  "Execution"
                ],
                "techniques": [
                  "T1189",
                  "T1566",
                  "T1059"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_Domain_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_DomainName_Nested",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Domain": "MA_Domain_URL",
                  "Keyword": "MA_Keyword_Nested",
                  "Status": "Status",
                  "IsLive": "MA_IsLive",
                  "Service": "Service",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Malicious Ad Detected  {{MA_DomainName_Nested}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "Cyble Intelligence detected a malicious advertisement or suspicious redirect.\nDomain {{MA_Domain_URL}}\nBrand/Keyword {{MA_Keyword_Nested}}\nStatus Code {{MA_StatusCode}}\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject24').analyticRuleId24,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 24",
                "parentId": "[variables('analyticRuleObject24').analyticRuleId24]",
                "contentId": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject24').analyticRuleVersion24]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Malicious Ads Detected",
        "contentProductId": "[variables('analyticRuleObject24')._analyticRulecontentProductId24]",
        "id": "[variables('analyticRuleObject24')._analyticRulecontentProductId24]",
        "version": "[variables('analyticRuleObject24').analyticRuleVersion24]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject25').analyticRuleTemplateSpecName25]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Mobile_Apps_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject25').analyticRuleVersion25]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects suspicious, unauthorized or impersonating mobile applications from 3rd-party marketplaces using CybleVision data. Extracts metadata, screenshots, developer, package name, and detailed app attributes.",
                "displayName": "CybleVision Alerts Mobile Apps",
                "enabled": false,
                "query": "Alerts_mobile_apps \n| where Service == \"mobile_apps\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "ResourceDevelopment",
                  "InitialAccess"
                ],
                "techniques": [
                  "T1595",
                  "T1608",
                  "T1195"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_DeepLink",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "AppEmail": "MA_Email",
                  "MarketSource": "MA_MarketSource",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "CreatedOn": "MA_Created",
                  "Tags": "MA_Tags",
                  "MappedSeverity": "Severity",
                  "Website": "MA_Website",
                  "Status": "Status",
                  "Description": "MA_Description",
                  "AppName": "AppName",
                  "IconURL": "MA_MarketURL",
                  "MarketStatus": "MA_MarketStatus",
                  "Version": "MA_Version",
                  "Developer": "MA_Developer",
                  "Screenshots": "MA_Screenshots",
                  "MarketURL": "MA_MarketURL",
                  "PackageName": "MA_PackageName",
                  "Downloads": "MA_Downloads",
                  "MarketUpdated": "MA_MarketUpdated"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Suspicious Mobile App {{MA_Title}}",
                  "alertDescriptionFormat": "A potentially suspicious mobile application was detected. Developer {{MA_Developer}} Market {{MA_MarketSource}} Deep Link {{MA_DeepLink}}\\n\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject25').analyticRuleId25,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 25",
                "parentId": "[variables('analyticRuleObject25').analyticRuleId25]",
                "contentId": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject25').analyticRuleVersion25]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
        "contentKind": "AnalyticsRule",
        "displayName": "CybleVision Alerts Mobile Apps",
        "contentProductId": "[variables('analyticRuleObject25')._analyticRulecontentProductId25]",
        "id": "[variables('analyticRuleObject25')._analyticRulecontentProductId25]",
        "version": "[variables('analyticRuleObject25').analyticRuleVersion25]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject26').analyticRuleTemplateSpecName26]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_new_vulnerability_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject26').analyticRuleVersion26]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "A newly detected CVE has been associated with a monitored keyword or asset. This may indicate exposure to newly published or exploited vulnerabilities.",
                "displayName": "Cyble Vision Alerts New Vulnerability Detected",
                "enabled": false,
                "query": "Alerts_new_vulnerability  \n| where Service == \"new_vulnerability\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "InitialAccess"
                ],
                "techniques": [
                  "T1190"
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Service": "Service",
                  "NV_CVE": "NV_CVE",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "Status": "Status"
                },
                "incidentConfiguration": {
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDisplayNameFormat": "New Vulnerability Identified {{NV_CVE}}",
                  "severityColumnName": "MappedSeverity",
                  "createIncident": true,
                  "alertDetailsOverride": null,
                  "description": "A new vulnerability ({{NV_CVE}}) has been identified for one of the monitored keywords or assets. This CVE may pose risks depending on exposure and exploitability. Review CVE details and assess potential impact on your environment.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject26').analyticRuleId26,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 26",
                "parentId": "[variables('analyticRuleObject26').analyticRuleId26]",
                "contentId": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject26').analyticRuleVersion26]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts New Vulnerability Detected",
        "contentProductId": "[variables('analyticRuleObject26')._analyticRulecontentProductId26]",
        "id": "[variables('analyticRuleObject26')._analyticRulecontentProductId26]",
        "version": "[variables('analyticRuleObject26').analyticRuleVersion26]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject27').analyticRuleTemplateSpecName27]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_News_Feed_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject27').analyticRuleVersion27]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when monitored keywords are found in external news feeds. Helps analysts track relevant cybersecurity news, advisories, or threat intelligence updates tied to monitored entities.",
                "displayName": "Cyble Vision Alerts News Feed Alert",
                "enabled": false,
                "query": "Alerts_news_feed  \n| where Service == \"news_feed\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1598"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "NF_PostURL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "KeywordName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Status": "Status",
                  "NF_PostTitle": "NF_PostTitle",
                  "Service": "Service",
                  "NF_PostURL": "NF_PostURL",
                  "NF_PostSource": "NF_PostSourceName",
                  "NF_AI_Summary": "NF_AI_Summary",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Relevant Cybersecurity News {{NF_PostTitle}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A news article referencing the monitored keyword {{KeywordName}} was identified. Source {{NF_PostSourceName}}. URL {{NF_PostURL}}.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject27').analyticRuleId27,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 27",
                "parentId": "[variables('analyticRuleObject27').analyticRuleId27]",
                "contentId": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject27').analyticRuleVersion27]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts News Feed Alert",
        "contentProductId": "[variables('analyticRuleObject27')._analyticRulecontentProductId27]",
        "id": "[variables('analyticRuleObject27')._analyticRulecontentProductId27]",
        "version": "[variables('analyticRuleObject27').analyticRuleVersion27]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject28').analyticRuleTemplateSpecName28]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_osint_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject28').analyticRuleVersion28]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when Cyble detects an OSINT mention related to monitored keywords, entities, or brand identifiers. OSINT findings may indicate data leaks, expose content, targeting activity, impersonation, or discussions that may require investigation.",
                "displayName": "Cyble Vision Alerts OSINT Mention Detected",
                "enabled": false,
                "query": "Alerts_osint  \n| where Service == \"osint\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1592",
                  "T1589"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_DomainURL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "KeywordName",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Source": "OS_Source",
                  "Status": "Status",
                  "AuthorName": "OS_AuthorName",
                  "Service": "Service",
                  "MentionURL": "OS_MentionURL",
                  "MentionDate": "OS_MentionDate",
                  "PostSnippet": "OS_PostSnippet",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "AuthorUsername": "OS_AuthorUsername"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "OSINT Mention Identified for Monitored Keyword {{KeywordName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A public OSINT mention referencing monitored keyword/entity {{KeywordName}} has been detected. Source {{OS_Source}}. Mention URL {{OS_MentionURL}}. This may indicate reputational impact, data exposure, or adversarial research targeting the organization.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject28').analyticRuleId28,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 28",
                "parentId": "[variables('analyticRuleObject28').analyticRuleId28]",
                "contentId": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject28').analyticRuleVersion28]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts OSINT Mention Detected",
        "contentProductId": "[variables('analyticRuleObject28')._analyticRulecontentProductId28]",
        "id": "[variables('analyticRuleObject28')._analyticRulecontentProductId28]",
        "version": "[variables('analyticRuleObject28').analyticRuleVersion28]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject29').analyticRuleTemplateSpecName29]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ot_ics_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject29').analyticRuleVersion29]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "This alert indicates detection of OT/ICS-related network activity involving industrial control protocols (e.g., IEC104). May indicate probing, reconnaissance, or attempted access against critical infrastructure assets.",
                "displayName": "Cyble Vision Alerts OT/ICS Threat Activity Detected",
                "enabled": false,
                "query": "Alerts_ot_ics  \n| where Service == \"ot_ics\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Discovery",
                  "Collection"
                ],
                "techniques": [
                  "T0842",
                  "T0830"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "OT_SourceIP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "OT_IP_Reputation": "OT_IP_Reputation",
                  "Service": "Service",
                  "Status": "Status",
                  "OT_SourceIP": "OT_SourceIP",
                  "OT_Country": "OT_Country",
                  "OT_ASN": "OT_ASN",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "OT_DestPort": "OT_DestPort",
                  "OT_DataType": "OT_DataType"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "OT/ICS Activity Detected from {{OT_SourceIP}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "description": "Cyble detected industrial control system related traffic involving protocol {{OT_DataType}} from IP {{OT_SourceIP}}. Destination port {{OT_DestPort}}. Country. {{OT_Country}}. This may indicate reconnaissance or hostile probing of OT/ICS infrastructure.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject29').analyticRuleId29,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 29",
                "parentId": "[variables('analyticRuleObject29').analyticRuleId29]",
                "contentId": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject29').analyticRuleVersion29]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts OT/ICS Threat Activity Detected",
        "contentProductId": "[variables('analyticRuleObject29')._analyticRulecontentProductId29]",
        "id": "[variables('analyticRuleObject29')._analyticRulecontentProductId29]",
        "version": "[variables('analyticRuleObject29').analyticRuleVersion29]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject30').analyticRuleTemplateSpecName30]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_pastebin_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject30').analyticRuleVersion30]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Cyble detected a paste containing references to monitored keywords or domains. Pastebin/Gist exposure may indicate data leakage or threat actor activity referencing the organization.",
                "displayName": "Cyble Vision Alerts Pastebin",
                "enabled": false,
                "query": "Alerts_pastebin  \n| where Service == \"pastebin\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1591"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "MA_DomainURL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "KeywordName",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "PasteID": "PB_Data_PasteID",
                  "PasteURL": "PB_Data_URL",
                  "Status": "Status",
                  "PasteUpdatedOn": "PB_ContentUpdatedOn",
                  "Service": "Service",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "PasteAuthor": "PB_Author"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Pastebin/Gist Exposure for Keyword {{KeywordName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A public paste has been detected referencing monitored keyword {{KeywordName}}. Paste Author {{PB_Author}}. URL {{PB_Data_URL}}. This may indicate sensitive information exposure or monitoring by external actors.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject30').analyticRuleId30,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 30",
                "parentId": "[variables('analyticRuleObject30').analyticRuleId30]",
                "contentId": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject30').analyticRuleVersion30]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Pastebin",
        "contentProductId": "[variables('analyticRuleObject30')._analyticRulecontentProductId30]",
        "id": "[variables('analyticRuleObject30')._analyticRulecontentProductId30]",
        "version": "[variables('analyticRuleObject30').analyticRuleVersion30]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject31').analyticRuleTemplateSpecName31]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_phishing_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject31').analyticRuleVersion31]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Cyble detected a phishing website impersonating a monitored brand. This alert provides landing page, host, screenshot, status and configured keyword for SOC triage.",
                "displayName": "Cyble Vision Alerts Phishing Domain Detected",
                "enabled": false,
                "query": "Alerts_phishing \n| where Service == \"phishing\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "subTechniques": [
                  "T1598.003"
                ],
                "techniques": [
                  "T1598"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "PH_DomainName",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "PH_HostName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "PH_Top_Domain": "PH_Top_Domain",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "PH_DetectedAt": "PH_DetectedAt",
                  "PH_IsLive": "PH_IsLive",
                  "PH_PhishingStatus": "PH_PhishingStatus",
                  "PH_ScreenshotURL": "PH_ScreenshotURL",
                  "PH_LastLiveOn": "PH_LastLiveOn",
                  "Status": "Status",
                  "PH_PhishingKeyword": "PH_PhishingKeyword",
                  "PH_Title": "PH_Title",
                  "PH_AWSObjectName": "PH_AWSObjectName",
                  "PH_DomainName": "PH_DomainName",
                  "PH_HostName": "PH_HostName",
                  "MappedSeverity": "Severity",
                  "PH_Score": "PH_Score"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Phishing Detected {{PH_PhishingKeyword}} on {{PH_DomainName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A phishing landing page impersonating {{PH_Brand}}.\nHost {{PH_HostName}}\nLive {{PH_IsLive}}\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject31').analyticRuleId31,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 31",
                "parentId": "[variables('analyticRuleObject31').analyticRuleId31]",
                "contentId": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject31').analyticRuleVersion31]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Phishing Domain Detected",
        "contentProductId": "[variables('analyticRuleObject31')._analyticRulecontentProductId31]",
        "id": "[variables('analyticRuleObject31')._analyticRulecontentProductId31]",
        "version": "[variables('analyticRuleObject31').analyticRuleVersion31]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject32').analyticRuleTemplateSpecName32]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Physical_Threats_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject32').analyticRuleVersion32]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Creates an incident for physical threats identified by Cyble Intelligence such as explosions, safety incidents, riots, or violence. Each alert generates a single incident for SOC evaluation.",
                "displayName": "Cyble Vision Alerts Physical Threat Alert",
                "enabled": false,
                "query": "Alerts_physical_threats\n| where Service == \"physical_threats\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Impact"
                ],
                "techniques": [
                  "T1486"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "PT_BaseSourceURL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "LocationType": "PT_LocationType",
                  "Status": "Status",
                  "ThreatType": "PT_ThreatType",
                  "Latitude": "PT_Latitude",
                  "Service": "Service",
                  "ThreatTitle": "PT_Title_Nested",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "Location": "PT_LocationName",
                  "Longitude": "PT_Longitude"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A physical threat incident was identified by Cyble Intelligence.\nTitle {{PT_Title_Nested}}\nThreat Type {{PT_ThreatType}}\nPublished At {{PT_PublishedAt}}\n",
                  "alertDisplayNameFormat": "Physical Threat Detected  {{PT_Title_Nested}}"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject32').analyticRuleId32,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 32",
                "parentId": "[variables('analyticRuleObject32').analyticRuleId32]",
                "contentId": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject32').analyticRuleVersion32]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Physical Threat Alert",
        "contentProductId": "[variables('analyticRuleObject32')._analyticRulecontentProductId32]",
        "id": "[variables('analyticRuleObject32')._analyticRulecontentProductId32]",
        "version": "[variables('analyticRuleObject32').analyticRuleVersion32]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject33').analyticRuleTemplateSpecName33]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Postman_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject33').analyticRuleVersion33]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects exposed Postman requests, collections or endpoints referencing monitored entities. Alerts analysts to possible API enumeration, leaked endpoints, or unintended exposure.",
                "displayName": "Cyble Vision Alerts Postman API Exposure Detection",
                "enabled": false,
                "query": "Alerts_postman  \n| where Service == \"postman\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "CredentialAccess",
                  "Exfiltration"
                ],
                "techniques": [
                  "T1595",
                  "T1552",
                  "T1041"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "PM_Url",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "Url"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "KeywordName",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "PM_PostmanKey": "PM_PostmanKey",
                  "PM_Title": "PM_Title",
                  "Status": "Status",
                  "PM_Category": "PM_Category",
                  "PM_Url": "PM_Url",
                  "Service": "Service",
                  "PM_DevelopedByUrl": "PM_DevelopedByUrl",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "PM_DevelopedBy": "PM_DevelopedBy"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Exposed Postman API Request {{PM_Title}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A Postman API request referencing monitored entity {{KeywordName}} was discovered. Public Workspace {{PM_IsPublic}}. Developer {{PM_DevelopedBy}}. This may indicate exposed API endpoints, leaked request parameters or sensitive testing data.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject33').analyticRuleId33,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 33",
                "parentId": "[variables('analyticRuleObject33').analyticRuleId33]",
                "contentId": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject33').analyticRuleVersion33]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Postman API Exposure Detection",
        "contentProductId": "[variables('analyticRuleObject33')._analyticRulecontentProductId33]",
        "id": "[variables('analyticRuleObject33')._analyticRulecontentProductId33]",
        "version": "[variables('analyticRuleObject33').analyticRuleVersion33]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject34').analyticRuleTemplateSpecName34]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_product_vulnerability_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject34').analyticRuleVersion34]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects product vulnerability updates (CVE) for monitored products. Triggers SOC triage when a product vulnerability is reported or updated for a monitored product/version.",
                "displayName": "Cyble Vision Alerts Product Vulnerability Detected",
                "enabled": false,
                "query": "Alerts_product_vulnerability  \n| where Service == \"product_vulnerability\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "InitialAccess",
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1190",
                  "T1588"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SD_Subdomain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "KeywordName",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SD_Subdomain",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "PV_SW_Company": "PV_SW_Company",
                  "PV_Title": "PV_Title",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "New_Exploitability": "PV_New_Exploitability",
                  "PV_Old_EPS_Score": "PV_Old_EPS_Score",
                  "PV_New_Price_Today": "PV_New_Price_Today",
                  "MappedSeverity": "Severity",
                  "PV_CVE_ID": "PV_CVE_ID",
                  "PV_New_Price_0day": "PV_New_Price_0day",
                  "PV_SW_Software": "PV_SW_Software",
                  "PV_Version": "PV_Version",
                  "PV_New_EPS_Score": "PV_New_EPS_Score",
                  "Status": "Status",
                  "New_EPS_Percentile": "PV_New_EPS_Percentile",
                  "PV_Product": "PV_Product"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "Product Vulnerability {{PV_Product}} {{PV_Version}} {{PV_CVE_ID}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A product vulnerability has been detected.\nTitle {{PV_Title}}\nExploitability {{PV_New_Exploitability}}\nReview the CVE details, assess exposure in your environment, and apply mitigations as required.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject34').analyticRuleId34,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 34",
                "parentId": "[variables('analyticRuleObject34').analyticRuleId34]",
                "contentId": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject34').analyticRuleVersion34]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Product Vulnerability Detected",
        "contentProductId": "[variables('analyticRuleObject34')._analyticRulecontentProductId34]",
        "id": "[variables('analyticRuleObject34')._analyticRulecontentProductId34]",
        "version": "[variables('analyticRuleObject34').analyticRuleVersion34]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject35').analyticRuleTemplateSpecName35]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Social_Media_Monitoring_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject35').analyticRuleVersion35]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects and CybleVision 'social_media_monitoring' alerts into a single incident.",
                "displayName": "Cyble Vision Alerts Social Media Monitoring",
                "enabled": false,
                "query": "Alerts_social_media_monitoring \n| where Service == \"social_media_monitoring\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "ResourceDevelopment"
                ],
                "techniques": [
                  "T1595",
                  "T1585",
                  "T1589"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SM_CreatorName",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SM_Urls",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Source": "SM_SourceData",
                  "Service": "Service",
                  "Status": "Status",
                  "Domains": "SM_Domains",
                  "CreatorName": "SM_CreatorName",
                  "URLS": "SM_Urls",
                  "Category": "SM_Category",
                  "ContentHash": "SM_ContentHash",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "Sentiment": "SM_SentimentData",
                  "Subdomains": "SM_Subdomains"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Social Media Monitoring ({{SM_CreatorName}})",
                  "alertDescriptionFormat": "Social media monitoring alert detected. Category {{SM_Category}}. Source {{SM_SourceData}}. Creator {{SM_CreatorName}}.\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject35').analyticRuleId35,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 35",
                "parentId": "[variables('analyticRuleObject35').analyticRuleId35]",
                "contentId": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject35').analyticRuleVersion35]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Social Media Monitoring",
        "contentProductId": "[variables('analyticRuleObject35')._analyticRulecontentProductId35]",
        "id": "[variables('analyticRuleObject35')._analyticRulecontentProductId35]",
        "version": "[variables('analyticRuleObject35').analyticRuleVersion35]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject36').analyticRuleTemplateSpecName36]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ssl_expiry_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject36').analyticRuleVersion36]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Generates Microsoft Sentinel incidents for SSL certificates nearing expiry as detected by Cyble. These alerts help identify certificate hygiene risks that may lead to service disruption or security issues. Severity is normalized using MappedSeverity for downstream automation.",
                "displayName": "Cyble Vision Alerts SSL Certificate Expiry",
                "enabled": false,
                "query": "Alerts_ssl_expiry\n| where Service == \"ssl_expiry\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "InitialAccess",
                  "Impact"
                ],
                "techniques": [
                  "T1190",
                  "T1499"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SS_Asset",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SS_Asset",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SS_Port",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DaysToExpiry": "SS_DaysUntilExpiry",
                  "Status": "Status",
                  "Port": "SS_Port",
                  "CertificateTitle": "SS_Title",
                  "Service": "Service",
                  "Asset": "SS_Asset",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "ExpiryDate": "SS_Expiry"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "SSL Certificate Expiry  {{DC_ServerName}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": ""
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject36').analyticRuleId36,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 36",
                "parentId": "[variables('analyticRuleObject36').analyticRuleId36]",
                "contentId": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject36').analyticRuleVersion36]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts SSL Certificate Expiry",
        "contentProductId": "[variables('analyticRuleObject36')._analyticRulecontentProductId36]",
        "id": "[variables('analyticRuleObject36')._analyticRulecontentProductId36]",
        "version": "[variables('analyticRuleObject36').analyticRuleVersion36]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject37').analyticRuleTemplateSpecName37]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Stealer_Logs_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject37').analyticRuleVersion37]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects credential theft and information-stealer malware logs. Extracts stolen credentials, URLs, device info, IPs, domains, and metadata using the Alerts_StealerLogs parser.",
                "displayName": "CybleVision Alerts Stealer Logs",
                "enabled": false,
                "query": "Alerts_stealer_logs \n| where Service == \"stealer_logs\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "CredentialAccess",
                  "Collection",
                  "Exfiltration",
                  "Reconnaissance",
                  "InitialAccess"
                ],
                "techniques": [
                  "T1555",
                  "T1005",
                  "T1041",
                  "T1589",
                  "T1189"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SL_MainUsername",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SL_MainURL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SL_IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SL_Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "CompromisedDate": "SL_CompromiseDate",
                  "MalwareFamily": "SL_MalwareFamily",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "FileModified": "SL_FileModified",
                  "HWID": "SL_HWID",
                  "MappedSeverity": "Severity",
                  "Password": "SL_Password",
                  "ContentUsername": "SL_Username_Content",
                  "Tags": "SL_Tags",
                  "FileName": "SL_FileName",
                  "ContentURL": "SL_URL_Content",
                  "FileCreated": "SL_FileCreated",
                  "IP": "SL_IP",
                  "FileSize": "SL_FileSize",
                  "Domain": "SL_Domain",
                  "Status": "Status",
                  "App": "SL_App",
                  "Country": "SL_Country"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Stealer Log Credential Exposure {{SL_MainUsername}}",
                  "alertDescriptionFormat": "Stolen credentials detected in stealer logs. Malware Family {{SL_MalwareFamily}} URL {{SL_MainURL}} IP {{SL_IP}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject37').analyticRuleId37,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 37",
                "parentId": "[variables('analyticRuleObject37').analyticRuleId37]",
                "contentId": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject37').analyticRuleVersion37]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
        "contentKind": "AnalyticsRule",
        "displayName": "CybleVision Alerts Stealer Logs",
        "contentProductId": "[variables('analyticRuleObject37')._analyticRulecontentProductId37]",
        "id": "[variables('analyticRuleObject37')._analyticRulecontentProductId37]",
        "version": "[variables('analyticRuleObject37').analyticRuleVersion37]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject38').analyticRuleTemplateSpecName38]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_subdomains_rule_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject38').analyticRuleVersion38]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Triggers when a new subdomain is detected for a monitored keyword/domain.",
                "displayName": "Cyble Vision Alerts Discovered Subdomain",
                "enabled": false,
                "query": "Alerts_subdomains  \n| where Service == \"subdomains\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1595"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "SD_Subdomain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Status": "Status",
                  "SD_BucketName": "BucketName",
                  "SD_Subdomain": "SD_Subdomain",
                  "Service": "Service",
                  "SD_KeywordName": "KeywordName",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "SD_EntityID": "EntityID"
                },
                "incidentConfiguration": {
                  "alertDetailsOverride": null,
                  "alertDisplayNameFormat": "New Subdomain Detected {{SD_Subdomain}}",
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  },
                  "alertDescriptionFormat": "A new subdomain was discovered for monitored domain/keyword. Keyword {{SD_KeywordName}} Bucket {{SD_BucketName}} Severity {{MappedSeverity}} This may represent new attack surface exposure or infrastructure expansion.\n"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject38').analyticRuleId38,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 38",
                "parentId": "[variables('analyticRuleObject38').analyticRuleId38]",
                "contentId": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject38').analyticRuleVersion38]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Discovered Subdomain",
        "contentProductId": "[variables('analyticRuleObject38')._analyticRulecontentProductId38]",
        "id": "[variables('analyticRuleObject38')._analyticRulecontentProductId38]",
        "version": "[variables('analyticRuleObject38').analyticRuleVersion38]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject39').analyticRuleTemplateSpecName39]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Suspicious_Domain_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject39').analyticRuleVersion39]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "This Rule generates Cyble Vision Alerts for Service - Suspicious Domain severity LOW",
                "displayName": "Cyble Vision Alerts Suspicious Domain",
                "enabled": false,
                "query": "Alerts_suspicious_domains \n| where Service == \"suspicious_domain\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1595"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Domain": "Domain",
                  "NS_Records": "NS_Records",
                  "LastLiveCheck": "SD_LastLiveCheck",
                  "AlertID": "AlertID",
                  "Service": "Service",
                  "LiveStatus": "SD_IsLive",
                  "MappedSeverity": "Severity",
                  "Screenshot": "SD_ScreenshotURL",
                  "Status": "Status",
                  "Score": "SD_Score",
                  "RegistrationDate": "SD_RegistrationDate",
                  "Keyword": "KeywordName",
                  "A_Records": "A_Records",
                  "MX_Records": "MX_Records"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "Suspicious Domain Detected {{Domain}}  {{Status}}",
                  "alertDescriptionFormat": "Suspicious Domain detected for {{Domain}} with {{Status}}\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject39').analyticRuleId39,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 39",
                "parentId": "[variables('analyticRuleObject39').analyticRuleId39]",
                "contentId": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject39').analyticRuleVersion39]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Suspicious Domain",
        "contentProductId": "[variables('analyticRuleObject39')._analyticRulecontentProductId39]",
        "id": "[variables('analyticRuleObject39')._analyticRulecontentProductId39]",
        "version": "[variables('analyticRuleObject39').analyticRuleVersion39]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject40').analyticRuleTemplateSpecName40]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Telegram_Mentions_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject40').analyticRuleVersion40]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects mentions of monitored keywords across Telegram channels and groups. Extracts message content, URLs, chat metadata, user identity, and timestamps.",
                "displayName": "CybleVision Alerts Telegram Mentions",
                "enabled": false,
                "query": "Alerts_telegram_mentions \n| where Service == \"telegram_mentions\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "ResourceDevelopment",
                  "InitialAccess",
                  "CommandAndControl"
                ],
                "techniques": [
                  "T1598",
                  "T1585",
                  "T1102"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "TG_Username2",
                        "identifier": "Name"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "TG_Urls",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "ChatID": "TG_ChatID",
                  "User": "TG_Username2",
                  "Status": "Status",
                  "UpdatedDate": "TG_UpdatedDate",
                  "Message": "TG_Message",
                  "ChatTitle": "TG_ChatTitle",
                  "Service": "Service",
                  "URLs": "TG_Urls",
                  "Tags": "TG_Tags",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "CreatedDate": "TG_CreatedDate"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Telegram Mention in {{TG_ChatTitle}}",
                  "alertDescriptionFormat": "A Telegram post mentioning monitored keywords was detected. User {{TG_Username2}}. Message {{TG_Message}} URL {{TG_Urls}}\\n\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject40').analyticRuleId40,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 40",
                "parentId": "[variables('analyticRuleObject40').analyticRuleId40]",
                "contentId": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject40').analyticRuleVersion40]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
        "contentKind": "AnalyticsRule",
        "displayName": "CybleVision Alerts Telegram Mentions",
        "contentProductId": "[variables('analyticRuleObject40')._analyticRulecontentProductId40]",
        "id": "[variables('analyticRuleObject40')._analyticRulecontentProductId40]",
        "version": "[variables('analyticRuleObject40').analyticRuleVersion40]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject41').analyticRuleTemplateSpecName41]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_TOR_Links_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject41').analyticRuleVersion41]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects Tor marketplace, darkweb link, and onion domain alerts from CybleVision. Uses the Alerts_TorLinks parser to extract onion URLs, search engines, search keywords, content, and identifiers. Incidents are grouped by service.",
                "displayName": "Cyble Vision Alerts TOR Links",
                "enabled": false,
                "query": "Alerts_tor_links \n| where Service == \"tor_links\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "ResourceDevelopment",
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1583",
                  "T1590",
                  "T1595"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "TL_TorUrl",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "Domain",
                        "identifier": "DomainName"
                      }
                    ],
                    "entityType": "DNS"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "SearchEngine": "Search_Engine",
                  "Status": "Status",
                  "Tags": "Tags",
                  "Service": "Service",
                  "SearchKeyword": "TL_SearchKeyword",
                  "UpdatedOn": "TL_UpdatedOn",
                  "TOR_Doc": "TL_Doc_Data",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID",
                  "DocId": "TL_Doc_Id"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Tor Link Alert ({{KeywordName}})",
                  "alertDescriptionFormat": "Source {{TL_SearchEngine}}. Tor URL {{TL_TorUrl}}. Description {{Description}}\"\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject41').analyticRuleId41,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 41",
                "parentId": "[variables('analyticRuleObject41').analyticRuleId41]",
                "contentId": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject41').analyticRuleVersion41]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts TOR Links",
        "contentProductId": "[variables('analyticRuleObject41')._analyticRulecontentProductId41]",
        "id": "[variables('analyticRuleObject41')._analyticRulecontentProductId41]",
        "version": "[variables('analyticRuleObject41').analyticRuleVersion41]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject42').analyticRuleTemplateSpecName42]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Vulnerability_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject42').analyticRuleVersion42]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects SSL/TLS and application vulnerabilities from CybleVision. Extracts host, IP, port, severity, vulnerability ID and first-seen metadata using the Alerts_Vulnerability parser. Incidents grouped per service.",
                "displayName": "Cyble Vision Alerts Vulnerability",
                "enabled": false,
                "query": "Alerts_vulnerability \n| where Service == \"vulnerability\" \n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance",
                  "Execution",
                  "Discovery"
                ],
                "techniques": [
                  "T1595",
                  "T1203",
                  "T1046"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "V_Host",
                        "identifier": "HostName"
                      }
                    ],
                    "entityType": "Host"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "V_IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "Service": "Service",
                  "V_Confidence": "V_Confidence",
                  "Status": "Status",
                  "V_VulnID": "V_VulnID",
                  "V_Port": "V_Port",
                  "Title": "V_Title",
                  "V_LastSeen": "V_LastSeen",
                  "V_Type": "V_Type",
                  "V_FirstSeen": "V_FirstSeen",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID"
                },
                "alertDetailsOverride": {
                  "alertDynamicProperties": [],
                  "alertDisplayNameFormat": "CybleVision Vulnerability {{V_Title}}",
                  "alertDescriptionFormat": "A vulnerability was detected for host {{V_Host}} (IP {{V_IP}}, Port {{V_Port}}).\n"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject42').analyticRuleId42,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 42",
                "parentId": "[variables('analyticRuleObject42').analyticRuleId42]",
                "contentId": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject42').analyticRuleVersion42]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Vulnerability",
        "contentProductId": "[variables('analyticRuleObject42')._analyticRulecontentProductId42]",
        "id": "[variables('analyticRuleObject42')._analyticRulecontentProductId42]",
        "version": "[variables('analyticRuleObject42').analyticRuleVersion42]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject43').analyticRuleTemplateSpecName43]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_Web_Applications_AnalyticalRules Analytics Rule with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject43').analyticRuleVersion43]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Creates an incident for each discovered or exposed web application detected by Cyble Intelligence. Useful for SOC teams to investigate externally facing login portals, misconfigurations, and exposed infrastructure.",
                "displayName": "Cyble Vision Alerts Cyble Web Applications",
                "enabled": false,
                "query": "Alerts_web_applications\n| where Service == \"web_applications\"\n| extend MappedSeverity = Severity\n",
                "queryFrequency": "PT30M",
                "queryPeriod": "PT30M",
                "severity": "Low",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CybleVisionAlerts_CL"
                    ],
                    "connectorId": "CybleVisionAlerts"
                  }
                ],
                "tactics": [
                  "Reconnaissance"
                ],
                "techniques": [
                  "T1595",
                  "T1592"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "columnName": "WA_URL",
                        "identifier": "Url"
                      }
                    ],
                    "entityType": "URL"
                  },
                  {
                    "fieldMappings": [
                      {
                        "columnName": "IP",
                        "identifier": "Address"
                      }
                    ],
                    "entityType": "IP"
                  }
                ],
                "eventGroupingSettings": {
                  "aggregationKind": "AlertPerResult"
                },
                "customDetails": {
                  "DetectedURL": "WA_URL",
                  "Service": "Service",
                  "Status": "Status",
                  "Host": "WA_Host_Nested",
                  "Title": "WA_Title_Nested",
                  "MappedSeverity": "Severity",
                  "AlertID": "AlertID"
                },
                "alertDetailsOverride": {
                  "alertDescriptionFormat": "A web application was detected by Cyble Intelligence.\nHost {{WA_Host_Nested}}\nPort {{WA_Port_Nested}}\nURL {{WA_URL}}\n",
                  "alertDisplayNameFormat": "Cyble Web Application Found  {{WA_Title_Nested}}"
                },
                "incidentConfiguration": {
                  "createIncident": true,
                  "groupingConfiguration": {
                    "matchingMethod": "AllEntities",
                    "reopenClosedIncident": false,
                    "enabled": false,
                    "lookbackDuration": "PT5H"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject43').analyticRuleId43,'/'))))]",
              "properties": {
                "description": "Cyble Vision Analytics Rule 43",
                "parentId": "[variables('analyticRuleObject43').analyticRuleId43]",
                "contentId": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject43').analyticRuleVersion43]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
        "contentKind": "AnalyticsRule",
        "displayName": "Cyble Vision Alerts Cyble Web Applications",
        "contentProductId": "[variables('analyticRuleObject43')._analyticRulecontentProductId43]",
        "id": "[variables('analyticRuleObject43')._analyticRulecontentProductId43]",
        "version": "[variables('analyticRuleObject43').analyticRuleVersion43]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject1').parserTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_advisory Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject1').parserVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject1')._parserName1]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Advisory alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_advisory",
                "query": "CybleVisionAlerts_CL\n | where Service == \"advisory\"\n | extend MappedSeverity = Severity\n // Normalize inner payload (handles numeric or object)\n | extend Data = parse_json(Data)\n | extend Data = (Data.data)\n // Extract advisory value (stringsafe)\n | extend\n     ADV_Value = tostring(Data)\n // Pack risk score (same as other parsers)\n | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n // Final projection (standardized across parsers)\n | project\n     TimeGenerated,\n     AlertID = tostring(ID),\n     EntityID,\n     KeywordName,\n     CompanyID,\n     Status,\n     Severity,\n     UserSeverity,\n     BucketID,\n     Domain,\n     BucketName,\n     TruePositive,\n     LLMProcessed,\n     LLMExplanation,\n     IP,\n     Service,\n     Risk_Score,\n     // Advisory fields\n     ADV_Value,\n     // Raw parsed object\n     Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
              "dependsOn": [
                "[variables('parserObject1')._parserId1]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_advisory')]",
                "contentId": "[variables('parserObject1').parserContentId1]",
                "kind": "Parser",
                "version": "[variables('parserObject1').parserVersion1]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Advisory alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "version": "[variables('parserObject1').parserVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject1')._parserName1]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Advisory alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_advisory",
        "query": "CybleVisionAlerts_CL\n | where Service == \"advisory\"\n | extend MappedSeverity = Severity\n // Normalize inner payload (handles numeric or object)\n | extend Data = parse_json(Data)\n | extend Data = (Data.data)\n // Extract advisory value (stringsafe)\n | extend\n     ADV_Value = tostring(Data)\n // Pack risk score (same as other parsers)\n | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n // Final projection (standardized across parsers)\n | project\n     TimeGenerated,\n     AlertID = tostring(ID),\n     EntityID,\n     KeywordName,\n     CompanyID,\n     Status,\n     Severity,\n     UserSeverity,\n     BucketID,\n     Domain,\n     BucketName,\n     TruePositive,\n     LLMProcessed,\n     LLMExplanation,\n     IP,\n     Service,\n     Risk_Score,\n     // Advisory fields\n     ADV_Value,\n     // Raw parsed object\n     Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
      "dependsOn": [
        "[variables('parserObject1')._parserId1]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_advisory')]",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "kind": "Parser",
        "version": "[variables('parserObject1').parserVersion1]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject2').parserTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_assets Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject2').parserVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject2')._parserName2]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Bit Bucket alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_assets",
                "query": "CybleVisionAlerts_CL\n| where Service == \"assets\"\n| extend MappedSeverity = Severity\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n// Parse the inner Data (Data.data)\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract inner fields safely\n| extend\n    AA_KeywordID          = tostring(Data.keyword_id),\n    AA_LastDetected       = tostring(Data.last_detected_at),\n    AA_Value              = tostring(Data.value)\n// Project cleaned output + original fields if needed\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    AA_KeywordID,\n    AA_LastDetected,\n    AA_Value\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
              "dependsOn": [
                "[variables('parserObject2')._parserId2]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_assets')]",
                "contentId": "[variables('parserObject2').parserContentId2]",
                "kind": "Parser",
                "version": "[variables('parserObject2').parserVersion2]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Bit Bucket alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '1.0.0')))]",
        "version": "[variables('parserObject2').parserVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject2')._parserName2]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Bit Bucket alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_assets",
        "query": "CybleVisionAlerts_CL\n| where Service == \"assets\"\n| extend MappedSeverity = Severity\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n// Parse the inner Data (Data.data)\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract inner fields safely\n| extend\n    AA_KeywordID          = tostring(Data.keyword_id),\n    AA_LastDetected       = tostring(Data.last_detected_at),\n    AA_Value              = tostring(Data.value)\n// Project cleaned output + original fields if needed\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    AA_KeywordID,\n    AA_LastDetected,\n    AA_Value\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
      "dependsOn": [
        "[variables('parserObject2')._parserId2]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_assets')]",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "kind": "Parser",
        "version": "[variables('parserObject2').parserVersion2]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject3').parserTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_bit_bucket Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject3').parserVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject3')._parserName3]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Bit Bucket alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_bit_bucket",
                "query": "CybleVisionAlerts_CL\n| where Service == \"bit_bucket\"\n| extend MappedSeverity = Severity\n// Parse the outer data array\n| extend Data = parse_json(Data)\n| extend DataArray = (Data.data)\n// Expand each secret finding into its own row\n| mv-expand Entry = DataArray\n// Extract Bitbucket level fields\n| extend\n    BB_DecoderName   = tostring(Entry.DecoderName),\n    BB_DetectorName  = tostring(Entry.DetectorName),\n    BB_DetectorType  = tostring(Entry.DetectorType),\n    BB_Raw           = tostring(Entry.Raw),\n    BB_Verified      = tostring(Entry.Verified),\n    BB_SourceName    = tostring(Entry.SourceName),\n    BB_SourceType    = tostring(Entry.SourceType),\n    BB_Timestamp     = tostring(Entry.ts),\n    // ExtraData fields (optional)\n    BB_RotationGuide = tostring(Entry.ExtraData.rotation_guide),\n    // SourceMetadata Bitbucket tree\n    BB_Commit        = tostring(Entry.SourceMetadata.Data.Bitbucket.commit),\n    BB_Email         = tostring(Entry.SourceMetadata.Data.Bitbucket.email),\n    BB_File          = tostring(Entry.SourceMetadata.Data.Bitbucket.file),\n    BB_Line          = tostring(Entry.SourceMetadata.Data.Bitbucket.line),\n    BB_Link          = tostring(Entry.SourceMetadata.Data.Bitbucket.link),\n    BB_Repository    = tostring(Entry.SourceMetadata.Data.Bitbucket.repository),\n    BB_RepoTimestamp = tostring(Entry.SourceMetadata.Data.Bitbucket.timestamp)\n// Pack risk score like your other parsers  \n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (same structure as all your parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Bitbucket secret fields\n    BB_DecoderName,\n    BB_DetectorName,\n    BB_DetectorType,\n    BB_Raw,\n    BB_Verified,\n    BB_SourceName,\n    BB_SourceType,\n    BB_Timestamp,\n    BB_RotationGuide,\n    BB_Commit,\n    BB_Email,\n    BB_File,\n    BB_Line,\n    BB_Link,\n    BB_Repository,\n    BB_RepoTimestamp,\n    Entry\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
              "dependsOn": [
                "[variables('parserObject3')._parserId3]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_bit_bucket')]",
                "contentId": "[variables('parserObject3').parserContentId3]",
                "kind": "Parser",
                "version": "[variables('parserObject3').parserVersion3]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Bit Bucket alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "version": "[variables('parserObject3').parserVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject3')._parserName3]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Bit Bucket alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_bit_bucket",
        "query": "CybleVisionAlerts_CL\n| where Service == \"bit_bucket\"\n| extend MappedSeverity = Severity\n// Parse the outer data array\n| extend Data = parse_json(Data)\n| extend DataArray = (Data.data)\n// Expand each secret finding into its own row\n| mv-expand Entry = DataArray\n// Extract Bitbucket level fields\n| extend\n    BB_DecoderName   = tostring(Entry.DecoderName),\n    BB_DetectorName  = tostring(Entry.DetectorName),\n    BB_DetectorType  = tostring(Entry.DetectorType),\n    BB_Raw           = tostring(Entry.Raw),\n    BB_Verified      = tostring(Entry.Verified),\n    BB_SourceName    = tostring(Entry.SourceName),\n    BB_SourceType    = tostring(Entry.SourceType),\n    BB_Timestamp     = tostring(Entry.ts),\n    // ExtraData fields (optional)\n    BB_RotationGuide = tostring(Entry.ExtraData.rotation_guide),\n    // SourceMetadata Bitbucket tree\n    BB_Commit        = tostring(Entry.SourceMetadata.Data.Bitbucket.commit),\n    BB_Email         = tostring(Entry.SourceMetadata.Data.Bitbucket.email),\n    BB_File          = tostring(Entry.SourceMetadata.Data.Bitbucket.file),\n    BB_Line          = tostring(Entry.SourceMetadata.Data.Bitbucket.line),\n    BB_Link          = tostring(Entry.SourceMetadata.Data.Bitbucket.link),\n    BB_Repository    = tostring(Entry.SourceMetadata.Data.Bitbucket.repository),\n    BB_RepoTimestamp = tostring(Entry.SourceMetadata.Data.Bitbucket.timestamp)\n// Pack risk score like your other parsers  \n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (same structure as all your parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Bitbucket secret fields\n    BB_DecoderName,\n    BB_DetectorName,\n    BB_DetectorType,\n    BB_Raw,\n    BB_Verified,\n    BB_SourceName,\n    BB_SourceType,\n    BB_Timestamp,\n    BB_RotationGuide,\n    BB_Commit,\n    BB_Email,\n    BB_File,\n    BB_Line,\n    BB_Link,\n    BB_Repository,\n    BB_RepoTimestamp,\n    Entry\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
      "dependsOn": [
        "[variables('parserObject3')._parserId3]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_bit_bucket')]",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "kind": "Parser",
        "version": "[variables('parserObject3').parserVersion3]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject4').parserTemplateSpecName4]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_cloud_storage Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject4').parserVersion4]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject4')._parserName4]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Cloud Storage alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_cloud_storage",
                "query": "CybleVisionAlerts_CL\n| where Service == \"cloud_storage\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend Data = Data.data\n// extract cloud storage fields (CS_ prefix)\n| extend\n    CS_Bucket     = tostring(Data.bucket),\n    CS_BucketId   = tostring(Data.bucketId),\n    CS_Filename   = tostring(Data.filename),\n    CS_FullPath   = tostring(Data.fullPath),\n    CS_ObjectId   = tostring(Data.id),\n    CS_Size       = toint(Data.size),\n    CS_Url        = tostring(Data.url)\n// agentic workflow metadata (top level fields on the alert)\n| extend\n    CS_ProcessedByAgenticAI = tostring(processed_by_agentic_ai),\n    CS_AgenticAIStatus      = tostring(agentic_ai_process_status),\n    CS_WorkflowID           = tostring(workflow_id)\n// final projection keep your standard top level columns first (consistent with other parsers)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // parsed cloud storage specific fields\n    CS_Bucket,\n    CS_BucketId,\n    CS_Filename,\n    CS_FullPath,\n    CS_ObjectId,\n    CS_Size,\n    CS_Url,\n    CS_ProcessedByAgenticAI,\n    CS_AgenticAIStatus,\n    CS_WorkflowID\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject4')._parserId4,'/'))))]",
              "dependsOn": [
                "[variables('parserObject4')._parserId4]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_cloud_storage')]",
                "contentId": "[variables('parserObject4').parserContentId4]",
                "kind": "Parser",
                "version": "[variables('parserObject4').parserVersion4]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject4').parserContentId4]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Cloud Storage alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject4').parserContentId4,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject4').parserContentId4,'-', '1.0.0')))]",
        "version": "[variables('parserObject4').parserVersion4]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject4')._parserName4]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Cloud Storage alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_cloud_storage",
        "query": "CybleVisionAlerts_CL\n| where Service == \"cloud_storage\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend Data = Data.data\n// extract cloud storage fields (CS_ prefix)\n| extend\n    CS_Bucket     = tostring(Data.bucket),\n    CS_BucketId   = tostring(Data.bucketId),\n    CS_Filename   = tostring(Data.filename),\n    CS_FullPath   = tostring(Data.fullPath),\n    CS_ObjectId   = tostring(Data.id),\n    CS_Size       = toint(Data.size),\n    CS_Url        = tostring(Data.url)\n// agentic workflow metadata (top level fields on the alert)\n| extend\n    CS_ProcessedByAgenticAI = tostring(processed_by_agentic_ai),\n    CS_AgenticAIStatus      = tostring(agentic_ai_process_status),\n    CS_WorkflowID           = tostring(workflow_id)\n// final projection keep your standard top level columns first (consistent with other parsers)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // parsed cloud storage specific fields\n    CS_Bucket,\n    CS_BucketId,\n    CS_Filename,\n    CS_FullPath,\n    CS_ObjectId,\n    CS_Size,\n    CS_Url,\n    CS_ProcessedByAgenticAI,\n    CS_AgenticAIStatus,\n    CS_WorkflowID\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject4')._parserId4,'/'))))]",
      "dependsOn": [
        "[variables('parserObject4')._parserId4]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_cloud_storage')]",
        "contentId": "[variables('parserObject4').parserContentId4]",
        "kind": "Parser",
        "version": "[variables('parserObject4').parserVersion4]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject5').parserTemplateSpecName5]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_compromised_endpoints_cookies Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject5').parserVersion5]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject5')._parserName5]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Compromised Endpoints Cookies alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_compromised_endpoints_cookies",
                "query": "CybleVisionAlerts_CL\n  | where Service == \"compromised_endpoints_cookies\"\n  // Parse toplevel data object\n  | extend Data = parse_json(Data)\n  // Extract nested content object\n  | extend Content = Data.content\n  // Cookie Data convert singlequoted Python dict to valid JSON\n  | extend RawCookieData = tostring(Content.[\"Cookie Data\"])\n  | extend CookieJsonString = replace(\"'\", '\"', RawCookieData)\n  | extend CEC_Cookie = parse_json(CookieJsonString)\n  // Extract cookie fields\n  | extend\n      CEC_Email           = tostring(CEC_Cookie.email),\n      CEC_EmailDomain     = tostring(CEC_Cookie.emailDomain),\n      CEC_SessionID       = tostring(CEC_Cookie.sessionId),\n      CEC_Issuer          = tostring(CEC_Cookie.iss),\n      CEC_Audience        = tostring(CEC_Cookie.aud),\n      CEC_Subject         = tostring(CEC_Cookie.sub),\n      CEC_JTI             = tostring(CEC_Cookie.jti),\n      CEC_Exp             = tostring(CEC_Cookie.exp),\n      CEC_IAT             = tostring(CEC_Cookie.iat),\n      CEC_NBF             = tostring(CEC_Cookie.nbf),\n      CEC_Verified        = tostring(CEC_Cookie.verified),\n      CEC_RefreshTimeout  = tostring(CEC_Cookie.refreshTimeout)\n  // Additional extracted fields\n  | extend\n      CEC_URL             = tostring(Content.URL),\n      CEC_Expiry          = tostring(Content.Expiry),\n      CEC_Filename        = tostring(Data.filename),\n      CEC_CreatedOn       = tostring(Data.created_on),\n      CEC_UpdatedOn       = tostring(Data.updated_on),\n      CEC_SourceID        = tostring(Data.source_id),\n      CEC_S3Key           = tostring(Data.s3_key),\n      CEC_TA              = tostring(Data.ta),\n      CEC_ParentFolderID  = tostring(Data.parent_folder_path_id),\n      CEC_Meta_FileName   = tostring(Data.['meta-data'].file_name),\n      CEC_Meta_FilePath   = tostring(Data.['meta-data'].file_path),\n      CEC_Meta_FileSize   = tostring(Data.['meta-data'].file_size),\n      CEC_Meta_Created    = tostring(Data.['meta-data'].c_date),\n      CEC_Meta_Modified   = tostring(Data.['meta-data'].m_date)\n  // Risk Score Pack (your standard)\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  // FINAL projection (same structure as all your parsers)\n  | project\n      TimeGenerated,\n      AlertID = tostring(ID),\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      // Compromised Cookies fields\n      CEC_URL,\n      CEC_Expiry,\n      CEC_Email,\n      CEC_EmailDomain,\n      CEC_SessionID,\n      CEC_Issuer,\n      CEC_Audience,\n      CEC_Subject,\n      CEC_JTI,\n      CEC_Exp,\n      CEC_IAT,\n      CEC_NBF,\n      CEC_Verified,\n      CEC_RefreshTimeout,\n      CEC_Filename,\n      CEC_CreatedOn,\n      CEC_UpdatedOn,\n      CEC_SourceID,\n      CEC_S3Key,\n      CEC_TA,\n      CEC_ParentFolderID,\n      CEC_Meta_FileName,\n      CEC_Meta_FilePath,\n      CEC_Meta_FileSize,\n      CEC_Meta_Created,\n      CEC_Meta_Modified,\n      // raw parsed content\n      Data,\n      CEC_Cookie\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject5')._parserId5,'/'))))]",
              "dependsOn": [
                "[variables('parserObject5')._parserId5]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_compromised_endpoints_cookies')]",
                "contentId": "[variables('parserObject5').parserContentId5]",
                "kind": "Parser",
                "version": "[variables('parserObject5').parserVersion5]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject5').parserContentId5]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Compromised Endpoints Cookies alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject5').parserContentId5,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject5').parserContentId5,'-', '1.0.0')))]",
        "version": "[variables('parserObject5').parserVersion5]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject5')._parserName5]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Compromised Endpoints Cookies alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_compromised_endpoints_cookies",
        "query": "CybleVisionAlerts_CL\n  | where Service == \"compromised_endpoints_cookies\"\n  // Parse toplevel data object\n  | extend Data = parse_json(Data)\n  // Extract nested content object\n  | extend Content = Data.content\n  // Cookie Data convert singlequoted Python dict to valid JSON\n  | extend RawCookieData = tostring(Content.[\"Cookie Data\"])\n  | extend CookieJsonString = replace(\"'\", '\"', RawCookieData)\n  | extend CEC_Cookie = parse_json(CookieJsonString)\n  // Extract cookie fields\n  | extend\n      CEC_Email           = tostring(CEC_Cookie.email),\n      CEC_EmailDomain     = tostring(CEC_Cookie.emailDomain),\n      CEC_SessionID       = tostring(CEC_Cookie.sessionId),\n      CEC_Issuer          = tostring(CEC_Cookie.iss),\n      CEC_Audience        = tostring(CEC_Cookie.aud),\n      CEC_Subject         = tostring(CEC_Cookie.sub),\n      CEC_JTI             = tostring(CEC_Cookie.jti),\n      CEC_Exp             = tostring(CEC_Cookie.exp),\n      CEC_IAT             = tostring(CEC_Cookie.iat),\n      CEC_NBF             = tostring(CEC_Cookie.nbf),\n      CEC_Verified        = tostring(CEC_Cookie.verified),\n      CEC_RefreshTimeout  = tostring(CEC_Cookie.refreshTimeout)\n  // Additional extracted fields\n  | extend\n      CEC_URL             = tostring(Content.URL),\n      CEC_Expiry          = tostring(Content.Expiry),\n      CEC_Filename        = tostring(Data.filename),\n      CEC_CreatedOn       = tostring(Data.created_on),\n      CEC_UpdatedOn       = tostring(Data.updated_on),\n      CEC_SourceID        = tostring(Data.source_id),\n      CEC_S3Key           = tostring(Data.s3_key),\n      CEC_TA              = tostring(Data.ta),\n      CEC_ParentFolderID  = tostring(Data.parent_folder_path_id),\n      CEC_Meta_FileName   = tostring(Data.['meta-data'].file_name),\n      CEC_Meta_FilePath   = tostring(Data.['meta-data'].file_path),\n      CEC_Meta_FileSize   = tostring(Data.['meta-data'].file_size),\n      CEC_Meta_Created    = tostring(Data.['meta-data'].c_date),\n      CEC_Meta_Modified   = tostring(Data.['meta-data'].m_date)\n  // Risk Score Pack (your standard)\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  // FINAL projection (same structure as all your parsers)\n  | project\n      TimeGenerated,\n      AlertID = tostring(ID),\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      // Compromised Cookies fields\n      CEC_URL,\n      CEC_Expiry,\n      CEC_Email,\n      CEC_EmailDomain,\n      CEC_SessionID,\n      CEC_Issuer,\n      CEC_Audience,\n      CEC_Subject,\n      CEC_JTI,\n      CEC_Exp,\n      CEC_IAT,\n      CEC_NBF,\n      CEC_Verified,\n      CEC_RefreshTimeout,\n      CEC_Filename,\n      CEC_CreatedOn,\n      CEC_UpdatedOn,\n      CEC_SourceID,\n      CEC_S3Key,\n      CEC_TA,\n      CEC_ParentFolderID,\n      CEC_Meta_FileName,\n      CEC_Meta_FilePath,\n      CEC_Meta_FileSize,\n      CEC_Meta_Created,\n      CEC_Meta_Modified,\n      // raw parsed content\n      Data,\n      CEC_Cookie\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject5')._parserId5,'/'))))]",
      "dependsOn": [
        "[variables('parserObject5')._parserId5]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_compromised_endpoints_cookies')]",
        "contentId": "[variables('parserObject5').parserContentId5]",
        "kind": "Parser",
        "version": "[variables('parserObject5').parserVersion5]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject6').parserTemplateSpecName6]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_compromised_files Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject6').parserVersion6]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject6')._parserName6]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Compromised Files alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_compromised_files",
                "query": "CybleVisionAlerts_CL\n| where Service == \"compromised_files\"\n// Parse inner object\n| extend Data = parse_json(Data)\n// Extract top level compromised file fields\n| extend\n    CF_CompromisedOn   = tostring(Data.compromised_on),\n    CF_Content         = tostring(Data.content),\n    CF_CreatedOn       = tostring(Data.created_on),\n    CF_DocId           = tostring(Data.doc_id),\n    CF_FileObjPath     = tostring(Data.file_obj_path),\n    CF_LogName         = tostring(Data.log_name),\n    CF_LogObjPath      = tostring(Data.log_obj_path),\n    CF_RelativePath    = tostring(Data.relative_path),\n    // meta_data sub object\n    CF_Meta_FileName   = tostring(Data.meta_data.file_name),\n    CF_Meta_FilePath   = tostring(Data.meta_data.file_path),\n    CF_Meta_FileSize   = tostring(Data.meta_data.file_size),\n    CF_Meta_Created    = tostring(Data.meta_data.c_date),\n    CF_Meta_Modified   = tostring(Data.meta_data.m_date)\n// Extract URLs\n| extend CF_Parsed_URLs = extract_all(@\"(URL:\\s*([^\\s]+))\", CF_Content)\n// Extract USERNAME fields\n| extend CF_Parsed_Usernames = extract_all(@\"(USERNAME:\\s*([^\\s]+))\", CF_Content)\n// Extract PASSWORD fields\n| extend CF_Parsed_Passwords = extract_all(@\"(PASSWORD:\\s*([^\\s]+))\", CF_Content)\n// Extract first usable values for entity mapping\n| extend\n    CF_FirstURL       = tostring(CF_Parsed_URLs[0]),\n    CF_FirstUsername  = tostring(CF_Parsed_Usernames[0]),\n    CF_FirstPassword  = tostring(CF_Parsed_Passwords[0])\n// Also extract emails from content\n| extend CF_Emails = extract_all(@\"\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\\b\", CF_Content)\n| extend CF_PrimaryEmail = tostring(CF_Emails[0])\n// Risk Score Pack (your standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection same structure as your other parsers\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // compromised_files specific fields\n    Filename,\n    Extension,\n    Compromised_Date,\n    CF_CompromisedOn,\n    CF_CreatedOn,\n    CF_DocId,\n    CF_FileObjPath,\n    CF_LogName,\n    CF_LogObjPath,\n    CF_RelativePath,\n    CF_Meta_FileName,\n    CF_Meta_FilePath,\n    CF_Meta_FileSize,\n    CF_Meta_Created,\n    CF_Meta_Modified,\n    CF_Content,\n    // Parsed credentials\n    CF_Parsed_URLs,\n    CF_Parsed_Usernames,\n    CF_Parsed_Passwords,\n    CF_FirstURL,\n    CF_FirstUsername,\n    CF_FirstPassword,\n    CF_Emails,\n    CF_PrimaryEmail,\n    // raw parsed object\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject6')._parserId6,'/'))))]",
              "dependsOn": [
                "[variables('parserObject6')._parserId6]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_compromised_files')]",
                "contentId": "[variables('parserObject6').parserContentId6]",
                "kind": "Parser",
                "version": "[variables('parserObject6').parserVersion6]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject6').parserContentId6]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Compromised Files alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject6').parserContentId6,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject6').parserContentId6,'-', '1.0.0')))]",
        "version": "[variables('parserObject6').parserVersion6]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject6')._parserName6]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Compromised Files alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_compromised_files",
        "query": "CybleVisionAlerts_CL\n| where Service == \"compromised_files\"\n// Parse inner object\n| extend Data = parse_json(Data)\n// Extract top level compromised file fields\n| extend\n    CF_CompromisedOn   = tostring(Data.compromised_on),\n    CF_Content         = tostring(Data.content),\n    CF_CreatedOn       = tostring(Data.created_on),\n    CF_DocId           = tostring(Data.doc_id),\n    CF_FileObjPath     = tostring(Data.file_obj_path),\n    CF_LogName         = tostring(Data.log_name),\n    CF_LogObjPath      = tostring(Data.log_obj_path),\n    CF_RelativePath    = tostring(Data.relative_path),\n    // meta_data sub object\n    CF_Meta_FileName   = tostring(Data.meta_data.file_name),\n    CF_Meta_FilePath   = tostring(Data.meta_data.file_path),\n    CF_Meta_FileSize   = tostring(Data.meta_data.file_size),\n    CF_Meta_Created    = tostring(Data.meta_data.c_date),\n    CF_Meta_Modified   = tostring(Data.meta_data.m_date)\n// Extract URLs\n| extend CF_Parsed_URLs = extract_all(@\"(URL:\\s*([^\\s]+))\", CF_Content)\n// Extract USERNAME fields\n| extend CF_Parsed_Usernames = extract_all(@\"(USERNAME:\\s*([^\\s]+))\", CF_Content)\n// Extract PASSWORD fields\n| extend CF_Parsed_Passwords = extract_all(@\"(PASSWORD:\\s*([^\\s]+))\", CF_Content)\n// Extract first usable values for entity mapping\n| extend\n    CF_FirstURL       = tostring(CF_Parsed_URLs[0]),\n    CF_FirstUsername  = tostring(CF_Parsed_Usernames[0]),\n    CF_FirstPassword  = tostring(CF_Parsed_Passwords[0])\n// Also extract emails from content\n| extend CF_Emails = extract_all(@\"\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\\b\", CF_Content)\n| extend CF_PrimaryEmail = tostring(CF_Emails[0])\n// Risk Score Pack (your standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection same structure as your other parsers\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // compromised_files specific fields\n    Filename,\n    Extension,\n    Compromised_Date,\n    CF_CompromisedOn,\n    CF_CreatedOn,\n    CF_DocId,\n    CF_FileObjPath,\n    CF_LogName,\n    CF_LogObjPath,\n    CF_RelativePath,\n    CF_Meta_FileName,\n    CF_Meta_FilePath,\n    CF_Meta_FileSize,\n    CF_Meta_Created,\n    CF_Meta_Modified,\n    CF_Content,\n    // Parsed credentials\n    CF_Parsed_URLs,\n    CF_Parsed_Usernames,\n    CF_Parsed_Passwords,\n    CF_FirstURL,\n    CF_FirstUsername,\n    CF_FirstPassword,\n    CF_Emails,\n    CF_PrimaryEmail,\n    // raw parsed object\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject6')._parserId6,'/'))))]",
      "dependsOn": [
        "[variables('parserObject6')._parserId6]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_compromised_files')]",
        "contentId": "[variables('parserObject6').parserContentId6]",
        "kind": "Parser",
        "version": "[variables('parserObject6').parserVersion6]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject7').parserTemplateSpecName7]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_cyber_crime_forums Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject7').parserVersion7]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject7')._parserName7]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Cyber Crime Forums alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_cyber_crime_forums",
                "query": "CybleVisionAlerts_CL\n  | where Service == \"cyber_crime_forums\"\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  | extend AlertID = ID\n  | extend Data = parse_json(Data)\n  // Extract discussion metadata (root level)\n  | extend\n      CF_DiscussionDate      = tostring(Discussion_Date),\n      CF_DiscussionBy        = tostring(Discussion_By),\n      CF_SourceName          = tostring(Source_Name),\n      CF_TopicName           = tostring(Topic_Name)\n  // Extract nested data fields\n  | extend D = Data\n  | extend\n      CF_CategoryID          = tostring(D.category_id),\n      CF_DiscussionBy2       = tostring(D.discussion_by),\n      CF_Content             = tostring(D.discussion_content),\n      CF_DiscussionDate2     = tostring(D.discussion_date),\n      CF_DiscussionID        = tostring(D.discussion_id),\n      CF_JoinedDate          = tostring(D.joined_dated),\n      CF_Likes               = tostring(D.likes),\n      CF_NumberOfPosts       = tostring(D.number_of_post),\n      CF_Reputation          = tostring(D.reputation),\n      CF_TopicCreatedBy      = tostring(D.topic_created_by),\n      CF_TopicID             = tostring(D.topic_id),\n      CF_TopicName2          = tostring(D.topic_name),\n      CF_TopicURL            = tostring(D.topic_url),\n      CF_UpdatedOn           = tostring(D.updated_on)\n  // Extract URLs inside content\n  | extend CF_Urls = extract_all(@\"(https?://[^\\s]+)\", CF_Content)\n  // Extract phone numbers\n  | extend CF_Phones = extract_all(@\"(\\+?\\d[\\d\\-\\s]{6,}\\d)\", CF_Content)\n  // Extract emails\n  | extend CF_Emails = extract_all(@\"([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,})\", CF_Content)\n  // Tags\n  | extend CF_Tags = tostring(Tags)\n  | project\n      TimeGenerated,\n      AlertID,\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      CF_DiscussionDate,\n      CF_DiscussionBy,\n      CF_SourceName,\n      CF_TopicName,\n      CF_CategoryID,\n      CF_DiscussionBy2,\n      CF_Content,\n      CF_DiscussionDate2,\n      CF_DiscussionID,\n      CF_JoinedDate,\n      CF_Likes,\n      CF_NumberOfPosts,\n      CF_Reputation,\n      CF_TopicCreatedBy,\n      CF_TopicID,\n      CF_TopicName2,\n      CF_TopicURL,\n      CF_UpdatedOn,\n      CF_Urls,\n      CF_Phones,\n      CF_Emails,\n      CF_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject7')._parserId7,'/'))))]",
              "dependsOn": [
                "[variables('parserObject7')._parserId7]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_cyber_crime_forums')]",
                "contentId": "[variables('parserObject7').parserContentId7]",
                "kind": "Parser",
                "version": "[variables('parserObject7').parserVersion7]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject7').parserContentId7]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Cyber Crime Forums alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject7').parserContentId7,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject7').parserContentId7,'-', '1.0.0')))]",
        "version": "[variables('parserObject7').parserVersion7]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject7')._parserName7]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Cyber Crime Forums alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_cyber_crime_forums",
        "query": "CybleVisionAlerts_CL\n  | where Service == \"cyber_crime_forums\"\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  | extend AlertID = ID\n  | extend Data = parse_json(Data)\n  // Extract discussion metadata (root level)\n  | extend\n      CF_DiscussionDate      = tostring(Discussion_Date),\n      CF_DiscussionBy        = tostring(Discussion_By),\n      CF_SourceName          = tostring(Source_Name),\n      CF_TopicName           = tostring(Topic_Name)\n  // Extract nested data fields\n  | extend D = Data\n  | extend\n      CF_CategoryID          = tostring(D.category_id),\n      CF_DiscussionBy2       = tostring(D.discussion_by),\n      CF_Content             = tostring(D.discussion_content),\n      CF_DiscussionDate2     = tostring(D.discussion_date),\n      CF_DiscussionID        = tostring(D.discussion_id),\n      CF_JoinedDate          = tostring(D.joined_dated),\n      CF_Likes               = tostring(D.likes),\n      CF_NumberOfPosts       = tostring(D.number_of_post),\n      CF_Reputation          = tostring(D.reputation),\n      CF_TopicCreatedBy      = tostring(D.topic_created_by),\n      CF_TopicID             = tostring(D.topic_id),\n      CF_TopicName2          = tostring(D.topic_name),\n      CF_TopicURL            = tostring(D.topic_url),\n      CF_UpdatedOn           = tostring(D.updated_on)\n  // Extract URLs inside content\n  | extend CF_Urls = extract_all(@\"(https?://[^\\s]+)\", CF_Content)\n  // Extract phone numbers\n  | extend CF_Phones = extract_all(@\"(\\+?\\d[\\d\\-\\s]{6,}\\d)\", CF_Content)\n  // Extract emails\n  | extend CF_Emails = extract_all(@\"([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,})\", CF_Content)\n  // Tags\n  | extend CF_Tags = tostring(Tags)\n  | project\n      TimeGenerated,\n      AlertID,\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      CF_DiscussionDate,\n      CF_DiscussionBy,\n      CF_SourceName,\n      CF_TopicName,\n      CF_CategoryID,\n      CF_DiscussionBy2,\n      CF_Content,\n      CF_DiscussionDate2,\n      CF_DiscussionID,\n      CF_JoinedDate,\n      CF_Likes,\n      CF_NumberOfPosts,\n      CF_Reputation,\n      CF_TopicCreatedBy,\n      CF_TopicID,\n      CF_TopicName2,\n      CF_TopicURL,\n      CF_UpdatedOn,\n      CF_Urls,\n      CF_Phones,\n      CF_Emails,\n      CF_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject7')._parserId7,'/'))))]",
      "dependsOn": [
        "[variables('parserObject7')._parserId7]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_cyber_crime_forums')]",
        "contentId": "[variables('parserObject7').parserContentId7]",
        "kind": "Parser",
        "version": "[variables('parserObject7').parserVersion7]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject8').parserTemplateSpecName8]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_darkweb_data_breaches Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject8').parserVersion8]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject8')._parserName8]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract DarkWeb Data Breaches alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_darkweb_data_breaches",
                "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| where Service == \"darkweb_data_breaches\"\n// inner string JSON inside data.data\n| extend BreachRaw = tostring(Data.data)\n| extend BreachObj = parse_json(BreachRaw)\n// Extract fields from BreachObj\n| extend\n    DB_Username          = tostring(BreachObj.username),\n    DB_Email             = tostring(BreachObj.email),\n    DB_PasswordHash      = tostring(BreachObj.password_hash),\n    DB_RegistrationDate  = tostring(BreachObj.registration_date),\n    DB_DisplayName       = tostring(BreachObj.display_name)\n// Extract other metadata in Data{}\n| extend\n    DB_Date              = tostring(Data.['date']),\n    DB_S3Key             = tostring(Data.s3_key),\n    DB_Structured        = tostring(Data.structured)\n// Tags[]\n| extend\n    DB_Tags = tostring(Data.tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    Breach_Source,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    DB_Username,\n    DB_Email,\n    DB_PasswordHash,\n    DB_RegistrationDate,\n    DB_DisplayName,\n    DB_Date,\n    DB_S3Key,\n    DB_Structured,\n    DB_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject8')._parserId8,'/'))))]",
              "dependsOn": [
                "[variables('parserObject8')._parserId8]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_data_breaches')]",
                "contentId": "[variables('parserObject8').parserContentId8]",
                "kind": "Parser",
                "version": "[variables('parserObject8').parserVersion8]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject8').parserContentId8]",
        "contentKind": "Parser",
        "displayName": "Parser to extract DarkWeb Data Breaches alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject8').parserContentId8,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject8').parserContentId8,'-', '1.0.0')))]",
        "version": "[variables('parserObject8').parserVersion8]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject8')._parserName8]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract DarkWeb Data Breaches alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_darkweb_data_breaches",
        "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| where Service == \"darkweb_data_breaches\"\n// inner string JSON inside data.data\n| extend BreachRaw = tostring(Data.data)\n| extend BreachObj = parse_json(BreachRaw)\n// Extract fields from BreachObj\n| extend\n    DB_Username          = tostring(BreachObj.username),\n    DB_Email             = tostring(BreachObj.email),\n    DB_PasswordHash      = tostring(BreachObj.password_hash),\n    DB_RegistrationDate  = tostring(BreachObj.registration_date),\n    DB_DisplayName       = tostring(BreachObj.display_name)\n// Extract other metadata in Data{}\n| extend\n    DB_Date              = tostring(Data.['date']),\n    DB_S3Key             = tostring(Data.s3_key),\n    DB_Structured        = tostring(Data.structured)\n// Tags[]\n| extend\n    DB_Tags = tostring(Data.tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    Breach_Source,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    DB_Username,\n    DB_Email,\n    DB_PasswordHash,\n    DB_RegistrationDate,\n    DB_DisplayName,\n    DB_Date,\n    DB_S3Key,\n    DB_Structured,\n    DB_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject8')._parserId8,'/'))))]",
      "dependsOn": [
        "[variables('parserObject8')._parserId8]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_data_breaches')]",
        "contentId": "[variables('parserObject8').parserContentId8]",
        "kind": "Parser",
        "version": "[variables('parserObject8').parserVersion8]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject9').parserTemplateSpecName9]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_darkweb_marketplaces Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject9').parserVersion9]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject9')._parserName9]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract DarkWeb Marketplace alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_darkweb_marketplaces",
                "query": "CybleVisionAlerts_CL\n| where Service == \"darkweb_marketplaces\"\n| extend MappedSeverity = Severity\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// Extract BANK Information\n| extend Bank = Data.bank\n| extend\nDW_Bank_BIN            = tostring(Bank.bin),\nDW_Bank_Brand          = tostring(Bank.['card'].brand),\nDW_Bank_CardNo         = tostring(Bank.['card'].card_no),\nDW_Bank_CardType       = tostring(Bank.['card'].card_type),\nDW_Bank_CVR            = tostring(Bank.['card'].cvr),\nDW_Bank_CVV            = tostring(Bank.['card'].cvv),\nDW_Bank_Expiry         = tostring(Bank.['card'].expiry),\nDW_Bank_Level          = tostring(Bank.['card'].level),\nDW_Bank_Country        = tostring(Bank.isocountry),\nDW_Bank_Phone          = tostring(Bank.phone),\nDW_Bank_RealName       = tostring(Bank.real_name),\nDW_Bank_RefName        = tostring(Bank.ref_name),\nDW_Bank_Site           = tostring(Bank.site)\n// Extract general marketplace fields\n| extend\nDW_Marketplace         = tostring(marketplace),\nDW_StealerName         = tostring(stealer),\nDW_ContentUpdatedOn    = tostring(Content_Updated_On),\nDW_Country             = tostring(Data.country),\nDW_Region              = tostring(Data.region),\nDW_Size                = tostring(Data.size),\nDW_Vendor              = tostring(Data.vendor),\nDW_Price               = tostring(Data.price),\nDW_Date                = tostring(Data.['date']),\nDW_OS                  = tostring(Data.os),\nDW_IP                  = tostring(Data.ip),\nDW_Browser             = tostring(Data.browser),\nDW_InstalledDate       = tostring(Data.installed_date),\nDW_CompanyLeaked       = tostring(Data.company_leaked)\n// Extract huge list of links (CSV to array)\n| extend DW_Links = split(tostring(Data.links), \",\")\n// Extract other metadata fields\n| extend\nDW_Outlook             = tostring(Data.outlook),\nDW_Info                = tostring(Data.info),\nDW_RawData             = tostring(Data.raw_data),\nDW_ConfigUpdate        = tostring(Data.config_update),\nDW_Cookies             = tostring(Data.cookies),\nDW_CookiesDate         = tostring(Data.cookies_date),\nDW_UserAgent           = tostring(Data.userAgent),\nDW_UpdatedDate         = tostring(Data.updated_date)\n// Tags\n| extend DW_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    DW_Marketplace,\n    DW_StealerName,\n    DW_ContentUpdatedOn,\n    DW_Country,\n    DW_Region,\n    DW_Size,\n    DW_Vendor,\n    DW_Price,\n    DW_Date,\n    DW_OS,\n    DW_IP,\n    DW_Browser,\n    DW_InstalledDate,\n    DW_CompanyLeaked,\n    DW_Links,\n    DW_Outlook,\n    DW_Info,\n    DW_RawData,\n    DW_ConfigUpdate,\n    DW_Cookies,\n    DW_CookiesDate,\n    DW_UserAgent,\n    DW_UpdatedDate,\n    DW_Bank_BIN,\n    DW_Bank_Brand,\n    DW_Bank_CardNo,\n    DW_Bank_CardType,\n    DW_Bank_CVR,\n    DW_Bank_CVV,\n    DW_Bank_Expiry,\n    DW_Bank_Level,\n    DW_Bank_Country,\n    DW_Bank_Phone,\n    DW_Bank_RealName,\n    DW_Bank_RefName,\n    DW_Bank_Site,\n    DW_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject9')._parserId9,'/'))))]",
              "dependsOn": [
                "[variables('parserObject9')._parserId9]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_marketplaces')]",
                "contentId": "[variables('parserObject9').parserContentId9]",
                "kind": "Parser",
                "version": "[variables('parserObject9').parserVersion9]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject9').parserContentId9]",
        "contentKind": "Parser",
        "displayName": "Parser to extract DarkWeb Marketplace alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject9').parserContentId9,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject9').parserContentId9,'-', '1.0.0')))]",
        "version": "[variables('parserObject9').parserVersion9]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject9')._parserName9]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract DarkWeb Marketplace alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_darkweb_marketplaces",
        "query": "CybleVisionAlerts_CL\n| where Service == \"darkweb_marketplaces\"\n| extend MappedSeverity = Severity\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// Extract BANK Information\n| extend Bank = Data.bank\n| extend\nDW_Bank_BIN            = tostring(Bank.bin),\nDW_Bank_Brand          = tostring(Bank.['card'].brand),\nDW_Bank_CardNo         = tostring(Bank.['card'].card_no),\nDW_Bank_CardType       = tostring(Bank.['card'].card_type),\nDW_Bank_CVR            = tostring(Bank.['card'].cvr),\nDW_Bank_CVV            = tostring(Bank.['card'].cvv),\nDW_Bank_Expiry         = tostring(Bank.['card'].expiry),\nDW_Bank_Level          = tostring(Bank.['card'].level),\nDW_Bank_Country        = tostring(Bank.isocountry),\nDW_Bank_Phone          = tostring(Bank.phone),\nDW_Bank_RealName       = tostring(Bank.real_name),\nDW_Bank_RefName        = tostring(Bank.ref_name),\nDW_Bank_Site           = tostring(Bank.site)\n// Extract general marketplace fields\n| extend\nDW_Marketplace         = tostring(marketplace),\nDW_StealerName         = tostring(stealer),\nDW_ContentUpdatedOn    = tostring(Content_Updated_On),\nDW_Country             = tostring(Data.country),\nDW_Region              = tostring(Data.region),\nDW_Size                = tostring(Data.size),\nDW_Vendor              = tostring(Data.vendor),\nDW_Price               = tostring(Data.price),\nDW_Date                = tostring(Data.['date']),\nDW_OS                  = tostring(Data.os),\nDW_IP                  = tostring(Data.ip),\nDW_Browser             = tostring(Data.browser),\nDW_InstalledDate       = tostring(Data.installed_date),\nDW_CompanyLeaked       = tostring(Data.company_leaked)\n// Extract huge list of links (CSV to array)\n| extend DW_Links = split(tostring(Data.links), \",\")\n// Extract other metadata fields\n| extend\nDW_Outlook             = tostring(Data.outlook),\nDW_Info                = tostring(Data.info),\nDW_RawData             = tostring(Data.raw_data),\nDW_ConfigUpdate        = tostring(Data.config_update),\nDW_Cookies             = tostring(Data.cookies),\nDW_CookiesDate         = tostring(Data.cookies_date),\nDW_UserAgent           = tostring(Data.userAgent),\nDW_UpdatedDate         = tostring(Data.updated_date)\n// Tags\n| extend DW_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    DW_Marketplace,\n    DW_StealerName,\n    DW_ContentUpdatedOn,\n    DW_Country,\n    DW_Region,\n    DW_Size,\n    DW_Vendor,\n    DW_Price,\n    DW_Date,\n    DW_OS,\n    DW_IP,\n    DW_Browser,\n    DW_InstalledDate,\n    DW_CompanyLeaked,\n    DW_Links,\n    DW_Outlook,\n    DW_Info,\n    DW_RawData,\n    DW_ConfigUpdate,\n    DW_Cookies,\n    DW_CookiesDate,\n    DW_UserAgent,\n    DW_UpdatedDate,\n    DW_Bank_BIN,\n    DW_Bank_Brand,\n    DW_Bank_CardNo,\n    DW_Bank_CardType,\n    DW_Bank_CVR,\n    DW_Bank_CVV,\n    DW_Bank_Expiry,\n    DW_Bank_Level,\n    DW_Bank_Country,\n    DW_Bank_Phone,\n    DW_Bank_RealName,\n    DW_Bank_RefName,\n    DW_Bank_Site,\n    DW_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject9')._parserId9,'/'))))]",
      "dependsOn": [
        "[variables('parserObject9')._parserId9]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_marketplaces')]",
        "contentId": "[variables('parserObject9').parserContentId9]",
        "kind": "Parser",
        "version": "[variables('parserObject9').parserVersion9]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject10').parserTemplateSpecName10]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_darkweb_ransomware Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject10').parserVersion10]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject10')._parserName10]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Darkweb Ransomware alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_darkweb_ransomware",
                "query": "CybleVisionAlerts_CL\n| where Service == \"darkweb_ransomware\"\n| extend Data = parse_json(Data)\n// Extract raw content object (stringified Python style dict)\n| extend RawContent = tostring(Data.content)\n// Extract \"text\" value from the Python style string\n| extend DW_Text = extract(@\"('text':\\s*'([^']*)')\", 1, RawContent)\n// Cleanup escaped characters\n| extend DW_Text = replace(@\"(\\\\\\\\n\", \"\\n)\", DW_Text)\n| extend DW_Text = replace(@\"(\\\\\\\\\\\\\\\\\", \"\\\\\", DW_Text)\n| extend DW_Text = replace(@\"(\\\\\\\\'\", \"')\", DW_Text)\n| extend DW_Text = trim(\" \", DW_Text)\n// Extract other nested data fields\n| extend\n    DW_CompanyLeak          = tostring(Data.company_leak),\n    DW_CreatedDate          = tostring(Data.created_date),\n    DW_DocumentYear         = tostring(Data.document_created_year),\n    DW_FileName             = tostring(Data.file_name),\n    DW_OriginalFileName     = tostring(Data.original_file_name),\n    DW_DataID               = tostring(Data.id),\n    DW_Keywords             = tostring(Data.keywords),\n    DW_ThreatActor_Nested   = tostring(Data.threat_actor),\n    DW_UpdatedDate_Nested   = tostring(Data.updated_date),\n    DW_Victim_Nested        = tostring(Data.victim)\n// Standard risk score packing\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection: standard columns + parsed fields + clean text\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Parsed fields from data\n    DW_CompanyLeak,\n    DW_CreatedDate,\n    DW_DocumentYear,\n    DW_FileName,\n    DW_OriginalFileName,\n    DW_DataID,\n    DW_Keywords,\n    DW_ThreatActor_Nested,\n    DW_UpdatedDate_Nested,\n    DW_Victim_Nested,\n    // Clean text content\n    DW_Text,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject10')._parserId10,'/'))))]",
              "dependsOn": [
                "[variables('parserObject10')._parserId10]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_ransomware')]",
                "contentId": "[variables('parserObject10').parserContentId10]",
                "kind": "Parser",
                "version": "[variables('parserObject10').parserVersion10]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject10').parserContentId10]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Darkweb Ransomware alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject10').parserContentId10,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject10').parserContentId10,'-', '1.0.0')))]",
        "version": "[variables('parserObject10').parserVersion10]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject10')._parserName10]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Darkweb Ransomware alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_darkweb_ransomware",
        "query": "CybleVisionAlerts_CL\n| where Service == \"darkweb_ransomware\"\n| extend Data = parse_json(Data)\n// Extract raw content object (stringified Python style dict)\n| extend RawContent = tostring(Data.content)\n// Extract \"text\" value from the Python style string\n| extend DW_Text = extract(@\"('text':\\s*'([^']*)')\", 1, RawContent)\n// Cleanup escaped characters\n| extend DW_Text = replace(@\"(\\\\\\\\n\", \"\\n)\", DW_Text)\n| extend DW_Text = replace(@\"(\\\\\\\\\\\\\\\\\", \"\\\\\", DW_Text)\n| extend DW_Text = replace(@\"(\\\\\\\\'\", \"')\", DW_Text)\n| extend DW_Text = trim(\" \", DW_Text)\n// Extract other nested data fields\n| extend\n    DW_CompanyLeak          = tostring(Data.company_leak),\n    DW_CreatedDate          = tostring(Data.created_date),\n    DW_DocumentYear         = tostring(Data.document_created_year),\n    DW_FileName             = tostring(Data.file_name),\n    DW_OriginalFileName     = tostring(Data.original_file_name),\n    DW_DataID               = tostring(Data.id),\n    DW_Keywords             = tostring(Data.keywords),\n    DW_ThreatActor_Nested   = tostring(Data.threat_actor),\n    DW_UpdatedDate_Nested   = tostring(Data.updated_date),\n    DW_Victim_Nested        = tostring(Data.victim)\n// Standard risk score packing\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection: standard columns + parsed fields + clean text\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Parsed fields from data\n    DW_CompanyLeak,\n    DW_CreatedDate,\n    DW_DocumentYear,\n    DW_FileName,\n    DW_OriginalFileName,\n    DW_DataID,\n    DW_Keywords,\n    DW_ThreatActor_Nested,\n    DW_UpdatedDate_Nested,\n    DW_Victim_Nested,\n    // Clean text content\n    DW_Text,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject10')._parserId10,'/'))))]",
      "dependsOn": [
        "[variables('parserObject10')._parserId10]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_darkweb_ransomware')]",
        "contentId": "[variables('parserObject10').parserContentId10]",
        "kind": "Parser",
        "version": "[variables('parserObject10').parserVersion10]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject11').parserTemplateSpecName11]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_defacement_content Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject11').parserVersion11]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject11')._parserName11]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Defacement Content alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_defacement_content",
                "query": "CybleVisionAlerts_CL\n| where Service == \"defacement_content\"\n// Parse inner object\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract defacement specific fields\n| extend\n    DC_CompanyID        = tostring(Data.company_id),\n    DC_CreatedOn        = tostring(Data.created_on),\n    DC_DomainName       = tostring(Data.domain_name),\n    DC_RecordID         = tostring(Data.id),\n    DC_Keywords         = tostring(Data.keywords),\n    DC_URL              = tostring(Data.url),\n    DC_WebsiteAddedOn   = tostring(Data.website_added_on),\n    DC_WebsiteID        = tostring(Data.website_id)\n// Normalize risk score\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final unified projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // DEFACEMENT fields\n    DC_CompanyID,\n    DC_CreatedOn,\n    DC_DomainName,\n    DC_RecordID,\n    DC_Keywords,\n    DC_URL,\n    DC_WebsiteAddedOn,\n    DC_WebsiteID,\n    // raw parsed object\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject11')._parserId11,'/'))))]",
              "dependsOn": [
                "[variables('parserObject11')._parserId11]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_content')]",
                "contentId": "[variables('parserObject11').parserContentId11]",
                "kind": "Parser",
                "version": "[variables('parserObject11').parserVersion11]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject11').parserContentId11]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Defacement Content alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject11').parserContentId11,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject11').parserContentId11,'-', '1.0.0')))]",
        "version": "[variables('parserObject11').parserVersion11]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject11')._parserName11]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Defacement Content alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_defacement_content",
        "query": "CybleVisionAlerts_CL\n| where Service == \"defacement_content\"\n// Parse inner object\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract defacement specific fields\n| extend\n    DC_CompanyID        = tostring(Data.company_id),\n    DC_CreatedOn        = tostring(Data.created_on),\n    DC_DomainName       = tostring(Data.domain_name),\n    DC_RecordID         = tostring(Data.id),\n    DC_Keywords         = tostring(Data.keywords),\n    DC_URL              = tostring(Data.url),\n    DC_WebsiteAddedOn   = tostring(Data.website_added_on),\n    DC_WebsiteID        = tostring(Data.website_id)\n// Normalize risk score\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final unified projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // DEFACEMENT fields\n    DC_CompanyID,\n    DC_CreatedOn,\n    DC_DomainName,\n    DC_RecordID,\n    DC_Keywords,\n    DC_URL,\n    DC_WebsiteAddedOn,\n    DC_WebsiteID,\n    // raw parsed object\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject11')._parserId11,'/'))))]",
      "dependsOn": [
        "[variables('parserObject11')._parserId11]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_content')]",
        "contentId": "[variables('parserObject11').parserContentId11]",
        "kind": "Parser",
        "version": "[variables('parserObject11').parserVersion11]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject12').parserTemplateSpecName12]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_defacement_keyword Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject12').parserVersion12]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject12')._parserName12]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Defacement Keyword alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_defacement_keyword",
                "query": "CybleVisionAlerts_CL\n| where Service == \"defacement_keyword\"\n// Parse inner object\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract keyword defacement fields\n| extend\n    DK_CompanyID        = tostring(Data.company_id),\n    DK_CreatedOn        = tostring(Data.created_on),\n    DK_DomainName       = tostring(Data.domain_name),\n    DK_Frequency        = tostring(Data.frequency),\n    DK_RecordID         = tostring(Data.id),\n    DK_Keyword          = tostring(Data.keyword),\n    DK_Keywords         = tostring(Data.keywords),\n    DK_URL              = tostring(Data.url),\n    DK_WebsiteAddedOn   = tostring(Data.website_added_on),\n    DK_WebsiteID        = tostring(Data.website_id)\n// Normalize risk score to standard format\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final unified projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // DEFACEMENT KEYWORD fields\n    DK_CompanyID,\n    DK_CreatedOn,\n    DK_DomainName,\n    DK_Frequency,\n    DK_RecordID,\n    DK_Keyword,\n    DK_Keywords,\n    DK_URL,\n    DK_WebsiteAddedOn,\n    DK_WebsiteID,\n    // Raw inner data\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject12')._parserId12,'/'))))]",
              "dependsOn": [
                "[variables('parserObject12')._parserId12]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_keyword')]",
                "contentId": "[variables('parserObject12').parserContentId12]",
                "kind": "Parser",
                "version": "[variables('parserObject12').parserVersion12]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject12').parserContentId12]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Defacement Keyword alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject12').parserContentId12,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject12').parserContentId12,'-', '1.0.0')))]",
        "version": "[variables('parserObject12').parserVersion12]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject12')._parserName12]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Defacement Keyword alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_defacement_keyword",
        "query": "CybleVisionAlerts_CL\n| where Service == \"defacement_keyword\"\n// Parse inner object\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract keyword defacement fields\n| extend\n    DK_CompanyID        = tostring(Data.company_id),\n    DK_CreatedOn        = tostring(Data.created_on),\n    DK_DomainName       = tostring(Data.domain_name),\n    DK_Frequency        = tostring(Data.frequency),\n    DK_RecordID         = tostring(Data.id),\n    DK_Keyword          = tostring(Data.keyword),\n    DK_Keywords         = tostring(Data.keywords),\n    DK_URL              = tostring(Data.url),\n    DK_WebsiteAddedOn   = tostring(Data.website_added_on),\n    DK_WebsiteID        = tostring(Data.website_id)\n// Normalize risk score to standard format\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final unified projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // DEFACEMENT KEYWORD fields\n    DK_CompanyID,\n    DK_CreatedOn,\n    DK_DomainName,\n    DK_Frequency,\n    DK_RecordID,\n    DK_Keyword,\n    DK_Keywords,\n    DK_URL,\n    DK_WebsiteAddedOn,\n    DK_WebsiteID,\n    // Raw inner data\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject12')._parserId12,'/'))))]",
      "dependsOn": [
        "[variables('parserObject12')._parserId12]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_keyword')]",
        "contentId": "[variables('parserObject12').parserContentId12]",
        "kind": "Parser",
        "version": "[variables('parserObject12').parserVersion12]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject13').parserTemplateSpecName13]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_defacement_url Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject13').parserVersion13]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject13')._parserName13]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Defacement URL alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_defacement_url",
                "query": "CybleVisionAlerts_CL\n| where Service == \"defacement_url\"\n// Parse inner defacement URL object\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract fields\n| extend\n    DU_CompanyID        = tostring(Data.company_id),\n    DU_CreatedOn        = tostring(Data.created_on),\n    DU_Description      = tostring(Data.description),\n    DU_DomainName       = tostring(Data.domain_name),\n    DU_RecordID         = tostring(Data.id),\n    DU_Keywords         = tostring(Data.keywords),\n    DU_Type             = tostring(Data.type),\n    DU_WebsiteAddedOn   = tostring(Data.website_added_on),\n    DU_WebsiteID        = tostring(Data.website_id)\n// Pack risk score for compatibility across all parsers\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// FINAL PROJECTION your standard schema\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // DEFACEMENT URL fields\n    DU_CompanyID,\n    DU_CreatedOn,\n    DU_Description,\n    DU_DomainName,\n    DU_RecordID,\n    DU_Keywords,\n    DU_Type,\n    DU_WebsiteAddedOn,\n    DU_WebsiteID,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject13')._parserId13,'/'))))]",
              "dependsOn": [
                "[variables('parserObject13')._parserId13]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_url')]",
                "contentId": "[variables('parserObject13').parserContentId13]",
                "kind": "Parser",
                "version": "[variables('parserObject13').parserVersion13]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject13').parserContentId13]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Defacement URL alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject13').parserContentId13,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject13').parserContentId13,'-', '1.0.0')))]",
        "version": "[variables('parserObject13').parserVersion13]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject13')._parserName13]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Defacement URL alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_defacement_url",
        "query": "CybleVisionAlerts_CL\n| where Service == \"defacement_url\"\n// Parse inner defacement URL object\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract fields\n| extend\n    DU_CompanyID        = tostring(Data.company_id),\n    DU_CreatedOn        = tostring(Data.created_on),\n    DU_Description      = tostring(Data.description),\n    DU_DomainName       = tostring(Data.domain_name),\n    DU_RecordID         = tostring(Data.id),\n    DU_Keywords         = tostring(Data.keywords),\n    DU_Type             = tostring(Data.type),\n    DU_WebsiteAddedOn   = tostring(Data.website_added_on),\n    DU_WebsiteID        = tostring(Data.website_id)\n// Pack risk score for compatibility across all parsers\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// FINAL PROJECTION your standard schema\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // DEFACEMENT URL fields\n    DU_CompanyID,\n    DU_CreatedOn,\n    DU_Description,\n    DU_DomainName,\n    DU_RecordID,\n    DU_Keywords,\n    DU_Type,\n    DU_WebsiteAddedOn,\n    DU_WebsiteID,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject13')._parserId13,'/'))))]",
      "dependsOn": [
        "[variables('parserObject13')._parserId13]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_defacement_url')]",
        "contentId": "[variables('parserObject13').parserContentId13]",
        "kind": "Parser",
        "version": "[variables('parserObject13').parserVersion13]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject14').parserTemplateSpecName14]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_discord Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject14').parserVersion14]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject14')._parserName14]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Discord alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_discord",
                "query": "CybleVisionAlerts_CL\n| where Service == \"discord\"\n// Parse inner discord message object\n| extend RawData = parse_json(Data)\n| extend Doc = RawData.doc\n// Extract author object\n| extend Author = Doc.author\n// Extract discord fields\n| extend\n    DC_MessageID        = tostring(Doc.id),\n    DC_Content          = tostring(Doc.content),\n    DC_ChannelName      = tostring(Doc.channel_name),\n    DC_ServerName       = tostring(Doc.server_name),\n    DC_Timestamp        = tostring(Doc.timestamp),\n    DC_Attachments      = tostring(Doc.attachments),\n    DC_Embeds           = tostring(Doc.embeds),\n    // Author fields\n    DC_AuthorID         = tostring(Author.id),\n    DC_AuthorUsername   = tostring(Author.username),\n    DC_AuthorGlobalName = tostring(Author.global_name),\n    DC_AuthorAvatar     = tostring(Author.avatar),\n    DC_AuthorFlags      = tostring(Author.['flags'])\n// Normalize risk score\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final standardized projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Discord fields\n    DC_MessageID,\n    DC_Content,\n    DC_ChannelName,\n    DC_ServerName,\n    DC_Timestamp,\n    DC_Attachments,\n    DC_Embeds,\n    // Author info\n    DC_AuthorID,\n    DC_AuthorUsername,\n    DC_AuthorGlobalName,\n    DC_AuthorAvatar,\n    DC_AuthorFlags,\n    RawData\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject14')._parserId14,'/'))))]",
              "dependsOn": [
                "[variables('parserObject14')._parserId14]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_discord')]",
                "contentId": "[variables('parserObject14').parserContentId14]",
                "kind": "Parser",
                "version": "[variables('parserObject14').parserVersion14]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject14').parserContentId14]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Discord alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject14').parserContentId14,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject14').parserContentId14,'-', '1.0.0')))]",
        "version": "[variables('parserObject14').parserVersion14]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject14')._parserName14]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Discord alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_discord",
        "query": "CybleVisionAlerts_CL\n| where Service == \"discord\"\n// Parse inner discord message object\n| extend RawData = parse_json(Data)\n| extend Doc = RawData.doc\n// Extract author object\n| extend Author = Doc.author\n// Extract discord fields\n| extend\n    DC_MessageID        = tostring(Doc.id),\n    DC_Content          = tostring(Doc.content),\n    DC_ChannelName      = tostring(Doc.channel_name),\n    DC_ServerName       = tostring(Doc.server_name),\n    DC_Timestamp        = tostring(Doc.timestamp),\n    DC_Attachments      = tostring(Doc.attachments),\n    DC_Embeds           = tostring(Doc.embeds),\n    // Author fields\n    DC_AuthorID         = tostring(Author.id),\n    DC_AuthorUsername   = tostring(Author.username),\n    DC_AuthorGlobalName = tostring(Author.global_name),\n    DC_AuthorAvatar     = tostring(Author.avatar),\n    DC_AuthorFlags      = tostring(Author.['flags'])\n// Normalize risk score\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final standardized projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Discord fields\n    DC_MessageID,\n    DC_Content,\n    DC_ChannelName,\n    DC_ServerName,\n    DC_Timestamp,\n    DC_Attachments,\n    DC_Embeds,\n    // Author info\n    DC_AuthorID,\n    DC_AuthorUsername,\n    DC_AuthorGlobalName,\n    DC_AuthorAvatar,\n    DC_AuthorFlags,\n    RawData\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject14')._parserId14,'/'))))]",
      "dependsOn": [
        "[variables('parserObject14')._parserId14]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_discord')]",
        "contentId": "[variables('parserObject14').parserContentId14]",
        "kind": "Parser",
        "version": "[variables('parserObject14').parserVersion14]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject15').parserTemplateSpecName15]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_docker Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject15').parserVersion15]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject15')._parserName15]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Docker alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_docker",
                "query": "CybleVisionAlerts_CL\n| where Service == \"docker\"\n// Parse inner object (docker data is not nested under data.data; it's directly inside data)\n| extend Data = parse_json(Data)\n// Extract Docker specific fields\n| extend\n    DK_Description        = tostring(Data.description),\n    DK_Developer          = tostring(Data.developed_by),\n    DK_DeveloperUrl       = tostring(Data.developed_by_url),\n    DK_UniqueKey          = tostring(Data.docker_unique_key),\n    DK_Downloads          = toint(Data.downloads),\n    DK_ImageIconUrl       = tostring(Data.image_icon_url),\n    DK_LastUpdatedOn      = tostring(Data.last_updated_on),\n    DK_LastUpdatedOnDate  = tostring(Data.last_updated_on_date),\n    DK_MetaData           = tostring(Data.meta_data),\n    DK_ScrappingTime      = tostring(Data.scrapping_time),\n    DK_SourceName         = tostring(Data.source_name),\n    DK_Stars              = toint(Data.stars),\n    DK_Title              = tostring(Data.['title']),\n    DK_TrustedContent     = tostring(Data.trusted_content),\n    DK_UpdatedAt          = tostring(Data.updated_at),\n    DK_Url                = tostring(Data.url),\n    DK_Keyword            = tostring(Data.keyword)\n// Pack risk score (same as your other parsers)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (same structure used in all your parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Docker extracted fields\n    DK_Title,\n    DK_Description,\n    DK_Developer,\n    DK_DeveloperUrl,\n    DK_UniqueKey,\n    DK_Downloads,\n    DK_ImageIconUrl,\n    DK_LastUpdatedOn,\n    DK_LastUpdatedOnDate,\n    DK_MetaData,\n    DK_ScrappingTime,\n    DK_SourceName,\n    DK_Stars,\n    DK_TrustedContent,\n    DK_UpdatedAt,\n    DK_Url,\n    DK_Keyword,\n    // raw parsed content\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject15')._parserId15,'/'))))]",
              "dependsOn": [
                "[variables('parserObject15')._parserId15]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_docker')]",
                "contentId": "[variables('parserObject15').parserContentId15]",
                "kind": "Parser",
                "version": "[variables('parserObject15').parserVersion15]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject15').parserContentId15]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Docker alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject15').parserContentId15,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject15').parserContentId15,'-', '1.0.0')))]",
        "version": "[variables('parserObject15').parserVersion15]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject15')._parserName15]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Docker alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_docker",
        "query": "CybleVisionAlerts_CL\n| where Service == \"docker\"\n// Parse inner object (docker data is not nested under data.data; it's directly inside data)\n| extend Data = parse_json(Data)\n// Extract Docker specific fields\n| extend\n    DK_Description        = tostring(Data.description),\n    DK_Developer          = tostring(Data.developed_by),\n    DK_DeveloperUrl       = tostring(Data.developed_by_url),\n    DK_UniqueKey          = tostring(Data.docker_unique_key),\n    DK_Downloads          = toint(Data.downloads),\n    DK_ImageIconUrl       = tostring(Data.image_icon_url),\n    DK_LastUpdatedOn      = tostring(Data.last_updated_on),\n    DK_LastUpdatedOnDate  = tostring(Data.last_updated_on_date),\n    DK_MetaData           = tostring(Data.meta_data),\n    DK_ScrappingTime      = tostring(Data.scrapping_time),\n    DK_SourceName         = tostring(Data.source_name),\n    DK_Stars              = toint(Data.stars),\n    DK_Title              = tostring(Data.['title']),\n    DK_TrustedContent     = tostring(Data.trusted_content),\n    DK_UpdatedAt          = tostring(Data.updated_at),\n    DK_Url                = tostring(Data.url),\n    DK_Keyword            = tostring(Data.keyword)\n// Pack risk score (same as your other parsers)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (same structure used in all your parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Docker extracted fields\n    DK_Title,\n    DK_Description,\n    DK_Developer,\n    DK_DeveloperUrl,\n    DK_UniqueKey,\n    DK_Downloads,\n    DK_ImageIconUrl,\n    DK_LastUpdatedOn,\n    DK_LastUpdatedOnDate,\n    DK_MetaData,\n    DK_ScrappingTime,\n    DK_SourceName,\n    DK_Stars,\n    DK_TrustedContent,\n    DK_UpdatedAt,\n    DK_Url,\n    DK_Keyword,\n    // raw parsed content\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject15')._parserId15,'/'))))]",
      "dependsOn": [
        "[variables('parserObject15')._parserId15]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_docker')]",
        "contentId": "[variables('parserObject15').parserContentId15]",
        "kind": "Parser",
        "version": "[variables('parserObject15').parserVersion15]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject16').parserTemplateSpecName16]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_domain_expiry Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject16').parserVersion16]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject16')._parserName16]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Domain Expiry alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_domain_expiry",
                "query": "CybleVisionAlerts_CL\n| where Service == \"domain_expiry\"\n// Parse inner object\n| extend Data = parse_json(Data)\n// Extract fields\n| extend\n    DE_Domain        = tostring(Data.domain),\n    DE_DueDays       = tostring(Data.due_days),\n    DE_ExpiryDate    = tostring(Data.expiry_date),\n    DE_SeverityText  = tostring(Data.severity),\n    DE_TypeText      = tostring(Data.type_text)\n// Normalize risk score to standard format\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final unified projection (same structure as other parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n// DOMAIN EXPIRY extracted fields\n    DE_Domain,\n    DE_DueDays,\n    DE_ExpiryDate,\n    DE_SeverityText,\n    DE_TypeText,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject16')._parserId16,'/'))))]",
              "dependsOn": [
                "[variables('parserObject16')._parserId16]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_domain_expiry')]",
                "contentId": "[variables('parserObject16').parserContentId16]",
                "kind": "Parser",
                "version": "[variables('parserObject16').parserVersion16]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject16').parserContentId16]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Domain Expiry alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject16').parserContentId16,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject16').parserContentId16,'-', '1.0.0')))]",
        "version": "[variables('parserObject16').parserVersion16]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject16')._parserName16]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Domain Expiry alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_domain_expiry",
        "query": "CybleVisionAlerts_CL\n| where Service == \"domain_expiry\"\n// Parse inner object\n| extend Data = parse_json(Data)\n// Extract fields\n| extend\n    DE_Domain        = tostring(Data.domain),\n    DE_DueDays       = tostring(Data.due_days),\n    DE_ExpiryDate    = tostring(Data.expiry_date),\n    DE_SeverityText  = tostring(Data.severity),\n    DE_TypeText      = tostring(Data.type_text)\n// Normalize risk score to standard format\n| extend Risk_Score =\n    pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final unified projection (same structure as other parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n// DOMAIN EXPIRY extracted fields\n    DE_Domain,\n    DE_DueDays,\n    DE_ExpiryDate,\n    DE_SeverityText,\n    DE_TypeText,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject16')._parserId16,'/'))))]",
      "dependsOn": [
        "[variables('parserObject16')._parserId16]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_domain_expiry')]",
        "contentId": "[variables('parserObject16').parserContentId16]",
        "kind": "Parser",
        "version": "[variables('parserObject16').parserVersion16]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject17').parserTemplateSpecName17]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_domain_watchlist Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject17').parserVersion17]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject17')._parserName17]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Domain Watchlist alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_domain_watchlist",
                "query": "CybleVisionAlerts_CL\n| where Service == \"domain_watchlist\"\n// Parse inner dataset\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract updated fields list\n| extend DW_UpdatedFields = tostring(Data.updated_fields)\n// Old DNS record\n| extend Old = Data.old_dns_record\n| extend\n    DW_Old_Domain = tostring(Old.domain),\n    DW_Old_A = tostring(Old.a_records),\n    DW_Old_NS = tostring(Old.ns_records),\n    DW_Old_MX = tostring(Old.mx_records),\n    DW_Old_SOA = tostring(Old.soa_records),\n    DW_Old_TXT = tostring(Old.txt_records)\n// New DNS record\n| extend New = Data.new_dns_record\n| extend\n    DW_New_Domain = tostring(New.domain),\n    DW_New_A = tostring(New.a_records),\n    DW_New_NS = tostring(New.ns_records),\n    DW_New_MX = tostring(New.mx_records),\n    DW_New_SOA = tostring(New.soa_records),\n    DW_New_TXT = tostring(New.txt_records)\n// Normalize risk score (your standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Domain Watchlist additions\n    DW_UpdatedFields,\n    DW_Old_Domain,\n    DW_Old_A,\n    DW_Old_NS,\n    DW_Old_MX,\n    DW_Old_SOA,\n    DW_Old_TXT,\n    DW_New_Domain,\n    DW_New_A,\n    DW_New_NS,\n    DW_New_MX,\n    DW_New_SOA,\n    DW_New_TXT\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject17')._parserId17,'/'))))]",
              "dependsOn": [
                "[variables('parserObject17')._parserId17]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_domain_watchlist')]",
                "contentId": "[variables('parserObject17').parserContentId17]",
                "kind": "Parser",
                "version": "[variables('parserObject17').parserVersion17]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject17').parserContentId17]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Domain Watchlist alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject17').parserContentId17,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject17').parserContentId17,'-', '1.0.0')))]",
        "version": "[variables('parserObject17').parserVersion17]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject17')._parserName17]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Domain Watchlist alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_domain_watchlist",
        "query": "CybleVisionAlerts_CL\n| where Service == \"domain_watchlist\"\n// Parse inner dataset\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract updated fields list\n| extend DW_UpdatedFields = tostring(Data.updated_fields)\n// Old DNS record\n| extend Old = Data.old_dns_record\n| extend\n    DW_Old_Domain = tostring(Old.domain),\n    DW_Old_A = tostring(Old.a_records),\n    DW_Old_NS = tostring(Old.ns_records),\n    DW_Old_MX = tostring(Old.mx_records),\n    DW_Old_SOA = tostring(Old.soa_records),\n    DW_Old_TXT = tostring(Old.txt_records)\n// New DNS record\n| extend New = Data.new_dns_record\n| extend\n    DW_New_Domain = tostring(New.domain),\n    DW_New_A = tostring(New.a_records),\n    DW_New_NS = tostring(New.ns_records),\n    DW_New_MX = tostring(New.mx_records),\n    DW_New_SOA = tostring(New.soa_records),\n    DW_New_TXT = tostring(New.txt_records)\n// Normalize risk score (your standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Domain Watchlist additions\n    DW_UpdatedFields,\n    DW_Old_Domain,\n    DW_Old_A,\n    DW_Old_NS,\n    DW_Old_MX,\n    DW_Old_SOA,\n    DW_Old_TXT,\n    DW_New_Domain,\n    DW_New_A,\n    DW_New_NS,\n    DW_New_MX,\n    DW_New_SOA,\n    DW_New_TXT\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject17')._parserId17,'/'))))]",
      "dependsOn": [
        "[variables('parserObject17')._parserId17]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_domain_watchlist')]",
        "contentId": "[variables('parserObject17').parserContentId17]",
        "kind": "Parser",
        "version": "[variables('parserObject17').parserVersion17]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject18').parserTemplateSpecName18]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_flash_report Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject18').parserVersion18]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject18')._parserName18]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Flash Reports alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_flash_report",
                "query": "CybleVisionAlerts_CL\n| where Service == \"flash_report\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend FR = Data.data\n// Extract flash report fields\n| extend\n    FR_ForCompany   = toint(FR.for_company),\n    FR_ReportID     = tostring(FR.report_id)\n// Tags\n| extend FR_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    Description,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    FR_ForCompany,\n    FR_ReportID,\n    FR_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject18')._parserId18,'/'))))]",
              "dependsOn": [
                "[variables('parserObject18')._parserId18]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_flash_report')]",
                "contentId": "[variables('parserObject18').parserContentId18]",
                "kind": "Parser",
                "version": "[variables('parserObject18').parserVersion18]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject18').parserContentId18]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Flash Reports alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject18').parserContentId18,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject18').parserContentId18,'-', '1.0.0')))]",
        "version": "[variables('parserObject18').parserVersion18]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject18')._parserName18]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Flash Reports alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_flash_report",
        "query": "CybleVisionAlerts_CL\n| where Service == \"flash_report\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend FR = Data.data\n// Extract flash report fields\n| extend\n    FR_ForCompany   = toint(FR.for_company),\n    FR_ReportID     = tostring(FR.report_id)\n// Tags\n| extend FR_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    Description,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    FR_ForCompany,\n    FR_ReportID,\n    FR_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject18')._parserId18,'/'))))]",
      "dependsOn": [
        "[variables('parserObject18')._parserId18]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_flash_report')]",
        "contentId": "[variables('parserObject18').parserContentId18]",
        "kind": "Parser",
        "version": "[variables('parserObject18').parserVersion18]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject19').parserTemplateSpecName19]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_github Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject19').parserVersion19]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject19')._parserName19]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract GitHub alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_github",
                "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"github\"\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend\n    git_url        = tostring(Data.data.git_url),\n    html_url       = tostring(Data.data.html_url),\n    file_name      = tostring(Data.data.name),\n    file_path      = tostring(Data.data.path),\n    api_url        = tostring(Data.data.url),\n    score          = toint(Data.data.score),\n    sha            = tostring(Data.data.sha)\n| extend\n    repo_id              = toint(Data.data.repository.id),\n    repo_full_name       = tostring(Data.data.repository.full_name),\n    repo_html_url        = tostring(Data.data.repository.html_url),\n    repo_description     = tostring(Data.data.repository.description),\n    repo_language        = tostring(Data.data.repository.language),\n    repo_fork            = tostring(Data.data.repository.fork),\n    repo_forks_count     = toint(Data.data.repository.forks_count),\n    repo_stars           = toint(Data.data.repository.stargazers_count),\n    repo_private         = tostring(Data.data.repository.private),\n    repo_size            = toint(Data.data.repository.size),\n    repo_updated_at      = tostring(Data.data.repository.updated_at),\n    repo_pushed_at       = tostring(Data.data.repository.pushed_at)\n| extend\n    owner                = Data.data.repository.owner,\n    owner_login          = tostring(Data.data.repository.owner.login),\n    owner_id             = toint(Data.data.repository.owner.id),\n    owner_html_url       = tostring(Data.data.repository.owner.html_url),\n    owner_avatar_url     = tostring(Data.data.repository.owner.avatar_url),\n    owner_type           = tostring(Data.data.repository.owner.type)\n| mv-apply textMatch = Data.data.text_matches on ( \n      summarize \n          text_fragment   = make_list(textMatch.fragment),\n          object_type     = make_list(textMatch.object_type),\n          object_url      = make_list(textMatch.object_url),\n          property        = make_list(textMatch.property),\n          matches         = make_list(textMatch.matches)\n  )\n| mv-apply MatchItem = matches on (\n      summarize TM_AllMatchWords = make_set(MatchItem.text)\n  )\n| project\n    TimeGenerated, AlertID, git_url, html_url, file_name, file_path, api_url, score, sha,\n    repo_id, repo_full_name, repo_html_url, repo_description, repo_language, repo_fork,\n    repo_forks_count, repo_stars, repo_private, repo_size, repo_updated_at, repo_pushed_at,\n    owner_login, owner_id, owner_html_url, owner_avatar_url, owner_type,\n    text_fragment, matches, object_type, object_url, property, Risk_Score,\n    Created_At, Updated_At, Deleted_At, DataID, EntityID, KeywordName, EntityType, Service,\n    CompanyID, Description, Status, AssigneeID, AssignmentDate, ArchiveDate, Severity,\n    UpdatedBy, CreatedBy, UserSeverity, BucketID, Filename, RepositoryName, OwnerName,\n    BucketName, TruePositive, LLMProcessed, LLMExplanation, Tags, ID, Asset, Last_Detected_At,\n    Extension, Compromised_Date, Article_Name, Breach_Source, Breach_Date, Channel_Name,\n    Server_Name, Content_Updated_On, Discussion_Date, Discussion_By, Source_Name, Topic_Name,\n    Source, Alert_Type, Content_Added_On, IOC, First_Seen_On, Last_Seen_On, Old_Risk_Score,\n    New_Risk_Score, IP, Host, Port, Application_Name, Market_Source, Uploaded_At, CVE,\n    Subdomain, Domain, Chat_Title, Username, Search_Engine, Category, Sentiment\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject19')._parserId19,'/'))))]",
              "dependsOn": [
                "[variables('parserObject19')._parserId19]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_github')]",
                "contentId": "[variables('parserObject19').parserContentId19]",
                "kind": "Parser",
                "version": "[variables('parserObject19').parserVersion19]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject19').parserContentId19]",
        "contentKind": "Parser",
        "displayName": "Parser to extract GitHub alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject19').parserContentId19,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject19').parserContentId19,'-', '1.0.0')))]",
        "version": "[variables('parserObject19').parserVersion19]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject19')._parserName19]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract GitHub alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_github",
        "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"github\"\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend\n    git_url        = tostring(Data.data.git_url),\n    html_url       = tostring(Data.data.html_url),\n    file_name      = tostring(Data.data.name),\n    file_path      = tostring(Data.data.path),\n    api_url        = tostring(Data.data.url),\n    score          = toint(Data.data.score),\n    sha            = tostring(Data.data.sha)\n| extend\n    repo_id              = toint(Data.data.repository.id),\n    repo_full_name       = tostring(Data.data.repository.full_name),\n    repo_html_url        = tostring(Data.data.repository.html_url),\n    repo_description     = tostring(Data.data.repository.description),\n    repo_language        = tostring(Data.data.repository.language),\n    repo_fork            = tostring(Data.data.repository.fork),\n    repo_forks_count     = toint(Data.data.repository.forks_count),\n    repo_stars           = toint(Data.data.repository.stargazers_count),\n    repo_private         = tostring(Data.data.repository.private),\n    repo_size            = toint(Data.data.repository.size),\n    repo_updated_at      = tostring(Data.data.repository.updated_at),\n    repo_pushed_at       = tostring(Data.data.repository.pushed_at)\n| extend\n    owner                = Data.data.repository.owner,\n    owner_login          = tostring(Data.data.repository.owner.login),\n    owner_id             = toint(Data.data.repository.owner.id),\n    owner_html_url       = tostring(Data.data.repository.owner.html_url),\n    owner_avatar_url     = tostring(Data.data.repository.owner.avatar_url),\n    owner_type           = tostring(Data.data.repository.owner.type)\n| mv-apply textMatch = Data.data.text_matches on ( \n      summarize \n          text_fragment   = make_list(textMatch.fragment),\n          object_type     = make_list(textMatch.object_type),\n          object_url      = make_list(textMatch.object_url),\n          property        = make_list(textMatch.property),\n          matches         = make_list(textMatch.matches)\n  )\n| mv-apply MatchItem = matches on (\n      summarize TM_AllMatchWords = make_set(MatchItem.text)\n  )\n| project\n    TimeGenerated, AlertID, git_url, html_url, file_name, file_path, api_url, score, sha,\n    repo_id, repo_full_name, repo_html_url, repo_description, repo_language, repo_fork,\n    repo_forks_count, repo_stars, repo_private, repo_size, repo_updated_at, repo_pushed_at,\n    owner_login, owner_id, owner_html_url, owner_avatar_url, owner_type,\n    text_fragment, matches, object_type, object_url, property, Risk_Score,\n    Created_At, Updated_At, Deleted_At, DataID, EntityID, KeywordName, EntityType, Service,\n    CompanyID, Description, Status, AssigneeID, AssignmentDate, ArchiveDate, Severity,\n    UpdatedBy, CreatedBy, UserSeverity, BucketID, Filename, RepositoryName, OwnerName,\n    BucketName, TruePositive, LLMProcessed, LLMExplanation, Tags, ID, Asset, Last_Detected_At,\n    Extension, Compromised_Date, Article_Name, Breach_Source, Breach_Date, Channel_Name,\n    Server_Name, Content_Updated_On, Discussion_Date, Discussion_By, Source_Name, Topic_Name,\n    Source, Alert_Type, Content_Added_On, IOC, First_Seen_On, Last_Seen_On, Old_Risk_Score,\n    New_Risk_Score, IP, Host, Port, Application_Name, Market_Source, Uploaded_At, CVE,\n    Subdomain, Domain, Chat_Title, Username, Search_Engine, Category, Sentiment\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject19')._parserId19,'/'))))]",
      "dependsOn": [
        "[variables('parserObject19')._parserId19]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_github')]",
        "contentId": "[variables('parserObject19').parserContentId19]",
        "kind": "Parser",
        "version": "[variables('parserObject19').parserVersion19]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject20').parserTemplateSpecName20]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_hacktivism Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject20').parserVersion20]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject20')._parserName20]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Hacktivism alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_hacktivism",
                "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| where Service == \"hacktivism\"\n| extend Data = parse_json(Data)\n// Common parsed fields (root level)\n| extend\n    HK_ChannelName        = tostring(Channel_Name),\n    HK_Source             = tostring(Source),\n    HK_Type               = tostring(Type),\n    HK_ContentAddedOn     = tostring(Content_Added_On),\n    HK_BucketName         = tostring(BucketName),\n    HK_Marketplace        = tostring(marketplace) // if present in other records\n// Variant A: Telegram / feed style fields inside data\n| extend\n    HK_ChannelLink        = tostring(Data.channel_link),\n    HK_Data_ChannelName   = tostring(Data.channel_name),\n    HK_Countries          = Data.countries,\n    HK_CountryCodes       = Data.country_codes,\n    HK_PostData           = tostring(Data.post_data),\n    HK_PostDomains        = Data.post_domains,\n    HK_PostFiles          = Data.post_files,\n    HK_PostID             = tostring(Data.post_id),\n    HK_PostLinks          = Data.post_links,\n    HK_PostPhotos         = Data.post_photos,\n    HK_PostURL            = tostring(Data.post_url),\n    HK_PostVideos         = Data.post_videos,\n    HK_PostedAt           = tostring(Data.posted_at),\n    HK_SourceType         = tostring(Data.source),\n    HK_UpdatedAt_Data     = tostring(Data.updated_at)\n// Variant B: defacedWebsite / domainbased fields inside data\n| extend\n    HK_Attacker           = tostring(Data.attacker),\n    HK_AttackerTeam       = tostring(Data.team),\n    HK_Domain             = tostring(Data.domain),\n    HK_IP                 = tostring(Data.ip),\n    HK_Server             = tostring(Data.server),\n    HK_SourceWebsite      = tostring(Data.source_website),\n    HK_Mirror             = tostring(Data.mirror),\n    HK_Timestamp_Raw      = tostring(Data.timestamp),\n    HK_WebsiteURL         = tostring(Data.website_url),\n    HK_CountryName        = tostring(Data.country_name),\n    HK_CountryCode        = tostring(Data.country_code)\n// Normalize lists: ensure arrays for links/domains/photos\n| extend\n    HK_PostLinksArray     = iif(isnull(HK_PostLinks) or HK_PostLinks == \"\", dynamic([]), todynamic(HK_PostLinks)),\n    HK_PostDomainsArray   = iif(isnull(HK_PostDomains) or HK_PostDomains == \"\", dynamic([]), todynamic(HK_PostDomains)),\n    HK_PostPhotosArray    = iif(isnull(HK_PostPhotos) or HK_PostPhotos == \"\", dynamic([]), todynamic(HK_PostPhotos))\n// If links were supplied as a single string or CSV (defensive parsing)\n| extend HK_PostLinksArray = case(\n    isnull(HK_PostLinksArray) or isempty(tostring(HK_PostLinksArray)), \n        split(tostring(Data.post_links), \",\"),\n        HK_PostLinksArray)\n// Extract URLs from post text as well (adds any missed links)\n| extend HK_Urls_In_Text = extract_all(@\"(https?://[^\\s,]+)\", HK_PostData)\n// Combine arrays (array_concat exists in Kusto)\n| extend HK_CombinedUrls = array_concat(HK_PostLinksArray, HK_Urls_In_Text)\n// mvapply to dedupe and create HK_All_URLs per original row\n| mv-apply url = HK_CombinedUrls on (\n    where isnotempty(tostring(url))\n    | summarize HK_All_URLs = make_set(tostring(url))\n)\n// Extract domains from HK_All_URLs using mvapply (works per row) \n| mv-apply url = HK_All_URLs on (\n    where isnotempty(tostring(url))\n    | extend host = tostring(parse_url(tostring(url)).Host)\n    | where isnotempty(host)\n    | summarize HK_All_Domains = make_set(host)\n)\n// Extract phone numbers & emails from post text (helpful for forum posts)\n| extend\n    HK_Phones = extract_all(@\"(\\+?\\d[\\d\\-\\s]{6,}\\)d)\", HK_PostData),\n    HK_Emails = extract_all(@\"([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,})\", HK_PostData)\n// Tags to string\n| extend HK_Tags = tostring(Tags)\n// Final projection: keep original table columns + parsed HK_* columns\n| project\n    // Original base columns (kept for context)\n    TimeGenerated,\n    Created_At,\n    Updated_At,\n    Deleted_At,\n    AlertID,\n    Service,\n    Status,\n    DataID,\n    EntityID,\n    KeywordName,\n    EntityType,\n    CompanyID,\n    Description,\n    AssigneeID,\n    AssignmentDate,\n    ArchiveDate,\n    Severity,\n    UpdatedBy,\n    CreatedBy,\n    UserSeverity,\n    BucketID,\n    Filename,\n    RepositoryName,\n    OwnerName,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Tags,\n    ID,\n    Asset,\n    Last_Detected_At,\n    Extension,\n    Compromised_Date,\n    Article_Name,\n    Breach_Source,\n    Breach_Date,\n    Channel_Name,\n    Server_Name,\n    Content_Updated_On,\n    Discussion_Date,\n    Discussion_By,\n    Source_Name,\n    Topic_Name,\n    Source,\n    Alert_Type,\n    Content_Added_On,\n    IOC,\n    First_Seen_On,\n    Last_Seen_On,\n    Old_Risk_Score,\n    New_Risk_Score,\n    IP,\n    Host,\n    Port,\n    Application_Name,\n    Market_Source,\n    Uploaded_At,\n    CVE,\n    Subdomain,\n    Domain,\n    Chat_Title,\n    Username,\n    Search_Engine,\n    Category,\n    Sentiment,\n    Data,\n    TenantId,\n    _ResourceId,\n    // Parsed hacktivism fields\n    HK_ChannelName,\n    HK_ChannelLink,\n    HK_Data_ChannelName,\n    HK_Countries,\n    HK_CountryCodes,\n    HK_PostData,\n    HK_PostID,\n    HK_PostedAt,\n    HK_PostLinksArray,\n    HK_PostDomainsArray,\n    HK_PostPhotosArray,\n    HK_All_URLs,\n    HK_All_Domains,\n    HK_Urls_In_Text,\n    HK_Phones,\n    HK_Emails,\n    HK_Attacker,\n    HK_AttackerTeam,\n    HK_Domain,\n    HK_IP,\n    HK_Server,\n    HK_SourceWebsite,\n    HK_WebsiteURL,\n    HK_Mirror,\n    HK_Timestamp_Raw,\n    HK_CountryName,\n    HK_CountryCode,\n    HK_UpdatedAt_Data,\n    HK_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject20')._parserId20,'/'))))]",
              "dependsOn": [
                "[variables('parserObject20')._parserId20]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_hacktivism')]",
                "contentId": "[variables('parserObject20').parserContentId20]",
                "kind": "Parser",
                "version": "[variables('parserObject20').parserVersion20]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject20').parserContentId20]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Hacktivism alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject20').parserContentId20,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject20').parserContentId20,'-', '1.0.0')))]",
        "version": "[variables('parserObject20').parserVersion20]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject20')._parserName20]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Hacktivism alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_hacktivism",
        "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| where Service == \"hacktivism\"\n| extend Data = parse_json(Data)\n// Common parsed fields (root level)\n| extend\n    HK_ChannelName        = tostring(Channel_Name),\n    HK_Source             = tostring(Source),\n    HK_Type               = tostring(Type),\n    HK_ContentAddedOn     = tostring(Content_Added_On),\n    HK_BucketName         = tostring(BucketName),\n    HK_Marketplace        = tostring(marketplace) // if present in other records\n// Variant A: Telegram / feed style fields inside data\n| extend\n    HK_ChannelLink        = tostring(Data.channel_link),\n    HK_Data_ChannelName   = tostring(Data.channel_name),\n    HK_Countries          = Data.countries,\n    HK_CountryCodes       = Data.country_codes,\n    HK_PostData           = tostring(Data.post_data),\n    HK_PostDomains        = Data.post_domains,\n    HK_PostFiles          = Data.post_files,\n    HK_PostID             = tostring(Data.post_id),\n    HK_PostLinks          = Data.post_links,\n    HK_PostPhotos         = Data.post_photos,\n    HK_PostURL            = tostring(Data.post_url),\n    HK_PostVideos         = Data.post_videos,\n    HK_PostedAt           = tostring(Data.posted_at),\n    HK_SourceType         = tostring(Data.source),\n    HK_UpdatedAt_Data     = tostring(Data.updated_at)\n// Variant B: defacedWebsite / domainbased fields inside data\n| extend\n    HK_Attacker           = tostring(Data.attacker),\n    HK_AttackerTeam       = tostring(Data.team),\n    HK_Domain             = tostring(Data.domain),\n    HK_IP                 = tostring(Data.ip),\n    HK_Server             = tostring(Data.server),\n    HK_SourceWebsite      = tostring(Data.source_website),\n    HK_Mirror             = tostring(Data.mirror),\n    HK_Timestamp_Raw      = tostring(Data.timestamp),\n    HK_WebsiteURL         = tostring(Data.website_url),\n    HK_CountryName        = tostring(Data.country_name),\n    HK_CountryCode        = tostring(Data.country_code)\n// Normalize lists: ensure arrays for links/domains/photos\n| extend\n    HK_PostLinksArray     = iif(isnull(HK_PostLinks) or HK_PostLinks == \"\", dynamic([]), todynamic(HK_PostLinks)),\n    HK_PostDomainsArray   = iif(isnull(HK_PostDomains) or HK_PostDomains == \"\", dynamic([]), todynamic(HK_PostDomains)),\n    HK_PostPhotosArray    = iif(isnull(HK_PostPhotos) or HK_PostPhotos == \"\", dynamic([]), todynamic(HK_PostPhotos))\n// If links were supplied as a single string or CSV (defensive parsing)\n| extend HK_PostLinksArray = case(\n    isnull(HK_PostLinksArray) or isempty(tostring(HK_PostLinksArray)), \n        split(tostring(Data.post_links), \",\"),\n        HK_PostLinksArray)\n// Extract URLs from post text as well (adds any missed links)\n| extend HK_Urls_In_Text = extract_all(@\"(https?://[^\\s,]+)\", HK_PostData)\n// Combine arrays (array_concat exists in Kusto)\n| extend HK_CombinedUrls = array_concat(HK_PostLinksArray, HK_Urls_In_Text)\n// mvapply to dedupe and create HK_All_URLs per original row\n| mv-apply url = HK_CombinedUrls on (\n    where isnotempty(tostring(url))\n    | summarize HK_All_URLs = make_set(tostring(url))\n)\n// Extract domains from HK_All_URLs using mvapply (works per row) \n| mv-apply url = HK_All_URLs on (\n    where isnotempty(tostring(url))\n    | extend host = tostring(parse_url(tostring(url)).Host)\n    | where isnotempty(host)\n    | summarize HK_All_Domains = make_set(host)\n)\n// Extract phone numbers & emails from post text (helpful for forum posts)\n| extend\n    HK_Phones = extract_all(@\"(\\+?\\d[\\d\\-\\s]{6,}\\)d)\", HK_PostData),\n    HK_Emails = extract_all(@\"([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,})\", HK_PostData)\n// Tags to string\n| extend HK_Tags = tostring(Tags)\n// Final projection: keep original table columns + parsed HK_* columns\n| project\n    // Original base columns (kept for context)\n    TimeGenerated,\n    Created_At,\n    Updated_At,\n    Deleted_At,\n    AlertID,\n    Service,\n    Status,\n    DataID,\n    EntityID,\n    KeywordName,\n    EntityType,\n    CompanyID,\n    Description,\n    AssigneeID,\n    AssignmentDate,\n    ArchiveDate,\n    Severity,\n    UpdatedBy,\n    CreatedBy,\n    UserSeverity,\n    BucketID,\n    Filename,\n    RepositoryName,\n    OwnerName,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Tags,\n    ID,\n    Asset,\n    Last_Detected_At,\n    Extension,\n    Compromised_Date,\n    Article_Name,\n    Breach_Source,\n    Breach_Date,\n    Channel_Name,\n    Server_Name,\n    Content_Updated_On,\n    Discussion_Date,\n    Discussion_By,\n    Source_Name,\n    Topic_Name,\n    Source,\n    Alert_Type,\n    Content_Added_On,\n    IOC,\n    First_Seen_On,\n    Last_Seen_On,\n    Old_Risk_Score,\n    New_Risk_Score,\n    IP,\n    Host,\n    Port,\n    Application_Name,\n    Market_Source,\n    Uploaded_At,\n    CVE,\n    Subdomain,\n    Domain,\n    Chat_Title,\n    Username,\n    Search_Engine,\n    Category,\n    Sentiment,\n    Data,\n    TenantId,\n    _ResourceId,\n    // Parsed hacktivism fields\n    HK_ChannelName,\n    HK_ChannelLink,\n    HK_Data_ChannelName,\n    HK_Countries,\n    HK_CountryCodes,\n    HK_PostData,\n    HK_PostID,\n    HK_PostedAt,\n    HK_PostLinksArray,\n    HK_PostDomainsArray,\n    HK_PostPhotosArray,\n    HK_All_URLs,\n    HK_All_Domains,\n    HK_Urls_In_Text,\n    HK_Phones,\n    HK_Emails,\n    HK_Attacker,\n    HK_AttackerTeam,\n    HK_Domain,\n    HK_IP,\n    HK_Server,\n    HK_SourceWebsite,\n    HK_WebsiteURL,\n    HK_Mirror,\n    HK_Timestamp_Raw,\n    HK_CountryName,\n    HK_CountryCode,\n    HK_UpdatedAt_Data,\n    HK_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject20')._parserId20,'/'))))]",
      "dependsOn": [
        "[variables('parserObject20')._parserId20]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_hacktivism')]",
        "contentId": "[variables('parserObject20').parserContentId20]",
        "kind": "Parser",
        "version": "[variables('parserObject20').parserVersion20]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject21').parserTemplateSpecName21]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_i2p Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject21').parserVersion21]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject21')._parserName21]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract I2P alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_i2p",
                "query": "CybleVisionAlerts_CL\n| where Service == \"i2p\"\n// Parse inner content\n| extend Data = parse_json(Data)\n// Extract main fields\n| extend \n    I2P_Content          = tostring(Data.data),\n    I2P_URL              = tostring(Data.i2p_url),\n    I2P_SearchEngine     = tostring(Data.search_engine),\n    I2P_SearchKeyword    = tostring(Data.search_keyword),\n    I2P_UpdatedOn        = tostring(Data.updated_on)\n// Normalize risk score (your standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (consistent with all parsers)\n| project \n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // I2P fields\n    I2P_Content,\n    I2P_URL,\n    I2P_SearchEngine,\n    I2P_SearchKeyword,\n    I2P_UpdatedOn\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject21')._parserId21,'/'))))]",
              "dependsOn": [
                "[variables('parserObject21')._parserId21]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_i2p')]",
                "contentId": "[variables('parserObject21').parserContentId21]",
                "kind": "Parser",
                "version": "[variables('parserObject21').parserVersion21]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject21').parserContentId21]",
        "contentKind": "Parser",
        "displayName": "Parser to extract I2P alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject21').parserContentId21,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject21').parserContentId21,'-', '1.0.0')))]",
        "version": "[variables('parserObject21').parserVersion21]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject21')._parserName21]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract I2P alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_i2p",
        "query": "CybleVisionAlerts_CL\n| where Service == \"i2p\"\n// Parse inner content\n| extend Data = parse_json(Data)\n// Extract main fields\n| extend \n    I2P_Content          = tostring(Data.data),\n    I2P_URL              = tostring(Data.i2p_url),\n    I2P_SearchEngine     = tostring(Data.search_engine),\n    I2P_SearchKeyword    = tostring(Data.search_keyword),\n    I2P_UpdatedOn        = tostring(Data.updated_on)\n// Normalize risk score (your standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (consistent with all parsers)\n| project \n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // I2P fields\n    I2P_Content,\n    I2P_URL,\n    I2P_SearchEngine,\n    I2P_SearchKeyword,\n    I2P_UpdatedOn\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject21')._parserId21,'/'))))]",
      "dependsOn": [
        "[variables('parserObject21')._parserId21]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_i2p')]",
        "contentId": "[variables('parserObject21').parserContentId21]",
        "kind": "Parser",
        "version": "[variables('parserObject21').parserVersion21]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject22').parserTemplateSpecName22]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_iocs Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject22').parserVersion22]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject22')._parserName22]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract IOC alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_iocs",
                "query": "CybleVisionAlerts_CL\n| where Service == \"iocs\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// unroll IOC object\n| extend IOC = Data\n| extend\n    IOC_Value           = tostring(IOC),\n    IOC_FirstSeen       = tostring(First_Seen_On),\n    IOC_LastSeen        = tostring(Last_Seen_On),\n    IOC_BehaviourTags   = tostring(IOC.behaviour_tags),\n    IOC_ConfidentRating = tostring(IOC.confident_rating),\n    IOC_Desc            = tostring(IOC.description),\n    IOC_FirstSeen2      = tostring(IOC.first_seen),\n    IOC_LastSeen2       = tostring(IOC.last_seen),\n    IOC_Type            = tostring(IOC.ioc_type),\n    IOC_AttackName      = tostring(IOC.ioc_attack_name),\n    IOC_ReferenceLink   = tostring(IOC.reference_link),\n    IOC_RiskRating      = toint(IOC.risk_rating),\n    IOC_SourceNameID    = tostring(IOC.source_name_id),\n    IOC_UUID            = tostring(IOC.uuid),\n    IOC_UpdatedAt       = tostring(IOC.updated_at)\n| extend IOC_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    IOC_Value,\n    IOC_FirstSeen,\n    IOC_LastSeen,\n    IOC_BehaviourTags,\n    IOC_ConfidentRating,\n    IOC_Desc,\n    IOC_FirstSeen2,\n    IOC_LastSeen2,\n    IOC_Type,\n    IOC_AttackName,\n    IOC_ReferenceLink,\n    IOC_RiskRating,\n    IOC_SourceNameID,\n    IOC_UUID,\n    IOC_UpdatedAt,\n    IOC_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject22')._parserId22,'/'))))]",
              "dependsOn": [
                "[variables('parserObject22')._parserId22]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_iocs')]",
                "contentId": "[variables('parserObject22').parserContentId22]",
                "kind": "Parser",
                "version": "[variables('parserObject22').parserVersion22]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject22').parserContentId22]",
        "contentKind": "Parser",
        "displayName": "Parser to extract IOC alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject22').parserContentId22,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject22').parserContentId22,'-', '1.0.0')))]",
        "version": "[variables('parserObject22').parserVersion22]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject22')._parserName22]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract IOC alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_iocs",
        "query": "CybleVisionAlerts_CL\n| where Service == \"iocs\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// unroll IOC object\n| extend IOC = Data\n| extend\n    IOC_Value           = tostring(IOC),\n    IOC_FirstSeen       = tostring(First_Seen_On),\n    IOC_LastSeen        = tostring(Last_Seen_On),\n    IOC_BehaviourTags   = tostring(IOC.behaviour_tags),\n    IOC_ConfidentRating = tostring(IOC.confident_rating),\n    IOC_Desc            = tostring(IOC.description),\n    IOC_FirstSeen2      = tostring(IOC.first_seen),\n    IOC_LastSeen2       = tostring(IOC.last_seen),\n    IOC_Type            = tostring(IOC.ioc_type),\n    IOC_AttackName      = tostring(IOC.ioc_attack_name),\n    IOC_ReferenceLink   = tostring(IOC.reference_link),\n    IOC_RiskRating      = toint(IOC.risk_rating),\n    IOC_SourceNameID    = tostring(IOC.source_name_id),\n    IOC_UUID            = tostring(IOC.uuid),\n    IOC_UpdatedAt       = tostring(IOC.updated_at)\n| extend IOC_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    IOC_Value,\n    IOC_FirstSeen,\n    IOC_LastSeen,\n    IOC_BehaviourTags,\n    IOC_ConfidentRating,\n    IOC_Desc,\n    IOC_FirstSeen2,\n    IOC_LastSeen2,\n    IOC_Type,\n    IOC_AttackName,\n    IOC_ReferenceLink,\n    IOC_RiskRating,\n    IOC_SourceNameID,\n    IOC_UUID,\n    IOC_UpdatedAt,\n    IOC_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject22')._parserId22,'/'))))]",
      "dependsOn": [
        "[variables('parserObject22')._parserId22]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_iocs')]",
        "contentId": "[variables('parserObject22').parserContentId22]",
        "kind": "Parser",
        "version": "[variables('parserObject22').parserVersion22]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject23').parserTemplateSpecName23]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ip_risk_score Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject23').parserVersion23]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject23')._parserName23]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract IP Risk Score alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_ip_risk_score",
                "query": "CybleVisionAlerts_CL\n| where Service == \"ip_risk_score\"\n// Parse the numeric array [old_score, new_score, ip]\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract fields\n| extend \n    IPRS_OldScore = tostring(Old_Risk_Score),\n    IPRS_NewScore = tostring(New_Risk_Score),\n    IPRS_IP       = tostring(IP)\n// Normalize risk score using your standard pack format\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (your standard)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    Data,\n    // IP RISK SCORE fields\n    IPRS_IP,\n    IPRS_OldScore,\n    IPRS_NewScore\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject23')._parserId23,'/'))))]",
              "dependsOn": [
                "[variables('parserObject23')._parserId23]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ip_risk_score')]",
                "contentId": "[variables('parserObject23').parserContentId23]",
                "kind": "Parser",
                "version": "[variables('parserObject23').parserVersion23]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject23').parserContentId23]",
        "contentKind": "Parser",
        "displayName": "Parser to extract IP Risk Score alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject23').parserContentId23,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject23').parserContentId23,'-', '1.0.0')))]",
        "version": "[variables('parserObject23').parserVersion23]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject23')._parserName23]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract IP Risk Score alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_ip_risk_score",
        "query": "CybleVisionAlerts_CL\n| where Service == \"ip_risk_score\"\n// Parse the numeric array [old_score, new_score, ip]\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract fields\n| extend \n    IPRS_OldScore = tostring(Old_Risk_Score),\n    IPRS_NewScore = tostring(New_Risk_Score),\n    IPRS_IP       = tostring(IP)\n// Normalize risk score using your standard pack format\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (your standard)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    Data,\n    // IP RISK SCORE fields\n    IPRS_IP,\n    IPRS_OldScore,\n    IPRS_NewScore\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject23')._parserId23,'/'))))]",
      "dependsOn": [
        "[variables('parserObject23')._parserId23]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ip_risk_score')]",
        "contentId": "[variables('parserObject23').parserContentId23]",
        "kind": "Parser",
        "version": "[variables('parserObject23').parserVersion23]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject24').parserTemplateSpecName24]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_leaked_credentials Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject24').parserVersion24]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject24')._parserName24]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Leaked Credentials alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_leaked_credentials",
                "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"leaked_credentials\"\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend\n    LC_Data       = tostring(Data.data),\n    LC_Date       = tostring(Data['date']),\n    LC_Domain     = tostring(Data.domain),\n    LC_Password   = tostring(Data.password),\n    LC_URL        = tostring(Data.url),\n    LC_Username   = tostring(Data.username),\n    LC_Tags       = Data.tags\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    Risk_Score,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    LC_Data,\n    LC_Date,\n    LC_Domain,\n    LC_Password,\n    LC_URL,\n    LC_Username,\n    LC_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject24')._parserId24,'/'))))]",
              "dependsOn": [
                "[variables('parserObject24')._parserId24]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_leaked_credentials')]",
                "contentId": "[variables('parserObject24').parserContentId24]",
                "kind": "Parser",
                "version": "[variables('parserObject24').parserVersion24]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject24').parserContentId24]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Leaked Credentials alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject24').parserContentId24,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject24').parserContentId24,'-', '1.0.0')))]",
        "version": "[variables('parserObject24').parserVersion24]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject24')._parserName24]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Leaked Credentials alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_leaked_credentials",
        "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"leaked_credentials\"\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend\n    LC_Data       = tostring(Data.data),\n    LC_Date       = tostring(Data['date']),\n    LC_Domain     = tostring(Data.domain),\n    LC_Password   = tostring(Data.password),\n    LC_URL        = tostring(Data.url),\n    LC_Username   = tostring(Data.username),\n    LC_Tags       = Data.tags\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    Risk_Score,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    LC_Data,\n    LC_Date,\n    LC_Domain,\n    LC_Password,\n    LC_URL,\n    LC_Username,\n    LC_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject24')._parserId24,'/'))))]",
      "dependsOn": [
        "[variables('parserObject24')._parserId24]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_leaked_credentials')]",
        "contentId": "[variables('parserObject24').parserContentId24]",
        "kind": "Parser",
        "version": "[variables('parserObject24').parserVersion24]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject25').parserTemplateSpecName25]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_malicious_ads Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject25').parserVersion25]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject25')._parserName25]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Malicious Ads alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_malicious_ads",
                "query": "CybleVisionAlerts_CL\n| where Service == \"malicious_ads\"\n| extend Data = parse_json(Data)\n// Extract nested malicious ads fields\n| extend\n    MA_RegistrationDate      = tostring(Data.REGISTRATIONDATE),\n    MA_Source                = tostring(Data.SOURCE),\n    MA_CreatedAt_Nested      = tostring(Data.created_at),\n    MA_DetectedTechnologies  = tostring(Data.detected_technologies),\n    MA_A_Record              = tostring(Data.dns_records.a_record),\n    MA_MX_Record             = tostring(Data.dns_records.mx_record),\n    MA_NS_Record             = tostring(Data.dns_records.ns_record),\n    MA_Domain_URL            = tostring(Data.domain),\n    MA_DomainName_Nested     = tostring(Data.domain_name),\n    MA_Fuzzer                = tostring(Data.fuzzer),\n    MA_RecordID              = tostring(Data.id),\n    MA_IsLive                = tostring(Data.is_live),\n    MA_Keyword_Nested        = tostring(Data.keyword),\n    MA_LastLiveCheck         = tostring(Data.last_live_check),\n    MA_RawRegistrationDate   = tostring(Data.raw_registration_date),\n    MA_ScreenshotURL         = tostring(Data.screenshot_url),\n    MA_Service_Nested        = tostring(Data.service),\n    MA_StatusCode            = tostring(Data.status_code),\n    MA_UpdatedAt_Nested      = tostring(Data.updated_at),\n    MA_WhoisEnriched         = tostring(Data.whois_enriched),\n    MA_WhoisEnrichedTries    = tostring(Data.whois_enriched_tries)\n// Standard risk pack\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    MA_RegistrationDate,\n    MA_Source,\n    MA_CreatedAt_Nested,\n    MA_DetectedTechnologies,\n    MA_A_Record,\n    MA_MX_Record,\n    MA_NS_Record,\n    MA_Domain_URL,\n    MA_DomainName_Nested,\n    MA_Fuzzer,\n    MA_RecordID,\n    MA_IsLive,\n    MA_Keyword_Nested,\n    MA_LastLiveCheck,\n    MA_RawRegistrationDate,\n    MA_ScreenshotURL,\n    MA_Service_Nested,\n    MA_StatusCode,\n    MA_UpdatedAt_Nested,\n    MA_WhoisEnriched,\n    MA_WhoisEnrichedTries,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject25')._parserId25,'/'))))]",
              "dependsOn": [
                "[variables('parserObject25')._parserId25]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_malicious_ads')]",
                "contentId": "[variables('parserObject25').parserContentId25]",
                "kind": "Parser",
                "version": "[variables('parserObject25').parserVersion25]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject25').parserContentId25]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Malicious Ads alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject25').parserContentId25,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject25').parserContentId25,'-', '1.0.0')))]",
        "version": "[variables('parserObject25').parserVersion25]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject25')._parserName25]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Malicious Ads alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_malicious_ads",
        "query": "CybleVisionAlerts_CL\n| where Service == \"malicious_ads\"\n| extend Data = parse_json(Data)\n// Extract nested malicious ads fields\n| extend\n    MA_RegistrationDate      = tostring(Data.REGISTRATIONDATE),\n    MA_Source                = tostring(Data.SOURCE),\n    MA_CreatedAt_Nested      = tostring(Data.created_at),\n    MA_DetectedTechnologies  = tostring(Data.detected_technologies),\n    MA_A_Record              = tostring(Data.dns_records.a_record),\n    MA_MX_Record             = tostring(Data.dns_records.mx_record),\n    MA_NS_Record             = tostring(Data.dns_records.ns_record),\n    MA_Domain_URL            = tostring(Data.domain),\n    MA_DomainName_Nested     = tostring(Data.domain_name),\n    MA_Fuzzer                = tostring(Data.fuzzer),\n    MA_RecordID              = tostring(Data.id),\n    MA_IsLive                = tostring(Data.is_live),\n    MA_Keyword_Nested        = tostring(Data.keyword),\n    MA_LastLiveCheck         = tostring(Data.last_live_check),\n    MA_RawRegistrationDate   = tostring(Data.raw_registration_date),\n    MA_ScreenshotURL         = tostring(Data.screenshot_url),\n    MA_Service_Nested        = tostring(Data.service),\n    MA_StatusCode            = tostring(Data.status_code),\n    MA_UpdatedAt_Nested      = tostring(Data.updated_at),\n    MA_WhoisEnriched         = tostring(Data.whois_enriched),\n    MA_WhoisEnrichedTries    = tostring(Data.whois_enriched_tries)\n// Standard risk pack\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    MA_RegistrationDate,\n    MA_Source,\n    MA_CreatedAt_Nested,\n    MA_DetectedTechnologies,\n    MA_A_Record,\n    MA_MX_Record,\n    MA_NS_Record,\n    MA_Domain_URL,\n    MA_DomainName_Nested,\n    MA_Fuzzer,\n    MA_RecordID,\n    MA_IsLive,\n    MA_Keyword_Nested,\n    MA_LastLiveCheck,\n    MA_RawRegistrationDate,\n    MA_ScreenshotURL,\n    MA_Service_Nested,\n    MA_StatusCode,\n    MA_UpdatedAt_Nested,\n    MA_WhoisEnriched,\n    MA_WhoisEnrichedTries,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject25')._parserId25,'/'))))]",
      "dependsOn": [
        "[variables('parserObject25')._parserId25]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_malicious_ads')]",
        "contentId": "[variables('parserObject25').parserContentId25]",
        "kind": "Parser",
        "version": "[variables('parserObject25').parserVersion25]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject26').parserTemplateSpecName26]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_mobile_apps Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject26').parserVersion26]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject26')._parserName26]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Mobile Apps alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_mobile_apps",
                "query": "CybleVisionAlerts_CL\n| where Service == \"mobile_apps\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend Src = Data._source\n// Main app fields\n| extend\n    MA_Title             = tostring(Src.['title']),\n    MA_Description       = tostring(Src.description),\n    MA_Developer         = tostring(Src.developer),\n    MA_MarketSource      = tostring(Src.market_source),\n    MA_MarketURL         = tostring(Src.market_url),\n    MA_DeepLink          = tostring(Src.deep_link),\n    MA_PackageName       = tostring(Src.package_name),\n    MA_Downloads         = tostring(Src.downloads),\n    MA_MarketStatus      = tostring(Src.market_status),\n    MA_MarketUpdated     = tostring(Src.market_update),\n    MA_Created           = tostring(Src.created),\n    MA_Email             = tostring(Src.email),\n    MA_Icon              = tostring(Src.icon),\n    MA_Website           = tostring(Src.website),\n    MA_ShortDesc         = tostring(Src.short_desc),\n    MA_Version           = tostring(Src.version)\n// Handle screenshots ARRAY correctly\n| extend MA_Screenshots = Src.screenshots\n// Higher level first class fields\n| extend\n    AppName              = tostring(Data.application_name),\n    MarketSource2        = tostring(Data.market_source),\n    UploadedAt           = tostring(Data.uploaded_at)\n// Tags as \n| extend MA_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    AppName,\n    MarketSource2,\n    UploadedAt,\n    MA_Title,\n    MA_Description,\n    MA_Developer,\n    MA_MarketSource,\n    MA_MarketURL,\n    MA_DeepLink,\n    MA_PackageName,\n    MA_Downloads,\n    MA_MarketStatus,\n    MA_MarketUpdated,\n    MA_Created,\n    MA_Email,\n    MA_Icon,\n    MA_Website,\n    MA_ShortDesc,\n    MA_Version,\n    MA_Screenshots,\n    MA_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject26')._parserId26,'/'))))]",
              "dependsOn": [
                "[variables('parserObject26')._parserId26]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_mobile_apps')]",
                "contentId": "[variables('parserObject26').parserContentId26]",
                "kind": "Parser",
                "version": "[variables('parserObject26').parserVersion26]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject26').parserContentId26]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Mobile Apps alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject26').parserContentId26,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject26').parserContentId26,'-', '1.0.0')))]",
        "version": "[variables('parserObject26').parserVersion26]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject26')._parserName26]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Mobile Apps alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_mobile_apps",
        "query": "CybleVisionAlerts_CL\n| where Service == \"mobile_apps\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend Src = Data._source\n// Main app fields\n| extend\n    MA_Title             = tostring(Src.['title']),\n    MA_Description       = tostring(Src.description),\n    MA_Developer         = tostring(Src.developer),\n    MA_MarketSource      = tostring(Src.market_source),\n    MA_MarketURL         = tostring(Src.market_url),\n    MA_DeepLink          = tostring(Src.deep_link),\n    MA_PackageName       = tostring(Src.package_name),\n    MA_Downloads         = tostring(Src.downloads),\n    MA_MarketStatus      = tostring(Src.market_status),\n    MA_MarketUpdated     = tostring(Src.market_update),\n    MA_Created           = tostring(Src.created),\n    MA_Email             = tostring(Src.email),\n    MA_Icon              = tostring(Src.icon),\n    MA_Website           = tostring(Src.website),\n    MA_ShortDesc         = tostring(Src.short_desc),\n    MA_Version           = tostring(Src.version)\n// Handle screenshots ARRAY correctly\n| extend MA_Screenshots = Src.screenshots\n// Higher level first class fields\n| extend\n    AppName              = tostring(Data.application_name),\n    MarketSource2        = tostring(Data.market_source),\n    UploadedAt           = tostring(Data.uploaded_at)\n// Tags as \n| extend MA_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    AppName,\n    MarketSource2,\n    UploadedAt,\n    MA_Title,\n    MA_Description,\n    MA_Developer,\n    MA_MarketSource,\n    MA_MarketURL,\n    MA_DeepLink,\n    MA_PackageName,\n    MA_Downloads,\n    MA_MarketStatus,\n    MA_MarketUpdated,\n    MA_Created,\n    MA_Email,\n    MA_Icon,\n    MA_Website,\n    MA_ShortDesc,\n    MA_Version,\n    MA_Screenshots,\n    MA_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject26')._parserId26,'/'))))]",
      "dependsOn": [
        "[variables('parserObject26')._parserId26]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_mobile_apps')]",
        "contentId": "[variables('parserObject26').parserContentId26]",
        "kind": "Parser",
        "version": "[variables('parserObject26').parserVersion26]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject27').parserTemplateSpecName27]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_new_vulnerability Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject27').parserVersion27]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject27')._parserName27]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract New Vulnerability alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_new_vulnerability",
                "query": "CybleVisionAlerts_CL\n| where Service == \"new_vulnerability\"\n// Parse nested content\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract main CVE reference\n| extend NV_CVE = tostring(CVE)\n// Normalize risk score (standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (same structure you use for every parser)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    Data,\n    // Vulnerability fields\n    NV_CVE\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject27')._parserId27,'/'))))]",
              "dependsOn": [
                "[variables('parserObject27')._parserId27]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_new_vulnerability')]",
                "contentId": "[variables('parserObject27').parserContentId27]",
                "kind": "Parser",
                "version": "[variables('parserObject27').parserVersion27]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject27').parserContentId27]",
        "contentKind": "Parser",
        "displayName": "Parser to extract New Vulnerability alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject27').parserContentId27,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject27').parserContentId27,'-', '1.0.0')))]",
        "version": "[variables('parserObject27').parserVersion27]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject27')._parserName27]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract New Vulnerability alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_new_vulnerability",
        "query": "CybleVisionAlerts_CL\n| where Service == \"new_vulnerability\"\n// Parse nested content\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract main CVE reference\n| extend NV_CVE = tostring(CVE)\n// Normalize risk score (standard)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (same structure you use for every parser)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    Data,\n    // Vulnerability fields\n    NV_CVE\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject27')._parserId27,'/'))))]",
      "dependsOn": [
        "[variables('parserObject27')._parserId27]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_new_vulnerability')]",
        "contentId": "[variables('parserObject27').parserContentId27]",
        "kind": "Parser",
        "version": "[variables('parserObject27').parserVersion27]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject28').parserTemplateSpecName28]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_news_feed Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject28').parserVersion28]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject28')._parserName28]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract News Feed alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_news_feed",
                "query": "CybleVisionAlerts_CL\n  | where Service == \"news_feed\"\n  // Parse inner data object\n  | extend Data = parse_json(Data)\n  // Extract fields\n  | extend\n      NF_AI_Summary       = tostring(Data.ai_summary),\n      NF_PostDate         = tostring(Data.post_date),\n      NF_PostDescription  = tostring(Data.post_description),\n      NF_PostImage        = tostring(Data.post_img),\n      NF_PostTitle        = tostring(Data.post_title),\n      NF_PostURL          = tostring(Data.post_url),\n      NF_NewsFeedType     = tostring(Data.news_feed_type),\n      NF_PostSourceName   = tostring(Data.post_source.name),\n      NF_PostSourceURL    = tostring(Data.post_source.url),\n      NF_PostSourceIcon   = tostring(Data.post_source.icon),\n      NF_Industries       = tostring(Data.industries),\n      NF_Malwares         = tostring(Data.malwares),\n      NF_ThreatActors     = tostring(Data.threat_actors),\n      NF_TTPs             = tostring(Data.ttps),\n      NF_IOCs             = tostring(Data.iocs),\n      NF_SourceCountries  = tostring(Data.source_countries),\n      NF_Regions          = tostring(Data.regions),\n      NF_TargetCountries  = tostring(Data.target_countries),\n      NF_CVEs             = tostring(Data.cves)\n  // Normalize Risk Score (same style for all parsers)\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  // Final projection (your standard unified layout)\n  | project\n      TimeGenerated,\n      AlertID = tostring(ID),\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      // NEWS FEED extracted data\n      NF_AI_Summary,\n      NF_PostDate,\n      NF_PostDescription,\n      NF_PostImage,\n      NF_PostTitle,\n      NF_PostURL,\n      NF_NewsFeedType,\n      NF_PostSourceName,\n      NF_PostSourceURL,\n      NF_PostSourceIcon,\n      NF_Industries,\n      NF_Malwares,\n      NF_ThreatActors,\n      NF_TTPs,\n      NF_IOCs,\n      NF_SourceCountries,\n      NF_Regions,\n      NF_TargetCountries,\n      NF_CVEs,\n      // raw parsed object\n      Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject28')._parserId28,'/'))))]",
              "dependsOn": [
                "[variables('parserObject28')._parserId28]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_news_feed')]",
                "contentId": "[variables('parserObject28').parserContentId28]",
                "kind": "Parser",
                "version": "[variables('parserObject28').parserVersion28]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject28').parserContentId28]",
        "contentKind": "Parser",
        "displayName": "Parser to extract News Feed alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject28').parserContentId28,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject28').parserContentId28,'-', '1.0.0')))]",
        "version": "[variables('parserObject28').parserVersion28]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject28')._parserName28]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract News Feed alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_news_feed",
        "query": "CybleVisionAlerts_CL\n  | where Service == \"news_feed\"\n  // Parse inner data object\n  | extend Data = parse_json(Data)\n  // Extract fields\n  | extend\n      NF_AI_Summary       = tostring(Data.ai_summary),\n      NF_PostDate         = tostring(Data.post_date),\n      NF_PostDescription  = tostring(Data.post_description),\n      NF_PostImage        = tostring(Data.post_img),\n      NF_PostTitle        = tostring(Data.post_title),\n      NF_PostURL          = tostring(Data.post_url),\n      NF_NewsFeedType     = tostring(Data.news_feed_type),\n      NF_PostSourceName   = tostring(Data.post_source.name),\n      NF_PostSourceURL    = tostring(Data.post_source.url),\n      NF_PostSourceIcon   = tostring(Data.post_source.icon),\n      NF_Industries       = tostring(Data.industries),\n      NF_Malwares         = tostring(Data.malwares),\n      NF_ThreatActors     = tostring(Data.threat_actors),\n      NF_TTPs             = tostring(Data.ttps),\n      NF_IOCs             = tostring(Data.iocs),\n      NF_SourceCountries  = tostring(Data.source_countries),\n      NF_Regions          = tostring(Data.regions),\n      NF_TargetCountries  = tostring(Data.target_countries),\n      NF_CVEs             = tostring(Data.cves)\n  // Normalize Risk Score (same style for all parsers)\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  // Final projection (your standard unified layout)\n  | project\n      TimeGenerated,\n      AlertID = tostring(ID),\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      // NEWS FEED extracted data\n      NF_AI_Summary,\n      NF_PostDate,\n      NF_PostDescription,\n      NF_PostImage,\n      NF_PostTitle,\n      NF_PostURL,\n      NF_NewsFeedType,\n      NF_PostSourceName,\n      NF_PostSourceURL,\n      NF_PostSourceIcon,\n      NF_Industries,\n      NF_Malwares,\n      NF_ThreatActors,\n      NF_TTPs,\n      NF_IOCs,\n      NF_SourceCountries,\n      NF_Regions,\n      NF_TargetCountries,\n      NF_CVEs,\n      // raw parsed object\n      Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject28')._parserId28,'/'))))]",
      "dependsOn": [
        "[variables('parserObject28')._parserId28]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_news_feed')]",
        "contentId": "[variables('parserObject28').parserContentId28]",
        "kind": "Parser",
        "version": "[variables('parserObject28').parserVersion28]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject29').parserTemplateSpecName29]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_osint Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject29').parserVersion29]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject29')._parserName29]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract OSINT alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_osint",
                "query": "CybleVisionAlerts_CL\n  | where Service == \"osint\"\n  // Parse nested OSINT data\n  | extend Data = parse_json(Data)\n  // top level extracted fields\n  | extend\n      OS_AuthorName        = tostring(Data.['Author Name']),\n      OS_AuthorUsername    = tostring(Data.['author_username']),\n      OS_Source            = tostring(Source),\n      OS_UploadedAt        = tostring(Uploaded_At)\n  // Inner OSINT metadata  \n  | extend\n      OS_MentionDate       = tostring(Data.['Mention Date']),\n      OS_MentionURL        = tostring(Data.['Mention URL']),\n      OS_PostSnippet       = tostring(Data.['Post Snippet']),\n      OS_Reach             = tostring(Data.['Reach']),\n      OS_Starred           = tostring(Data.['Starred']),\n      OS_Title             = tostring(Data.['Title'])\n  // Normalize risk score (as used globally)\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  // Final projection (standard schema)\n  | project\n      TimeGenerated,\n      AlertID = tostring(ID),\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      // OSINT specific extracted fields\n      OS_AuthorName,\n      OS_AuthorUsername,\n      OS_Source,\n      OS_UploadedAt,\n      OS_MentionDate,\n      OS_MentionURL,\n      OS_PostSnippet,\n      OS_Reach,\n      OS_Starred,\n      OS_Title\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject29')._parserId29,'/'))))]",
              "dependsOn": [
                "[variables('parserObject29')._parserId29]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_osint')]",
                "contentId": "[variables('parserObject29').parserContentId29]",
                "kind": "Parser",
                "version": "[variables('parserObject29').parserVersion29]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject29').parserContentId29]",
        "contentKind": "Parser",
        "displayName": "Parser to extract OSINT alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject29').parserContentId29,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject29').parserContentId29,'-', '1.0.0')))]",
        "version": "[variables('parserObject29').parserVersion29]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject29')._parserName29]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract OSINT alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_osint",
        "query": "CybleVisionAlerts_CL\n  | where Service == \"osint\"\n  // Parse nested OSINT data\n  | extend Data = parse_json(Data)\n  // top level extracted fields\n  | extend\n      OS_AuthorName        = tostring(Data.['Author Name']),\n      OS_AuthorUsername    = tostring(Data.['author_username']),\n      OS_Source            = tostring(Source),\n      OS_UploadedAt        = tostring(Uploaded_At)\n  // Inner OSINT metadata  \n  | extend\n      OS_MentionDate       = tostring(Data.['Mention Date']),\n      OS_MentionURL        = tostring(Data.['Mention URL']),\n      OS_PostSnippet       = tostring(Data.['Post Snippet']),\n      OS_Reach             = tostring(Data.['Reach']),\n      OS_Starred           = tostring(Data.['Starred']),\n      OS_Title             = tostring(Data.['Title'])\n  // Normalize risk score (as used globally)\n  | extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n  // Final projection (standard schema)\n  | project\n      TimeGenerated,\n      AlertID = tostring(ID),\n      EntityID,\n      KeywordName,\n      CompanyID,\n      Status,\n      Severity,\n      UserSeverity,\n      BucketID,\n      Domain,\n      BucketName,\n      TruePositive,\n      LLMProcessed,\n      LLMExplanation,\n      IP,\n      Service,\n      Risk_Score,\n      // OSINT specific extracted fields\n      OS_AuthorName,\n      OS_AuthorUsername,\n      OS_Source,\n      OS_UploadedAt,\n      OS_MentionDate,\n      OS_MentionURL,\n      OS_PostSnippet,\n      OS_Reach,\n      OS_Starred,\n      OS_Title\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject29')._parserId29,'/'))))]",
      "dependsOn": [
        "[variables('parserObject29')._parserId29]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_osint')]",
        "contentId": "[variables('parserObject29').parserContentId29]",
        "kind": "Parser",
        "version": "[variables('parserObject29').parserVersion29]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject30').parserTemplateSpecName30]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ot_ics Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject30').parserVersion30]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject30')._parserName30]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract OT ICS alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_ot_ics",
                "query": "CybleVisionAlerts_CL\n| where Service == \"ot_ics\"\n| extend Data = parse_json(Data)\n| extend\n    OT_ASN            = tostring(Data.asn),\n    OT_Country        = tostring(Data.country),\n    OT_SourceIP       = tostring(Data.source_ip),\n    OT_ContentAddedOn = tostring(Data.content_added_on),\n    OT_Industry       = tostring(Data.industry),\n    // Nested attributes\n    OT_DataType       = tostring(Data.data_type),\n    OT_DestPort       = tostring(Data.dest_port),\n    OT_CountryCode    = tostring(Data.country_code),\n    OT_CountryName    = tostring(Data.country_name),\n    OT_IP_Reputation  = tostring(Data.ip_rep),\n    OT_Src_IP         = tostring(Data.src_ip),\n    OT_Timestamp      = tostring(Data.timestamp)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // OT/ICS attributes\n    OT_ASN,\n    OT_Country,\n    OT_SourceIP,\n    OT_ContentAddedOn,\n    OT_Industry,\n    OT_DataType,\n    OT_DestPort,\n    OT_CountryCode,\n    OT_CountryName,\n    OT_IP_Reputation,\n    OT_Src_IP,\n    OT_Timestamp\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject30')._parserId30,'/'))))]",
              "dependsOn": [
                "[variables('parserObject30')._parserId30]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ot_ics')]",
                "contentId": "[variables('parserObject30').parserContentId30]",
                "kind": "Parser",
                "version": "[variables('parserObject30').parserVersion30]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject30').parserContentId30]",
        "contentKind": "Parser",
        "displayName": "Parser to extract OT ICS alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject30').parserContentId30,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject30').parserContentId30,'-', '1.0.0')))]",
        "version": "[variables('parserObject30').parserVersion30]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject30')._parserName30]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract OT ICS alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_ot_ics",
        "query": "CybleVisionAlerts_CL\n| where Service == \"ot_ics\"\n| extend Data = parse_json(Data)\n| extend\n    OT_ASN            = tostring(Data.asn),\n    OT_Country        = tostring(Data.country),\n    OT_SourceIP       = tostring(Data.source_ip),\n    OT_ContentAddedOn = tostring(Data.content_added_on),\n    OT_Industry       = tostring(Data.industry),\n    // Nested attributes\n    OT_DataType       = tostring(Data.data_type),\n    OT_DestPort       = tostring(Data.dest_port),\n    OT_CountryCode    = tostring(Data.country_code),\n    OT_CountryName    = tostring(Data.country_name),\n    OT_IP_Reputation  = tostring(Data.ip_rep),\n    OT_Src_IP         = tostring(Data.src_ip),\n    OT_Timestamp      = tostring(Data.timestamp)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // OT/ICS attributes\n    OT_ASN,\n    OT_Country,\n    OT_SourceIP,\n    OT_ContentAddedOn,\n    OT_Industry,\n    OT_DataType,\n    OT_DestPort,\n    OT_CountryCode,\n    OT_CountryName,\n    OT_IP_Reputation,\n    OT_Src_IP,\n    OT_Timestamp\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject30')._parserId30,'/'))))]",
      "dependsOn": [
        "[variables('parserObject30')._parserId30]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ot_ics')]",
        "contentId": "[variables('parserObject30').parserContentId30]",
        "kind": "Parser",
        "version": "[variables('parserObject30').parserVersion30]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject31').parserTemplateSpecName31]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_pastebin Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject31').parserVersion31]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject31')._parserName31]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Pastebin alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_pastebin",
                "query": "CybleVisionAlerts_CL\n| where Service == \"pastebin\"\n// Parse main nested structure\n| extend Data = parse_json(Data)\n// Extract top level fields\n| extend\n    PB_Author           = tostring(Data.author),\n    PB_ContentUpdatedOn = tostring(Content_Added_On),\n    PB_URL              = tostring(url)\n// Extract nested metadata\n| extend\n    PB_Data_Author      = tostring(Data.author),\n    PB_Data_ContentRaw  = tostring(Data.content),\n    PB_Data_Date        = tostring(Data.['date']),\n    PB_Data_PasteID     = tostring(Data.pastebin_id),\n    PB_Data_SourceName  = tostring(Data.source_name),\n    PB_Data_SourceID    = tostring(Data.source_id),\n    PB_Data_URL         = tostring(Data.url),\n    PB_Data_Meta        = tostring(Data.meta),\n    PB_Data_PasteType   = tostring(Data.paste_type)\n// Clean escaped characters in content (double escaped Pastebin text)\n| extend PB_Content = replace(@'\\\\\\\\n', '\\n', PB_Data_ContentRaw)\n// Standard risk score normalization\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Projection standard across all your parsers\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Pastebin specific extracted values\n    PB_Author,\n    PB_ContentUpdatedOn,\n    PB_URL,\n    PB_Data_Author,\n    PB_Content,\n    PB_Data_Date,\n    PB_Data_PasteID,\n    PB_Data_SourceName,\n    PB_Data_SourceID,\n    PB_Data_URL,\n    PB_Data_PasteType,\n    PB_Data_Meta\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject31')._parserId31,'/'))))]",
              "dependsOn": [
                "[variables('parserObject31')._parserId31]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_pastebin')]",
                "contentId": "[variables('parserObject31').parserContentId31]",
                "kind": "Parser",
                "version": "[variables('parserObject31').parserVersion31]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject31').parserContentId31]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Pastebin alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject31').parserContentId31,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject31').parserContentId31,'-', '1.0.0')))]",
        "version": "[variables('parserObject31').parserVersion31]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject31')._parserName31]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Pastebin alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_pastebin",
        "query": "CybleVisionAlerts_CL\n| where Service == \"pastebin\"\n// Parse main nested structure\n| extend Data = parse_json(Data)\n// Extract top level fields\n| extend\n    PB_Author           = tostring(Data.author),\n    PB_ContentUpdatedOn = tostring(Content_Added_On),\n    PB_URL              = tostring(url)\n// Extract nested metadata\n| extend\n    PB_Data_Author      = tostring(Data.author),\n    PB_Data_ContentRaw  = tostring(Data.content),\n    PB_Data_Date        = tostring(Data.['date']),\n    PB_Data_PasteID     = tostring(Data.pastebin_id),\n    PB_Data_SourceName  = tostring(Data.source_name),\n    PB_Data_SourceID    = tostring(Data.source_id),\n    PB_Data_URL         = tostring(Data.url),\n    PB_Data_Meta        = tostring(Data.meta),\n    PB_Data_PasteType   = tostring(Data.paste_type)\n// Clean escaped characters in content (double escaped Pastebin text)\n| extend PB_Content = replace(@'\\\\\\\\n', '\\n', PB_Data_ContentRaw)\n// Standard risk score normalization\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Projection standard across all your parsers\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Pastebin specific extracted values\n    PB_Author,\n    PB_ContentUpdatedOn,\n    PB_URL,\n    PB_Data_Author,\n    PB_Content,\n    PB_Data_Date,\n    PB_Data_PasteID,\n    PB_Data_SourceName,\n    PB_Data_SourceID,\n    PB_Data_URL,\n    PB_Data_PasteType,\n    PB_Data_Meta\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject31')._parserId31,'/'))))]",
      "dependsOn": [
        "[variables('parserObject31')._parserId31]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_pastebin')]",
        "contentId": "[variables('parserObject31').parserContentId31]",
        "kind": "Parser",
        "version": "[variables('parserObject31').parserVersion31]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject32').parserTemplateSpecName32]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_phishing Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject32').parserVersion32]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject32')._parserName32]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Phishing alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_phishing",
                "query": "CybleVisionAlerts_CL\n| where Service == \"phishing\"\n| extend Data = parse_json(Data)\n// Extract PH_* attributes\n| extend\n    PH_Domain           = tostring(Domain),\n    PH_ContentUpdatedOn = tostring(Content_Updated_On),\n    // Nested phishing data\n    PH_Brand              = tostring(Data.brand),\n    PH_BrandIndustry      = tostring(Data.brand_industry),\n    PH_BrandWebsite       = tostring(Data.brand_website),\n    PH_DomainName         = tostring(Data.domain_name),     // nested domain_name (the phishing landing)\n    PH_HostName           = tostring(Data.host_name),\n    PH_Title              = tostring(Data.['title']),\n    PH_ScreenshotURL      = tostring(Data.screenshot_url),\n    PH_Source             = tostring(Data.source),\n    PH_DetectedAt         = tostring(Data.detected_at),\n    PH_LastLiveOn         = tostring(Data.last_live_on),\n    PH_IsLive             = tostring(Data.is_live),\n    PH_IsTakedown         = tostring(Data.is_takedown),\n    PH_StatusCode         = tostring(Data.status_code),\n    PH_LogoMatch          = tostring(Data.logo_match),\n    PH_ContentMatch       = tostring(Data.content_match),\n    PH_IPDetail           = tostring(Data.IPDetail),\n    PH_AWSObjectName      = tostring(Data.aws_object_name),\n    PH_DOObjectName       = tostring(Data.do_object_name),\n    PH_Score              = tostring(Data.score),\n    PH_URLs               = tostring(Data.urls),\n    PH_PhishingKeyword    = tostring(Data.phishing_keyword_name), \n    PH_PhishingStatus     = tostring(Data.phishing_status),\n    // Risk normalization (consistent with your standard)\n    Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    BucketName,\n    Domain,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Service,\n    Risk_Score,\n    // Phishing specific extracted fields\n    PH_Brand,\n    PH_BrandIndustry,\n    PH_BrandWebsite,\n    PH_DomainName,\n    PH_HostName,\n    PH_Title,\n    PH_ScreenshotURL,\n    PH_Source,\n    PH_DetectedAt,\n    PH_LastLiveOn,\n    PH_IsLive,\n    PH_IsTakedown,\n    PH_StatusCode,\n    PH_LogoMatch,\n    PH_ContentMatch,\n    PH_IPDetail,\n    PH_AWSObjectName,\n    PH_DOObjectName,\n    PH_Score,\n    PH_URLs,\n    PH_PhishingKeyword,\n    PH_PhishingStatus,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject32')._parserId32,'/'))))]",
              "dependsOn": [
                "[variables('parserObject32')._parserId32]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_phishing')]",
                "contentId": "[variables('parserObject32').parserContentId32]",
                "kind": "Parser",
                "version": "[variables('parserObject32').parserVersion32]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject32').parserContentId32]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Phishing alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject32').parserContentId32,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject32').parserContentId32,'-', '1.0.0')))]",
        "version": "[variables('parserObject32').parserVersion32]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject32')._parserName32]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Phishing alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_phishing",
        "query": "CybleVisionAlerts_CL\n| where Service == \"phishing\"\n| extend Data = parse_json(Data)\n// Extract PH_* attributes\n| extend\n    PH_Domain           = tostring(Domain),\n    PH_ContentUpdatedOn = tostring(Content_Updated_On),\n    // Nested phishing data\n    PH_Brand              = tostring(Data.brand),\n    PH_BrandIndustry      = tostring(Data.brand_industry),\n    PH_BrandWebsite       = tostring(Data.brand_website),\n    PH_DomainName         = tostring(Data.domain_name),     // nested domain_name (the phishing landing)\n    PH_HostName           = tostring(Data.host_name),\n    PH_Title              = tostring(Data.['title']),\n    PH_ScreenshotURL      = tostring(Data.screenshot_url),\n    PH_Source             = tostring(Data.source),\n    PH_DetectedAt         = tostring(Data.detected_at),\n    PH_LastLiveOn         = tostring(Data.last_live_on),\n    PH_IsLive             = tostring(Data.is_live),\n    PH_IsTakedown         = tostring(Data.is_takedown),\n    PH_StatusCode         = tostring(Data.status_code),\n    PH_LogoMatch          = tostring(Data.logo_match),\n    PH_ContentMatch       = tostring(Data.content_match),\n    PH_IPDetail           = tostring(Data.IPDetail),\n    PH_AWSObjectName      = tostring(Data.aws_object_name),\n    PH_DOObjectName       = tostring(Data.do_object_name),\n    PH_Score              = tostring(Data.score),\n    PH_URLs               = tostring(Data.urls),\n    PH_PhishingKeyword    = tostring(Data.phishing_keyword_name), \n    PH_PhishingStatus     = tostring(Data.phishing_status),\n    // Risk normalization (consistent with your standard)\n    Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    BucketName,\n    Domain,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Service,\n    Risk_Score,\n    // Phishing specific extracted fields\n    PH_Brand,\n    PH_BrandIndustry,\n    PH_BrandWebsite,\n    PH_DomainName,\n    PH_HostName,\n    PH_Title,\n    PH_ScreenshotURL,\n    PH_Source,\n    PH_DetectedAt,\n    PH_LastLiveOn,\n    PH_IsLive,\n    PH_IsTakedown,\n    PH_StatusCode,\n    PH_LogoMatch,\n    PH_ContentMatch,\n    PH_IPDetail,\n    PH_AWSObjectName,\n    PH_DOObjectName,\n    PH_Score,\n    PH_URLs,\n    PH_PhishingKeyword,\n    PH_PhishingStatus,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject32')._parserId32,'/'))))]",
      "dependsOn": [
        "[variables('parserObject32')._parserId32]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_phishing')]",
        "contentId": "[variables('parserObject32').parserContentId32]",
        "kind": "Parser",
        "version": "[variables('parserObject32').parserVersion32]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject33').parserTemplateSpecName33]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_physical_threats Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject33').parserVersion33]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject33')._parserName33]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Physical Threats alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_physical_threats",
                "query": "CybleVisionAlerts_CL\n| where Service == \"physical_threats\"\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract nested physical threat fields\n| extend\n    PT_Address          = tostring(Data.address),\n    PT_BaseSourceName   = tostring(Data.base_source.name),\n    PT_BaseSourceURL    = tostring(Data.base_source.url),\n    PT_City_Nested      = tostring(Data.city),\n    PT_Country          = tostring(Data.country),\n    PT_Description      = tostring(Data.description),\n    PT_ID               = tostring(Data.id),\n    PT_LocationName     = tostring(Data.location_name),\n    PT_LocationType     = tostring(Data.location_type),\n    PT_Latitude         = todouble(Data.latitude),\n    PT_Longitude        = todouble(Data.longitude),\n    PT_PinID            = tostring(Data.pin_id),\n    PT_PinName_Nested   = tostring(Data.pin_name),\n    PT_PinString        = tostring(Data.pin_string),\n    PT_PublishedAt      = tostring(Data.published_at),\n    PT_Region           = tostring(Data.region),\n    PT_SeverityNested   = tostring(Data.severity),\n    PT_SourceCount      = tostring(Data.source_count),\n    PT_Sources          = tostring(Data.sources),\n    PT_State            = tostring(Data.state),\n    PT_ThreatType       = tostring(Data.threat_type),\n    PT_Title_Nested     = tostring(Data.['title'])\n// Pack risk score\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    PT_Address,\n    PT_BaseSourceName,\n    PT_BaseSourceURL,\n    PT_City_Nested,\n    PT_Country,\n    PT_Description,\n    PT_ID,\n    PT_LocationName,\n    PT_LocationType,\n    PT_Latitude,\n    PT_Longitude,\n    PT_PinID,\n    PT_PinName_Nested,\n    PT_PinString,\n    PT_PublishedAt,\n    PT_Region,\n    PT_SeverityNested,\n    PT_SourceCount,\n    PT_Sources,\n    PT_State,\n    PT_ThreatType,\n    PT_Title_Nested,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject33')._parserId33,'/'))))]",
              "dependsOn": [
                "[variables('parserObject33')._parserId33]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_physical_threats')]",
                "contentId": "[variables('parserObject33').parserContentId33]",
                "kind": "Parser",
                "version": "[variables('parserObject33').parserVersion33]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject33').parserContentId33]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Physical Threats alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject33').parserContentId33,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject33').parserContentId33,'-', '1.0.0')))]",
        "version": "[variables('parserObject33').parserVersion33]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject33')._parserName33]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Physical Threats alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_physical_threats",
        "query": "CybleVisionAlerts_CL\n| where Service == \"physical_threats\"\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract nested physical threat fields\n| extend\n    PT_Address          = tostring(Data.address),\n    PT_BaseSourceName   = tostring(Data.base_source.name),\n    PT_BaseSourceURL    = tostring(Data.base_source.url),\n    PT_City_Nested      = tostring(Data.city),\n    PT_Country          = tostring(Data.country),\n    PT_Description      = tostring(Data.description),\n    PT_ID               = tostring(Data.id),\n    PT_LocationName     = tostring(Data.location_name),\n    PT_LocationType     = tostring(Data.location_type),\n    PT_Latitude         = todouble(Data.latitude),\n    PT_Longitude        = todouble(Data.longitude),\n    PT_PinID            = tostring(Data.pin_id),\n    PT_PinName_Nested   = tostring(Data.pin_name),\n    PT_PinString        = tostring(Data.pin_string),\n    PT_PublishedAt      = tostring(Data.published_at),\n    PT_Region           = tostring(Data.region),\n    PT_SeverityNested   = tostring(Data.severity),\n    PT_SourceCount      = tostring(Data.source_count),\n    PT_Sources          = tostring(Data.sources),\n    PT_State            = tostring(Data.state),\n    PT_ThreatType       = tostring(Data.threat_type),\n    PT_Title_Nested     = tostring(Data.['title'])\n// Pack risk score\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    PT_Address,\n    PT_BaseSourceName,\n    PT_BaseSourceURL,\n    PT_City_Nested,\n    PT_Country,\n    PT_Description,\n    PT_ID,\n    PT_LocationName,\n    PT_LocationType,\n    PT_Latitude,\n    PT_Longitude,\n    PT_PinID,\n    PT_PinName_Nested,\n    PT_PinString,\n    PT_PublishedAt,\n    PT_Region,\n    PT_SeverityNested,\n    PT_SourceCount,\n    PT_Sources,\n    PT_State,\n    PT_ThreatType,\n    PT_Title_Nested,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject33')._parserId33,'/'))))]",
      "dependsOn": [
        "[variables('parserObject33')._parserId33]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_physical_threats')]",
        "contentId": "[variables('parserObject33').parserContentId33]",
        "kind": "Parser",
        "version": "[variables('parserObject33').parserVersion33]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject34').parserTemplateSpecName34]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_postman Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject34').parserVersion34]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject34')._parserName34]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Postman alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_postman",
                "query": "CybleVisionAlerts_CL\n| where Service == \"postman\"\n// Parse inner object\n| extend Data = parse_json(Data)\n// Extract Postman fields\n| extend\n    PM_Category          = tostring(Data.category),\n    PM_Collection        = tostring(Data.collection),\n    PM_DevelopedBy       = tostring(Data.developed_by),\n    PM_DevelopedByUrl    = tostring(Data.developed_by_url),\n    PM_Description       = tostring(Data.description),\n    PM_PostmanKey        = tostring(Data.postman_unique_key),\n    PM_Views             = toint(Data.['views']),\n    PM_Watchers          = toint(Data.watchers),\n    PM_ImageIconUrl      = tostring(Data.image_icon_url),\n    PM_LastUpdatedOn     = tostring(Data.last_updated_on),\n    PM_LastUpdatedOnDate = tostring(Data.last_updated_on_date),\n    PM_MetaData          = tostring(Data.meta_data),\n    PM_ScrappingTime     = tostring(Data.scrapping_time),\n    PM_SourceName        = tostring(Data.source_name),\n    PM_Title             = tostring(Data.['title']),\n    PM_UpdatedAt         = tostring(Data.updated_at),\n    PM_Url               = tostring(Data.url),\n    PM_IsPublic          = tostring(Data.is_public),\n    PM_APIs              = tostring(Data.apis),\n    PM_Forks             = tostring(Data.forks),\n    PM_Workspace         = tostring(Data.workspace),\n    PM_Keyword           = tostring(Data.keyword)\n// Pack risk score (same format used in all your parsers)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection SAME order & style across all your parsers\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Postman extracted fields\n    PM_Category,\n    PM_Collection,\n    PM_DevelopedBy,\n    PM_DevelopedByUrl,\n    PM_Description,\n    PM_PostmanKey,\n    PM_Views,\n    PM_Watchers,\n    PM_ImageIconUrl,\n    PM_LastUpdatedOn,\n    PM_LastUpdatedOnDate,\n    PM_MetaData,\n    PM_ScrappingTime,\n    PM_SourceName,\n    PM_Title,\n    PM_UpdatedAt,\n    PM_Url,\n    PM_IsPublic,\n    PM_APIs,\n    PM_Forks,\n    PM_Workspace,\n    PM_Keyword,\n    // raw parsed object\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject34')._parserId34,'/'))))]",
              "dependsOn": [
                "[variables('parserObject34')._parserId34]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_postman')]",
                "contentId": "[variables('parserObject34').parserContentId34]",
                "kind": "Parser",
                "version": "[variables('parserObject34').parserVersion34]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject34').parserContentId34]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Postman alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject34').parserContentId34,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject34').parserContentId34,'-', '1.0.0')))]",
        "version": "[variables('parserObject34').parserVersion34]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject34')._parserName34]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Postman alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_postman",
        "query": "CybleVisionAlerts_CL\n| where Service == \"postman\"\n// Parse inner object\n| extend Data = parse_json(Data)\n// Extract Postman fields\n| extend\n    PM_Category          = tostring(Data.category),\n    PM_Collection        = tostring(Data.collection),\n    PM_DevelopedBy       = tostring(Data.developed_by),\n    PM_DevelopedByUrl    = tostring(Data.developed_by_url),\n    PM_Description       = tostring(Data.description),\n    PM_PostmanKey        = tostring(Data.postman_unique_key),\n    PM_Views             = toint(Data.['views']),\n    PM_Watchers          = toint(Data.watchers),\n    PM_ImageIconUrl      = tostring(Data.image_icon_url),\n    PM_LastUpdatedOn     = tostring(Data.last_updated_on),\n    PM_LastUpdatedOnDate = tostring(Data.last_updated_on_date),\n    PM_MetaData          = tostring(Data.meta_data),\n    PM_ScrappingTime     = tostring(Data.scrapping_time),\n    PM_SourceName        = tostring(Data.source_name),\n    PM_Title             = tostring(Data.['title']),\n    PM_UpdatedAt         = tostring(Data.updated_at),\n    PM_Url               = tostring(Data.url),\n    PM_IsPublic          = tostring(Data.is_public),\n    PM_APIs              = tostring(Data.apis),\n    PM_Forks             = tostring(Data.forks),\n    PM_Workspace         = tostring(Data.workspace),\n    PM_Keyword           = tostring(Data.keyword)\n// Pack risk score (same format used in all your parsers)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection SAME order & style across all your parsers\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Postman extracted fields\n    PM_Category,\n    PM_Collection,\n    PM_DevelopedBy,\n    PM_DevelopedByUrl,\n    PM_Description,\n    PM_PostmanKey,\n    PM_Views,\n    PM_Watchers,\n    PM_ImageIconUrl,\n    PM_LastUpdatedOn,\n    PM_LastUpdatedOnDate,\n    PM_MetaData,\n    PM_ScrappingTime,\n    PM_SourceName,\n    PM_Title,\n    PM_UpdatedAt,\n    PM_Url,\n    PM_IsPublic,\n    PM_APIs,\n    PM_Forks,\n    PM_Workspace,\n    PM_Keyword,\n    // raw parsed object\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject34')._parserId34,'/'))))]",
      "dependsOn": [
        "[variables('parserObject34')._parserId34]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_postman')]",
        "contentId": "[variables('parserObject34').parserContentId34]",
        "kind": "Parser",
        "version": "[variables('parserObject34').parserVersion34]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject35').parserTemplateSpecName35]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_product_vulnerability Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject35').parserVersion35]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject35')._parserName35]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Product Vulnerability alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_product_vulnerability",
                "query": "CybleVisionAlerts_CL\n| where Service == \"product_vulnerability\"\n| extend Data = parse_json(Data)\n// Extract nested fields from Data (only nested no top level duplication)\n| extend\n    PV_Company            = tostring(Data.company),\n    PV_CVE_ID             = tostring(Data.cve_id),\n    PV_DocID              = tostring(Data.doc_id),\n    PV_Product            = tostring(Data.product),\n    PV_Title              = tostring(Data.['title']),\n    PV_Version            = tostring(Data.version),\n    PV_UpdatedFields      = tostring(Data.updated_fields),\n    PV_Tags               = tostring(Data.tags),\n    // New CVE details\n    PV_New_Counter_Name        = tostring(Data.new_cve_details.countermeasure.name),\n    PV_New_Counter_Remediation = tostring(Data.new_cve_details.countermeasure.remediationlevel),\n    PV_New_Exploitability      = tostring(Data.new_cve_details.exploit.exploitability),\n    PV_New_EPS_Score           = tostring(Data.new_cve_details.exploit.epss.score),\n    PV_New_EPS_Percentile      = tostring(Data.new_cve_details.exploit.epss.percentile),\n    PV_New_Price_0day          = tostring(Data.new_cve_details.exploit.price.['0day']),\n    PV_New_Price_Today         = tostring(Data.new_cve_details.exploit.price.today),\n    // Old CVE details\n    PV_Old_EPS_Score           = tostring(Data.old_cve_details.exploit.epss.score),\n    PV_Old_EPS_Percentile      = tostring(Data.old_cve_details.exploit.epss.percentile),\n    PV_Old_Price_0day          = tostring(Data.old_cve_details.exploit.price.['0day']),\n    PV_Old_Price_Today         = tostring(Data.old_cve_details.exploit.price.today),\n    // Software details (nested)\n    PV_SW_Company              = tostring(Data.software_details.company),\n    PV_SW_CompanyID            = tostring(Data.software_details.company_id),\n    PV_SW_Software             = tostring(Data.software_details.software),\n    PV_SW_Version              = tostring(Data.software_details.version),\n    PV_SW_CreatedAt            = tostring(Data.software_details.created_at),\n    PV_SW_UpdatedAt            = tostring(Data.software_details.updated_at),\n    PV_SW_LastAlertDate        = tostring(Data.software_details.last_alert_date),\n    PV_SW_UserID               = tostring(Data.software_details.user_id)\n// Standard risk packing\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (standard columns + PV fields)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Parsed PV fields\n    PV_Company,\n    PV_CVE_ID,\n    PV_DocID,\n    PV_Product,\n    PV_Title,\n    PV_Version,\n    PV_UpdatedFields,\n    PV_Tags,\n    PV_New_Counter_Name,\n    PV_New_Counter_Remediation,\n    PV_New_Exploitability,\n    PV_New_EPS_Score,\n    PV_New_EPS_Percentile,\n    PV_New_Price_0day,\n    PV_New_Price_Today,\n    PV_Old_EPS_Score,\n    PV_Old_EPS_Percentile,\n    PV_Old_Price_0day,\n    PV_Old_Price_Today,\n    PV_SW_Company,\n    PV_SW_CompanyID,\n    PV_SW_Software,\n    PV_SW_Version,\n    PV_SW_CreatedAt,\n    PV_SW_UpdatedAt,\n    PV_SW_LastAlertDate,\n    PV_SW_UserID,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject35')._parserId35,'/'))))]",
              "dependsOn": [
                "[variables('parserObject35')._parserId35]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_product_vulnerability')]",
                "contentId": "[variables('parserObject35').parserContentId35]",
                "kind": "Parser",
                "version": "[variables('parserObject35').parserVersion35]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject35').parserContentId35]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Product Vulnerability alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject35').parserContentId35,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject35').parserContentId35,'-', '1.0.0')))]",
        "version": "[variables('parserObject35').parserVersion35]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject35')._parserName35]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Product Vulnerability alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_product_vulnerability",
        "query": "CybleVisionAlerts_CL\n| where Service == \"product_vulnerability\"\n| extend Data = parse_json(Data)\n// Extract nested fields from Data (only nested no top level duplication)\n| extend\n    PV_Company            = tostring(Data.company),\n    PV_CVE_ID             = tostring(Data.cve_id),\n    PV_DocID              = tostring(Data.doc_id),\n    PV_Product            = tostring(Data.product),\n    PV_Title              = tostring(Data.['title']),\n    PV_Version            = tostring(Data.version),\n    PV_UpdatedFields      = tostring(Data.updated_fields),\n    PV_Tags               = tostring(Data.tags),\n    // New CVE details\n    PV_New_Counter_Name        = tostring(Data.new_cve_details.countermeasure.name),\n    PV_New_Counter_Remediation = tostring(Data.new_cve_details.countermeasure.remediationlevel),\n    PV_New_Exploitability      = tostring(Data.new_cve_details.exploit.exploitability),\n    PV_New_EPS_Score           = tostring(Data.new_cve_details.exploit.epss.score),\n    PV_New_EPS_Percentile      = tostring(Data.new_cve_details.exploit.epss.percentile),\n    PV_New_Price_0day          = tostring(Data.new_cve_details.exploit.price.['0day']),\n    PV_New_Price_Today         = tostring(Data.new_cve_details.exploit.price.today),\n    // Old CVE details\n    PV_Old_EPS_Score           = tostring(Data.old_cve_details.exploit.epss.score),\n    PV_Old_EPS_Percentile      = tostring(Data.old_cve_details.exploit.epss.percentile),\n    PV_Old_Price_0day          = tostring(Data.old_cve_details.exploit.price.['0day']),\n    PV_Old_Price_Today         = tostring(Data.old_cve_details.exploit.price.today),\n    // Software details (nested)\n    PV_SW_Company              = tostring(Data.software_details.company),\n    PV_SW_CompanyID            = tostring(Data.software_details.company_id),\n    PV_SW_Software             = tostring(Data.software_details.software),\n    PV_SW_Version              = tostring(Data.software_details.version),\n    PV_SW_CreatedAt            = tostring(Data.software_details.created_at),\n    PV_SW_UpdatedAt            = tostring(Data.software_details.updated_at),\n    PV_SW_LastAlertDate        = tostring(Data.software_details.last_alert_date),\n    PV_SW_UserID               = tostring(Data.software_details.user_id)\n// Standard risk packing\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (standard columns + PV fields)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Parsed PV fields\n    PV_Company,\n    PV_CVE_ID,\n    PV_DocID,\n    PV_Product,\n    PV_Title,\n    PV_Version,\n    PV_UpdatedFields,\n    PV_Tags,\n    PV_New_Counter_Name,\n    PV_New_Counter_Remediation,\n    PV_New_Exploitability,\n    PV_New_EPS_Score,\n    PV_New_EPS_Percentile,\n    PV_New_Price_0day,\n    PV_New_Price_Today,\n    PV_Old_EPS_Score,\n    PV_Old_EPS_Percentile,\n    PV_Old_Price_0day,\n    PV_Old_Price_Today,\n    PV_SW_Company,\n    PV_SW_CompanyID,\n    PV_SW_Software,\n    PV_SW_Version,\n    PV_SW_CreatedAt,\n    PV_SW_UpdatedAt,\n    PV_SW_LastAlertDate,\n    PV_SW_UserID,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject35')._parserId35,'/'))))]",
      "dependsOn": [
        "[variables('parserObject35')._parserId35]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_product_vulnerability')]",
        "contentId": "[variables('parserObject35').parserContentId35]",
        "kind": "Parser",
        "version": "[variables('parserObject35').parserVersion35]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject36').parserTemplateSpecName36]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ransomware_updates Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject36').parserVersion36]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject36')._parserName36]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Ransomware Updates alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_ransomware_updates",
                "query": "CybleVisionAlerts_CL\n| where Service == \"ransomware_updates\"\n| extend Data = parse_json(Data)\n// Extract nested ransomware update fields\n| extend\n    RW_Country        = tostring(Data.country),\n    RW_CreatedAt      = tostring(Data.created_at),\n    RW_Date           = tostring(Data.['date']),\n    RW_Description    = tostring(Data.description),\n    RW_Gang           = tostring(Data.gang),\n    RW_Hash           = tostring(Data.hash),\n    RW_RecordID       = tostring(Data.id),\n    RW_Industry       = tostring(Data.industry),\n    RW_Region         = tostring(Data.region),\n    RW_UpdatedAt      = tostring(Data.updated_at),\n    RW_Victim         = tostring(Data.victim),\n    RW_Website        = tostring(Data.website)\n// Normalized risk score\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (standard columns + parsed RW fields)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Parsed ransomware fields\n    RW_Country,\n    RW_CreatedAt,\n    RW_Date,\n    RW_Description,\n    RW_Gang,\n    RW_Hash,\n    RW_RecordID,\n    RW_Industry,\n    RW_Region,\n    RW_UpdatedAt,\n    RW_Victim,\n    RW_Website,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject36')._parserId36,'/'))))]",
              "dependsOn": [
                "[variables('parserObject36')._parserId36]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ransomware_updates')]",
                "contentId": "[variables('parserObject36').parserContentId36]",
                "kind": "Parser",
                "version": "[variables('parserObject36').parserVersion36]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject36').parserContentId36]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Ransomware Updates alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject36').parserContentId36,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject36').parserContentId36,'-', '1.0.0')))]",
        "version": "[variables('parserObject36').parserVersion36]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject36')._parserName36]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Ransomware Updates alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_ransomware_updates",
        "query": "CybleVisionAlerts_CL\n| where Service == \"ransomware_updates\"\n| extend Data = parse_json(Data)\n// Extract nested ransomware update fields\n| extend\n    RW_Country        = tostring(Data.country),\n    RW_CreatedAt      = tostring(Data.created_at),\n    RW_Date           = tostring(Data.['date']),\n    RW_Description    = tostring(Data.description),\n    RW_Gang           = tostring(Data.gang),\n    RW_Hash           = tostring(Data.hash),\n    RW_RecordID       = tostring(Data.id),\n    RW_Industry       = tostring(Data.industry),\n    RW_Region         = tostring(Data.region),\n    RW_UpdatedAt      = tostring(Data.updated_at),\n    RW_Victim         = tostring(Data.victim),\n    RW_Website        = tostring(Data.website)\n// Normalized risk score\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (standard columns + parsed RW fields)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Parsed ransomware fields\n    RW_Country,\n    RW_CreatedAt,\n    RW_Date,\n    RW_Description,\n    RW_Gang,\n    RW_Hash,\n    RW_RecordID,\n    RW_Industry,\n    RW_Region,\n    RW_UpdatedAt,\n    RW_Victim,\n    RW_Website,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject36')._parserId36,'/'))))]",
      "dependsOn": [
        "[variables('parserObject36')._parserId36]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ransomware_updates')]",
        "contentId": "[variables('parserObject36').parserContentId36]",
        "kind": "Parser",
        "version": "[variables('parserObject36').parserVersion36]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject37').parserTemplateSpecName37]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_social_media_monitoring Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject37').parserVersion37]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject37')._parserName37]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Social Media Monitoring Data Message alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_social_media_monitoring",
                "query": "CybleVisionAlerts_CL\n| extend MappedSeverity = Severity\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"social_media_monitoring\"\n| extend AlertID = ID\n| extend ParsedData = parse_json(Data)\n| extend\n    SM_Category           = tostring(ParsedData.category),\n    SM_Confidence         = tostring(ParsedData.confidence),\n    SM_ConfidenceScore    = toint(ParsedData.confidence_score),\n    SM_FindingId          = tostring(ParsedData.finding_id),\n    SM_DataId             = tostring(ParsedData.id),\n    SM_Language           = tostring(ParsedData.language),\n    SM_Location           = tostring(ParsedData.location),\n    SM_SentimentData      = tostring(ParsedData.sentiment),\n    SM_SourceData         = tostring(ParsedData.source),\n    SM_TypeData           = tostring(ParsedData.type),\n    SM_Weightage          = toint(ParsedData.weightage),\n    SM_Tags               = tostring(ParsedData.tags)\n| extend\n    SM_Content            = tostring(ParsedData.metadata.extras.content),\n    SM_ContentHash        = tostring(ParsedData.metadata.extras.content_hash),\n    SM_MainUrl            = tostring(ParsedData.metadata.extras.url)\n| extend\n    SM_CreatorName        = tostring(ParsedData.metadata.extras.creator.name),\n    SM_CreatorId          = tostring(ParsedData.metadata.extras.creator.id),\n    SM_CreatorFollowers   = toint(ParsedData.metadata.extras.creator.followers),\n    SM_CreatorFollowing   = toint(ParsedData.metadata.extras.creator.following),\n    SM_CreatorIsVerified  = tostring(ParsedData.metadata.extras.creator.is_verified),\n    SM_CreatorDescription = tostring(ParsedData.metadata.extras.creator.description),\n    SM_CreatorUrl         = tostring(ParsedData.metadata.extras.creator.url),\n    SM_CreatorUsername    = tostring(ParsedData.metadata.extras.creator.username)\n| extend\n    SM_Domains            = tostring(ParsedData.metadata.extras.extracts.domains),\n    SM_Subdomains         = tostring(ParsedData.metadata.extras.extracts.subdomains),\n    SM_Urls               = tostring(ParsedData.metadata.extras.extracts.urls)\n| mv-expand Rules = ParsedData.rules\n| extend\n    SM_RuleName           = tostring(Rules.name),\n    SM_RuleNiceName       = tostring(Rules.nice_name),\n    SM_RuleWeight         = toint(Rules.weightage)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    DataID,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    SM_Category,\n    SM_Confidence,\n    SM_ConfidenceScore,\n    SM_FindingId,\n    SM_DataId,\n    SM_Language,\n    SM_Location,\n    SM_SentimentData,\n    SM_SourceData,\n    SM_TypeData,\n    SM_Weightage,\n    SM_Tags,\n    SM_Content,\n    SM_ContentHash,\n    SM_MainUrl,\n    SM_CreatorName,\n    SM_CreatorId,\n    SM_CreatorFollowers,\n    SM_CreatorFollowing,\n    SM_CreatorIsVerified,\n    SM_CreatorDescription,\n    SM_CreatorUrl,\n    SM_CreatorUsername,\n    SM_Domains,\n    SM_Subdomains,\n    SM_Urls,\n    SM_RuleName,\n    SM_RuleNiceName,\n    SM_RuleWeight\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject37')._parserId37,'/'))))]",
              "dependsOn": [
                "[variables('parserObject37')._parserId37]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_social_media_monitoring')]",
                "contentId": "[variables('parserObject37').parserContentId37]",
                "kind": "Parser",
                "version": "[variables('parserObject37').parserVersion37]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject37').parserContentId37]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Social Media Monitoring Data Message alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject37').parserContentId37,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject37').parserContentId37,'-', '1.0.0')))]",
        "version": "[variables('parserObject37').parserVersion37]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject37')._parserName37]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Social Media Monitoring Data Message alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_social_media_monitoring",
        "query": "CybleVisionAlerts_CL\n| extend MappedSeverity = Severity\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"social_media_monitoring\"\n| extend AlertID = ID\n| extend ParsedData = parse_json(Data)\n| extend\n    SM_Category           = tostring(ParsedData.category),\n    SM_Confidence         = tostring(ParsedData.confidence),\n    SM_ConfidenceScore    = toint(ParsedData.confidence_score),\n    SM_FindingId          = tostring(ParsedData.finding_id),\n    SM_DataId             = tostring(ParsedData.id),\n    SM_Language           = tostring(ParsedData.language),\n    SM_Location           = tostring(ParsedData.location),\n    SM_SentimentData      = tostring(ParsedData.sentiment),\n    SM_SourceData         = tostring(ParsedData.source),\n    SM_TypeData           = tostring(ParsedData.type),\n    SM_Weightage          = toint(ParsedData.weightage),\n    SM_Tags               = tostring(ParsedData.tags)\n| extend\n    SM_Content            = tostring(ParsedData.metadata.extras.content),\n    SM_ContentHash        = tostring(ParsedData.metadata.extras.content_hash),\n    SM_MainUrl            = tostring(ParsedData.metadata.extras.url)\n| extend\n    SM_CreatorName        = tostring(ParsedData.metadata.extras.creator.name),\n    SM_CreatorId          = tostring(ParsedData.metadata.extras.creator.id),\n    SM_CreatorFollowers   = toint(ParsedData.metadata.extras.creator.followers),\n    SM_CreatorFollowing   = toint(ParsedData.metadata.extras.creator.following),\n    SM_CreatorIsVerified  = tostring(ParsedData.metadata.extras.creator.is_verified),\n    SM_CreatorDescription = tostring(ParsedData.metadata.extras.creator.description),\n    SM_CreatorUrl         = tostring(ParsedData.metadata.extras.creator.url),\n    SM_CreatorUsername    = tostring(ParsedData.metadata.extras.creator.username)\n| extend\n    SM_Domains            = tostring(ParsedData.metadata.extras.extracts.domains),\n    SM_Subdomains         = tostring(ParsedData.metadata.extras.extracts.subdomains),\n    SM_Urls               = tostring(ParsedData.metadata.extras.extracts.urls)\n| mv-expand Rules = ParsedData.rules\n| extend\n    SM_RuleName           = tostring(Rules.name),\n    SM_RuleNiceName       = tostring(Rules.nice_name),\n    SM_RuleWeight         = toint(Rules.weightage)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    DataID,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    SM_Category,\n    SM_Confidence,\n    SM_ConfidenceScore,\n    SM_FindingId,\n    SM_DataId,\n    SM_Language,\n    SM_Location,\n    SM_SentimentData,\n    SM_SourceData,\n    SM_TypeData,\n    SM_Weightage,\n    SM_Tags,\n    SM_Content,\n    SM_ContentHash,\n    SM_MainUrl,\n    SM_CreatorName,\n    SM_CreatorId,\n    SM_CreatorFollowers,\n    SM_CreatorFollowing,\n    SM_CreatorIsVerified,\n    SM_CreatorDescription,\n    SM_CreatorUrl,\n    SM_CreatorUsername,\n    SM_Domains,\n    SM_Subdomains,\n    SM_Urls,\n    SM_RuleName,\n    SM_RuleNiceName,\n    SM_RuleWeight\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject37')._parserId37,'/'))))]",
      "dependsOn": [
        "[variables('parserObject37')._parserId37]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_social_media_monitoring')]",
        "contentId": "[variables('parserObject37').parserContentId37]",
        "kind": "Parser",
        "version": "[variables('parserObject37').parserVersion37]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject38').parserTemplateSpecName38]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_ssl_expiry Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject38').parserVersion38]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject38')._parserName38]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract SSL Expiry alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_ssl_expiry",
                "query": "CybleVisionAlerts_CL\n| where Service == \"ssl_expiry\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// inner object (Data.data)\n| extend Inner = Data.data\n// Extract the nested SSL detail safely (detail is a doubleencoded JSON string)\n| extend RawDetail = tostring(Data.data.detail)\n// Normalize double escaping if present\n| extend NormalizedDetail =\n    case(\n        isempty(RawDetail), \"{}\", \n        RawDetail startswith \"{\\\\\\\"\", RawDetail,                      // already correct JSON string\n        RawDetail startswith \"\\\\\\\\\\\"\", replace(@'\\\\\\\\\\\"', '\"', RawDetail), // fix double escaped JSON\n        RawDetail\n    )\n// Parse JSON from the normalized string\n| extend CertObj = parse_json(NormalizedDetail)\n// If parsing failed fallback to empty object\n| extend CertObj = iif(isnull(CertObj) or isempty(tostring(CertObj)), dynamic({}), CertObj)\n// Certificate fields\n| extend\n    SS_Asset                 = tostring(Inner.asset),\n    SS_Expiry                = tostring(Inner.expiry),\n    SS_Age                   = toint(Inner.age),\n    SS_DaysUntilExpiry       = toint(Inner.days),\n    SS_Expiry_ISO            = tostring(Inner.data.expiry)\n// From parsed certificate object (CertObj)\n| extend\n    SS_Cert_Fingerprint_MD5    = tostring(CertObj.certificate.fingerprint_md5),\n    SS_Cert_Fingerprint_SHA1   = tostring(CertObj.certificate.fingerprint_sha1),\n    SS_Cert_Fingerprint_SHA256 = tostring(CertObj.certificate.fingerprint_sha256),\n    SS_Cert_IsExpired          = tostring(CertObj.certificate.is_expired),\n    SS_Cert_Issuer_CN          = tostring(CertObj.certificate.issuer.common_name[0]),\n    SS_Cert_Issuer_O           = tostring(CertObj.certificate.issuer.organization[0]),\n    SS_Cert_Issuer_C           = tostring(CertObj.certificate.issuer.country[0]),\n    SS_Cert_Subject_CN         = tostring(CertObj.certificate.subject.common_name[0]),\n    SS_Cert_Serial             = tostring(CertObj.certificate.serial_number),\n    SS_Cert_Valid_NotBefore    = tostring(CertObj.certificate.validity.not_before),\n    SS_Cert_Valid_NotAfter     = tostring(CertObj.certificate.validity.not_after),\n    SS_Cert_Version            = tostring(CertObj.certificate.version),\n    SS_Cert_Raw                = tostring(CertObj.certificate.raw)\n// Subject Alternative Names\n| extend SS_SAN_Array = \n    iif(isnull(CertObj.certificate.subject_alt_name) or isempty(tostring(CertObj.certificate.subject_alt_name)),\n        dynamic([]),\n        todynamic(CertObj.certificate.subject_alt_name.dns_names))\n| extend SS_SANs = \n    iif(isnull(SS_SAN_Array) or array_length(SS_SAN_Array) == 0, \"\", strcat_array(SS_SAN_Array, \",\"))\n// Fallbacks: certificate payload nested inside Inner.data\n| extend InnerData = parse_json(tostring(Inner.data))\n| extend\n    SS_Title   = tostring(InnerData.['title']),\n    SS_Port    = toint(InnerData.port),\n    SS_Hash    = tostring(InnerData.hash),\n    SS_IsValid = tostring(InnerData.is_valid),\n    SS_Issued  = tostring(InnerData.issued)\n// Tags\n| extend SS_Tags = tostring(Tags)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    SS_Asset,\n    SS_Expiry,\n    SS_DaysUntilExpiry,\n    SS_Age,\n    SS_Title,\n    SS_Port,\n    SS_Hash,\n    SS_IsValid,\n    SS_Issued,\n    SS_Cert_Fingerprint_MD5,\n    SS_Cert_Fingerprint_SHA1,\n    SS_Cert_Fingerprint_SHA256,\n    SS_Cert_IsExpired,\n    SS_Cert_Issuer_CN,\n    SS_Cert_Issuer_O,\n    SS_Cert_Issuer_C,\n    SS_Cert_Subject_CN,\n    SS_SANs,\n    SS_Cert_Serial,\n    SS_Cert_Valid_NotBefore,\n    SS_Cert_Valid_NotAfter,\n    SS_Cert_Version,\n    SS_Cert_Raw,\n    SS_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject38')._parserId38,'/'))))]",
              "dependsOn": [
                "[variables('parserObject38')._parserId38]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ssl_expiry')]",
                "contentId": "[variables('parserObject38').parserContentId38]",
                "kind": "Parser",
                "version": "[variables('parserObject38').parserVersion38]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject38').parserContentId38]",
        "contentKind": "Parser",
        "displayName": "Parser to extract SSL Expiry alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject38').parserContentId38,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject38').parserContentId38,'-', '1.0.0')))]",
        "version": "[variables('parserObject38').parserVersion38]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject38')._parserName38]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract SSL Expiry alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_ssl_expiry",
        "query": "CybleVisionAlerts_CL\n| where Service == \"ssl_expiry\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// inner object (Data.data)\n| extend Inner = Data.data\n// Extract the nested SSL detail safely (detail is a doubleencoded JSON string)\n| extend RawDetail = tostring(Data.data.detail)\n// Normalize double escaping if present\n| extend NormalizedDetail =\n    case(\n        isempty(RawDetail), \"{}\", \n        RawDetail startswith \"{\\\\\\\"\", RawDetail,                      // already correct JSON string\n        RawDetail startswith \"\\\\\\\\\\\"\", replace(@'\\\\\\\\\\\"', '\"', RawDetail), // fix double escaped JSON\n        RawDetail\n    )\n// Parse JSON from the normalized string\n| extend CertObj = parse_json(NormalizedDetail)\n// If parsing failed fallback to empty object\n| extend CertObj = iif(isnull(CertObj) or isempty(tostring(CertObj)), dynamic({}), CertObj)\n// Certificate fields\n| extend\n    SS_Asset                 = tostring(Inner.asset),\n    SS_Expiry                = tostring(Inner.expiry),\n    SS_Age                   = toint(Inner.age),\n    SS_DaysUntilExpiry       = toint(Inner.days),\n    SS_Expiry_ISO            = tostring(Inner.data.expiry)\n// From parsed certificate object (CertObj)\n| extend\n    SS_Cert_Fingerprint_MD5    = tostring(CertObj.certificate.fingerprint_md5),\n    SS_Cert_Fingerprint_SHA1   = tostring(CertObj.certificate.fingerprint_sha1),\n    SS_Cert_Fingerprint_SHA256 = tostring(CertObj.certificate.fingerprint_sha256),\n    SS_Cert_IsExpired          = tostring(CertObj.certificate.is_expired),\n    SS_Cert_Issuer_CN          = tostring(CertObj.certificate.issuer.common_name[0]),\n    SS_Cert_Issuer_O           = tostring(CertObj.certificate.issuer.organization[0]),\n    SS_Cert_Issuer_C           = tostring(CertObj.certificate.issuer.country[0]),\n    SS_Cert_Subject_CN         = tostring(CertObj.certificate.subject.common_name[0]),\n    SS_Cert_Serial             = tostring(CertObj.certificate.serial_number),\n    SS_Cert_Valid_NotBefore    = tostring(CertObj.certificate.validity.not_before),\n    SS_Cert_Valid_NotAfter     = tostring(CertObj.certificate.validity.not_after),\n    SS_Cert_Version            = tostring(CertObj.certificate.version),\n    SS_Cert_Raw                = tostring(CertObj.certificate.raw)\n// Subject Alternative Names\n| extend SS_SAN_Array = \n    iif(isnull(CertObj.certificate.subject_alt_name) or isempty(tostring(CertObj.certificate.subject_alt_name)),\n        dynamic([]),\n        todynamic(CertObj.certificate.subject_alt_name.dns_names))\n| extend SS_SANs = \n    iif(isnull(SS_SAN_Array) or array_length(SS_SAN_Array) == 0, \"\", strcat_array(SS_SAN_Array, \",\"))\n// Fallbacks: certificate payload nested inside Inner.data\n| extend InnerData = parse_json(tostring(Inner.data))\n| extend\n    SS_Title   = tostring(InnerData.['title']),\n    SS_Port    = toint(InnerData.port),\n    SS_Hash    = tostring(InnerData.hash),\n    SS_IsValid = tostring(InnerData.is_valid),\n    SS_Issued  = tostring(InnerData.issued)\n// Tags\n| extend SS_Tags = tostring(Tags)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    SS_Asset,\n    SS_Expiry,\n    SS_DaysUntilExpiry,\n    SS_Age,\n    SS_Title,\n    SS_Port,\n    SS_Hash,\n    SS_IsValid,\n    SS_Issued,\n    SS_Cert_Fingerprint_MD5,\n    SS_Cert_Fingerprint_SHA1,\n    SS_Cert_Fingerprint_SHA256,\n    SS_Cert_IsExpired,\n    SS_Cert_Issuer_CN,\n    SS_Cert_Issuer_O,\n    SS_Cert_Issuer_C,\n    SS_Cert_Subject_CN,\n    SS_SANs,\n    SS_Cert_Serial,\n    SS_Cert_Valid_NotBefore,\n    SS_Cert_Valid_NotAfter,\n    SS_Cert_Version,\n    SS_Cert_Raw,\n    SS_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject38')._parserId38,'/'))))]",
      "dependsOn": [
        "[variables('parserObject38')._parserId38]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_ssl_expiry')]",
        "contentId": "[variables('parserObject38').parserContentId38]",
        "kind": "Parser",
        "version": "[variables('parserObject38').parserVersion38]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject39').parserTemplateSpecName39]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_stealer_logs Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject39').parserVersion39]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject39')._parserName39]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Stealer Logs alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_stealer_logs",
                "query": "CybleVisionAlerts_CL\n| where Service == \"stealer_logs\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// Extract: data.content\n| extend Content = Data.content\n| extend\n    SL_App                = tostring(Content.Application),\n    SL_URL_Content        = tostring(Content.URL),\n    SL_Username_Content   = tostring(Content.Username),\n    SL_Password           = tostring(Content.Password)\n// Extract: data.content_related_info\n| extend Rel = Data.content_related_info\n| extend\n    SL_HWID               = tostring(Rel.HWID),\n    SL_IP                 = tostring(Rel.IP),\n    SL_Country            = tostring(Rel.country_name),\n    SL_Domain             = tostring(Rel.domain),\n    SL_TA                 = tostring(Rel.ta),\n    SL_UserHashAD         = tostring(Rel.user_hash_ad),\n    SL_CompromiseDate2    = tostring(Rel.compromise_date)\n// Extract: data.file_metadata\n| extend FM = Data.file_metadata\n| extend\n    SL_FileName           = tostring(FM.filename),\n    SL_FileSize           = toint(FM.size),\n    SL_FileCreated        = tostring(FM.c_date),\n    SL_FileModified       = tostring(FM.m_date)\n// Additional fields in data\n| extend\n    SL_DocID              = tostring(Data.doc_id),\n    SL_CreatedOn          = tostring(Data.created_on),\n    SL_ParentFolder       = tostring(Data.parent_folder_path_id)\n// Root level fields\n| extend\n    SL_MainURL            = tostring(url),\n    SL_MainUsername       = tostring(Username),\n    SL_CompromiseDate     = tostring(Compromised_Date),\n    SL_MalwareFamily      = tostring(malware_family)\n// Tags\n| extend SL_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    SL_App,\n    SL_URL_Content,\n    SL_Username_Content,\n    SL_Password,\n    SL_HWID,\n    SL_IP,\n    SL_Country,\n    SL_Domain,\n    SL_TA,\n    SL_UserHashAD,\n    SL_CompromiseDate2,\n    SL_FileName,\n    SL_FileSize,\n    SL_FileCreated,\n    SL_FileModified,\n    SL_DocID,\n    SL_CreatedOn,\n    SL_ParentFolder,\n    SL_MainURL,\n    SL_MainUsername,\n    SL_CompromiseDate,\n    SL_MalwareFamily,\n    SL_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject39')._parserId39,'/'))))]",
              "dependsOn": [
                "[variables('parserObject39')._parserId39]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_stealer_logs')]",
                "contentId": "[variables('parserObject39').parserContentId39]",
                "kind": "Parser",
                "version": "[variables('parserObject39').parserVersion39]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject39').parserContentId39]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Stealer Logs alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject39').parserContentId39,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject39').parserContentId39,'-', '1.0.0')))]",
        "version": "[variables('parserObject39').parserVersion39]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject39')._parserName39]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Stealer Logs alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_stealer_logs",
        "query": "CybleVisionAlerts_CL\n| where Service == \"stealer_logs\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// Extract: data.content\n| extend Content = Data.content\n| extend\n    SL_App                = tostring(Content.Application),\n    SL_URL_Content        = tostring(Content.URL),\n    SL_Username_Content   = tostring(Content.Username),\n    SL_Password           = tostring(Content.Password)\n// Extract: data.content_related_info\n| extend Rel = Data.content_related_info\n| extend\n    SL_HWID               = tostring(Rel.HWID),\n    SL_IP                 = tostring(Rel.IP),\n    SL_Country            = tostring(Rel.country_name),\n    SL_Domain             = tostring(Rel.domain),\n    SL_TA                 = tostring(Rel.ta),\n    SL_UserHashAD         = tostring(Rel.user_hash_ad),\n    SL_CompromiseDate2    = tostring(Rel.compromise_date)\n// Extract: data.file_metadata\n| extend FM = Data.file_metadata\n| extend\n    SL_FileName           = tostring(FM.filename),\n    SL_FileSize           = toint(FM.size),\n    SL_FileCreated        = tostring(FM.c_date),\n    SL_FileModified       = tostring(FM.m_date)\n// Additional fields in data\n| extend\n    SL_DocID              = tostring(Data.doc_id),\n    SL_CreatedOn          = tostring(Data.created_on),\n    SL_ParentFolder       = tostring(Data.parent_folder_path_id)\n// Root level fields\n| extend\n    SL_MainURL            = tostring(url),\n    SL_MainUsername       = tostring(Username),\n    SL_CompromiseDate     = tostring(Compromised_Date),\n    SL_MalwareFamily      = tostring(malware_family)\n// Tags\n| extend SL_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    SL_App,\n    SL_URL_Content,\n    SL_Username_Content,\n    SL_Password,\n    SL_HWID,\n    SL_IP,\n    SL_Country,\n    SL_Domain,\n    SL_TA,\n    SL_UserHashAD,\n    SL_CompromiseDate2,\n    SL_FileName,\n    SL_FileSize,\n    SL_FileCreated,\n    SL_FileModified,\n    SL_DocID,\n    SL_CreatedOn,\n    SL_ParentFolder,\n    SL_MainURL,\n    SL_MainUsername,\n    SL_CompromiseDate,\n    SL_MalwareFamily,\n    SL_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject39')._parserId39,'/'))))]",
      "dependsOn": [
        "[variables('parserObject39')._parserId39]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_stealer_logs')]",
        "contentId": "[variables('parserObject39').parserContentId39]",
        "kind": "Parser",
        "version": "[variables('parserObject39').parserVersion39]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject40').parserTemplateSpecName40]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_subdomains Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject40').parserVersion40]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject40')._parserName40]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Subdomains alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_subdomains",
                "query": "CybleVisionAlerts_CL\n| where Service == \"subdomains\"\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract nested subdomain info\n| extend\n    SD_Subdomain_Nested = tostring(Data)\n// Normalized risk score (same pattern used in all your parsers)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (standard across all parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Subdomains specific parsed fields\n    SD_Subdomain_Nested,\n    Data\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject40')._parserId40,'/'))))]",
              "dependsOn": [
                "[variables('parserObject40')._parserId40]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_subdomains')]",
                "contentId": "[variables('parserObject40').parserContentId40]",
                "kind": "Parser",
                "version": "[variables('parserObject40').parserVersion40]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject40').parserContentId40]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Subdomains alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject40').parserContentId40,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject40').parserContentId40,'-', '1.0.0')))]",
        "version": "[variables('parserObject40').parserVersion40]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject40')._parserName40]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Subdomains alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_subdomains",
        "query": "CybleVisionAlerts_CL\n| where Service == \"subdomains\"\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract nested subdomain info\n| extend\n    SD_Subdomain_Nested = tostring(Data)\n// Normalized risk score (same pattern used in all your parsers)\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection (standard across all parsers)\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    // Subdomains specific parsed fields\n    SD_Subdomain_Nested,\n    Data\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject40')._parserId40,'/'))))]",
      "dependsOn": [
        "[variables('parserObject40')._parserId40]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_subdomains')]",
        "contentId": "[variables('parserObject40').parserContentId40]",
        "kind": "Parser",
        "version": "[variables('parserObject40').parserVersion40]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject41').parserTemplateSpecName41]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_suspicious_domains Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject41').parserVersion41]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject41')._parserName41]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Suspicious Domains alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_suspicious_domains",
                "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"suspicious_domains\"\n| extend Data = todynamic(Data)\n| extend AlertID = ID\n| extend \n    SD_RegistrationDate = tostring(Data.REGISTRATIONDATE),\n    SD_Source = tostring(Data.SOURCE),\n    SD_CreatedAt = tostring(Data.created_at),\n    SD_Domain = tostring(Data.domain),\n    SD_DomainName = tostring(Data.domain_name),\n    SD_Fuzzer = tostring(Data.fuzzer),\n    SD_ID = tostring(Data.id),\n    SD_IsLive = tostring(Data.is_live),\n    SD_Keyword = tostring(Data.keyword),\n    SD_LastLiveCheck = tostring(Data.last_live_check),\n    SD_RawRegDate = tostring(Data.raw_registration_date),\n    SD_Score = tostring(Data.score),\n    SD_ScreenshotURL = tostring(Data.screenshot_url),\n    SD_Service = tostring(Data.service),\n    SD_StatusCode = tostring(Data.status_code),\n    SD_UpdatedAt = tostring(Data.updated_at),\n    SD_WhoisEnriched = tostring(Data.whois_enriched),\n    SD_WhoisTries = tostring(Data.whois_enriched_tries)\n| extend DNS = Data.dns_records\n| extend\n    A_Records = DNS.a_record,\n    MX_Records = DNS.mx_record,\n    NS_Records = DNS.ns_record\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Service,\n    SD_RegistrationDate,\n    SD_Source,\n    SD_CreatedAt,\n    SD_Domain,\n    SD_DomainName,\n    SD_Fuzzer,\n    SD_ID,\n    SD_IsLive,\n    SD_Keyword,\n    SD_LastLiveCheck,\n    SD_RawRegDate,\n    SD_Score,\n    SD_ScreenshotURL,\n    SD_Service,\n    SD_StatusCode,\n    SD_UpdatedAt,\n    SD_WhoisEnriched,\n    SD_WhoisTries,\n    A_Records,\n    MX_Records,\n    NS_Records\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject41')._parserId41,'/'))))]",
              "dependsOn": [
                "[variables('parserObject41')._parserId41]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_suspicious_domains')]",
                "contentId": "[variables('parserObject41').parserContentId41]",
                "kind": "Parser",
                "version": "[variables('parserObject41').parserVersion41]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject41').parserContentId41]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Suspicious Domains alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject41').parserContentId41,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject41').parserContentId41,'-', '1.0.0')))]",
        "version": "[variables('parserObject41').parserVersion41]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject41')._parserName41]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Suspicious Domains alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_suspicious_domains",
        "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"suspicious_domains\"\n| extend Data = todynamic(Data)\n| extend AlertID = ID\n| extend \n    SD_RegistrationDate = tostring(Data.REGISTRATIONDATE),\n    SD_Source = tostring(Data.SOURCE),\n    SD_CreatedAt = tostring(Data.created_at),\n    SD_Domain = tostring(Data.domain),\n    SD_DomainName = tostring(Data.domain_name),\n    SD_Fuzzer = tostring(Data.fuzzer),\n    SD_ID = tostring(Data.id),\n    SD_IsLive = tostring(Data.is_live),\n    SD_Keyword = tostring(Data.keyword),\n    SD_LastLiveCheck = tostring(Data.last_live_check),\n    SD_RawRegDate = tostring(Data.raw_registration_date),\n    SD_Score = tostring(Data.score),\n    SD_ScreenshotURL = tostring(Data.screenshot_url),\n    SD_Service = tostring(Data.service),\n    SD_StatusCode = tostring(Data.status_code),\n    SD_UpdatedAt = tostring(Data.updated_at),\n    SD_WhoisEnriched = tostring(Data.whois_enriched),\n    SD_WhoisTries = tostring(Data.whois_enriched_tries)\n| extend DNS = Data.dns_records\n| extend\n    A_Records = DNS.a_record,\n    MX_Records = DNS.mx_record,\n    NS_Records = DNS.ns_record\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Service,\n    SD_RegistrationDate,\n    SD_Source,\n    SD_CreatedAt,\n    SD_Domain,\n    SD_DomainName,\n    SD_Fuzzer,\n    SD_ID,\n    SD_IsLive,\n    SD_Keyword,\n    SD_LastLiveCheck,\n    SD_RawRegDate,\n    SD_Score,\n    SD_ScreenshotURL,\n    SD_Service,\n    SD_StatusCode,\n    SD_UpdatedAt,\n    SD_WhoisEnriched,\n    SD_WhoisTries,\n    A_Records,\n    MX_Records,\n    NS_Records\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject41')._parserId41,'/'))))]",
      "dependsOn": [
        "[variables('parserObject41')._parserId41]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_suspicious_domains')]",
        "contentId": "[variables('parserObject41').parserContentId41]",
        "kind": "Parser",
        "version": "[variables('parserObject41').parserVersion41]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject42').parserTemplateSpecName42]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_telegram_mentions Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject42').parserVersion42]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject42')._parserName42]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Telegram Mentions alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_telegram_mentions",
                "query": "CybleVisionAlerts_CL\n| where Service == \"telegram_mentions\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// Extract primary Telegram metadata\n| extend\n    TG_ChatID          = tolong(Data.chat_id),\n    TG_ChatTitle       = tostring(Data.chat_title),\n    TG_Message         = tostring(Data.message),\n    TG_CreatedDate     = tostring(Data.created_date),\n    TG_UpdatedDate     = tostring(Data.updated_date),\n    TG_UserID          = tostring(Data.user_id),\n    TG_Username2       = tostring(Data.username)\n// Extract URLs from message text (Telegram links & media)\n| extend\n    TG_Urls = extract_all(@\"(https?://[^\\s]+)\", TG_Message)\n// Tags\n| extend TG_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    TG_ChatID,\n    TG_ChatTitle,\n    TG_Message,\n    TG_CreatedDate,\n    TG_UpdatedDate,\n    TG_UserID,\n    TG_Username2,\n    TG_Urls,\n    TG_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject42')._parserId42,'/'))))]",
              "dependsOn": [
                "[variables('parserObject42')._parserId42]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_telegram_mentions')]",
                "contentId": "[variables('parserObject42').parserContentId42]",
                "kind": "Parser",
                "version": "[variables('parserObject42').parserVersion42]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject42').parserContentId42]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Telegram Mentions alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject42').parserContentId42,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject42').parserContentId42,'-', '1.0.0')))]",
        "version": "[variables('parserObject42').parserVersion42]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject42')._parserName42]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Telegram Mentions alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_telegram_mentions",
        "query": "CybleVisionAlerts_CL\n| where Service == \"telegram_mentions\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// Extract primary Telegram metadata\n| extend\n    TG_ChatID          = tolong(Data.chat_id),\n    TG_ChatTitle       = tostring(Data.chat_title),\n    TG_Message         = tostring(Data.message),\n    TG_CreatedDate     = tostring(Data.created_date),\n    TG_UpdatedDate     = tostring(Data.updated_date),\n    TG_UserID          = tostring(Data.user_id),\n    TG_Username2       = tostring(Data.username)\n// Extract URLs from message text (Telegram links & media)\n| extend\n    TG_Urls = extract_all(@\"(https?://[^\\s]+)\", TG_Message)\n// Tags\n| extend TG_Tags = tostring(Tags)\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    TG_ChatID,\n    TG_ChatTitle,\n    TG_Message,\n    TG_CreatedDate,\n    TG_UpdatedDate,\n    TG_UserID,\n    TG_Username2,\n    TG_Urls,\n    TG_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject42')._parserId42,'/'))))]",
      "dependsOn": [
        "[variables('parserObject42')._parserId42]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_telegram_mentions')]",
        "contentId": "[variables('parserObject42').parserContentId42]",
        "kind": "Parser",
        "version": "[variables('parserObject42').parserVersion42]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject43').parserTemplateSpecName43]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_tor_links Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject43').parserVersion43]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject43')._parserName43]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract GitHub TOR Links alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_tor_links",
                "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"tor_links\"\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend // Parse top level fields inside Data{}\n    TL_Id                = tostring(Data._id),\n    TL_Doc               = Data.doc\n| extend // Parse nested doc{} object\n    TL_Doc_Data          = tostring(TL_Doc.data),\n    TL_Doc_Id            = tostring(TL_Doc.id),\n    TL_SearchEngine      = tostring(TL_Doc.search_engine),\n    TL_SearchKeyword     = tostring(TL_Doc.search_keyword),\n    TL_TorUrl            = tostring(TL_Doc.tor_url),\n    TL_UpdatedOn         = tostring(TL_Doc.updated_on)\n| extend // Parse Tags\n    TL_Tags              = tostring(Data.tags)\n| project\n    TimeGenerated,\n    Created_At,\n    Updated_At,\n    Deleted_At,\n    AlertID,\n    DataID,\n    EntityID,\n    KeywordName,\n    EntityType,\n    Service,\n    CompanyID,\n    Description,\n    Status,\n    AssigneeID,\n    AssignmentDate,\n    ArchiveDate,\n    Severity,\n    UpdatedBy,\n    CreatedBy,\n    UserSeverity,\n    BucketID,\n    Filename,\n    RepositoryName,\n    OwnerName,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Tags,\n    Asset,\n    Last_Detected_At,\n    Extension,\n    Compromised_Date,\n    Article_Name,\n    Breach_Source,\n    Breach_Date,\n    Channel_Name,\n    Server_Name,\n    Content_Updated_On,\n    Discussion_Date,\n    Discussion_By,\n    Source_Name,\n    Topic_Name,\n    Source,\n    Alert_Type,\n    Content_Added_On,\n    IOC,\n    First_Seen_On,\n    Last_Seen_On,\n    Old_Risk_Score,\n    New_Risk_Score,\n    IP,\n    Host,\n    Port,\n    Application_Name,\n    Market_Source,\n    Uploaded_At,\n    CVE,\n    Subdomain,\n    Domain,\n    Chat_Title,\n    Username,\n    Search_Engine,\n    Category,\n    Sentiment,\n    Data,\n    TenantId,\n    Type,\n    _ResourceId,\n    TL_Id,              // Parsed TOR links fields\n    TL_Doc_Data,\n    TL_Doc_Id,\n    TL_SearchEngine,\n    TL_SearchKeyword,\n    TL_TorUrl,\n    TL_UpdatedOn,\n    TL_Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject43')._parserId43,'/'))))]",
              "dependsOn": [
                "[variables('parserObject43')._parserId43]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_tor_links')]",
                "contentId": "[variables('parserObject43').parserContentId43]",
                "kind": "Parser",
                "version": "[variables('parserObject43').parserVersion43]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject43').parserContentId43]",
        "contentKind": "Parser",
        "displayName": "Parser to extract GitHub TOR Links alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject43').parserContentId43,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject43').parserContentId43,'-', '1.0.0')))]",
        "version": "[variables('parserObject43').parserVersion43]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject43')._parserName43]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract GitHub TOR Links alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_tor_links",
        "query": "CybleVisionAlerts_CL\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| where Service == \"tor_links\"\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n| extend // Parse top level fields inside Data{}\n    TL_Id                = tostring(Data._id),\n    TL_Doc               = Data.doc\n| extend // Parse nested doc{} object\n    TL_Doc_Data          = tostring(TL_Doc.data),\n    TL_Doc_Id            = tostring(TL_Doc.id),\n    TL_SearchEngine      = tostring(TL_Doc.search_engine),\n    TL_SearchKeyword     = tostring(TL_Doc.search_keyword),\n    TL_TorUrl            = tostring(TL_Doc.tor_url),\n    TL_UpdatedOn         = tostring(TL_Doc.updated_on)\n| extend // Parse Tags\n    TL_Tags              = tostring(Data.tags)\n| project\n    TimeGenerated,\n    Created_At,\n    Updated_At,\n    Deleted_At,\n    AlertID,\n    DataID,\n    EntityID,\n    KeywordName,\n    EntityType,\n    Service,\n    CompanyID,\n    Description,\n    Status,\n    AssigneeID,\n    AssignmentDate,\n    ArchiveDate,\n    Severity,\n    UpdatedBy,\n    CreatedBy,\n    UserSeverity,\n    BucketID,\n    Filename,\n    RepositoryName,\n    OwnerName,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    Tags,\n    Asset,\n    Last_Detected_At,\n    Extension,\n    Compromised_Date,\n    Article_Name,\n    Breach_Source,\n    Breach_Date,\n    Channel_Name,\n    Server_Name,\n    Content_Updated_On,\n    Discussion_Date,\n    Discussion_By,\n    Source_Name,\n    Topic_Name,\n    Source,\n    Alert_Type,\n    Content_Added_On,\n    IOC,\n    First_Seen_On,\n    Last_Seen_On,\n    Old_Risk_Score,\n    New_Risk_Score,\n    IP,\n    Host,\n    Port,\n    Application_Name,\n    Market_Source,\n    Uploaded_At,\n    CVE,\n    Subdomain,\n    Domain,\n    Chat_Title,\n    Username,\n    Search_Engine,\n    Category,\n    Sentiment,\n    Data,\n    TenantId,\n    Type,\n    _ResourceId,\n    TL_Id,              // Parsed TOR links fields\n    TL_Doc_Data,\n    TL_Doc_Id,\n    TL_SearchEngine,\n    TL_SearchKeyword,\n    TL_TorUrl,\n    TL_UpdatedOn,\n    TL_Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject43')._parserId43,'/'))))]",
      "dependsOn": [
        "[variables('parserObject43')._parserId43]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_tor_links')]",
        "contentId": "[variables('parserObject43').parserContentId43]",
        "kind": "Parser",
        "version": "[variables('parserObject43').parserVersion43]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject44').parserTemplateSpecName44]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_vulnerability Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject44').parserVersion44]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject44')._parserName44]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Vulnerability alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_vulnerability",
                "query": "CybleVisionAlerts_CL\n| where Service == \"vulnerability\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// inner \"data.data\" object\n| extend Vuln = Data.data\n| extend\n    V_Confidence        = tostring(Vuln.confidence),\n    V_FirstSeen         = tostring(Vuln.first_seen_on),\n    V_LastSeen          = tostring(Vuln.last_seen_on),\n    V_Host              = tostring(Vuln.host),\n    V_IP                = tostring(Vuln.ip),\n    V_Port              = toint(Vuln.port),\n    V_Severity          = tostring(Vuln.severity),\n    V_Title             = tostring(Vuln.['title']),\n    V_VulnID            = tostring(Vuln.vulnerability_id),\n    V_Type              = tostring(Vuln.vulnerability_type)\n// Return all columns + parsed fields\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    Asset,\n    V_Confidence,\n    V_FirstSeen,\n    V_LastSeen,\n    V_Host,\n    V_IP,\n    V_Port,\n    V_Severity,\n    V_Title,\n    V_VulnID,\n    V_Type\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject44')._parserId44,'/'))))]",
              "dependsOn": [
                "[variables('parserObject44')._parserId44]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_vulnerability')]",
                "contentId": "[variables('parserObject44').parserContentId44]",
                "kind": "Parser",
                "version": "[variables('parserObject44').parserVersion44]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject44').parserContentId44]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Vulnerability alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject44').parserContentId44,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject44').parserContentId44,'-', '1.0.0')))]",
        "version": "[variables('parserObject44').parserVersion44]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject44')._parserName44]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Vulnerability alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_vulnerability",
        "query": "CybleVisionAlerts_CL\n| where Service == \"vulnerability\"\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n| extend AlertID = ID\n| extend Data = parse_json(Data)\n// inner \"data.data\" object\n| extend Vuln = Data.data\n| extend\n    V_Confidence        = tostring(Vuln.confidence),\n    V_FirstSeen         = tostring(Vuln.first_seen_on),\n    V_LastSeen          = tostring(Vuln.last_seen_on),\n    V_Host              = tostring(Vuln.host),\n    V_IP                = tostring(Vuln.ip),\n    V_Port              = toint(Vuln.port),\n    V_Severity          = tostring(Vuln.severity),\n    V_Title             = tostring(Vuln.['title']),\n    V_VulnID            = tostring(Vuln.vulnerability_id),\n    V_Type              = tostring(Vuln.vulnerability_type)\n// Return all columns + parsed fields\n| project\n    TimeGenerated,\n    AlertID,\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    Asset,\n    V_Confidence,\n    V_FirstSeen,\n    V_LastSeen,\n    V_Host,\n    V_IP,\n    V_Port,\n    V_Severity,\n    V_Title,\n    V_VulnID,\n    V_Type\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject44')._parserId44,'/'))))]",
      "dependsOn": [
        "[variables('parserObject44')._parserId44]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_vulnerability')]",
        "contentId": "[variables('parserObject44').parserContentId44]",
        "kind": "Parser",
        "version": "[variables('parserObject44').parserVersion44]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject45').parserTemplateSpecName45]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Alerts_web_applications Data Parser with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject45').parserVersion45]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject45')._parserName45]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser to extract Web Applications alerts from Cyble Vision Alerts",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "Alerts_web_applications",
                "query": "CybleVisionAlerts_CL\n| where Service == \"web_applications\"\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract nested web application fields\n| extend\n    WA_AppID            = tostring(Data.app_id),\n    WA_Confidence       = tostring(Data.confidence),\n    WA_Favicon          = tostring(Data.favicon),\n    WA_FirstSeen        = tostring(Data.first_seen_on),\n    WA_LastSeen         = tostring(Data.last_seen_on),\n    WA_Host_Nested      = tostring(Data.host),\n    WA_Path             = tostring(Data.path),\n    WA_Port_Nested      = tostring(Data.port),\n    WA_Severity_Nested  = tostring(Data.severity),\n    WA_Title_Nested     = tostring(Data.['title']),\n    WA_URL              = tostring(Data.url),\n    WA_IPs              = tostring(Data.ip),\n    WA_IsBehindWAF      = tostring(Data.is_behind_waf),\n    WA_IsCDN            = tostring(Data.is_cdn),\n    WA_IsVHost          = tostring(Data.is_vhost)\n// Standard risk pack\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    WA_AppID,\n    WA_Confidence,\n    WA_Favicon,\n    WA_FirstSeen,\n    WA_LastSeen,\n    WA_Host_Nested,\n    WA_Path,\n    WA_Port_Nested,\n    WA_Severity_Nested,\n    WA_Title_Nested,\n    WA_URL,\n    WA_IPs,\n    WA_IsBehindWAF,\n    WA_IsCDN,\n    WA_IsVHost,\n    Data,\n    Tags\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject45')._parserId45,'/'))))]",
              "dependsOn": [
                "[variables('parserObject45')._parserId45]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_web_applications')]",
                "contentId": "[variables('parserObject45').parserContentId45]",
                "kind": "Parser",
                "version": "[variables('parserObject45').parserVersion45]",
                "source": {
                  "name": "Cyble Vision",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject45').parserContentId45]",
        "contentKind": "Parser",
        "displayName": "Parser to extract Web Applications alerts from Cyble Vision Alerts",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject45').parserContentId45,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject45').parserContentId45,'-', '1.0.0')))]",
        "version": "[variables('parserObject45').parserVersion45]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject45')._parserName45]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser to extract Web Applications alerts from Cyble Vision Alerts",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "Alerts_web_applications",
        "query": "CybleVisionAlerts_CL\n| where Service == \"web_applications\"\n| extend Data = parse_json(Data)\n| extend Data = (Data.data)\n// Extract nested web application fields\n| extend\n    WA_AppID            = tostring(Data.app_id),\n    WA_Confidence       = tostring(Data.confidence),\n    WA_Favicon          = tostring(Data.favicon),\n    WA_FirstSeen        = tostring(Data.first_seen_on),\n    WA_LastSeen         = tostring(Data.last_seen_on),\n    WA_Host_Nested      = tostring(Data.host),\n    WA_Path             = tostring(Data.path),\n    WA_Port_Nested      = tostring(Data.port),\n    WA_Severity_Nested  = tostring(Data.severity),\n    WA_Title_Nested     = tostring(Data.['title']),\n    WA_URL              = tostring(Data.url),\n    WA_IPs              = tostring(Data.ip),\n    WA_IsBehindWAF      = tostring(Data.is_behind_waf),\n    WA_IsCDN            = tostring(Data.is_cdn),\n    WA_IsVHost          = tostring(Data.is_vhost)\n// Standard risk pack\n| extend Risk_Score = pack(\"s\", RiskScore_s, \"e\", RiskScore_e, \"c\", RiskScore_c)\n// Final projection\n| project\n    TimeGenerated,\n    AlertID = tostring(ID),\n    EntityID,\n    KeywordName,\n    CompanyID,\n    Status,\n    Severity,\n    UserSeverity,\n    BucketID,\n    Domain,\n    BucketName,\n    TruePositive,\n    LLMProcessed,\n    LLMExplanation,\n    IP,\n    Service,\n    Risk_Score,\n    WA_AppID,\n    WA_Confidence,\n    WA_Favicon,\n    WA_FirstSeen,\n    WA_LastSeen,\n    WA_Host_Nested,\n    WA_Path,\n    WA_Port_Nested,\n    WA_Severity_Nested,\n    WA_Title_Nested,\n    WA_URL,\n    WA_IPs,\n    WA_IsBehindWAF,\n    WA_IsCDN,\n    WA_IsVHost,\n    Data,\n    Tags\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject45')._parserId45,'/'))))]",
      "dependsOn": [
        "[variables('parserObject45')._parserId45]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Alerts_web_applications')]",
        "contentId": "[variables('parserObject45').parserContentId45]",
        "kind": "Parser",
        "version": "[variables('parserObject45').parserVersion45]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Cyble-IOC-Enrichment-Playbook Playbook with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion1')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "Cyble-IOC-Enrichment-Playbook",
              "type": "String"
            },
            "ScheduleFrequencyInMinutes": {
              "defaultValue": "60",
              "type": "String"
            },
            "CybleApiBearerToken": {
              "defaultValue": "",
              "type": "securestring"
            },
            "WorkspaceID": {
              "defaultValue": "",
              "type": "String"
            }
          },
          "variables": {
            "apiConnectionResourceName": "[[concat(parameters('PlaybookName'), '-ti-conn-', uniqueString(resourceGroup().id, parameters('PlaybookName')))]",
            "connection-1": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/',  variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-1": "[[variables('connection-1')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('apiConnectionResourceName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "displayName": "[[variables('apiConnectionResourceName')]",
                "api": {
                  "id": "[[variables('_connection-1')]",
                  "type": "Microsoft.Web/locations/managedApis"
                }
              }
            },
            {
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('apiConnectionResourceName'))]"
              ],
              "identity": {
                "type": "SystemAssigned"
              },
              "properties": {
                "state": "Enabled",
                "parameters": {
                  "ScheduleFrequencyInMinutes": {
                    "type": "String",
                    "value": "[[parameters('ScheduleFrequencyInMinutes')]"
                  },
                  "CybleApiBearerToken": {
                    "type": "SecureString",
                    "value": "[[parameters('CybleApiBearerToken')]"
                  },
                  "WorkspaceID": {
                    "type": "String",
                    "value": "[[parameters('WorkspaceID')]"
                  },
                  "$connections": {
                    "type": "Object",
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('apiConnectionResourceName'))]",
                        "connectionName": "[[variables('apiConnectionResourceName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/',  variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "alternativeParameterValues": {
                          "authenticationType": "ManagedServiceIdentity"
                        }
                      }
                    }
                  }
                },
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "ScheduleFrequencyInMinutes": {
                      "type": "String"
                    },
                    "CybleApiBearerToken": {
                      "type": "SecureString"
                    },
                    "$connections": {
                      "type": "Object"
                    },
                    "WorkspaceID": {
                      "type": "String"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Parse_FullIncident": {
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@triggerOutputs()?['body/object']",
                        "schema": {
                          "type": "object",
                          "properties": {
                            "Properties": {
                              "type": "object",
                              "properties": {
                                "relatedEntities": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "Parse_Entities": {
                      "runAfter": {
                        "Parse_FullIncident": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Parse_FullIncident')?['Properties']?['relatedEntities']",
                        "schema": {
                          "type": "array",
                          "items": {
                            "type": "object"
                          }
                        }
                      }
                    },
                    "Initialize_Enrichment_Array": {
                      "runAfter": {
                        "Parse_Entities": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "FormattedComments",
                            "type": "Array",
                            "value": "[variables('TemplateEmptyArray')]"
                          }
                        ]
                      }
                    },
                    "For_each_Entity": {
                      "foreach": "@body('Parse_Entities')",
                      "actions": {
                        "HTTP_Get_IOC_Data": {
                          "type": "Http",
                          "inputs": {
                            "uri": "@concat('https://api.cyble.ai/engine/api/v2/y/iocs?ioc=', coalesce(if(equals(toLower(item()?['kind']),'filehash'), item()?['properties']?['hashValue'], null), if(equals(toLower(item()?['kind']),'ip'), item()?['properties']?['address'], null), if(equals(toLower(item()?['kind']),'url'), item()?['properties']?['url'], null), if(equals(toLower(item()?['kind']),'host'), item()?['properties']?['hostName'], null), if(equals(toLower(item()?['kind']),'mailbox'), item()?['properties']?['mailboxPrimaryAddress'], null), ''))",
                            "method": "GET",
                            "headers": {
                              "Authorization": "@concat('Bearer ', parameters('CybleApiBearerToken'))",
                              "Content-Type": "application/json"
                            }
                          }
                        },
                        "Parse_IOC_Response": {
                          "runAfter": {
                            "HTTP_Get_IOC_Data": [
                              "Succeeded"
                            ]
                          },
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@body('HTTP_Get_IOC_Data')",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "success": {
                                  "type": "boolean"
                                },
                                "data": {
                                  "type": "object",
                                  "properties": {
                                    "iocs": {
                                      "type": [
                                        "array",
                                        "null"
                                      ],
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "ioc": {
                                            "type": "string"
                                          },
                                          "ioc_type": {
                                            "type": "string"
                                          },
                                          "first_seen": {
                                            "type": "number"
                                          },
                                          "last_seen": {
                                            "type": "number"
                                          },
                                          "risk_score": {
                                            "type": "integer"
                                          },
                                          "sources": {
                                            "type": "array",
                                            "items": {
                                              "type": "string"
                                            }
                                          },
                                          "behaviour_tags": {
                                            "type": [
                                              "array",
                                              "null"
                                            ],
                                            "items": {
                                              "type": "string"
                                            }
                                          },
                                          "confidence_rating": {
                                            "type": "string"
                                          },
                                          "target_countries": {
                                            "type": [
                                              "array",
                                              "null"
                                            ],
                                            "items": {
                                              "type": "string"
                                            }
                                          },
                                          "target_regions": {
                                            "type": [
                                              "array",
                                              "null"
                                            ],
                                            "items": {
                                              "type": "string"
                                            }
                                          },
                                          "target_industries": {
                                            "type": [
                                              "array",
                                              "null"
                                            ],
                                            "items": {
                                              "type": "string"
                                            }
                                          },
                                          "related_malware": {
                                            "type": [
                                              "string",
                                              "null"
                                            ]
                                          },
                                          "related_threat_actors": {
                                            "type": [
                                              "string",
                                              "null"
                                            ]
                                          },
                                          "is_whitelisted": {
                                            "type": "boolean"
                                          }
                                        }
                                      }
                                    },
                                    "pagination": {
                                      "type": "object",
                                      "properties": {
                                        "total_count": {
                                          "type": "integer"
                                        },
                                        "page": {
                                          "type": "integer"
                                        },
                                        "limit": {
                                          "type": "integer"
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        },
                        "Compose_Formatted_Comment": {
                          "runAfter": {
                            "Parse_IOC_Response": [
                              "Succeeded"
                            ]
                          },
                          "type": "Compose",
                          "inputs": "@concat(\n  '---\\n**Entity:** ', coalesce(item()?['properties']?['address'], item()?['properties']?['hostName'], item()?['properties']?['url'], item()?['properties']?['mailboxPrimaryAddress'], item()?['properties']?['hashValue'], 'Unknown'), '\\n',\n  if(\n    equals(body('Parse_IOC_Response')?['success'], true),\n    concat(\n      '**IOC:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'No IOCs found.',\n          first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['ioc']\n        ), '\\n',\n      '**Type:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['ioc_type']\n        ), '\\n',\n      '**Risk Score:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          string(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['risk_score'])\n        ), '\\n',\n      '**Confidence Rating:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['confidence_rating']\n        ), '\\n',\n      '**Sources:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          join(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['sources'], ', ')\n        ), '\\n',\n      '**Malware:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          string(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['related_malware'])\n        ), '\\n',\n      '**Threat Actors:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          string(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['related_threat_actors'])\n        ), '\\n',\n      '**Behavior Tags:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          if(\n            or(\n              equals(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['behaviour_tags'], null),\n              equals(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['behaviour_tags'], 'null')\n            ),\n            'None',\n            join(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['behaviour_tags'], ', ')\n          )\n        ), '\\n',\n      '**First Seen:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          string(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['first_seen'])\n        ), '\\n',\n      '**Last Seen:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          string(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['last_seen'])\n        ), '\\n',\n      '**Is Whitelisted:** ',\n        if(\n          equals(\n            length(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))),\n            0\n          ),\n          'N/A',\n          string(first(coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]')))?['is_whitelisted'])\n        ), '\\n'\n    ),\n    'API returned an error or no data available.\\n'\n  )\n)"
                        },
                        "Append_Comment_to_Array": {
                          "runAfter": {
                            "Compose_Formatted_Comment": [
                              "Succeeded"
                            ]
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "FormattedComments",
                            "value": "@outputs('Compose_Formatted_Comment')"
                          }
                        }
                      },
                      "runAfter": {
                        "Initialize_Enrichment_Array": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Check_If_Comments_Not_Empty": {
                      "actions": {
                        "Add_comment_to_incident_(V3)": {
                          "type": "ApiConnection",
                          "inputs": {
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "body": {
                              "incidentArmId": "@body('Parse_FullIncident')?['id']",
                              "message": "<p class=\"editor-paragraph\">@{concat('**IOC Enrichment Results**\\\\n\\\\n', join(variables('FormattedComments'), '\\\\n'))}</p>"
                            },
                            "path": "/Incidents/Comment"
                          }
                        }
                      },
                      "runAfter": {
                        "For_each_Entity": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "No_Comments_Skip": {
                            "type": "Compose",
                            "inputs": "No enriched IOCs found; skipping comment."
                          }
                        }
                      },
                      "expression": "@greater(length(variables('FormattedComments')), 0)",
                      "type": "If"
                    }
                  }
                }
              },
              "tags": {
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId1'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId1')]",
                "contentId": "[variables('_playbookContentId1')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ],
          "metadata": {
            "title": "Cyble-IOC_Enrichment-Playbook",
            "description": "This playbook leverages the Cyble API to enrich IP, Domain, Url & Hash indicators, found in Microsoft Sentinel incidents, with the following context: Risk Score, Confidence, etc. The enrichment content will be posted as a comment in the Microsoft Sentinel incident",
            "prerequisites": [
              "To use the Cyble Endpoints for Azure connector, you will need a valid API token from Cyble Vision platform."
            ],
            "postDeployment": [
              ""
            ],
            "lastUpdateTime": "2025-05-06T00:00:00Z",
            "entities": [
              "ip",
              "url",
              "filehash"
            ],
            "tags": [
              "Enrichment"
            ],
            "releaseNotes": [
              {
                "version": "1.0",
                "title": "Cyble-IOC_Enrichment",
                "notes": [
                  "Initial version"
                ]
              }
            ],
            "basics": {
              "displayName": "Cyble IOC Enrichment",
              "description": "Enrich IOCs using the Cyble Threat Intelligence API.",
              "category": "Threat Intelligence"
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId1')]",
        "contentKind": "Playbook",
        "displayName": "Cyble-IOC-Enrichment-Playbook",
        "contentProductId": "[variables('_playbookcontentProductId1')]",
        "id": "[variables('_playbookcontentProductId1')]",
        "version": "[variables('playbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Cyble-TI-Ingest-Playbook Playbook with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion2')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "Cyble-TI-Ingest-Playbook",
              "type": "string"
            },
            "ScheduleFrequencyInMinutes": {
              "defaultValue": "60",
              "type": "string"
            },
            "CybleApiBearerToken": {
              "defaultValue": "",
              "type": "securestring"
            },
            "WorkspaceID": {
              "defaultValue": "",
              "type": "string"
            },
            "logAnalyticsWorkspaceName": {
              "defaultValue": "please enter your workspace name",
              "type": "string"
            }
          },
          "variables": {
            "apiConnectionResourceName": "[[concat(parameters('PlaybookName'), '-ti-connection')]",
            "AzuremonitorlogsConnectionName": "[[concat('Azuremonitorlogs-', parameters('PlaybookName'))]",
            "logAnalyticsWorkspaceName": "[[parameters('logAnalyticsWorkspaceName')]",
            "connection-1": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-1": "[[variables('connection-1')]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuremonitorlogs')]",
            "_connection-2": "[[variables('connection-2')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('apiConnectionResourceName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "displayName": "[[variables('apiConnectionResourceName')]",
                "api": {
                  "id": "[[variables('_connection-1')]",
                  "type": "Microsoft.Web/locations/managedApis"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('AzuremonitorlogsConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('AzuremonitorlogsConnectionName')]",
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('apiConnectionResourceName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]"
              ],
              "identity": {
                "type": "SystemAssigned"
              },
              "properties": {
                "state": "Enabled",
                "parameters": {
                  "ScheduleFrequencyInMinutes": {
                    "type": "String",
                    "value": "[[parameters('ScheduleFrequencyInMinutes')]"
                  },
                  "CybleApiBearerToken": {
                    "type": "securestring",
                    "value": "[[parameters('CybleApiBearerToken')]"
                  },
                  "WorkspaceID": {
                    "type": "String",
                    "value": "[[parameters('WorkspaceID')]"
                  },
                  "$connections": {
                    "type": "Object",
                    "value": {
                      "azuresentinel": {
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('apiConnectionResourceName'))]",
                        "connectionName": "[[variables('apiConnectionResourceName')]"
                      },
                      "azuremonitorlogs": {
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuremonitorlogs')]",
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]",
                        "connectionName": "[[variables('AzuremonitorlogsConnectionName')]"
                      }
                    }
                  }
                },
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "ScheduleFrequencyInMinutes": {
                      "type": "String"
                    },
                    "CybleApiBearerToken": {
                      "type": "SecureString"
                    },
                    "WorkspaceID": {
                      "type": "String"
                    },
                    "$connections": {
                      "type": "Object"
                    }
                  },
                  "triggers": {
                    "Recurrence_Trigger": {
                      "recurrence": {
                        "frequency": "Minute",
                        "interval": "@int(parameters('ScheduleFrequencyInMinutes'))"
                      },
                      "evaluatedRecurrence": {
                        "frequency": "Minute",
                        "interval": 60
                      },
                      "type": "Recurrence"
                    }
                  },
                  "actions": {
                    "Initialize_StartDateTimeFull": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "StartDateTimeFull",
                            "type": "String",
                            "value": "@formatDateTime(addMinutes(utcNow(), mul(-1, int(parameters('ScheduleFrequencyInMinutes')))), 'yyyy-MM-ddTHH:mm:ssZ')"
                          }
                        ]
                      }
                    },
                    "Initialize_EndDateTimeFull": {
                      "runAfter": {
                        "Initialize_StartDateTimeFull": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "EndDateTimeFull",
                            "type": "String",
                            "value": "@{formatDateTime(utcNow(), 'yyyy-MM-ddTHH:mm:ssZ')}"
                          }
                        ]
                      }
                    },
                    "HTTP_Get_IOC_Data": {
                      "runAfter": {
                        "Initialize_existingIoCs": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "uri": "@concat('https://api.cyble.ai/engine/api/v2/y/iocs?sortBy=last_seen&order=desc&limit=100&startDate=', variables('StartDateTimeFull'), '&endDate=', variables('EndDateTimeFull'))",
                        "method": "GET",
                        "headers": {
                          "Authorization": "@{concat('Bearer ', parameters('CybleApiBearerToken'))}",
                          "Content-Type": "application/json"
                        }
                      }
                    },
                    "For_Each_IOC": {
                      "foreach": "@variables('rawIocs')",
                      "actions": {
                        "Condition": {
                          "actions": {
                            "Check_If_in_lastNmins": {
                              "actions": {
                                "Upload_Indicators_v2": {
                                  "type": "ApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                      }
                                    },
                                    "method": "post",
                                    "body": {
                                      "sourcesystem": "CybleVision",
                                      "indicators": [
                                        {
                                          "DisplayName": "@item()?['ioc']",
                                          "Name": "@item()?['ioc']",
                                          "IndicatorValue": "@item()?['ioc']",
                                          "IndicatorType": "@if(equals(item()?['ioc_type'],'FileHash-SHA256'),'filehash-sha256',if(equals(item()?['ioc_type'],'IPv4'),'ipv4address','url'))",
                                          "ThreatType": "malicious-activity",
                                          "Confidence": "@if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 80), 5, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 60), 4, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 40), 3, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 20), 2, 1))))",
                                          "SeverityLevel": "@if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 80), 5, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 60), 4, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 40), 3, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 20), 2, 1))))",
                                          "severity_level": "@if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 80), 5, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 60), 4, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 40), 3, if(greaterOrEquals(coalesce(item()?['risk_score'], 0), 20), 2, 1))))",
                                          "Tags": [
                                            "@coalesce(item()?['confidence_rating'],'Unknown')"
                                          ],
                                          "ExpirationDateTime": "@addDays(utcNow(),7)",
                                          "description": "IOC from Cyble",
                                          "labels": [
                                            "@join(coalesce(item()?['behaviour_tags'], json('[]')), ',')"
                                          ],
                                          "pattern": "@if(equals(item()?['ioc_type'],'FileHash-SHA256'), concat('[[file:hashes.''SHA-256'' = ''', item()?['ioc'], ''']]'), if(equals(item()?['ioc_type'],'IPv4'), concat('[[ipv4-addr:value = ''', item()?['ioc'], ''']]'), concat('[[url:value = ''', item()?['ioc'], ''']]')))",
                                          "valid_from": "@utcNow()",
                                          "type": "indicator",
                                          "id": "@concat('indicator--', guid())",
                                          "created": "@utcNow()",
                                          "modified": "@utcNow()",
                                          "pattern_type": "stix",
                                          "spec_version": "2.1"
                                        }
                                      ]
                                    },
                                    "path": "/V2/ThreatIntelligence/@{encodeURIComponent(parameters('WorkspaceID'))}/UploadIndicators/",
                                    "retryPolicy": {
                                      "type": "exponential",
                                      "count": 5,
                                      "interval": "PT15S"
                                    }
                                  }
                                }
                              },
                              "expression": "@and(\n  greaterOrEquals(\n    item()?['last_seen'],\n    div(\n      sub(\n        ticks(variables('StartDateTimeFull')),\n        ticks('1970-01-01T00:00:00Z')\n      ),\n      10000000\n    )\n  ),\n  lessOrEquals(\n    item()?['last_seen'],\n    div(\n      sub(\n        ticks(variables('EndDateTimeFull')),\n        ticks('1970-01-01T00:00:00Z')\n      ),\n      10000000\n    )\n  )\n)",
                              "type": "If"
                            }
                          },
                          "else": {
                            "actions": {
                              "Increment_variable": {
                                "type": "IncrementVariable",
                                "inputs": {
                                  "name": "skippedCounter",
                                  "value": 1
                                }
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "equals": [
                                  "@not(contains(variables('existingIocs'), item()?['ioc']))",
                                  ""
                                ]
                              }
                            ]
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Initialize_skippedCounter": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach",
                      "runtimeConfiguration": {
                        "concurrency": {
                          "repetitions": 1
                        }
                      }
                    },
                    "Compose": {
                      "runAfter": {
                        "Get_Iocs_Per_Page": [
                          "Succeeded"
                        ]
                      },
                      "type": "Compose",
                      "inputs": "@variables('existingIocs')"
                    },
                    "Initialize_skippedCounter": {
                      "runAfter": {
                        "Compose": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "skippedCounter",
                            "type": "integer",
                            "value": 0
                          }
                        ]
                      }
                    },
                    "Compose_1": {
                      "runAfter": {
                        "For_Each_IOC": [
                          "Succeeded"
                        ]
                      },
                      "type": "Compose",
                      "inputs": "@variables('skippedCounter')"
                    },
                    "Initialize_Page_Number": {
                      "runAfter": {
                        "Initialize_EndDateTimeFull": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "PageNumber",
                            "type": "integer",
                            "value": 1
                          }
                        ]
                      }
                    },
                    "Parse_JSON": {
                      "runAfter": {
                        "HTTP_Get_IOC_Data": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('HTTP_Get_IOC_Data')",
                        "schema": {
                          "type": "object",
                          "properties": {
                            "data": {
                              "type": "object",
                              "properties": {
                                "iocs": {
                                  "type": [
                                    "array",
                                    "null"
                                  ]
                                },
                                "pagination": {
                                  "type": "object",
                                  "properties": {
                                    "total_count": {
                                      "type": [
                                        "integer",
                                        "null"
                                      ]
                                    },
                                    "page": {
                                      "type": [
                                        "integer",
                                        "null"
                                      ]
                                    },
                                    "limit": {
                                      "type": [
                                        "integer",
                                        "null"
                                      ]
                                    }
                                  }
                                }
                              }
                            },
                            "success": {
                              "type": "boolean"
                            }
                          }
                        }
                      }
                    },
                    "Initialize_Limit": {
                      "runAfter": {
                        "Initialize_Page_Number": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Limit",
                            "type": "integer",
                            "value": 100
                          }
                        ]
                      }
                    },
                    "Initialize_TotalPages": {
                      "runAfter": {
                        "Initialize_Limit": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "TotalPages",
                            "type": "integer",
                            "value": 0
                          }
                        ]
                      }
                    },
                    "Set_TotalPages": {
                      "runAfter": {
                        "Parse_JSON": [
                          "Succeeded"
                        ]
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "TotalPages",
                        "value": "@div(add(int(body('Parse_JSON')?['data']?['pagination']?['total_count']), sub(variables('limit'), 1)), variables('limit'))\n"
                      }
                    },
                    "Initialize_rawIoCs": {
                      "runAfter": {
                        "Initialize_TotalPages": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "rawIocs",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Initialize_iocArray": {
                      "runAfter": {
                        "Initialize_rawIoCs": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "iocArray",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Get_Iocs_Per_Page": {
                      "foreach": "@range(1, variables('TotalPages'))",
                      "actions": {
                        "HTTP_Get_Iocs_Per_Page": {
                          "runAfter": {
                            "Set_PageNumber": [
                              "Succeeded"
                            ]
                          },
                          "type": "Http",
                          "inputs": {
                            "uri": "@concat('https://api.cyble.ai/engine/api/v2/y/iocs?sortBy=last_seen&order=desc&limit=', string(variables('Limit')), '&page=', string(variables('PageNumber')), '&startDate=', variables('StartDateTimeFull'), '&endDate=', variables('EndDateTimeFull'))\n",
                            "method": "GET",
                            "headers": {
                              "Content-Type": "application/json",
                              "Authorization": "@{concat('Bearer ', parameters('CybleApiBearerToken'))}"
                            }
                          },
                          "runtimeConfiguration": {
                            "contentTransfer": {
                              "transferMode": "Chunked"
                            }
                          }
                        },
                        "Set_PageNumber": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "PageNumber",
                            "value": "@items('Get_Iocs_Per_Page')"
                          }
                        },
                        "Parse_IOC_Response": {
                          "runAfter": {
                            "HTTP_Get_Iocs_Per_Page": [
                              "Succeeded"
                            ]
                          },
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@body('HTTP_Get_IOC_Data')",
                            "schema": {
                              "type": "object"
                            }
                          }
                        },
                        "For_each": {
                          "foreach": "@coalesce(body('Parse_IOC_Response')?['data']?['iocs'], json('[]'))",
                          "actions": {
                            "Append_to_rawIoCs": {
                              "runAfter": {
                                "Append_to_iocArrray": [
                                  "Succeeded"
                                ]
                              },
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "rawIocs",
                                "value": "@item()"
                              }
                            },
                            "Append_to_iocArrray": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "iocArray",
                                "value": "@{concat('\"', items('For_each')?['ioc'], '\"')\n}\n"
                              }
                            }
                          },
                          "runAfter": {
                            "Parse_IOC_Response": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach"
                        },
                        "FinalIOCList": {
                          "runAfter": {
                            "For_each": [
                              "Succeeded"
                            ]
                          },
                          "type": "Compose",
                          "inputs": "@concat('[', join(variables('iocArray'), ','), ']')"
                        },
                        "KQLQuery": {
                          "runAfter": {
                            "FinalIOCList": [
                              "Succeeded"
                            ]
                          },
                          "type": "Compose",
                          "inputs": "@replace(\n  'let iocs = dynamic(PLACEHOLDER); ThreatIntelIndicators | where ObservableValue in (iocs) | order by TimeGenerated desc',\n  'PLACEHOLDER',\n  outputs('FinalIOCList')\n)"
                        },
                        "GetExistingIoCs": {
                          "runAfter": {
                            "KQLQuery": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                              }
                            },
                            "method": "post",
                            "body": "@{outputs('KQLQuery')}",
                            "path": "/queryData",
                            "queries": {
                              "subscriptions": "[[subscription().subscriptionId]",
                              "resourcegroups": "[[resourceGroup().name]",
                              "resourcetype": "Log Analytics Workspace",
                              "resourcename": "[[variables('logAnalyticsWorkspaceName')]",
                              "timerange": "Last 7 days"
                            }
                          }
                        },
                        "Parse_KQL": {
                          "runAfter": {
                            "GetExistingIoCs": [
                              "Succeeded"
                            ]
                          },
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@body('GetExistingIoCs')",
                            "schema": {
                              "value": [
                                {
                                  "ObservableValue": "16f97a927458e2c1af1a03e546730a9251f136b85fdd136dd85a091bc65cb44f"
                                }
                              ]
                            }
                          }
                        },
                        "For_each_existing_IOC": {
                          "foreach": "@body('Parse_KQL')?['value']\n",
                          "actions": {
                            "Append_to_existingIoCs": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "existingIocs",
                                "value": "@items('For_each_existing_IOC')?['ObservableValue']"
                              }
                            }
                          },
                          "runAfter": {
                            "Parse_KQL": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach"
                        }
                      },
                      "runAfter": {
                        "Set_TotalPages": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Initialize_existingIoCs": {
                      "runAfter": {
                        "Initialize_iocArray": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "existingIocs",
                            "type": "array"
                          }
                        ]
                      }
                    }
                  }
                }
              },
              "tags": {
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId2'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId2')]",
                "contentId": "[variables('_playbookContentId2')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ],
          "metadata": {
            "title": "Cyble-ThreatIntelligence-Ingest-Playbook",
            "description": "This playbook imports IoC lists from Cyble and stores them as Threat Intelligence Indicators in Microsoft Sentinel, for detection purposes.\n\nThis playbook depends on Cyble-ThreatIntelligence-Ingest that need to be installed **manually** before installing this playbook.",
            "prerequisites": [
              "First install the Cyble-ThreatIntelligenceImport playbook.",
              "To use the Cyble for Azure connector, you will need a valid API token from Cyble"
            ],
            "lastUpdateTime": "2025-05-06T00:00:00Z",
            "tags": [
              "Threat Intelligence"
            ],
            "releaseNotes": [
              {
                "version": "1.0",
                "title": "Cyble-ThreatIntelligence-Ingest",
                "description": "This playbook imports IoC lists from Cyble and stores them as Threat Intelligence Indicators in Microsoft Sentinel, for detection purposes.\n\nThis playbook depends on Cyble-ThreatIntelligence-Ingest that need to be installed **manually** before installing this playbook.",
                "prerequisites": [
                  "First install the Cyble-ThreatIntelligenceImport playbook.",
                  "To use the Cyble for Azure connector, you will need a valid API token from Cyble"
                ],
                "prerequisitesDeployTemplateFile": "../azuredeploy.json",
                "lastUpdateTime": "2025-05-06T00:00:00Z",
                "entities": [],
                "tags": [
                  "Threat Intelligence"
                ],
                "support": {
                  "tier": "Partner",
                  "armtemplate": "Generated from https://github.com/Azure/Azure-Sentinel/tree/master/Tools/Playbook-ARM-Template-Generator"
                },
                "author": {
                  "name": "Cyble Inc."
                },
                "releaseNotes": [
                  {
                    "version": "1.0",
                    "title": "Cyble-ThreatIntelligence-Ingest",
                    "notes": [
                      "Initial version"
                    ]
                  }
                ]
              }
            ],
            "basics": {
              "displayName": "Cyble Threat Intelligence Ingestion",
              "description": "Import IOCs using the Cyble Threat Intelligence API.",
              "category": "Threat Intelligence"
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId2')]",
        "contentKind": "Playbook",
        "displayName": "Cyble-TI-Ingest-Playbook",
        "contentProductId": "[variables('_playbookcontentProductId2')]",
        "id": "[variables('_playbookcontentProductId2')]",
        "version": "[variables('playbookVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CybleVisionAlert_Status_Update Playbook with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion3')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "CybleVisionAlert_Status_Update",
              "type": "String"
            },
            "CybleAPIkey": {
              "defaultValue": "",
              "type": "SecureString"
            }
          },
          "variables": {
            "MicrosoftSentinelConnectionName": "[[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
            "connection-1": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/',  variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-1": "[[variables('connection-1')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('MicrosoftSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "displayName": "[[variables('MicrosoftSentinelConnectionName')]",
                "api": {
                  "id": "[[variables('_connection-1')]",
                  "type": "Microsoft.Web/locations/managedApis"
                }
              }
            },
            {
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "identity": {
                "type": "SystemAssigned"
              },
              "properties": {
                "state": "Enabled",
                "parameters": {
                  "CybleAPIkey": {
                    "type": "SecureString",
                    "value": "[[parameters('CybleAPIkey')]"
                  },
                  "$connections": {
                    "type": "Object",
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                        "connectionName": "[[variables('MicrosoftSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/',  variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "alternativeParameterValues": {
                          "authenticationType": "ManagedServiceIdentity"
                        }
                      }
                    }
                  }
                },
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "CybleAPIkey": {
                      "type": "SecureString"
                    },
                    "$connections": {
                      "type": "Object"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "body": {
                          "callback_url": "@listCallbackUrl()"
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Check_Severity_Low": {
                      "actions": {
                        "Set_variable_17": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_MappedSeverity",
                            "value": "LOW"
                          }
                        }
                      },
                      "runAfter": {
                        "For_each_": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@variables('var_MappedSeverity')",
                              "Low"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Check_Severity_Medium": {
                      "actions": {
                        "Set_variable_18": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_MappedSeverity",
                            "value": "MEDIUM"
                          }
                        }
                      },
                      "runAfter": {
                        "Check_Severity_Low": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@triggerBody()?['object']?['properties']?['severity']",
                              "Medium"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Check_Severity_High": {
                      "actions": {
                        "Set_variable_19": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_MappedSeverity",
                            "value": "HIGH"
                          }
                        }
                      },
                      "runAfter": {
                        "Check_Severity_Medium": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@triggerBody()?['object']?['properties']?['severity']",
                              "High"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Status_New_UNREVIEWED": {
                      "actions": {
                        "UNREVIEWED": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_cybleStatus",
                            "value": "UNREVIEWED"
                          }
                        }
                      },
                      "runAfter": {
                        "For_each_": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "contains": [
                              "@triggerBody()?['object']?['properties']?['status']",
                              "New"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Status_Active_UNDERREVIEW": {
                      "actions": {
                        "UNDER_REVIEW": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_cybleStatus",
                            "value": "UNDER_REVIEW"
                          }
                        }
                      },
                      "runAfter": {
                        "Status_New_UNREVIEWED": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "contains": [
                              "@triggerBody()?['object']?['properties']?['status']",
                              "Active"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Status_Closed_RESOLVED": {
                      "actions": {
                        "RESOLVED": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_cybleStatus",
                            "value": "RESOLVED"
                          }
                        }
                      },
                      "runAfter": {
                        "Status_Active_UNDERREVIEW": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@triggerBody()?['object']?['properties']?['status']",
                              "Closed"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "For_each_": {
                      "foreach": "@triggerBody()?['object']?['properties']?['Alerts']",
                      "actions": {
                        "Parse_additional_data": {
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@items('For_each_')?['properties']?['additionalData']?['Custom Details']",
                            "schema": {
                              "properties": {
                                "Domain": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "Keyword": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "Score": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "LiveStatus": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "RegistrationDate": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "LastLiveCheck": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "Screenshot": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "AlertID": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "Current_Status": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "Set_AlertID": {
                          "runAfter": {
                            "Parse_additional_data": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_alertId",
                            "value": "@body('Parse_additional_data')?['AlertID'][0]"
                          }
                        },
                        "set_service": {
                          "runAfter": {
                            "Set_AlertID": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "var_service",
                            "value": "@body('Parse_additional_data')?['Service'][0]"
                          }
                        }
                      },
                      "runAfter": {
                        "Initialize_variables": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Initialize_variables": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "var_alertId",
                            "type": "string"
                          },
                          {
                            "name": "var_service",
                            "type": "string",
                            "value": "@{triggerBody()?['object']?['properties']?['customDetails']?['Service']}"
                          },
                          {
                            "name": "var_cybleStatus",
                            "type": "string",
                            "value": "@{triggerBody()?['object']?['properties']?['status']}"
                          },
                          {
                            "name": "var_MappedSeverity",
                            "type": "string",
                            "value": "@{triggerBody()?['object']?['properties']?['severity']}"
                          },
                          {
                            "name": "var_comm",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "post_comment-copy": {
                      "runAfter": {
                        "Set_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "uri": "https://bifrost.cyble.ai/ar-apollo-v2/api/v2/y/alerts/@{variables('var_alertId')}/comments",
                        "method": "POST",
                        "headers": {
                          "Accept": "application/json",
                          "Authorization": "@{concat('Bearer', parameters('CybleAPIkey'))}"
                        },
                        "body": {
                          "content": "@{variables('var_comm')}",
                          "service": "@{variables('var_service')}"
                        }
                      },
                      "runtimeConfiguration": {
                        "contentTransfer": {
                          "transferMode": "Chunked"
                        }
                      }
                    },
                    "update_alert_details": {
                      "runAfter": {
                        "Set_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "uri": "https://bifrost.cyble.ai/ar-apollo-v2/api/v2/y/alerts",
                        "method": "PUT",
                        "headers": {
                          "Accept": "application/json",
                          "Authorization": "@{concat('Bearer', parameters('CybleAPIkey'))}"
                        },
                        "body": "\"alerts\": [\n                    {\n                      \"id\": \"@{variables('var_alertId')}\",\n                      \"status\": \"@{variables('var_cybleStatus')}\",\n                      \"service\": \"@{variables('var_service')}\"\n                      \"severity\": \"@{variables('var_MappedSeverity')}\" \n                    }\n                  ]"
                      }
                    },
                    "Set_variable": {
                      "runAfter": {
                        "Status_Closed_RESOLVED": [
                          "Succeeded"
                        ]
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "var_comm",
                        "value": "@concat(\n  'This alert was updated by ',\n  coalesce(triggerBody()?['object']?['properties']?['owner']?['assignedTo'], 'Unknown'),\n  '. Status updated to ',\n  variables('var_cybleStatus'),\n  '. Comment: ',\n  coalesce(\n    triggerBody()?['incidentUpdates']?['comments']?[0]?['properties']?['message'],\n    ''\n  )\n)"
                      }
                    }
                  }
                }
              },
              "tags": {
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId3'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId3')]",
                "contentId": "[variables('_playbookContentId3')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                }
              }
            }
          ],
          "metadata": {
            "title": "CybleVisionAlert_Status_Update",
            "description": "This Logic App updates Cyble alert status and severity based on Sentinel incident changes. It supports automatic updates via automation rules and interprets user-applied tags to determine the correct status mapping.",
            "prerequisites": [
              "1. A valid Cyble API key is required to authenticate requests to the Cyble platform. Which can be obtained from your Cyble account.",
              "2. Sentinel Automation Rules must be configured to trigger this Logic App.",
              "3. [Automation Rules](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cyble%20Vision/Playbooks/CybleVisionAlert_Status_Update/Azure_Sentinel_automation_rules.json)"
            ],
            "postDeployment": [
              "* When updating an incident, remove any auto-applied tags such as",
              "   severity auto set",
              "    status auto set",
              "These tags can prevent the Logic App from triggering correctly."
            ],
            "lastUpdateTime": "2025-12-12T10:02:00Z",
            "tags": [
              "Alerts",
              "Cyble Vision"
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Cyble-Vision-Alert-Status",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId3')]",
        "contentKind": "Playbook",
        "displayName": "CybleVisionAlert_Status_Update",
        "contentProductId": "[variables('_playbookcontentProductId3')]",
        "id": "[variables('_playbookcontentProductId3')]",
        "version": "[variables('playbookVersion3')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CybleVisionAlertsWorkbook Workbook with template version 3.0.2",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "This Workbook is used to display and analyze Cyble Vision Alerts. Cyble Vision is a threat intelligence platform that provides real-time monitoring of an organization's digital footprint across the dark, deep, and surface web."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Cyble Vision Alerts\\n---\\n\\nWorkbook to display and analyze Cyble Vision Alerts. This workbook visualize data that is retrived by the ```Cyble Vision Alerts``` CCF Data Connector.First connect the Cyble Vision Connector from Data Connector blade and then select CybleVisionAlerts_CL Logs table. \",\"style\":\"info\"},\"name\":\"text - 2\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"8e8c2f1a-d25d-49d1-a217-9831dbc4f919\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"time_picker\",\"label\":\"Time Picker\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":604800000}},{\"id\":\"f8d34a51-ba10-4241-abff-cb6c14b50a55\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"log_table\",\"label\":\"Alerts Log Table\",\"type\":2,\"isRequired\":true,\"query\":\"search \\\"*\\\" | summarize count() by $table | sort by count_ desc | where $table endswith \\\"CL\\\" | project $table\",\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"time_picker\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":\"CybleVisionAlerts_CL\"},{\"id\":\"89279a9c-af9e-4734-8a98-21aa1f2fa545\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Service\",\"label\":\"Alert Service\",\"type\":2,\"description\":\"Filter alert rules you're looking at\",\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"{log_table}\\n| distinct Service\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":604800000},\"timeContextFromParameter\":\"time_picker\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"web_applications\"]},{\"id\":\"e9c5c651-ea8f-499e-8aa1-93faa1ae2eba\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"AlertID\",\"label\":\"Select AlertID \",\"type\":2,\"query\":\"CybleVisionAlerts_CL\\n| where Service contains {Service}\\n| distinct ID\",\"typeSettings\":{\"showDefault\":false},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":\"87574a9e-68c6-539c-a5e8-8b74f6baef8d\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let pService = {Service};\\nlet pAlert   = '{AlertID}';\\n\\nCybleVisionAlerts_CL\\n| where isempty(pService) or Service == pService\\n| where isempty(pAlert) or ID == pAlert\\n| extend ParsedData = parse_json(Data)\\n| project TimeGenerated, ID, Service, Severity, Status, Description, ParsedData, Data\\n| order by TimeGenerated desc\\n\",\"size\":0,\"timeContext\":{\"durationMs\":604800000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Data\",\"formatter\":2,\"formatOptions\":{\"linkTarget\":\"CellDetails\",\"linkIsContextBlade\":true}}]},\"tileSettings\":{\"rightContent\":{\"columnMatch\":\"ParsedData\",\"formatter\":2},\"secondaryContent\":{\"columnMatch\":\"Data\",\"formatter\":2,\"formatOptions\":{\"linkColumn\":\"Data\",\"linkTarget\":\"GenericDetails\",\"linkIsContextBlade\":true}},\"showBorder\":false,\"rowLimit\":100,\"sortOrderField\":2}},\"name\":\"query - 2\"}],\"fallbackResourceIds\":[\"/subscriptions/34692849-4d09-4702-8aed-cfdb6e696cdb/resourcegroups/vision/providers/microsoft.operationalinsights/workspaces/pb-t3\"],\"fromTemplateId\":\"sentinel-CybleVisionAlertsWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=CybleVisionAlertsWorkbook; logoFileName=CybleLogo.svg; description=This Workbook is used to display and analyze Cyble Vision Alerts. Cyble Vision is a threat intelligence platform that provides real-time monitoring of an organization's digital footprint across the dark, deep, and surface web.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.1; title=Cyble Vision Alerts Workbook  (Preview); templateRelativePath=CybleVisionAlertsWorkbook.json; subtitle=; provider=Cyble Inc.}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cyble Vision",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cyble Inc"
                },
                "support": {
                  "name": "Cyble Support",
                  "email": "csm@cyble.com",
                  "tier": "Partner",
                  "link": "https://cyble.com/talk-to-sales/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "CybleVisionAlerts_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "CybleVisionAlerts",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.2",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Cyble Vision",
        "publisherDisplayName": "Cyble Support",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Cyble%20Vision/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>This Solution provides Playbooks for Cyble Vision Threat Intelligence ingestion and IOC enrichment, integrating Cyble APIs.</p>\n<p>This Solution also includes a CCF Conenctor which enables Alerts ingestion from Cyble Platform to Microsoft Sentinel Workspace.</p>\n<p><strong>Data Connectors:</strong> 1, <strong>Parsers:</strong> 45, <strong>Workbooks:</strong> 1, <strong>Analytic Rules:</strong> 43, <strong>Playbooks:</strong> 3</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/CybleLogo.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Cyble Vision",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cyble Inc"
        },
        "support": {
          "name": "Cyble Support",
          "email": "csm@cyble.com",
          "tier": "Partner",
          "link": "https://cyble.com/talk-to-sales/"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject4')._analyticRulecontentId4]",
              "version": "[variables('analyticRuleObject4').analyticRuleVersion4]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject5')._analyticRulecontentId5]",
              "version": "[variables('analyticRuleObject5').analyticRuleVersion5]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject6')._analyticRulecontentId6]",
              "version": "[variables('analyticRuleObject6').analyticRuleVersion6]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject7')._analyticRulecontentId7]",
              "version": "[variables('analyticRuleObject7').analyticRuleVersion7]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject8')._analyticRulecontentId8]",
              "version": "[variables('analyticRuleObject8').analyticRuleVersion8]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject9')._analyticRulecontentId9]",
              "version": "[variables('analyticRuleObject9').analyticRuleVersion9]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject10')._analyticRulecontentId10]",
              "version": "[variables('analyticRuleObject10').analyticRuleVersion10]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject11')._analyticRulecontentId11]",
              "version": "[variables('analyticRuleObject11').analyticRuleVersion11]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject12')._analyticRulecontentId12]",
              "version": "[variables('analyticRuleObject12').analyticRuleVersion12]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject13')._analyticRulecontentId13]",
              "version": "[variables('analyticRuleObject13').analyticRuleVersion13]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject14')._analyticRulecontentId14]",
              "version": "[variables('analyticRuleObject14').analyticRuleVersion14]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject15')._analyticRulecontentId15]",
              "version": "[variables('analyticRuleObject15').analyticRuleVersion15]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject16')._analyticRulecontentId16]",
              "version": "[variables('analyticRuleObject16').analyticRuleVersion16]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject17')._analyticRulecontentId17]",
              "version": "[variables('analyticRuleObject17').analyticRuleVersion17]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject18')._analyticRulecontentId18]",
              "version": "[variables('analyticRuleObject18').analyticRuleVersion18]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject19')._analyticRulecontentId19]",
              "version": "[variables('analyticRuleObject19').analyticRuleVersion19]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject20')._analyticRulecontentId20]",
              "version": "[variables('analyticRuleObject20').analyticRuleVersion20]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject21')._analyticRulecontentId21]",
              "version": "[variables('analyticRuleObject21').analyticRuleVersion21]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject22')._analyticRulecontentId22]",
              "version": "[variables('analyticRuleObject22').analyticRuleVersion22]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject23')._analyticRulecontentId23]",
              "version": "[variables('analyticRuleObject23').analyticRuleVersion23]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject24')._analyticRulecontentId24]",
              "version": "[variables('analyticRuleObject24').analyticRuleVersion24]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject25')._analyticRulecontentId25]",
              "version": "[variables('analyticRuleObject25').analyticRuleVersion25]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject26')._analyticRulecontentId26]",
              "version": "[variables('analyticRuleObject26').analyticRuleVersion26]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject27')._analyticRulecontentId27]",
              "version": "[variables('analyticRuleObject27').analyticRuleVersion27]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject28')._analyticRulecontentId28]",
              "version": "[variables('analyticRuleObject28').analyticRuleVersion28]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject29')._analyticRulecontentId29]",
              "version": "[variables('analyticRuleObject29').analyticRuleVersion29]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject30')._analyticRulecontentId30]",
              "version": "[variables('analyticRuleObject30').analyticRuleVersion30]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject31')._analyticRulecontentId31]",
              "version": "[variables('analyticRuleObject31').analyticRuleVersion31]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject32')._analyticRulecontentId32]",
              "version": "[variables('analyticRuleObject32').analyticRuleVersion32]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject33')._analyticRulecontentId33]",
              "version": "[variables('analyticRuleObject33').analyticRuleVersion33]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject34')._analyticRulecontentId34]",
              "version": "[variables('analyticRuleObject34').analyticRuleVersion34]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject35')._analyticRulecontentId35]",
              "version": "[variables('analyticRuleObject35').analyticRuleVersion35]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject36')._analyticRulecontentId36]",
              "version": "[variables('analyticRuleObject36').analyticRuleVersion36]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject37')._analyticRulecontentId37]",
              "version": "[variables('analyticRuleObject37').analyticRuleVersion37]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject38')._analyticRulecontentId38]",
              "version": "[variables('analyticRuleObject38').analyticRuleVersion38]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject39')._analyticRulecontentId39]",
              "version": "[variables('analyticRuleObject39').analyticRuleVersion39]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject40')._analyticRulecontentId40]",
              "version": "[variables('analyticRuleObject40').analyticRuleVersion40]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject41')._analyticRulecontentId41]",
              "version": "[variables('analyticRuleObject41').analyticRuleVersion41]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject42')._analyticRulecontentId42]",
              "version": "[variables('analyticRuleObject42').analyticRuleVersion42]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject43')._analyticRulecontentId43]",
              "version": "[variables('analyticRuleObject43').analyticRuleVersion43]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject1').parserContentId1]",
              "version": "[variables('parserObject1').parserVersion1]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject2').parserContentId2]",
              "version": "[variables('parserObject2').parserVersion2]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject3').parserContentId3]",
              "version": "[variables('parserObject3').parserVersion3]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject4').parserContentId4]",
              "version": "[variables('parserObject4').parserVersion4]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject5').parserContentId5]",
              "version": "[variables('parserObject5').parserVersion5]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject6').parserContentId6]",
              "version": "[variables('parserObject6').parserVersion6]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject7').parserContentId7]",
              "version": "[variables('parserObject7').parserVersion7]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject8').parserContentId8]",
              "version": "[variables('parserObject8').parserVersion8]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject9').parserContentId9]",
              "version": "[variables('parserObject9').parserVersion9]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject10').parserContentId10]",
              "version": "[variables('parserObject10').parserVersion10]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject11').parserContentId11]",
              "version": "[variables('parserObject11').parserVersion11]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject12').parserContentId12]",
              "version": "[variables('parserObject12').parserVersion12]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject13').parserContentId13]",
              "version": "[variables('parserObject13').parserVersion13]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject14').parserContentId14]",
              "version": "[variables('parserObject14').parserVersion14]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject15').parserContentId15]",
              "version": "[variables('parserObject15').parserVersion15]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject16').parserContentId16]",
              "version": "[variables('parserObject16').parserVersion16]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject17').parserContentId17]",
              "version": "[variables('parserObject17').parserVersion17]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject18').parserContentId18]",
              "version": "[variables('parserObject18').parserVersion18]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject19').parserContentId19]",
              "version": "[variables('parserObject19').parserVersion19]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject20').parserContentId20]",
              "version": "[variables('parserObject20').parserVersion20]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject21').parserContentId21]",
              "version": "[variables('parserObject21').parserVersion21]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject22').parserContentId22]",
              "version": "[variables('parserObject22').parserVersion22]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject23').parserContentId23]",
              "version": "[variables('parserObject23').parserVersion23]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject24').parserContentId24]",
              "version": "[variables('parserObject24').parserVersion24]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject25').parserContentId25]",
              "version": "[variables('parserObject25').parserVersion25]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject26').parserContentId26]",
              "version": "[variables('parserObject26').parserVersion26]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject27').parserContentId27]",
              "version": "[variables('parserObject27').parserVersion27]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject28').parserContentId28]",
              "version": "[variables('parserObject28').parserVersion28]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject29').parserContentId29]",
              "version": "[variables('parserObject29').parserVersion29]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject30').parserContentId30]",
              "version": "[variables('parserObject30').parserVersion30]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject31').parserContentId31]",
              "version": "[variables('parserObject31').parserVersion31]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject32').parserContentId32]",
              "version": "[variables('parserObject32').parserVersion32]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject33').parserContentId33]",
              "version": "[variables('parserObject33').parserVersion33]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject34').parserContentId34]",
              "version": "[variables('parserObject34').parserVersion34]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject35').parserContentId35]",
              "version": "[variables('parserObject35').parserVersion35]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject36').parserContentId36]",
              "version": "[variables('parserObject36').parserVersion36]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject37').parserContentId37]",
              "version": "[variables('parserObject37').parserVersion37]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject38').parserContentId38]",
              "version": "[variables('parserObject38').parserVersion38]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject39').parserContentId39]",
              "version": "[variables('parserObject39').parserVersion39]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject40').parserContentId40]",
              "version": "[variables('parserObject40').parserVersion40]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject41').parserContentId41]",
              "version": "[variables('parserObject41').parserVersion41]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject42').parserContentId42]",
              "version": "[variables('parserObject42').parserVersion42]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject43').parserContentId43]",
              "version": "[variables('parserObject43').parserVersion43]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject44').parserContentId44]",
              "version": "[variables('parserObject44').parserVersion44]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject45').parserContentId45]",
              "version": "[variables('parserObject45').parserVersion45]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_IoC-Enrichment')]",
              "version": "[variables('playbookVersion1')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_TI-Ingest')]",
              "version": "[variables('playbookVersion2')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CybleVisionAlert_Status_Update')]",
              "version": "[variables('playbookVersion3')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            }
          ]
        },
        "firstPublishDate": "2025-05-05",
        "providers": [
          "Cyble"
        ],
        "categories": {
          "domains": [
            "Security - Threat Protection"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
