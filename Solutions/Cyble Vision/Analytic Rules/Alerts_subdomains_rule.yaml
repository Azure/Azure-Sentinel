id: 7a0f79cc-8d28-44b5-ac1e-6176565bb7b8
name: Cyble Vision Alerts Discovered Subdomain
description: |
  'Triggers when a new subdomain is detected for a monitored keyword/domain.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryfrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- Reconnaissance
relevantTechniques:
- T1595
query: |
  Alerts_subdomains  
  | where Service == "subdomains" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
  alertDetailsOverride:
  alertDisplayNameFormat: New Subdomain Detected {{SD_Subdomain}}
  alertDescriptionFormat: |
    A new subdomain was discovered for monitored domain/keyword. Keyword {{SD_KeywordName}} Bucket {{SD_BucketName}} Severity {{MappedSeverity}} This may represent new attack surface exposure or infrastructure expansion.
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  SD_Subdomain: SD_Subdomain
  SD_KeywordName: KeywordName
  SD_EntityID: EntityID
  SD_BucketName: BucketName
entityMappings:
- entityType: DNS
  fieldMappings:
  - identifier: DomainName
    columnName: SD_Subdomain
version: 1.0.0
kind: Scheduled
