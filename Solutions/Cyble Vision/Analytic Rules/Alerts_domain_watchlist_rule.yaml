id: 0a54dc90-9a9d-4300-af21-feb5136e81da
name: Cyble Vision Alerts Domain Watchlist
description: |
  'Triggers when monitored domain DNS records change (A, NS, MX, TXT, SOA). DNS record changes may indicate misconfiguration, domain takeover attempts, or infrastructure shifts requiring review.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryfrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- ResourceDevelopment
relevantTechniques:
- T1584
query: |
  Alerts_domain_watchlist  
  | where Service == "domain_watchlist" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
  alertDetailsOverride:
  alertDisplayNameFormat: DNS Record Change Detected for {{DW_New_Domain}}
  alertDescriptionFormat: |
    Domain Watchlist Alert: DNS records for {{DW_New_Domain}} have changed. Updated fields {{DW_UpdatedFields}}. Review differences between old and new DNS records to determine if this is a legitimate update or a potential hijack attempt.
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  DW_UpdatedFields: DW_UpdatedFields
  DW_Old_Domain: DW_Old_Domain
  DW_New_Domain: DW_New_Domain
entityMappings:
- entityType: DNS
  fieldMappings:
  - identifier: DomainName
    columnName: DW_New_Domain
version: 1.0.0
kind: Scheduled
