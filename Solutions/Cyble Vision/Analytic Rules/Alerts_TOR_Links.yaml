id: b9df1ec4-a572-4448-8da1-1bc4b7e1687f
name: Cyble Vision Alerts TOR Links
description: |
  'Detects Tor marketplace, darkweb link, and onion domain alerts from CybleVision. Uses the Alerts_TorLinks parser to extract onion URLs, search engines, search keywords, content, and identifiers. Incidents are grouped by service.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryFrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
suppressionDuration: PT5H
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- ResourceDevelopment
- Reconnaissance
relevantTechniques:
- T1583
- T1590
- T1595
subTechniques: []
query: |
  Alerts_tor_links 
  | where Service == "tor_links" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
alertDetailsOverride:
  alertDisplayNameFormat: CybleVision Tor Link Alert ({{KeywordName}})
  alertDescriptionFormat: |
    Source {{TL_SearchEngine}}. Tor URL {{TL_TorUrl}}. Description {{Description}}"
  alertDynamicProperties: []
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  SearchEngine: Search_Engine
  SearchKeyword: TL_SearchKeyword
  TOR_Doc: TL_Doc_Data
  DocId: TL_Doc_Id
  UpdatedOn: TL_UpdatedOn
  Tags: Tags
entityMappings:
- entityType: URL
  fieldMappings:
  - identifier: Url
    columnName: TL_TorUrl
- entityType: DNS
  fieldMappings:
  - identifier: DomainName
    columnName: Domain
- entityType: IP
  fieldMappings:
  - identifier: Address
    columnName: IP
version: 1.0.0
kind: Scheduled
