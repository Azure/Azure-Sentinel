id: db417cee-529c-4eac-b7b9-36eb0166800a
name: Cyble Vision Alerts Cloud Storage
description: |
  'Detects cloud storage objects/paths discovered in ingestion (uses Alerts_cloud_storage parser). Creates incidents for discovered S3/GCS/Azure blob objects, includes bucket/object/url, size and workflow metadata. Mandatory custom details: MappedSeverity, Status, AlertID, Service.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryfrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- Exfiltration
- Discovery
relevantTechniques:
- T1537
- T1083
query: |
  Alerts_cloud_storage  
  | where Service == "cloud_storage" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
alertDetailsOverride:
  alertDisplayNameFormat: Exposed cloud object  {{CS_Filename}} in {{CS_Bucket}}.
  alertDescriptionFormat: |
    A cloud storage object was discovered by ingestion. (ID {{CS_BucketId}}). Object {{CS_FullPath}} (ID {{CS_ObjectId}}). Review and remediate access if required.
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  CS_Bucket: CS_Bucket
  CS_BucketId: CS_BucketId
  CS_Filename: CS_Filename
  CS_FullPath: CS_FullPath
  CS_ObjectId: CS_ObjectId
  CS_Size: CS_Size
  CS_Url: CS_Url
  ProcessedByAgenticAI: CS_ProcessedByAgenticAI
  CS_AgenticAIStatus: CS_AgenticAIStatus
  CS_WorkflowID: CS_WorkflowID
entityMappings:
- entityType: Url
  fieldMappings:
  - identifier: Url
    columnName: CS_Url
- entityType: Host
  fieldMappings:
  - identifier: HostName
    columnName: CS_Bucket
version: 1.0.0
kind: Scheduled
