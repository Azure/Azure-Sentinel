id: 601a5859-0dc2-452d-8d1e-66dc651c16d5
name: Cyble Vision Alerts Discord Keyword
description: |
  'Triggers when monitored keywords or risky content appear in Discord channels. Useful for detecting data leakage, impersonation, abuse or reputational threats originating from social platforms.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryfrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- Reconnaissance
- InitialAccess
relevantTechniques:
- T1598
- T1664
query: |
  Alerts_discord  
  | where Service == "discord" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
  alertDetailsOverride:
  alertDisplayNameFormat: Discord Alert Risky Content by {{DC_AuthorUsername}}
  alertDescriptionFormat: |
    A monitored keyword or harmful content was detected in Discord.
    **Server:** {{DC_ServerName}}
    **Channel:** {{DC_ChannelName}}
    **Message:** {{DC_Content}}
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  DC_MessageID: DC_MessageID
  DC_Content: DC_Content
  DC_ChannelName: DC_ChannelName
  DC_ServerName: DC_ServerName
  DC_AuthorUsername: DC_AuthorUsername
entityMappings:
- entityType: Account
  fieldMappings:
  - identifier: AadUserId
    columnName: DC_AuthorID
  - identifier: Name
    columnName: DC_AuthorUsername
- entityType: CloudApplication
  fieldMappings:
  - identifier: Name
    columnName: DC_ServerName
version: 1.0.0
kind: Scheduled
