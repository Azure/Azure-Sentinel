id: f3c25011-4509-41c8-be27-35d891531c39
name: Cyble Vision Alerts Bitbucket
description: |
  'Detects exposed secrets in Bitbucket repositories using the Alerts_bit_bucket parser. Creates one incident per matched secret. Includes decoder, detector, commit, file, and repository context for SOC triage.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryFrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- CredentialAccess
- Exfiltration
- Discovery
relevantTechniques:
- T1552
- T1537
- T1083
query: |
  Alerts_bit_bucket 
  | where Service == "bit_bucket" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
alertDetailsOverride:
  alertDisplayNameFormat: Secret Exposure in Bitbucket {{BB_File}} ({{BB_DetectorName}})
  alertDescriptionFormat: |
    A sensitive secret was detected in Bitbucket repository {{BB_Repository}}. File {{BB_File}}:{{BB_Line}}. Investigator should verify exposure, rotate credentials and remediate impacted systems.
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  BB_DetectorName: BB_DetectorName
  BB_Raw: BB_Raw
  BB_File: BB_File
  BB_Line: BB_Line
  BB_Commit: BB_Commit
  BB_Email: BB_Email
  BB_Repository: BB_Repository
  BB_Link: BB_Link
  BB_Verified: BB_Verified
  BB_RotationGuide: BB_RotationGuide
entityMappings:
- entityType: Url
  fieldMappings:
  - identifier: Url
    columnName: BB_Repository
- entityType: Url
  fieldMappings:
  - identifier: Url
    columnName: BB_Link
- entityType: File
  fieldMappings:
  - identifier: Name
    columnName: BB_File
  - identifier: Directory
    columnName: KeywordName
version: 1.0.0
kind: Scheduled
