id: d6a188a8-bc48-4cc2-889b-7583c2f18e52
name: Cyble Vision Alerts - Subdomains Alert Detection
description: |
  This analytic rule detects newly observed or suspicious subdomains identified by Cyble Intelligence ingestion. Each alert corresponds to a single subdomain observation and generates one incident for SOC triage.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryFrequency: PT5M
queryPeriod: PT5M
triggerOperator: GreaterThan
triggerThreshold: 0
suppressionDuration: PT5M
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- Reconnaissance
techniques:
- T1590
- T1595
query: |
  Alerts_subdomains
  | where Service == "subdomains"
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
    groupByEntities: []
    groupByAlertDetails: []
    groupByCustomDetails: []
alertDetailsOverride:
  alertDisplayNameFormat: Cyble Subdomains Alert - {{SD_Subdomain_Nested}}
  alertDescriptionFormat: |
    A new or suspicious subdomain was identified by Cyble Intelligence.
    Keyword: {{KeywordName}}
    Status: {{Status}}
    Severity: {{Severity}}
customDetails:
  MappedSeverity: MappedSeverity
  AlertID: AlertID
  Service: Service
  Status: Status
  Subdomain: SD_Subdomain_Nested
entityMappings:
- entityType: DNS
  fieldMappings:
  - identifier: DomainName
    columnName: SD_Subdomain_Nested
version: 1.0.0
kind: Scheduled
