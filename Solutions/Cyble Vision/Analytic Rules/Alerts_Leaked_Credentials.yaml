id: 224a63ae-e278-4a11-b7c2-02ec3e17b56c
name: Cyble Vision Alerts Leaked Credentials
description: |
  'Detects leaked credentials identified by CybleVision ingestion and triggers an incident with mapped entities, severity, and details.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryFrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
suppressionDuration: PT5H
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- CredentialAccess
- Discovery
- Reconnaissance
relevantTechniques:
- T1552
- T1082
subTechniques: []
query: |
  Alerts_leaked_credentials
  | where Service == "leaked_credentials"
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
alertDetailsOverride:
  alertDisplayNameFormat: Leaked Credentials Detected {{LC_Username}}
  alertDescriptionFormat: |
    A leaked set of credentials associated with {{LC_Username}} was detected. Domain {{LC_Domain}} Source URL {{LC_URL}}
  alertDynamicProperties: []
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  MappedSeveritry: MappedSeverity
  Leak_Username: LC_Username
  Leak_Url: LC_URL
  Leak_Date: LC_Date
  Leak_Tags: LC_Tags
  Leak_Data: LC_Data
entityMappings:
- entityType: Account
  fieldMappings:
  - identifier: Name
    columnName: LC_Username
- entityType: URL
  fieldMappings:
  - identifier: Url
    columnName: LC_URL
- entityType: DNS
  fieldMappings:
  - identifier: DomainName
    columnName: LC_Domain
version: 1.0.0
kind: Scheduled
