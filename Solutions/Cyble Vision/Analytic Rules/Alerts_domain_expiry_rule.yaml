id: 81404e99-ce27-45aa-aa19-a276a3d4c645
name: Cyble Vision Alerts Domain Expiry Alert
description: |
  'Triggers when a monitored domain is about to expire. Expired domains risk service disruption, takeover, or misuse by adversaries.'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: CybleVisionAlerts
  dataTypes:
  - CybleVisionAlerts_CL
enabled: true
queryfrequency: 30m
queryPeriod: 30m
triggerOperator: GreaterThan
triggerThreshold: 0
eventGroupingSettings:
  aggregationKind: AlertPerResult
tactics:
- Impact
relevantTechniques:
- T1499
query: |
  Alerts_domain_expiry  
  | where Service == "domain_expiry" 
  | extend MappedSeverity = Severity
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
  alertDetailsOverride:
  alertDisplayNameFormat: Domain Expiration Imminent {{DE_Domain}}
  alertDescriptionFormat: |
    The monitored domain is expiring soon. Expiry Date {{DE_ExpiryDate}}. Due in {{DE_DueDays}} days. Alert Type {{DE_TypeText}}. Immediate renewal is recommended to avoid service disruption or domain hijacking.
customDetails:
  MappedSeverity: Severity
  Status: Status
  AlertID: AlertID
  Service: Service
  DE_Domain: DE_Domain
  DE_DueDays: DE_DueDays
  DE_ExpiryDate: DE_ExpiryDate
  DE_TypeText: DE_TypeText
entityMappings:
- entityType: DNS
  fieldMappings:
  - identifier: DomainName
    columnName: DE_Domain
version: 1.0.0
kind: Scheduled
