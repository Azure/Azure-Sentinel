[
    {
        "name": "CybleVisionAlertsDCR",
        "apiVersion": "2021-09-01-preview",
        "type": "Microsoft.Insights/dataCollectionRules",
        "location": "{{location}}",
        "properties": {
            "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
            "streamDeclarations": {
                "Custom-CybleVisionAlerts_CL": {
                    "columns": [
                        {
                            "name": "created_at",
                            "type": "datetime"
                        },
                        {
                            "name": "updated_at",
                            "type": "datetime"
                        },
                        {
                            "name": "deleted_at",
                            "type": "string"
                        },
                        {
                            "name": "id",
                            "type": "string"
                        },
                        {
                            "name": "data_id",
                            "type": "string"
                        },
                        {
                            "name": "entity_id",
                            "type": "int"
                        },
                        {
                            "name": "keyword_name",
                            "type": "string"
                        },
                        {
                            "name": "entity_type",
                            "type": "int"
                        },
                        {
                            "name": "service",
                            "type": "string"
                        },
                        {
                            "name": "company_id",
                            "type": "int"
                        },
                        {
                            "name": "description",
                            "type": "string"
                        },
                        {
                            "name": "status",
                            "type": "string"
                        },
                        {
                            "name": "assignee_id",
                            "type": "string"
                        },
                        {
                            "name": "assignment_date",
                            "type": "string"
                        },
                        {
                            "name": "archive_date",
                            "type": "string"
                        },
                        {
                            "name": "severity",
                            "type": "string"
                        },
                        {
                            "name": "updated_by_id",
                            "type": "string"
                        },
                        {
                            "name": "created_by",
                            "type": "string"
                        },
                        {
                            "name": "user_severity",
                            "type": "string"
                        },
                        {
                            "name": "risk_score",
                            "type": "string"
                        },
                        {
                            "name": "bucket_id",
                            "type": "int"
                        },
                        {
                            "name": "filename",
                            "type": "string"
                        },
                        {
                            "name": "repository_name",
                            "type": "string"
                        },
                        {
                            "name": "owner_name",
                            "type": "string"
                        },
                        {
                            "name": "bucket_name",
                            "type": "string"
                        },
                        {
                            "name": "true_positive",
                            "type": "string"
                        },
                        {
                            "name": "llm_processed",
                            "type": "string"
                        },
                        {
                            "name": "llm_explanation",
                            "type": "string"
                        },
                        {
                            "name": "tags",
                            "type": "string"
                        }
                    ]
                }
            },
            "destinations": {
                "logAnalytics": [
                    {
                        "workspaceResourceId": "{{workspaceResourceId}}",
                        "name": "clv2ws1"
                    }
                ]
            },
            "dataFlows": [
                {
                    "streams": [
                        "Custom-CybleVisionAlerts_CL"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source | project  TimeGenerated = now(), CreatedAt = todatetime(created_at), UpdatedAt = todatetime(updated_at), DeletedAt = deleted_at, DataID = data_id, EntityID = entity_id, KeywordName = keyword_name, EntityType = entity_type, Service = service, CompanyID = company_id, Description = description, Status = status, AssigneeID = assignee_id, AssignmentDate = assignment_date, ArchiveDate = archive_date, Severity = severity, UpdatedBy = updated_by_id, CreatedBy = created_by, UserSeverity = user_severity, RiskScore = risk_score, BucketID = bucket_id, Filename = filename, RepositoryName = repository_name, OwnerName = owner_name, BucketName = bucket_name, TruePositive = true_positive, LLMProcessed = llm_processed, LLMExplanation = llm_explanation, Tags = tags",
                    "outputStream": "Custom-CybleVisionAlerts_CL"
                }
            ]
        }
    }
]
