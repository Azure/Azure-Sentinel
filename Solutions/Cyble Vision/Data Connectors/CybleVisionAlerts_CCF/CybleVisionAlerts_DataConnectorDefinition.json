{
    "name": "CybleVisionAlerts",
    "apiVersion": "2022-09-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "location": "{{location}}",
    "kind": "Customizable",
    "availability": {
        "isPreview": true
    },
    "properties": {
        "connectorUiConfig": {
            "title": "Cyble Vision Alerts",
            "publisher": "Cyble",
            "id": "CybleVisionAlerts",
            "descriptionMarkdown": "The **Cyble Vision Alerts** CCF Data Connector enables Ingestion of Threat Alerts from Cyble Vision into Microsoft Sentinel using the Codeless Connector Framework Connector. It collects alert data via API, normalizes it, and stores it in a custom table for advanced detection, correlation, and response.",
            "graphQueriesTableName": "CybleVisionAlerts_CL",
            "graphQueries": [
                {
                    "metricName": "Total Alerts received",
                    "legend": "Alerts",
                    "baseQuery": "{{graphQueriesTableName}}"
                }
            ],
            "sampleQueries": [
                {
                    "description": "Get Sample of Cyble Vision Alerts",
                    "query": "{{graphQueriesTableName}}\n | take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "CybleVisionAlerts_CL",
                    "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors"
                }
            ],
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "write": true,
                            "read": true,
                            "delete": true
                        }
                    }
                ],
                "customs": [
                    {
                        "name": "Cyble Vision API token",
                        "description": "An API Token from Cyble Vision Platform is required."
                    }
                ]
            },
            "instructionSteps": [
                {
                    "title": "Step 1 - Generating API Token from Cyble Platform",
                    "description": "Navigate to [Cyble Platform](https://cyble.ai/utilities/access-apis) and log in using your Cyble Vision credentials.\n\nOnce logged in, go to the left-hand panel and scroll down to **Utilities**. Click on **Access APIs**. On the top-right corner of the page, click the **+ (Add)** icon to generate a new API key. Provide an alias (a friendly name for your key) and click **Generate**. Copy the generated API token and store it securely."
                },
                {
                    "title": "STEP 2 - Configure the Data Connector",
                    "description": "Return to Microsoft Sentinel and open the **Cyble Vision Alerts** data connector configuration page. Paste your Cyble API Token into the **API Token** field under 'API Details'.",
                    "instructions": [
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "API Token",
                                "placeholder": "Enter your API Token",
                                "type": "password",
                                "name": "ApiToken"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Query Interval (in minutes)",
                                "placeholder": "Enter Time in Minutes (e.g., 10)",
                                "type": "Textbox",
                                "name": "querywindow"
                            }
                        },
                        {
                            "type": "ConnectionToggleButton",
                            "parameters": {
                                "connectLabel": "Connect",
                                "name": "toggle"
                            }
                        }
                    ]
                }
            ]
        }
    }
}