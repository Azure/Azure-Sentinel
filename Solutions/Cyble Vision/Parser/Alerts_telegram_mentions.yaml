id: e2c4b19a-3c41-4c90-ae7b-9b16c44df0a7
Function:
  Title: Parser to extract Telegram Mentions alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_telegram_mentions
FunctionAlias: Alerts_telegram_mentions
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "telegram_mentions"
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | extend AlertID = ID
  | extend Data = parse_json(Data)
  // Extract primary Telegram metadata
  | extend
      TG_ChatID          = tolong(Data.chat_id),
      TG_ChatTitle       = tostring(Data.chat_title),
      TG_Message         = tostring(Data.message),
      TG_CreatedDate     = tostring(Data.created_date),
      TG_UpdatedDate     = tostring(Data.updated_date),
      TG_UserID          = tostring(Data.user_id),
      TG_Username2       = tostring(Data.username)
  // Extract URLs from message text (Telegram links & media)
  | extend
      TG_Urls = extract_all(@"(https?://[^\s]+)", TG_Message)
  // Tags
  | extend TG_Tags = tostring(Tags)
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      TG_ChatID,
      TG_ChatTitle,
      TG_Message,
      TG_CreatedDate,
      TG_UpdatedDate,
      TG_UserID,
      TG_Username2,
      TG_Urls,
      TG_Tags
