id: 9f3e7b8c-2c61-4d55-8601-2e7f90a4b3c2
Function:
  Title: Parser to extract Cloud Storage alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_cloud_storage
FunctionAlias: Alerts_cloud_storage
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "cloud_storage"
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | extend AlertID = ID
  | extend Data = parse_json(Data)
  | extend Data = Data.data
  // extract cloud storage fields (CS_ prefix)
  | extend
      CS_Bucket     = tostring(Data.bucket),
      CS_BucketId   = tostring(Data.bucketId),
      CS_Filename   = tostring(Data.filename),
      CS_FullPath   = tostring(Data.fullPath),
      CS_ObjectId   = tostring(Data.id),
      CS_Size       = toint(Data.size),
      CS_Url        = tostring(Data.url)
  // agentic workflow metadata (top level fields on the alert)
  | extend
      CS_ProcessedByAgenticAI = tostring(processed_by_agentic_ai),
      CS_AgenticAIStatus      = tostring(agentic_ai_process_status),
      CS_WorkflowID           = tostring(workflow_id)
  // final projection keep your standard top level columns first (consistent with other parsers)
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // parsed cloud storage specific fields
      CS_Bucket,
      CS_BucketId,
      CS_Filename,
      CS_FullPath,
      CS_ObjectId,
      CS_Size,
      CS_Url,
      CS_ProcessedByAgenticAI,
      CS_AgenticAIStatus,
      CS_WorkflowID
