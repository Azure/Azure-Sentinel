id: 72c0f4b9-6ef4-4f3c-8bb2-5e18c6a3bf10
Function:
    Title: Parser to extract Stealer Logs alerts from Cyble Vision Alerts
    Version: '1.0.0'
    LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_stealer_logs
FunctionAlias: Alerts_stealer_logs
FunctionQuery: |
    CybleVisionAlerts_CL
    | where Service == "stealer_logs"
    | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    | extend AlertID = ID
    | extend Data = parse_json(Data)
    // Extract: data.content
    | extend Content = Data.content
    | extend
        SL_App                = tostring(Content.Application),
        SL_URL_Content        = tostring(Content.URL),
        SL_Username_Content   = tostring(Content.Username),
        SL_Password           = tostring(Content.Password)
    // Extract: data.content_related_info
    | extend Rel = Data.content_related_info
    | extend
        SL_HWID               = tostring(Rel.HWID),
        SL_IP                 = tostring(Rel.IP),
        SL_Country            = tostring(Rel.country_name),
        SL_Domain             = tostring(Rel.domain),
        SL_TA                 = tostring(Rel.ta),
        SL_UserHashAD         = tostring(Rel.user_hash_ad),
        SL_CompromiseDate2    = tostring(Rel.compromise_date)
    // Extract: data.file_metadata
    | extend FM = Data.file_metadata
    | extend
        SL_FileName           = tostring(FM.filename),
        SL_FileSize           = toint(FM.size),
        SL_FileCreated        = tostring(FM.c_date),
        SL_FileModified       = tostring(FM.m_date)
    // Additional fields in data
    | extend
        SL_DocID              = tostring(Data.doc_id),
        SL_CreatedOn          = tostring(Data.created_on),
        SL_ParentFolder       = tostring(Data.parent_folder_path_id)
    // Root level fields
    | extend
        SL_MainURL            = tostring(url),
        SL_MainUsername       = tostring(Username),
        SL_CompromiseDate     = tostring(Compromised_Date),
        SL_MalwareFamily      = tostring(malware_family)
    // Tags
    | extend SL_Tags = tostring(Tags)
    | project
        TimeGenerated,
        AlertID,
        EntityID,
        KeywordName,
        CompanyID,
        Status,
        Severity,
        UserSeverity,
        BucketID,
        Domain,
        BucketName,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        IP,
        Service,
        Risk_Score,
        SL_App,
        SL_URL_Content,
        SL_Username_Content,
        SL_Password,
        SL_HWID,
        SL_IP,
        SL_Country,
        SL_Domain,
        SL_TA,
        SL_UserHashAD,
        SL_CompromiseDate2,
        SL_FileName,
        SL_FileSize,
        SL_FileCreated,
        SL_FileModified,
        SL_DocID,
        SL_CreatedOn,
        SL_ParentFolder,
        SL_MainURL,
        SL_MainUsername,
        SL_CompromiseDate,
        SL_MalwareFamily,
        SL_Tags
