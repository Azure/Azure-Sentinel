id: c0b6d8e4-2a9a-4df1-9ad4-9e57f5c8d1a3
Function:
  Title: Parser to extract OSINT alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_osint
FunctionAlias: Alerts_osint
FunctionQuery: |
  CybleVisionAlerts_CL
    | where Service == "osint"
    // Parse nested OSINT data
    | extend Data = parse_json(Data)
    // top level extracted fields
    | extend
        OS_AuthorName        = tostring(Data.['Author Name']),
        OS_AuthorUsername    = tostring(Data.['author_username']),
        OS_Source            = tostring(Source),
        OS_UploadedAt        = tostring(Uploaded_At)
    // Inner OSINT metadata  
    | extend
        OS_MentionDate       = tostring(Data.['Mention Date']),
        OS_MentionURL        = tostring(Data.['Mention URL']),
        OS_PostSnippet       = tostring(Data.['Post Snippet']),
        OS_Reach             = tostring(Data.['Reach']),
        OS_Starred           = tostring(Data.['Starred']),
        OS_Title             = tostring(Data.['Title'])
    // Normalize risk score (as used globally)
    | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    // Final projection (standard schema)
    | project
        TimeGenerated,
        AlertID = tostring(ID),
        EntityID,
        KeywordName,
        CompanyID,
        Status,
        Severity,
        UserSeverity,
        BucketID,
        Domain,
        BucketName,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        IP,
        Service,
        Risk_Score,
        // OSINT specific extracted fields
        OS_AuthorName,
        OS_AuthorUsername,
        OS_Source,
        OS_UploadedAt,
        OS_MentionDate,
        OS_MentionURL,
        OS_PostSnippet,
        OS_Reach,
        OS_Starred,
        OS_Title
