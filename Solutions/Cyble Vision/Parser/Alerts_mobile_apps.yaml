id: 3B52BAEB-0CDB-40A2-90B0-49EC949E9BAA
Function:
  Title: Parser to extract Mobile Apps alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_mobile_apps
FunctionAlias: Alerts_mobile_apps
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "mobile_apps"
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | extend AlertID = ID
  | extend Data = parse_json(Data)
  | extend Src = Data._source
  // Main app fields
  | extend
      MA_Title             = tostring(Src.['title']),
      MA_Description       = tostring(Src.description),
      MA_Developer         = tostring(Src.developer),
      MA_MarketSource      = tostring(Src.market_source),
      MA_MarketURL         = tostring(Src.market_url),
      MA_DeepLink          = tostring(Src.deep_link),
      MA_PackageName       = tostring(Src.package_name),
      MA_Downloads         = tostring(Src.downloads),
      MA_MarketStatus      = tostring(Src.market_status),
      MA_MarketUpdated     = tostring(Src.market_update),
      MA_Created           = tostring(Src.created),
      MA_Email             = tostring(Src.email),
      MA_Icon              = tostring(Src.icon),
      MA_Website           = tostring(Src.website),
      MA_ShortDesc         = tostring(Src.short_desc),
      MA_Version           = tostring(Src.version)
  // Handle screenshots ARRAY correctly
  | extend MA_Screenshots = Src.screenshots
  // Higher level first class fields
  | extend
      AppName              = tostring(Data.application_name),
      MarketSource2        = tostring(Data.market_source),
      UploadedAt           = tostring(Data.uploaded_at)
  // Tags as 
  | extend MA_Tags = tostring(Tags)
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      AppName,
      MarketSource2,
      UploadedAt,
      MA_Title,
      MA_Description,
      MA_Developer,
      MA_MarketSource,
      MA_MarketURL,
      MA_DeepLink,
      MA_PackageName,
      MA_Downloads,
      MA_MarketStatus,
      MA_MarketUpdated,
      MA_Created,
      MA_Email,
      MA_Icon,
      MA_Website,
      MA_ShortDesc,
      MA_Version,
      MA_Screenshots,
      MA_Tags
