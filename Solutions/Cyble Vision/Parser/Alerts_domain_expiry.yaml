id: E6846B75-3E50-4A97-BF31-86EDC4A860C7
Function:
    Title: Parser to extract Domain Expiry alerts from Cyble Vision Alerts
    Version: '1.0.0'
    LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_domain_expiry
FunctionAlias: Alerts_domain_expiry
FunctionQuery: |
    CybleVisionAlerts_CL
    | where Service == "domain_expiry"
    // Parse inner object
    | extend Data = parse_json(Data)
    // Extract fields
    | extend
        DE_Domain        = tostring(Data.domain),
        DE_DueDays       = tostring(Data.due_days),
        DE_ExpiryDate    = tostring(Data.expiry_date),
        DE_SeverityText  = tostring(Data.severity),
        DE_TypeText      = tostring(Data.type_text)
    // Normalize risk score to standard format
    | extend Risk_Score =
        pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    // Final unified projection (same structure as other parsers)
    | project
        TimeGenerated,
        AlertID = tostring(ID),
        EntityID,
        KeywordName,
        CompanyID,
        Status,
        Severity,
        UserSeverity,
        BucketID,
        Domain,
        BucketName,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        IP,
        Service,
        Risk_Score,
    // DOMAIN EXPIRY extracted fields
        DE_Domain,
        DE_DueDays,
        DE_ExpiryDate,
        DE_SeverityText,
        DE_TypeText,
        Data
