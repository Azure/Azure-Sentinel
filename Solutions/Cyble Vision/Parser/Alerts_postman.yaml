id: d3e98c57-0c41-4c0f-9f7d-1b38fd74ac92
Function:
  Title: Parser to extract Postman alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_postman
FunctionAlias: Alerts_postman
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "postman"
  // Parse inner object
  | extend Data = parse_json(Data)
  // Extract Postman fields
  | extend
      PM_Category          = tostring(Data.category),
      PM_Collection        = tostring(Data.collection),
      PM_DevelopedBy       = tostring(Data.developed_by),
      PM_DevelopedByUrl    = tostring(Data.developed_by_url),
      PM_Description       = tostring(Data.description),
      PM_PostmanKey        = tostring(Data.postman_unique_key),
      PM_Views             = toint(Data.['views']),
      PM_Watchers          = toint(Data.watchers),
      PM_ImageIconUrl      = tostring(Data.image_icon_url),
      PM_LastUpdatedOn     = tostring(Data.last_updated_on),
      PM_LastUpdatedOnDate = tostring(Data.last_updated_on_date),
      PM_MetaData          = tostring(Data.meta_data),
      PM_ScrappingTime     = tostring(Data.scrapping_time),
      PM_SourceName        = tostring(Data.source_name),
      PM_Title             = tostring(Data.['title']),
      PM_UpdatedAt         = tostring(Data.updated_at),
      PM_Url               = tostring(Data.url),
      PM_IsPublic          = tostring(Data.is_public),
      PM_APIs              = tostring(Data.apis),
      PM_Forks             = tostring(Data.forks),
      PM_Workspace         = tostring(Data.workspace),
      PM_Keyword           = tostring(Data.keyword)
  // Pack risk score (same format used in all your parsers)
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection SAME order & style across all your parsers
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // Postman extracted fields
      PM_Category,
      PM_Collection,
      PM_DevelopedBy,
      PM_DevelopedByUrl,
      PM_Description,
      PM_PostmanKey,
      PM_Views,
      PM_Watchers,
      PM_ImageIconUrl,
      PM_LastUpdatedOn,
      PM_LastUpdatedOnDate,
      PM_MetaData,
      PM_ScrappingTime,
      PM_SourceName,
      PM_Title,
      PM_UpdatedAt,
      PM_Url,
      PM_IsPublic,
      PM_APIs,
      PM_Forks,
      PM_Workspace,
      PM_Keyword,
      // raw parsed object
      Data
