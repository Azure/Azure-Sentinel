id: CCEEF0B7-C69B-4665-B357-4036B2B02CFF
Function:
  Title: Parser to extract Leaked Credentials alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_leaked_credentials
FunctionAlias: Alerts_leaked_credentials
FunctionQuery: |
  CybleVisionAlerts_CL
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | where Service == "leaked_credentials"
  | extend AlertID = ID
  | extend Data = parse_json(Data)
  | extend
      LC_Data       = tostring(Data.data),
      LC_Date       = tostring(Data['date']),
      LC_Domain     = tostring(Data.domain),
      LC_Password   = tostring(Data.password),
      LC_URL        = tostring(Data.url),
      LC_Username   = tostring(Data.username),
      LC_Tags       = Data.tags
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      Risk_Score,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      LC_Data,
      LC_Date,
      LC_Domain,
      LC_Password,
      LC_URL,
      LC_Username,
      LC_Tags
