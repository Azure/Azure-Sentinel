id: C9D6D764-F283-4529-BBCE-97F9EE042845
Function:
  Title: Parser to extract Suspicious Domains alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_suspicious_domains
FunctionAlias: Alerts_suspicious_domains
FunctionQuery: |
  CybleVisionAlerts_CL
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | where Service == "suspicious_domains"
  | extend Data = todynamic(Data)
  | extend AlertID = ID
  | extend 
      SD_RegistrationDate = tostring(Data.REGISTRATIONDATE),
      SD_Source = tostring(Data.SOURCE),
      SD_CreatedAt = tostring(Data.created_at),
      SD_Domain = tostring(Data.domain),
      SD_DomainName = tostring(Data.domain_name),
      SD_Fuzzer = tostring(Data.fuzzer),
      SD_ID = tostring(Data.id),
      SD_IsLive = tostring(Data.is_live),
      SD_Keyword = tostring(Data.keyword),
      SD_LastLiveCheck = tostring(Data.last_live_check),
      SD_RawRegDate = tostring(Data.raw_registration_date),
      SD_Score = tostring(Data.score),
      SD_ScreenshotURL = tostring(Data.screenshot_url),
      SD_Service = tostring(Data.service),
      SD_StatusCode = tostring(Data.status_code),
      SD_UpdatedAt = tostring(Data.updated_at),
      SD_WhoisEnriched = tostring(Data.whois_enriched),
      SD_WhoisTries = tostring(Data.whois_enriched_tries)
  | extend DNS = Data.dns_records
  | extend
      A_Records = DNS.a_record,
      MX_Records = DNS.mx_record,
      NS_Records = DNS.ns_record
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      Service,
      SD_RegistrationDate,
      SD_Source,
      SD_CreatedAt,
      SD_Domain,
      SD_DomainName,
      SD_Fuzzer,
      SD_ID,
      SD_IsLive,
      SD_Keyword,
      SD_LastLiveCheck,
      SD_RawRegDate,
      SD_Score,
      SD_ScreenshotURL,
      SD_Service,
      SD_StatusCode,
      SD_UpdatedAt,
      SD_WhoisEnriched,
      SD_WhoisTries,
      A_Records,
      MX_Records,
      NS_Records
