id: 52B85596-1010-4D93-9401-B0C27FE708BB
Function:
  Title: Parser to extract Physical Threats alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_physical_threats
FunctionAlias: Alerts_physical_threats
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "physical_threats"
  | extend Data = parse_json(Data)
  | extend Data = (Data.data)
  // Extract nested physical threat fields
  | extend
      PT_Address          = tostring(Data.address),
      PT_BaseSourceName   = tostring(Data.base_source.name),
      PT_BaseSourceURL    = tostring(Data.base_source.url),
      PT_City_Nested      = tostring(Data.city),
      PT_Country          = tostring(Data.country),
      PT_Description      = tostring(Data.description),
      PT_ID               = tostring(Data.id),
      PT_LocationName     = tostring(Data.location_name),
      PT_LocationType     = tostring(Data.location_type),
      PT_Latitude         = todouble(Data.latitude),
      PT_Longitude        = todouble(Data.longitude),
      PT_PinID            = tostring(Data.pin_id),
      PT_PinName_Nested   = tostring(Data.pin_name),
      PT_PinString        = tostring(Data.pin_string),
      PT_PublishedAt      = tostring(Data.published_at),
      PT_Region           = tostring(Data.region),
      PT_SeverityNested   = tostring(Data.severity),
      PT_SourceCount      = tostring(Data.source_count),
      PT_Sources          = tostring(Data.sources),
      PT_State            = tostring(Data.state),
      PT_ThreatType       = tostring(Data.threat_type),
      PT_Title_Nested     = tostring(Data.['title'])
  // Pack risk score
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      PT_Address,
      PT_BaseSourceName,
      PT_BaseSourceURL,
      PT_City_Nested,
      PT_Country,
      PT_Description,
      PT_ID,
      PT_LocationName,
      PT_LocationType,
      PT_Latitude,
      PT_Longitude,
      PT_PinID,
      PT_PinName_Nested,
      PT_PinString,
      PT_PublishedAt,
      PT_Region,
      PT_SeverityNested,
      PT_SourceCount,
      PT_Sources,
      PT_State,
      PT_ThreatType,
      PT_Title_Nested,
      Data
