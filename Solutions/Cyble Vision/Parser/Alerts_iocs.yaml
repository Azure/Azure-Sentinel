id: cf0b71c2-1ad2-4b0e-9f7b-6d28b593e3da
Function:
  Title: Parser to extract IOC alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_iocs
FunctionAlias: Alerts_iocs
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "iocs"
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | extend AlertID = ID
  | extend Data = parse_json(Data)
  // unroll IOC object
  | extend IOC = Data
  | extend
      IOC_Value           = tostring(IOC),
      IOC_FirstSeen       = tostring(First_Seen_On),
      IOC_LastSeen        = tostring(Last_Seen_On),
      IOC_BehaviourTags   = tostring(IOC.behaviour_tags),
      IOC_ConfidentRating = tostring(IOC.confident_rating),
      IOC_Desc            = tostring(IOC.description),
      IOC_FirstSeen2      = tostring(IOC.first_seen),
      IOC_LastSeen2       = tostring(IOC.last_seen),
      IOC_Type            = tostring(IOC.ioc_type),
      IOC_AttackName      = tostring(IOC.ioc_attack_name),
      IOC_ReferenceLink   = tostring(IOC.reference_link),
      IOC_RiskRating      = toint(IOC.risk_rating),
      IOC_SourceNameID    = tostring(IOC.source_name_id),
      IOC_UUID            = tostring(IOC.uuid),
      IOC_UpdatedAt       = tostring(IOC.updated_at)
  | extend IOC_Tags = tostring(Tags)
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      IOC_Value,
      IOC_FirstSeen,
      IOC_LastSeen,
      IOC_BehaviourTags,
      IOC_ConfidentRating,
      IOC_Desc,
      IOC_FirstSeen2,
      IOC_LastSeen2,
      IOC_Type,
      IOC_AttackName,
      IOC_ReferenceLink,
      IOC_RiskRating,
      IOC_SourceNameID,
      IOC_UUID,
      IOC_UpdatedAt,
      IOC_Tags
