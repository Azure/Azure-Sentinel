id: 6CE5518F-7F50-4774-B4D0-93882933BE3A
Function:
  Title: Parser to extract Discord alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_discord
FunctionAlias: Alerts_discord
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "discord"
  // Parse inner discord message object
  | extend RawData = parse_json(Data)
  | extend Doc = RawData.doc
  // Extract author object
  | extend Author = Doc.author
  // Extract discord fields
  | extend
      DC_MessageID        = tostring(Doc.id),
      DC_Content          = tostring(Doc.content),
      DC_ChannelName      = tostring(Doc.channel_name),
      DC_ServerName       = tostring(Doc.server_name),
      DC_Timestamp        = tostring(Doc.timestamp),
      DC_Attachments      = tostring(Doc.attachments),
      DC_Embeds           = tostring(Doc.embeds),
      // Author fields
      DC_AuthorID         = tostring(Author.id),
      DC_AuthorUsername   = tostring(Author.username),
      DC_AuthorGlobalName = tostring(Author.global_name),
      DC_AuthorAvatar     = tostring(Author.avatar),
      DC_AuthorFlags      = tostring(Author.['flags'])
  // Normalize risk score
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final standardized projection
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // Discord fields
      DC_MessageID,
      DC_Content,
      DC_ChannelName,
      DC_ServerName,
      DC_Timestamp,
      DC_Attachments,
      DC_Embeds,
      // Author info
      DC_AuthorID,
      DC_AuthorUsername,
      DC_AuthorGlobalName,
      DC_AuthorAvatar,
      DC_AuthorFlags,
      RawData
