id: B3AF08D4-363D-44B0-854F-9F3229610877
Function:
  Title: Parser to extract Cyber Crime Forums alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_cyber_crime_forums
FunctionAlias: Alerts_cyber_crime_forums
FunctionQuery: |
  CybleVisionAlerts_CL
    | where Service == "cyber_crime_forums"
    | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    | extend AlertID = ID
    | extend Data = parse_json(Data)
    // Extract discussion metadata (root level)
    | extend
        CF_DiscussionDate      = tostring(Discussion_Date),
        CF_DiscussionBy        = tostring(Discussion_By),
        CF_SourceName          = tostring(Source_Name),
        CF_TopicName           = tostring(Topic_Name)
    // Extract nested data fields
    | extend D = Data
    | extend
        CF_CategoryID          = tostring(D.category_id),
        CF_DiscussionBy2       = tostring(D.discussion_by),
        CF_Content             = tostring(D.discussion_content),
        CF_DiscussionDate2     = tostring(D.discussion_date),
        CF_DiscussionID        = tostring(D.discussion_id),
        CF_JoinedDate          = tostring(D.joined_dated),
        CF_Likes               = tostring(D.likes),
        CF_NumberOfPosts       = tostring(D.number_of_post),
        CF_Reputation          = tostring(D.reputation),
        CF_TopicCreatedBy      = tostring(D.topic_created_by),
        CF_TopicID             = tostring(D.topic_id),
        CF_TopicName2          = tostring(D.topic_name),
        CF_TopicURL            = tostring(D.topic_url),
        CF_UpdatedOn           = tostring(D.updated_on)
    // Extract URLs inside content
    | extend CF_Urls = extract_all(@"(https?://[^\s]+)", CF_Content)
    // Extract phone numbers
    | extend CF_Phones = extract_all(@"(\+?\d[\d\-\s]{6,}\d)", CF_Content)
    // Extract emails
    | extend CF_Emails = extract_all(@"([A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,})", CF_Content)
    // Tags
    | extend CF_Tags = tostring(Tags)
    | project
        TimeGenerated,
        AlertID,
        EntityID,
        KeywordName,
        CompanyID,
        Status,
        Severity,
        UserSeverity,
        BucketID,
        Domain,
        BucketName,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        IP,
        Service,
        Risk_Score,
        CF_DiscussionDate,
        CF_DiscussionBy,
        CF_SourceName,
        CF_TopicName,
        CF_CategoryID,
        CF_DiscussionBy2,
        CF_Content,
        CF_DiscussionDate2,
        CF_DiscussionID,
        CF_JoinedDate,
        CF_Likes,
        CF_NumberOfPosts,
        CF_Reputation,
        CF_TopicCreatedBy,
        CF_TopicID,
        CF_TopicName2,
        CF_TopicURL,
        CF_UpdatedOn,
        CF_Urls,
        CF_Phones,
        CF_Emails,
        CF_Tags
