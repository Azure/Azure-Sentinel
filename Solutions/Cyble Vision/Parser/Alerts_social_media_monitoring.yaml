id: 3579AF97-D2E3-4E4E-9B9F-99A76F255C29
Function:
    Title: Parser to extract Social Media Monitoring Data Message alerts from Cyble Vision Alerts
    Version: '1.0.0'
    LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_social_media_monitoring
FunctionAlias: Alerts_social_media_monitoring
FunctionQuery: |
    CybleVisionAlerts_CL
    | extend MappedSeverity = Severity
    | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    | where Service == "social_media_monitoring"
    | extend AlertID = ID
    | extend ParsedData = parse_json(Data)
    | extend
        SM_Category           = tostring(ParsedData.category),
        SM_Confidence         = tostring(ParsedData.confidence),
        SM_ConfidenceScore    = toint(ParsedData.confidence_score),
        SM_FindingId          = tostring(ParsedData.finding_id),
        SM_DataId             = tostring(ParsedData.id),
        SM_Language           = tostring(ParsedData.language),
        SM_Location           = tostring(ParsedData.location),
        SM_SentimentData      = tostring(ParsedData.sentiment),
        SM_SourceData         = tostring(ParsedData.source),
        SM_TypeData           = tostring(ParsedData.type),
        SM_Weightage          = toint(ParsedData.weightage),
        SM_Tags               = tostring(ParsedData.tags)
    | extend
        SM_Content            = tostring(ParsedData.metadata.extras.content),
        SM_ContentHash        = tostring(ParsedData.metadata.extras.content_hash),
        SM_MainUrl            = tostring(ParsedData.metadata.extras.url)
    | extend
        SM_CreatorName        = tostring(ParsedData.metadata.extras.creator.name),
        SM_CreatorId          = tostring(ParsedData.metadata.extras.creator.id),
        SM_CreatorFollowers   = toint(ParsedData.metadata.extras.creator.followers),
        SM_CreatorFollowing   = toint(ParsedData.metadata.extras.creator.following),
        SM_CreatorIsVerified  = tostring(ParsedData.metadata.extras.creator.is_verified),
        SM_CreatorDescription = tostring(ParsedData.metadata.extras.creator.description),
        SM_CreatorUrl         = tostring(ParsedData.metadata.extras.creator.url),
        SM_CreatorUsername    = tostring(ParsedData.metadata.extras.creator.username)
    | extend
        SM_Domains            = tostring(ParsedData.metadata.extras.extracts.domains),
        SM_Subdomains         = tostring(ParsedData.metadata.extras.extracts.subdomains),
        SM_Urls               = tostring(ParsedData.metadata.extras.extracts.urls)
    | mv-expand Rules = ParsedData.rules
    | extend
        SM_RuleName           = tostring(Rules.name),
        SM_RuleNiceName       = tostring(Rules.nice_name),
        SM_RuleWeight         = toint(Rules.weightage)
    | project
        TimeGenerated,
        AlertID,
        EntityID,
        KeywordName,
        CompanyID,
        Status,
        Severity,
        UserSeverity,
        BucketID,
        Domain,
        BucketName,
        DataID,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        IP,
        Service,
        Risk_Score,
        SM_Category,
        SM_Confidence,
        SM_ConfidenceScore,
        SM_FindingId,
        SM_DataId,
        SM_Language,
        SM_Location,
        SM_SentimentData,
        SM_SourceData,
        SM_TypeData,
        SM_Weightage,
        SM_Tags,
        SM_Content,
        SM_ContentHash,
        SM_MainUrl,
        SM_CreatorName,
        SM_CreatorId,
        SM_CreatorFollowers,
        SM_CreatorFollowing,
        SM_CreatorIsVerified,
        SM_CreatorDescription,
        SM_CreatorUrl,
        SM_CreatorUsername,
        SM_Domains,
        SM_Subdomains,
        SM_Urls,
        SM_RuleName,
        SM_RuleNiceName,
        SM_RuleWeight
