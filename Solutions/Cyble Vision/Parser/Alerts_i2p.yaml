id: 66B3B83B-D3EF-448C-93CC-63AC3CDA48F0
Function:
  Title: Parser to extract I2P alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_i2p
FunctionAlias: Alerts_i2p
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "i2p"
  // Parse inner content
  | extend Data = parse_json(Data)
  // Extract main fields
  | extend 
      I2P_Content          = tostring(Data.data),
      I2P_URL              = tostring(Data.i2p_url),
      I2P_SearchEngine     = tostring(Data.search_engine),
      I2P_SearchKeyword    = tostring(Data.search_keyword),
      I2P_UpdatedOn        = tostring(Data.updated_on)
  // Normalize risk score (your standard)
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection (consistent with all parsers)
  | project 
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // I2P fields
      I2P_Content,
      I2P_URL,
      I2P_SearchEngine,
      I2P_SearchKeyword,
      I2P_UpdatedOn
