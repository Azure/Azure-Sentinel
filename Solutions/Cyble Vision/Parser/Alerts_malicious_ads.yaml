id: a13d52d9-4cf8-46a2-9e3c-5b241b8a9277
Function:
  Title: Parser to extract Malicious Ads alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_malicious_ads
FunctionAlias: Alerts_malicious_ads
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "malicious_ads"
  | extend Data = parse_json(Data)
  // Extract nested malicious ads fields
  | extend
      MA_RegistrationDate      = tostring(Data.REGISTRATIONDATE),
      MA_Source                = tostring(Data.SOURCE),
      MA_CreatedAt_Nested      = tostring(Data.created_at),
      MA_DetectedTechnologies  = tostring(Data.detected_technologies),
      MA_A_Record              = tostring(Data.dns_records.a_record),
      MA_MX_Record             = tostring(Data.dns_records.mx_record),
      MA_NS_Record             = tostring(Data.dns_records.ns_record),
      MA_Domain_URL            = tostring(Data.domain),
      MA_DomainName_Nested     = tostring(Data.domain_name),
      MA_Fuzzer                = tostring(Data.fuzzer),
      MA_RecordID              = tostring(Data.id),
      MA_IsLive                = tostring(Data.is_live),
      MA_Keyword_Nested        = tostring(Data.keyword),
      MA_LastLiveCheck         = tostring(Data.last_live_check),
      MA_RawRegistrationDate   = tostring(Data.raw_registration_date),
      MA_ScreenshotURL         = tostring(Data.screenshot_url),
      MA_Service_Nested        = tostring(Data.service),
      MA_StatusCode            = tostring(Data.status_code),
      MA_UpdatedAt_Nested      = tostring(Data.updated_at),
      MA_WhoisEnriched         = tostring(Data.whois_enriched),
      MA_WhoisEnrichedTries    = tostring(Data.whois_enriched_tries)
  // Standard risk pack
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      MA_RegistrationDate,
      MA_Source,
      MA_CreatedAt_Nested,
      MA_DetectedTechnologies,
      MA_A_Record,
      MA_MX_Record,
      MA_NS_Record,
      MA_Domain_URL,
      MA_DomainName_Nested,
      MA_Fuzzer,
      MA_RecordID,
      MA_IsLive,
      MA_Keyword_Nested,
      MA_LastLiveCheck,
      MA_RawRegistrationDate,
      MA_ScreenshotURL,
      MA_Service_Nested,
      MA_StatusCode,
      MA_UpdatedAt_Nested,
      MA_WhoisEnriched,
      MA_WhoisEnrichedTries,
      Data
