id: c702d399-a18f-40ec-8021-620fe670e45e
Function:
  Title: Parser to extract Advisory alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_advisory
FunctionAlias: Alerts_advisory
FunctionQuery: |
  CybleVisionAlerts_CL
   | where Service == "advisory"
   | extend MappedSeverity = Severity
   // Normalize inner payload (handles numeric or object)
   | extend Data = parse_json(Data)
   | extend Data = (Data.data)
   // Extract advisory value (stringsafe)
   | extend
       ADV_Value = tostring(Data)
   // Pack risk score (same as other parsers)
   | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
   // Final projection (standardized across parsers)
   | project
       TimeGenerated,
       AlertID = tostring(ID),
       EntityID,
       KeywordName,
       CompanyID,
       Status,
       Severity,
       UserSeverity,
       BucketID,
       Domain,
       BucketName,
       TruePositive,
       LLMProcessed,
       LLMExplanation,
       IP,
       Service,
       Risk_Score,
       // Advisory fields
       ADV_Value,
       // Raw parsed object
       Data
