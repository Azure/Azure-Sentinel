id: 5f7b03d2-6c2d-4f12-9a5b-0cfaea9c44e0
Function:
  Title: Parser to extract Ransomware Updates alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_ransomware_updates
FunctionAlias: Alerts_ransomware_updates
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "ransomware_updates"
  | extend Data = parse_json(Data)
  // Extract nested ransomware update fields
  | extend
      RW_Country        = tostring(Data.country),
      RW_CreatedAt      = tostring(Data.created_at),
      RW_Date           = tostring(Data.['date']),
      RW_Description    = tostring(Data.description),
      RW_Gang           = tostring(Data.gang),
      RW_Hash           = tostring(Data.hash),
      RW_RecordID       = tostring(Data.id),
      RW_Industry       = tostring(Data.industry),
      RW_Region         = tostring(Data.region),
      RW_UpdatedAt      = tostring(Data.updated_at),
      RW_Victim         = tostring(Data.victim),
      RW_Website        = tostring(Data.website)
  // Normalized risk score
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection (standard columns + parsed RW fields)
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // Parsed ransomware fields
      RW_Country,
      RW_CreatedAt,
      RW_Date,
      RW_Description,
      RW_Gang,
      RW_Hash,
      RW_RecordID,
      RW_Industry,
      RW_Region,
      RW_UpdatedAt,
      RW_Victim,
      RW_Website,
      Data
