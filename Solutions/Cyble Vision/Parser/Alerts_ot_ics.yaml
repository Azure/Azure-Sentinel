id: C130D2C6-CE85-4DE7-86D8-3EDA4B7B8F82
Function:
  Title: Parser to extract OT ICS alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_ot_ics
FunctionAlias: Alerts_ot_ics
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "ot_ics"
  | extend Data = parse_json(Data)
  | extend
      OT_ASN            = tostring(Data.asn),
      OT_Country        = tostring(Data.country),
      OT_SourceIP       = tostring(Data.source_ip),
      OT_ContentAddedOn = tostring(Data.content_added_on),
      OT_Industry       = tostring(Data.industry),
      // Nested attributes
      OT_DataType       = tostring(Data.data_type),
      OT_DestPort       = tostring(Data.dest_port),
      OT_CountryCode    = tostring(Data.country_code),
      OT_CountryName    = tostring(Data.country_name),
      OT_IP_Reputation  = tostring(Data.ip_rep),
      OT_Src_IP         = tostring(Data.src_ip),
      OT_Timestamp      = tostring(Data.timestamp)
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // OT/ICS attributes
      OT_ASN,
      OT_Country,
      OT_SourceIP,
      OT_ContentAddedOn,
      OT_Industry,
      OT_DataType,
      OT_DestPort,
      OT_CountryCode,
      OT_CountryName,
      OT_IP_Reputation,
      OT_Src_IP,
      OT_Timestamp
