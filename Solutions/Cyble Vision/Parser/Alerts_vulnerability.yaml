id: 669C275D-F729-4582-9F48-64A73F73FE12
Function:
  Title: Parser to extract Vulnerability alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_vulnerability
FunctionAlias: Alerts_vulnerability
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "vulnerability"
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | extend AlertID = ID
  | extend Data = parse_json(Data)
  // inner "data.data" object
  | extend Vuln = Data.data
  | extend
      V_Confidence        = tostring(Vuln.confidence),
      V_FirstSeen         = tostring(Vuln.first_seen_on),
      V_LastSeen          = tostring(Vuln.last_seen_on),
      V_Host              = tostring(Vuln.host),
      V_IP                = tostring(Vuln.ip),
      V_Port              = toint(Vuln.port),
      V_Severity          = tostring(Vuln.severity),
      V_Title             = tostring(Vuln.['title']),
      V_VulnID            = tostring(Vuln.vulnerability_id),
      V_Type              = tostring(Vuln.vulnerability_type)
  // Return all columns + parsed fields
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      Asset,
      V_Confidence,
      V_FirstSeen,
      V_LastSeen,
      V_Host,
      V_IP,
      V_Port,
      V_Severity,
      V_Title,
      V_VulnID,
      V_Type
