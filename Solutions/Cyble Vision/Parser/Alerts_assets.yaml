id: 211F42B8-835A-4FDE-ACB9-9EB1092AE22E
Function:
  Title: Parser to extract Bit Bucket alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_assets
FunctionAlias: Alerts_assets
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "assets"
  | extend MappedSeverity = Severity
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  | extend AlertID = ID
  // Parse the inner Data (Data.data)
  | extend Data = parse_json(Data)
  | extend Data = (Data.data)
  // Extract inner fields safely
  | extend
      AA_KeywordID          = tostring(Data.keyword_id),
      AA_LastDetected       = tostring(Data.last_detected_at),
      AA_Value              = tostring(Data.value)
  // Project cleaned output + original fields if needed
  | project
      TimeGenerated,
      AlertID,
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      AA_KeywordID,
      AA_LastDetected,
      AA_Value
