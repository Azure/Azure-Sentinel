id: E9325EA2-F1AE-499B-B9F9-D365A11E9E84
Function:
  Title: Parser to extract Product Vulnerability alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_product_vulnerability
FunctionAlias: Alerts_product_vulnerability
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "product_vulnerability"
  | extend Data = parse_json(Data)
  // Extract nested fields from Data (only nested no top level duplication)
  | extend
      PV_Company            = tostring(Data.company),
      PV_CVE_ID             = tostring(Data.cve_id),
      PV_DocID              = tostring(Data.doc_id),
      PV_Product            = tostring(Data.product),
      PV_Title              = tostring(Data.['title']),
      PV_Version            = tostring(Data.version),
      PV_UpdatedFields      = tostring(Data.updated_fields),
      PV_Tags               = tostring(Data.tags),
      // New CVE details
      PV_New_Counter_Name        = tostring(Data.new_cve_details.countermeasure.name),
      PV_New_Counter_Remediation = tostring(Data.new_cve_details.countermeasure.remediationlevel),
      PV_New_Exploitability      = tostring(Data.new_cve_details.exploit.exploitability),
      PV_New_EPS_Score           = tostring(Data.new_cve_details.exploit.epss.score),
      PV_New_EPS_Percentile      = tostring(Data.new_cve_details.exploit.epss.percentile),
      PV_New_Price_0day          = tostring(Data.new_cve_details.exploit.price.['0day']),
      PV_New_Price_Today         = tostring(Data.new_cve_details.exploit.price.today),
      // Old CVE details
      PV_Old_EPS_Score           = tostring(Data.old_cve_details.exploit.epss.score),
      PV_Old_EPS_Percentile      = tostring(Data.old_cve_details.exploit.epss.percentile),
      PV_Old_Price_0day          = tostring(Data.old_cve_details.exploit.price.['0day']),
      PV_Old_Price_Today         = tostring(Data.old_cve_details.exploit.price.today),
      // Software details (nested)
      PV_SW_Company              = tostring(Data.software_details.company),
      PV_SW_CompanyID            = tostring(Data.software_details.company_id),
      PV_SW_Software             = tostring(Data.software_details.software),
      PV_SW_Version              = tostring(Data.software_details.version),
      PV_SW_CreatedAt            = tostring(Data.software_details.created_at),
      PV_SW_UpdatedAt            = tostring(Data.software_details.updated_at),
      PV_SW_LastAlertDate        = tostring(Data.software_details.last_alert_date),
      PV_SW_UserID               = tostring(Data.software_details.user_id)
  // Standard risk packing
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection (standard columns + PV fields)
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // Parsed PV fields
      PV_Company,
      PV_CVE_ID,
      PV_DocID,
      PV_Product,
      PV_Title,
      PV_Version,
      PV_UpdatedFields,
      PV_Tags,
      PV_New_Counter_Name,
      PV_New_Counter_Remediation,
      PV_New_Exploitability,
      PV_New_EPS_Score,
      PV_New_EPS_Percentile,
      PV_New_Price_0day,
      PV_New_Price_Today,
      PV_Old_EPS_Score,
      PV_Old_EPS_Percentile,
      PV_Old_Price_0day,
      PV_Old_Price_Today,
      PV_SW_Company,
      PV_SW_CompanyID,
      PV_SW_Software,
      PV_SW_Version,
      PV_SW_CreatedAt,
      PV_SW_UpdatedAt,
      PV_SW_LastAlertDate,
      PV_SW_UserID,
      Data
