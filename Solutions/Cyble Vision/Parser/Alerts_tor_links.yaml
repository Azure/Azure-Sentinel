id: 3c6f4c11-9fb2-4e6a-b3e9-0ae3df64b72e
Function:
    Title: Parser to extract GitHub TOR Links alerts from Cyble Vision Alerts
    Version: '1.0.0'
    LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_tor_links
FunctionAlias: Alerts_tor_links
FunctionQuery: |
    CybleVisionAlerts_CL
    | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    | where Service == "tor_links"
    | extend AlertID = ID
    | extend Data = parse_json(Data)
    | extend // Parse top level fields inside Data{}
        TL_Id                = tostring(Data._id),
        TL_Doc               = Data.doc
    | extend // Parse nested doc{} object
        TL_Doc_Data          = tostring(TL_Doc.data),
        TL_Doc_Id            = tostring(TL_Doc.id),
        TL_SearchEngine      = tostring(TL_Doc.search_engine),
        TL_SearchKeyword     = tostring(TL_Doc.search_keyword),
        TL_TorUrl            = tostring(TL_Doc.tor_url),
        TL_UpdatedOn         = tostring(TL_Doc.updated_on)
    | extend // Parse Tags
        TL_Tags              = tostring(Data.tags)
    | project
        TimeGenerated,
        Created_At,
        Updated_At,
        Deleted_At,
        AlertID,
        DataID,
        EntityID,
        KeywordName,
        EntityType,
        Service,
        CompanyID,
        Description,
        Status,
        AssigneeID,
        AssignmentDate,
        ArchiveDate,
        Severity,
        UpdatedBy,
        CreatedBy,
        UserSeverity,
        BucketID,
        Filename,
        RepositoryName,
        OwnerName,
        BucketName,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        Tags,
        Asset,
        Last_Detected_At,
        Extension,
        Compromised_Date,
        Article_Name,
        Breach_Source,
        Breach_Date,
        Channel_Name,
        Server_Name,
        Content_Updated_On,
        Discussion_Date,
        Discussion_By,
        Source_Name,
        Topic_Name,
        Source,
        Alert_Type,
        Content_Added_On,
        IOC,
        First_Seen_On,
        Last_Seen_On,
        Old_Risk_Score,
        New_Risk_Score,
        IP,
        Host,
        Port,
        Application_Name,
        Market_Source,
        Uploaded_At,
        CVE,
        Subdomain,
        Domain,
        Chat_Title,
        Username,
        Search_Engine,
        Category,
        Sentiment,
        Data,
        TenantId,
        Type,
        _ResourceId,
        TL_Id,              // Parsed TOR links fields
        TL_Doc_Data,
        TL_Doc_Id,
        TL_SearchEngine,
        TL_SearchKeyword,
        TL_TorUrl,
        TL_UpdatedOn,
        TL_Tags
