id: 317263D6-8A3C-4890-9955-0ED850111BD4
Function:
  Title: Parser to extract Defacement Keyword alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_defacement_keyword
FunctionAlias: Alerts_defacement_keyword
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "defacement_keyword"
  // Parse inner object
  | extend Data = parse_json(Data)
  | extend Data = (Data.data)
  // Extract keyword defacement fields
  | extend
      DK_CompanyID        = tostring(Data.company_id),
      DK_CreatedOn        = tostring(Data.created_on),
      DK_DomainName       = tostring(Data.domain_name),
      DK_Frequency        = tostring(Data.frequency),
      DK_RecordID         = tostring(Data.id),
      DK_Keyword          = tostring(Data.keyword),
      DK_Keywords         = tostring(Data.keywords),
      DK_URL              = tostring(Data.url),
      DK_WebsiteAddedOn   = tostring(Data.website_added_on),
      DK_WebsiteID        = tostring(Data.website_id)
  // Normalize risk score to standard format
  | extend Risk_Score =
      pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final unified projection
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      // DEFACEMENT KEYWORD fields
      DK_CompanyID,
      DK_CreatedOn,
      DK_DomainName,
      DK_Frequency,
      DK_RecordID,
      DK_Keyword,
      DK_Keywords,
      DK_URL,
      DK_WebsiteAddedOn,
      DK_WebsiteID,
      // Raw inner data
      Data
