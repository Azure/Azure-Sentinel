id: 9436EAE0-B638-46C3-A399-11A55488C4FE
Function:
  Title: Parser to extract News Feed alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_news_feed
FunctionAlias: Alerts_news_feed
FunctionQuery: |
  CybleVisionAlerts_CL
    | where Service == "news_feed"
    // Parse inner data object
    | extend Data = parse_json(Data)
    // Extract fields
    | extend
        NF_AI_Summary       = tostring(Data.ai_summary),
        NF_PostDate         = tostring(Data.post_date),
        NF_PostDescription  = tostring(Data.post_description),
        NF_PostImage        = tostring(Data.post_img),
        NF_PostTitle        = tostring(Data.post_title),
        NF_PostURL          = tostring(Data.post_url),
        NF_NewsFeedType     = tostring(Data.news_feed_type),
        NF_PostSourceName   = tostring(Data.post_source.name),
        NF_PostSourceURL    = tostring(Data.post_source.url),
        NF_PostSourceIcon   = tostring(Data.post_source.icon),
        NF_Industries       = tostring(Data.industries),
        NF_Malwares         = tostring(Data.malwares),
        NF_ThreatActors     = tostring(Data.threat_actors),
        NF_TTPs             = tostring(Data.ttps),
        NF_IOCs             = tostring(Data.iocs),
        NF_SourceCountries  = tostring(Data.source_countries),
        NF_Regions          = tostring(Data.regions),
        NF_TargetCountries  = tostring(Data.target_countries),
        NF_CVEs             = tostring(Data.cves)
    // Normalize Risk Score (same style for all parsers)
    | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
    // Final projection (your standard unified layout)
    | project
        TimeGenerated,
        AlertID = tostring(ID),
        EntityID,
        KeywordName,
        CompanyID,
        Status,
        Severity,
        UserSeverity,
        BucketID,
        Domain,
        BucketName,
        TruePositive,
        LLMProcessed,
        LLMExplanation,
        IP,
        Service,
        Risk_Score,
        // NEWS FEED extracted data
        NF_AI_Summary,
        NF_PostDate,
        NF_PostDescription,
        NF_PostImage,
        NF_PostTitle,
        NF_PostURL,
        NF_NewsFeedType,
        NF_PostSourceName,
        NF_PostSourceURL,
        NF_PostSourceIcon,
        NF_Industries,
        NF_Malwares,
        NF_ThreatActors,
        NF_TTPs,
        NF_IOCs,
        NF_SourceCountries,
        NF_Regions,
        NF_TargetCountries,
        NF_CVEs,
        // raw parsed object
        Data
