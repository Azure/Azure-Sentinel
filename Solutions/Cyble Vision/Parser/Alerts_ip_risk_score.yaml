id: 4e8c2f51-b1ab-4d32-8c8f-2f83c71b4cd0
Function:
  Title: Parser to extract IP Risk Score alerts from Cyble Vision Alerts
  Version: '1.0.0'
  LastUpdated: '2025-12-09'
Category: Microsoft Sentinel Parser
FunctionName: Alerts_ip_risk_score
FunctionAlias: Alerts_ip_risk_score
FunctionQuery: |
  CybleVisionAlerts_CL
  | where Service == "ip_risk_score"
  // Parse the numeric array [old_score, new_score, ip]
  | extend Data = parse_json(Data)
  | extend Data = (Data.data)
  // Extract fields
  | extend 
      IPRS_OldScore = tostring(Old_Risk_Score),
      IPRS_NewScore = tostring(New_Risk_Score),
      IPRS_IP       = tostring(IP)
  // Normalize risk score using your standard pack format
  | extend Risk_Score = pack("s", RiskScore_s, "e", RiskScore_e, "c", RiskScore_c)
  // Final projection (your standard)
  | project
      TimeGenerated,
      AlertID = tostring(ID),
      EntityID,
      KeywordName,
      CompanyID,
      Status,
      Severity,
      UserSeverity,
      BucketID,
      Domain,
      BucketName,
      TruePositive,
      LLMProcessed,
      LLMExplanation,
      IP,
      Service,
      Risk_Score,
      Data,
      // IP RISK SCORE fields
      IPRS_IP,
      IPRS_OldScore,
      IPRS_NewScore
