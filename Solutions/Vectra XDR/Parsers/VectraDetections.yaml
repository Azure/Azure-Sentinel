id: de724888-764f-4cfb-9882-804269dea40b
Function:
  Title: Parser for VectraDetections
  Version: "1.1.1"
  LastUpdated: "2025-09-08"
Category: Microsoft Sentinel Parser
FunctionName: VectraDetections
FunctionAlias: VectraDetections
FunctionQuery: |
  let VectraDetections_view  = view () { 
      Detections_Data_CL
      | extend 
          EventVendor="VectraDetections",
          EventProduct="VectraDetections",
          ID = column_ifexists('id', ''),
          ["Detection Category"] = column_ifexists('category', ''),
          ["Is Triaged"] = column_ifexists('triaged', ''),
          ["Detection Name"] = column_ifexists('detection_type', ''),
          ["Type"] = column_ifexists('entity_type', ''),
          ["Entity Type"] = column_ifexists('entity_type', ''),
          ["D Type Vname"] = column_ifexists('d_type_vname', ''),
          ["Detection ID"] = column_ifexists('detection_id', ''),
          ["Temp Pivot"] = column_ifexists('detection_href', ''),
          ["Entity ID"] = toint(column_ifexists('entity_id', '')),
          URL = column_ifexists('url', ''),
          ["Entity UID"] = column_ifexists('entity_uid', ''),
          ["Last Updated"] = column_ifexists('event_timestamp', ''),
          ["Details"] = column_ifexists('detail', ''),
          Severity = column_ifexists('severity', ''),
          ["Source IP"] = column_ifexists('src_ip', ''),
          ["Detection Details"] = column_ifexists('d_detection_details', ''),
          ["Normal Domains"] = column_ifexists('normal_domains', ''),
          ["Is Targeting Key Asset"] = column_ifexists('is_targeting_key_asset', ''),
          ["Source Host"] = column_ifexists('src_host', ''),
          Summary = column_ifexists('summary', ''),
          ["Grouped Details"] = column_ifexists('grouped_details', ''),
          Mitre = column_ifexists('mitre', ''),
          Tags = column_ifexists('tags', '')
      |extend 
          ["Vectra Pivot"] = case(isnotempty(['Temp Pivot']), strcat(split(['Temp Pivot'], '?detail_id=')[0], "?pivot=Vectra-Sentinel-2.0.0"), ['Temp Pivot']),
          URL = case(isnotempty(URL), strcat(URL, "?pivot=Vectra-Sentinel-2.0.0"), URL)
      | project
          TimeGenerated,
          EventVendor,
          EventProduct,
          ID,
          ["Detection Category"],
          ["Is Triaged"],
          ["Detection Name"],
          ["Type"],
          ["Entity Type"],
          ["D Type Vname"],
          ["Detection ID"],
          ["Vectra Pivot"],
          ["Entity ID"],
          URL,
          ["Entity UID"],
          ["Last Updated"],
          ["Details"],
          Severity,
          ["Source IP"],
          ["Detection Details"],
          ["Normal Domains"],
          ["Is Targeting Key Asset"],
          ["Source Host"],
          Summary,
          ["Grouped Details"],
          Mitre,
          Tags
  };
  VectraDetections_view