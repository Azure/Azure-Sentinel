id: 1175ffec-960e-48f8-b646-8292745c9524
Function:
  Title: Parser for VectraEntityScoring
  Version: '1.1.0'
  LastUpdated: '2025-09-08'
Category: Microsoft Sentinel Parser
FunctionName: VectraEntityScoring
FunctionAlias: VectraEntityScoring
FunctionQuery: |
    let VectraEntityScoring_view  = view () { 
        Entity_Scoring_Data_CL
        | extend 
            EventVendor="VectraEntityScoring",
            EventProduct="VectraEntityScoring",
            ID = column_ifexists('id', ''),
            ["Entity ID"] = column_ifexists('entity_id', ''),
            ["Active Detection Types"] = column_ifexists('active_detection_types', ''),
            ["Breadth Contrib"] = column_ifexists('breadth_contrib', ''),
            Category = column_ifexists('category', ''),
            Importance = column_ifexists('importance', ''),
            Type = column_ifexists('entity_type', ''),
            ["Last Updated"] = column_ifexists('event_timestamp', ''),
            ["Is Prioritized"] = column_ifexists('is_prioritized', ''),
            ["Last Detection ID"] = column_ifexists('last_detection_id', ''),
            ["Last Detection Type"] = column_ifexists('last_detection_type', ''),
            ["Last Detection URL"] = column_ifexists('last_detection_url', ''),
            ["Last Detection"] = column_ifexists('last_detection', ''),
            Name = column_ifexists('name', ''),
            Severity = column_ifexists('severity', ''),
            ["Urgency Score"] = column_ifexists('urgency_score', ''),
            ["Vectra Pivot"] = column_ifexists('url', ''),
            Velocity = column_ifexists('velocity_contrib', ''),
            ["Attack Rating"] =  column_ifexists('attack_rating', '')
        | extend ["Vectra Pivot"] = case(isnotempty(['Vectra Pivot']), strcat(['Vectra Pivot'], "?pivot=Vectra-Sentinel-2.0.0"), ['Vectra Pivot'])
        | project
            TimeGenerated,
            EventVendor,
            EventProduct,
            ID,
            ["Entity ID"],
            Name,
            Importance,
            Type,
            ["Is Prioritized"],
            Severity,
            ["Urgency Score"],
            ["Vectra Pivot"],
            Category,
            ["Last Detection URL"],
            ["Last Detection Type"],
            ["Last Detection ID"],
            ["Last Detection"],
            ["Active Detection Types"],
            ["Last Updated"],
            ["Breadth Contrib"],
            Velocity,
            ["Attack Rating"]
    };
    VectraEntityScoring_view