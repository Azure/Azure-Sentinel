[
  {
    "name": "HubspotDCR",
    "apiVersion": "2021-09-01-preview",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {
        "Custom-HubspotAuditLogs": {
          "columns": [
            {
              "name": "actingUser",
              "type": "dynamic"
            },
            {
              "name": "action",
              "type": "string"
            },
            {
              "name": "category",
              "type": "string"
            },
            {
              "name": "id",
              "type": "string"
            },
            {
              "name": "occurredAt",
              "type": "datetime"
            },
            {
              "name": "subCategory",
              "type": "string"
            },
            {
              "name": "targetObjectId",
              "type": "string"
            }
          ]
        },
        "Custom-HubspotLoginActivity": {
          "columns": [
            {
              "name": "countryCode",
              "type": "string"
            },
            {
              "name": "email",
              "type": "string"
            },
            {
              "name": "id",
              "type": "string"
            },
            {
              "name": "ipAddress",
              "type": "string"
            },
            {
              "name": "location",
              "type": "string"
            },
            {
              "name": "loginAt",
              "type": "datetime"
            },
            {
              "name": "loginSucceeded",
              "type": "boolean"
            },
            {
              "name": "regionCode",
              "type": "string"
            },
            {
              "name": "userAgent",
              "type": "string"
            },
            {
              "name": "userId",
              "type": "int"
            }
          ]
        },
        "Custom-HubspotSecurityActivity": {
          "columns": [
            {
              "name": "actingUser",
              "type": "string"
            },
            {
              "name": "countryCode",
              "type": "string"
            },
            {
              "name": "createdAt",
              "type": "datetime"
            },
            {
              "name": "id",
              "type": "string"
            },
            {
              "name": "infoUrl",
              "type": "string"
            },
            {
              "name": "ipAddress",
              "type": "string"
            },
            {
              "name": "objectId",
              "type": "string"
            },
            {
              "name": "regionCode",
              "type": "string"
            },
            {
              "name": "type",
              "type": "string"
            },
            {
              "name": "userId",
              "type": "int"
            }
          ]
        }
      },
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "clv2ws1"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Custom-HubspotAuditLogs"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source | project-rename TimeGenerated=occurredAt",
          "outputStream": "Custom-HubspotAuditLogs_CL"
        },
        {
          "streams": [
            "Custom-HubspotLoginActivity"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source | project-rename TimeGenerated=loginAt",
          "outputStream": "Custom-HubspotLoginActivity"
        },
        {
          "streams": [
            "Custom-HubspotSecurityActivity"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source | project-rename TimeGenerated=createdAt, eventType=type",
          "outputStream": "Custom-HubspotSecurityActivity_CL"
        }
      ]
    }
  }
]