[
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2025-03-01",
    "name": "HubspotAuditLogsPoller",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "HubspotDefinition",
      "dataType": "HubspotAuditLogs",
      "dcrConfig": {
        "streamName": "Custom-HubspotAuditLogs_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{apikey}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "Bearer"
      },
      "request": {
        "httpMethod": "GET",
        "apiEndpoint": "https://api.hubapi.com/account-info/v3/activity/audit-logs",
        "queryWindowInMin": 5,
        "queryTimeFormat": "UnixTimestampInMills",
        "startTimeAttributeName": "occurredAfter",
        "endTimeAttributeName": "occurredBefore",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Scuba"
        },
        "queryParameters": {
          "limit": "200"
        },
        "rateLimitConfig": {
          "evaluation": {
            "checkMode": "OnlyWhen429"
          },
          "extraction": {
            "source": "CustomHeaders",
            "headers": {
              "limit": {
                "name": "X-HubSpot-RateLimit-Max",
                "format": "Integer"
              },
              "remaining": {
                "name": "X-HubSpot-RateLimit-Remaining",
                "format": "Integer"
              },
              "reset": {
                "name": "X-HubSpot-RateLimit-Interval-Milliseconds",
                "format": "UnixTimeMilliseconds"
              }
            }
          },
          "retryStrategy": {
            "useResetOrRetryAfterHeaders": true
          }
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$.results"
        ],
        "format": "json"
      },
      "paging": {
        "pagingType": "NextPageToken",
        "pageSize": 200,
        "nextPageParaName": "after",
        "nextPageTokenJsonPath": "$.paging.next.after"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2025-03-01",
    "name": "HubspotSecurityActivity",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "Hubspot",
      "dataType": "HubspotSecurityActivity",
      "dcrConfig": {
        "streamName": "Custom-HubspotSecurityActivity_CL"
      },
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{apikey}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "Bearer"
      },
      "request": {
        "httpMethod": "GET",
        "apiEndpoint": "https://api.hubapi.com/account-info/v3/activity/security",
        "queryWindowInMin": 5,
        "queryTimeFormat": "UnixTimestampInMills",
        "startTimeAttributeName": "fromTimestamp",
        "endTimeAttributeName": "toTimestamp",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Scuba"
        },
        "queryParameters": {
          "limit": "200"
        },
        "rateLimitConfig": {
          "evaluation": {
            "checkMode": "OnlyWhen429"
          },
          "extraction": {
            "source": "CustomHeaders",
            "headers": {
              "limit": {
                "name": "X-HubSpot-RateLimit-Max",
                "format": "Integer"
              },
              "remaining": {
                "name": "X-HubSpot-RateLimit-Remaining",
                "format": "Integer"
              },
              "reset": {
                "name": "X-HubSpot-RateLimit-Interval-Milliseconds",
                "format": "UnixTimeMilliseconds"
              }
            }
          },
          "retryStrategy": {
            "useResetOrRetryAfterHeaders": true
          }
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$.results"
        ],
        "format": "json"
      },
      "paging": {
        "pagingType": "NextPageToken",
        "pageSize": 200,
        "nextPageParaName": "after",
        "nextPageTokenJsonPath": "$.paging.next.after"
      }
    }
  }
]