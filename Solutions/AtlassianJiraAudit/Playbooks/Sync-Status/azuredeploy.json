{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "title": "Sync Jira to Sentinel - Status",
        "description": "This Playbook will sync the status from JIRA to Microsoft Sentinel.",
        "prerequisites": [
            "1. Configure JIRA with for custom fields and automation rule. [Learn more](https://github.com/ThijsLecomte/Azure-Sentinel/tree/master/Playbooks/Sync-IncidentsWithJIRA#2-jira-configuration)",
            "2. After playbook is deployed, grant the playbook permissions on the Key Vault (Secret - Get) and on Microsoft Sentinel workspace (Microsoft Sentinel responder)",
            "Optional: deploy Azure Function to sync comments from Jira to Microsoft Sentinel."
        ],
        "prerequisitesDeployTemplateFile": "../Sync-CommentsFunctionApp/azuredeploy.json",
        "lastUpdateTime": "2022-07-20T00:00:00.000Z",
        "entities": [ "Account" ],
        "tags": [ "Sync" ],
        "support": {
            "tier": "community"
        },
        "author": {
            "name": "Thijs Lecomte"
        },
        "releaseNotes": [
            {
                "version": "1.0.0",
                "title": "Sync Jira to Sentinel - Status",
                "notes": [ "Initial version" ]
            }
        ]
    },
    "parameters": {
        "PlaybookName": {
            "defaultValue": "Sync-Status",
            "type": "string"
        }
    },
    "variables": {
        "AzureSentinelConnectionName" : "[concat('azuresentinel-', parameters('PlaybookName'))]"
    },
    "resources": [
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('AzureSentinelConnectionName')]",
            "location": "[resourceGroup().location]",
            "properties": {
                "displayName": "[parameters('PlaybookName')]",
                "customParameterValues": {},
                "parameterValueType": "Alternative",
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                }
            }
        },
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('PlaybookName')]",
            "location": "[resourceGroup().location]",
            "identity": {
                "type": "SystemAssigned"
            },
            "tags": {
                "hidden-SentinelTemplateName": "SyncJIRAStatus",
                "hidden-SentinelTemplateVersion": "1.0"
            },
            "dependsOn": [
                "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]"
            ],
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        }
                    },
                    "triggers": {
                        "manual": {
                            "type": "Request",
                            "kind": "Http",
                            "inputs": {
                                "schema": {
                                    "properties": {
                                        "changelog": {
                                            "properties": {
                                                "histories": {},
                                                "maxResults": {
                                                    "type": "integer"
                                                },
                                                "startAt": {
                                                    "type": "integer"
                                                },
                                                "total": {
                                                    "type": "integer"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "fields": {
                                            "properties": {
                                                "aggregateprogress": {
                                                    "properties": {
                                                        "progress": {
                                                            "type": "integer"
                                                        },
                                                        "total": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "aggregatetimeestimate": {},
                                                "aggregatetimeoriginalestimate": {},
                                                "aggregatetimespent": {},
                                                "assignee": {},
                                                "attachment": {
                                                    "items": {
                                                        "properties": {
                                                            "author": {
                                                                "properties": {
                                                                    "accountId": {
                                                                        "type": "string"
                                                                    },
                                                                    "accountType": {
                                                                        "type": "string"
                                                                    },
                                                                    "active": {
                                                                        "type": "boolean"
                                                                    },
                                                                    "avatarUrls": {
                                                                        "properties": {
                                                                            "16x16": {
                                                                                "type": "string"
                                                                            },
                                                                            "24x24": {
                                                                                "type": "string"
                                                                            },
                                                                            "32x32": {
                                                                                "type": "string"
                                                                            },
                                                                            "48x48": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "displayName": {
                                                                        "type": "string"
                                                                    },
                                                                    "emailAddress": {},
                                                                    "groups": {},
                                                                    "key": {},
                                                                    "locale": {},
                                                                    "name": {},
                                                                    "self": {
                                                                        "type": "string"
                                                                    },
                                                                    "timeZone": {
                                                                        "type": "string"
                                                                    }
                                                                },
                                                                "type": "object"
                                                            },
                                                            "content": {
                                                                "type": "string"
                                                            },
                                                            "created": {
                                                                "type": "integer"
                                                            },
                                                            "filename": {
                                                                "type": "string"
                                                            },
                                                            "id": {
                                                                "type": "integer"
                                                            },
                                                            "mimeType": {
                                                                "type": "string"
                                                            },
                                                            "self": {
                                                                "type": "string"
                                                            },
                                                            "size": {
                                                                "type": "integer"
                                                            }
                                                        },
                                                        "required": [
                                                            "self",
                                                            "id",
                                                            "filename",
                                                            "author",
                                                            "created",
                                                            "size",
                                                            "mimeType",
                                                            "content"
                                                        ],
                                                        "type": "object"
                                                    },
                                                    "type": "array"
                                                },
                                                "comment": {
                                                    "properties": {
                                                        "comments": {
                                                            "items": {
                                                                "properties": {
                                                                    "author": {
                                                                        "properties": {
                                                                            "accountId": {
                                                                                "type": "string"
                                                                            },
                                                                            "accountType": {
                                                                                "type": "string"
                                                                            },
                                                                            "active": {
                                                                                "type": "boolean"
                                                                            },
                                                                            "avatarUrls": {
                                                                                "properties": {
                                                                                    "16x16": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "24x24": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "32x32": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "48x48": {
                                                                                        "type": "string"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "displayName": {
                                                                                "type": "string"
                                                                            },
                                                                            "emailAddress": {},
                                                                            "groups": {},
                                                                            "key": {},
                                                                            "locale": {},
                                                                            "name": {},
                                                                            "self": {
                                                                                "type": "string"
                                                                            },
                                                                            "timeZone": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "body": {
                                                                        "type": "string"
                                                                    },
                                                                    "created": {
                                                                        "type": "integer"
                                                                    },
                                                                    "id": {
                                                                        "type": "integer"
                                                                    },
                                                                    "renderedBody": {},
                                                                    "self": {
                                                                        "type": "string"
                                                                    },
                                                                    "updateAuthor": {
                                                                        "properties": {
                                                                            "accountId": {
                                                                                "type": "string"
                                                                            },
                                                                            "accountType": {
                                                                                "type": "string"
                                                                            },
                                                                            "active": {
                                                                                "type": "boolean"
                                                                            },
                                                                            "avatarUrls": {
                                                                                "properties": {
                                                                                    "16x16": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "24x24": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "32x32": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "48x48": {
                                                                                        "type": "string"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "displayName": {
                                                                                "type": "string"
                                                                            },
                                                                            "emailAddress": {},
                                                                            "groups": {},
                                                                            "key": {},
                                                                            "locale": {},
                                                                            "name": {},
                                                                            "self": {
                                                                                "type": "string"
                                                                            },
                                                                            "timeZone": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "updated": {
                                                                        "type": "integer"
                                                                    },
                                                                    "visibility": {}
                                                                },
                                                                "required": [
                                                                    "self",
                                                                    "id",
                                                                    "author",
                                                                    "body",
                                                                    "renderedBody",
                                                                    "updateAuthor",
                                                                    "created",
                                                                    "updated",
                                                                    "visibility"
                                                                ],
                                                                "type": "object"
                                                            },
                                                            "type": "array"
                                                        },
                                                        "last": {
                                                            "type": "boolean"
                                                        },
                                                        "maxResults": {
                                                            "type": "integer"
                                                        },
                                                        "startAt": {
                                                            "type": "integer"
                                                        },
                                                        "total": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "components": {
                                                    "type": "array"
                                                },
                                                "created": {
                                                    "type": "integer"
                                                },
                                                "creator": {
                                                    "properties": {
                                                        "accountId": {
                                                            "type": "string"
                                                        },
                                                        "accountType": {
                                                            "type": "string"
                                                        },
                                                        "active": {
                                                            "type": "boolean"
                                                        },
                                                        "avatarUrls": {
                                                            "properties": {
                                                                "16x16": {
                                                                    "type": "string"
                                                                },
                                                                "24x24": {
                                                                    "type": "string"
                                                                },
                                                                "32x32": {
                                                                    "type": "string"
                                                                },
                                                                "48x48": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "displayName": {
                                                            "type": "string"
                                                        },
                                                        "emailAddress": {},
                                                        "groups": {},
                                                        "key": {},
                                                        "locale": {},
                                                        "name": {},
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "timeZone": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10000": {
                                                    "type": "string"
                                                },
                                                "customfield_10001": {},
                                                "customfield_10002": {
                                                    "items": {
                                                        "properties": {
                                                            "_links": {
                                                                "properties": {
                                                                    "self": {
                                                                        "type": "string"
                                                                    }
                                                                },
                                                                "type": "object"
                                                            },
                                                            "id": {
                                                                "type": "string"
                                                            },
                                                            "name": {
                                                                "type": "string"
                                                            }
                                                        },
                                                        "required": [
                                                            "id",
                                                            "name",
                                                            "_links"
                                                        ],
                                                        "type": "object"
                                                    },
                                                    "type": "array"
                                                },
                                                "customfield_10003": {
                                                    "items": {
                                                        "properties": {
                                                            "accountId": {
                                                                "type": "string"
                                                            },
                                                            "accountType": {
                                                                "type": "string"
                                                            },
                                                            "active": {
                                                                "type": "boolean"
                                                            },
                                                            "avatarUrls": {
                                                                "properties": {
                                                                    "16x16": {
                                                                        "type": "string"
                                                                    },
                                                                    "24x24": {
                                                                        "type": "string"
                                                                    },
                                                                    "32x32": {
                                                                        "type": "string"
                                                                    },
                                                                    "48x48": {
                                                                        "type": "string"
                                                                    }
                                                                },
                                                                "type": "object"
                                                            },
                                                            "displayName": {
                                                                "type": "string"
                                                            },
                                                            "self": {
                                                                "type": "string"
                                                            },
                                                            "timeZone": {
                                                                "type": "string"
                                                            }
                                                        },
                                                        "required": [
                                                            "self",
                                                            "accountId",
                                                            "avatarUrls",
                                                            "displayName",
                                                            "active",
                                                            "timeZone",
                                                            "accountType"
                                                        ],
                                                        "type": "object"
                                                    },
                                                    "type": "array"
                                                },
                                                "customfield_10004": {},
                                                "customfield_10005": {},
                                                "customfield_10006": {},
                                                "customfield_10007": {},
                                                "customfield_10008": {},
                                                "customfield_10009": {},
                                                "customfield_10010": {
                                                    "properties": {
                                                        "_links": {
                                                            "properties": {
                                                                "agent": {
                                                                    "type": "string"
                                                                },
                                                                "jiraRest": {
                                                                    "type": "string"
                                                                },
                                                                "self": {
                                                                    "type": "string"
                                                                },
                                                                "web": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "currentStatus": {
                                                            "properties": {
                                                                "status": {
                                                                    "type": "string"
                                                                },
                                                                "statusCategory": {
                                                                    "type": "string"
                                                                },
                                                                "statusDate": {
                                                                    "properties": {
                                                                        "epochMillis": {
                                                                            "type": "integer"
                                                                        },
                                                                        "friendly": {
                                                                            "type": "string"
                                                                        },
                                                                        "iso8601": {
                                                                            "type": "string"
                                                                        },
                                                                        "jira": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "requestType": {
                                                            "properties": {
                                                                "_expands": {
                                                                    "items": {
                                                                        "type": "string"
                                                                    },
                                                                    "type": "array"
                                                                },
                                                                "_links": {
                                                                    "properties": {
                                                                        "self": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "description": {
                                                                    "type": "string"
                                                                },
                                                                "groupIds": {
                                                                    "type": "array"
                                                                },
                                                                "helpText": {
                                                                    "type": "string"
                                                                },
                                                                "icon": {
                                                                    "properties": {
                                                                        "_links": {
                                                                            "properties": {
                                                                                "iconUrls": {
                                                                                    "properties": {
                                                                                        "16x16": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "24x24": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "32x32": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "48x48": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "id": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "id": {
                                                                    "type": "string"
                                                                },
                                                                "issueTypeId": {
                                                                    "type": "string"
                                                                },
                                                                "name": {
                                                                    "type": "string"
                                                                },
                                                                "serviceDeskId": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10014": {},
                                                "customfield_10015": {},
                                                "customfield_10016": {},
                                                "customfield_10017": {},
                                                "customfield_10018": {
                                                    "properties": {
                                                        "hasEpicLinkFieldDependency": {
                                                            "type": "boolean"
                                                        },
                                                        "nonEditableReason": {
                                                            "properties": {
                                                                "message": {
                                                                    "type": "string"
                                                                },
                                                                "reason": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "showField": {
                                                            "type": "boolean"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10019": {
                                                    "type": "string"
                                                },
                                                "customfield_10020": {},
                                                "customfield_10021": {},
                                                "customfield_10022": {
                                                    "type": "string"
                                                },
                                                "customfield_10023": {
                                                    "type": "string"
                                                },
                                                "customfield_10024": {
                                                    "type": "array"
                                                },
                                                "customfield_10025": {},
                                                "customfield_10026": {},
                                                "customfield_10027": {},
                                                "customfield_10047": {},
                                                "customfield_10048": {
                                                    "properties": {
                                                        "_links": {
                                                            "properties": {
                                                                "self": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "completedCycles": {
                                                            "items": {
                                                                "properties": {
                                                                    "breached": {
                                                                        "type": "boolean"
                                                                    },
                                                                    "elapsedTime": {
                                                                        "properties": {
                                                                            "friendly": {
                                                                                "type": "string"
                                                                            },
                                                                            "millis": {
                                                                                "type": "integer"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "goalDuration": {
                                                                        "properties": {
                                                                            "friendly": {
                                                                                "type": "string"
                                                                            },
                                                                            "millis": {
                                                                                "type": "integer"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "remainingTime": {
                                                                        "properties": {
                                                                            "friendly": {
                                                                                "type": "string"
                                                                            },
                                                                            "millis": {
                                                                                "type": "integer"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "startTime": {
                                                                        "properties": {
                                                                            "epochMillis": {
                                                                                "type": "integer"
                                                                            },
                                                                            "friendly": {
                                                                                "type": "string"
                                                                            },
                                                                            "iso8601": {
                                                                                "type": "string"
                                                                            },
                                                                            "jira": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "stopTime": {
                                                                        "properties": {
                                                                            "epochMillis": {
                                                                                "type": "integer"
                                                                            },
                                                                            "friendly": {
                                                                                "type": "string"
                                                                            },
                                                                            "iso8601": {
                                                                                "type": "string"
                                                                            },
                                                                            "jira": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    }
                                                                },
                                                                "required": [
                                                                    "startTime",
                                                                    "stopTime",
                                                                    "breached",
                                                                    "goalDuration",
                                                                    "elapsedTime",
                                                                    "remainingTime"
                                                                ],
                                                                "type": "object"
                                                            },
                                                            "type": "array"
                                                        },
                                                        "id": {
                                                            "type": "string"
                                                        },
                                                        "name": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10049": {},
                                                "customfield_10050": {},
                                                "customfield_10051": {
                                                    "properties": {
                                                        "displayName": {
                                                            "type": "string"
                                                        },
                                                        "languageCode": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10124": {},
                                                "customfield_10125": {},
                                                "customfield_10126": {},
                                                "customfield_10127": {},
                                                "customfield_10128": {},
                                                "customfield_10129": {},
                                                "customfield_10130": {},
                                                "customfield_10131": {},
                                                "customfield_10132": {},
                                                "customfield_10133": {},
                                                "customfield_10134": {},
                                                "customfield_10135": {},
                                                "customfield_10136": {},
                                                "customfield_10142": {},
                                                "customfield_10143": {},
                                                "customfield_10144": {
                                                    "type": "string"
                                                },
                                                "customfield_10145": {
                                                    "type": "string"
                                                },
                                                "customfield_10146": {
                                                    "type": "string"
                                                },
                                                "customfield_10147": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "value": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10148": {},
                                                "customfield_10149": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "value": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "customfield_10150": {},
                                                "customfield_10151": {},
                                                "customfield_10154": {
                                                    "type": "string"
                                                },
                                                "customfield_10155": {
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "string"
                                                            },
                                                            "self": {
                                                                "type": "string"
                                                            },
                                                            "value": {
                                                                "type": "string"
                                                            }
                                                        },
                                                        "required": [
                                                            "self",
                                                            "value",
                                                            "id"
                                                        ],
                                                        "type": "object"
                                                    },
                                                    "type": "array"
                                                },
                                                "customfield_10156": {},
                                                "customfield_10157": {},
                                                "customfield_10158": {
                                                    "type": "string"
                                                },
                                                "customfield_10159": {},
                                                "customfield_10160": {},
                                                "customfield_10161": {},
                                                "customfield_10162": {
                                                    "type": "string"
                                                },
                                                "customfield_10164": {},
                                                "customfield_10165": {},
                                                "customfield_10167": {},
                                                "customfield_10168": {},
                                                "customfield_10169": {
                                                    "type": "string"
                                                },
                                                "customfield_10170": {
                                                    "type": "string"
                                                },
                                                "customfield_10171": {},
                                                "customfield_10172": {
                                                    "type": "string"
                                                },
                                                "customfield_10173": {
                                                    "type": "string"
                                                },
                                                "customfield_10174": {},
                                                "customfield_10175": {
                                                    "type": "string"
                                                },
                                                "customfield_10176": {},
                                                "description": {
                                                    "type": "string"
                                                },
                                                "duedate": {},
                                                "environment": {},
                                                "fixVersions": {
                                                    "type": "array"
                                                },
                                                "issuelinks": {
                                                    "type": "array"
                                                },
                                                "issuerestriction": {
                                                    "properties": {
                                                        "issuerestrictions": {
                                                            "properties": {},
                                                            "type": "object"
                                                        },
                                                        "shouldDisplay": {
                                                            "type": "boolean"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "issuetype": {
                                                    "properties": {
                                                        "description": {
                                                            "type": "string"
                                                        },
                                                        "fields": {},
                                                        "iconUrl": {
                                                            "type": "string"
                                                        },
                                                        "id": {
                                                            "type": "integer"
                                                        },
                                                        "name": {
                                                            "type": "string"
                                                        },
                                                        "namedValue": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "statuses": {
                                                            "type": "array"
                                                        },
                                                        "subtask": {
                                                            "type": "boolean"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "labels": {
                                                    "type": "array"
                                                },
                                                "lastViewed": {},
                                                "priority": {
                                                    "properties": {
                                                        "iconUrl": {
                                                            "type": "string"
                                                        },
                                                        "id": {
                                                            "type": "integer"
                                                        },
                                                        "name": {
                                                            "type": "string"
                                                        },
                                                        "namedValue": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "progress": {
                                                    "properties": {
                                                        "progress": {
                                                            "type": "integer"
                                                        },
                                                        "total": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "project": {
                                                    "properties": {
                                                        "avatarUrls": {
                                                            "properties": {
                                                                "16x16": {
                                                                    "type": "string"
                                                                },
                                                                "24x24": {
                                                                    "type": "string"
                                                                },
                                                                "32x32": {
                                                                    "type": "string"
                                                                },
                                                                "48x48": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "components": {},
                                                        "description": {},
                                                        "email": {},
                                                        "id": {
                                                            "type": "integer"
                                                        },
                                                        "issuetypes": {},
                                                        "key": {
                                                            "type": "string"
                                                        },
                                                        "lead": {},
                                                        "name": {
                                                            "type": "string"
                                                        },
                                                        "projectCategory": {},
                                                        "projectTypeKey": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "simplified": {
                                                            "type": "boolean"
                                                        },
                                                        "versions": {}
                                                    },
                                                    "type": "object"
                                                },
                                                "reporter": {
                                                    "properties": {
                                                        "accountId": {
                                                            "type": "string"
                                                        },
                                                        "accountType": {
                                                            "type": "string"
                                                        },
                                                        "active": {
                                                            "type": "boolean"
                                                        },
                                                        "avatarUrls": {
                                                            "properties": {
                                                                "16x16": {
                                                                    "type": "string"
                                                                },
                                                                "24x24": {
                                                                    "type": "string"
                                                                },
                                                                "32x32": {
                                                                    "type": "string"
                                                                },
                                                                "48x48": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "displayName": {
                                                            "type": "string"
                                                        },
                                                        "emailAddress": {},
                                                        "groups": {},
                                                        "key": {},
                                                        "locale": {},
                                                        "name": {},
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "timeZone": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "resolution": {
                                                    "properties": {
                                                        "description": {
                                                            "type": "string"
                                                        },
                                                        "id": {
                                                            "type": "integer"
                                                        },
                                                        "name": {
                                                            "type": "string"
                                                        },
                                                        "namedValue": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "resolutiondate": {
                                                    "type": "integer"
                                                },
                                                "security": {},
                                                "status": {
                                                    "properties": {
                                                        "description": {
                                                            "type": "string"
                                                        },
                                                        "iconUrl": {
                                                            "type": "string"
                                                        },
                                                        "id": {
                                                            "type": "integer"
                                                        },
                                                        "name": {
                                                            "type": "string"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "statusCategory": {
                                                            "properties": {
                                                                "colorName": {
                                                                    "type": "string"
                                                                },
                                                                "id": {
                                                                    "type": "integer"
                                                                },
                                                                "key": {
                                                                    "type": "string"
                                                                },
                                                                "name": {
                                                                    "type": "string"
                                                                },
                                                                "self": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "untranslatedName": {},
                                                        "untranslatedNameValue": {}
                                                    },
                                                    "type": "object"
                                                },
                                                "statuscategorychangedate": {
                                                    "type": "string"
                                                },
                                                "subtasks": {
                                                    "type": "array"
                                                },
                                                "summary": {
                                                    "type": "string"
                                                },
                                                "timeestimate": {},
                                                "timeoriginalestimate": {},
                                                "timespent": {},
                                                "timetracking": {
                                                    "properties": {
                                                        "originalEstimate": {},
                                                        "originalEstimateSeconds": {
                                                            "type": "integer"
                                                        },
                                                        "remainingEstimate": {},
                                                        "remainingEstimateSeconds": {
                                                            "type": "integer"
                                                        },
                                                        "timeSpent": {},
                                                        "timeSpentSeconds": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "updated": {
                                                    "type": "integer"
                                                },
                                                "versions": {
                                                    "type": "array"
                                                },
                                                "votes": {
                                                    "properties": {
                                                        "hasVoted": {
                                                            "type": "boolean"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "votes": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "watches": {
                                                    "properties": {
                                                        "isWatching": {
                                                            "type": "boolean"
                                                        },
                                                        "self": {
                                                            "type": "string"
                                                        },
                                                        "watchCount": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "worklog": {
                                                    "properties": {
                                                        "last": {
                                                            "type": "boolean"
                                                        },
                                                        "maxResults": {
                                                            "type": "integer"
                                                        },
                                                        "startAt": {
                                                            "type": "integer"
                                                        },
                                                        "total": {
                                                            "type": "integer"
                                                        },
                                                        "worklogs": {
                                                            "type": "array"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "workratio": {
                                                    "type": "integer"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "id": {
                                            "type": "integer"
                                        },
                                        "key": {
                                            "type": "string"
                                        },
                                        "renderedFields": {},
                                        "self": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "actions": {
                        "Switch": {
                            "runAfter": {},
                            "cases": {
                                "Case": {
                                    "case": "NEW",
                                    "actions": {
                                        "Update_incident_2": {
                                            "runAfter": {},
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": {
                                                    "incidentArmId": "@triggerBody()?['fields']?['customfield_10175']",
                                                    "status": "New"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                                    }
                                                },
                                                "method": "put",
                                                "path": "/Incidents"
                                            }
                                        }
                                    }
                                },
                                "Case_2": {
                                    "case": "INDETERMINATE",
                                    "actions": {
                                        "Update_incident_3": {
                                            "runAfter": {},
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": {
                                                    "incidentArmId": "@triggerBody()?['fields']?['customfield_10175']",
                                                    "status": "Active"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                                    }
                                                },
                                                "method": "put",
                                                "path": "/Incidents"
                                            }
                                        }
                                    }
                                },
                                "Case_3": {
                                    "case": "DONE",
                                    "actions": {
                                        "Update_incident": {
                                            "runAfter": {},
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": {
                                                    "classification": {
                                                        "ClassificationAndReason": "@{triggerBody()?['fields']?['customfield_10147']?['value']}",
                                                        "ClassificationReasonText": "@triggerBody()?['fields']?['customfield_10146']"
                                                    },
                                                    "incidentArmId": "@triggerBody()?['fields']?['customfield_10175']",
                                                    "status": "Closed"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                                    }
                                                },
                                                "method": "put",
                                                "path": "/Incidents"
                                            }
                                        }
                                    }
                                }
                            },
                            "default": {
                                "actions": {}
                            },
                            "expression": "@triggerBody()?['fields']?['customfield_10010']?['currentStatus']?['statusCategory']",
                            "type": "Switch"
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
                    "$connections": {
                        "value": {
                            "azuresentinel": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                                "connectionName": "[variables('AzureSentinelConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]",
                                "connectionProperties": {
                                    "authentication": {
                                        "type": "ManagedServiceIdentity"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    ]
}