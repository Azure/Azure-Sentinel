id: 983ea97a-fdf8-4efd-8b64-86f1e04ea684
Function:
  Title: Parser for Netskope Alerts
  Version: "1.0.0"
  LastUpdated: "2025-08-06"
Category: Microsoft Sentinel Parser
FunctionName: NetskopeAlerts
FunctionAlias: NetskopeAlerts
FunctionQuery: |
  let dummy_table = datatable(TimeGenerated: datetime) [];
  let NetskopeAlerts = view() {
    union isfuzzy=true dummy_table, NetskopeAlerts_CL
    | extend
        TimeGenerated = column_ifexists('TimeGenerated', ''),
        AccessMethod = column_ifexists('access_method', ''),
        AccountId = column_ifexists('account_id', ''),
        AccountName = column_ifexists('account_name', ''),
        Acked = column_ifexists('acked', ''),
        Action = column_ifexists('action', ''),
        Activity = column_ifexists('activity', ''),
        Alert = column_ifexists('alert', ''),
        AlertId = column_ifexists('alert_id', ''),
        AlertName = column_ifexists('alert_name', ''),
        AlertType = column_ifexists('alert_type', ''),
        App = column_ifexists('app', ''),
        AppActivity = column_ifexists('app_activity', ''),
        AppSessionid = column_ifexists('app_sessionid', ''),
        AppCategory = column_ifexists('appcategory', ''),
        AppSuite = column_ifexists('appsuite', ''),
        AssetId = column_ifexists('asset_id', ''),
        AssetObjectId = column_ifexists('asset_object_id', ''),
        BreachDate = column_ifexists('breach_date', ''),
        BreachDescription = column_ifexists('breach_description', ''),
        BreachId = column_ifexists('breach_id', ''),
        BreachMediaReferences = column_ifexists('breach_media_references', ''),
        BreachScore = column_ifexists('breach_score', ''),
        BreachTargetReferences = column_ifexists('breach_target_references', ''),
        Browser = column_ifexists('browser', ''),
        BrowserSessionId = column_ifexists('browser_sessionid', ''),
        BrowserVersion = column_ifexists('browser_version', ''),
        BypassTraffic = column_ifexists('bypass_traffic', ''),
        Category = column_ifexists('category', ''),
        Cci = column_ifexists('cci', ''),
        Ccl = column_ifexists('ccl', ''),
        ClientBytes = column_ifexists('client_bytes', ''),
        ComplianceStandards = column_ifexists('compliance_standards', ''),
        ConnDuration = column_ifexists('conn_duration', ''),
        ConnEndtime = column_ifexists('conn_endtime', ''),
        ConnStarttime = column_ifexists('conn_starttime', ''),
        ConnectionId = column_ifexists('connectionid', ''),
        CononicalName = column_ifexists('CononicalName', ''),
        CountI = column_ifexists('count_i', ''),
        DataType = column_ifexists('data_type', ''),
        Device = column_ifexists('device', ''),
        DeviceClassification = column_ifexists('device_classification', ''),
        DlpFile = column_ifexists('dlp_file', ''),
        DlpIncidentId = column_ifexists('dlp_incidentid', ''),
        DlpIsUniqueCount = column_ifexists('dlp_is_unique_count', ''),
        DlpMailParentId = column_ifexists('dlp_mail_parent_id', ''),
        DlpParentId = column_ifexists('dlp_parentid', ''),
        DlpProfile = column_ifexists('dlp_profile', ''),
        DlpRule = column_ifexists('dlp_rule', ''),
        DlpRuleCount = column_ifexists('dlp_rule_count', ''),
        DlpRuleSeverity = column_ifexists('dlp_rule_severity', ''),
        DlpUniqueCount = column_ifexists('dlp_unique_count', ''),
        Domain = column_ifexists('domain', ''),
        DstCountry = column_ifexists('dst_country', ''),
        DstGeoipSrc = column_ifexists('dst_geoip_src', ''),
        DstLatitude = column_ifexists('dst_latitude', ''),
        DstLocation = column_ifexists('dst_location', ''),
        DstLongitude = column_ifexists('dst_longitude', ''),
        DstRegion = column_ifexists('dst_region', ''),
        DstTimezone = column_ifexists('dst_timezone', ''),
        DstZipcode = column_ifexists('dst_zipcode', ''),
        DstIp = column_ifexists('dstip', ''),
        DstHost = column_ifexists('dsthost', ''),
        DstPort = column_ifexists('dstport', ''),
        EmailSource = column_ifexists('email_source', ''),
        EventType = column_ifexists('event_type', ''),
        EvtSrcChnl = column_ifexists('evt_src_chnl', ''),
        Exposure = column_ifexists('exposure', ''),
        ExternalCollaboratorCount = column_ifexists('external_collaborator_count', ''),
        ExternalEmail = column_ifexists('external_email', ''),
        FileClsEncrypted = column_ifexists('file_cls_encrypted', ''),
        FileLang = column_ifexists('file_lang', ''),
        FilePath = column_ifexists('file_path', ''),
        FileSize = column_ifexists('file_size', ''),
        FileType = column_ifexists('file_type', ''),
        FromUser = column_ifexists('from_user', ''),
        FromLogs = column_ifexists('fromlogs', ''),
        HostName = column_ifexists('hostname', ''),
        HttpTransactionCount = column_ifexists('http_transaction_count', ''),
        IaasAssetTags = column_ifexists('iaas_asset_tags', ''),
        IaasRemediated = column_ifexists('iaas_remediated', ''),
        Instance = column_ifexists('instance', ''),
        InstanceId = column_ifexists('instance_id', ''),
        InternalCollaboratorCount = column_ifexists('internal_collaborator_count', ''),
        JustificationReason = column_ifexists('justification_reason', ''),
        JustificationType = column_ifexists('justification_type', ''),
        LastApp = column_ifexists('last_app', ''),
        LastCountry = column_ifexists('last_country', ''),
        LastDevice = column_ifexists('last_device', ''),
        LastLocation = column_ifexists('last_location', ''),
        LastRegion = column_ifexists('last_region', ''),
        LastTimestamp = column_ifexists('last_timestamp', ''),
        LogFileName = column_ifexists('log_file_name', ''),
        Malicious = column_ifexists('malicious', ''),
        MalsiteCategory = column_ifexists('malsite_category', ''),
        MalsiteCountry = column_ifexists('malsite_country', ''),
        MalsiteId = column_ifexists('malsite_id', ''),
        MalsiteIpHost = column_ifexists('malsite_ip_host', ''),
        MalsiteLatitude = column_ifexists('malsite_latitude', ''),
        MalsiteLongitude = column_ifexists('malsite_longitude', ''),
        MalsiteRegion = column_ifexists('malsite_region', ''),
        ManagedApp = column_ifexists('managed_app', ''),
        ManagementId = column_ifexists('managementID', ''),
        MatchedUserName = column_ifexists('matched_username', ''),
        Md5 = column_ifexists('md5', ''),
        MimeType = column_ifexists('mime_type', ''),
        Modified = column_ifexists('modified', ''),
        NetskopeActivity = column_ifexists('netskope_activity', ''),
        NetskopePop = column_ifexists('netskope_pop', ''),
        NotifyTemplate = column_ifexists('notify_template', ''),
        NsdeviceUid = column_ifexists('nsdeviceuid', ''),
        Numbytes = column_ifexists('numbytes', ''),
        Object = column_ifexists('object', ''),
        ObjectId = column_ifexists('object_id', ''),
        ObjectType = column_ifexists('object_type', ''),
        Org = column_ifexists('org', ''),
        OrganizationUnit = column_ifexists('organization_unit', ''),
        OrigTy = column_ifexists('orig_ty', ''),
        OrignalFilePath = column_ifexists('orignal_file_path', ''),
        Os = column_ifexists('os', ''),
        OsVersion = column_ifexists('os_version', ''),
        OtherCategories = column_ifexists('other_categories', ''),
        OuterDocType = column_ifexists('outer_doc_type', ''),
        Owner = column_ifexists('owner', ''),
        Page = column_ifexists('page', ''),
        PageSite = column_ifexists('page_site', ''),
        ParentId = column_ifexists('parent_id', ''),
        PasswordType = column_ifexists('password_type', ''),
        Policy = column_ifexists('policy', ''),
        PolicyActions = column_ifexists('policy_actions', ''),
        PolicyId = column_ifexists('policy_id', ''),
        ProfileId = column_ifexists('profile_id', ''),
        Protocol = column_ifexists('protocol', ''),
        Referer = column_ifexists('referer', ''),
        RegionId = column_ifexists('region_id', ''),
        RegionName = column_ifexists('region_name', ''),
        ReqCnt = column_ifexists('req_cnt', ''),
        RequestId = column_ifexists('requestid', ''),
        ResourceCategory = column_ifexists('resource_category', ''),
        ResourceGroup = column_ifexists('resource_group', ''),
        RespCnt = column_ifexists('resp_cnt', ''),
        SaProfileId = column_ifexists('sa_profile_id', ''),
        SaProfileName = column_ifexists('sa_profile_name', ''),
        SaRuleId = column_ifexists('sa_rule_id', ''),
        SaRuleName = column_ifexists('sa_rule_name', ''),
        SaRuleSeverity = column_ifexists('sa_rule_severity', ''),
        SAMAccountName = column_ifexists('sAMAccountName', ''),
        SanctionedInstance = column_ifexists('sanctioned_instance', ''),
        ScanType = column_ifexists('scan_type', ''),
        Serial = column_ifexists('serial', ''),
        ServerBytes = column_ifexists('server_bytes', ''),
        SessionId = column_ifexists('sessionid', ''),
        Severity = column_ifexists('severity', ''),
        SeverityLevel = column_ifexists('severity_level', ''),
        SeverityLevelId = column_ifexists('severity_level_id', ''),
        Sfwder = column_ifexists('sfwder', ''),
        Sha256 = column_ifexists('sha256', ''),
        SharedDomains = column_ifexists('shared_domains', ''),
        SharedWith = column_ifexists('shared_with', ''),
        Site = column_ifexists('site', ''),
        SrcCountry = column_ifexists('src_country', ''),
        SrcGeoipSrc = column_ifexists('src_geoip_src', ''),
        SrcLatitude = column_ifexists('src_latitude', ''),
        SrcLocation = column_ifexists('src_location', ''),
        SrcLongitude = column_ifexists('src_longitude', ''),
        SrcRegion = column_ifexists('src_region', ''),
        SrcTime = column_ifexists('src_time', ''),
        SrcTimezone = column_ifexists('src_timezone', ''),
        SrcZipcode = column_ifexists('src_zipcode', ''),
        SrcIp = column_ifexists('srcip', ''),
        SuppressionEndTime = column_ifexists('suppression_end_time', ''),
        SuppressionKey = column_ifexists('suppression_key', ''),
        SuppressionStartTime = column_ifexists('suppression_start_time', ''),
        TelemetryApp = column_ifexists('telemetry_app', ''),
        ThreatMatchField = column_ifexists('threat_match_field', ''),
        ThreatMatchValue = column_ifexists('threat_match_value', ''),
        ThreatSourceId = column_ifexists('threat_source_id', ''),
        Threshold = column_ifexists('threshold', ''),
        ThresholdTime = column_ifexists('threshold_time', ''),
        Timestamp = column_ifexists('timestamp', ''),
        TitleS = column_ifexists('title_s', ''),
        ToObject = column_ifexists('to_object', ''),
        TotalCollaboratorCount = column_ifexists('total_collaborator_count', ''),
        TrafficType = column_ifexists('traffic_type', ''),
        TransactionId = column_ifexists('transactionid', ''),
        TrueObjCategory = column_ifexists('true_obj_category', ''),
        TrueObjType = column_ifexists('true_obj_type', ''),
        TssMode = column_ifexists('tss_mode', ''),
        TwoFactorAuth = column_ifexists('two_factor_auth', ''),
        PolicyType = column_ifexists('type_s', ''),
        UniversalConnector = column_ifexists('universal_connector', ''),
        UrNormalized = column_ifexists('ur_normalized', ''),
        Url = column_ifexists('url', ''),
        User = column_ifexists('user', ''),
        UserGenerated = column_ifexists('user_generated', ''),
        UserId = column_ifexists('user_id', ''),
        UserAgent = column_ifexists('useragent', ''),
        UserIp = column_ifexists('userip', ''),
        UserKey = column_ifexists('userkey', ''),
        UserPrincipalName = column_ifexists('userPrincipalName', ''),
        WebUniversalConnector = column_ifexists('web_universal_connector', '')
    | project
        TimeGenerated,
        AccessMethod,
        AccountId,
        AccountName,
        Acked,
        Action,
        Activity,
        Alert,
        AlertId,
        AlertName,
        AlertType,
        App,
        AppActivity,
        AppSessionid,
        AppCategory,
        AppSuite,
        AssetId,
        AssetObjectId,
        BreachDate,
        BreachDescription,
        BreachId,
        BreachMediaReferences,
        BreachScore,
        BreachTargetReferences,
        Browser,
        BrowserSessionId,
        BrowserVersion,
        BypassTraffic,
        Category,
        Cci,
        Ccl,
        ClientBytes,
        ComplianceStandards,
        ConnDuration,
        ConnEndtime,
        ConnStarttime,
        ConnectionId,
        CononicalName,
        CountI,
        DataType,
        Device,
        DeviceClassification,
        DlpFile,
        DlpIncidentId,
        DlpIsUniqueCount,
        DlpMailParentId,
        DlpParentId,
        DlpProfile,
        DlpRule,
        DlpRuleCount,
        DlpRuleSeverity,
        DlpUniqueCount,
        Domain,
        DstCountry,
        DstGeoipSrc,
        DstLatitude,
        DstLocation,
        DstLongitude,
        DstRegion,
        DstTimezone,
        DstZipcode,
        DstIp,
        DstHost,
        DstPort,
        EmailSource,
        EventType,
        EvtSrcChnl,
        Exposure,
        ExternalCollaboratorCount,
        ExternalEmail,
        FileClsEncrypted,
        FileLang,
        FilePath,
        FileSize,
        FileType,
        FromUser,
        FromLogs,
        HostName,
        HttpTransactionCount,
        IaasAssetTags,
        IaasRemediated,
        Instance,
        InstanceId,
        InternalCollaboratorCount,
        JustificationReason,
        JustificationType,
        LastApp,
        LastCountry,
        LastDevice,
        LastLocation,
        LastRegion,
        LastTimestamp,
        LogFileName,
        Malicious,
        MalsiteCategory,
        MalsiteCountry,
        MalsiteId,
        MalsiteIpHost,
        MalsiteLatitude,
        MalsiteLongitude,
        MalsiteRegion,
        ManagedApp,
        ManagementId,
        MatchedUserName,
        Md5,
        MimeType,
        Modified,
        NetskopeActivity,
        NetskopePop,
        NotifyTemplate,
        NsdeviceUid,
        Numbytes,
        Object,
        ObjectId,
        ObjectType,
        Org,
        OrganizationUnit,
        OrigTy,
        OrignalFilePath,
        Os,
        OsVersion,
        OtherCategories,
        OuterDocType,
        Owner,
        Page,
        PageSite,
        ParentId,
        PasswordType,
        Policy,
        PolicyActions,
        PolicyId,
        ProfileId,
        Protocol,
        Referer,
        RegionId,
        RegionName,
        ReqCnt,
        RequestId,
        ResourceCategory,
        ResourceGroup,
        RespCnt,
        SaProfileId,
        SaProfileName,
        SaRuleId,
        SaRuleName,
        SaRuleSeverity,
        SAMAccountName,
        SanctionedInstance,
        ScanType,
        Serial,
        ServerBytes,
        SessionId,
        Severity,
        SeverityLevel,
        SeverityLevelId,
        Sfwder,
        Sha256,
        SharedDomains,
        SharedWith,
        Site,
        SrcCountry,
        SrcGeoipSrc,
        SrcLatitude,
        SrcLocation,
        SrcLongitude,
        SrcRegion,
        SrcTime,
        SrcTimezone,
        SrcZipcode,
        SrcIp,
        SuppressionEndTime,
        SuppressionKey,
        SuppressionStartTime,
        TelemetryApp,
        ThreatMatchField,
        ThreatMatchValue,
        ThreatSourceId,
        Threshold,
        ThresholdTime,
        Timestamp,
        TitleS,
        ToObject,
        TotalCollaboratorCount,
        TrafficType,
        TransactionId,
        TrueObjCategory,
        TrueObjType,
        TssMode,
        TwoFactorAuth,
        PolicyType,
        UniversalConnector,
        UrNormalized,
        Url,
        User,
        UserGenerated,
        UserId,
        UserAgent,
        UserIp,
        UserKey,
        UserPrincipalName,
        WebUniversalConnector
  };
  NetskopeAlerts