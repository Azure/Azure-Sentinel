id: a839f340-221e-4894-9a1c-e24d397cd508
Function:
  Title: Parser for AlertsMalsite
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: AlertsMalsite
FunctionAlias: AlertsMalsite
FunctionQuery: |
  let Alerts_malsite_view = view(){
     alertsmalsitedata_CL
     | extend Category = column_ifexists('Category', ''),
       Computer = column_ifexists('Computer', ''),
       MG = column_ifexists('MG', ''),
       ManagementGroupName = column_ifexists('ManagementGroupName', ''),
       RawData = column_ifexists('RawData', ''),
       SourceSystem = column_ifexists('SourceSystem', ''),
       TenantId = column_ifexists('TenantId', ''),
       TimeGenerated = column_ifexists('TimeGenerated', ''),
       Type = column_ifexists('Type', ''),
       _ResourceId = column_ifexists('_ResourceId', ''),
       Id = column_ifexists('_id_s', ''),
       AccessMethod = column_ifexists('access_method_s', ''),
       Acked = column_ifexists('acked_s', ''),
       Action = column_ifexists('action_s', ''),
       AggregatedUser = column_ifexists('aggregated_user_s', ''),
       AlertName = column_ifexists('alert_name_s', ''),
       Alert = column_ifexists('alert_s', ''),
       AlertType = column_ifexists('alert_type_s', ''),
       App = column_ifexists('app_s', ''),
       AppSessionId = column_ifexists('app_session_id_d', ''),
       AppCategory = column_ifexists('appcategory_s', ''),
       AppSuite = column_ifexists('appsuite_s', ''),
       Browser = column_ifexists('browser_s', ''),
       BrowserSessionId = column_ifexists('browser_session_id_d', ''),
       BrowserVersion = column_ifexists('browser_version_s', ''),
       CCI = column_ifexists('cci_d', ''),
       CCIString = column_ifexists('cci_s', ''),
       CCL = column_ifexists('ccl_s', ''),
       ClientBytes = column_ifexists('client_bytes_d', ''),
       CO = column_ifexists('co_s', ''),
       ConnDuration = column_ifexists('conn_duration_d', ''),
       ConnectionId = column_ifexists('connection_id_d', ''),
       Count = column_ifexists('count_d', ''),
       Department = column_ifexists('department_s', ''),
       DeviceClassification = column_ifexists('device_classification_s', ''),
       Device = column_ifexists('device_s', ''),
       Division = column_ifexists('division_s', ''),
       DestinationCountry = column_ifexists('dst_country_s', ''),
       DestinationGeoipSource = column_ifexists('dst_geoip_src_d', ''),
       DestinationLatitude = column_ifexists('dst_latitude_d', ''),
       DestinationLocation = column_ifexists('dst_location_s', ''),
       DestinationLongitude = column_ifexists('dst_longitude_d', ''),
       DestinationRegion = column_ifexists('dst_region_s', ''),
       DestinationTimezone = column_ifexists('dst_timezone_s', ''),
       DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
       DestinationHost = column_ifexists('dsthost_s', ''),
       DestinationIp = column_ifexists('dstip_s', ''),
       DestinationPort = column_ifexists('dstport_d', ''),
       FromUser = column_ifexists('from_user_s', ''),
       Fromlogs = column_ifexists('fromlogs_s', ''),
       Gateway = column_ifexists('gateway_s', ''),
       HostName = column_ifexists('hostname_s', ''),
       IncidentId = column_ifexists('incident_id_d', ''),
       JA3 = column_ifexists('ja3_s', ''),
       JA3S = column_ifexists('ja3s_s', ''),
       LogFileName = column_ifexists('log_file_name_s', ''),
       Malicious = column_ifexists('malicious_s', ''),
       malsite_active = column_ifexists('malsite_active_s', ''),
       MalsiteCategory = column_ifexists('malsite_category_s', ''),
       MalsiteConfidence = column_ifexists('malsite_confidence_d', ''),
       MalsiteConsecutive = column_ifexists('malsite_consecutive_s', ''),
       MalsiteCountry = column_ifexists('malsite_country_s', ''),
       MalsiteFirstSeen = column_ifexists('malsite_first_seen_d', ''),
       MalsiteHostility = column_ifexists('malsite_hostility_s', ''),
       MalsiteId = column_ifexists('malsite_id_s', ''),
       MalsiteIpHost = column_ifexists('malsite_ip_host_s', ''),
       MalsiteLastSeen = column_ifexists('malsite_last_seen_d', ''),
       MalsiteLatitude = column_ifexists('malsite_latitude_d', ''),
       MalsiteLongitude = column_ifexists('malsite_longitude_d', ''),
       MalsiteRegion = column_ifexists('malsite_region_s', ''),
       MalsiteReputation = column_ifexists('malsite_reputation_s', ''),
       ManagedApp = column_ifexists('managed_app_s', ''),
       NotifyTemplate = column_ifexists('notify_template_s', ''),
       Numbytes = column_ifexists('numbytes_d', ''),
       Object = column_ifexists('object_s', ''),
       ObjectType = column_ifexists('object_type_s', ''),
       Org = column_ifexists('org_s', ''),
       OrganizationUnit = column_ifexists('organization_unit_s', ''),
       OS = column_ifexists('os_s', ''),
       OsVersion = column_ifexists('os_version_s', ''),
       OtherCategories = column_ifexists('other_categories_s', ''),
       Page = column_ifexists('page_s', ''),
       PageSite = column_ifexists('page_site_s', ''),
       PolicyId = column_ifexists('policy_id_s', ''),
       Policy = column_ifexists('policy_s', ''),
       Protocol = column_ifexists('protocol_s', ''),
       Referer = column_ifexists('referer_s', ''),
       RequestCount = column_ifexists('req_cnt_d', ''),
       RequestId = column_ifexists('request_id_s', ''),
       ResponseCount = column_ifexists('resp_cnt_d', ''),
       SAMAccountName = column_ifexists('sAMAccountName_s', ''),
       Serial = column_ifexists('serial_s', ''),
       ServerBytes = column_ifexists('server_bytes_d', ''),
       severity_level_id = column_ifexists('severity_level_id_d', ''),
       severity_level = column_ifexists('severity_level_s', ''),
       Severity = column_ifexists('severity_s', ''),
       Sfwder = column_ifexists('sfwder_s', ''),
       Site = column_ifexists('site_s', ''),
       SourceCountry = column_ifexists('src_country_s', ''),
       SourceGeoIpSrc = column_ifexists('src_geoip_src_d', ''),
       SourceLatitude = column_ifexists('src_latitude_d', ''),
       SourceLocation = column_ifexists('src_location_s', ''),
       SourceLongitude = column_ifexists('src_longitude_d', ''),
       SourceRegion = column_ifexists('src_region_s', ''),
       SourceTime = column_ifexists('src_time_s', ''),
       SourceTimezone = column_ifexists('src_timezone_s', ''),
       SourceZipcode = column_ifexists('src_zipcode_s', ''),
       SourceIp = column_ifexists('srcip_s', ''),
       SuppressionEndTime = column_ifexists('suppression_end_time_d', ''),
       SuppressionStartTime = column_ifexists('suppression_start_time_d', ''),
       TelemetryApp = column_ifexists('telemetry_app_s', ''),
       ThreatMatchField = column_ifexists('threat_match_field_s', ''),
       ThreatMatchValue = column_ifexists('threat_match_value_s', ''),
       ThreatSourceId = column_ifexists('threat_source_id_d', ''),
       Timestamp = column_ifexists('timestamp_d', ''),
       TrafficType = column_ifexists('traffic_type_s', ''),
       TransactionId = column_ifexists('transaction_id_d', ''),
       PolicyType = column_ifexists('type_s', ''),
       UniversalConnector = column_ifexists('universal_connector_s', ''),
       UrNormalized = column_ifexists('ur_normalized_s', ''),
       Url = column_ifexists('url_s', ''),
       User = column_ifexists('user_s', ''),
       Useragent = column_ifexists('useragent_s', ''),
       UserIp = column_ifexists('userip_s', '')
       | project Category,
         Computer,
         MG,
         ManagementGroupName,
         RawData,
         SourceSystem,
         TenantId,
         TimeGenerated,
         Type,
         _ResourceId,
         Id,
         AccessMethod,
         Acked,
         Action,
         AggregatedUser,
         AlertName,
         Alert,
         AlertType,
         App,
         AppSessionId,
         AppCategory,
         AppSuite,
         Browser,
         BrowserSessionId,
         BrowserVersion,
         CCI,
         CCIString,
         CCL,
         ClientBytes,
         CO,
         ConnDuration,
         ConnectionId,
         Count,
         Department,
         DeviceClassification,
         Device,
         Division,
         DestinationCountry,
         DestinationGeoipSource,
         DestinationLatitude,
         DestinationLocation,
         DestinationLongitude,
         DestinationRegion,
         DestinationTimezone,
         DestinationZipcode,
         DestinationHost,
         DestinationIp,
         DestinationPort,
         FromUser,
         Fromlogs,
         Gateway,
         HostName,
         IncidentId,
         JA3,
         JA3S,
         LogFileName,
         Malicious,
         malsite_active,
         MalsiteCategory,
         MalsiteConfidence,
         MalsiteConsecutive,
         MalsiteCountry,
         MalsiteFirstSeen,
         MalsiteHostility,
         MalsiteId,
         MalsiteIpHost,
         MalsiteLastSeen,
         MalsiteLatitude,
         MalsiteLongitude,
         MalsiteRegion,
         MalsiteReputation,
         ManagedApp,
         NotifyTemplate,
         Numbytes,
         Object,
         ObjectType,
         Org,
         OrganizationUnit,
         OS,
         OsVersion,
         OtherCategories,
         Page,
         PageSite,
         PolicyId,
         Policy,
         Protocol,
         Referer,
         RequestCount,
         RequestId,
         ResponseCount,
         SAMAccountName,
         Serial,
         ServerBytes,
         severity_level_id,
         severity_level,
         Severity,
         Sfwder,
         Site,
         SourceCountry,
         SourceGeoIpSrc,
         SourceLatitude,
         SourceLocation,
         SourceLongitude,
         SourceRegion,
         SourceTime,
         SourceTimezone,
         SourceZipcode,
         SourceIp,
         SuppressionEndTime,
         SuppressionStartTime,
         TelemetryApp,
         ThreatMatchField,
         ThreatMatchValue,
         ThreatSourceId,
         Timestamp,
         TrafficType,
         TransactionId,
         PolicyType,
         UniversalConnector,
         UrNormalized,
         Url,
         User,
         Useragent,
         UserIp
     };
     Alerts_malsite_view
