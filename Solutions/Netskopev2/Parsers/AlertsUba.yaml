id: 1038c863-722b-4ce2-88d7-3ffc0fc40043
Function:
  Title: Parser for AlertsUba
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: AlertsUba
FunctionAlias: AlertsUba
FunctionQuery: |
  let Alerts_Uda_view = view (){
      alertsubadata_CL
          | extend 
              Category = column_ifexists('Category', ''),
              Computer = column_ifexists('Computer', ''),
              MG = column_ifexists('MG', ''),
              ManagementGroupName = column_ifexists('ManagementGroupName', ''),
              RawData = column_ifexists('RawData', ''),
              SourceSystem = column_ifexists('SourceSystem', ''),
              TenantId = column_ifexists('TenantId', ''),
              TimeGenerated  = column_ifexists('TimeGenerated', ''),
              Type = column_ifexists('Type', ''),
              _ResourceId = column_ifexists('_ResourceId', ''),
              TssScan = column_ifexists('TSS_scan_s', ''),
              AccountType = column_ifexists('AccountType_s', ''),
              UserSPACEId = column_ifexists('User_SPACE_Id_s', ''),
              UserSPACEName = column_ifexists('User_SPACE_Name_s', ''),
              Id = column_ifexists('_id_s', ''),
              AccessMethod = column_ifexists('access_method_s', ''),
              Acked = column_ifexists('acked_s', ''),
              ActUser = column_ifexists('act_user_s', ''),
              Action = column_ifexists('action_s', ''),
              Activity = column_ifexists('activity_s', ''),
              ActivityStatus = column_ifexists('activity_status_s', ''),
              AlertId = column_ifexists('alert_id_g', ''),
              AlertName = column_ifexists('alert_name_s', ''),
              Alert = column_ifexists('alert_s', ''),
              AlertType = column_ifexists('alert_type_s', ''),
              AllPolicyMatches = column_ifexists('all_policy_matches_s', ''),
              AnomalyType = column_ifexists('anomaly_type_s', ''),
              AppActivity = column_ifexists('app_activity_s', ''),
              AppCategory_ = column_ifexists('app_category_s', ''),
              App = column_ifexists('app_s', ''),
              AppSessionId = column_ifexists('app_session_id_d', ''),
              AppCategory = column_ifexists('appcategory_s', ''),
              AppSuite = column_ifexists('appsuite_s', ''),
              AuditCategory = column_ifexists('audit_category_s', ''),
              AuditType = column_ifexists('audit_type_s', ''),
              BinTimestamp = column_ifexists('bin_timestamp_d', ''),
              Browser = column_ifexists('browser_s', ''),
              BrowserSessionId = column_ifexists('browser_session_id_d', ''),
              BrowserVersion = column_ifexists('browser_version_s', ''),
              CCI = column_ifexists('cci_d', ''),
              CCL = column_ifexists('ccl_s', ''),
              ConnectionId = column_ifexists('connection_id_d', ''),
              Count = column_ifexists('count_d', ''),
              CreatedTime = column_ifexists('createdTime_s', ''),
              DeviceClassification = column_ifexists('device_classification_s', ''),
              Device = column_ifexists('device_s', ''),
              DisplayName = column_ifexists('displayName_s', ''),
              DistinguishedName = column_ifexists('distinguishedName_s', ''),
              Division = column_ifexists('division_s', ''),
              DownloadApp = column_ifexists('download_app_s', ''),
              DestinationCountry = column_ifexists('dst_country_s', ''),
              DestinationGeoipSource = column_ifexists('dst_geoip_src_d', ''),
              DestinationLatitude = column_ifexists('dst_latitude_d', ''),
              DestinationLocation = column_ifexists('dst_location_s', ''),
              DestinationLongitude = column_ifexists('dst_longitude_d', ''),
              DestinationRegion = column_ifexists('dst_region_s', ''),
              DestinationTimezone = column_ifexists('dst_timezone_s', ''),
              DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
              DestinationIp = column_ifexists('dstip_s', ''),
              EmployeeType = column_ifexists('employeeType_s', ''),
              EventType = column_ifexists('event_type_s', ''),
              EventSourceChannel = column_ifexists('evt_src_chnl_s', ''),
              FileCategory = column_ifexists('file_category_s', ''),
              FileSize = column_ifexists('file_size_d', ''),
              FileType = column_ifexists('file_type_s', ''),
              FromUserCategory = column_ifexists('from_user_category_s', ''),
              FromUser = column_ifexists('from_user_s', ''),
              Group = column_ifexists('group_s', ''),
              HostName = column_ifexists('hostname_s', ''),
              IncidentId = column_ifexists('incident_id_d', ''),
              InstanceId = column_ifexists('instance_id_s', ''),
              LastApp = column_ifexists('last_app_s', ''),
              LastCountry = column_ifexists('last_country_s', ''),
              LastDevice = column_ifexists('last_device_s', ''),
              LastLocation = column_ifexists('last_location_s', ''),
              LastRegion = column_ifexists('last_region_s', ''),
              LastTimestamp = column_ifexists('last_timestamp_d', ''),
              LoginType = column_ifexists('logintype_s', ''),
              LoginUrl = column_ifexists('loginurl_s', ''),
              Mail = column_ifexists('mail_s', ''),
              ManagedApp = column_ifexists('managed_app_s', ''),
              ManagementId = column_ifexists('managementID_s', ''),
              Manager = column_ifexists('manager_s', ''),
              Md5 = column_ifexists('md5_g', ''),
              NetskopeActivity = column_ifexists('netskope_activity_s', ''),
              ObjectCount = column_ifexists('object_count_d', ''),
              ObjectId = column_ifexists('object_id_g', ''),
              Object = column_ifexists('object_s', ''),
              ObjectType = column_ifexists('object_type_s', ''),
              OrganizationUnit = column_ifexists('organization_unit_s', ''),
              OS = column_ifexists('os_s', ''),
              OsVersion = column_ifexists('os_version_s', ''),
              Page = column_ifexists('page_s', ''),
              PageSite = column_ifexists('page_site_s', ''),
              ParentId = column_ifexists('parent_id_s', ''),
              PolicyActions = column_ifexists('policy_actions_s', ''),
              PolicyId = column_ifexists('policy_id_s', ''),
              PolicyName = column_ifexists('policy_name_s', ''),
              Policy = column_ifexists('policy_s', ''),
              ProfileId = column_ifexists('profile_id_s', ''),
              Protocol = column_ifexists('protocol_s', ''),
              Referer = column_ifexists('referer_s', ''),
              RequestId = column_ifexists('request_id_d', ''),
              RiskLevelId = column_ifexists('risk_level_id_d', ''),
              RiskLevel = column_ifexists('risk_level_s', ''),
              SAMAccountName = column_ifexists('sAMAccountName_s', ''),
              SanctionedInstance = column_ifexists('sanctioned_instance_s', ''),
              Scopes = column_ifexists('scopes_s', ''),
              Score = column_ifexists('score_s', ''),
              Severity = column_ifexists('severity_s', ''),
              SharedCredentialUser = column_ifexists('shared_credential_user_s', ''),
              Site = column_ifexists('site_s', ''),
              SourceCountry = column_ifexists('src_country_s', ''),
              SourceGeoIpSrc = column_ifexists('src_geoip_src_d', ''),
              SourceLatitude = column_ifexists('src_latitude_d', ''),
              SourceLocation = column_ifexists('src_location_s', ''),
              SourceLongitude = column_ifexists('src_longitude_d', ''),
              SourceRegion = column_ifexists('src_region_s', ''),
              SourceTime = column_ifexists('src_time_s', ''),
              SourceTimezone = column_ifexists('src_timezone_s', ''),
              SourceZipcode = column_ifexists('src_zipcode_s', ''),
              SourceIp = column_ifexists('srcip_s', ''),
              SuppressionEndTime = column_ifexists('suppression_end_time_d', ''),
              SuppressionStartTime = column_ifexists('suppression_start_time_d', ''),
              Surhn = column_ifexists('surhn_s', ''),
              TelemetryApp = column_ifexists('telemetry_app_s', ''),
              Threshold = column_ifexists('threshold_d', ''),
              ThresholdTime = column_ifexists('threshold_time_d', ''),
              Timestamp = column_ifexists('timestamp_d', ''),
              ToObject = column_ifexists('to_object_s', ''),
              ToUserCategory = column_ifexists('to_user_category_s', ''),
              ToUser = column_ifexists('to_user_s', ''),
              TrafficType = column_ifexists('traffic_type_s', ''),
              TransactionId = column_ifexists('transaction_id_d', ''),
              TssFailReason = column_ifexists('tss_fail_reason_s', ''),
              TssMode = column_ifexists('tss_mode_s', ''),
              TssScanFailed = column_ifexists('tss_scan_failed_s', ''),
              TwoFactorAuth = column_ifexists('two_factor_auth_s', ''),
              PolicyType = column_ifexists('type_s', ''),
              UbaAp1 = column_ifexists('uba_ap1_s', ''),
              UbaAp2 = column_ifexists('uba_ap2_s', ''),
              UbaInst1 = column_ifexists('uba_inst1_s', ''),
              UbaInst2 = column_ifexists('uba_inst2_s', ''),
              UrNormalized = column_ifexists('ur_normalized_s', ''),
              Url = column_ifexists('url_s', ''),
              UserPrincipalName = column_ifexists('userPrincipalName_s', ''),
              UserCountry = column_ifexists('user_category_s', ''),
              UserId = column_ifexists('user_id_s', ''),
              UserName = column_ifexists('user_name_s', ''),
              UserRole = column_ifexists('user_role_s', ''),
              User = column_ifexists('user_s', ''),
              Useragent = column_ifexists('useragent_s', ''),
              UserIp = column_ifexists('userip_s', ''),
              Userkey = column_ifexists('userkey_s', ''),
              WebUniversalConnector = column_ifexists('web_universal_connector_s', ''),
              WindowId = column_ifexists('windowId_d', '') 
          | project Category,
              Computer,
              MG,
              ManagementGroupName,
              RawData,
              SourceSystem,
              TenantId,
              TimeGenerated,
              Type,
              _ResourceId,
              TssScan,
              AccountType,
              UserSPACEId,
              UserSPACEName,
              Id,
              AccessMethod,
              Acked,
              ActUser,
              Action,
              Activity,
              ActivityStatus,
              AlertId,
              AlertName,
              Alert,
              AlertType,
              AllPolicyMatches,
              AnomalyType,
              AppActivity,
              AppCategory_,
              App,
              AppSessionId,
              AppCategory,
              AppSuite,
              AuditCategory,
              AuditType,
              BinTimestamp,
              Browser,
              BrowserSessionId,
              BrowserVersion,
              CCI,
              CCL,
              ConnectionId,
              Count,
              CreatedTime,
              DeviceClassification,
              Device,
              DisplayName,
              DistinguishedName,
              Division,
              DownloadApp,
              DestinationCountry,
              DestinationGeoipSource,
              DestinationLatitude,
              DestinationLocation,
              DestinationLongitude,
              DestinationRegion,
              DestinationTimezone,
              DestinationZipcode,
              DestinationIp,
              EmployeeType,
              EventType,
              EventSourceChannel,
              FileCategory,
              FileSize,
              FileType,
              FromUserCategory,
              FromUser,
              Group,
              HostName,
              IncidentId,
              InstanceId,
              LastApp,
              LastCountry,
              LastDevice,
              LastLocation,
              LastRegion,
              LastTimestamp,
              LoginType,
              LoginUrl,
              Mail,
              ManagedApp,
              ManagementId,
              Manager,
              Md5,
              NetskopeActivity,
              ObjectCount,
              ObjectId,
              Object,
              ObjectType,
              OrganizationUnit,
              OS,
              OsVersion,
              Page,
              PageSite,
              ParentId,
              PolicyActions,
              PolicyId,
              PolicyName,
              Policy,
              ProfileId,
              Protocol,
              Referer,
              RequestId,
              RiskLevelId,
              RiskLevel,
              SAMAccountName,
              SanctionedInstance,
              Scopes,
              Score,
              Severity,
              SharedCredentialUser,
              Site,
              SourceCountry,
              SourceGeoIpSrc,
              SourceLatitude,
              SourceLocation,
              SourceLongitude,
              SourceRegion,
              SourceTime,
              SourceTimezone,
              SourceZipcode,
              SourceIp,
              SuppressionEndTime,
              SuppressionStartTime,
              Surhn,
              TelemetryApp,
              Threshold,
              ThresholdTime,
              Timestamp,
              ToObject,
              ToUserCategory,
              ToUser,
              TrafficType,
              TransactionId,
              TssFailReason,
              TssMode,
              TssScanFailed,
              TwoFactorAuth,
              PolicyType,
              UbaAp1,
              UbaAp2,
              UbaInst1,
              UbaInst2,
              UrNormalized,
              Url,
              UserPrincipalName,
              UserCountry,
              UserId,
              UserName,
              UserRole,
              User,
              Useragent,
              UserIp,
              Userkey,
              WebUniversalConnector,
              WindowId
  };
  Alerts_Uda_view