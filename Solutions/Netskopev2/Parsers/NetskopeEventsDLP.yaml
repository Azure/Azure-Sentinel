id: 319ce7ff-31c8-4435-bea3-7adbb5e33281
Function:
  Title: Parser for Netskope Events DLP
  Version: "1.0.0"
  LastUpdated: "2025-08-06"
Category: Microsoft Sentinel Parser
FunctionName: NetskopeEventsDLP
FunctionAlias: NetskopeEventsDLP
FunctionQuery: |
  let dummy_table = datatable(TimeGenerated: datetime) [];
    let NetskopeEventsDLP = view() {
    union isfuzzy=true dummy_table, NetskopeEventsDLP_CL
    | extend 
        TimeGenerated = column_ifexists('TimeGenerated', ''),
        Title = column_ifexists('title_s', ''),
        Object = column_ifexists('object', ''),
        App = column_ifexists('app', ''),
        Site = column_ifexists('site', ''),
        Status = column_ifexists('status', ''),
        Assignee = column_ifexists('assignee', ''),
        Severity = column_ifexists('severity', ''),
        InstanceId = column_ifexists('instance_id', ''),
        Timestamp = column_ifexists('timestamp', ''),
        Exposure = column_ifexists('exposure', ''),
        ActingUser = column_ifexists('acting_user', ''),
        User = column_ifexists('user', ''),
        FilePath = column_ifexists('file_path', ''),
        FileSize = column_ifexists('file_size', ''),
        FileType = column_ifexists('file_type', ''),
        DlpMatchInfo = column_ifexists('dlp_match_info', ''),
        InlineDlpMatchInfo = column_ifexists('inline_dlp_match_info', ''),
        AccessMethod = column_ifexists('access_method', ''),
        Activity = column_ifexists('activity', ''),
        Instance = column_ifexists('instance', ''),
        Url = column_ifexists('url', ''),
        ObjectType = column_ifexists('object_type', ''),
        Owner = column_ifexists('owner', ''),
        OwnerPdl = column_ifexists('owner_pdl', ''),
        FileLang = column_ifexists('file_lang', ''),
        TrueObjCategory = column_ifexists('true_obj_category', ''),
        TrueObjType = column_ifexists('true_obj_type', ''),
        DlpIncidentId = column_ifexists('dlp_incidentid', ''),
        LatestIncidentId = column_ifexists('latest_incidentid', ''),
        DlpParentId = column_ifexists('dlp_parentid', ''),
        FromUser = column_ifexists('from_user', ''),
        Md5 = column_ifexists('md5', ''),
        ConnectionId = column_ifexists('connectionid', ''),
        AppSessionId = column_ifexists('app_sessionid', ''),
        Referer = column_ifexists('referer', ''),
        DstLocation = column_ifexists('dst_location', ''),
        SrcLocation = column_ifexists('src_location', ''),
        Channel = column_ifexists('channel', ''),
        ToUser = column_ifexists('to_user', ''),
        Cc = column_ifexists('cc', ''),
        Bcc = column_ifexists('bcc', ''),
        Classification = column_ifexists('classification', ''),
        UserId = column_ifexists('user_id', ''),
        DestinationApp = column_ifexists('destination_app', ''),
        DestinationInstanceId = column_ifexists('destination_instance_id', ''),
        ZipFileId = column_ifexists('zip_file_id', ''),
        OriginalFileSnapshotId = column_ifexists('original_file_snapshot_id', ''),
        DlpFile = column_ifexists('dlp_file', '')
    | project 
        TimeGenerated,
        Title,
        Object,
        App,
        Site,
        Status,
        Assignee,
        Severity,
        InstanceId,
        Timestamp,
        Exposure,
        ActingUser,
        User,
        FilePath,
        FileSize,
        FileType,
        DlpMatchInfo,
        InlineDlpMatchInfo,
        AccessMethod,
        Activity,
        Instance,
        Url,
        ObjectType,
        Owner,
        OwnerPdl,
        FileLang,
        TrueObjCategory,
        TrueObjType,
        DlpIncidentId,
        LatestIncidentId,
        DlpParentId,
        FromUser,
        Md5,
        ConnectionId,
        AppSessionId,
        Referer,
        DstLocation,
        SrcLocation,
        Channel,
        ToUser,
        Cc,
        Bcc,
        Classification,
        UserId,
        DestinationApp,
        DestinationInstanceId,
        ZipFileId,
        OriginalFileSnapshotId,
        DlpFile
    };
    NetskopeEventsDLP
