id: 0b360eb0-224d-4d99-af9b-43b1909ec0f9
Function:
  Title: Parser for EventsNetwork
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: EventsNetwork
FunctionAlias: EventsNetwork
FunctionQuery: |
  let Events_Network_View = view () { 
      eventsnetworkdata_CL
      | extend 
          Category = column_ifexists('Category', ''),
          Computer = column_ifexists('Computer', ''),
          MG = column_ifexists('MG', ''),
          ManagementGroupName = column_ifexists('ManagementGroupName', ''),
          RawData = column_ifexists('RawData', ''),
          SourceSystem = column_ifexists('SourceSystem', ''),
          TenantId = column_ifexists('TenantId', ''),
          TimeGenerated  = column_ifexists('TimeGenerated', ''),
          Type = column_ifexists('Type', ''),
          _ResourceId = column_ifexists('_ResourceId', ''),
          Id = column_ifexists('_id_s', ''),
          AccessMethod = column_ifexists('access_method_s', ''),
          Action = column_ifexists('action_s', ''),
          App = column_ifexists('app_s', ''),
          AppCategory = column_ifexists('appcategory_s', ''),
          CCI = column_ifexists('cci_d', ''),
          CCIString = column_ifexists('cci_s', ''),
          CCL = column_ifexists('ccl_s', ''),
          ClientBytes = column_ifexists('client_bytes_d', ''),
          ClientPackets = column_ifexists('client_packets_d', ''),
          Count = column_ifexists('count_d', ''),
          Device = column_ifexists('device_s', ''),
          Domain = column_ifexists('domain_s', ''),
          DestinationCountry = column_ifexists('dst_country_s', ''),
          DestinationGeoIpSource = column_ifexists('dst_geoip_src_d', ''),
          DestinationLatitude = column_ifexists('dst_latitude_d', ''),
          DestinationLocation = column_ifexists('dst_location_s', ''),
          DestinationLongitude = column_ifexists('dst_longitude_d', ''),
          DestinationRegion = column_ifexists('dst_region_s', ''),
          DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
          DestinationHost = column_ifexists('dsthost_s', ''),
          DestinationIp = column_ifexists('dstip_s', ''),
          DestinationPort = column_ifexists('dstport_d', ''),
          EndTime = column_ifexists('end_time_s', ''),
          FlowStatus = column_ifexists('flow_status_s', ''),
          HostName = column_ifexists('hostname_s', ''),
          IpProtocol = column_ifexists('ip_protocol_s', ''),
          NetworkSessionId = column_ifexists('network_session_id_s', ''),
          NumSessions = column_ifexists('num_sessions_d', ''),
          NumBytes = column_ifexists('numbytes_d', ''),
          OrganizationUnit = column_ifexists('organization_unit_s', ''),
          OS = column_ifexists('os_s', ''),
          OsVersion = column_ifexists('os_version_s', ''),
          Policy = column_ifexists('policy_s', ''),
          PolicyType = column_ifexists('type_s', ''),
          Protocol = column_ifexists('protocol_s', ''),
          ProtocolPort = column_ifexists('protocol_port_s', ''),
          PublisherCn = column_ifexists('publisher_cn_s', ''),
          PublisherName = column_ifexists('publisher_name_s', ''),
          SAMAccountName = column_ifexists('sAMAccountName_s', ''),
          ServerBytes = column_ifexists('server_bytes_d', ''),
          ServerPackets = column_ifexists('server_packets_d', ''),
          SessionDuration = column_ifexists('session_duration_d', ''),
          Site = column_ifexists('site_s', ''),
          SourceCountry = column_ifexists('src_country_s', ''),
          SourceGeoIpSource = column_ifexists('src_geoip_src_d', ''),
          SourceLatitude = column_ifexists('src_latitude_d', ''),
          SourceLocation = column_ifexists('src_location_s', ''),
          SourceLongitude = column_ifexists('src_longitude_d', ''),
          SourceRegion = column_ifexists('src_region_s', ''),
          SourceZipcode = column_ifexists('src_zipcode_s', ''),
          SourceIp = column_ifexists('srcip_s', ''),
          SourcePort = column_ifexists('srcport_d', ''),
          StartTime = column_ifexists('start_time_s', ''),
          Timestamp = column_ifexists('timestamp_d', ''),
          TotalPackets = column_ifexists('total_packets_d', ''),
          TrafficType = column_ifexists('traffic_type_s', ''),
          TunnelId = column_ifexists('tunnel_id_s', ''),
          TunnelType = column_ifexists('tunnel_type_s', ''),
          TunnelUpTime = column_ifexists('tunnel_up_time_d', ''),
          UrNormalized = column_ifexists('ur_normalized_s', ''),
          User = column_ifexists('user_s', ''),
          Userip = column_ifexists('userip_s', ''),
          Userkey = column_ifexists('userkey_s', ''),
          UserPrincipalName = column_ifexists('userPrincipalName_s', '')
      | project 
          Category,
          Computer,
          MG,
          ManagementGroupName,
          RawData,
          SourceSystem,
          TenantId,
          TimeGenerated,
          Type,
          _ResourceId,
          Id,
          AccessMethod,
          Action,
          App,
          AppCategory,
          CCI,
          CCIString,
          CCL,
          ClientBytes,
          ClientPackets,
          Count,
          Device,
          Domain,
          DestinationCountry,
          DestinationGeoIpSource,
          DestinationLatitude,
          DestinationLocation,
          DestinationLongitude,
          DestinationRegion,
          DestinationZipcode,
          DestinationHost,
          DestinationIp,
          DestinationPort,
          EndTime,
          FlowStatus,
          HostName,
          IpProtocol,
          NetworkSessionId,
          NumSessions,
          NumBytes,
          OrganizationUnit,
          OS,
          OsVersion,
          Policy,
          PolicyType,
          Protocol,
          ProtocolPort,
          PublisherCn,
          PublisherName,
          SAMAccountName,
          ServerBytes,
          ServerPackets,
          SessionDuration,
          Site,
          SourceCountry,
          SourceGeoIpSource,
          SourceLatitude,
          SourceLocation,
          SourceLongitude,
          SourceRegion,
          SourceZipcode,
          SourceIp,
          SourcePort,
          StartTime,
          Timestamp,
          TotalPackets,
          TrafficType,
          TunnelId,
          TunnelType,
          TunnelUpTime,
          UrNormalized,
          User,
          Userip,
          Userkey,
          UserPrincipalName
  };
  Events_Network_View