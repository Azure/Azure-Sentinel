id: 669e29da-9d79-4d40-b4f4-c051a5652b30
Function:
  Title: Parser for EventsConnection
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: EventsConnection
FunctionAlias: EventsConnection
FunctionQuery: |
  let Events_Connection_view = view(){
  eventsconnectiondata_CL
  | extend Category = column_ifexists('Category', ''),
          Type = column_ifexists('Type', ''),
          _ResourceId = column_ifexists('_ResourceId', ''),
          TenantId = column_ifexists('TenantId', ''),
          SourceSystem = column_ifexists('SourceSystem', ''),
          MG = column_ifexists('MG', ''),
          ManagementGroupName = column_ifexists('ManagementGroupName', ''),
          TimeGenerated = column_ifexists('TimeGenerated [UTC]', ''),
          Computer = column_ifexists('Computer', ''),
          RawData = column_ifexists('RawData', ''),
          SuppressionEndTime = column_ifexists('suppression_end_time_d', ''),
          SuppressionStartTime = column_ifexists('suppression_start_time_d', ''),
          Id = column_ifexists('_id_s', ''),
          AccessMethod = column_ifexists('access_method_s', ''),
          App = column_ifexists('app_s', ''),
          AppCategory = column_ifexists('appcategory_s', ''),
          BypassReason = column_ifexists('bypass_reason_s', ''),
          BypassTraffic = column_ifexists('bypass_traffic_s', ''),
          CCI = column_ifexists('cci_d', ''),
          CCL = column_ifexists('ccl_s', ''),
          ConnectionId = column_ifexists('connection_id_d', ''),
          Count = column_ifexists('count_d', ''),
          Domain = column_ifexists('domain_s', ''),
          DestinationCountry = column_ifexists('dst_country_s', ''),
          DestinationLatitude = column_ifexists('dst_latitude_d', ''),
          DestinationLocation = column_ifexists('dst_location_s', ''),
          DestinationLongitude = column_ifexists('dst_longitude_d', ''),
          DestinationRegion = column_ifexists('dst_region_s', ''),
          DestinationTimezone = column_ifexists('dst_timezone_s', ''),
          DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
          DestinationIp = column_ifexists('dstip_s', ''),
          DestinationPort = column_ifexists('dstport_d', ''),
          IncidentId = column_ifexists('incident_id_d', ''),
          NetskopePop = column_ifexists('netskope_pop_s', ''),
          OrganizationUnit = column_ifexists('organization_unit_s', ''),
          OtherCategories = column_ifexists('other_categories_s', ''),
          Page = column_ifexists('page_s', ''),
          RequestId = column_ifexists('request_id_d', ''),
          Site = column_ifexists('site_s', ''),
          SourceCountry = column_ifexists('src_country_s', ''),
          SourceLatitude = column_ifexists('src_latitude_d', ''),
          SourceLocation = column_ifexists('src_location_s', ''),
          SourceLongitude = column_ifexists('src_longitude_d', ''),
          SourceRegion = column_ifexists('src_region_s', ''),
          SourceTime = column_ifexists('src_time_s', ''),
          SourceTimezone = column_ifexists('src_timezone_s', ''),
          SourceZipcode = column_ifexists('src_zipcode_s', ''),
          SourceIp = column_ifexists('srcip_s', ''),
          SslDecryptPolicy = column_ifexists('ssl_decrypt_policy_s', ''),
          Timestamp = column_ifexists('timestamp_d', ''),
          TrafficType = column_ifexists('traffic_type_s', ''),
          TransactionId = column_ifexists('transaction_id_d', ''),
          PolicyType = column_ifexists('type_s', ''),
          UrNormalized = column_ifexists('ur_normalized_s', ''),
          Url = column_ifexists('url_s', ''),
          User = column_ifexists('user_s', ''),
          UserGenerated = column_ifexists('user_generated_s', ''),
          UserIp = column_ifexists('userip_s', ''),
          Userkey = column_ifexists('userkey_s', '')
          |project Category,
                  Type,
                  _ResourceId,
                  TenantId,
                  SourceSystem,
                  MG,
                  ManagementGroupName,
                  TimeGenerated,
                  Computer,
                  RawData,
                  SuppressionEndTime,
                  SuppressionStartTime,
                  Id,
                  AccessMethod,
                  App,
                  AppCategory,
                  BypassReason,
                  BypassTraffic,
                  CCI,
                  CCL,
                  ConnectionId,
                  Count,
                  Domain,
                  DestinationCountry,
                  DestinationLatitude,
                  DestinationLocation,
                  DestinationLongitude,
                  DestinationRegion,
                  DestinationTimezone,
                  DestinationZipcode,
                  DestinationIp,
                  DestinationPort,
                  IncidentId,
                  NetskopePop,
                  OrganizationUnit,
                  OtherCategories,
                  Page,
                  RequestId,
                  Site,
                  SourceCountry,
                  SourceLatitude,
                  SourceLocation,
                  SourceLongitude,
                  SourceRegion,
                  SourceTime,
                  SourceTimezone,
                  SourceZipcode,
                  SourceIp,
                  SslDecryptPolicy,
                  Timestamp,
                  TrafficType,
                  TransactionId,
                  PolicyType,
                  UrNormalized,
                  Url,
                  User,
                  UserGenerated,
                  UserIp,
                  Userkey
  };
  Events_Connection_view
