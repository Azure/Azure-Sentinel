id: 44db348f-92f4-4f81-96b9-7d38d9fe2254
Function:
  Title: Parser for AlertsMalware
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: AlertsMalware
FunctionAlias: AlertsMalware
FunctionQuery: |
  let Alerts_Malware_View = view(){
      alertsmalwaredata_CL
      | extend
          Category = column_ifexists('Category', ''),
          Computer = column_ifexists('Computer', ''),
          MG = column_ifexists('MG', ''),
          ManagementGroupName = column_ifexists('ManagementGroupName', ''),
          RawData = column_ifexists('RawData', ''),
          SourceSystem = column_ifexists('SourceSystem', ''),
          TenantId = column_ifexists('TenantId', ''),
          TimeGenerated  = column_ifexists('TimeGenerated', ''),
          Type = column_ifexists('Type', ''),
          _ResourceId = column_ifexists('_ResourceId', ''),
          Id = column_ifexists('_id_s', ''),
          AccessMethod = column_ifexists('access_method_s', ''),
          Acked = column_ifexists('acked_s', ''),
          Action = column_ifexists('action_s', ''),
          Activity = column_ifexists('activity_s', ''),
          AlertName = column_ifexists('alert_name_s', ''),
          Alert = column_ifexists('alert_s', ''),
          AlertType = column_ifexists('alert_type_s', ''),
          AppName = column_ifexists('app_name_s', ''),
          App = column_ifexists('app_s', ''),
          AppSessionId = column_ifexists('app_session_id_d', ''),
          AppCategory = column_ifexists('appcategory_s', ''),
          AppSuite = column_ifexists('appsuite_s', ''),
          Browser = column_ifexists('browser_s', ''),
          BrowserSessionId = column_ifexists('browser_session_id_d', ''),
          BrowserVersion = column_ifexists('browser_version_s', ''),
          CCI = column_ifexists('cci_d', ''),
          CCIString = column_ifexists('cci_s', ''),
          CCL = column_ifexists('ccl_s', ''),
          Company = column_ifexists('company_s', ''),
          ConnectionId = column_ifexists('connection_id_d', ''),
          Count = column_ifexists('count_d', ''),
          CreatedDate = column_ifexists('created_date_d', ''),
          Department = column_ifexists('department_s', ''),
          DetectionEngine = column_ifexists('detection_engine_s', ''),
          DetectionType = column_ifexists('detection_type_s', ''),
          DeviceClassification = column_ifexists('device_classification_s', ''),
          Device = column_ifexists('device_s', ''),
          DestinationCountry = column_ifexists('dst_country_s', ''),
          DestinationGeoipSource = column_ifexists('dst_geoip_src_d', ''),
          DestinationLatitude = column_ifexists('dst_latitude_d', ''),
          DestinationLocation = column_ifexists('dst_location_s', ''),
          DestinationLongitude = column_ifexists('dst_longitude_d', ''),
          DestinationRegion = column_ifexists('dst_region_s', ''),
          DestinationTimezone = column_ifexists('dst_timezone_s', ''),
          DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
          DestinationIp = column_ifexists('dstip_s', ''),
          FastscanResults = column_ifexists('fastscan_results_s', ''),
          FileCategory = column_ifexists('file_category_s', ''),
          FileId = column_ifexists('file_id_s', ''),
          FileName1 = column_ifexists('file_name_s', ''),
          FilePath = column_ifexists('file_path_s', ''),
          FileSize = column_ifexists('file_size_d', ''),
          FileType = column_ifexists('file_type_s', ''),
          FileName2 = column_ifexists('filename_s', ''),
          FromUser = column_ifexists('from_user_s', ''),
          HostName = column_ifexists('hostname_s', ''),
          IncidentId = column_ifexists('incident_id_d', ''),
          InstanceId = column_ifexists('instance_id_s', ''),
          Instance = column_ifexists('instance_s', ''),
          LocalMd5 = column_ifexists('local_md5_s', ''),
          LocalSha256 = column_ifexists('local_sha256_s', ''),
          MalwareId = column_ifexists('malware_id_s', ''),
          MalwareName = column_ifexists('malware_name_s', ''),
          MalwareProfile = column_ifexists('malware_profile_s', ''),
          MalwareSeverity = column_ifexists('malware_severity_s', ''),
          MalwareType = column_ifexists('malware_type_s', ''),
          ManagedApp = column_ifexists('managed_app_s', ''),
          ManagementId = column_ifexists('managementID_s', ''),
          Manager = column_ifexists('manager_s', ''),
          Md5 = column_ifexists('md5_g', ''),
          MimeType = column_ifexists('mime_type_s', ''),
          MlDetection = column_ifexists('ml_detection_s', ''),
          ModifiedDate = column_ifexists('modified_date_d', ''),
          Nsdeviceuid = column_ifexists('nsdeviceuid_s', ''),
          ObjectId = column_ifexists('object_id_s', ''),
          Object = column_ifexists('object_s', ''),
          ObjectType = column_ifexists('object_type_s', ''),
          OrganizationUnit = column_ifexists('organization_unit_s', ''),
          OS = column_ifexists('os_s', ''),
          OsVersion = column_ifexists('os_version_s', ''),
          Page = column_ifexists('page_s', ''),
          PageSite = column_ifexists('page_site_s', ''),
          ParentId = column_ifexists('parent_id_s', ''),
          PolicyId = column_ifexists('policy_id_s', ''),
          Policy = column_ifexists('policy_s', ''),
          Protocol = column_ifexists('protocol_s', ''),
          Referer = column_ifexists('referer_s', ''),
          RequestId = column_ifexists('request_id_s', ''),
          SanctionedInstance = column_ifexists('sanctioned_instance_s', ''),
          ScanTime = column_ifexists('scan_time_d', ''),
          ScanType = column_ifexists('scan_type_s', ''),
          ScannerResult = column_ifexists('scanner_result_s', ''),
          SeverityId = column_ifexists('severity_id_d', ''),
          Severity = column_ifexists('severity_s', ''),
          SHA1 = column_ifexists('sha1_s', ''),
          SharedType = column_ifexists('shared_type_s', ''),
          SharedWith = column_ifexists('shared_with_s', ''),
          Site = column_ifexists('site_s', ''),
          SourceCountry = column_ifexists('src_country_s', ''),
          SourceGeoIpSrc = column_ifexists('src_geoip_src_d', ''),
          SourceLatitude = column_ifexists('src_latitude_d', ''),
          SourceLocation = column_ifexists('src_location_s', ''),
          SourceLongitude = column_ifexists('src_longitude_d', ''),
          SourceRegion = column_ifexists('src_region_s', ''),
          SourceTime = column_ifexists('src_time_s', ''),
          SourceTimezone = column_ifexists('src_timezone_s', ''),
          SourceZipcode = column_ifexists('src_zipcode_s', ''),
          SourceIp = column_ifexists('srcip_s', ''),
          Timestamp = column_ifexists('timestamp_d', ''),
          Title = column_ifexists('title_s', ''),
          TrafficType = column_ifexists('traffic_type_s', ''),
          TransactionId = column_ifexists('transaction_id_d', ''),
          TrueFileType = column_ifexists('true_filetype_s', ''),
          TssLicense = column_ifexists('tss_license_s', ''),
          TssMode = column_ifexists('tss_mode_s', ''),
          TssScan = column_ifexists('TSS_scan_s', ''),
          PolicyType = column_ifexists('type_s', ''),
          UrNormalized = column_ifexists('ur_normalized_s', ''),
          Url = column_ifexists('url_s', ''),
          UserCountry = column_ifexists('userCountry_s', ''),
          UserPrincipalName = column_ifexists('userPrincipalName_s', ''),
          UserId = column_ifexists('user_id_s', ''),
          User = column_ifexists('user_s', ''),
          UserIp = column_ifexists('userip_s', ''),
          UsrDisplayName = column_ifexists('usr_display_name_s', ''),
          usrStatus = column_ifexists('usr_status_s', ''),
          usrTitle = column_ifexists('usr_title_s', ''),
          UsrUdfBusinessSegmentLevel1 = column_ifexists('usr_udf_businesssegmentlevel1_s', ''),
          UsrUdfBusinessSegmentLevel2 = column_ifexists('usr_udf_businesssegmentlevel2_s', ''),
          UsrUdfBusinessSegmentLevel3 = column_ifexists('usr_udf_businesssegmentlevel3_s', ''),
          UsrUdfBusinessSegmentLevel4 = column_ifexists('usr_udf_businesssegmentlevel4_s', ''),
          UsrUdfCompanyName = column_ifexists('usr_udf_companyname_s', ''),
          UsrUdfEmployeeId = column_ifexists('usr_udf_employeeid_s', ''),
          UsrUdfPrimaryDomain = column_ifexists('usr_udf_primarydomain_s', ''),
          UsrUdfSupervisorId = column_ifexists('usr_udf_supervisorid_s', ''),
          UsrUdfSupervisorName = column_ifexists('usr_udf_supervisorname_s', '')
      | project 
          Category,
          Computer,
          MG,
          ManagementGroupName,
          RawData,
          SourceSystem,
          TenantId,
          TimeGenerated,
          Type,
          _ResourceId,
          Id,
          AccessMethod,
          Acked,
          Action,
          Activity,
          AlertName,
          Alert,
          AlertType,
          AppName,
          App,
          AppSessionId,
          AppCategory,
          AppSuite,
          Browser,
          BrowserSessionId,
          BrowserVersion,
          CCI,
          CCIString,
          CCL,
          Company,
          ConnectionId,
          Count,
          CreatedDate,
          Department,
          DetectionEngine,
          DetectionType,
          DeviceClassification,
          Device,
          DestinationCountry,
          DestinationGeoipSource,
          DestinationLatitude,
          DestinationLocation,
          DestinationLongitude,
          DestinationRegion,
          DestinationTimezone,
          DestinationZipcode,
          DestinationIp,
          FastscanResults,
          FileCategory,
          FileId,
          FileName1,
          FilePath,
          FileSize,
          FileType,
          FileName2,
          FromUser,
          HostName,
          IncidentId,
          InstanceId,
          Instance,
          LocalMd5,
          LocalSha256,
          MalwareId,
          MalwareName,
          MalwareProfile,
          MalwareSeverity,
          MalwareType,
          ManagedApp,
          ManagementId,
          Manager,
          Md5,
          MimeType,
          MlDetection,
          ModifiedDate,
          Nsdeviceuid,
          ObjectId,
          Object,
          ObjectType,
          OrganizationUnit,
          OS,
          OsVersion,
          Page,
          PageSite,
          ParentId,
          PolicyId,
          Policy,
          Protocol,
          Referer,
          RequestId,
          SanctionedInstance,
          ScanTime,
          ScanType,
          ScannerResult,
          SeverityId,
          Severity,
          SHA1,
          SharedType,
          SharedWith,
          Site,
          SourceCountry,
          SourceGeoIpSrc,
          SourceLatitude,
          SourceLocation,
          SourceLongitude,
          SourceRegion,
          SourceTime,
          SourceTimezone,
          SourceZipcode,
          SourceIp,
          Timestamp,
          Title,
          TrafficType,
          TransactionId,
          TrueFileType,
          TssLicense,
          TssMode,
          TssScan,
          PolicyType,
          UrNormalized,
          Url,
          UserCountry,
          UserPrincipalName,
          UserId,
          User,
          UserIp,
          UsrDisplayName,
          usrStatus,
          usrTitle,
          UsrUdfBusinessSegmentLevel1,
          UsrUdfBusinessSegmentLevel2,
          UsrUdfBusinessSegmentLevel3,
          UsrUdfBusinessSegmentLevel4,
          UsrUdfCompanyName,
          UsrUdfEmployeeId,
          UsrUdfPrimaryDomain,
          UsrUdfSupervisorId,
          UsrUdfSupervisorName        
  };
  Alerts_Malware_View