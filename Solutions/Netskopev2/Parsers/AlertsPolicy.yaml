id: f5604faf-5b55-40ff-b8c2-caa207124664
Function:
  Title: Parser for AlertsPolicy
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: AlertsPolicy
FunctionAlias: AlertsPolicy
FunctionQuery: |
  let Alerts_Policy_View = view () {
      alertspolicydata_CL
      | extend 
          Category = column_ifexists('Category', ''),
          Computer = column_ifexists('Computer', ''),
          MG = column_ifexists('MG', ''),
          ManagementGroupName = column_ifexists('ManagementGroupName', ''),
          RawData = column_ifexists('RawData', ''),
          SourceSystem = column_ifexists('SourceSystem', ''),
          TenantId = column_ifexists('TenantId', ''),
          TimeGenerated  = column_ifexists('TimeGenerated', ''),
          Type = column_ifexists('Type', ''),
          _ResourceId = column_ifexists('_ResourceId', ''),
          Id = column_ifexists('_id_s', ''),
          AccessMethod = column_ifexists('access_method_s', ''),
          Acked = column_ifexists('acked_s', ''),
          ActUser = column_ifexists('act_user_s', ''),
          Action = column_ifexists('action_s', ''),
          Activity = column_ifexists('activity_s', ''),
          ActivityStatus = column_ifexists('activity_status_s', ''),
          ActivityType = column_ifexists('activity_type_s', ''),
          AggregatedUser = column_ifexists('aggregated_user_s', ''),
          Alert = column_ifexists('alert_s', ''),
          AlertName = column_ifexists('alert_name_s', ''),
          AlertType = column_ifexists('alert_type_s', ''),
          AllPolicyMatches = column_ifexists('all_policy_matches_s', ''),
          App = column_ifexists('app_s', ''),
          AppActivity = column_ifexists('app_activity_s', ''),
          AppScopes = column_ifexists('app_scopes_s', ''),
          AppSessionId = column_ifexists('app_session_id_d', ''),
          AppCategory = column_ifexists('appcategory_s', ''),
          AppSuite = column_ifexists('appsuite_s', ''),
          BCC = column_ifexists('bcc_s', ''),
          Browser = column_ifexists('browser_s', ''),
          BrowserSessionId = column_ifexists('browser_session_id_d', ''),
          BrowserVersion = column_ifexists('browser_version_s', ''),
          CC = column_ifexists('cc_s', ''),
          CCI = column_ifexists('cci_d', ''),
          CCIString = column_ifexists('cci_s', ''),
          CCL = column_ifexists('ccl_s', ''),
          ClientBytes = column_ifexists('client_bytes_d', ''),
          ClientPackets = column_ifexists('client_packets_d', ''),
          ConnDuration = column_ifexists('conn_duration_d', ''),
          ConnectionId = column_ifexists('connection_id_d', ''),
          Count = column_ifexists('count_d', ''),
          CustomConnector = column_ifexists('custom_connector_s', ''),
          DataType = column_ifexists('data_type_s', ''),
          Device = column_ifexists('device_s', ''),
          DeviceClassification = column_ifexists('device_classification_s', ''),
          DisplayName = column_ifexists('displayName_s', ''),
          DistinguishedName = column_ifexists('distinguishedName_s', ''),
          Division = column_ifexists('division_s', ''),
          DlpFailReason = column_ifexists('dlp_fail_reason_s', ''),
          DlpProfile = column_ifexists('dlp_profile_s', ''),
          DlpScanFailed = column_ifexists('dlp_scan_failed_s', ''),
          DestinationCountry = column_ifexists('dst_country_s', ''),
          DestinationGeoIpSource = column_ifexists('dst_geoip_src_d', ''),
          DestinationLatitude = column_ifexists('dst_latitude_d', ''),
          DestinationLocation = column_ifexists('dst_location_s', ''),
          DestinationLongitude = column_ifexists('dst_longitude_d', ''),
          DestinationRegion = column_ifexists('dst_region_s', ''),
          DestinationTimezone = column_ifexists('dst_timezone_s', ''),
          DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
          DestinationHost = column_ifexists('dsthost_s', ''),
          DestinationIp = column_ifexists('dstip_s', ''),
          DestinationPort = column_ifexists('dstport_d', ''),
          DynamicClassification = column_ifexists('dynamic_classification_s', ''),
          EncryptFailure = column_ifexists('encrypt_failure_s', ''),
          EndTime = column_ifexists('end_time_s', ''),
          EventType = column_ifexists('event_type_s', ''),
          Exposure = column_ifexists('exposure_s', ''),
          ExternalCollaboratorCount = column_ifexists('external_collaborator_count_d', ''),
          FileCategory = column_ifexists('file_category_s', ''),
          FileId = column_ifexists('file_id_s', ''),
          FilePath = column_ifexists('file_path_s', ''),
          FileSize = column_ifexists('file_size_d', ''),
          FileType = column_ifexists('file_type_s', ''),
          ForwardToProxyXau = column_ifexists('forward_to_proxy_xau_s', ''),
          FromObject = column_ifexists('from_object_s', ''),
          FromStorage = column_ifexists('from_storage_s', ''),
          FromUser = column_ifexists('from_user_s', ''),
          Gateway = column_ifexists('gateway_s', ''),
          Group = column_ifexists('group_s', ''),
          Hostname = column_ifexists('hostname_s', ''),
          HttpStatus = column_ifexists('http_status_s', ''),
          IncidentId = column_ifexists('incident_id_d', ''),
          Instance = column_ifexists('instance_s', ''),
          InstanceId = column_ifexists('instance_id_s', ''),
          InternalCollaboratorCount = column_ifexists('internal_collaborator_count_d', ''),
          IpProtocol = column_ifexists('ip_protocol_s', ''),
          JustificationReason = column_ifexists('justification_reason_s', ''),
          JustificationType = column_ifexists('justification_type_s', ''),
          LastName = column_ifexists('last_name_s', ''),
          LogFileName = column_ifexists('log_file_name_s', ''),
          Mail = column_ifexists('mail_s', ''),
          Malicious = column_ifexists('malicious_s', ''),
          MalsiteCategory = column_ifexists('malsite_category_s', ''),
          MalwareId = column_ifexists('malware_id_s', ''),
          MalwareName = column_ifexists('malware_name_s', ''),
          MalwareSeverity = column_ifexists('malware_severity_s', ''),
          MalwareType = column_ifexists('malware_type_s', ''),
          ManagedApp = column_ifexists('managed_app_s', ''),
          ManagementId = column_ifexists('managementID_s', ''),
          Manager = column_ifexists('manager_s', ''),
          Md5 = column_ifexists('md5_g', ''),
          MemberOf = column_ifexists('memberOf_s', ''),
          MessageId = column_ifexists('message_id_s', ''),
          MessageSize = column_ifexists('message_size_d', ''),
          MimeType = column_ifexists('mime_type_s', ''),
          Modified = column_ifexists('modified_d', ''),
          Network = column_ifexists('network_s', ''),
          NetworkSessionId = column_ifexists('network_session_id_s', ''),
          NotifyTemplate = column_ifexists('notify_template_s', ''),
          Nsdeviceuid = column_ifexists('nsdeviceuid_s', ''),
          NumSessions = column_ifexists('num_sessions_d', ''),
          NumBytes = column_ifexists('numbytes_d', ''),
          Object = column_ifexists('object_s', ''),
          ObjectCount = column_ifexists('object_count_d', ''),
          ObjectId = column_ifexists('object_id_s', ''),
          ObjectType = column_ifexists('object_type_s', ''),
          Org = column_ifexists('org_s', ''),
          OrganizationUnit = column_ifexists('organization_unit_s', ''),
          OrignalFilePath = column_ifexists('orignal_file_path_s', ''),
          OS = column_ifexists('os_s', ''),
          OsVersion = column_ifexists('os_version_s', ''),
          OtherCategories = column_ifexists('other_categories_s', ''),
          Owner = column_ifexists('owner_s', ''),
          Page = column_ifexists('page_s', ''),
          PageSite = column_ifexists('page_site_s', ''),
          ParentId = column_ifexists('parent_id_s', ''),
          Policy = column_ifexists('policy_s', ''),
          PolicyId = column_ifexists('policy_id_s', ''),
          PolicyType = column_ifexists('type_s', ''),
          ProfileEmails = column_ifexists('profile_emails_s', ''),
          Protocol = column_ifexists('protocol_s', ''),
          ProtocolPort = column_ifexists('protocol_port_s', ''),
          PublisherCn = column_ifexists('publisher_cn_s', ''),
          PublisherName = column_ifexists('publisher_name_s', ''),
          QAdmin = column_ifexists('q_admin_s', ''),
          QApp = column_ifexists('q_app_s', ''),
          QInstance = column_ifexists('q_instance_s', ''),
          QOriginalFilename = column_ifexists('q_original_filename_s', ''),
          QOriginalFilepath = column_ifexists('q_original_filepath_s', ''),
          QOriginalShared = column_ifexists('q_original_shared_s', ''),
          QOriginalVersion = column_ifexists('q_original_version_s', ''),
          QuarantineFileId = column_ifexists('quarantine_file_id_s', ''),
          QuarantineFileName = column_ifexists('quarantine_file_name_s', ''),
          QuarantineProfile = column_ifexists('quarantine_profile_s', ''),
          QuarantineProfileId = column_ifexists('quarantine_profile_id_s', ''),
          RedirectUrl = column_ifexists('redirect_url_s', ''),
          Referer = column_ifexists('referer_s', ''),
          RemediationProfile = column_ifexists('remediation_profile_s', ''),
          ReqCnt = column_ifexists('req_cnt_d', ''),
          RequestId = column_ifexists('request_id_s', ''),
          RespCnt = column_ifexists('resp_cnt_d', ''),
          RiskLevel = column_ifexists('risk_level_s', ''),
          SAMAccountName = column_ifexists('sAMAccountName_s', ''),
          SAMAccountType = column_ifexists('sAMAccountType_s', ''),
          SanctionedInstance = column_ifexists('sanctioned_instance_s', ''),
          ScanType = column_ifexists('scan_type_s', ''),
          Sender = column_ifexists('sender_s', ''),
          Serial = column_ifexists('serial_s', ''),
          ServerBytes = column_ifexists('server_bytes_d', ''),
          ServerPackets = column_ifexists('server_packets_d', ''),
          SessionDuration = column_ifexists('session_duration_d', ''),
          SessionId = column_ifexists('sessionid_s', ''),
          Severity = column_ifexists('severity_s', ''),
          Sfwder = column_ifexists('sfwder_s', ''),
          SharedDomains = column_ifexists('shared_domains_s', ''),
          SharedWith = column_ifexists('shared_with_s', ''),
          Site = column_ifexists('site_s', ''),
          SmtpStatus = column_ifexists('smtp_status_s', ''),
          SmtpTo = column_ifexists('smtp_to_s', ''),
          SourceCountry = column_ifexists('src_country_s', ''),
          SourceGeoIpSource = column_ifexists('src_geoip_src_d', ''),
          SourceLatitude = column_ifexists('src_latitude_d', ''),
          SourceLocation = column_ifexists('src_location_s', ''),
          SourceLongitude = column_ifexists('src_longitude_d', ''),
          SourceRegion = column_ifexists('src_region_s', ''),
          SourceTime = column_ifexists('src_time_s', ''),
          SourceTimezone = column_ifexists('src_timezone_s', ''),
          SourceZipcode = column_ifexists('src_zipcode_s', ''),
          SourceIp = column_ifexists('srcip_s', ''),
          SourcePort = column_ifexists('srcport_d', ''),
          StartTime = column_ifexists('start_time_s', ''),
          SuppressionEndTime = column_ifexists('suppression_end_time_d', ''),
          SuppressionKey = column_ifexists('suppression_key_s', ''),
          SuppressionStartTime = column_ifexists('suppression_start_time_d', ''),
          TelemetryApp = column_ifexists('telemetry_app_s', ''),
          ThreatMatchField = column_ifexists('threat_match_field_s', ''),
          ThreatMatchValue = column_ifexists('threat_match_value_s', ''),
          ThreatSourceId = column_ifexists('threat_source_id_d', ''),
          Timestamp = column_ifexists('timestamp_d', ''),
          Title = column_ifexists('Title_s', ''),
          ToObject = column_ifexists('to_object_s', ''),
          ToStorage = column_ifexists('to_storage_s', ''),
          ToUser = column_ifexists('to_user_s', ''),
          TotalCollaboratorCount = column_ifexists('total_collaborator_count_d', ''),
          TotalPackets = column_ifexists('total_packets_d', ''),
          TrafficType = column_ifexists('traffic_type_s', ''),
          TransactionId = column_ifexists('transaction_id_d', ''),
          TrustComputerChecked = column_ifexists('trust_computer_checked_s', ''),
          TssFailReason = column_ifexists('tss_fail_reason_s', ''),
          TssMode = column_ifexists('tss_mode_s', ''),
          TssScanFailed = column_ifexists('tss_scan_failed_s', ''),
          TssScan = column_ifexists('TSS_scan_s', ''),
          TunnelId = column_ifexists('tunnel_id_s', ''),
          TunnelType = column_ifexists('tunnel_type_s', ''),
          TunnelUpTime = column_ifexists('tunnel_up_time_d', ''),
          TwoFactorAuth = column_ifexists('two_factor_auth_s', ''),
          UniversalConnector = column_ifexists('universal_connector_s', ''),
          UrNormalized = column_ifexists('ur_normalized_s', ''),
          Url = column_ifexists('url_s', ''),
          User = column_ifexists('user_s', ''),
          UserId = column_ifexists('user_id_s', ''),
          UserTmp = column_ifexists('user_tmp_s', ''),
          UserAgent = column_ifexists('useragent_s', ''),
          UserCountry = column_ifexists('userCountry_s', ''),
          UserIp = column_ifexists('userip_s', '')
      | project 
          Category,
          Computer,
          MG,
          ManagementGroupName,
          RawData,
          SourceSystem,
          TenantId,
          TimeGenerated,
          Type,
          _ResourceId,
          Id,
          AccessMethod,
          Acked,
          ActUser,
          Action,
          Activity,
          ActivityStatus,
          ActivityType,
          AggregatedUser,
          Alert,
          AlertName,
          AlertType,
          AllPolicyMatches,
          App,
          AppActivity,
          AppScopes,
          AppSessionId,
          AppCategory,
          AppSuite,
          BCC,
          Browser,
          BrowserSessionId,
          BrowserVersion,
          CC,
          CCI,
          CCIString,
          CCL,
          ClientBytes,
          ClientPackets,
          ConnDuration,
          ConnectionId,
          Count,
          CustomConnector,
          DataType,
          Device,
          DeviceClassification,
          DisplayName,
          DistinguishedName,
          Division,
          DlpFailReason,
          DlpProfile,
          DlpScanFailed,
          DestinationCountry,
          DestinationGeoIpSource,
          DestinationLatitude,
          DestinationLocation,
          DestinationLongitude,
          DestinationRegion,
          DestinationTimezone,
          DestinationZipcode,
          DestinationHost,
          DestinationIp,
          DestinationPort,
          DynamicClassification,
          EncryptFailure,
          EndTime,
          EventType,
          Exposure,
          ExternalCollaboratorCount,
          FileCategory,
          FileId,
          FilePath,
          FileSize,
          FileType,
          ForwardToProxyXau,
          FromObject,
          FromStorage,
          FromUser,
          Gateway,
          Group,
          Hostname,
          HttpStatus,
          IncidentId,
          Instance,
          InstanceId,
          InternalCollaboratorCount,
          IpProtocol,
          JustificationReason,
          JustificationType,
          LastName,
          LogFileName,
          Mail,
          Malicious,
          MalsiteCategory,
          MalwareId,
          MalwareName,
          MalwareSeverity,
          MalwareType,
          ManagedApp,
          ManagementId,
          Manager,
          Md5,
          MemberOf,
          MessageId,
          MessageSize,
          MimeType,
          Modified,
          Network,
          NetworkSessionId,
          NotifyTemplate,
          Nsdeviceuid,
          NumSessions,
          NumBytes,
          Object,
          ObjectCount,
          ObjectId,
          ObjectType,
          Org,
          OrganizationUnit,
          OrignalFilePath,
          OS,
          OsVersion,
          OtherCategories,
          Owner,
          Page,
          PageSite,
          ParentId,
          Policy,
          PolicyId,
          PolicyType,
          ProfileEmails,
          Protocol,
          ProtocolPort,
          PublisherCn,
          PublisherName,
          QAdmin,
          QApp,
          QInstance,
          QOriginalFilename,
          QOriginalFilepath,
          QOriginalShared,
          QOriginalVersion,
          QuarantineFileId,
          QuarantineFileName,
          QuarantineProfile,
          QuarantineProfileId,
          RedirectUrl,
          Referer,
          RemediationProfile,
          ReqCnt,
          RequestId,
          RespCnt,
          RiskLevel,
          SAMAccountName,
          SAMAccountType,
          SanctionedInstance,
          ScanType,
          Sender,
          Serial,
          ServerBytes,
          ServerPackets,
          SessionDuration,
          SessionId,
          Severity,
          Sfwder,
          SharedDomains,
          SharedWith,
          Site,
          SmtpStatus,
          SmtpTo,
          SourceCountry,
          SourceGeoIpSource,
          SourceLatitude,
          SourceLocation,
          SourceLongitude,
          SourceRegion,
          SourceTime,
          SourceTimezone,
          SourceZipcode,
          SourceIp,
          SourcePort,
          StartTime,
          SuppressionEndTime,
          SuppressionKey,
          SuppressionStartTime,
          TelemetryApp,
          ThreatMatchField,
          ThreatMatchValue,
          ThreatSourceId,
          Timestamp,
          Title,
          ToObject,
          ToStorage,
          ToUser,
          TotalCollaboratorCount,
          TotalPackets,
          TrafficType,
          TransactionId,
          TrustComputerChecked,
          TssFailReason,
          TssMode,
          TssScanFailed,
          TssScan,
          TunnelId,
          TunnelType,
          TunnelUpTime,
          TwoFactorAuth,
          UniversalConnector,
          UrNormalized,
          Url,
          User,
          UserId,
          UserTmp,
          UserAgent,
          UserCountry,
          UserIp
  };
  Alerts_Policy_View