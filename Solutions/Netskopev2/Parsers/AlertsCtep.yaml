id: 692b3a9d-ddd1-46f8-a44e-f830fb485ad5
Function:
  Title: Parser for AlertsCtep
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: AlertsCtep
FunctionAlias: AlertsCtep
FunctionQuery: |
  let Alerts_ctep_view = view(){
  alertsctepdata_CL
  | extend   Category = column_ifexists('Category', ''),
    Computer = column_ifexists('Computer', ''),
    MG = column_ifexists('MG', ''),
    ManagementGroupName = column_ifexists('ManagementGroupName', ''),
    RawData = column_ifexists('RawData', ''),
    SourceSystem = column_ifexists('SourceSystem', ''),
    TenantId = column_ifexists('TenantId', ''),
    TimeGenerated = column_ifexists('TimeGenerated', ''),
    Type = column_ifexists('Type', ''),
    _ResourceId = column_ifexists('_ResourceId', ''),
    Id = column_ifexists('_id_s', ''),
    Acked = column_ifexists('acked_s', ''),
    Action = column_ifexists('action_s', ''),
    AlertName = column_ifexists('alert_name_s', ''),
    Alert = column_ifexists('alert_s', ''),
    AlertType = column_ifexists('alert_type_s', ''),
    App = column_ifexists('app_s', ''),
    CCI = column_ifexists('cci_d', ''),
    CCIString = column_ifexists('cci_s', ''),
    CCL = column_ifexists('ccl_s', ''),
    Company = column_ifexists('company_s', ''),
    Count = column_ifexists('count_d', ''),
    Department = column_ifexists('department_s', ''),
    DeviceClassification = column_ifexists('deviceClassification_s', ''),
    Device = column_ifexists('device_s', ''),
    DestinationCountry = column_ifexists('dst_country_s', ''),
    DestinationGeoipSource = column_ifexists('dst_geoip_src_d', ''),
    DestinationLatitude = column_ifexists('dst_latitude_d', ''),
    DestinationLocation = column_ifexists('dst_location_s', ''),
    DestinationLongitude = column_ifexists('dst_longitude_d', ''),
    DestinationRegion = column_ifexists('dst_region_s', ''),
    DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
    DestinationIp = column_ifexists('dstip_s', ''),
    DestinationPort = column_ifexists('dstport_d', ''),
    GId = column_ifexists('gid_d', ''),
    HomePop = column_ifexists('home_pop_s', ''),
    HostName = column_ifexists('hostname_s', ''),
    HttpMethod_s = column_ifexists('http_method_s', ''),
    HttpPort_d = column_ifexists('http_port_d', ''),
    IpProtocol = column_ifexists('ip_protocol_s', ''),
    Manager = column_ifexists('manager_s', ''),
    NetskopePop_s = column_ifexists('netskope_pop_s', ''),
    OrganizationUnit = column_ifexists('organization_unit_s', ''),
    OS = column_ifexists('os_s', ''),
    OtherCategories = column_ifexists('other_categories_s', ''),
    ProfileId = column_ifexists('profile_id_s', ''),
    Referer = column_ifexists('referer_s', ''),
    SignatureId = column_ifexists('signature_id_d', ''),
    Signature = column_ifexists('signature_s', ''),
    Site = column_ifexists('site_s', ''),
    SourceCountry = column_ifexists('src_country_s', ''),
    SourceGeoIpSrc = column_ifexists('src_geoip_src_d', ''),
    SourceLatitude = column_ifexists('src_latitude_d', ''),
    SourceLocation = column_ifexists('src_location_s', ''),
    SourceLongitude = column_ifexists('src_longitude_d', ''),
    SourceRegion = column_ifexists('src_region_s', ''),
    SourceZipcode = column_ifexists('src_zipcode_s', ''),
    SourceIp = column_ifexists('srcip_s', ''),
    SourcePort = column_ifexists('srcport_d', ''),
    Timestamp = column_ifexists('timestamp_d', ''),
    TrafficType = column_ifexists('traffic_type_s', ''),
    TransactionId = column_ifexists('transaction_id_d', ''),
    TunnelId = column_ifexists('tunnel_id_s', ''),
    PolicyType = column_ifexists('type_s', ''),
    UrNormalized = column_ifexists('ur_normalized_s', ''),
    Url = column_ifexists('url_s', ''),
    UserPrincipalName = column_ifexists('userPrincipalName_s', ''),
    User = column_ifexists('user_s', ''),
    UserIp = column_ifexists('userip_s', ''),
    Userkey = column_ifexists('userkey_s', '')
    |project Category,
          Computer,
          MG,
          ManagementGroupName,
          RawData,
          SourceSystem,
          TenantId,
          TimeGenerated,
          Type,
          _ResourceId,
          Id,
          Acked,
          Action,
          AlertName,
          Alert,
          AlertType,
          App,
          CCI,
          CCIString,
          CCL,
          Company,
          Count,
          Department,
          DeviceClassification,
          Device,
          DestinationCountry,
          DestinationGeoipSource,
          DestinationLatitude,
          DestinationLocation,
          DestinationLongitude,
          DestinationRegion,
          DestinationZipcode,
          DestinationIp,
          DestinationPort,
          GId,
          HomePop,
          HostName,
          HttpMethod_s,
          HttpPort_d,
          IpProtocol,
          Manager,
          NetskopePop_s,
          OrganizationUnit,
          OS,
          OtherCategories,
          ProfileId,
          Referer,
          SignatureId,
          Signature,
          Site,
          SourceCountry,
          SourceGeoIpSrc,
          SourceLatitude,
          SourceLocation,
          SourceLongitude,
          SourceRegion,
          SourceZipcode,
          SourceIp,
          SourcePort,
          Timestamp,
          TrafficType,
          TransactionId,
          TunnelId,
          PolicyType,
          UrNormalized,
          Url,
          UserPrincipalName,
          User,
          UserIp,
          Userkey
  };
  Alerts_ctep_view
