id: 6b84879b-285e-4e00-b28f-61907ad7e1ef
Function:
  Title: Parser for AlertsDLP
  Version: "1.0.0"
  LastUpdated: "2024-03-06"
Category: Microsoft Sentinel Parser
FunctionName: AlertsDLP
FunctionAlias: AlertsDLP
FunctionQuery: |
  let Alert_DLP_Data_View = view (){
      alertsdlpdata_CL
          |extend 
              Category = column_ifexists('Category', ''),
              Computer = column_ifexists('Computer', ''),
              MG = column_ifexists('MG', ''),
              ManagementGroupName = column_ifexists('ManagementGroupName', ''),
              RawData = column_ifexists('RawData', ''),
              SourceSystem = column_ifexists('SourceSystem', ''),
              TenantId = column_ifexists('TenantId', ''),
              TimeGenerated  = column_ifexists('TimeGenerated', ''),
              Type = column_ifexists('Type', ''),
              _ResourceId = column_ifexists('_ResourceId', ''),
              Id = column_ifexists('_id_s', ''),
              AccessMethod = column_ifexists('access_method_s', ''),
              Acked = column_ifexists('acked_s', ''),
              ActUser = column_ifexists('act_user_s', ''),
              Action = column_ifexists('action_s', ''),
              Activity = column_ifexists('activity_s', ''),
              AlertName = column_ifexists('alert_name_s', ''),
              Alert = column_ifexists('alert_s', ''),
              AlertType = column_ifexists('alert_type_s', ''),
              AppActivity = column_ifexists('app_activity_s', ''),
              App = column_ifexists('app_s', ''),
              AppSessionId = column_ifexists('app_session_id_d', ''),
              AppCategory = column_ifexists('appcategory_s', ''),
              AppSuite = column_ifexists('appsuite_s', ''),
              BCC = column_ifexists('bcc_s', ''),
              Browser = column_ifexists('browser_s', ''),
              BrowserSessionId = column_ifexists('browser_session_id_d', ''),
              BrowserVersion = column_ifexists('browser_version_s', ''),
              CCL = column_ifexists('ccl_s', ''),
              Channel = column_ifexists('channel_s', ''),
              ClassificationName = column_ifexists('classification_name_s', ''),
              Collaborated = column_ifexists('collaborated_s', ''),
              ConnectionId = column_ifexists('connection_id_d', ''),
              DataType = column_ifexists('data_type_s', ''),
              DeviceClassification = column_ifexists('device_classification_s', ''),
              Device = column_ifexists('device_s', ''),
              DisplayName = column_ifexists('displayName_s', ''),
              DlpFile = column_ifexists('dlp_file_s', ''),
              DlpFingerprintClassification = column_ifexists('dlp_fingerprint_classification_s', ''),
              DlpFingerprintMatch = column_ifexists('dlp_fingerprint_match_s', ''),
              DlpFingerprintScore = column_ifexists('dlp_fingerprint_score_d', ''),
              DlpIncidentId = column_ifexists('dlp_incident_id_d', ''),
              DlpIsUniqueCount = column_ifexists('dlp_is_unique_count_s', ''),
              DlpMailParentId = column_ifexists('dlp_mail_parent_id_s', ''),
              DlpParentId = column_ifexists('dlp_parent_id_d', ''),
              DlpProfile = column_ifexists('dlp_profile_s', ''),
              DlpRuleCount = column_ifexists('dlp_rule_count_d', ''),
              DlpRule = column_ifexists('dlp_rule_s', ''),
              DlpRuleScore = column_ifexists('dlp_rule_score_d', ''),
              DlpRuleSeverity = column_ifexists('dlp_rule_severity_s', ''),
              DlpUniqueCount = column_ifexists('dlp_unique_count_d', ''),
              DestinationCountry = column_ifexists('dst_country_s', ''),
              DestinationGeoipSource = column_ifexists('dst_geoip_src_d', ''),
              DestinationLatitude = column_ifexists('dst_latitude_d', ''),
              DestinationLocation = column_ifexists('dst_location_s', ''),
              DestinationLongitude = column_ifexists('dst_longitude_d', ''),
              DestinationRegion = column_ifexists('dst_region_s', ''),
              DestinationTimezone = column_ifexists('dst_timezone_s', ''),
              DestinationZipcode = column_ifexists('dst_zipcode_s', ''),
              DestinationIp = column_ifexists('dstip_s', ''),
              DynamicClassification = column_ifexists('dynamic_classification_s', ''),
              Exposure = column_ifexists('exposure_s', ''),
              ExternalCollaboratorCount = column_ifexists('external_collaborator_count_d', ''),
              FileCategory = column_ifexists('file_category_s', ''),
              FileClsEncrypted = column_ifexists('file_cls_encrypted_b', ''),
              FileLang = column_ifexists('file_lang_s', ''),
              FilePasswordProtected = column_ifexists('file_password_protected_s', ''),
              FilePath = column_ifexists('file_path_s', ''),
              FileSize = column_ifexists('file_size_d', ''),
              FileType = column_ifexists('file_type_s', ''),
              FromStorage = column_ifexists('from_storage_s', ''),
              FromUser = column_ifexists('from_user_s', ''),
              Group = column_ifexists('group_s', ''),
              HostName = column_ifexists('hostname_s', ''),
              IncidentId = column_ifexists('incident_id_d', ''),
              InstanceId = column_ifexists('instance_id_s', ''),
              Instance = column_ifexists('instance_s', ''),
              LocalSha256 = column_ifexists('local_sha256_s', ''),
              Mail = column_ifexists('mail_s', ''),
              ManagedApp = column_ifexists('managed_app_s', ''),
              ManagementId = column_ifexists('managementID_s', ''),
              Manager = column_ifexists('manager_s', ''),
              Md5 = column_ifexists('md5_g', ''),
              MessageId = column_ifexists('message_id_s', ''),
              MessageSize = column_ifexists('message_size_d', ''),
              MimeType = column_ifexists('mime_type_s', ''),
              Modified = column_ifexists('modified_d', ''),
              ObjectId = column_ifexists('object_id_s', ''),
              Object = column_ifexists('object_s', ''),
              ObjectType = column_ifexists('object_type_s', ''),
              OrganizationUnit = column_ifexists('organization_unit_s', ''),
              OrignalFilePath = column_ifexists('orignal_file_path_s', ''),
              OS = column_ifexists('os_s', ''),
              OsVersion = column_ifexists('os_version_s', ''),
              OuterDocType = column_ifexists('outer_doc_type_d', ''),
              OwnerPdl = column_ifexists('owner_pdl_s', ''),
              Owner = column_ifexists('owner_s', ''),
              Page = column_ifexists('page_s', ''),
              PageSite = column_ifexists('page_site_s', ''),
              ParentId = column_ifexists('parent_id_s', ''),
              PolicyId = column_ifexists('policy_id_s', ''),
              Policy = column_ifexists('policy_s', ''),
              Protocol = column_ifexists('protocol_s', ''),
              Referer = column_ifexists('referer_s', ''),
              RequestId = column_ifexists('request_id_s', ''),
              RetroScanName = column_ifexists('retro_scan_name_s', ''),
              SAMAccountName = column_ifexists('sAMAccountName_s', ''),
              SanctionedInstance = column_ifexists('sanctioned_instance_s', ''),
              ScanType = column_ifexists('scan_type_s', ''),
              Severity = column_ifexists('severity_s', ''),
              SHA256 = column_ifexists('sha256_s', ''),
              SharedDomains = column_ifexists('shared_domains_s', ''),
              SharedWith = column_ifexists('shared_with_s', ''),
              Site = column_ifexists('site_s', ''),
              SmtpTo = column_ifexists('smtp_to_s', ''),
              SourceCountry = column_ifexists('src_country_s', ''),
              SourceGeoIpSrc = column_ifexists('src_geoip_src_d', ''),
              SourceLatitude = column_ifexists('src_latitude_d', ''),
              SourceLocation = column_ifexists('src_location_s', ''),
              SourceLongitude = column_ifexists('src_longitude_d', ''),
              SourceRegion = column_ifexists('src_region_s', ''),
              SourceTime = column_ifexists('src_time_s', ''),
              SourceTimezone = column_ifexists('src_timezone_s', ''),
              SourceZipcode = column_ifexists('src_zipcode_s', ''),
              SourceIp = column_ifexists('srcip_s', ''),
              SubType = column_ifexists('sub_type_s', ''),
              SuppressionKey = column_ifexists('suppression_key_s', ''),
              Timestamp = column_ifexists('timestamp_d', ''),
              Title = column_ifexists('title_s', ''),
              ToStorage = column_ifexists('to_storage_s', ''),
              ToUser = column_ifexists('to_user_s', ''),
              TotalCollaboratorCount = column_ifexists('total_collaborator_count_d', ''),
              TrafficType = column_ifexists('traffic_type_s', ''),
              TransactionId = column_ifexists('transaction_id_d', ''),
              TrueFileType = column_ifexists('true_filetype_s', ''),
              TrueObjCategory = column_ifexists('true_obj_category_s', ''),
              TrueObjType = column_ifexists('true_obj_type_s', ''),
              TrueTypeId = column_ifexists('true_type_id_d', ''),
              TssMode = column_ifexists('tss_mode_s', ''),
              PolicyType = column_ifexists('type_s', ''),
              UniversalConnector = column_ifexists('universal_connector_s', ''),
              UrNormalized = column_ifexists('ur_normalized_s', ''),
              Url = column_ifexists('url_s', ''),
              UserCountry = column_ifexists('userCountry_s', ''),
              UserPrincipalName = column_ifexists('userPrincipalName_s', ''),
              UserId = column_ifexists('user_id_s', ''),
              User = column_ifexists('user_s', ''),
              UserIp = column_ifexists('userip_s', ''),
              Userkey = column_ifexists('userkey_s', ''),
              ViolatingUser = column_ifexists('violating_user_s', ''),
              ViolatingUserType = column_ifexists('violating_user_type_s', ''),
              WebUniversalConnector = column_ifexists('web_universal_connector_s', '')
          | project 
              Category,
              MG,
              ManagementGroupName,
              SourceSystem,
              TenantId,
              _ResourceId,
              Computer,
              RawData,
              TimeGenerated,
              Type,
              Id,
              AccessMethod,
              Acked,
              ActUser,
              Action,
              Activity,
              AlertName,
              Alert,
              AlertType,
              AppActivity,
              App,
              AppSessionId,
              AppCategory,
              AppSuite,
              BCC,
              Browser,
              BrowserSessionId,
              BrowserVersion,
              CCL,
              Channel,
              ClassificationName,
              Collaborated,
              ConnectionId,
              DataType,
              DeviceClassification,
              Device,
              DisplayName,
              DlpFile,
              DlpFingerprintClassification,
              DlpFingerprintMatch,
              DlpFingerprintScore,
              DlpIncidentId,
              DlpIsUniqueCount,
              DlpMailParentId,
              DlpParentId,
              DlpProfile,
              DlpRuleCount,
              DlpRule,
              DlpRuleScore,
              DlpRuleSeverity,
              DlpUniqueCount,
              DestinationCountry,
              DestinationGeoipSource,
              DestinationLatitude,
              DestinationLocation,
              DestinationLongitude,
              DestinationRegion,
              DestinationTimezone,
              DestinationZipcode,
              DestinationIp,
              DynamicClassification,
              Exposure,
              ExternalCollaboratorCount,
              FileCategory,
              FileClsEncrypted,
              FileLang,
              FilePasswordProtected,
              FilePath,
              FileSize,
              FileType,
              FromStorage,
              FromUser,
              Group,
              HostName,
              IncidentId,
              InstanceId,
              Instance,
              LocalSha256,
              Mail,
              ManagedApp,
              ManagementId,
              Manager,
              Md5,
              MessageId,
              MessageSize,
              MimeType,
              Modified,
              ObjectId,
              Object,
              ObjectType,
              OrganizationUnit,
              OrignalFilePath,
              OS,
              OsVersion,
              OuterDocType,
              OwnerPdl,
              Owner,
              Page,
              PageSite,
              ParentId,
              PolicyId,
              Policy,
              Protocol,
              Referer,
              RequestId,
              RetroScanName,
              SAMAccountName,
              SanctionedInstance,
              ScanType,
              Severity,
              SHA256,
              SharedDomains,
              SharedWith,
              Site,
              SmtpTo,
              SourceCountry,
              SourceGeoIpSrc,
              SourceLatitude,
              SourceLocation,
              SourceLongitude,
              SourceRegion,
              SourceTime,
              SourceTimezone,
              SourceZipcode,
              SourceIp,
              SubType,
              SuppressionKey,
              Timestamp,
              Title,
              ToStorage,
              ToUser,
              TotalCollaboratorCount,
              TrafficType,
              TransactionId,
              TrueFileType,
              TrueObjCategory,
              TrueObjType,
              TrueTypeId,
              TssMode,
              PolicyType,
              UniversalConnector,
              UrNormalized,
              Url,
              UserCountry,
              UserPrincipalName,
              UserId,
              User,
              UserIp,
              Userkey,
              ViolatingUser,
              ViolatingUserType,
              WebUniversalConnector
      };
      Alert_DLP_Data_View
