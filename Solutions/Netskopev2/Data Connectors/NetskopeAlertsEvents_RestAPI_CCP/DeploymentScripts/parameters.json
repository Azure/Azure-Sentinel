{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "description": "Parameter template for Netskope DEV instance deployment",
        "author": "Microsoft Sentinel Community",
        "version": "1.0"
    },
    "parameters": {
        "subscriptionId": {
            "value": "12345678-1234-1234-1234-123456789012",
            "metadata": {
                "description": "Azure subscription ID where resources will be deployed",
                "example": "12345678-1234-1234-1234-123456789012"
            }
        },
        "resourceGroupName": {
            "value": "rg-sentinel",
            "metadata": {
                "description": "Name of the resource group containing the Log Analytics workspace",
                "example": "rg-sentinel"
            }
        },
        "workspaceName": {
            "value": "law-sentinel",
            "metadata": {
                "description": "Name of the Log Analytics workspace",
                "example": "law-sentinel"
            }
        },
        "location": {
            "value": "eastus",
            "metadata": {
                "description": "Azure region where resources will be deployed",
                "allowedValues": [
                    "eastus",
                    "eastus2", 
                    "westus",
                    "westus2",
                    "centralus",
                    "northcentralus",
                    "southcentralus",
                    "westcentralus",
                    "canadacentral",
                    "canadaeast",
                    "brazilsouth",
                    "northeurope",
                    "westeurope",
                    "uksouth",
                    "ukwest",
                    "francecentral",
                    "germanywestcentral",
                    "norwayeast",
                    "switzerlandnorth",
                    "swedencentral",
                    "australiaeast",
                    "australiasoutheast",
                    "japaneast",
                    "japanwest",
                    "koreacentral",
                    "koreasouth",
                    "southeastasia",
                    "eastasia",
                    "centralindia",
                    "southindia",
                    "westindia",
                    "southafricanorth",
                    "uaenorth"
                ],
                "example": "eastus"
            }
        },
        "devPrefix": {
            "value": "DEV",
            "metadata": {
                "description": "Prefix for DEV environment resources",
                "example": "DEV"
            }
        },
        "prodPrefix": {
            "value": "PROD", 
            "metadata": {
                "description": "Prefix for PROD environment resources (for reference only)",
                "example": "PROD"
            }
        }
    },
    "variables": {
        "deploymentInfo": {
            "description": "This parameter file is used with Deploy-NetskopeDevInstance.ps1 to create a second set of Netskope data connectors for DEV environment",
            "supportedEventTypes": [
                "ApplicationEvents",
                "AuditEvents", 
                "ConnectionEvents",
                "InfrastructureEvents",
                "NetworkEvents",
                "PagesEvents",
                "AlertsEvents",
                "BehaviorAnalyticsAlertsEvents",
                "CompromisedCredentialsAlertsEvents",
                "DLPAlertsEvents",
                "LegalHoldAlertsEvents",
                "MalsiteAlertsEvents",
                "MalwareAlertsEvents",
                "PolicyAlertsEvents",
                "QuarantineAlertsEvents",
                "RemediationAlertsEvents",
                "SecurityAssessmentAlertsEvents",
                "UBAAlertsEvents",
                "WatchlistAlertsEvents",
                "WebTxAlertsEvents",
                "CTEPAlertsEvents"
            ],
            "totalConnectors": 21,
            "estimatedDeploymentTime": "10-15 minutes"
        }
    },
    "outputs": {
        "deploymentGuide": {
            "type": "object",
            "value": {
                "step1": "Update the parameter values above with your environment details",
                "step2": "Run: .\\Deploy-NetskopeDevInstance.ps1 -SubscriptionId '<subscriptionId>' -ResourceGroupName '<resourceGroupName>' -WorkspaceName '<workspaceName>' -Location '<location>'",
                "step3": "Configure your DEV Netskope tenant with policy names prefixed with the devPrefix value",
                "step4": "Use VerificationQueries.kql to validate deployment and data ingestion",
                "step5": "Update analytics rules to filter by policy name prefixes for environment separation"
            }
        },
        "requiredPermissions": {
            "type": "array",
            "value": [
                "Microsoft.Insights/dataCollectionEndpoints/write",
                "Microsoft.Insights/dataCollectionRules/write", 
                "Microsoft.OperationalInsights/workspaces/read",
                "Microsoft.Resources/resourceGroups/read"
            ]
        },
        "resourcesCreated": {
            "type": "object",
            "value": {
                "dataCollectionEndpoints": "21 DCEs with names like 'dce-DEV-NetskopeAlertsEvents-<EventType>'",
                "dataCollectionRules": "21 DCRs with names like 'dcr-DEV-NetskopeAlertsEvents-<EventType>'",
                "targetTables": "Same tables as PROD environment (e.g., NetskopeApplicationEvents_CL)",
                "totalResources": 42
            }
        }
    }
}