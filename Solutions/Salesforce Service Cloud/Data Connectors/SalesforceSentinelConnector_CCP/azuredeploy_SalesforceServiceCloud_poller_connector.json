{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "location": {
            "type": "string",
            "minLength": 1,
            "defaultValue": "[resourceGroup().location]",
            "metadata": {
                "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
            }
        },
        "workspace-location": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
            }
        },
        "workspace": {
            "defaultValue": "",
            "type": "string",
            "metadata": {
                "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
            }
        }
    },
    "variables": {
        "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
        "dataCollectionEndpointId": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
        "_solutionName": "SalesforceEventLog",
        "_solutionVersion": "0.0.1",
        "_solutionAuthor": "Microsoft",
        "_packageIcon": "icon",
        "_solutionId": "azuresentinel.azure-sentinel-solution-azuresentinel.azure-sentinel-SalesforceEventLogConnector",
        "dataConnectorVersionConnectorDefinition": "0.0.1",
        "dataConnectorVersionConnections": "0.0.1",
        "_solutionTier": "Community",
        "_dataConnectorContentIdConnectorDefinition": "SalesforceEventLogConnectorTemplateConnectorDefinition",
        "dataConnectorTemplateNameConnectorDefinition": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition')))]",
        "_dataConnectorContentIdConnections": "SalesforceEventLogConnectorTemplateConnections",
        "dataConnectorTemplateNameConnections": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections')))]",
        "_logAnalyticsTableId1": "SalesforceServiceCloudV2_CL"
    },
    "resources": [
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition'), variables('dataConnectorVersionConnectorDefinition'))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
            ],
            "properties": {
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition')]",
                "displayName": "[concat(variables('_solutionName'), variables('dataConnectorTemplateNameConnectorDefinition'))]",
                "contentKind": "DataConnector",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "[variables('dataConnectorVersionConnectorDefinition')]",
                    "parameters": {
                        
                    },
                    "variables": {
                        
                    },
                    "resources": [
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition')))]",
                            "apiVersion": "2022-01-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "properties": {
                                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition'))]",
                                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition')]",
                                "kind": "DataConnector",
                                "version": "[variables('dataConnectorVersionConnectorDefinition')]",
                                "source": {
                                    "sourceId": "[variables('_solutionId')]",
                                    "name": "[variables('_solutionName')]",
                                    "kind": "Solution"
                                },
                                "author": {
                                    "name": "[variables('_solutionAuthor')]"
                                },
                                "support": {
                                    "name": "[variables('_solutionAuthor')]",
                                    "tier": "[variables('_solutionTier')]"
                                },
                                "dependencies": {
                                    "criteria": [
                                        {
                                            "version": "[variables('dataConnectorVersionConnections')]",
                                            "contentId": "[variables('_dataConnectorContentIdConnections')]",
                                            "kind": "ResourcesDataConnector"
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition'))]",
                            "apiVersion": "2022-09-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
                            "location": "[parameters('workspace-location')]",
                            "kind": "Customizable",
                            "properties": {
                                "connectorUiConfig": {
                                    "id": "SalesforceServiceCloudCCPDefinition",
                                    "title": "Salesforce Service Cloud (via Codeless Connector Framework)",
                                    "publisher": "Microsoft",
                                    "descriptionMarkdown": "The Salesforce Service Cloud data connector provides the capability to ingest information about your Salesforce operational events into Microsoft Sentinel through the REST API. The connector provides ability to review events in your org on an accelerated basis, get [event log files](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/event_log_file_hourly_overview.htm) in hourly increments for recent activity.",
                                    "graphQueriesTableName": "SalesforceServiceCloudV2_CL",
                                    "graphQueries": [
                                        {
                                            "metricName": "Total data received",
                                            "legend": "Salesforce Service Cloud EventLogFile Events",
                                            "baseQuery": "{{graphQueriesTableName}}"
                                        }
                                    ],
                                    "sampleQueries": [
                                        {
                                            "description": "Get a sample of Salesforce Service Cloud Event Log File Events",
                                            "query": "{{graphQueriesTableName}}\n| take 10"
                                        }
                                    ],
                                    "dataTypes": [
                                        {
                                            "name": "{{graphQueriesTableName}}",
                                            "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                                        }
                                    ],
                                    "connectivityCriteria": [
                                        {
                                            "type": "HasDataConnectors"
                                        }
                                    ],
                                    "availability": {
                                        "isPreview": false,
                                        "status": 1
                                    },
                                    "permissions": {
                                        "resourceProvider": [
                                            {
                                                "provider": "Microsoft.OperationalInsights/workspaces",
                                                "permissionsDisplayText": "Read and Write permissions are required.",
                                                "providerDisplayName": "Workspace",
                                                "scope": "Workspace",
                                                "requiredPermissions": {
                                                    "write": true,
                                                    "read": true,
                                                    "delete": true,
                                                    "action": false
                                                }
                                            }
                                        ],
                                        "customs": [
                                            {
                                                "name": "Salesforce Service Cloud API access",
                                                "description": "Access to the Salesforce Service Cloud API through a Connected App is required."
                                            }
                                        ]
                                    },
                                    "instructionSteps": [
                                        {
                                            "title": "Connect to Salesforce Service Cloud API to start collecting event logs in Microsoft Sentinel",
                                            "description": "Follow [Create a Connected App in Salesforce for OAuth](https://help.salesforce.com/s/articleView?id=platform.ev_relay_create_connected_app.htm&type=5) and [Configure a Connected App for the OAuth 2.0 Client Credentials Flow](https://help.salesforce.com/s/articleView?id=xcloud.connected_app_client_credentials_setup.htm&type=5) to create a Connected App with access to the Salesforce Service Cloud API. Through those instructions, you should get the Consumer Key and Consumer Secret.\n For Salesforce Domain name, Go to Setup, type My Domain in the Quick Find box, and select My Domain to view your domain details. Make sure to enter the domain name without a trailing slash (e.g., https://your-domain.my.salesforce.com). Fill the form below with that information.",
                                            "instructions": [
                                                {
                                                    "type": "Textbox",
                                                    "parameters": {
                                                        "label": "Salesforce Domain Name",
                                                        "placeholder": "Salesforce Domain Name",
                                                        "type": "text",
                                                        "name": "salesforceDomainName",
                                                        "validations": {
                                                            "required": true
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "Dropdown",
                                                    "parameters": {
                                                        "label": "Log Collection Interval",
                                                        "name": "queryType",
                                                        "options": [
                                                            {
                                                                "key": "SELECT Id,EventType,LogDate,Interval,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE Interval='Hourly' and CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                                                                "text": "Hourly"
                                                            },
                                                            {
                                                                "key": "SELECT Id,EventType,LogDate,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                                                                "text": "Daily"
                                                            }
                                                        ],
                                                        "placeholder": "Select an interval type",
                                                        "isMultiSelect": false,
                                                        "required": true
                                                    }
                                                },
                                                {
                                                    "type": "OAuthForm",
                                                    "parameters": {
                                                        "clientIdLabel": "Consumer Key",
                                                        "clientSecretLabel": "Consumer Secret",
                                                        "clientIdPlaceholder": "Enter Connected App Consumer Key",
                                                        "clientSecretPlaceholder": "Enter Connected App Consumer Secret",
                                                        "connectButtonLabel": "Connect",
                                                        "disconnectButtonLabel": "Disconnect"
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "name": "SalesforceServiceCloudDCR",
                            "apiVersion": "2021-09-01-preview",
                            "type": "Microsoft.Insights/dataCollectionRules",
                            "location": "[parameters('workspace-location')]",
                            "kind": null,
                            "properties": {
                                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId')]",
                                "streamDeclarations": {
                                    "Custom-SalesforceServiceCloudV2_CL": {
                                        "columns": [
                                            {
                                                "name": "REQUEST_SIZE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EXEC_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ACTION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PLATFORM_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "OS_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "OS_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TIMESTAMP",
                                                "type": "string"
                                            },
                                            {
                                                "name": "STATUS_CODE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EVENT_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REFERRER_URI",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_AGENT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "BROWSER_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RESPONSE_SIZE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DEVICE_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DEVICE_MODEL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SOURCE_IP",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLIENT_IP",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SUCCESS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "URI",
                                                "type": "string"
                                            },
                                            {
                                                "name": "URL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLIENT_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_INITIATED_LOGOUT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_EMAIL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "USER",
                                                "type": "string"
                                            },
                                            {
                                                "name": "URI_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "UI_EVENT_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "UI_EVENT_TIMESTAMP",
                                                "type": "string"
                                            },
                                            {
                                                "name": "UI_EVENT_SOURCE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "UI_EVENT_SEQUENCE_NUM",
                                                "type": "string"
                                            },
                                            {
                                                "name": "UI_EVENT_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TLS_PROTOCOL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TIMESTAMP_DERIVED",
                                                "type": "datetime"
                                            },
                                            {
                                                "name": "TARGET_UI_ELEMENT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SORT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SESSION_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SESSION_LEVEL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SESSION_KEY",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SEARCH_QUERY",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SDK_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SDK_APP_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SDK_APP_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RUN_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ROWS_PROCESSED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ROW_COUNT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RESOLUTION_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REQUEST_STATUS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REQUEST_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REPORT_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REPORT_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RENDERING_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RELATED_LIST",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RECORD_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RECORD_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "QUIDDITY",
                                                "type": "string"
                                            },
                                            {
                                                "name": "QUERY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PREVPAGE_URL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PREVPAGE_ENTITY_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PREVPAGE_ENTITY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PREVPAGE_CONTEXT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PREVPAGE_APP_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PREFIXES_SEARCHED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PARENT_UI_ELEMENT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_URL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_START_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_ENTITY_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_ENTITY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_CONTEXT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_APP_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ORIGIN",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ORGANIZATION_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUM_RESULTS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUMBER_SOQL_QUERIES",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUMBER_FIELDS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUMBER_EXCEPTION_FILTERS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUMBER_COLUMNS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUMBER_BUCKETS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "METHOD_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "METHOD",
                                                "type": "string"
                                            },
                                            {
                                                "name": "MEDIA_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LOGIN_STATUS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LOGIN_KEY",
                                                "type": "string"
                                            },
                                            {
                                                "name": "HTTP_METHOD",
                                                "type": "string"
                                            },
                                            {
                                                "name": "GRANDPARENT_UI_ELEMENT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ENTRY_POINT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ENTITY_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ENTITY",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EFFECTIVE_PAGE_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DURATION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DISPLAY_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DEVICE_SESSION_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DEVICE_PLATFORM",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DB_TOTAL_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DB_CPU_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DB_BLOCKS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CPU_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CONNECTION_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "COMPONENT_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLIENT_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLIENT_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CIPHER_SUITE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CALLOUT_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "BROWSER_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "BROWSER_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "AVERAGE_ROW_SIZE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "APP_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "APP_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "API_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "API_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ARTICLE_VERSION_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ARTICLE_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ARTICLE_STATUS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ARTICLE_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ANALYTICS_MODE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "BATCH_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLICKED_RECORD_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLASS_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "COMPONENT_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "COMPONENT_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CONTROLLER_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CONTEXT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CONSOLE_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CONSOLE_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "CLIENT_INFO",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DST_BYTES",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DST_USER",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DST_USER_SID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DST_USER_SID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DATA",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DASHBOARD_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DASHBOARD_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DASHBOARD_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DASHBOARD_COMPONENT_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DVC_ACTION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DVC_OS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DVC_OS_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DVC_OS_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DELIVERY_LOCATION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DELIVERY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DOCUMENT_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "DOCUMENT_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ENTITY_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "ENTITY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "FILE_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "FILE_PREVIEW_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EXCEPTION_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EXCEPTION_MESSAGE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EPT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EVENT_COUNT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EVENT_END_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "EVENT_RESULT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "FILE_SIZE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "HTTP_REFERRER_ORIGINAL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "HTTP_USER_AGENT_ORIGINAL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "HTTP_USER_AGENT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LOG_GROUP_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LIMIT_USAGE_PERCENT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LICENSE_CONTEXT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LAST_VERSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "LANGUAGE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "JOB_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_SUCCESS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_SECURE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_SCHEDULED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_NEW",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_MOBILE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_LONG_RUNNING_REQUEST",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_GUEST",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_FIRST_REQUEST",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_ERROR",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_API",
                                                "type": "string"
                                            },
                                            {
                                                "name": "IS_AJAX_REQUEST",
                                                "type": "string"
                                            },
                                            {
                                                "name": "MANAGED_PACKAGE_NAMESPACE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "HTTP_HEADERS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NETWORK_DURATION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUMBER_FAILURES",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUM_CLICKS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "OPERATION_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "NUM_SESSIONS",
                                                "type": "string"
                                            },
                                            {
                                                "name": "PAGE_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "QUERY",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REQUEST_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REPORT_DESCRIPTION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "REOPEN_COUNT",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RELATED_ENTITY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RECORD_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "READ_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "RANK",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SRC_BYTES",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SRC_DVC_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SRC_DVC_MODEL_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SRC_IP_ADDR",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SRC_NAT_IP_ADDR",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SESSION_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SITE_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SHARING_PERMISSION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SHARING_OPERATION",
                                                "type": "string"
                                            },
                                            {
                                                "name": "SHARED_WITH_ENTITY_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "URL_ORIGINAL",
                                                "type": "string"
                                            },
                                            {
                                                "name": "WAVE_TIMESTAMP",
                                                "type": "string"
                                            },
                                            {
                                                "name": "WAVE_SESSION_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "VIEW_STATE_SIZE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "VERSION_ID_DERIVED",
                                                "type": "string"
                                            },
                                            {
                                                "name": "VERSION_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TRIGGER_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TRIGGER_NAME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TRIGGER_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TRANSACTION_TYPE",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TOTAL_TIME",
                                                "type": "string"
                                            },
                                            {
                                                "name": "TAB_ID",
                                                "type": "string"
                                            },
                                            {
                                                "name": "STACK_TRACE",
                                                "type": "string"
                                            }
                                        ]
                                    }
                                },
                                "destinations": {
                                    "logAnalytics": [
                                        {
                                            "workspaceResourceId": "[variables('workspaceResourceId')]",
                                            "name": "clv2ws1"
                                        }
                                    ]
                                },
                                "dataFlows": [
                                    {
                                        "streams": [
                                            "Custom-SalesforceServiceCloudV2_CL"
                                        ],
                                        "destinations": [
                                            "clv2ws1"
                                        ],
                                        "outputStream": "Custom-SalesforceServiceCloudV2_CL",
                                        "transformKql": "source | extend TimeGenerated = TIMESTAMP_DERIVED , RequestSize = ['REQUEST_SIZE'] , ExecTime = ['EXEC_TIME'] , Action = ['ACTION'] , PlatformType = ['PLATFORM_TYPE'] , OsName = ['OS_NAME'] , OsVersion = ['OS_VERSION'] , TimeStamp = ['TIMESTAMP'] , StatusCode = ['STATUS_CODE'] , EventType = ['EVENT_TYPE'] , ReferrerUri = ['REFERRER_URI'] , UserAgent = ['USER_AGENT'] , BrowserType = ['BROWSER_TYPE'] , Time = ['TIME'] , ResponseSize = ['RESPONSE_SIZE'] , DeviceId = ['DEVICE_ID'] , DeviceModel = ['DEVICE_MODEL'] , SourceIp = ['SOURCE_IP'] , ClientIp = ['CLIENT_IP'] , Success = ['SUCCESS'] , Uri = ['URI'] , Url = ['URL'] , ClientName = ['CLIENT_NAME'] , UserType = ['USER_TYPE'] , UserInitiatedLogout = ['USER_INITIATED_LOGOUT'] , UserIdDerived = ['USER_ID_DERIVED'] , UserId = ['USER_ID'] , UserEmail = ['USER_EMAIL'] , UserName = ['USER_NAME'] , User = ['USER'] , UriIdDerived = ['URI_ID_DERIVED'] , UiEventType = ['UI_EVENT_TYPE'] , UiEventTimestamp = ['UI_EVENT_TIMESTAMP'] , UiEventSource = ['UI_EVENT_SOURCE'] , UiEventSequenceNum = ['UI_EVENT_SEQUENCE_NUM'] , UiEventId = ['UI_EVENT_ID'] , TlsProtocol = ['TLS_PROTOCOL'] , TimestampDerived = ['TIMESTAMP_DERIVED'] , TargetUiElement = ['TARGET_UI_ELEMENT'] , Sort = ['SORT'] , SessionType = ['SESSION_TYPE'] , SessionLevel = ['SESSION_LEVEL'] , SessionKey = ['SESSION_KEY'] , SearchQuery = ['SEARCH_QUERY'] , SdkVersion = ['SDK_VERSION'] , SdkAppVersion = ['SDK_APP_VERSION'] , SdkAppType = ['SDK_APP_TYPE'] , RunTime = ['RUN_TIME'] , RowsProcessed = ['ROWS_PROCESSED'] , RowCount = ['ROW_COUNT'] , ResolutionType = ['RESOLUTION_TYPE'] , RequestStatus = ['REQUEST_STATUS'] , RequestId = ['REQUEST_ID'] , ReportIdDerived = ['REPORT_ID_DERIVED'] , ReportId = ['REPORT_ID'] , RenderingType = ['RENDERING_TYPE'] , RelatedList = ['RELATED_LIST'] , RecordType = ['RECORD_TYPE'] , RecordId = ['RECORD_ID'] , Quiddity = ['QUIDDITY'] , QueryId = ['QUERY_ID'] , PrevpageUrl = ['PREVPAGE_URL'] , PrevpageEntityType = ['PREVPAGE_ENTITY_TYPE'] , PrevpageEntityId = ['PREVPAGE_ENTITY_ID'] , PrevpageContext = ['PREVPAGE_CONTEXT'] , PrevpageAppName = ['PREVPAGE_APP_NAME'] , PrefixesSearched = ['PREFIXES_SEARCHED'] , ParentUiElement = ['PARENT_UI_ELEMENT'] , PageUrl = ['PAGE_URL'] , PageStartTime = ['PAGE_START_TIME'] , PageEntityType = ['PAGE_ENTITY_TYPE'] , PageEntityId = ['PAGE_ENTITY_ID'] , PageContext = ['PAGE_CONTEXT'] , PageAppName = ['PAGE_APP_NAME'] , Origin = ['ORIGIN'] , OrganizationId = ['ORGANIZATION_ID'] , NumResults = ['NUM_RESULTS'] , NumberSoqlQueries = ['NUMBER_SOQL_QUERIES'] , NumberFields = ['NUMBER_FIELDS'] , NumberExceptionFilters = ['NUMBER_EXCEPTION_FILTERS'] , NumberColumns = ['NUMBER_COLUMNS'] , NumberBuckets = ['NUMBER_BUCKETS'] , MethodName = ['METHOD_NAME'] , Method = ['METHOD'] , MediaType = ['MEDIA_TYPE'] , LoginStatus = ['LOGIN_STATUS'] , LoginKey = ['LOGIN_KEY'] , HttpMethod = ['HTTP_METHOD'] , GrandparentUiElement = ['GRANDPARENT_UI_ELEMENT'] , EntryPoint = ['ENTRY_POINT'] , EntityName = ['ENTITY_NAME'] , Entity = ['ENTITY'] , EffectivePageTime = ['EFFECTIVE_PAGE_TIME'] , Duration = ['DURATION'] , DisplayType = ['DISPLAY_TYPE'] , DeviceSessionId = ['DEVICE_SESSION_ID'] , DevicePlatform = ['DEVICE_PLATFORM'] , DbTotalTime = ['DB_TOTAL_TIME'] , DbCpuTime = ['DB_CPU_TIME'] , DbBlocks = ['DB_BLOCKS'] , CpuTime = ['CPU_TIME'] , ConnectionType = ['CONNECTION_TYPE'] , ComponentName = ['COMPONENT_NAME'] , ClientVersion = ['CLIENT_VERSION'] , ClientId = ['CLIENT_ID'] , CipherSuite = ['CIPHER_SUITE'] , CalloutTime = ['CALLOUT_TIME'] , BrowserVersion = ['BROWSER_VERSION'] , BrowserName = ['BROWSER_NAME'] , AverageRowSize = ['AVERAGE_ROW_SIZE'] , AppType = ['APP_TYPE'] , AppName = ['APP_NAME'] , ApiVersion = ['API_VERSION'] , ApiType = ['API_TYPE'] , ArticleVersionId = ['ARTICLE_VERSION_ID'] , ArticleVersion = ['ARTICLE_VERSION'] , ArticleStatus = ['ARTICLE_STATUS'] , ArticleId = ['ARTICLE_ID'] , AnalyticsMode = ['ANALYTICS_MODE'] , BatchId = ['BATCH_ID'] , ClickedRecordId = ['CLICKED_RECORD_ID'] , ClassName = ['CLASS_NAME'] , ComponentIdDerived = ['COMPONENT_ID_DERIVED'] , ComponentId = ['COMPONENT_ID'] , ControllerType = ['CONTROLLER_TYPE'] , Context = ['CONTEXT'] , ConsoleIdDerived = ['CONSOLE_ID_DERIVED'] , ConsoleId = ['CONSOLE_ID'] , ClientInfo = ['CLIENT_INFO'] , DstBytes = ['DST_BYTES'] , DstUser = ['DST_USER'] , DstUserSid = ['DST_USER_SID'] , DstUserSidDerived = ['DST_USER_SID_DERIVED'] , Data = ['DATA'] , DashboardType = ['DASHBOARD_TYPE'] , DashboardIdDerived = ['DASHBOARD_ID_DERIVED'] , DashboardId = ['DASHBOARD_ID'] , DashboardComponentId = ['DASHBOARD_COMPONENT_ID'] , DvcAction = ['DVC_ACTION'] , DvcOs = ['DVC_OS'] , DvcOsName = ['DVC_OS_NAME'] , DvcOsVersion = ['DVC_OS_VERSION'] , DeliveryLocation = ['DELIVERY_LOCATION'] , DeliveryId = ['DELIVERY_ID'] , DocumentIdDerived = ['DOCUMENT_ID_DERIVED'] , DocumentId = ['DOCUMENT_ID'] , EntityType = ['ENTITY_TYPE'] , EntityId = ['ENTITY_ID'] , FileType = ['FILE_TYPE'] , FilePreviewType = ['FILE_PREVIEW_TYPE'] , ExceptionType = ['EXCEPTION_TYPE'] , ExceptionMessage = ['EXCEPTION_MESSAGE'] , Ept = ['EPT'] , EventCount = ['EVENT_COUNT'] , EventEndTime = ['EVENT_END_TIME'] , EventResult = ['EVENT_RESULT'] , FileSize = ['FILE_SIZE'] , HttpReferrerOriginal = ['HTTP_REFERRER_ORIGINAL'] , HttpUserAgentOriginal = ['HTTP_USER_AGENT_ORIGINAL'] , HttpUserAgent = ['HTTP_USER_AGENT'] , LogGroupId = ['LOG_GROUP_ID'] , LimitUsagePercent = ['LIMIT_USAGE_PERCENT'] , LicenseContext = ['LICENSE_CONTEXT'] , LastVersion = ['LAST_VERSION'] , Language = ['LANGUAGE'] , JobId = ['JOB_ID'] , IsSuccess = ['IS_SUCCESS'] , IsSecure = ['IS_SECURE'] , IsScheduled = ['IS_SCHEDULED'] , IsNew = ['IS_NEW'] , IsMobile = ['IS_MOBILE'] , IsLongRunningRequest = ['IS_LONG_RUNNING_REQUEST'] , IsGuest = ['IS_GUEST'] , IsFirstRequest = ['IS_FIRST_REQUEST'] , IsError = ['IS_ERROR'] , IsApi = ['IS_API'] , IsAjaxRequest = ['IS_AJAX_REQUEST'] , ManagedPackageNamespace = ['MANAGED_PACKAGE_NAMESPACE'] , HttpHeaders = ['HTTP_HEADERS'] , NetworkDuration = ['NETWORK_DURATION'] , Name = ['NAME'] , NumberFailures = ['NUMBER_FAILURES'] , NumClicks = ['NUM_CLICKS'] , OperationType = ['OPERATION_TYPE'] , NumSessions = ['NUM_SESSIONS'] , PageName = ['PAGE_NAME'] , Query = ['QUERY'] , RequestType = ['REQUEST_TYPE'] , ReportDescription = ['REPORT_DESCRIPTION'] , ReopenCount = ['REOPEN_COUNT'] , RelatedEntityId = ['RELATED_ENTITY_ID'] , RecordIdDerived = ['RECORD_ID_DERIVED'] , ReadTime = ['READ_TIME'] , Rank = ['RANK'] , SrcBytes = ['SRC_BYTES'] , SrcDvcId = ['SRC_DVC_ID'] , SrcDvcModelName = ['SRC_DVC_MODEL_NAME'] , SrcIpAddr = ['SRC_IP_ADDR'] , SrcNatIpAddr = ['SRC_NAT_IP_ADDR'] , SessionId = ['SESSION_ID'] , SiteId = ['SITE_ID'] , SharingPermission = ['SHARING_PERMISSION'] , SharingOperation = ['SHARING_OPERATION'] , SharedWithEntityId = ['SHARED_WITH_ENTITY_ID'] , UrlOriginal = ['URL_ORIGINAL'] , WaveTimeStamp = ['WAVE_TIMESTAMP'] , WaveSessionId = ['WAVE_SESSION_ID'] , ViewStateSize = ['VIEW_STATE_SIZE'] , VersionIdDerived = ['VERSION_ID_DERIVED'] , VersionId = ['VERSION_ID'] , TriggerType = ['TRIGGER_TYPE'] , TriggerName = ['TRIGGER_NAME'] , TriggerId = ['TRIGGER_ID'] , TransactionType = ['TRANSACTION_TYPE'] , TotalTime = ['TOTAL_TIME'] , TabId = ['TAB_ID'] , StackTrace = ['STACK_TRACE'] | project TimeGenerated , RequestSize , ExecTime , Action , PlatformType , OsName , OsVersion , TimeStamp , StatusCode , EventType , ReferrerUri , UserAgent , BrowserType , Time , ResponseSize , DeviceId , DeviceModel , SourceIp , ClientIp , Success , Uri , Url , ClientName , UserType , UserInitiatedLogout , UserIdDerived , UserId , UserEmail , UserName , User , UriIdDerived , UiEventType , UiEventTimestamp , UiEventSource , UiEventSequenceNum , UiEventId , TlsProtocol , TimestampDerived , TargetUiElement , Sort , SessionType , SessionLevel , SessionKey , SearchQuery , SdkVersion , SdkAppVersion , SdkAppType , RunTime , RowsProcessed , RowCount , ResolutionType , RequestStatus , RequestId , ReportIdDerived , ReportId , RenderingType , RelatedList , RecordType , RecordId , Quiddity , QueryId , PrevpageUrl , PrevpageEntityType , PrevpageEntityId , PrevpageContext , PrevpageAppName , PrefixesSearched , ParentUiElement , PageUrl , PageStartTime , PageEntityType , PageEntityId , PageContext , PageAppName , Origin , OrganizationId , NumResults , NumberSoqlQueries , NumberFields , NumberExceptionFilters , NumberColumns , NumberBuckets , MethodName , Method , MediaType , LoginStatus , LoginKey , HttpMethod , GrandparentUiElement , EntryPoint , EntityName , Entity , EffectivePageTime , Duration , DisplayType , DeviceSessionId , DevicePlatform , DbTotalTime , DbCpuTime , DbBlocks , CpuTime , ConnectionType , ComponentName , ClientVersion , ClientId , CipherSuite , CalloutTime , BrowserVersion , BrowserName , AverageRowSize , AppType , AppName , ApiVersion , ApiType , ArticleVersionId , ArticleVersion , ArticleStatus , ArticleId , AnalyticsMode , BatchId , ClickedRecordId , ClassName , ComponentIdDerived , ComponentId , ControllerType , Context , ConsoleIdDerived , ConsoleId , ClientInfo , DstBytes , DstUser , DstUserSid , DstUserSidDerived , Data , DashboardType , DashboardIdDerived , DashboardId , DashboardComponentId , DvcAction , DvcOs , DvcOsName , DvcOsVersion , DeliveryLocation , DeliveryId , DocumentIdDerived , DocumentId , EntityType , EntityId , FileType , FilePreviewType , ExceptionType , ExceptionMessage , Ept , EventCount , EventEndTime , EventResult , FileSize , HttpReferrerOriginal , HttpUserAgentOriginal , HttpUserAgent , LogGroupId , LimitUsagePercent , LicenseContext , LastVersion , Language , JobId , IsSuccess , IsSecure , IsScheduled , IsNew , IsMobile , IsLongRunningRequest , IsGuest , IsFirstRequest , IsError , IsApi , IsAjaxRequest , ManagedPackageNamespace , HttpHeaders , NetworkDuration , Name , NumberFailures , NumClicks , OperationType , NumSessions , PageName , Query , RequestType , ReportDescription , ReopenCount , RelatedEntityId , RecordIdDerived , ReadTime , Rank , SrcBytes , SrcDvcId , SrcDvcModelName , SrcIpAddr , SrcNatIpAddr , SessionId , SiteId , SharingPermission , SharingOperation , SharedWithEntityId , UrlOriginal , WaveTimeStamp , WaveSessionId , ViewStateSize , VersionIdDerived , VersionId , TriggerType , TriggerName , TriggerId , TransactionType , TotalTime , TabId , StackTrace"
                                    }
                                ]
                            }
                        },
                        {
                            "name": "[variables('_logAnalyticsTableId1')]",
                            "apiVersion": "2021-03-01-privatepreview",
                            "type": "Microsoft.OperationalInsights/workspaces/tables",
                            "location": "[parameters('workspace-location')]",
                            "kind": null,
                            "properties": {
                                "retentionInDays": 180,
                                "schema": {
                                    "name": "[variables('_logAnalyticsTableId1')]",
                                    "description": "Event Log data",
                                    "columns": [
                                        {
                                            "name": "TimeGenerated",
                                            "type": "datetime",
                                            "isDefaultDisplay": true
                                        },
                                        {
                                            "name": "RequestSize",
                                            "type": "string",
                                            "description": "The size of the request payload."
                                        },
                                        {
                                            "name": "ExecTime",
                                            "type": "string",
                                            "description": "The execution time of the request."
                                        },
                                        {
                                            "name": "Action",
                                            "type": "string",
                                            "description": "The action performed."
                                        },
                                        {
                                            "name": "PlatformType",
                                            "type": "string",
                                            "description": "The platform type."
                                        },
                                        {
                                            "name": "OsName",
                                            "type": "string",
                                            "description": "The operating system name."
                                        },
                                        {
                                            "name": "OsVersion",
                                            "type": "string",
                                            "description": "The operating system version."
                                        },
                                        {
                                            "name": "TimeStamp",
                                            "type": "string",
                                            "description": "The timestamp of the event."
                                        },
                                        {
                                            "name": "StatusCode",
                                            "type": "string",
                                            "description": "The status code of the response."
                                        },
                                        {
                                            "name": "EventType",
                                            "type": "string",
                                            "description": "The type of the event."
                                        },
                                        {
                                            "name": "ReferrerUri",
                                            "type": "string",
                                            "description": "The referrer URI."
                                        },
                                        {
                                            "name": "UserAgent",
                                            "type": "string",
                                            "description": "The user agent."
                                        },
                                        {
                                            "name": "BrowserType",
                                            "type": "string",
                                            "description": "The browser type."
                                        },
                                        {
                                            "name": "Time",
                                            "type": "string",
                                            "description": "The time of the event."
                                        },
                                        {
                                            "name": "ResponseSize",
                                            "type": "string",
                                            "description": "The size of the response payload."
                                        },
                                        {
                                            "name": "DeviceId",
                                            "type": "string",
                                            "description": "The device ID."
                                        },
                                        {
                                            "name": "DeviceModel",
                                            "type": "string",
                                            "description": "The device model."
                                        },
                                        {
                                            "name": "SourceIp",
                                            "type": "string",
                                            "description": "The source IP address."
                                        },
                                        {
                                            "name": "ClientIp",
                                            "type": "string",
                                            "description": "The client IP address."
                                        },
                                        {
                                            "name": "Success",
                                            "type": "string",
                                            "description": "Indicates if the request was successful."
                                        },
                                        {
                                            "name": "Uri",
                                            "type": "string",
                                            "description": "The URI of the request."
                                        },
                                        {
                                            "name": "Url",
                                            "type": "string",
                                            "description": "The URL of the request."
                                        },
                                        {
                                            "name": "ClientName",
                                            "type": "string",
                                            "description": "The name of the client."
                                        },
                                        {
                                            "name": "UserType",
                                            "type": "string",
                                            "description": "The type of the user."
                                        },
                                        {
                                            "name": "UserInitiatedLogout",
                                            "type": "string",
                                            "description": "Indicates if the logout was user-initiated."
                                        },
                                        {
                                            "name": "UserIdDerived",
                                            "type": "string",
                                            "description": "The derived user ID."
                                        },
                                        {
                                            "name": "UserId",
                                            "type": "string",
                                            "description": "The user ID."
                                        },
                                        {
                                            "name": "UserEmail",
                                            "type": "string",
                                            "description": "The user email."
                                        },
                                        {
                                            "name": "UserName",
                                            "type": "string",
                                            "description": "The user name."
                                        },
                                        {
                                            "name": "User",
                                            "type": "string",
                                            "description": "The user."
                                        },
                                        {
                                            "name": "UriIdDerived",
                                            "type": "string",
                                            "description": "The derived URI ID."
                                        },
                                        {
                                            "name": "UiEventType",
                                            "type": "string",
                                            "description": "The UI event type."
                                        },
                                        {
                                            "name": "UiEventTimestamp",
                                            "type": "string",
                                            "description": "The UI event timestamp."
                                        },
                                        {
                                            "name": "UiEventSource",
                                            "type": "string",
                                            "description": "The UI event source."
                                        },
                                        {
                                            "name": "UiEventSequenceNum",
                                            "type": "string",
                                            "description": "The UI event sequence number."
                                        },
                                        {
                                            "name": "UiEventId",
                                            "type": "string",
                                            "description": "The UI event ID."
                                        },
                                        {
                                            "name": "TlsProtocol",
                                            "type": "string",
                                            "description": "The TLS protocol."
                                        },
                                        {
                                            "name": "TimestampDerived",
                                            "type": "datetime",
                                            "description": "The derived timestamp."
                                        },
                                        {
                                            "name": "TargetUiElement",
                                            "type": "string",
                                            "description": "The target UI element."
                                        },
                                        {
                                            "name": "Sort",
                                            "type": "string",
                                            "description": "The sort order."
                                        },
                                        {
                                            "name": "SessionType",
                                            "type": "string",
                                            "description": "The session type."
                                        },
                                        {
                                            "name": "SessionLevel",
                                            "type": "string",
                                            "description": "The session level."
                                        },
                                        {
                                            "name": "SessionKey",
                                            "type": "string",
                                            "description": "The session key."
                                        },
                                        {
                                            "name": "SearchQuery",
                                            "type": "string",
                                            "description": "The search query."
                                        },
                                        {
                                            "name": "SdkVersion",
                                            "type": "string",
                                            "description": "The SDK version."
                                        },
                                        {
                                            "name": "SdkAppVersion",
                                            "type": "string",
                                            "description": "The SDK app version."
                                        },
                                        {
                                            "name": "SdkAppType",
                                            "type": "string",
                                            "description": "The SDK app type."
                                        },
                                        {
                                            "name": "RunTime",
                                            "type": "string",
                                            "description": "The run time."
                                        },
                                        {
                                            "name": "RowsProcessed",
                                            "type": "string",
                                            "description": "The rows processed."
                                        },
                                        {
                                            "name": "RowCount",
                                            "type": "string",
                                            "description": "The row count."
                                        },
                                        {
                                            "name": "ResolutionType",
                                            "type": "string",
                                            "description": "The resolution type."
                                        },
                                        {
                                            "name": "RequestStatus",
                                            "type": "string",
                                            "description": "The request status."
                                        },
                                        {
                                            "name": "RequestId",
                                            "type": "string",
                                            "description": "The request ID."
                                        },
                                        {
                                            "name": "ReportIdDerived",
                                            "type": "string",
                                            "description": "The derived report ID."
                                        },
                                        {
                                            "name": "ReportId",
                                            "type": "string",
                                            "description": "The report ID."
                                        },
                                        {
                                            "name": "RenderingType",
                                            "type": "string",
                                            "description": "The rendering type."
                                        },
                                        {
                                            "name": "RelatedList",
                                            "type": "string",
                                            "description": "The related list."
                                        },
                                        {
                                            "name": "RecordType",
                                            "type": "string",
                                            "description": "The record type."
                                        },
                                        {
                                            "name": "RecordId",
                                            "type": "string",
                                            "description": "The record ID."
                                        },
                                        {
                                            "name": "Quiddity",
                                            "type": "string",
                                            "description": "The quiddity."
                                        },
                                        {
                                            "name": "QueryId",
                                            "type": "string",
                                            "description": "The query ID."
                                        },
                                        {
                                            "name": "PrevpageUrl",
                                            "type": "string",
                                            "description": "The previous page URL."
                                        },
                                        {
                                            "name": "PrevpageEntityType",
                                            "type": "string",
                                            "description": "The previous page entity type."
                                        },
                                        {
                                            "name": "PrevpageEntityId",
                                            "type": "string",
                                            "description": "The previous page entity ID."
                                        },
                                        {
                                            "name": "PrevpageContext",
                                            "type": "string",
                                            "description": "The previous page context."
                                        },
                                        {
                                            "name": "PrevpageAppName",
                                            "type": "string",
                                            "description": "The previous page app name."
                                        },
                                        {
                                            "name": "PrefixesSearched",
                                            "type": "string",
                                            "description": "The prefixes searched."
                                        },
                                        {
                                            "name": "ParentUiElement",
                                            "type": "string",
                                            "description": "The parent UI element."
                                        },
                                        {
                                            "name": "PageUrl",
                                            "type": "string",
                                            "description": "The page URL."
                                        },
                                        {
                                            "name": "PageStartTime",
                                            "type": "string",
                                            "description": "The page start time."
                                        },
                                        {
                                            "name": "PageEntityType",
                                            "type": "string",
                                            "description": "The page entity type."
                                        },
                                        {
                                            "name": "PageEntityId",
                                            "type": "string",
                                            "description": "The page entity ID."
                                        },
                                        {
                                            "name": "PageContext",
                                            "type": "string",
                                            "description": "The page context."
                                        },
                                        {
                                            "name": "PageAppName",
                                            "type": "string",
                                            "description": "The page app name."
                                        },
                                        {
                                            "name": "Origin",
                                            "type": "string",
                                            "description": "The origin."
                                        },
                                        {
                                            "name": "OrganizationId",
                                            "type": "string",
                                            "description": "The organization ID."
                                        },
                                        {
                                            "name": "NumResults",
                                            "type": "string",
                                            "description": "The number of results."
                                        },
                                        {
                                            "name": "NumberSoqlQueries",
                                            "type": "string",
                                            "description": "The number of SOQL queries."
                                        },
                                        {
                                            "name": "NumberFields",
                                            "type": "string",
                                            "description": "The number of fields."
                                        },
                                        {
                                            "name": "NumberExceptionFilters",
                                            "type": "string",
                                            "description": "The number of exception filters."
                                        },
                                        {
                                            "name": "NumberColumns",
                                            "type": "string",
                                            "description": "The number of columns."
                                        },
                                        {
                                            "name": "NumberBuckets",
                                            "type": "string",
                                            "description": "The number of buckets."
                                        },
                                        {
                                            "name": "MethodName",
                                            "type": "string",
                                            "description": "The method name."
                                        },
                                        {
                                            "name": "Method",
                                            "type": "string",
                                            "description": "The method."
                                        },
                                        {
                                            "name": "MediaType",
                                            "type": "string",
                                            "description": "The media type."
                                        },
                                        {
                                            "name": "LoginStatus",
                                            "type": "string",
                                            "description": "The login status."
                                        },
                                        {
                                            "name": "LoginKey",
                                            "type": "string",
                                            "description": "The login key."
                                        },
                                        {
                                            "name": "HttpMethod",
                                            "type": "string",
                                            "description": "The HTTP method."
                                        },
                                        {
                                            "name": "GrandparentUiElement",
                                            "type": "string",
                                            "description": "The grandparent UI element."
                                        },
                                        {
                                            "name": "EntryPoint",
                                            "type": "string",
                                            "description": "The entry point."
                                        },
                                        {
                                            "name": "EntityName",
                                            "type": "string",
                                            "description": "The entity name."
                                        },
                                        {
                                            "name": "Entity",
                                            "type": "string",
                                            "description": "The entity."
                                        },
                                        {
                                            "name": "EffectivePageTime",
                                            "type": "string",
                                            "description": "The effective page time."
                                        },
                                        {
                                            "name": "Duration",
                                            "type": "string",
                                            "description": "The duration."
                                        },
                                        {
                                            "name": "DisplayType",
                                            "type": "string",
                                            "description": "The display type."
                                        },
                                        {
                                            "name": "DeviceSessionId",
                                            "type": "string",
                                            "description": "The device session ID."
                                        },
                                        {
                                            "name": "DevicePlatform",
                                            "type": "string",
                                            "description": "The device platform."
                                        },
                                        {
                                            "name": "DbTotalTime",
                                            "type": "string",
                                            "description": "The database total time."
                                        },
                                        {
                                            "name": "DbCpuTime",
                                            "type": "string",
                                            "description": "The database CPU time."
                                        },
                                        {
                                            "name": "DbBlocks",
                                            "type": "string",
                                            "description": "The database blocks."
                                        },
                                        {
                                            "name": "CpuTime",
                                            "type": "string",
                                            "description": "The CPU time."
                                        },
                                        {
                                            "name": "ConnectionType",
                                            "type": "string",
                                            "description": "The connection type."
                                        },
                                        {
                                            "name": "ComponentName",
                                            "type": "string",
                                            "description": "The component name."
                                        },
                                        {
                                            "name": "ClientVersion",
                                            "type": "string",
                                            "description": "The client version."
                                        },
                                        {
                                            "name": "ClientId",
                                            "type": "string",
                                            "description": "The client ID."
                                        },
                                        {
                                            "name": "CipherSuite",
                                            "type": "string",
                                            "description": "The cipher suite."
                                        },
                                        {
                                            "name": "CalloutTime",
                                            "type": "string",
                                            "description": "The callout time."
                                        },
                                        {
                                            "name": "BrowserVersion",
                                            "type": "string",
                                            "description": "The browser version."
                                        },
                                        {
                                            "name": "BrowserName",
                                            "type": "string",
                                            "description": "The browser name."
                                        },
                                        {
                                            "name": "AverageRowSize",
                                            "type": "string",
                                            "description": "The average row size."
                                        },
                                        {
                                            "name": "AppType",
                                            "type": "string",
                                            "description": "The app type."
                                        },
                                        {
                                            "name": "AppName",
                                            "type": "string",
                                            "description": "The app name."
                                        },
                                        {
                                            "name": "ApiVersion",
                                            "type": "string",
                                            "description": "The API version."
                                        },
                                        {
                                            "name": "ApiType",
                                            "type": "string",
                                            "description": "The API type."
                                        },
                                        {
                                            "name": "ArticleVersionId",
                                            "type": "string",
                                            "description": "The article version ID."
                                        },
                                        {
                                            "name": "ArticleVersion",
                                            "type": "string",
                                            "description": "The article version."
                                        },
                                        {
                                            "name": "ArticleStatus",
                                            "type": "string",
                                            "description": "The article status."
                                        },
                                        {
                                            "name": "ArticleId",
                                            "type": "string",
                                            "description": "The article ID."
                                        },
                                        {
                                            "name": "AnalyticsMode",
                                            "type": "string",
                                            "description": "The analytics mode."
                                        },
                                        {
                                            "name": "BatchId",
                                            "type": "string",
                                            "description": "The batch ID."
                                        },
                                        {
                                            "name": "ClickedRecordId",
                                            "type": "string",
                                            "description": "The clicked record ID."
                                        },
                                        {
                                            "name": "ClassName",
                                            "type": "string",
                                            "description": "The class name."
                                        },
                                        {
                                            "name": "ComponentIdDerived",
                                            "type": "string",
                                            "description": "The component ID derived."
                                        },
                                        {
                                            "name": "ComponentId",
                                            "type": "string",
                                            "description": "The component ID."
                                        },
                                        {
                                            "name": "ControllerType",
                                            "type": "string",
                                            "description": "The controller type."
                                        },
                                        {
                                            "name": "Context",
                                            "type": "string",
                                            "description": "The context."
                                        },
                                        {
                                            "name": "ConsoleIdDerived",
                                            "type": "string",
                                            "description": "The console ID derived."
                                        },
                                        {
                                            "name": "ConsoleId",
                                            "type": "string",
                                            "description": "The console ID."
                                        },
                                        {
                                            "name": "ClientInfo",
                                            "type": "string",
                                            "description": "The client info."
                                        },
                                        {
                                            "name": "DstBytes",
                                            "type": "string",
                                            "description": "The destination bytes."
                                        },
                                        {
                                            "name": "DstUser",
                                            "type": "string",
                                            "description": "The destination user."
                                        },
                                        {
                                            "name": "DstUserSid",
                                            "type": "string",
                                            "description": "The destination user SID."
                                        },
                                        {
                                            "name": "DstUserSidDerived",
                                            "type": "string",
                                            "description": "The destination user SID derived."
                                        },
                                        {
                                            "name": "Data",
                                            "type": "string",
                                            "description": "The data."
                                        },
                                        {
                                            "name": "DashboardType",
                                            "type": "string",
                                            "description": "The dashboard type."
                                        },
                                        {
                                            "name": "DashboardIdDerived",
                                            "type": "string",
                                            "description": "The dashboard ID derived."
                                        },
                                        {
                                            "name": "DashboardId",
                                            "type": "string",
                                            "description": "The dashboard ID."
                                        },
                                        {
                                            "name": "DashboardComponentId",
                                            "type": "string",
                                            "description": "The dashboard component ID."
                                        },
                                        {
                                            "name": "DvcAction",
                                            "type": "string",
                                            "description": "The DVC action."
                                        },
                                        {
                                            "name": "DvcOs",
                                            "type": "string",
                                            "description": "The DVC OS."
                                        },
                                        {
                                            "name": "DvcOsName",
                                            "type": "string",
                                            "description": "The DVC OS name."
                                        },
                                        {
                                            "name": "DvcOsVersion",
                                            "type": "string",
                                            "description": "The DVC OS version."
                                        },
                                        {
                                            "name": "DeliveryLocation",
                                            "type": "string",
                                            "description": "The delivery location."
                                        },
                                        {
                                            "name": "DeliveryId",
                                            "type": "string",
                                            "description": "The delivery ID."
                                        },
                                        {
                                            "name": "DocumentIdDerived",
                                            "type": "string",
                                            "description": "The document ID derived."
                                        },
                                        {
                                            "name": "DocumentId",
                                            "type": "string",
                                            "description": "The document ID."
                                        },
                                        {
                                            "name": "EntityType",
                                            "type": "string",
                                            "description": "The entity type."
                                        },
                                        {
                                            "name": "EntityId",
                                            "type": "string",
                                            "description": "The entity ID."
                                        },
                                        {
                                            "name": "FileType",
                                            "type": "string",
                                            "description": "The file type."
                                        },
                                        {
                                            "name": "FilePreviewType",
                                            "type": "string",
                                            "description": "The file preview type."
                                        },
                                        {
                                            "name": "ExceptionType",
                                            "type": "string",
                                            "description": "The exception type."
                                        },
                                        {
                                            "name": "ExceptionMessage",
                                            "type": "string",
                                            "description": "The exception message."
                                        },
                                        {
                                            "name": "Ept",
                                            "type": "string",
                                            "description": "The EPT."
                                        },
                                        {
                                            "name": "EventCount",
                                            "type": "string",
                                            "description": "The event count."
                                        },
                                        {
                                            "name": "EventEndTime",
                                            "type": "string",
                                            "description": "The event end time."
                                        },
                                        {
                                            "name": "EventResult",
                                            "type": "string",
                                            "description": "The event result."
                                        },
                                        {
                                            "name": "FileSize",
                                            "type": "string",
                                            "description": "The file size."
                                        },
                                        {
                                            "name": "HttpReferrerOriginal",
                                            "type": "string",
                                            "description": "The HTTP referrer original."
                                        },
                                        {
                                            "name": "HttpUserAgentOriginal",
                                            "type": "string",
                                            "description": "The HTTP user agent original."
                                        },
                                        {
                                            "name": "HttpUserAgent",
                                            "type": "string",
                                            "description": "The HTTP user agent."
                                        },
                                        {
                                            "name": "LogGroupId",
                                            "type": "string",
                                            "description": "The log group ID."
                                        },
                                        {
                                            "name": "LimitUsagePercent",
                                            "type": "string",
                                            "description": "The limit usage percent."
                                        },
                                        {
                                            "name": "LicenseContext",
                                            "type": "string",
                                            "description": "The license context."
                                        },
                                        {
                                            "name": "LastVersion",
                                            "type": "string",
                                            "description": "The last version."
                                        },
                                        {
                                            "name": "Language",
                                            "type": "string",
                                            "description": "The language."
                                        },
                                        {
                                            "name": "JobId",
                                            "type": "string",
                                            "description": "The job ID."
                                        },
                                        {
                                            "name": "IsSuccess",
                                            "type": "string",
                                            "description": "Indicates if the operation was successful."
                                        },
                                        {
                                            "name": "IsSecure",
                                            "type": "string",
                                            "description": "Indicates if the connection is secure."
                                        },
                                        {
                                            "name": "IsScheduled",
                                            "type": "string",
                                            "description": "Indicates if the job is scheduled."
                                        },
                                        {
                                            "name": "IsNew",
                                            "type": "string",
                                            "description": "Indicates if the job is new."
                                        },
                                        {
                                            "name": "IsMobile",
                                            "type": "string",
                                            "description": "Indicates if the job is mobile."
                                        },
                                        {
                                            "name": "IsLongRunningRequest",
                                            "type": "string",
                                            "description": "Indicates if the job is a long-running request."
                                        },
                                        {
                                            "name": "IsGuest",
                                            "type": "string",
                                            "description": "Indicates if the user is a guest."
                                        },
                                        {
                                            "name": "IsFirstRequest",
                                            "type": "string",
                                            "description": "Indicates if this is the first request."
                                        },
                                        {
                                            "name": "IsError",
                                            "type": "string",
                                            "description": "Indicates if there was an error."
                                        },
                                        {
                                            "name": "IsApi",
                                            "type": "string",
                                            "description": "Indicates if the request is an API request."
                                        },
                                        {
                                            "name": "IsAjaxRequest",
                                            "type": "string",
                                            "description": "Indicates if the request is an AJAX request."
                                        },
                                        {
                                            "name": "ManagedPackageNamespace",
                                            "type": "string",
                                            "description": "The managed package namespace."
                                        },
                                        {
                                            "name": "HttpHeaders",
                                            "type": "string",
                                            "description": "The HTTP headers."
                                        },
                                        {
                                            "name": "NetworkDuration",
                                            "type": "string",
                                            "description": "The network duration."
                                        },
                                        {
                                            "name": "Name",
                                            "type": "string",
                                            "description": "The name."
                                        },
                                        {
                                            "name": "NumberFailures",
                                            "type": "string",
                                            "description": "The number of failures."
                                        },
                                        {
                                            "name": "NumClicks",
                                            "type": "string",
                                            "description": "The number of clicks."
                                        },
                                        {
                                            "name": "OperationType",
                                            "type": "string",
                                            "description": "The operation type."
                                        },
                                        {
                                            "name": "NumSessions",
                                            "type": "string",
                                            "description": "The number of sessions."
                                        },
                                        {
                                            "name": "PageName",
                                            "type": "string",
                                            "description": "The page name."
                                        },
                                        {
                                            "name": "Query",
                                            "type": "string",
                                            "description": "The query."
                                        },
                                        {
                                            "name": "RequestType",
                                            "type": "string",
                                            "description": "The request type."
                                        },
                                        {
                                            "name": "ReportDescription",
                                            "type": "string",
                                            "description": "The report description."
                                        },
                                        {
                                            "name": "ReopenCount",
                                            "type": "string",
                                            "description": "The reopen count."
                                        },
                                        {
                                            "name": "RelatedEntityId",
                                            "type": "string",
                                            "description": "The related entity ID."
                                        },
                                        {
                                            "name": "RecordIdDerived",
                                            "type": "string",
                                            "description": "The derived record ID."
                                        },
                                        {
                                            "name": "ReadTime",
                                            "type": "string",
                                            "description": "The read time."
                                        },
                                        {
                                            "name": "Rank",
                                            "type": "string",
                                            "description": "The rank."
                                        },
                                        {
                                            "name": "SrcBytes",
                                            "type": "string",
                                            "description": "The source bytes."
                                        },
                                        {
                                            "name": "SrcDvcId",
                                            "type": "string",
                                            "description": "The source device ID."
                                        },
                                        {
                                            "name": "SrcDvcModelName",
                                            "type": "string",
                                            "description": "The source device model name."
                                        },
                                        {
                                            "name": "SrcIpAddr",
                                            "type": "string",
                                            "description": "The source IP address."
                                        },
                                        {
                                            "name": "SrcNatIpAddr",
                                            "type": "string",
                                            "description": "The source NAT IP address."
                                        },
                                        {
                                            "name": "SessionId",
                                            "type": "string",
                                            "description": "The session ID."
                                        },
                                        {
                                            "name": "SiteId",
                                            "type": "string",
                                            "description": "The site ID."
                                        },
                                        {
                                            "name": "SharingPermission",
                                            "type": "string",
                                            "description": "The sharing permission."
                                        },
                                        {
                                            "name": "SharingOperation",
                                            "type": "string",
                                            "description": "The sharing operation."
                                        },
                                        {
                                            "name": "SharedWithEntityId",
                                            "type": "string",
                                            "description": "The shared with entity ID."
                                        },
                                        {
                                            "name": "UrlOriginal",
                                            "type": "string",
                                            "description": "The original URL."
                                        },
                                        {
                                            "name": "WaveTimeStamp",
                                            "type": "string",
                                            "description": "The wave timestamp."
                                        },
                                        {
                                            "name": "WaveSessionId",
                                            "type": "string",
                                            "description": "The wave session ID."
                                        },
                                        {
                                            "name": "ViewStateSize",
                                            "type": "string",
                                            "description": "The view state size."
                                        },
                                        {
                                            "name": "VersionIdDerived",
                                            "type": "string",
                                            "description": "The derived version ID."
                                        },
                                        {
                                            "name": "VersionId",
                                            "type": "string",
                                            "description": "The version ID."
                                        },
                                        {
                                            "name": "TriggerType",
                                            "type": "string",
                                            "description": "The trigger type."
                                        },
                                        {
                                            "name": "TriggerName",
                                            "type": "string",
                                            "description": "The trigger name."
                                        },
                                        {
                                            "name": "TriggerId",
                                            "type": "string",
                                            "description": "The trigger ID."
                                        },
                                        {
                                            "name": "TransactionType",
                                            "type": "string",
                                            "description": "The transaction type."
                                        },
                                        {
                                            "name": "TotalTime",
                                            "type": "string",
                                            "description": "The total time."
                                        },
                                        {
                                            "name": "TabId",
                                            "type": "string",
                                            "description": "The tab ID."
                                        },
                                        {
                                            "name": "StackTrace",
                                            "type": "string",
                                            "description": "The stack trace."
                                        }
                                    ]
                                }
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "[variables('_solutionVersion')]",
                "packageName": "[variables('_solutionName')]",
                "contentProductId": "[concat(substring(variables('_solutionId'), 0, 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition'),'-', variables('dataConnectorVersionConnectorDefinition'))))]",
                "packageId": "[variables('_solutionId')]",
                "contentSchemaVersion": "3.0.0",
                "version": "[variables('_solutionVersion')]"
            }
        },
        {
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition'))]",
            "apiVersion": "2022-09-01-preview",
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
            "location": "[parameters('workspace-location')]",
            "kind": "Customizable",
            "properties": {
                "connectorUiConfig": {
                    "id": "SalesforceServiceCloudCCPDefinition",
                    "title": "Salesforce Service Cloud (via Codeless Connector Framework)",
                    "publisher": "Microsoft",
                    "descriptionMarkdown": "The Salesforce Service Cloud data connector provides the capability to ingest information about your Salesforce operational events into Microsoft Sentinel through the REST API. The connector provides ability to review events in your org on an accelerated basis, get [event log files](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/event_log_file_hourly_overview.htm) in hourly increments for recent activity.",
                    "graphQueriesTableName": "SalesforceServiceCloudV2_CL",
                    "graphQueries": [
                        {
                            "metricName": "Total data received",
                            "legend": "Salesforce Service Cloud EventLogFile Events",
                            "baseQuery": "{{graphQueriesTableName}}"
                        }
                    ],
                    "sampleQueries": [
                        {
                            "description": "Get a sample of Salesforce Service Cloud Event Log File Events",
                            "query": "{{graphQueriesTableName}}\n| take 10"
                        }
                    ],
                    "dataTypes": [
                        {
                            "name": "{{graphQueriesTableName}}",
                            "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                        }
                    ],
                    "connectivityCriteria": [
                        {
                            "type": "HasDataConnectors"
                        }
                    ],
                    "availability": {
                        "isPreview": false,
                        "status": 1
                    },
                    "permissions": {
                        "resourceProvider": [
                            {
                                "provider": "Microsoft.OperationalInsights/workspaces",
                                "permissionsDisplayText": "Read and Write permissions are required.",
                                "providerDisplayName": "Workspace",
                                "scope": "Workspace",
                                "requiredPermissions": {
                                    "write": true,
                                    "read": true,
                                    "delete": true,
                                    "action": false
                                }
                            }
                        ],
                        "customs": [
                            {
                                "name": "Salesforce Service Cloud API access",
                                "description": "Access to the Salesforce Service Cloud API through a Connected App is required."
                            }
                        ]
                    },
                    "instructionSteps": [
                        {
                            "title": "Connect to Salesforce Service Cloud API to start collecting event logs in Microsoft Sentinel",
                            "description": "Follow [Create a Connected App in Salesforce for OAuth](https://help.salesforce.com/s/articleView?id=platform.ev_relay_create_connected_app.htm&type=5) and [Configure a Connected App for the OAuth 2.0 Client Credentials Flow](https://help.salesforce.com/s/articleView?id=xcloud.connected_app_client_credentials_setup.htm&type=5) to create a Connected App with access to the Salesforce Service Cloud API. Through those instructions, you should get the Consumer Key and Consumer Secret.\n For Salesforce Domain name, Go to Setup, type My Domain in the Quick Find box, and select My Domain to view your domain details. Make sure to enter the domain name without a trailing slash (e.g., https://your-domain.my.salesforce.com). Fill the form below with that information.",
                            "instructions": [
                                {
                                    "type": "Textbox",
                                    "parameters": {
                                        "label": "Salesforce Domain Name",
                                        "placeholder": "Salesforce Domain Name",
                                        "type": "text",
                                        "name": "salesforceDomainName",
                                        "validations": {
                                            "required": true
                                        }
                                    }
                                },
                                {
                                    "type": "Dropdown",
                                    "parameters": {
                                        "label": "Log Collection Interval",
                                        "name": "queryType",
                                        "options": [
                                            {
                                                "key": "SELECT Id,EventType,LogDate,Interval,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE Interval='Hourly' and CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                                                "text": "Hourly"
                                            },
                                            {
                                                "key": "SELECT Id,EventType,LogDate,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                                                "text": "Daily"
                                            }
                                        ],
                                        "placeholder": "Select an interval type",
                                        "isMultiSelect": false,
                                        "required": true
                                    }
                                },
                                {
                                    "type": "OAuthForm",
                                    "parameters": {
                                        "clientIdLabel": "Consumer Key",
                                        "clientSecretLabel": "Consumer Secret",
                                        "clientIdPlaceholder": "Enter Connected App Consumer Key",
                                        "clientSecretPlaceholder": "Enter Connected App Consumer Secret",
                                        "connectButtonLabel": "Connect",
                                        "disconnectButtonLabel": "Disconnect"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition')))]",
            "apiVersion": "2022-01-01-preview",
            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
            "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersionConnectorDefinition')]",
                "source": {
                    "sourceId": "[variables('_solutionId')]",
                    "name": "[variables('_solutionName')]",
                    "kind": "Solution"
                },
                "author": {
                    "name": "[variables('_solutionAuthor')]"
                },
                "support": {
                    "name": "[variables('_solutionAuthor')]",
                    "tier": "[variables('_solutionTier')]"
                },
                "dependencies": {
                    "criteria": [
                        {
                            "version": "[variables('dataConnectorVersionConnections')]",
                            "contentId": "[variables('_dataConnectorContentIdConnections')]",
                            "kind": "ResourcesDataConnector"
                        }
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections'), variables('dataConnectorVersionConnections'))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
            ],
            "properties": {
                "contentId": "[variables('_dataConnectorContentIdConnections')]",
                "displayName": "[concat(variables('_solutionName'), variables('dataConnectorTemplateNameConnections'))]",
                "contentKind": "ResourcesDataConnector",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "[variables('dataConnectorVersionConnections')]",
                    "parameters": {
                        "connectorDefinitionName": {
                            "defaultValue": "connectorDefinitionName",
                            "type": "string",
                            "minLength": 1
                        },
                        "workspace": {
                            "defaultValue": "[parameters('workspace')]",
                            "type": "string"
                        },
                        "dcrConfig": {
                            "defaultValue": {
                                "dataCollectionEndpoint": "data collection Endpoint",
                                "dataCollectionRuleImmutableId": "data collection rule immutableId"
                            },
                            "type": "object"
                        },
                        "salesforceDomainName": {
                            "defaultValue": "salesforceDomainName",
                            "type": "string"
                        },
                        "queryType": {
                            "type": "array",
                            "defaultValue": "SELECT Id,EventType,LogDate,Interval,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE Interval='Hourly' and CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}"
                        },
                        "ClientId": {
                            "defaultValue": "-NA-",
                            "type": "securestring",
                            "minLength": 1
                        },
                        "ClientSecret": {
                            "defaultValue": "-NA-",
                            "type": "securestring",
                            "minLength": 1
                        },
                        "AuthorizationCode": {
                            "defaultValue": "-NA-",
                            "type": "securestring",
                            "minLength": 1
                        }
                    },
                    "variables": {
                        "_dataConnectorContentIdConnections": "[variables('_dataConnectorContentIdConnections')]"
                    },
                    "resources": [
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections')))]",
                            "apiVersion": "2022-01-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "properties": {
                                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections'))]",
                                "contentId": "[variables('_dataConnectorContentIdConnections')]",
                                "kind": "ResourcesDataConnector",
                                "version": "[variables('dataConnectorVersionConnections')]",
                                "source": {
                                    "sourceId": "[variables('_solutionId')]",
                                    "name": "[variables('_solutionName')]",
                                    "kind": "Solution"
                                },
                                "author": {
                                    "name": "[variables('_solutionAuthor')]"
                                },
                                "support": {
                                    "name": "[variables('_solutionAuthor')]",
                                    "tier": "[variables('_solutionTier')]"
                                }
                            }
                        },
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'SalesforceServiceCloudPolling')]",
                            "apiVersion": "2022-12-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
                            "location": "[parameters('workspace-location')]",
                            "kind": "RestApiPoller",
                            "properties": {
                                "auth": {
                                    "type": "OAuth2",
                                    "ClientId": "[[parameters('ClientId')]",
                                    "ClientSecret": "[[parameters('ClientSecret')]",
                                    "GrantType": "client_credentials",
                                    "TokenEndpoint": "[[concat(parameters('salesforceDomainName'),'/services/oauth2/token')]",
                                    "TokenEndpointHeaders": {
                                        "Accept": "application/json",
                                        "Content-Type": "application/x-www-form-urlencoded"
                                    },
                                    "TokenEndpointQueryParameters": {
                                        
                                    }
                                },
                                "request": {
                                    "apiEndpoint": "[[concat(parameters('salesforceDomainName'),'/services/data/v65.0/query')]",
                                    "httpMethod": "GET",
                                    "rateLimitQPS": 10,
                                    "queryWindowInMin": 10,
                                    "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                                    "retryCount": 3,
                                    "timeoutInSeconds": 60,
                                    "headers": {
                                        "Accept": "application/json",
                                        "User-Agent": "Scuba"
                                    },
                                    "queryParameters": {
                                        "q": "[[parameters('queryType')[0]]"
                                    }
                                },
                                "response": {
                                    "eventsJsonPaths": [
                                        "$.records"
                                    ],
                                    "format": "json"
                                },
                                "paging": {
                                    "pagingType": "NextPageUrl",
                                    "nextPageUrl": "[[parameters('salesforceDomainName')]",
                                    "nextPageTokenJsonPath": "$.nextRecordsUrl",
                                    "isNextPageTokenRelativeUrl": true
                                },
                                "stepInfo": {
                                    "stepType": "Nested",
                                    "nextSteps": [
                                        {
                                            "stepId": "fetchLogFileData",
                                            "stepPlaceholdersParsingKql": "source | project res = parse_json(data) | project logFileUrl = res.LogFile"
                                        }
                                    ]
                                },
                                "stepCollectorConfigs": {
                                    "fetchLogFileData": {
                                        "shouldJoinNestedData": true,
                                        "joinedDataStepName": "LogData",
                                        "request": {
                                            "apiEndpoint": "[[concat(parameters('salesforceDomainName'),'$logFileUrl$')]",
                                            "httpMethod": "GET",
                                            "headers": {
                                                "Accept": "application/json",
                                                "User-Agent": "Scuba"
                                            }
                                        },
                                        "response": {
                                            "eventsJsonPaths": [
                                                "$"
                                            ],
                                            "format": "csv",
                                            "hasCsvHeader": true
                                        }
                                    }
                                },
                                "connectorDefinitionName": "[[parameters('connectorDefinitionName')]",
                                "dataType": "SalesforceServiceCloudV2_CL",
                                "dcrConfig": {
                                    "streamName": "Custom-SalesforceServiceCloudV2_CL",
                                    "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                                    "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                                }
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "[variables('_solutionVersion')]",
                "packageName": "[variables('_solutionName')]",
                "contentProductId": "[concat(substring(variables('_solutionId'), 0, 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections'),'-', variables('dataConnectorVersionConnections'))))]",
                "packageId": "[variables('_solutionId')]",
                "contentSchemaVersion": "3.0.0",
                "version": "[variables('_solutionVersion')]"
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]",
            "location": "[parameters('workspace-location')]",
            "apiVersion": "2023-04-01-preview",
            "properties": {
                "version": "[variables('_solutionVersion')]",
                "kind": "Solution",
                "contentSchemaVersion": "3.0.0",
                "contentId": "[variables('_solutionId')]",
                "source": {
                    "kind": "Solution",
                    "name": "[variables('_solutionName')]",
                    "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                    "name": "[variables('_solutionAuthor')]"
                },
                "support": {
                    "name": "[variables('_solutionAuthor')]"
                },
                "dependencies": {
                    "operator": "AND",
                    "criteria": [
                        {
                            "kind": "DataConnector",
                            "contentId": "[variables('dataConnectorVersionConnectorDefinition')]",
                            "version": "[variables('_dataConnectorContentIdConnectorDefinition')]"
                        }
                    ]
                },
                "firstPublishDate": "2022-06-24",
                "providers": [
                    "[variables('_solutionAuthor')]"
                ],
                "contentKind": "Solution",
                "packageId": "[variables('_solutionId')]",
                "contentProductId": "[concat(substring(variables('_solutionId'), 0, 50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]",
                "displayName": "[variables('_solutionName')]",
                "publisherDisplayName": "[variables('_solutionId')]",
                "descriptionHtml": "test",
                "icon": "[variables('_packageIcon')]"
            }
        }
    ]
}
