{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Microsoft - support@microsoft.com",
    "comments": "Solution template for Salesforce Service Cloud"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Salesforce Service Cloud",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "email": "support@microsoft.com",
    "_email": "[variables('email')]",
    "_solutionName": "Salesforce Service Cloud",
    "_solutionVersion": "3.0.9",
    "solutionId": "azuresentinel.azure-sentinel-solution-salesforceservicecloud",
    "_solutionId": "[variables('solutionId')]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.4",
      "_analyticRulecontentId1": "5a6ce089-e756-40fb-b022-c8e8864a973a",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '5a6ce089-e756-40fb-b022-c8e8864a973a')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('5a6ce089-e756-40fb-b022-c8e8864a973a')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','5a6ce089-e756-40fb-b022-c8e8864a973a','-', '1.0.4')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.0.4",
      "_analyticRulecontentId2": "64d16e62-1a17-4a35-9ea7-2b9fe6f07118",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '64d16e62-1a17-4a35-9ea7-2b9fe6f07118')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('64d16e62-1a17-4a35-9ea7-2b9fe6f07118')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','64d16e62-1a17-4a35-9ea7-2b9fe6f07118','-', '1.0.4')))]"
    },
    "analyticRuleObject3": {
      "analyticRuleVersion3": "1.0.4",
      "_analyticRulecontentId3": "3094e036-e5ae-4d6e-8626-b0f86ebc71f2",
      "analyticRuleId3": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '3094e036-e5ae-4d6e-8626-b0f86ebc71f2')]",
      "analyticRuleTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('3094e036-e5ae-4d6e-8626-b0f86ebc71f2')))]",
      "_analyticRulecontentProductId3": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','3094e036-e5ae-4d6e-8626-b0f86ebc71f2','-', '1.0.4')))]"
    },
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "dataConnectorCCPVersion": "1.0.0",
    "_dataConnectorContentIdConnectorDefinition1": "SalesforceServiceCloudCCPDefinition",
    "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
    "_dataConnectorContentIdConnections1": "SalesforceServiceCloudCCPDefinitionConnections",
    "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
    "dataCollectionEndpointId1": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "blanks": "[replace('b', 'b', '')]",
    "parserObject1": {
      "_parserName1": "[concat(parameters('workspace'),'/','SalesforceServiceCloud')]",
      "_parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'SalesforceServiceCloud')]",
      "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('SalesforceServiceCloud-Parser')))]",
      "parserVersion1": "1.0.0",
      "parserContentId1": "SalesforceServiceCloud-Parser"
    },
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "SalesforceServiceCloudWorkbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]",
    "stepId": "fetchLogFileData",
    "_stepId": "[variables('stepId')]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Salesforce-BruteForce_AnalyticalRules Analytics Rule with template version 3.0.9",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Identifies evidence of brute force activity against a user based on multiple authentication failures and at least one successful authentication within a given time window. This query limits IPAddresses to 100 and may not potentially cover all IPAddresses.\nThe default failure threshold is 10, success threshold is 1, and the default time window is 20 minutes.",
                "displayName": "Brute force attack against user credentials",
                "enabled": false,
                "query": "let failureCountThreshold = 10;\nlet successCountThreshold = 1;\nlet Failures =\nSalesforceServiceCloud\n| where EventType == \"Login\" and LoginStatus != \"LOGIN_NO_ERROR\"\n| summarize\n      FailureStartTime = min(TimeGenerated),\n      FailureEndTime = max(TimeGenerated),\n      IpAddresses = make_set (ClientIp, 100),\n      FailureCount = count() by User, UserId, UserType;\n  SalesforceServiceCloud\n  | where EventType == \"Login\" and LoginStatus == \"LOGIN_NO_ERROR\"\n  | summarize\n          SuccessStartTime = min(TimeGenerated),\n          SuccessEndTime = max(TimeGenerated),\n          IpAddresses = make_set (ClientIp, 100),\n          SuccessCount = count() by User, UserId, UserType\n  | join kind=leftouter Failures on UserId\n  | where FailureCount >= failureCountThreshold and SuccessCount >= successCountThreshold\n  | where FailureEndTime < SuccessStartTime\n  | project User, EventStartTime = FailureStartTime, EventEndTime = SuccessEndTime, IpAddresses\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "SalesforceServiceCloud"
                    ],
                    "connectorId": "SalesforceServiceCloudCCPDefinition"
                  }
                ],
                "tactics": [
                  "CredentialAccess"
                ],
                "techniques": [
                  "T1110"
                ],
                "entityMappings": [
                  {
                    "entityType": "Account",
                    "fieldMappings": [
                      {
                        "identifier": "FullName",
                        "columnName": "User"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "EventEndTime": "SuccessEndTime",
                  "EventStartTime": "FailureStartTime",
                  "IPAddresses": "IpAddresses"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "Salesforce Service Cloud Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "Salesforce Service Cloud",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "Brute force attack against user credentials",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Salesforce-PasswordSpray_AnalyticalRules Analytics Rule with template version 3.0.9",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "This query searches for failed attempts to log in from more than 15 various users within a 5 minutes timeframe from the same source. This is a potential indication of a password spray attack.",
                "displayName": "Potential Password Spray Attack",
                "enabled": false,
                "query": "let FailureThreshold = 15;  \nSalesforceServiceCloud\n| where EventType =~ 'Login' and  LoginStatus != 'LOGIN_NO_ERROR'\n| where LoginStatus  in~ ('LOGIN_ERROR_INVALID_PASSWORD', 'LOGIN_ERROR_SSO_PWD_INVALID')\n| extend TimestampDerived = todatetime(TimestampDerived)\n| summarize UserCount=dcount(UserId), Users = make_set(UserId,100) by ClientIp, bin(TimestampDerived, 5m)\n| where UserCount > FailureThreshold\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "SalesforceServiceCloud"
                    ],
                    "connectorId": "SalesforceServiceCloudCCPDefinition"
                  }
                ],
                "tactics": [
                  "CredentialAccess"
                ],
                "techniques": [
                  "T1110"
                ],
                "entityMappings": [
                  {
                    "entityType": "IP",
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "ClientIp"
                      }
                    ]
                  }
                ],
                "customDetails": {
                  "Users": "Users"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "Salesforce Service Cloud Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "Salesforce Service Cloud",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "Potential Password Spray Attack",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject3').analyticRuleTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Salesforce-SigninsMultipleCountries_AnalyticalRules Analytics Rule with template version 3.0.9",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject3').analyticRuleVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "This query searches for successful user logins from different countries within 30 mins.",
                "displayName": "User Sign in from different countries",
                "enabled": false,
                "query": "let threshold = 2;\nlet Countrydb = externaldata(Network:string, geoname_id:string, continent_code:string, continent_name:string, country_iso_code:string, country_name:string)\n[@\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\"];\nlet UsersLocation = SalesforceServiceCloud\n| where EventType =~ 'Login' and LoginStatus=~'LOGIN_NO_ERROR'\n| project TimeGenerated, TimestampDerived, ClientIp, UserId, User, UserType ;\nUsersLocation\n| extend Dummy=1\n| extend TimestampDerived = todatetime(TimestampDerived)\n| summarize count() by Hour=bin(TimestampDerived,30m), ClientIp,User, Dummy\n| partition by Hour(\n                lookup (Countrydb|extend Dummy=1) on Dummy\n              | where ipv4_is_match(ClientIp, Network)\n              )\n| summarize NumOfCountries = dcount(country_name) by User, Hour\n| where NumOfCountries >= threshold\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "Medium",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "SalesforceServiceCloud"
                    ],
                    "connectorId": "SalesforceServiceCloudCCPDefinition"
                  }
                ],
                "tactics": [
                  "InitialAccess"
                ],
                "techniques": [
                  "T1078"
                ],
                "entityMappings": [
                  {
                    "entityType": "Account",
                    "fieldMappings": [
                      {
                        "identifier": "AadUserId",
                        "columnName": "User"
                      }
                    ]
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject3').analyticRuleId3,'/'))))]",
              "properties": {
                "description": "Salesforce Service Cloud Analytics Rule 3",
                "parentId": "[variables('analyticRuleObject3').analyticRuleId3]",
                "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject3').analyticRuleVersion3]",
                "source": {
                  "kind": "Solution",
                  "name": "Salesforce Service Cloud",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
        "contentKind": "AnalyticsRule",
        "displayName": "User Sign in from different countries",
        "contentProductId": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "id": "[variables('analyticRuleObject3')._analyticRulecontentProductId3]",
        "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "displayName": "Salesforce Service Cloud (via Codeless Connector Framework)",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "SalesforceServiceCloudCCPDefinition",
                  "title": "Salesforce Service Cloud (via Codeless Connector Framework)",
                  "publisher": "Microsoft",
                  "descriptionMarkdown": "The Salesforce Service Cloud data connector provides the capability to ingest information about your Salesforce operational events into Microsoft Sentinel through the REST API. The connector provides ability to review events in your org on an accelerated basis, get [event log files](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/event_log_file_hourly_overview.htm) in hourly increments for recent activity.",
                  "graphQueriesTableName": "SalesforceServiceCloudV2_CL",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "Salesforce Service Cloud EventLogFile Events",
                      "baseQuery": "{{graphQueriesTableName}}"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Get a sample of Salesforce Service Cloud Event Log File Events",
                      "query": "{{graphQueriesTableName}}\n| take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "{{graphQueriesTableName}}",
                      "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "availability": {
                    "isPreview": false,
                    "status": 1
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true,
                          "action": false
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Salesforce Service Cloud API access",
                        "description": "Access to the Salesforce Service Cloud API through a Connected App is required."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "Connect to Salesforce Service Cloud API to start collecting event logs in Microsoft Sentinel",
                      "description": "Follow [Create a Connected App in Salesforce for OAuth](https://help.salesforce.com/s/articleView?id=platform.ev_relay_create_connected_app.htm&type=5) and [Configure a Connected App for the OAuth 2.0 Client Credentials Flow](https://help.salesforce.com/s/articleView?id=xcloud.connected_app_client_credentials_setup.htm&type=5) to create a Connected App with access to the Salesforce Service Cloud API. Through those instructions, you should get the Consumer Key and Consumer Secret.\n For Salesforce Domain name, Go to Setup, type My Domain in the Quick Find box, and select My Domain to view your domain details. Make sure to enter the domain name without a trailing slash (e.g., https://your-domain.my.salesforce.com). Fill the form below with that information.",
                      "instructions": [
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "Salesforce Domain Name",
                            "placeholder": "Salesforce Domain Name",
                            "type": "text",
                            "name": "salesforceDomainName",
                            "validations": {
                              "required": true
                            }
                          }
                        },
                        {
                          "type": "Dropdown",
                          "parameters": {
                            "label": "Log Collection Interval",
                            "name": "queryType",
                            "options": [
                              {
                                "key": "SELECT Id,EventType,LogDate,Interval,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE Interval='Hourly' and CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                                "text": "Hourly"
                              },
                              {
                                "key": "SELECT Id,EventType,LogDate,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                                "text": "Daily"
                              }
                            ],
                            "placeholder": "Select an interval type",
                            "isMultiSelect": false,
                            "required": true
                          }
                        },
                        {
                          "type": "OAuthForm",
                          "parameters": {
                            "clientIdLabel": "Consumer Key",
                            "clientSecretLabel": "Consumer Secret",
                            "clientIdPlaceholder": "Enter Connected App Consumer Key",
                            "clientSecretPlaceholder": "Enter Connected App Consumer Secret",
                            "connectButtonLabel": "Connect",
                            "disconnectButtonLabel": "Disconnect"
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "SalesforceServiceCloudDCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId1')]",
                "streamDeclarations": {
                  "Custom-SalesforceServiceCloudV2_CL": {
                    "columns": [
                      {
                        "name": "REQUEST_SIZE",
                        "type": "string"
                      },
                      {
                        "name": "EXEC_TIME",
                        "type": "string"
                      },
                      {
                        "name": "ACTION",
                        "type": "string"
                      },
                      {
                        "name": "PLATFORM_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "OS_NAME",
                        "type": "string"
                      },
                      {
                        "name": "OS_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "TIMESTAMP",
                        "type": "string"
                      },
                      {
                        "name": "STATUS_CODE",
                        "type": "string"
                      },
                      {
                        "name": "EVENT_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "REFERRER_URI",
                        "type": "string"
                      },
                      {
                        "name": "USER_AGENT",
                        "type": "string"
                      },
                      {
                        "name": "BROWSER_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "TIME",
                        "type": "string"
                      },
                      {
                        "name": "RESPONSE_SIZE",
                        "type": "string"
                      },
                      {
                        "name": "DEVICE_ID",
                        "type": "string"
                      },
                      {
                        "name": "DEVICE_MODEL",
                        "type": "string"
                      },
                      {
                        "name": "SOURCE_IP",
                        "type": "string"
                      },
                      {
                        "name": "CLIENT_IP",
                        "type": "string"
                      },
                      {
                        "name": "SUCCESS",
                        "type": "string"
                      },
                      {
                        "name": "URI",
                        "type": "string"
                      },
                      {
                        "name": "URL",
                        "type": "string"
                      },
                      {
                        "name": "CLIENT_NAME",
                        "type": "string"
                      },
                      {
                        "name": "USER_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "USER_INITIATED_LOGOUT",
                        "type": "string"
                      },
                      {
                        "name": "USER_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "USER_ID",
                        "type": "string"
                      },
                      {
                        "name": "USER_EMAIL",
                        "type": "string"
                      },
                      {
                        "name": "USER_NAME",
                        "type": "string"
                      },
                      {
                        "name": "USER",
                        "type": "string"
                      },
                      {
                        "name": "URI_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "UI_EVENT_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "UI_EVENT_TIMESTAMP",
                        "type": "string"
                      },
                      {
                        "name": "UI_EVENT_SOURCE",
                        "type": "string"
                      },
                      {
                        "name": "UI_EVENT_SEQUENCE_NUM",
                        "type": "string"
                      },
                      {
                        "name": "UI_EVENT_ID",
                        "type": "string"
                      },
                      {
                        "name": "TLS_PROTOCOL",
                        "type": "string"
                      },
                      {
                        "name": "TIMESTAMP_DERIVED",
                        "type": "datetime"
                      },
                      {
                        "name": "TARGET_UI_ELEMENT",
                        "type": "string"
                      },
                      {
                        "name": "SORT",
                        "type": "string"
                      },
                      {
                        "name": "SESSION_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "SESSION_LEVEL",
                        "type": "string"
                      },
                      {
                        "name": "SESSION_KEY",
                        "type": "string"
                      },
                      {
                        "name": "SEARCH_QUERY",
                        "type": "string"
                      },
                      {
                        "name": "SDK_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "SDK_APP_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "SDK_APP_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "RUN_TIME",
                        "type": "string"
                      },
                      {
                        "name": "ROWS_PROCESSED",
                        "type": "string"
                      },
                      {
                        "name": "ROW_COUNT",
                        "type": "string"
                      },
                      {
                        "name": "RESOLUTION_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "REQUEST_STATUS",
                        "type": "string"
                      },
                      {
                        "name": "REQUEST_ID",
                        "type": "string"
                      },
                      {
                        "name": "REPORT_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "REPORT_ID",
                        "type": "string"
                      },
                      {
                        "name": "RENDERING_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "RELATED_LIST",
                        "type": "string"
                      },
                      {
                        "name": "RECORD_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "RECORD_ID",
                        "type": "string"
                      },
                      {
                        "name": "QUIDDITY",
                        "type": "string"
                      },
                      {
                        "name": "QUERY_ID",
                        "type": "string"
                      },
                      {
                        "name": "PREVPAGE_URL",
                        "type": "string"
                      },
                      {
                        "name": "PREVPAGE_ENTITY_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "PREVPAGE_ENTITY_ID",
                        "type": "string"
                      },
                      {
                        "name": "PREVPAGE_CONTEXT",
                        "type": "string"
                      },
                      {
                        "name": "PREVPAGE_APP_NAME",
                        "type": "string"
                      },
                      {
                        "name": "PREFIXES_SEARCHED",
                        "type": "string"
                      },
                      {
                        "name": "PARENT_UI_ELEMENT",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_URL",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_START_TIME",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_ENTITY_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_ENTITY_ID",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_CONTEXT",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_APP_NAME",
                        "type": "string"
                      },
                      {
                        "name": "ORIGIN",
                        "type": "string"
                      },
                      {
                        "name": "ORGANIZATION_ID",
                        "type": "string"
                      },
                      {
                        "name": "NUM_RESULTS",
                        "type": "string"
                      },
                      {
                        "name": "NUMBER_SOQL_QUERIES",
                        "type": "string"
                      },
                      {
                        "name": "NUMBER_FIELDS",
                        "type": "string"
                      },
                      {
                        "name": "NUMBER_EXCEPTION_FILTERS",
                        "type": "string"
                      },
                      {
                        "name": "NUMBER_COLUMNS",
                        "type": "string"
                      },
                      {
                        "name": "NUMBER_BUCKETS",
                        "type": "string"
                      },
                      {
                        "name": "METHOD_NAME",
                        "type": "string"
                      },
                      {
                        "name": "METHOD",
                        "type": "string"
                      },
                      {
                        "name": "MEDIA_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "LOGIN_STATUS",
                        "type": "string"
                      },
                      {
                        "name": "LOGIN_KEY",
                        "type": "string"
                      },
                      {
                        "name": "HTTP_METHOD",
                        "type": "string"
                      },
                      {
                        "name": "GRANDPARENT_UI_ELEMENT",
                        "type": "string"
                      },
                      {
                        "name": "ENTRY_POINT",
                        "type": "string"
                      },
                      {
                        "name": "ENTITY_NAME",
                        "type": "string"
                      },
                      {
                        "name": "ENTITY",
                        "type": "string"
                      },
                      {
                        "name": "EFFECTIVE_PAGE_TIME",
                        "type": "string"
                      },
                      {
                        "name": "DURATION",
                        "type": "string"
                      },
                      {
                        "name": "DISPLAY_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "DEVICE_SESSION_ID",
                        "type": "string"
                      },
                      {
                        "name": "DEVICE_PLATFORM",
                        "type": "string"
                      },
                      {
                        "name": "DB_TOTAL_TIME",
                        "type": "string"
                      },
                      {
                        "name": "DB_CPU_TIME",
                        "type": "string"
                      },
                      {
                        "name": "DB_BLOCKS",
                        "type": "string"
                      },
                      {
                        "name": "CPU_TIME",
                        "type": "string"
                      },
                      {
                        "name": "CONNECTION_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "COMPONENT_NAME",
                        "type": "string"
                      },
                      {
                        "name": "CLIENT_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "CLIENT_ID",
                        "type": "string"
                      },
                      {
                        "name": "CIPHER_SUITE",
                        "type": "string"
                      },
                      {
                        "name": "CALLOUT_TIME",
                        "type": "string"
                      },
                      {
                        "name": "BROWSER_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "BROWSER_NAME",
                        "type": "string"
                      },
                      {
                        "name": "AVERAGE_ROW_SIZE",
                        "type": "string"
                      },
                      {
                        "name": "APP_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "APP_NAME",
                        "type": "string"
                      },
                      {
                        "name": "API_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "API_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "ARTICLE_VERSION_ID",
                        "type": "string"
                      },
                      {
                        "name": "ARTICLE_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "ARTICLE_STATUS",
                        "type": "string"
                      },
                      {
                        "name": "ARTICLE_ID",
                        "type": "string"
                      },
                      {
                        "name": "ANALYTICS_MODE",
                        "type": "string"
                      },
                      {
                        "name": "BATCH_ID",
                        "type": "string"
                      },
                      {
                        "name": "CLICKED_RECORD_ID",
                        "type": "string"
                      },
                      {
                        "name": "CLASS_NAME",
                        "type": "string"
                      },
                      {
                        "name": "COMPONENT_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "COMPONENT_ID",
                        "type": "string"
                      },
                      {
                        "name": "CONTROLLER_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "CONTEXT",
                        "type": "string"
                      },
                      {
                        "name": "CONSOLE_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "CONSOLE_ID",
                        "type": "string"
                      },
                      {
                        "name": "CLIENT_INFO",
                        "type": "string"
                      },
                      {
                        "name": "DST_BYTES",
                        "type": "string"
                      },
                      {
                        "name": "DST_USER",
                        "type": "string"
                      },
                      {
                        "name": "DST_USER_SID",
                        "type": "string"
                      },
                      {
                        "name": "DST_USER_SID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "DATA",
                        "type": "string"
                      },
                      {
                        "name": "DASHBOARD_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "DASHBOARD_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "DASHBOARD_ID",
                        "type": "string"
                      },
                      {
                        "name": "DASHBOARD_COMPONENT_ID",
                        "type": "string"
                      },
                      {
                        "name": "DVC_ACTION",
                        "type": "string"
                      },
                      {
                        "name": "DVC_OS",
                        "type": "string"
                      },
                      {
                        "name": "DVC_OS_NAME",
                        "type": "string"
                      },
                      {
                        "name": "DVC_OS_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "DELIVERY_LOCATION",
                        "type": "string"
                      },
                      {
                        "name": "DELIVERY_ID",
                        "type": "string"
                      },
                      {
                        "name": "DOCUMENT_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "DOCUMENT_ID",
                        "type": "string"
                      },
                      {
                        "name": "ENTITY_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "ENTITY_ID",
                        "type": "string"
                      },
                      {
                        "name": "FILE_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "FILE_PREVIEW_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "EXCEPTION_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "EXCEPTION_MESSAGE",
                        "type": "string"
                      },
                      {
                        "name": "EPT",
                        "type": "string"
                      },
                      {
                        "name": "EVENT_COUNT",
                        "type": "string"
                      },
                      {
                        "name": "EVENT_END_TIME",
                        "type": "string"
                      },
                      {
                        "name": "EVENT_RESULT",
                        "type": "string"
                      },
                      {
                        "name": "FILE_SIZE",
                        "type": "string"
                      },
                      {
                        "name": "HTTP_REFERRER_ORIGINAL",
                        "type": "string"
                      },
                      {
                        "name": "HTTP_USER_AGENT_ORIGINAL",
                        "type": "string"
                      },
                      {
                        "name": "HTTP_USER_AGENT",
                        "type": "string"
                      },
                      {
                        "name": "LOG_GROUP_ID",
                        "type": "string"
                      },
                      {
                        "name": "LIMIT_USAGE_PERCENT",
                        "type": "string"
                      },
                      {
                        "name": "LICENSE_CONTEXT",
                        "type": "string"
                      },
                      {
                        "name": "LAST_VERSION",
                        "type": "string"
                      },
                      {
                        "name": "LANGUAGE",
                        "type": "string"
                      },
                      {
                        "name": "JOB_ID",
                        "type": "string"
                      },
                      {
                        "name": "IS_SUCCESS",
                        "type": "string"
                      },
                      {
                        "name": "IS_SECURE",
                        "type": "string"
                      },
                      {
                        "name": "IS_SCHEDULED",
                        "type": "string"
                      },
                      {
                        "name": "IS_NEW",
                        "type": "string"
                      },
                      {
                        "name": "IS_MOBILE",
                        "type": "string"
                      },
                      {
                        "name": "IS_LONG_RUNNING_REQUEST",
                        "type": "string"
                      },
                      {
                        "name": "IS_GUEST",
                        "type": "string"
                      },
                      {
                        "name": "IS_FIRST_REQUEST",
                        "type": "string"
                      },
                      {
                        "name": "IS_ERROR",
                        "type": "string"
                      },
                      {
                        "name": "IS_API",
                        "type": "string"
                      },
                      {
                        "name": "IS_AJAX_REQUEST",
                        "type": "string"
                      },
                      {
                        "name": "MANAGED_PACKAGE_NAMESPACE",
                        "type": "string"
                      },
                      {
                        "name": "HTTP_HEADERS",
                        "type": "string"
                      },
                      {
                        "name": "NETWORK_DURATION",
                        "type": "string"
                      },
                      {
                        "name": "NAME",
                        "type": "string"
                      },
                      {
                        "name": "NUMBER_FAILURES",
                        "type": "string"
                      },
                      {
                        "name": "NUM_CLICKS",
                        "type": "string"
                      },
                      {
                        "name": "OPERATION_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "NUM_SESSIONS",
                        "type": "string"
                      },
                      {
                        "name": "PAGE_NAME",
                        "type": "string"
                      },
                      {
                        "name": "QUERY",
                        "type": "string"
                      },
                      {
                        "name": "REQUEST_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "REPORT_DESCRIPTION",
                        "type": "string"
                      },
                      {
                        "name": "REOPEN_COUNT",
                        "type": "string"
                      },
                      {
                        "name": "RELATED_ENTITY_ID",
                        "type": "string"
                      },
                      {
                        "name": "RECORD_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "READ_TIME",
                        "type": "string"
                      },
                      {
                        "name": "RANK",
                        "type": "string"
                      },
                      {
                        "name": "SRC_BYTES",
                        "type": "string"
                      },
                      {
                        "name": "SRC_DVC_ID",
                        "type": "string"
                      },
                      {
                        "name": "SRC_DVC_MODEL_NAME",
                        "type": "string"
                      },
                      {
                        "name": "SRC_IP_ADDR",
                        "type": "string"
                      },
                      {
                        "name": "SRC_NAT_IP_ADDR",
                        "type": "string"
                      },
                      {
                        "name": "SESSION_ID",
                        "type": "string"
                      },
                      {
                        "name": "SITE_ID",
                        "type": "string"
                      },
                      {
                        "name": "SHARING_PERMISSION",
                        "type": "string"
                      },
                      {
                        "name": "SHARING_OPERATION",
                        "type": "string"
                      },
                      {
                        "name": "SHARED_WITH_ENTITY_ID",
                        "type": "string"
                      },
                      {
                        "name": "URL_ORIGINAL",
                        "type": "string"
                      },
                      {
                        "name": "WAVE_TIMESTAMP",
                        "type": "string"
                      },
                      {
                        "name": "WAVE_SESSION_ID",
                        "type": "string"
                      },
                      {
                        "name": "VIEW_STATE_SIZE",
                        "type": "string"
                      },
                      {
                        "name": "VERSION_ID_DERIVED",
                        "type": "string"
                      },
                      {
                        "name": "VERSION_ID",
                        "type": "string"
                      },
                      {
                        "name": "TRIGGER_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "TRIGGER_NAME",
                        "type": "string"
                      },
                      {
                        "name": "TRIGGER_ID",
                        "type": "string"
                      },
                      {
                        "name": "TRANSACTION_TYPE",
                        "type": "string"
                      },
                      {
                        "name": "TOTAL_TIME",
                        "type": "string"
                      },
                      {
                        "name": "TAB_ID",
                        "type": "string"
                      },
                      {
                        "name": "STACK_TRACE",
                        "type": "string"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-SalesforceServiceCloudV2_CL"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "outputStream": "Custom-SalesforceServiceCloudV2_CL",
                    "transformKql": "source | extend TimeGenerated = TIMESTAMP_DERIVED , RequestSize = ['REQUEST_SIZE'] , ExecTime = ['EXEC_TIME'] , Action = ['ACTION'] , PlatformType = ['PLATFORM_TYPE'] , OsName = ['OS_NAME'] , OsVersion = ['OS_VERSION'] , TimeStamp = ['TIMESTAMP'] , StatusCode = ['STATUS_CODE'] , EventType = ['EVENT_TYPE'] , ReferrerUri = ['REFERRER_URI'] , UserAgent = ['USER_AGENT'] , BrowserType = ['BROWSER_TYPE'] , Time = ['TIME'] , ResponseSize = ['RESPONSE_SIZE'] , DeviceId = ['DEVICE_ID'] , DeviceModel = ['DEVICE_MODEL'] , SourceIp = ['SOURCE_IP'] , ClientIp = ['CLIENT_IP'] , Success = ['SUCCESS'] , Uri = ['URI'] , Url = ['URL'] , ClientName = ['CLIENT_NAME'] , UserType = ['USER_TYPE'] , UserInitiatedLogout = ['USER_INITIATED_LOGOUT'] , UserIdDerived = ['USER_ID_DERIVED'] , UserId = ['USER_ID'] , UserEmail = ['USER_EMAIL'] , UserName = ['USER_NAME'] , User = ['USER'] , UriIdDerived = ['URI_ID_DERIVED'] , UiEventType = ['UI_EVENT_TYPE'] , UiEventTimestamp = ['UI_EVENT_TIMESTAMP'] , UiEventSource = ['UI_EVENT_SOURCE'] , UiEventSequenceNum = ['UI_EVENT_SEQUENCE_NUM'] , UiEventId = ['UI_EVENT_ID'] , TlsProtocol = ['TLS_PROTOCOL'] , TimestampDerived = ['TIMESTAMP_DERIVED'] , TargetUiElement = ['TARGET_UI_ELEMENT'] , Sort = ['SORT'] , SessionType = ['SESSION_TYPE'] , SessionLevel = ['SESSION_LEVEL'] , SessionKey = ['SESSION_KEY'] , SearchQuery = ['SEARCH_QUERY'] , SdkVersion = ['SDK_VERSION'] , SdkAppVersion = ['SDK_APP_VERSION'] , SdkAppType = ['SDK_APP_TYPE'] , RunTime = ['RUN_TIME'] , RowsProcessed = ['ROWS_PROCESSED'] , RowCount = ['ROW_COUNT'] , ResolutionType = ['RESOLUTION_TYPE'] , RequestStatus = ['REQUEST_STATUS'] , RequestId = ['REQUEST_ID'] , ReportIdDerived = ['REPORT_ID_DERIVED'] , ReportId = ['REPORT_ID'] , RenderingType = ['RENDERING_TYPE'] , RelatedList = ['RELATED_LIST'] , RecordType = ['RECORD_TYPE'] , RecordId = ['RECORD_ID'] , Quiddity = ['QUIDDITY'] , QueryId = ['QUERY_ID'] , PrevpageUrl = ['PREVPAGE_URL'] , PrevpageEntityType = ['PREVPAGE_ENTITY_TYPE'] , PrevpageEntityId = ['PREVPAGE_ENTITY_ID'] , PrevpageContext = ['PREVPAGE_CONTEXT'] , PrevpageAppName = ['PREVPAGE_APP_NAME'] , PrefixesSearched = ['PREFIXES_SEARCHED'] , ParentUiElement = ['PARENT_UI_ELEMENT'] , PageUrl = ['PAGE_URL'] , PageStartTime = ['PAGE_START_TIME'] , PageEntityType = ['PAGE_ENTITY_TYPE'] , PageEntityId = ['PAGE_ENTITY_ID'] , PageContext = ['PAGE_CONTEXT'] , PageAppName = ['PAGE_APP_NAME'] , Origin = ['ORIGIN'] , OrganizationId = ['ORGANIZATION_ID'] , NumResults = ['NUM_RESULTS'] , NumberSoqlQueries = ['NUMBER_SOQL_QUERIES'] , NumberFields = ['NUMBER_FIELDS'] , NumberExceptionFilters = ['NUMBER_EXCEPTION_FILTERS'] , NumberColumns = ['NUMBER_COLUMNS'] , NumberBuckets = ['NUMBER_BUCKETS'] , MethodName = ['METHOD_NAME'] , Method = ['METHOD'] , MediaType = ['MEDIA_TYPE'] , LoginStatus = ['LOGIN_STATUS'] , LoginKey = ['LOGIN_KEY'] , HttpMethod = ['HTTP_METHOD'] , GrandparentUiElement = ['GRANDPARENT_UI_ELEMENT'] , EntryPoint = ['ENTRY_POINT'] , EntityName = ['ENTITY_NAME'] , Entity = ['ENTITY'] , EffectivePageTime = ['EFFECTIVE_PAGE_TIME'] , Duration = ['DURATION'] , DisplayType = ['DISPLAY_TYPE'] , DeviceSessionId = ['DEVICE_SESSION_ID'] , DevicePlatform = ['DEVICE_PLATFORM'] , DbTotalTime = ['DB_TOTAL_TIME'] , DbCpuTime = ['DB_CPU_TIME'] , DbBlocks = ['DB_BLOCKS'] , CpuTime = ['CPU_TIME'] , ConnectionType = ['CONNECTION_TYPE'] , ComponentName = ['COMPONENT_NAME'] , ClientVersion = ['CLIENT_VERSION'] , ClientId = ['CLIENT_ID'] , CipherSuite = ['CIPHER_SUITE'] , CalloutTime = ['CALLOUT_TIME'] , BrowserVersion = ['BROWSER_VERSION'] , BrowserName = ['BROWSER_NAME'] , AverageRowSize = ['AVERAGE_ROW_SIZE'] , AppType = ['APP_TYPE'] , AppName = ['APP_NAME'] , ApiVersion = ['API_VERSION'] , ApiType = ['API_TYPE'] , ArticleVersionId = ['ARTICLE_VERSION_ID'] , ArticleVersion = ['ARTICLE_VERSION'] , ArticleStatus = ['ARTICLE_STATUS'] , ArticleId = ['ARTICLE_ID'] , AnalyticsMode = ['ANALYTICS_MODE'] , BatchId = ['BATCH_ID'] , ClickedRecordId = ['CLICKED_RECORD_ID'] , ClassName = ['CLASS_NAME'] , ComponentIdDerived = ['COMPONENT_ID_DERIVED'] , ComponentId = ['COMPONENT_ID'] , ControllerType = ['CONTROLLER_TYPE'] , Context = ['CONTEXT'] , ConsoleIdDerived = ['CONSOLE_ID_DERIVED'] , ConsoleId = ['CONSOLE_ID'] , ClientInfo = ['CLIENT_INFO'] , DstBytes = ['DST_BYTES'] , DstUser = ['DST_USER'] , DstUserSid = ['DST_USER_SID'] , DstUserSidDerived = ['DST_USER_SID_DERIVED'] , Data = ['DATA'] , DashboardType = ['DASHBOARD_TYPE'] , DashboardIdDerived = ['DASHBOARD_ID_DERIVED'] , DashboardId = ['DASHBOARD_ID'] , DashboardComponentId = ['DASHBOARD_COMPONENT_ID'] , DvcAction = ['DVC_ACTION'] , DvcOs = ['DVC_OS'] , DvcOsName = ['DVC_OS_NAME'] , DvcOsVersion = ['DVC_OS_VERSION'] , DeliveryLocation = ['DELIVERY_LOCATION'] , DeliveryId = ['DELIVERY_ID'] , DocumentIdDerived = ['DOCUMENT_ID_DERIVED'] , DocumentId = ['DOCUMENT_ID'] , EntityType = ['ENTITY_TYPE'] , EntityId = ['ENTITY_ID'] , FileType = ['FILE_TYPE'] , FilePreviewType = ['FILE_PREVIEW_TYPE'] , ExceptionType = ['EXCEPTION_TYPE'] , ExceptionMessage = ['EXCEPTION_MESSAGE'] , Ept = ['EPT'] , EventCount = ['EVENT_COUNT'] , EventEndTime = ['EVENT_END_TIME'] , EventResult = ['EVENT_RESULT'] , FileSize = ['FILE_SIZE'] , HttpReferrerOriginal = ['HTTP_REFERRER_ORIGINAL'] , HttpUserAgentOriginal = ['HTTP_USER_AGENT_ORIGINAL'] , HttpUserAgent = ['HTTP_USER_AGENT'] , LogGroupId = ['LOG_GROUP_ID'] , LimitUsagePercent = ['LIMIT_USAGE_PERCENT'] , LicenseContext = ['LICENSE_CONTEXT'] , LastVersion = ['LAST_VERSION'] , Language = ['LANGUAGE'] , JobId = ['JOB_ID'] , IsSuccess = ['IS_SUCCESS'] , IsSecure = ['IS_SECURE'] , IsScheduled = ['IS_SCHEDULED'] , IsNew = ['IS_NEW'] , IsMobile = ['IS_MOBILE'] , IsLongRunningRequest = ['IS_LONG_RUNNING_REQUEST'] , IsGuest = ['IS_GUEST'] , IsFirstRequest = ['IS_FIRST_REQUEST'] , IsError = ['IS_ERROR'] , IsApi = ['IS_API'] , IsAjaxRequest = ['IS_AJAX_REQUEST'] , ManagedPackageNamespace = ['MANAGED_PACKAGE_NAMESPACE'] , HttpHeaders = ['HTTP_HEADERS'] , NetworkDuration = ['NETWORK_DURATION'] , Name = ['NAME'] , NumberFailures = ['NUMBER_FAILURES'] , NumClicks = ['NUM_CLICKS'] , OperationType = ['OPERATION_TYPE'] , NumSessions = ['NUM_SESSIONS'] , PageName = ['PAGE_NAME'] , Query = ['QUERY'] , RequestType = ['REQUEST_TYPE'] , ReportDescription = ['REPORT_DESCRIPTION'] , ReopenCount = ['REOPEN_COUNT'] , RelatedEntityId = ['RELATED_ENTITY_ID'] , RecordIdDerived = ['RECORD_ID_DERIVED'] , ReadTime = ['READ_TIME'] , Rank = ['RANK'] , SrcBytes = ['SRC_BYTES'] , SrcDvcId = ['SRC_DVC_ID'] , SrcDvcModelName = ['SRC_DVC_MODEL_NAME'] , SrcIpAddr = ['SRC_IP_ADDR'] , SrcNatIpAddr = ['SRC_NAT_IP_ADDR'] , SessionId = ['SESSION_ID'] , SiteId = ['SITE_ID'] , SharingPermission = ['SHARING_PERMISSION'] , SharingOperation = ['SHARING_OPERATION'] , SharedWithEntityId = ['SHARED_WITH_ENTITY_ID'] , UrlOriginal = ['URL_ORIGINAL'] , WaveTimeStamp = ['WAVE_TIMESTAMP'] , WaveSessionId = ['WAVE_SESSION_ID'] , ViewStateSize = ['VIEW_STATE_SIZE'] , VersionIdDerived = ['VERSION_ID_DERIVED'] , VersionId = ['VERSION_ID'] , TriggerType = ['TRIGGER_TYPE'] , TriggerName = ['TRIGGER_NAME'] , TriggerId = ['TRIGGER_ID'] , TransactionType = ['TRANSACTION_TYPE'] , TotalTime = ['TOTAL_TIME'] , TabId = ['TAB_ID'] , StackTrace = ['STACK_TRACE'] | project TimeGenerated , RequestSize , ExecTime , Action , PlatformType , OsName , OsVersion , TimeStamp , StatusCode , EventType , ReferrerUri , UserAgent , BrowserType , Time , ResponseSize , DeviceId , DeviceModel , SourceIp , ClientIp , Success , Uri , Url , ClientName , UserType , UserInitiatedLogout , UserIdDerived , UserId , UserEmail , UserName , User , UriIdDerived , UiEventType , UiEventTimestamp , UiEventSource , UiEventSequenceNum , UiEventId , TlsProtocol , TimestampDerived , TargetUiElement , Sort , SessionType , SessionLevel , SessionKey , SearchQuery , SdkVersion , SdkAppVersion , SdkAppType , RunTime , RowsProcessed , RowCount , ResolutionType , RequestStatus , RequestId , ReportIdDerived , ReportId , RenderingType , RelatedList , RecordType , RecordId , Quiddity , QueryId , PrevpageUrl , PrevpageEntityType , PrevpageEntityId , PrevpageContext , PrevpageAppName , PrefixesSearched , ParentUiElement , PageUrl , PageStartTime , PageEntityType , PageEntityId , PageContext , PageAppName , Origin , OrganizationId , NumResults , NumberSoqlQueries , NumberFields , NumberExceptionFilters , NumberColumns , NumberBuckets , MethodName , Method , MediaType , LoginStatus , LoginKey , HttpMethod , GrandparentUiElement , EntryPoint , EntityName , Entity , EffectivePageTime , Duration , DisplayType , DeviceSessionId , DevicePlatform , DbTotalTime , DbCpuTime , DbBlocks , CpuTime , ConnectionType , ComponentName , ClientVersion , ClientId , CipherSuite , CalloutTime , BrowserVersion , BrowserName , AverageRowSize , AppType , AppName , ApiVersion , ApiType , ArticleVersionId , ArticleVersion , ArticleStatus , ArticleId , AnalyticsMode , BatchId , ClickedRecordId , ClassName , ComponentIdDerived , ComponentId , ControllerType , Context , ConsoleIdDerived , ConsoleId , ClientInfo , DstBytes , DstUser , DstUserSid , DstUserSidDerived , Data , DashboardType , DashboardIdDerived , DashboardId , DashboardComponentId , DvcAction , DvcOs , DvcOsName , DvcOsVersion , DeliveryLocation , DeliveryId , DocumentIdDerived , DocumentId , EntityType , EntityId , FileType , FilePreviewType , ExceptionType , ExceptionMessage , Ept , EventCount , EventEndTime , EventResult , FileSize , HttpReferrerOriginal , HttpUserAgentOriginal , HttpUserAgent , LogGroupId , LimitUsagePercent , LicenseContext , LastVersion , Language , JobId , IsSuccess , IsSecure , IsScheduled , IsNew , IsMobile , IsLongRunningRequest , IsGuest , IsFirstRequest , IsError , IsApi , IsAjaxRequest , ManagedPackageNamespace , HttpHeaders , NetworkDuration , Name , NumberFailures , NumClicks , OperationType , NumSessions , PageName , Query , RequestType , ReportDescription , ReopenCount , RelatedEntityId , RecordIdDerived , ReadTime , Rank , SrcBytes , SrcDvcId , SrcDvcModelName , SrcIpAddr , SrcNatIpAddr , SessionId , SiteId , SharingPermission , SharingOperation , SharedWithEntityId , UrlOriginal , WaveTimeStamp , WaveSessionId , ViewStateSize , VersionIdDerived , VersionId , TriggerType , TriggerName , TriggerId , TransactionType , TotalTime , TabId , StackTrace"
                  }
                ]
              }
            },
            {
              "name": "SalesforceServiceCloudV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "retentionInDays": 180,
                "schema": {
                  "name": "SalesforceServiceCloudV2_CL",
                  "description": "Event Log data",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime",
                      "isDefaultDisplay": true
                    },
                    {
                      "name": "RequestSize",
                      "type": "string",
                      "description": "The size of the request payload."
                    },
                    {
                      "name": "ExecTime",
                      "type": "string",
                      "description": "The execution time of the request."
                    },
                    {
                      "name": "Action",
                      "type": "string",
                      "description": "The action performed."
                    },
                    {
                      "name": "PlatformType",
                      "type": "string",
                      "description": "The platform type."
                    },
                    {
                      "name": "OsName",
                      "type": "string",
                      "description": "The operating system name."
                    },
                    {
                      "name": "OsVersion",
                      "type": "string",
                      "description": "The operating system version."
                    },
                    {
                      "name": "TimeStamp",
                      "type": "string",
                      "description": "The timestamp of the event."
                    },
                    {
                      "name": "StatusCode",
                      "type": "string",
                      "description": "The status code of the response."
                    },
                    {
                      "name": "EventType",
                      "type": "string",
                      "description": "The type of the event."
                    },
                    {
                      "name": "ReferrerUri",
                      "type": "string",
                      "description": "The referrer URI."
                    },
                    {
                      "name": "UserAgent",
                      "type": "string",
                      "description": "The user agent."
                    },
                    {
                      "name": "BrowserType",
                      "type": "string",
                      "description": "The browser type."
                    },
                    {
                      "name": "Time",
                      "type": "string",
                      "description": "The time of the event."
                    },
                    {
                      "name": "ResponseSize",
                      "type": "string",
                      "description": "The size of the response payload."
                    },
                    {
                      "name": "DeviceId",
                      "type": "string",
                      "description": "The device ID."
                    },
                    {
                      "name": "DeviceModel",
                      "type": "string",
                      "description": "The device model."
                    },
                    {
                      "name": "SourceIp",
                      "type": "string",
                      "description": "The source IP address."
                    },
                    {
                      "name": "ClientIp",
                      "type": "string",
                      "description": "The client IP address."
                    },
                    {
                      "name": "Success",
                      "type": "string",
                      "description": "Indicates if the request was successful."
                    },
                    {
                      "name": "Uri",
                      "type": "string",
                      "description": "The URI of the request."
                    },
                    {
                      "name": "Url",
                      "type": "string",
                      "description": "The URL of the request."
                    },
                    {
                      "name": "ClientName",
                      "type": "string",
                      "description": "The name of the client."
                    },
                    {
                      "name": "UserType",
                      "type": "string",
                      "description": "The type of the user."
                    },
                    {
                      "name": "UserInitiatedLogout",
                      "type": "string",
                      "description": "Indicates if the logout was user-initiated."
                    },
                    {
                      "name": "UserIdDerived",
                      "type": "string",
                      "description": "The derived user ID."
                    },
                    {
                      "name": "UserId",
                      "type": "string",
                      "description": "The user ID."
                    },
                    {
                      "name": "UserEmail",
                      "type": "string",
                      "description": "The user email."
                    },
                    {
                      "name": "UserName",
                      "type": "string",
                      "description": "The user name."
                    },
                    {
                      "name": "User",
                      "type": "string",
                      "description": "The user."
                    },
                    {
                      "name": "UriIdDerived",
                      "type": "string",
                      "description": "The derived URI ID."
                    },
                    {
                      "name": "UiEventType",
                      "type": "string",
                      "description": "The UI event type."
                    },
                    {
                      "name": "UiEventTimestamp",
                      "type": "string",
                      "description": "The UI event timestamp."
                    },
                    {
                      "name": "UiEventSource",
                      "type": "string",
                      "description": "The UI event source."
                    },
                    {
                      "name": "UiEventSequenceNum",
                      "type": "string",
                      "description": "The UI event sequence number."
                    },
                    {
                      "name": "UiEventId",
                      "type": "string",
                      "description": "The UI event ID."
                    },
                    {
                      "name": "TlsProtocol",
                      "type": "string",
                      "description": "The TLS protocol."
                    },
                    {
                      "name": "TimestampDerived",
                      "type": "datetime",
                      "description": "The derived timestamp."
                    },
                    {
                      "name": "TargetUiElement",
                      "type": "string",
                      "description": "The target UI element."
                    },
                    {
                      "name": "Sort",
                      "type": "string",
                      "description": "The sort order."
                    },
                    {
                      "name": "SessionType",
                      "type": "string",
                      "description": "The session type."
                    },
                    {
                      "name": "SessionLevel",
                      "type": "string",
                      "description": "The session level."
                    },
                    {
                      "name": "SessionKey",
                      "type": "string",
                      "description": "The session key."
                    },
                    {
                      "name": "SearchQuery",
                      "type": "string",
                      "description": "The search query."
                    },
                    {
                      "name": "SdkVersion",
                      "type": "string",
                      "description": "The SDK version."
                    },
                    {
                      "name": "SdkAppVersion",
                      "type": "string",
                      "description": "The SDK app version."
                    },
                    {
                      "name": "SdkAppType",
                      "type": "string",
                      "description": "The SDK app type."
                    },
                    {
                      "name": "RunTime",
                      "type": "string",
                      "description": "The run time."
                    },
                    {
                      "name": "RowsProcessed",
                      "type": "string",
                      "description": "The rows processed."
                    },
                    {
                      "name": "RowCount",
                      "type": "string",
                      "description": "The row count."
                    },
                    {
                      "name": "ResolutionType",
                      "type": "string",
                      "description": "The resolution type."
                    },
                    {
                      "name": "RequestStatus",
                      "type": "string",
                      "description": "The request status."
                    },
                    {
                      "name": "RequestId",
                      "type": "string",
                      "description": "The request ID."
                    },
                    {
                      "name": "ReportIdDerived",
                      "type": "string",
                      "description": "The derived report ID."
                    },
                    {
                      "name": "ReportId",
                      "type": "string",
                      "description": "The report ID."
                    },
                    {
                      "name": "RenderingType",
                      "type": "string",
                      "description": "The rendering type."
                    },
                    {
                      "name": "RelatedList",
                      "type": "string",
                      "description": "The related list."
                    },
                    {
                      "name": "RecordType",
                      "type": "string",
                      "description": "The record type."
                    },
                    {
                      "name": "RecordId",
                      "type": "string",
                      "description": "The record ID."
                    },
                    {
                      "name": "Quiddity",
                      "type": "string",
                      "description": "The quiddity."
                    },
                    {
                      "name": "QueryId",
                      "type": "string",
                      "description": "The query ID."
                    },
                    {
                      "name": "PrevpageUrl",
                      "type": "string",
                      "description": "The previous page URL."
                    },
                    {
                      "name": "PrevpageEntityType",
                      "type": "string",
                      "description": "The previous page entity type."
                    },
                    {
                      "name": "PrevpageEntityId",
                      "type": "string",
                      "description": "The previous page entity ID."
                    },
                    {
                      "name": "PrevpageContext",
                      "type": "string",
                      "description": "The previous page context."
                    },
                    {
                      "name": "PrevpageAppName",
                      "type": "string",
                      "description": "The previous page app name."
                    },
                    {
                      "name": "PrefixesSearched",
                      "type": "string",
                      "description": "The prefixes searched."
                    },
                    {
                      "name": "ParentUiElement",
                      "type": "string",
                      "description": "The parent UI element."
                    },
                    {
                      "name": "PageUrl",
                      "type": "string",
                      "description": "The page URL."
                    },
                    {
                      "name": "PageStartTime",
                      "type": "string",
                      "description": "The page start time."
                    },
                    {
                      "name": "PageEntityType",
                      "type": "string",
                      "description": "The page entity type."
                    },
                    {
                      "name": "PageEntityId",
                      "type": "string",
                      "description": "The page entity ID."
                    },
                    {
                      "name": "PageContext",
                      "type": "string",
                      "description": "The page context."
                    },
                    {
                      "name": "PageAppName",
                      "type": "string",
                      "description": "The page app name."
                    },
                    {
                      "name": "Origin",
                      "type": "string",
                      "description": "The origin."
                    },
                    {
                      "name": "OrganizationId",
                      "type": "string",
                      "description": "The organization ID."
                    },
                    {
                      "name": "NumResults",
                      "type": "string",
                      "description": "The number of results."
                    },
                    {
                      "name": "NumberSoqlQueries",
                      "type": "string",
                      "description": "The number of SOQL queries."
                    },
                    {
                      "name": "NumberFields",
                      "type": "string",
                      "description": "The number of fields."
                    },
                    {
                      "name": "NumberExceptionFilters",
                      "type": "string",
                      "description": "The number of exception filters."
                    },
                    {
                      "name": "NumberColumns",
                      "type": "string",
                      "description": "The number of columns."
                    },
                    {
                      "name": "NumberBuckets",
                      "type": "string",
                      "description": "The number of buckets."
                    },
                    {
                      "name": "MethodName",
                      "type": "string",
                      "description": "The method name."
                    },
                    {
                      "name": "Method",
                      "type": "string",
                      "description": "The method."
                    },
                    {
                      "name": "MediaType",
                      "type": "string",
                      "description": "The media type."
                    },
                    {
                      "name": "LoginStatus",
                      "type": "string",
                      "description": "The login status."
                    },
                    {
                      "name": "LoginKey",
                      "type": "string",
                      "description": "The login key."
                    },
                    {
                      "name": "HttpMethod",
                      "type": "string",
                      "description": "The HTTP method."
                    },
                    {
                      "name": "GrandparentUiElement",
                      "type": "string",
                      "description": "The grandparent UI element."
                    },
                    {
                      "name": "EntryPoint",
                      "type": "string",
                      "description": "The entry point."
                    },
                    {
                      "name": "EntityName",
                      "type": "string",
                      "description": "The entity name."
                    },
                    {
                      "name": "Entity",
                      "type": "string",
                      "description": "The entity."
                    },
                    {
                      "name": "EffectivePageTime",
                      "type": "string",
                      "description": "The effective page time."
                    },
                    {
                      "name": "Duration",
                      "type": "string",
                      "description": "The duration."
                    },
                    {
                      "name": "DisplayType",
                      "type": "string",
                      "description": "The display type."
                    },
                    {
                      "name": "DeviceSessionId",
                      "type": "string",
                      "description": "The device session ID."
                    },
                    {
                      "name": "DevicePlatform",
                      "type": "string",
                      "description": "The device platform."
                    },
                    {
                      "name": "DbTotalTime",
                      "type": "string",
                      "description": "The database total time."
                    },
                    {
                      "name": "DbCpuTime",
                      "type": "string",
                      "description": "The database CPU time."
                    },
                    {
                      "name": "DbBlocks",
                      "type": "string",
                      "description": "The database blocks."
                    },
                    {
                      "name": "CpuTime",
                      "type": "string",
                      "description": "The CPU time."
                    },
                    {
                      "name": "ConnectionType",
                      "type": "string",
                      "description": "The connection type."
                    },
                    {
                      "name": "ComponentName",
                      "type": "string",
                      "description": "The component name."
                    },
                    {
                      "name": "ClientVersion",
                      "type": "string",
                      "description": "The client version."
                    },
                    {
                      "name": "ClientId",
                      "type": "string",
                      "description": "The client ID."
                    },
                    {
                      "name": "CipherSuite",
                      "type": "string",
                      "description": "The cipher suite."
                    },
                    {
                      "name": "CalloutTime",
                      "type": "string",
                      "description": "The callout time."
                    },
                    {
                      "name": "BrowserVersion",
                      "type": "string",
                      "description": "The browser version."
                    },
                    {
                      "name": "BrowserName",
                      "type": "string",
                      "description": "The browser name."
                    },
                    {
                      "name": "AverageRowSize",
                      "type": "string",
                      "description": "The average row size."
                    },
                    {
                      "name": "AppType",
                      "type": "string",
                      "description": "The app type."
                    },
                    {
                      "name": "AppName",
                      "type": "string",
                      "description": "The app name."
                    },
                    {
                      "name": "ApiVersion",
                      "type": "string",
                      "description": "The API version."
                    },
                    {
                      "name": "ApiType",
                      "type": "string",
                      "description": "The API type."
                    },
                    {
                      "name": "ArticleVersionId",
                      "type": "string",
                      "description": "The article version ID."
                    },
                    {
                      "name": "ArticleVersion",
                      "type": "string",
                      "description": "The article version."
                    },
                    {
                      "name": "ArticleStatus",
                      "type": "string",
                      "description": "The article status."
                    },
                    {
                      "name": "ArticleId",
                      "type": "string",
                      "description": "The article ID."
                    },
                    {
                      "name": "AnalyticsMode",
                      "type": "string",
                      "description": "The analytics mode."
                    },
                    {
                      "name": "BatchId",
                      "type": "string",
                      "description": "The batch ID."
                    },
                    {
                      "name": "ClickedRecordId",
                      "type": "string",
                      "description": "The clicked record ID."
                    },
                    {
                      "name": "ClassName",
                      "type": "string",
                      "description": "The class name."
                    },
                    {
                      "name": "ComponentIdDerived",
                      "type": "string",
                      "description": "The component ID derived."
                    },
                    {
                      "name": "ComponentId",
                      "type": "string",
                      "description": "The component ID."
                    },
                    {
                      "name": "ControllerType",
                      "type": "string",
                      "description": "The controller type."
                    },
                    {
                      "name": "Context",
                      "type": "string",
                      "description": "The context."
                    },
                    {
                      "name": "ConsoleIdDerived",
                      "type": "string",
                      "description": "The console ID derived."
                    },
                    {
                      "name": "ConsoleId",
                      "type": "string",
                      "description": "The console ID."
                    },
                    {
                      "name": "ClientInfo",
                      "type": "string",
                      "description": "The client info."
                    },
                    {
                      "name": "DstBytes",
                      "type": "string",
                      "description": "The destination bytes."
                    },
                    {
                      "name": "DstUser",
                      "type": "string",
                      "description": "The destination user."
                    },
                    {
                      "name": "DstUserSid",
                      "type": "string",
                      "description": "The destination user SID."
                    },
                    {
                      "name": "DstUserSidDerived",
                      "type": "string",
                      "description": "The destination user SID derived."
                    },
                    {
                      "name": "Data",
                      "type": "string",
                      "description": "The data."
                    },
                    {
                      "name": "DashboardType",
                      "type": "string",
                      "description": "The dashboard type."
                    },
                    {
                      "name": "DashboardIdDerived",
                      "type": "string",
                      "description": "The dashboard ID derived."
                    },
                    {
                      "name": "DashboardId",
                      "type": "string",
                      "description": "The dashboard ID."
                    },
                    {
                      "name": "DashboardComponentId",
                      "type": "string",
                      "description": "The dashboard component ID."
                    },
                    {
                      "name": "DvcAction",
                      "type": "string",
                      "description": "The DVC action."
                    },
                    {
                      "name": "DvcOs",
                      "type": "string",
                      "description": "The DVC OS."
                    },
                    {
                      "name": "DvcOsName",
                      "type": "string",
                      "description": "The DVC OS name."
                    },
                    {
                      "name": "DvcOsVersion",
                      "type": "string",
                      "description": "The DVC OS version."
                    },
                    {
                      "name": "DeliveryLocation",
                      "type": "string",
                      "description": "The delivery location."
                    },
                    {
                      "name": "DeliveryId",
                      "type": "string",
                      "description": "The delivery ID."
                    },
                    {
                      "name": "DocumentIdDerived",
                      "type": "string",
                      "description": "The document ID derived."
                    },
                    {
                      "name": "DocumentId",
                      "type": "string",
                      "description": "The document ID."
                    },
                    {
                      "name": "EntityType",
                      "type": "string",
                      "description": "The entity type."
                    },
                    {
                      "name": "EntityId",
                      "type": "string",
                      "description": "The entity ID."
                    },
                    {
                      "name": "FileType",
                      "type": "string",
                      "description": "The file type."
                    },
                    {
                      "name": "FilePreviewType",
                      "type": "string",
                      "description": "The file preview type."
                    },
                    {
                      "name": "ExceptionType",
                      "type": "string",
                      "description": "The exception type."
                    },
                    {
                      "name": "ExceptionMessage",
                      "type": "string",
                      "description": "The exception message."
                    },
                    {
                      "name": "Ept",
                      "type": "string",
                      "description": "The EPT."
                    },
                    {
                      "name": "EventCount",
                      "type": "string",
                      "description": "The event count."
                    },
                    {
                      "name": "EventEndTime",
                      "type": "string",
                      "description": "The event end time."
                    },
                    {
                      "name": "EventResult",
                      "type": "string",
                      "description": "The event result."
                    },
                    {
                      "name": "FileSize",
                      "type": "string",
                      "description": "The file size."
                    },
                    {
                      "name": "HttpReferrerOriginal",
                      "type": "string",
                      "description": "The HTTP referrer original."
                    },
                    {
                      "name": "HttpUserAgentOriginal",
                      "type": "string",
                      "description": "The HTTP user agent original."
                    },
                    {
                      "name": "HttpUserAgent",
                      "type": "string",
                      "description": "The HTTP user agent."
                    },
                    {
                      "name": "LogGroupId",
                      "type": "string",
                      "description": "The log group ID."
                    },
                    {
                      "name": "LimitUsagePercent",
                      "type": "string",
                      "description": "The limit usage percent."
                    },
                    {
                      "name": "LicenseContext",
                      "type": "string",
                      "description": "The license context."
                    },
                    {
                      "name": "LastVersion",
                      "type": "string",
                      "description": "The last version."
                    },
                    {
                      "name": "Language",
                      "type": "string",
                      "description": "The language."
                    },
                    {
                      "name": "JobId",
                      "type": "string",
                      "description": "The job ID."
                    },
                    {
                      "name": "IsSuccess",
                      "type": "string",
                      "description": "Indicates if the operation was successful."
                    },
                    {
                      "name": "IsSecure",
                      "type": "string",
                      "description": "Indicates if the connection is secure."
                    },
                    {
                      "name": "IsScheduled",
                      "type": "string",
                      "description": "Indicates if the job is scheduled."
                    },
                    {
                      "name": "IsNew",
                      "type": "string",
                      "description": "Indicates if the job is new."
                    },
                    {
                      "name": "IsMobile",
                      "type": "string",
                      "description": "Indicates if the job is mobile."
                    },
                    {
                      "name": "IsLongRunningRequest",
                      "type": "string",
                      "description": "Indicates if the job is a long-running request."
                    },
                    {
                      "name": "IsGuest",
                      "type": "string",
                      "description": "Indicates if the user is a guest."
                    },
                    {
                      "name": "IsFirstRequest",
                      "type": "string",
                      "description": "Indicates if this is the first request."
                    },
                    {
                      "name": "IsError",
                      "type": "string",
                      "description": "Indicates if there was an error."
                    },
                    {
                      "name": "IsApi",
                      "type": "string",
                      "description": "Indicates if the request is an API request."
                    },
                    {
                      "name": "IsAjaxRequest",
                      "type": "string",
                      "description": "Indicates if the request is an AJAX request."
                    },
                    {
                      "name": "ManagedPackageNamespace",
                      "type": "string",
                      "description": "The managed package namespace."
                    },
                    {
                      "name": "HttpHeaders",
                      "type": "string",
                      "description": "The HTTP headers."
                    },
                    {
                      "name": "NetworkDuration",
                      "type": "string",
                      "description": "The network duration."
                    },
                    {
                      "name": "Name",
                      "type": "string",
                      "description": "The name."
                    },
                    {
                      "name": "NumberFailures",
                      "type": "string",
                      "description": "The number of failures."
                    },
                    {
                      "name": "NumClicks",
                      "type": "string",
                      "description": "The number of clicks."
                    },
                    {
                      "name": "OperationType",
                      "type": "string",
                      "description": "The operation type."
                    },
                    {
                      "name": "NumSessions",
                      "type": "string",
                      "description": "The number of sessions."
                    },
                    {
                      "name": "PageName",
                      "type": "string",
                      "description": "The page name."
                    },
                    {
                      "name": "Query",
                      "type": "string",
                      "description": "The query."
                    },
                    {
                      "name": "RequestType",
                      "type": "string",
                      "description": "The request type."
                    },
                    {
                      "name": "ReportDescription",
                      "type": "string",
                      "description": "The report description."
                    },
                    {
                      "name": "ReopenCount",
                      "type": "string",
                      "description": "The reopen count."
                    },
                    {
                      "name": "RelatedEntityId",
                      "type": "string",
                      "description": "The related entity ID."
                    },
                    {
                      "name": "RecordIdDerived",
                      "type": "string",
                      "description": "The derived record ID."
                    },
                    {
                      "name": "ReadTime",
                      "type": "string",
                      "description": "The read time."
                    },
                    {
                      "name": "Rank",
                      "type": "string",
                      "description": "The rank."
                    },
                    {
                      "name": "SrcBytes",
                      "type": "string",
                      "description": "The source bytes."
                    },
                    {
                      "name": "SrcDvcId",
                      "type": "string",
                      "description": "The source device ID."
                    },
                    {
                      "name": "SrcDvcModelName",
                      "type": "string",
                      "description": "The source device model name."
                    },
                    {
                      "name": "SrcIpAddr",
                      "type": "string",
                      "description": "The source IP address."
                    },
                    {
                      "name": "SrcNatIpAddr",
                      "type": "string",
                      "description": "The source NAT IP address."
                    },
                    {
                      "name": "SessionId",
                      "type": "string",
                      "description": "The session ID."
                    },
                    {
                      "name": "SiteId",
                      "type": "string",
                      "description": "The site ID."
                    },
                    {
                      "name": "SharingPermission",
                      "type": "string",
                      "description": "The sharing permission."
                    },
                    {
                      "name": "SharingOperation",
                      "type": "string",
                      "description": "The sharing operation."
                    },
                    {
                      "name": "SharedWithEntityId",
                      "type": "string",
                      "description": "The shared with entity ID."
                    },
                    {
                      "name": "UrlOriginal",
                      "type": "string",
                      "description": "The original URL."
                    },
                    {
                      "name": "WaveTimeStamp",
                      "type": "string",
                      "description": "The wave timestamp."
                    },
                    {
                      "name": "WaveSessionId",
                      "type": "string",
                      "description": "The wave session ID."
                    },
                    {
                      "name": "ViewStateSize",
                      "type": "string",
                      "description": "The view state size."
                    },
                    {
                      "name": "VersionIdDerived",
                      "type": "string",
                      "description": "The derived version ID."
                    },
                    {
                      "name": "VersionId",
                      "type": "string",
                      "description": "The version ID."
                    },
                    {
                      "name": "TriggerType",
                      "type": "string",
                      "description": "The trigger type."
                    },
                    {
                      "name": "TriggerName",
                      "type": "string",
                      "description": "The trigger name."
                    },
                    {
                      "name": "TriggerId",
                      "type": "string",
                      "description": "The trigger ID."
                    },
                    {
                      "name": "TransactionType",
                      "type": "string",
                      "description": "The transaction type."
                    },
                    {
                      "name": "TotalTime",
                      "type": "string",
                      "description": "The total time."
                    },
                    {
                      "name": "TabId",
                      "type": "string",
                      "description": "The tab ID."
                    },
                    {
                      "name": "StackTrace",
                      "type": "string",
                      "description": "The stack trace."
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition1'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "SalesforceServiceCloudCCPDefinition",
          "title": "Salesforce Service Cloud (via Codeless Connector Framework)",
          "publisher": "Microsoft",
          "descriptionMarkdown": "The Salesforce Service Cloud data connector provides the capability to ingest information about your Salesforce operational events into Microsoft Sentinel through the REST API. The connector provides ability to review events in your org on an accelerated basis, get [event log files](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/event_log_file_hourly_overview.htm) in hourly increments for recent activity.",
          "graphQueriesTableName": "SalesforceServiceCloudV2_CL",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "Salesforce Service Cloud EventLogFile Events",
              "baseQuery": "{{graphQueriesTableName}}"
            }
          ],
          "sampleQueries": [
            {
              "description": "Get a sample of Salesforce Service Cloud Event Log File Events",
              "query": "{{graphQueriesTableName}}\n| take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "{{graphQueriesTableName}}",
              "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "availability": {
            "isPreview": false,
            "status": 1
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true,
                  "action": false
                }
              }
            ],
            "customs": [
              {
                "name": "Salesforce Service Cloud API access",
                "description": "Access to the Salesforce Service Cloud API through a Connected App is required."
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Connect to Salesforce Service Cloud API to start collecting event logs in Microsoft Sentinel",
              "description": "Follow [Create a Connected App in Salesforce for OAuth](https://help.salesforce.com/s/articleView?id=platform.ev_relay_create_connected_app.htm&type=5) and [Configure a Connected App for the OAuth 2.0 Client Credentials Flow](https://help.salesforce.com/s/articleView?id=xcloud.connected_app_client_credentials_setup.htm&type=5) to create a Connected App with access to the Salesforce Service Cloud API. Through those instructions, you should get the Consumer Key and Consumer Secret.\n For Salesforce Domain name, Go to Setup, type My Domain in the Quick Find box, and select My Domain to view your domain details. Make sure to enter the domain name without a trailing slash (e.g., https://your-domain.my.salesforce.com). Fill the form below with that information.",
              "instructions": [
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "Salesforce Domain Name",
                    "placeholder": "Salesforce Domain Name",
                    "type": "text",
                    "name": "salesforceDomainName",
                    "validations": {
                      "required": true
                    }
                  }
                },
                {
                  "type": "Dropdown",
                  "parameters": {
                    "label": "Log Collection Interval",
                    "name": "queryType",
                    "options": [
                      {
                        "key": "SELECT Id,EventType,LogDate,Interval,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE Interval='Hourly' and CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                        "text": "Hourly"
                      },
                      {
                        "key": "SELECT Id,EventType,LogDate,CreatedDate,LogFile,LogFileLength FROM EventLogFile WHERE CreatedDate>{_QueryWindowStartTime} and CreatedDate<{_QueryWindowEndTime}",
                        "text": "Daily"
                      }
                    ],
                    "placeholder": "Select an interval type",
                    "isMultiSelect": false,
                    "required": true
                  }
                },
                {
                  "type": "OAuthForm",
                  "parameters": {
                    "clientIdLabel": "Consumer Key",
                    "clientSecretLabel": "Consumer Secret",
                    "clientIdPlaceholder": "Enter Connected App Consumer Key",
                    "clientSecretPlaceholder": "Enter Connected App Consumer Secret",
                    "connectButtonLabel": "Connect",
                    "disconnectButtonLabel": "Disconnect"
                  }
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition1')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition1'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com/"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections1'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
        "displayName": "Salesforce Service Cloud (via Codeless Connector Framework)",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "connectorDefinitionName": {
              "defaultValue": "Salesforce Service Cloud (via Codeless Connector Framework)",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "salesforceDomainName": {
              "defaultValue": "salesforceDomainName",
              "type": "securestring",
              "minLength": 1
            },
            "queryType": {
              "defaultValue": "queryType",
              "type": "array"
            },
            "ClientId": {
              "defaultValue": "-NA-",
              "type": "securestring",
              "minLength": 1
            },
            "ClientSecret": {
              "defaultValue": "-NA-",
              "type": "securestring",
              "minLength": 1
            },
            "AuthorizationCode": {
              "defaultValue": "-NA-",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections1": "[variables('_dataConnectorContentIdConnections1')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections1')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections1'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'SalesforceServiceCloudPolling', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "auth": {
                  "type": "OAuth2",
                  "ClientId": "[[parameters('clientId')]",
                  "ClientSecret": "[[parameters('clientSecret')]",
                  "GrantType": "client_credentials",
                  "TokenEndpoint": "[[concat(parameters('salesforceDomainName'),'/services/oauth2/token')]",
                  "TokenEndpointHeaders": {
                    "Accept": "application/json",
                    "Content-Type": "application/x-www-form-urlencoded"
                  },
                  "TokenEndpointQueryParameters": {}
                },
                "request": {
                  "apiEndpoint": "[[concat(parameters('salesforceDomainName'),'/services/data/v65.0/query')]",
                  "httpMethod": "GET",
                  "rateLimitQPS": 10,
                  "queryWindowInMin": 10,
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
                  },
                  "queryParameters": {
                    "q": "[[parameters('queryType')[0]]"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.records"
                  ],
                  "format": "json"
                },
                "paging": {
                  "pagingType": "NextPageUrl",
                  "nextPageUrl": "[[parameters('salesforceDomainName')]",
                  "nextPageTokenJsonPath": "$.nextRecordsUrl",
                  "isNextPageTokenRelativeUrl": true
                },
                "stepInfo": {
                  "stepType": "Nested",
                  "nextSteps": [
                    {
                      "stepId": "[variables('_stepId')]",
                      "stepPlaceholdersParsingKql": "source | project res = parse_json(data) | project logFileUrl = res.LogFile"
                    }
                  ]
                },
                "stepCollectorConfigs": {
                  "fetchLogFileData": {
                    "shouldJoinNestedData": true,
                    "joinedDataStepName": "LogData",
                    "request": {
                      "apiEndpoint": "[[concat(parameters('salesforceDomainName'),'$logFileUrl$')]",
                      "httpMethod": "GET",
                      "headers": {
                        "Accept": "application/json",
                        "User-Agent": "Scuba"
                      }
                    },
                    "response": {
                      "eventsJsonPaths": [
                        "$"
                      ],
                      "format": "csv",
                      "hasCsvHeader": true
                    }
                  }
                },
                "connectorDefinitionName": "SalesforceServiceCloudCCPDefinition",
                "dataType": "SalesforceServiceCloudV2_CL",
                "dcrConfig": {
                  "streamName": "Custom-SalesforceServiceCloudV2_CL",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections1'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject1').parserTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SalesforceServiceCloud Data Parser with template version 3.0.9",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject1').parserVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject1')._parserName1]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "SalesforceServiceCloud",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "SalesforceServiceCloud",
                "query": "SalesforceServiceCloud_CL \n| extend \n\t\tRequestSize=column_ifexists('request_size_s',''),\n\t\tExecTime=column_ifexists('exec_time_s',''),\n\t\tAction=column_ifexists('action_s',''),\n\t\tPlatformType=column_ifexists('platform_type_s',''),\n\t\tOsName=column_ifexists('os_name_s',''),\n\t\tOsVersion=column_ifexists('os_version_s',''),\n\t\tTimestamp=column_ifexists('timestamp_s',''),\n\t\tStatusCode=column_ifexists('status_code_s',''),\n\t\tEventType=column_ifexists('event_type_s',''),\n\t\tReferrerUri=column_ifexists('referrer_uri_s',''),\n\t\tUserAgent=column_ifexists('user_agent_s',''),\n\t\tBrowserType=column_ifexists('browser_type_s',''),\n\t\tTime=column_ifexists('time_s',''),\n\t\tResponseSize=column_ifexists('response_size_s',''),\n\t\tDeviceId=column_ifexists('device_id_s',''),\n\t\tDeviceModel=column_ifexists('device_model_s',''),\n\t\tSourceIp=column_ifexists('source_ip_s',''),\n\t\tClientIp=column_ifexists('client_ip_s',''),\n\t\tSuccess=column_ifexists('success_s',''),\n\t\tUri=column_ifexists('uri_s',''),\n\t\tUrl=column_ifexists('url_s',''),\n\t\tClientName=column_ifexists('client_name_s',''),\n\t\tUserType=column_ifexists('user_type_s',''),\n\t\tUserInitiatedLogout=column_ifexists('user_initiated_logout_s',''),\n\t\tUserIdDerived=column_ifexists('user_id_derived_s',''),\n\t\tUserId=column_ifexists('user_id_s',''),\n\t\tUserEmail=column_ifexists('user_email_s',''),\n\t\tUser=column_ifexists('user_name_s',''),\n\t\tUriIdDerived=column_ifexists('uri_id_derived_s',''),\n\t\tUiEventType=column_ifexists('ui_event_type_s',''),\n\t\tUiEventTimestamp=column_ifexists('ui_event_timestamp_s',''),\n\t\tUiEventSource=column_ifexists('ui_event_source_s',''),\n\t\tUiEventSequenceNum=column_ifexists('ui_event_sequence_num_s',''),\n\t\tUiEventId=column_ifexists('ui_event_id_s',''),\n\t\tTlsProtocol=column_ifexists('tls_protocol_s',''),\n\t\tTimestampDerived=column_ifexists('timestamp_derived_t',''),\n\t\tTargetUiElement=column_ifexists('target_ui_element_s',''),\n\t\tSort=column_ifexists('sort_s',''),\n\t\tSessionType=column_ifexists('session_type_s',''),\n\t\tSessionLevel=column_ifexists('session_level_s',''),\n\t\tSessionKey=column_ifexists('session_key_s',''),\n\t\tSearchQuery=column_ifexists('search_query_s',''),\n\t\tSdkVersion=column_ifexists('sdk_version_s',''),\n\t\tSdkAppVersion=column_ifexists('sdk_app_version_s',''),\n\t\tSdkAppType=column_ifexists('sdk_app_type_s',''),\n\t\tRunTime=column_ifexists('run_time_s',''),\n\t\tRowsProcessed=column_ifexists('rows_processed_s',''),\n\t\tRowCount=column_ifexists('row_count_s',''),\n\t\tResolutionType=column_ifexists('resolution_type_s',''),\n\t\tRequestStatus=column_ifexists('request_status_s',''),\n\t\tRequestId=column_ifexists('request_id_s',''),\n\t\tReportIdDerived=column_ifexists('report_id_derived_s',''),\n\t\tReportId=column_ifexists('report_id_s',''),\n\t\tRenderingType=column_ifexists('rendering_type_s',''),\n\t\tRelatedList=column_ifexists('related_list_s',''),\n\t\tRecordType=column_ifexists('record_type_s',''),\n\t\tRecordId=column_ifexists('record_id_s',''),\n\t\tQuiddity=column_ifexists('quiddity_s',''),\n\t\tQueryId=column_ifexists('query_id_s',''),\n\t\tPrevpageUrl=column_ifexists('prevpage_url_s',''),\n\t\tPrevpageEntityType=column_ifexists('prevpage_entity_type_s',''),\n\t\tPrevpageEntityId=column_ifexists('prevpage_entity_id_s',''),\n\t\tPrevpageContext=column_ifexists('prevpage_context_s',''),\n\t\tPrevpageAppName=column_ifexists('prevpage_app_name_s',''),\n\t\tPrefixesSearched=column_ifexists('prefixes_searched_s',''),\n\t\tParentUiElement=column_ifexists('parent_ui_element_s',''),\n\t\tPageUrl=column_ifexists('page_url_s',''),\n\t\tPageStartTime=column_ifexists('page_start_time_s',''),\n\t\tPageEntityType=column_ifexists('page_entity_type_s',''),\n\t\tPageEntityId=column_ifexists('page_entity_id_s',''),\n\t\tPageContext=column_ifexists('page_context_s',''),\n\t\tPageAppName=column_ifexists('page_app_name_s',''),\n\t\tOrigin=column_ifexists('origin_s',''),\n\t\tOrganizationId=column_ifexists('organization_id_s',''),\n\t\tNumResults=column_ifexists('num_results_s',''),\n\t\tNumberSoqlQueries=column_ifexists('number_soql_queries_s',''),\n\t\tNumberFields=column_ifexists('number_fields_s',''),\n\t\tNumberExceptionFilters=column_ifexists('number_exception_filters_s',''),\n\t\tNumberColumns=column_ifexists('number_columns_s',''),\n\t\tNumberBuckets=column_ifexists('number_buckets_s',''),\n\t\tMethodName=column_ifexists('method_name_s',''),\n\t\tMethod=column_ifexists('method_s',''),\n\t\tMediaType=column_ifexists('media_type_s',''),\n\t\tLoginStatus=column_ifexists('login_status_s',''),\n\t\tLoginKey=column_ifexists('login_key_s',''),\n\t\tHttpMethod=column_ifexists('http_method_s',''),\n\t\tGrandparentUiElement=column_ifexists('grandparent_ui_element_s',''),\n\t\tEntryPoint=column_ifexists('entry_point_s',''),\n\t\tEntityName=column_ifexists('entity_name_s',''),\n\t\tEntity=column_ifexists('entity_s',''),\n\t\tEffectivePageTime=column_ifexists('effective_page_time_s',''),\n\t\tDuration=column_ifexists('duration_s',''),\n\t\tDisplayType=column_ifexists('display_type_s',''),\n\t\tDeviceSessionId=column_ifexists('device_session_id_s',''),\n\t\tDevicePlatform=column_ifexists('device_platform_s',''),\n\t\tDbTotalTime=column_ifexists('db_total_time_s',''),\n\t\tDbCpuTime=column_ifexists('db_cpu_time_s',''),\n\t\tDbBlocks=column_ifexists('db_blocks_s',''),\n\t\tCpuTime=column_ifexists('cpu_time_s',''),\n\t\tConnectionType=column_ifexists('connection_type_s',''),\n\t\tComponentName=column_ifexists('component_name_s',''),\n\t\tClientVersion=column_ifexists('client_version_s',''),\n\t\tClientId=column_ifexists('client_id_s',''),\n\t\tCipherSuite=column_ifexists('cipher_suite_s',''),\n\t\tCalloutTime=column_ifexists('callout_time_s',''),\n\t\tBrowserVersion=column_ifexists('browser_version_s',''),\n\t\tBrowserName=column_ifexists('browser_name_s',''),\n\t\tAverageRowSize=column_ifexists('average_row_size_s',''),\n\t\tAppType=column_ifexists('app_type_s',''),\n\t\tAppName=column_ifexists('app_name_s',''),\n\t\tApiVersion=column_ifexists('api_version_s',''),\n\t\tApiType=column_ifexists('api_type_s',''),\n        ArticleVersionId=column_ifexists('article_version_id_s',''),\n\t\tArticleVersion=column_ifexists('article_version_s',''),\n\t\tArticleStatus=column_ifexists('article_status_s',''),\n\t\tArticleId=column_ifexists('article_id_s',''),\n        AnalyticsMode=column_ifexists('analytics_mode_s',''),\n        BatchId=column_ifexists('batch_id_s',''),\n        ClickedRecordId=column_ifexists('clicked_record_id_s',''),\n\t\tClassName=column_ifexists('class_name_s',''),\n        ComponentIdDerived=column_ifexists('component_id_derived_s',''),\n\t\tComponentId=column_ifexists('component_id_s',''),\n        ControllerType=column_ifexists('controller_type_s',''),\n\t\tContext=column_ifexists('context_s',''),\n\t\tConsoleIdDerived=column_ifexists('console_id_derived_s',''),\n\t\tConsoleId=column_ifexists('console_id_s',''),    \n        ClientInfo=column_ifexists('client_info_s',''),\n        DstBytes=column_ifexists('request_size_s',''),\n\t\tDstUser=column_ifexists('delegated_user_name_s',''),\n        DstUserSid=column_ifexists('delegated_user_id_s',''),\n\t\tDstUserSidDerived=column_ifexists('delegated_user_id_derived_s',''),\n        Data=column_ifexists('data_s',''),\n\t\tDashboardType=column_ifexists('dashboard_type_s',''),\n\t\tDashboardIdDerived=column_ifexists('dashboard_id_derived_s',''),\n\t\tDashboardId=column_ifexists('dashboard_id_s',''),\n\t\tDashboardComponentId=column_ifexists('dashboard_component_id_s',''),\n\t\tDvcAction=column_ifexists('action_s',''),\n\t\tDvcOS=column_ifexists('platform_type_s',''),\n\t\tDvcOSName=column_ifexists('os_name_s',''),\n\t\tDvcOSVersion=column_ifexists('os_version_s',''),\n        DeliveryLocation=column_ifexists('delivery_location_s',''),\n\t\tDeliveryId=column_ifexists('delivery_id_s',''),\n        DocumentIdDerived=column_ifexists('document_id_derived_s',''),\n\t\tDocumentId=column_ifexists('document_id_s',''),\n        EntityType=column_ifexists('entity_type_s',''),\n        EntityId=column_ifexists('entity_id_s',''),\n        FileType=column_ifexists('file_type_s',''),\n\t\tFilePreviewType=column_ifexists('file_preview_type_s',''),\n\t\tExceptionType=column_ifexists('exception_type_s',''),\n\t\tExceptionMessage=column_ifexists('exception_message_s',''),\n\t\tEpt=column_ifexists('ept_s',''),\n        EventCount=column_ifexists('number_of_records_s',''),\n\t\tEventEndTime=column_ifexists('timestamp_s',''),\n\t\tEventResult=column_ifexists('status_code_s',''),\n\t\tFileSize=column_ifexists('size_bytes_s',''),\n        HttpReferrerOriginal=column_ifexists('referrer_uri_s',''),\n\t\tHttpUserAgentOriginal=column_ifexists('user_agent_s',''),\n\t\tHttpUserAgent=column_ifexists('browser_type_s',''),\n        LogGroupId=column_ifexists('log_group_id_s',''),\n\t\tLimitUsagePercent=column_ifexists('limit_usage_percent_s',''),\n\t\tLicenseContext=column_ifexists('license_context_s',''),\n\t\tLastVersion=column_ifexists('last_version_s',''),\n\t\tLanguage=column_ifexists('language_s',''),\n\t\tJobId=column_ifexists('job_id_s',''),\n\t\tIsSuccess=column_ifexists('is_success_s',''),\n\t\tIsSecure=column_ifexists('is_secure_s',''),\n\t\tIsScheduled=column_ifexists('is_scheduled_s',''),\n\t\tIsNew=column_ifexists('is_new_s',''),\n\t\tIsMobile=column_ifexists('is_mobile_s',''),\n\t\tIsLongRunningRequest=column_ifexists('is_long_running_request_s',''),\n\t\tIsGuest=column_ifexists('is_guest_s',''),\n\t\tIsFirstRequest=column_ifexists('is_first_request_s',''),\n\t\tIsError=column_ifexists('is_error_s',''),\n\t\tIsApi=column_ifexists('is_api_s',''),\n\t\tIsAjaxRequest=column_ifexists('is_ajax_request_s',''),\n        ManagedPackageNamespace=column_ifexists('managed_package_namespace_s',''),\n        HttpHeaders=column_ifexists('http_headers_s',''),\n\t\tNetworkDuration=column_ifexists('time_s',''),\n        Name=column_ifexists('name_s',''),\n        NumberFailures=column_ifexists('number_failures_s',''),\n        NumClicks=column_ifexists('num_clicks_s',''),\n        OperationType=column_ifexists('operation_type_s',''),\n\t\tNumSessions=column_ifexists('num_sessions_s',''),\n        PageName=column_ifexists('page_name_s',''),\n        Query=column_ifexists('query_s',''),\n        RequestType=column_ifexists('request_type_s',''),\n        ReportDescription=column_ifexists('report_description_s',''),\n\t\tReopenCount=column_ifexists('reopen_count_s',''),\n        RelatedEntityId=column_ifexists('related_entity_id_s',''),\n        RecordIdDerived=column_ifexists('record_id_derived_s',''),\n        ReadTime=column_ifexists('read_time_s',''),\n\t\tRank=column_ifexists('rank_s',''),\n\t\tSrcBytes=column_ifexists('response_size_s',''),\n\t\tSrcDvcId=column_ifexists('device_id_s',''),\n\t\tSrcDvcModelName=column_ifexists('device_model_s',''),\n\t\tSrcIpAddr=column_ifexists('source_ip_s',''),\n\t\tSrcNatIpAddr=column_ifexists('client_ip_s',''),\n        SessionId=column_ifexists('session_id_s',''),\n        SiteId=column_ifexists('site_id_s',''),\n\t\tSharingPermission=column_ifexists('sharing_permission_s',''),\n\t\tSharingOperation=column_ifexists('sharing_operation_s',''),\n\t\tSharedWithEntityId=column_ifexists('shared_with_entity_id_s',''),\n\t\tUrlOriginal=column_ifexists('url_s',''),\n\t\tWaveTimestamp=column_ifexists('wave_timestamp_s',''),\n\t\tWaveSessionId=column_ifexists('wave_session_id_g',''),\n\t\tViewStateSize=column_ifexists('view_state_size_s',''),\n\t\tVersionIdDerived=column_ifexists('version_id_derived_s',''),\n\t\tVersionId=column_ifexists('version_id_s',''),\n        TriggerType=column_ifexists('trigger_type_s',''),\n\t\tTriggerName=column_ifexists('trigger_name_s',''),\n\t\tTriggerId=column_ifexists('trigger_id_s',''),\n\t\tTransactionType=column_ifexists('transaction_type_s',''),\n\t\tTotalTime=column_ifexists('total_time_s',''),\n        TabId=column_ifexists('tab_id_s',''),\n\t\tStackTrace=column_ifexists('stack_trace_s','')\n| project-away  *_s\n| union isfuzzy=true SalesforceServiceCloudV2_CL\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
              "dependsOn": [
                "[variables('parserObject1')._parserId1]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'SalesforceServiceCloud')]",
                "contentId": "[variables('parserObject1').parserContentId1]",
                "kind": "Parser",
                "version": "[variables('parserObject1').parserVersion1]",
                "source": {
                  "name": "Salesforce Service Cloud",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "contentKind": "Parser",
        "displayName": "SalesforceServiceCloud",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "version": "[variables('parserObject1').parserVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject1')._parserName1]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "SalesforceServiceCloud",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "SalesforceServiceCloud",
        "query": "SalesforceServiceCloud_CL \n| extend \n\t\tRequestSize=column_ifexists('request_size_s',''),\n\t\tExecTime=column_ifexists('exec_time_s',''),\n\t\tAction=column_ifexists('action_s',''),\n\t\tPlatformType=column_ifexists('platform_type_s',''),\n\t\tOsName=column_ifexists('os_name_s',''),\n\t\tOsVersion=column_ifexists('os_version_s',''),\n\t\tTimestamp=column_ifexists('timestamp_s',''),\n\t\tStatusCode=column_ifexists('status_code_s',''),\n\t\tEventType=column_ifexists('event_type_s',''),\n\t\tReferrerUri=column_ifexists('referrer_uri_s',''),\n\t\tUserAgent=column_ifexists('user_agent_s',''),\n\t\tBrowserType=column_ifexists('browser_type_s',''),\n\t\tTime=column_ifexists('time_s',''),\n\t\tResponseSize=column_ifexists('response_size_s',''),\n\t\tDeviceId=column_ifexists('device_id_s',''),\n\t\tDeviceModel=column_ifexists('device_model_s',''),\n\t\tSourceIp=column_ifexists('source_ip_s',''),\n\t\tClientIp=column_ifexists('client_ip_s',''),\n\t\tSuccess=column_ifexists('success_s',''),\n\t\tUri=column_ifexists('uri_s',''),\n\t\tUrl=column_ifexists('url_s',''),\n\t\tClientName=column_ifexists('client_name_s',''),\n\t\tUserType=column_ifexists('user_type_s',''),\n\t\tUserInitiatedLogout=column_ifexists('user_initiated_logout_s',''),\n\t\tUserIdDerived=column_ifexists('user_id_derived_s',''),\n\t\tUserId=column_ifexists('user_id_s',''),\n\t\tUserEmail=column_ifexists('user_email_s',''),\n\t\tUser=column_ifexists('user_name_s',''),\n\t\tUriIdDerived=column_ifexists('uri_id_derived_s',''),\n\t\tUiEventType=column_ifexists('ui_event_type_s',''),\n\t\tUiEventTimestamp=column_ifexists('ui_event_timestamp_s',''),\n\t\tUiEventSource=column_ifexists('ui_event_source_s',''),\n\t\tUiEventSequenceNum=column_ifexists('ui_event_sequence_num_s',''),\n\t\tUiEventId=column_ifexists('ui_event_id_s',''),\n\t\tTlsProtocol=column_ifexists('tls_protocol_s',''),\n\t\tTimestampDerived=column_ifexists('timestamp_derived_t',''),\n\t\tTargetUiElement=column_ifexists('target_ui_element_s',''),\n\t\tSort=column_ifexists('sort_s',''),\n\t\tSessionType=column_ifexists('session_type_s',''),\n\t\tSessionLevel=column_ifexists('session_level_s',''),\n\t\tSessionKey=column_ifexists('session_key_s',''),\n\t\tSearchQuery=column_ifexists('search_query_s',''),\n\t\tSdkVersion=column_ifexists('sdk_version_s',''),\n\t\tSdkAppVersion=column_ifexists('sdk_app_version_s',''),\n\t\tSdkAppType=column_ifexists('sdk_app_type_s',''),\n\t\tRunTime=column_ifexists('run_time_s',''),\n\t\tRowsProcessed=column_ifexists('rows_processed_s',''),\n\t\tRowCount=column_ifexists('row_count_s',''),\n\t\tResolutionType=column_ifexists('resolution_type_s',''),\n\t\tRequestStatus=column_ifexists('request_status_s',''),\n\t\tRequestId=column_ifexists('request_id_s',''),\n\t\tReportIdDerived=column_ifexists('report_id_derived_s',''),\n\t\tReportId=column_ifexists('report_id_s',''),\n\t\tRenderingType=column_ifexists('rendering_type_s',''),\n\t\tRelatedList=column_ifexists('related_list_s',''),\n\t\tRecordType=column_ifexists('record_type_s',''),\n\t\tRecordId=column_ifexists('record_id_s',''),\n\t\tQuiddity=column_ifexists('quiddity_s',''),\n\t\tQueryId=column_ifexists('query_id_s',''),\n\t\tPrevpageUrl=column_ifexists('prevpage_url_s',''),\n\t\tPrevpageEntityType=column_ifexists('prevpage_entity_type_s',''),\n\t\tPrevpageEntityId=column_ifexists('prevpage_entity_id_s',''),\n\t\tPrevpageContext=column_ifexists('prevpage_context_s',''),\n\t\tPrevpageAppName=column_ifexists('prevpage_app_name_s',''),\n\t\tPrefixesSearched=column_ifexists('prefixes_searched_s',''),\n\t\tParentUiElement=column_ifexists('parent_ui_element_s',''),\n\t\tPageUrl=column_ifexists('page_url_s',''),\n\t\tPageStartTime=column_ifexists('page_start_time_s',''),\n\t\tPageEntityType=column_ifexists('page_entity_type_s',''),\n\t\tPageEntityId=column_ifexists('page_entity_id_s',''),\n\t\tPageContext=column_ifexists('page_context_s',''),\n\t\tPageAppName=column_ifexists('page_app_name_s',''),\n\t\tOrigin=column_ifexists('origin_s',''),\n\t\tOrganizationId=column_ifexists('organization_id_s',''),\n\t\tNumResults=column_ifexists('num_results_s',''),\n\t\tNumberSoqlQueries=column_ifexists('number_soql_queries_s',''),\n\t\tNumberFields=column_ifexists('number_fields_s',''),\n\t\tNumberExceptionFilters=column_ifexists('number_exception_filters_s',''),\n\t\tNumberColumns=column_ifexists('number_columns_s',''),\n\t\tNumberBuckets=column_ifexists('number_buckets_s',''),\n\t\tMethodName=column_ifexists('method_name_s',''),\n\t\tMethod=column_ifexists('method_s',''),\n\t\tMediaType=column_ifexists('media_type_s',''),\n\t\tLoginStatus=column_ifexists('login_status_s',''),\n\t\tLoginKey=column_ifexists('login_key_s',''),\n\t\tHttpMethod=column_ifexists('http_method_s',''),\n\t\tGrandparentUiElement=column_ifexists('grandparent_ui_element_s',''),\n\t\tEntryPoint=column_ifexists('entry_point_s',''),\n\t\tEntityName=column_ifexists('entity_name_s',''),\n\t\tEntity=column_ifexists('entity_s',''),\n\t\tEffectivePageTime=column_ifexists('effective_page_time_s',''),\n\t\tDuration=column_ifexists('duration_s',''),\n\t\tDisplayType=column_ifexists('display_type_s',''),\n\t\tDeviceSessionId=column_ifexists('device_session_id_s',''),\n\t\tDevicePlatform=column_ifexists('device_platform_s',''),\n\t\tDbTotalTime=column_ifexists('db_total_time_s',''),\n\t\tDbCpuTime=column_ifexists('db_cpu_time_s',''),\n\t\tDbBlocks=column_ifexists('db_blocks_s',''),\n\t\tCpuTime=column_ifexists('cpu_time_s',''),\n\t\tConnectionType=column_ifexists('connection_type_s',''),\n\t\tComponentName=column_ifexists('component_name_s',''),\n\t\tClientVersion=column_ifexists('client_version_s',''),\n\t\tClientId=column_ifexists('client_id_s',''),\n\t\tCipherSuite=column_ifexists('cipher_suite_s',''),\n\t\tCalloutTime=column_ifexists('callout_time_s',''),\n\t\tBrowserVersion=column_ifexists('browser_version_s',''),\n\t\tBrowserName=column_ifexists('browser_name_s',''),\n\t\tAverageRowSize=column_ifexists('average_row_size_s',''),\n\t\tAppType=column_ifexists('app_type_s',''),\n\t\tAppName=column_ifexists('app_name_s',''),\n\t\tApiVersion=column_ifexists('api_version_s',''),\n\t\tApiType=column_ifexists('api_type_s',''),\n        ArticleVersionId=column_ifexists('article_version_id_s',''),\n\t\tArticleVersion=column_ifexists('article_version_s',''),\n\t\tArticleStatus=column_ifexists('article_status_s',''),\n\t\tArticleId=column_ifexists('article_id_s',''),\n        AnalyticsMode=column_ifexists('analytics_mode_s',''),\n        BatchId=column_ifexists('batch_id_s',''),\n        ClickedRecordId=column_ifexists('clicked_record_id_s',''),\n\t\tClassName=column_ifexists('class_name_s',''),\n        ComponentIdDerived=column_ifexists('component_id_derived_s',''),\n\t\tComponentId=column_ifexists('component_id_s',''),\n        ControllerType=column_ifexists('controller_type_s',''),\n\t\tContext=column_ifexists('context_s',''),\n\t\tConsoleIdDerived=column_ifexists('console_id_derived_s',''),\n\t\tConsoleId=column_ifexists('console_id_s',''),    \n        ClientInfo=column_ifexists('client_info_s',''),\n        DstBytes=column_ifexists('request_size_s',''),\n\t\tDstUser=column_ifexists('delegated_user_name_s',''),\n        DstUserSid=column_ifexists('delegated_user_id_s',''),\n\t\tDstUserSidDerived=column_ifexists('delegated_user_id_derived_s',''),\n        Data=column_ifexists('data_s',''),\n\t\tDashboardType=column_ifexists('dashboard_type_s',''),\n\t\tDashboardIdDerived=column_ifexists('dashboard_id_derived_s',''),\n\t\tDashboardId=column_ifexists('dashboard_id_s',''),\n\t\tDashboardComponentId=column_ifexists('dashboard_component_id_s',''),\n\t\tDvcAction=column_ifexists('action_s',''),\n\t\tDvcOS=column_ifexists('platform_type_s',''),\n\t\tDvcOSName=column_ifexists('os_name_s',''),\n\t\tDvcOSVersion=column_ifexists('os_version_s',''),\n        DeliveryLocation=column_ifexists('delivery_location_s',''),\n\t\tDeliveryId=column_ifexists('delivery_id_s',''),\n        DocumentIdDerived=column_ifexists('document_id_derived_s',''),\n\t\tDocumentId=column_ifexists('document_id_s',''),\n        EntityType=column_ifexists('entity_type_s',''),\n        EntityId=column_ifexists('entity_id_s',''),\n        FileType=column_ifexists('file_type_s',''),\n\t\tFilePreviewType=column_ifexists('file_preview_type_s',''),\n\t\tExceptionType=column_ifexists('exception_type_s',''),\n\t\tExceptionMessage=column_ifexists('exception_message_s',''),\n\t\tEpt=column_ifexists('ept_s',''),\n        EventCount=column_ifexists('number_of_records_s',''),\n\t\tEventEndTime=column_ifexists('timestamp_s',''),\n\t\tEventResult=column_ifexists('status_code_s',''),\n\t\tFileSize=column_ifexists('size_bytes_s',''),\n        HttpReferrerOriginal=column_ifexists('referrer_uri_s',''),\n\t\tHttpUserAgentOriginal=column_ifexists('user_agent_s',''),\n\t\tHttpUserAgent=column_ifexists('browser_type_s',''),\n        LogGroupId=column_ifexists('log_group_id_s',''),\n\t\tLimitUsagePercent=column_ifexists('limit_usage_percent_s',''),\n\t\tLicenseContext=column_ifexists('license_context_s',''),\n\t\tLastVersion=column_ifexists('last_version_s',''),\n\t\tLanguage=column_ifexists('language_s',''),\n\t\tJobId=column_ifexists('job_id_s',''),\n\t\tIsSuccess=column_ifexists('is_success_s',''),\n\t\tIsSecure=column_ifexists('is_secure_s',''),\n\t\tIsScheduled=column_ifexists('is_scheduled_s',''),\n\t\tIsNew=column_ifexists('is_new_s',''),\n\t\tIsMobile=column_ifexists('is_mobile_s',''),\n\t\tIsLongRunningRequest=column_ifexists('is_long_running_request_s',''),\n\t\tIsGuest=column_ifexists('is_guest_s',''),\n\t\tIsFirstRequest=column_ifexists('is_first_request_s',''),\n\t\tIsError=column_ifexists('is_error_s',''),\n\t\tIsApi=column_ifexists('is_api_s',''),\n\t\tIsAjaxRequest=column_ifexists('is_ajax_request_s',''),\n        ManagedPackageNamespace=column_ifexists('managed_package_namespace_s',''),\n        HttpHeaders=column_ifexists('http_headers_s',''),\n\t\tNetworkDuration=column_ifexists('time_s',''),\n        Name=column_ifexists('name_s',''),\n        NumberFailures=column_ifexists('number_failures_s',''),\n        NumClicks=column_ifexists('num_clicks_s',''),\n        OperationType=column_ifexists('operation_type_s',''),\n\t\tNumSessions=column_ifexists('num_sessions_s',''),\n        PageName=column_ifexists('page_name_s',''),\n        Query=column_ifexists('query_s',''),\n        RequestType=column_ifexists('request_type_s',''),\n        ReportDescription=column_ifexists('report_description_s',''),\n\t\tReopenCount=column_ifexists('reopen_count_s',''),\n        RelatedEntityId=column_ifexists('related_entity_id_s',''),\n        RecordIdDerived=column_ifexists('record_id_derived_s',''),\n        ReadTime=column_ifexists('read_time_s',''),\n\t\tRank=column_ifexists('rank_s',''),\n\t\tSrcBytes=column_ifexists('response_size_s',''),\n\t\tSrcDvcId=column_ifexists('device_id_s',''),\n\t\tSrcDvcModelName=column_ifexists('device_model_s',''),\n\t\tSrcIpAddr=column_ifexists('source_ip_s',''),\n\t\tSrcNatIpAddr=column_ifexists('client_ip_s',''),\n        SessionId=column_ifexists('session_id_s',''),\n        SiteId=column_ifexists('site_id_s',''),\n\t\tSharingPermission=column_ifexists('sharing_permission_s',''),\n\t\tSharingOperation=column_ifexists('sharing_operation_s',''),\n\t\tSharedWithEntityId=column_ifexists('shared_with_entity_id_s',''),\n\t\tUrlOriginal=column_ifexists('url_s',''),\n\t\tWaveTimestamp=column_ifexists('wave_timestamp_s',''),\n\t\tWaveSessionId=column_ifexists('wave_session_id_g',''),\n\t\tViewStateSize=column_ifexists('view_state_size_s',''),\n\t\tVersionIdDerived=column_ifexists('version_id_derived_s',''),\n\t\tVersionId=column_ifexists('version_id_s',''),\n        TriggerType=column_ifexists('trigger_type_s',''),\n\t\tTriggerName=column_ifexists('trigger_name_s',''),\n\t\tTriggerId=column_ifexists('trigger_id_s',''),\n\t\tTransactionType=column_ifexists('transaction_type_s',''),\n\t\tTotalTime=column_ifexists('total_time_s',''),\n        TabId=column_ifexists('tab_id_s',''),\n\t\tStackTrace=column_ifexists('stack_trace_s','')\n| project-away  *_s\n| union isfuzzy=true SalesforceServiceCloudV2_CL\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
      "dependsOn": [
        "[variables('parserObject1')._parserId1]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'SalesforceServiceCloud')]",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "kind": "Parser",
        "version": "[variables('parserObject1').parserVersion1]",
        "source": {
          "kind": "Solution",
          "name": "Salesforce Service Cloud",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "SalesforceServiceCloud Workbook with template version 3.0.9",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Sets the time name for analysis."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Salesforce Service Cloud Workbook\\n---\\n\\nThis workbook brings together queries and visualizations to assist you in identifying potential threats in your Salesforce Service cloud audit data. Visualizations may not appear if no data is present.\\n\\nTo begin select the desired TimeRange to filter the data to the timeframe you want to focus on. Note if you have a large amount of salesforce service cloud data, queries may timeout with a large time range, if this is the case simply select a smaller time range.: \",\"style\":\"info\"},\"name\":\"text - 2\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"412a09a0-64ae-4614-aec6-cbfc9273b82b\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":1800000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 32\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"ae90d1dc-20da-4948-80da-127b210bf152\",\"cellValue\":\"view_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"User Logins\",\"subTarget\":\"1\",\"style\":\"link\"},{\"id\":\"af58b4d9-a888-43ed-91a9-6e9f539a61d4\",\"cellValue\":\"view_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"API Usage\",\"subTarget\":\"2\",\"style\":\"link\"}]},\"name\":\"links - 34\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"User login locations\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let Countrydb = externaldata(Network:string, geoname_id:string, continent_code:string, continent_name:string, country_iso_code:string, country_name:string)\\n[@\\\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\\\"];\\nlet UsersLocation = SalesforceServiceCloud\\n| where EventType == \\\"Login\\\"\\n| project TimeGenerated, SourceIp;\\nUsersLocation\\n| extend Dummy=1\\n| summarize count() by Hour=bin(TimeGenerated,24h), SourceIp,Dummy\\n| partition by Hour(\\n                  lookup (Countrydb|extend Dummy=1) on Dummy\\n                | where ipv4_is_match(SourceIp, Network)\\n                )\\n| summarize sum(count_) by country_name\",\"size\":3,\"title\":\"Heat Map- Geographical - {TimeRange:label}\",\"timeContextFromParameter\":\"TimeRange\",\"exportedParameters\":[{\"fieldName\":\"TimeGenerated\",\"parameterName\":\"RetTime\"},{\"parameterType\":1}],\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"chartSettings\":{\"showLegend\":true},\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"country_name\",\"sizeSettings\":\"sum_count_\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"sum_count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"sum_count_\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"70\",\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == 'Login'\\r\\n| summarize AvgLogintime = avg(toint(RunTime)), MaxLoginTime = max(toint(RunTime)), TotalLoginRequests = count() by EventType\\r\\n| project-away EventType\",\"size\":1,\"title\":\"Overview - User login requests\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"AvgLogintime\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"palette\":\"categorical\"},\"numberFormat\":{\"unit\":23,\"options\":{\"style\":\"decimal\"}}},{\"columnMatch\":\"MaxLoginTime\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"palette\":\"categorical\"},\"numberFormat\":{\"unit\":23,\"options\":{\"style\":\"decimal\"}}},{\"columnMatch\":\"TotalLoginRequests\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"palette\":\"categorical\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}}}],\"rowLimit\":1},\"tileSettings\":{\"showBorder\":false}},\"customWidth\":\"30\",\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == 'Login'\\r\\n| summarize count() by bin(TimeGenerated, 1h),User, ClientIp \\r\\n| top 10 by count_\",\"size\":0,\"title\":\"Top 10 users with maximun logins - {TimeRange:label}\",\"exportFieldName\":\"UserId\",\"exportParameterName\":\"RetUser\",\"exportDefaultValue\":\"all users\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"user_name_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"TimeGenerated\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false},\"chartSettings\":{\"showLegend\":true}},\"customWidth\":\"60\",\"name\":\"query - 2\"},{\"type\":1,\"content\":{\"json\":\"To leverage infomation about Malicious IP, Threat Indicator solution should be configured and ThreatIntelIndicatorsv2 table should have information of malicious IP.\",\"style\":\"info\"},\"customWidth\":\"10\",\"name\":\"text - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"  let malicious_ips =\\r\\n  ThreatIntelIndicatorsv2\\r\\n  | where isnotempty(NetworkIP)\\r\\n  | summarize make_list(NetworkIP);  \\r\\n  SalesforceServiceCloud\\r\\n  | where EventType == 'Login'\\r\\n  | distinct User,ClientIp\\r\\n  | where ClientIp   in (malicious_ips)\\r\\n  | project UserName = User, MaliciousIP = ClientIp\\r\\n\",\"size\":1,\"title\":\"Malicious IP- User Login\",\"noDataMessage\":\"No Malicious IP found\",\"timeBrushParameterName\":\"TimeBrush\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"UserName\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"palette\":\"categorical\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}},{\"columnMatch\":\"MaliciousIP\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}}]},\"graphSettings\":{\"type\":0},\"chartSettings\":{\"showMetrics\":false}},\"customWidth\":\"30\",\"name\":\"query - 23\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == 'LoginAS'\\r\\n| project UserID = UserId,DerivedUSerID = UserIdDerived,EventType = EventType, IPAddress = ClientIp, LoginKey = LoginKey, OrgID = OrganizationId, RequestID = RequestId, SessionKey = SessionKey\\r\\n| limit 10\",\"size\":0,\"title\":\"User Activity- LoginAS(Top 10)\",\"noDataMessage\":\"No user impersonation found\",\"exportFieldName\":\"IPAddress\",\"exportParameterName\":\"RetIP\",\"exportDefaultValue\":\"all IP addresses\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IPAddress\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"TotalRecords\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":false}},\"customWidth\":\"60\",\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == 'LoginAs'\\r\\n| where isnotempty(User)\\r\\n| summarize  count() by User,UserIdDerived,ClientIp\\r\\n| project UserName = User,DerivedUSerID = UserIdDerived,IPAddress = ClientIp, count_\",\"size\":1,\"title\":\"User Impersonation from different IP Addresses\",\"color\":\"blue\",\"noDataMessage\":\"No user impersonation found\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"UserName\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"DerivedUSerID\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"IPAddress\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"count_\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}}],\"labelSettings\":[{\"columnId\":\"UserName\",\"label\":\"User Name\"},{\"columnId\":\"DerivedUSerID\",\"label\":\"Impersonated ID\"},{\"columnId\":\"IPAddress\",\"label\":\"IP Address\"},{\"columnId\":\"count_\",\"label\":\"Total Login\"}]},\"chartSettings\":{\"xAxis\":\"IPAddress\",\"yAxis\":[\"count_\"],\"showLegend\":true}},\"customWidth\":\"40\",\"name\":\"query - 24\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == 'Login'\\r\\n| where isnotempty(User)\\r\\n| project UserName= User,APIType= ApiType, Browser= BrowserType, CipherSuite =CipherSuite, IP =ClientIp, CPUTime=CpuTime, UserType = UserType\\r\\n| take 200\",\"size\":0,\"title\":\"User Successful Login Activity\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"customWidth\":\"60\",\"name\":\"query - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == 'Login'\\r\\n| where isnotempty(User)\\r\\n| where LoginStatus !has('LOGIN_NO_ERROR')\\r\\n| summarize  count() by User, ClientIp\\r\\n| project UserName = User, IP = ClientIp, Count = count_\",\"size\":1,\"title\":\"User Unsuccessful Logins by IP\",\"noDataMessage\":\"No Unsucessful Login found\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"UserName\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"IP\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"Count\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}}],\"labelSettings\":[{\"columnId\":\"UserName\",\"label\":\"User Name\"},{\"columnId\":\"IP\",\"label\":\"IP Address\"},{\"columnId\":\"Count\",\"label\":\"Count\"}]},\"chartSettings\":{\"xAxis\":\"UserName\",\"yAxis\":[\"Count\"],\"ySettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"30\",\"name\":\"query - 5\"}]},\"conditionalVisibility\":{\"parameterName\":\"view_tab\",\"comparison\":\"isEqualTo\",\"value\":\"1\"},\"name\":\"Retrieval Events\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"API Usage\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| summarize  count() by EventType\",\"size\":0,\"title\":\"Most fired events\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":50,\"name\":\"query - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType == \\\"ApiTotalUsage\\\"\\r\\n| summarize count() by IPAddress = ClientIp,Entity = EntityName\\r\\n| order by Entity\",\"size\":0,\"title\":\"Most accessed entities by IP Address\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"user_id_s\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}},{\"columnMatch\":\"entity_name_s\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"client_ip_s\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"}},{\"columnMatch\":\"count_\",\"formatter\":8,\"formatOptions\":{\"palette\":\"categorical\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}}}],\"labelSettings\":[{\"columnId\":\"count_\",\"label\":\"Count\"}]}},\"customWidth\":\"50\",\"name\":\"query - 5\",\"styleSettings\":{\"maxWidth\":\"30%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SalesforceServiceCloud\\r\\n| where EventType  == \\\"ApiTotalUsage\\\"\\r\\n| summarize count() by EntityName\",\"size\":0,\"title\":\"Most accessed Entities\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"query - 6\"}]},\"conditionalVisibility\":{\"parameterName\":\"view_tab\",\"comparison\":\"isEqualTo\",\"value\":\"2\"},\"name\":\"APIUsage\"}],\"fromTemplateId\":\"sentinel-SalesforceServiceCloudWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=SalesforceServiceCloudWorkbook; logoFileName=salesforce_logo.svg; description=Sets the time name for analysis.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Salesforce Service Cloud; templateRelativePath=SalesforceServiceCloud.json; subtitle=; provider=Salesforce}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Salesforce Service Cloud",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "SalesforceServiceCloud",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "SalesforceServiceCloud_CL",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.9",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Salesforce Service Cloud",
        "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Salesforce%20Service%20Cloud/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The <a href=\"https://www.salesforce.com/in/products/service-cloud/overview/\">Salesforce Service Cloud</a> solution for Microsoft Sentinel enables you to ingest Service Cloud events into Microsoft Sentinel.</p>\n<p><strong>Underlying Microsoft Technologies used:</strong></p>\n<p>This solution takes a dependency on the following technologies, and some of these dependencies either may be in <a href=\"https://azure.microsoft.com/support/legal/preview-supplemental-terms/\">Preview</a> state or might result in additional ingestion or operational costs:</p>\n<p> <a href=\"https://aka.ms/Sentinel-CCP_Platform\">Microsoft Sentinel Codeless Connector Framework</a></p>\n<p><strong>Data Connectors:</strong> 1, <strong>Parsers:</strong> 1, <strong>Workbooks:</strong> 1, <strong>Analytic Rules:</strong> 3</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/salesforce_logo.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Salesforce Service Cloud",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com/"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject3')._analyticRulecontentId3]",
              "version": "[variables('analyticRuleObject3').analyticRuleVersion3]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections1')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject1').parserContentId1]",
              "version": "[variables('parserObject1').parserVersion1]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            }
          ]
        },
        "firstPublishDate": "2022-05-16",
        "providers": [
          "Salesforce"
        ],
        "categories": {
          "domains": [
            "Cloud Provider"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}