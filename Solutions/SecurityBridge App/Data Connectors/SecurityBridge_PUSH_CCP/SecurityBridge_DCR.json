{
    "name": "SecurityBridge-DCR",
    "apiVersion": "2023-03-11",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
        "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
                            "streamDeclarations": {
                      "Custom-SecurityBridge_CL": {
                        "columns": [
                          { "name": "TimeGenerated", "type": "datetime" },
                          { "name": "BusinessEvent", "type": "string" },
                          { "name": "action", "type": "string" },
                          { "name": "attribute1", "type": "string" },
                          { "name": "attribute2", "type": "string" },
                          { "name": "attribute3", "type": "string" },
                          { "name": "attribute4", "type": "string" },
                          { "name": "attribute5", "type": "string" },
                          { "name": "client", "type": "string" },
                          { "name": "EventdateISO8601", "type": "datetime" },
                          { "name": "Eventdatetimestamp", "type": "string" },
                          { "name": "Eventtime", "type": "string" },
                          { "name": "Eventdate", "type": "string" },
                          { "name": "RecdateISO8601", "type": "datetime" },
                          { "name": "message", "type": "string" },
                          { "name": "Listener", "type": "string" },
                          { "name": "Program", "type": "string" },
                          { "name": "severity", "type": "string" },
                          { "name": "DataSource", "type": "string" },
                          { "name": "RawDatastructure", "type": "string" },
                          { "name": "Agent", "type": "string" },
                          { "name": "triggeringTA", "type": "string" },
                          { "name": "triggeringTerminal", "type": "string" },
                          { "name": "Terminal", "type": "string" },
                          { "name": "User", "type": "string" },
                          { "name": "UserGroup", "type": "string" },
                          { "name": "UserType", "type": "string" },
                          { "name": "User_Full", "type": "string" },
                          { "name": "UPN", "type": "string" },
                          { "name": "IP", "type": "string" },
                          { "name": "FQDN", "type": "string" },
                          { "name": "AppServerName", "type": "string" },
                          { "name": "PGUID", "type": "string" },
                          { "name": "ReferenceUser", "type": "string" },
                          { "name": "StagingLevel", "type": "string" },
                          { "name": "BContact_Mail", "type": "string" },
                          { "name": "BContact_name", "type": "string" },
                          { "name": "PContact_Mail", "type": "string" },
                          { "name": "PContact_name", "type": "string" },
                          { "name": "guid", "type": "string" }
                        ]
                      }  
                      },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "clv2ws1"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Microsoft-ABAPAuditLog"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n",
                "outputStream": "Microsoft-ABAPAuditLog"
            },
            {
                        "streams": ["Custom-SecurityBridge_CL"],
                        "destinations": ["clv2ws1"],
                        "transformKql": "source\n| extend TimeGenerated = now()\n| project\n    TimeGenerated,\n    BusinessEvent,\n    action,\n    attribute1,\n    attribute2,\n    attribute3,\n    attribute4,\n    attribute5,\n    client,\n    EventdateISO8601,\n    Eventdatetimestamp,\n    Eventtime,\n    Eventdate,\n    RecdateISO8601,\n    message,\n    Listener,\n    Program,\n    severity,\n    DataSource,\n    RawDatastructure,\n    Agent,\n    triggeringTA,\n    triggeringTerminal,\n    Terminal,\n    User,\n    UserGroup,\n    UserType,\n    User_Full,\n    UPN,\n    IP,\n    FQDN,\n    AppServerName,\n    PGUID,\n    ReferenceUser,\n    StagingLevel,\n    BContact_Mail,\n    BContact_name,\n    PContact_Mail,\n    PContact_name,\n    guid",
                        "outputStream": "Custom-SecurityBridge_CL"
            }
        ]
    }
}
