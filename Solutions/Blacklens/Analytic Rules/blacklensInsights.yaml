id: e261b70a-3005-4a1b-a7a2-2c8147fafed7
name: blacklens Insights
description: |
  'Creates incidents from blacklens.io Attack Surface Management alerts ingested into the blacklens_CL table. Alert severity is mapped dynamically from the source data.'
severity: High
status: Available
requiredDataConnectors:
  - connectorId: blacklens_io
    dataTypes:
      - blacklens_CL
kind: NRT
query: |
  blacklens_CL
  | summarize arg_max(TimeGenerated, *) by id
  | extend AlertSeverity = case(
      tolower(severity) == "high", "High",
      tolower(severity) == "medium", "Medium",
      tolower(severity) == "low", "Low",
      "Informational"
  )
suppressionDuration: PT5H
suppressionEnabled: false
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
eventGroupingSettings:
  aggregationKind: AlertPerResult
alertDetailsOverride:
  alertDisplayNameFormat: "{{alert_title}}"
  alertDescriptionFormat: "{{message}}"
  alertSeverityColumnName: AlertSeverity
entityMappings:
  - entityType: URL
    fieldMappings:
      - identifier: Url
        columnName: link
version: 1.0.0
