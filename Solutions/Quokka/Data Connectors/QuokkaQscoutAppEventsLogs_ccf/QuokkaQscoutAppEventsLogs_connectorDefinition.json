{
    "name": "QscoutAppEventsCCFDefinition",
    "apiVersion": "2022-09-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
        "connectorUiConfig": {
            "title": "QscoutAppEventsConnector",
            "id": "QscoutAppEventsCCFDefinition",
            "publisher": "Quokka",
            "descriptionMarkdown": "Ingest Qscout application events into Microsoft Sentinel",
            "graphQueriesTableName": "QscoutAppEvents_CL",
            "graphQueries": [
                {
                    "metricName": "Events received",
                    "legend": "Data connector events",
                    "baseQuery": "{{graphQueriesTableName}}"
                }
            ],
            "sampleQueries": [
                {
                    "description": "All event logs",
                    "query": "{{graphQueriesTableName}} | take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "QscoutAppEvents_CL",
                    "lastDataReceivedQuery": "QscoutAppEvents_CL | summarize Time = max(TimeGenerated) \n | where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors"
                }
            ],
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "write": true,
                            "delete": true,
                            "read": true
                        }
                    }
                ],
                "customs": [
                    {
                        "name": "Qscout organization id",
                        "description": "The API requires your organization ID in Qscout."
                    },
                    {
                        "name": "Qscout organization API key",
                        "description": "The API requires your organization API key in Qscout."
                    }
                ]
            },
            "instructionSteps": [
                {
                    "description": ">**NOTE:** This connector uses Codeless Connector Framework (CCF) to connect to the Qscout app events feed and ingest data into Microsoft Sentinel"
                },
                {
                    "description": "Provide the required values below:\n",
                    "instructions": [
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Qscout Organization ID",
                                "placeholder": "123456",
                                "type": "text",
                                "name": "organizationId"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Qscout Organization API Key",
                                "placeholder": "abcdxyz",
                                "type": "text",
                                "name": "apiKey"
                            }
                        },
                        {
                            "type": "ConnectionToggleButton",
                            "parameters": {
                                "connectLabel": "Connect",
                                "name": "connect"
                            }
                        }
                    ]
                }
            ]
        }
    }
}