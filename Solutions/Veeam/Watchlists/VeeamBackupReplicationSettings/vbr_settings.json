{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workspaceName": {
            "type": "string",
            "metadata": {
                "description": "Name of the Log Analytics Workspace"
            }
        }
    },
    "resources": [
        {
            "name": "[concat(parameters('workspaceName'), '/Microsoft.SecurityInsights/vbr_settings')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/Watchlists",
            "properties": {
                "displayName": "Veeam Backup & Replication Settings",
                "watchlistAlias": "vbr_settings",
                "source": "vbr_settings.csv",
                "description": "This watchlist lists Veeam Backup & Replication servers and the event types to collect. To add a server, specify Veeam Server Name and Base URL. Then run the Veeam-SetupConnections Playbook. The playbook sets the collection flags to true and creates keyVaultIds if they are empty. Otherwise, it uses the values you provide to configure Hybrid Connections and Key Vault secrets.",
                "provider": "Custom",
                "isDeleted": false,
                "defaultDuration": "P1000Y",
                "contentType": "Text/Csv",
                "numberOfLinesToSkip": 0,
                "itemsSearchKey": "Veeam Server Name",
                "rawContent": "Veeam Server Name,Base URL,Collect Malware Events,Collect Security and Compliance Analyzer Results,Collect Authorization Events,Collect Configuration Backups,Key Vault Username ID,Key Vault Password ID\r\nExampleServerName,https://ExampleServerName.domain.example:9419,true,true,true,true,ExampleServerNameUsername,ExampleServerNamePassword\r\n"
            },
            "apiVersion": "2022-08-01"
        }
    ]
}