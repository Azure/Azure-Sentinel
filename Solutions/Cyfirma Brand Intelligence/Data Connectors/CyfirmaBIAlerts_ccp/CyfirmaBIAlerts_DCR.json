{
    "name": "CyfirmaBIAlertsDCR",
    "type": "Microsoft.Insights/dataCollectionRules",
    "apiVersion": "2022-06-01",
    "location": "{{location}}",
    "properties": {
        "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
        "streamDeclarations": {
            "Custom-CyfirmaBIDomainITAssetAlerts_CL": {
                "columns": [
                    {
                        "name": "action",
                        "type": "string"
                    },
                    {
                        "name": "alert_created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "alert_object_uid",
                        "type": "string"
                    },
                    {
                        "name": "alert_uid",
                        "type": "datetime"
                    },
                    {
                        "name": "asset_comments",
                        "type": "string"
                    },
                    {
                        "name": "asset_type",
                        "type": "string"
                    },
                    {
                        "name": "asset_value",
                        "type": "string"
                    },
                    {
                        "name": "category",
                        "type": "string"
                    },
                    {
                        "name": "comments",
                        "type": "string"
                    },
                    {
                        "name": "created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "description",
                        "type": "string"
                    },
                    {
                        "name": "domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_sub_domain",
                        "type": "string"
                    },
                    {
                        "name": "first_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "host_provider",
                        "type": "string"
                    },
                    {
                        "name": "impact",
                        "type": "string"
                    },
                    {
                        "name": "ip_address",
                        "type": "string"
                    },
                    {
                        "name": "is_third_party",
                        "type": "boolean"
                    },
                    {
                        "name": "last_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "mail_server",
                        "type": "string"
                    },
                    {
                        "name": "notes",
                        "type": "dynamic"
                    },
                    {
                        "name": "recommendation",
                        "type": "string"
                    },
                    {
                        "name": "registered_date",
                        "type": "string"
                    },
                    {
                        "name": "risk_score",
                        "type": "int"
                    },
                    {
                        "name": "safe_flag_comments",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_by",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_date",
                        "type": "string"
                    },
                    {
                        "name": "severity",
                        "type": "string"
                    },
                    {
                        "name": "signature",
                        "type": "string"
                    },
                    {
                        "name": "source",
                        "type": "string"
                    },
                    {
                        "name": "source_type",
                        "type": "dynamic"
                    },
                    {
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "name": "sub_category",
                        "type": "string"
                    },
                    {
                        "name": "suspected_threat_actor",
                        "type": "dynamic"
                    },
                    {
                        "name": "title",
                        "type": "string"
                    },
                    {
                        "name": "uid",
                        "type": "string"
                    },
                    {
                        "name": "use_cases",
                        "type": "string"
                    }
                ]
            },
            "Custom-CyfirmaBIExecutivePeopleAlerts_CL": {
                "columns": [
                    {
                        "name": "action",
                        "type": "string"
                    },
                    {
                        "name": "alert_created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "alert_object_uid",
                        "type": "string"
                    },
                    {
                        "name": "alert_uid",
                        "type": "datetime"
                    },
                    {
                        "name": "asset_comments",
                        "type": "string"
                    },
                    {
                        "name": "asset_type",
                        "type": "string"
                    },
                    {
                        "name": "asset_value",
                        "type": "string"
                    },
                    {
                        "name": "category",
                        "type": "string"
                    },
                    {
                        "name": "comments",
                        "type": "string"
                    },
                    {
                        "name": "created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "description",
                        "type": "string"
                    },
                    {
                        "name": "domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_sub_domain",
                        "type": "string"
                    },
                    {
                        "name": "first_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "impact",
                        "type": "string"
                    },
                    {
                        "name": "is_third_party",
                        "type": "boolean"
                    },
                    {
                        "name": "last_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "notes",
                        "type": "dynamic"
                    },
                    {
                        "name": "posted_date",
                        "type": "string"
                    },
                    {
                        "name": "recommendation",
                        "type": "string"
                    },
                    {
                        "name": "risk_score",
                        "type": "int"
                    },
                    {
                        "name": "safe_flag_comments",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_by",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_date",
                        "type": "string"
                    },
                    {
                        "name": "severity",
                        "type": "string"
                    },
                    {
                        "name": "signature",
                        "type": "string"
                    },
                    {
                        "name": "source",
                        "type": "string"
                    },
                    {
                        "name": "source_type",
                        "type": "dynamic"
                    },
                    {
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "name": "sub_category",
                        "type": "string"
                    },
                    {
                        "name": "title",
                        "type": "string"
                    },
                    {
                        "name": "uid",
                        "type": "string"
                    },
                    {
                        "name": "use_cases",
                        "type": "string"
                    }
                ]
            },
            "Custom-CyfirmaBIProductSolutionAlerts_CL": {
                "columns": [
                    {
                        "name": "action",
                        "type": "string"
                    },
                    {
                        "name": "alert_created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "alert_object_uid",
                        "type": "string"
                    },
                    {
                        "name": "alert_uid",
                        "type": "datetime"
                    },
                    {
                        "name": "asset_comments",
                        "type": "string"
                    },
                    {
                        "name": "asset_type",
                        "type": "string"
                    },
                    {
                        "name": "asset_value",
                        "type": "string"
                    },
                    {
                        "name": "category",
                        "type": "string"
                    },
                    {
                        "name": "comments",
                        "type": "string"
                    },
                    {
                        "name": "created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "description",
                        "type": "string"
                    },
                    {
                        "name": "domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_sub_domain",
                        "type": "string"
                    },
                    {
                        "name": "first_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "impact",
                        "type": "string"
                    },
                    {
                        "name": "is_third_party",
                        "type": "boolean"
                    },
                    {
                        "name": "last_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "notes",
                        "type": "dynamic"
                    },
                    {
                        "name": "posted_date",
                        "type": "string"
                    },
                    {
                        "name": "recommendation",
                        "type": "string"
                    },
                    {
                        "name": "risk_score",
                        "type": "int"
                    },
                    {
                        "name": "safe_flag_comments",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_by",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_date",
                        "type": "string"
                    },
                    {
                        "name": "severity",
                        "type": "string"
                    },
                    {
                        "name": "signature",
                        "type": "string"
                    },
                    {
                        "name": "source",
                        "type": "string"
                    },
                    {
                        "name": "source_type",
                        "type": "dynamic"
                    },
                    {
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "name": "sub_category",
                        "type": "string"
                    },
                    {
                        "name": "title",
                        "type": "string"
                    },
                    {
                        "name": "uid",
                        "type": "string"
                    },
                    {
                        "name": "use_cases",
                        "type": "string"
                    }
                ]
            },
            "Custom-CyfirmaBISocialHandlersAlerts_CL": {
                "columns": [
                    {
                        "name": "action",
                        "type": "string"
                    },
                    {
                        "name": "alert_created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "alert_object_uid",
                        "type": "string"
                    },
                    {
                        "name": "alert_uid",
                        "type": "datetime"
                    },
                    {
                        "name": "asset_comments",
                        "type": "string"
                    },
                    {
                        "name": "asset_type",
                        "type": "string"
                    },
                    {
                        "name": "asset_value",
                        "type": "string"
                    },
                    {
                        "name": "category",
                        "type": "string"
                    },
                    {
                        "name": "comments",
                        "type": "string"
                    },
                    {
                        "name": "created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "description",
                        "type": "string"
                    },
                    {
                        "name": "domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_sub_domain",
                        "type": "string"
                    },
                    {
                        "name": "first_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "impact",
                        "type": "string"
                    },
                    {
                        "name": "is_third_party",
                        "type": "boolean"
                    },
                    {
                        "name": "last_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "notes",
                        "type": "dynamic"
                    },
                    {
                        "name": "posted_date",
                        "type": "string"
                    },
                    {
                        "name": "recommendation",
                        "type": "string"
                    },
                    {
                        "name": "risk_score",
                        "type": "int"
                    },
                    {
                        "name": "safe_flag_comments",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_by",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_date",
                        "type": "string"
                    },
                    {
                        "name": "severity",
                        "type": "string"
                    },
                    {
                        "name": "signature",
                        "type": "string"
                    },
                    {
                        "name": "source",
                        "type": "string"
                    },
                    {
                        "name": "source_type",
                        "type": "dynamic"
                    },
                    {
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "name": "sub_category",
                        "type": "string"
                    },
                    {
                        "name": "title",
                        "type": "string"
                    },
                    {
                        "name": "uid",
                        "type": "string"
                    },
                    {
                        "name": "use_cases",
                        "type": "string"
                    }
                ]
            },
            "Custom-CyfirmaBIMaliciousMobileAppsAlerts_CL": {
                "columns": [
                    {
                        "name": "alert_created_date",
                        "type": "datetime"
                    },
                    {
                        "name": "alert_object_uid",
                        "type": "string"
                    },
                    {
                        "name": "alert_uid",
                        "type": "datetime"
                    },
                    {
                        "name": "asset_comments",
                        "type": "string"
                    },
                    {
                        "name": "asset_name",
                        "type": "string"
                    },
                    {
                        "name": "asset_type",
                        "type": "string"
                    },
                    {
                        "name": "asset_value",
                        "type": "string"
                    },
                    {
                        "name": "category",
                        "type": "string"
                    },
                    {
                        "name": "description",
                        "type": "string"
                    },
                    {
                        "name": "domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_domain",
                        "type": "string"
                    },
                    {
                        "name": "dr_sub_domain",
                        "type": "string"
                    },
                    {
                        "name": "first_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "impact",
                        "type": "string"
                    },
                    {
                        "name": "is_third_party",
                        "type": "boolean"
                    },
                    {
                        "name": "last_seen",
                        "type": "datetime"
                    },
                    {
                        "name": "notes",
                        "type": "dynamic"
                    },
                    {
                        "name": "posted_date",
                        "type": "string"
                    },
                    {
                        "name": "recommendation",
                        "type": "string"
                    },
                    {
                        "name": "risk_score",
                        "type": "int"
                    },
                    {
                        "name": "safe_flag_comments",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_by",
                        "type": "string"
                    },
                    {
                        "name": "safe_flag_marked_date",
                        "type": "string"
                    },
                    {
                        "name": "severity",
                        "type": "string"
                    },
                    {
                        "name": "signature",
                        "type": "string"
                    },
                    {
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "name": "sub_category",
                        "type": "string"
                    },
                    {
                        "name": "title",
                        "type": "string"
                    },
                    {
                        "name": "uid",
                        "type": "string"
                    },
                    {
                        "name": "use_cases",
                        "type": "string"
                    }
                ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "clv2ws1"
                }
            ]
        },
        "dataFlows": [ 
            {
                "streams": [
                    "Custom-CyfirmaBIDomainITAssetAlerts_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated=alert_created_date\n| extend alert_title=['title']\n| extend category = 'Brand Intelligence'\n| project-away alert_created_date, ['title'], notes\n",
                "outputStream": "Custom-CyfirmaBIDomainITAssetAlerts_CL"
            },
            {
                "streams": [
                    "Custom-CyfirmaBIExecutivePeopleAlerts_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated=alert_created_date\n| extend alert_title=['title']\n| project-away alert_created_date, ['title'], notes\n",
                "outputStream": "Custom-CyfirmaBIExecutivePeopleAlerts_CL"
            },
            {
                "streams": [
                    "Custom-CyfirmaBIProductSolutionAlerts_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated=alert_created_date\n| extend alert_title=['title']\n| project-away alert_created_date, ['title'], notes\n",
                "outputStream": "Custom-CyfirmaBIProductSolutionAlerts_CL"
            },
            {
                "streams": [
                    "Custom-CyfirmaBISocialHandlersAlerts_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated=alert_created_date\n| extend alert_title=['title']\n| project-away alert_created_date, ['title'], notes\n",
                "outputStream": "Custom-CyfirmaBISocialHandlersAlerts_CL"
            },
            {
                "streams": [
                    "Custom-CyfirmaBIMaliciousMobileAppsAlerts_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "source\n| extend TimeGenerated=alert_created_date\n| extend alert_title=['title']\n| project-away alert_created_date, ['title'], notes\n",
                "outputStream": "Custom-CyfirmaBIMaliciousMobileAppsAlerts_CL"
            }
        ]
    }
}
