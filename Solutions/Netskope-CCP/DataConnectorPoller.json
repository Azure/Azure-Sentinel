[
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsRemediation",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/remediation?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsUBA",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/uba?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsSecurityAssessment",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/securityassessment?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsQuarantine",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/quarantine?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsPolicy",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/policy?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsMalware",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/malware?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsMalsite",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/malsite?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsDLP",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/dlp?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
    {
        "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
        "apiVersion": "2023-02-01-preview",
        "name": "NetskopeAlertsCTEP",
        "kind": "RestApiPoller",
        "properties": {
            "connectorDefinitionName": "NetskopeAlertsEvents",
            "dataType": "NetskopeAlerts_CL",
            "dcrConfig": {
                "streamName": "Custom-NetskopeAlerts",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "type": "APIKey",
                "ApiKeyName": "Netskope-Api-Token",
                "ApiKey": "{{ApiKey}}"
            },
            "request": {
                "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/ctep?operation=next&index=', parameters('Index'))]",
                "httpMethod": "GET",
                "queryWindowInMin": 5,
                "queryTimeFormat": "UnixTimestamp",
                "rateLimitQps": 10,
                "retryCount": 3,
                "timeoutInSeconds": 60,
                "headers": {
                    "Accept": "application/json"
                }
            },
            "response": {
                "eventsJsonPaths": [
                    "$.result"
                ]
            }
        }
    },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeAlertsWatchlist",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeAlerts",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/watchlist?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeAlertsCompromisedCredentials",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeAlerts",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/compromisedcredentials?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeAlertsWatchlist",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeAlerts",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/watchlist?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeAlertsContent",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeAlerts",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/content?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeAlertsDevice",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeAlerts",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/device?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsApplication",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsApplication_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsApplication",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/application?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsAudit",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsAudit_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsAudit",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/audit?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsConnection",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsConnection_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsConnection",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/connection?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsDLP",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsDLP_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsDLP",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/incident?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsEndpoint",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsEndpoint_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsEndpoint",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/endpoint?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsInfrastructure",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsInfrastructure_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsInfrastructure",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/infrastructure?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsNetwork",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsNetwork_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsNetwork",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/network?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "apiVersion": "2023-02-01-preview",
            "name": "NetskopeEventsPage",
            "kind": "RestApiPoller",
            "properties": {
                "connectorDefinitionName": "NetskopeAlertsEvents",
                "dataType": "NetskopeEventsPage_CL",
                "dcrConfig": {
                    "streamName": "Custom-NetskopeEventsPage",
                    "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                    "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
                },
                "auth": {
                    "type": "APIKey",
                    "ApiKeyName": "Netskope-Api-Token",
                    "ApiKey": "{{ApiKey}}"
                },
                "request": {
                    "apiEndpoint": "[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/page?operation=next&index=', parameters('Index'))]",
                    "httpMethod": "GET",
                    "queryWindowInMin": 5,
                    "queryTimeFormat": "UnixTimestamp",
                    "rateLimitQps": 10,
                    "retryCount": 3,
                    "timeoutInSeconds": 60,
                    "headers": {
                        "Accept": "application/json"
                    }
                },
                "response": {
                    "eventsJsonPaths": [
                        "$.result"
                    ]
                }
            }
        }
    ]
