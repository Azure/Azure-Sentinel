{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Cisco",
    "comments": "Solution template for Cisco Firepower EStreamer"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    }
  },
  "variables": {
    "solutionId": "cisco.cisco-firepower-estreamer",
    "_solutionId": "[variables('solutionId')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "uiConfigId1": "CiscoFirepowerEStreamer",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "CiscoFirepowerEStreamer",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1')))]",
    "dataConnectorVersion1": "1.0.0",
    "CiscoFirepowerConnector": "CiscoFirepowerConnector",
    "_CiscoFirepowerConnector": "[variables('CiscoFirepowerConnector')]",
    "TemplateEmptyArray": "[json('[]')]",
    "playbookVersion1": "1.0",
    "playbookContentId1": "CiscoFirepowerConnector",
    "_playbookContentId1": "[variables('playbookContentId1')]",
    "playbookTemplateSpecName1": "[concat(parameters('workspace'),'-lc-',uniquestring(variables('_playbookContentId1')))]",
    "CiscoFirepower-BlockFQDN-NetworkGroup": "CiscoFirepower-BlockFQDN-NetworkGroup",
    "_CiscoFirepower-BlockFQDN-NetworkGroup": "[variables('CiscoFirepower-BlockFQDN-NetworkGroup')]",
    "playbookVersion2": "1.0",
    "playbookContentId2": "CiscoFirepower-BlockFQDN-NetworkGroup",
    "_playbookContentId2": "[variables('playbookContentId2')]",
    "playbookId2": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId2'))]",
    "playbookTemplateSpecName2": "[concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId2')))]",
    "CiscoFirepower-BlockIP-NetworkGroup": "CiscoFirepower-BlockIP-NetworkGroup",
    "_CiscoFirepower-BlockIP-NetworkGroup": "[variables('CiscoFirepower-BlockIP-NetworkGroup')]",
    "playbookVersion3": "1.0",
    "playbookContentId3": "CiscoFirepower-BlockIP-NetworkGroup",
    "_playbookContentId3": "[variables('playbookContentId3')]",
    "playbookId3": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId3'))]",
    "playbookTemplateSpecName3": "[concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId3')))]",
    "CiscoFirepower-BlockIP-Teams": "CiscoFirepower-BlockIP-Teams",
    "_CiscoFirepower-BlockIP-Teams": "[variables('CiscoFirepower-BlockIP-Teams')]",
    "playbookVersion4": "1.0",
    "playbookContentId4": "CiscoFirepower-BlockIP-Teams",
    "_playbookContentId4": "[variables('playbookContentId4')]",
    "playbookId4": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId4'))]",
    "playbookTemplateSpecName4": "[concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId4')))]"
  },
  "resources": [
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "DataConnector"
      },
      "properties": {
        "description": "Cisco Firepower EStreamer data connector with template",
        "displayName": "Cisco Firepower EStreamer template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('dataConnectorTemplateSpecName1'),'/',variables('dataConnectorVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "DataConnector"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('dataConnectorTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "Cisco Firepower EStreamer data connector with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Cisco Firepower eStreamer",
                  "publisher": "Cisco",
                  "descriptionMarkdown": "eStreamer is a Client Server API designed for the Cisco Firepower NGFW Solution. The eStreamer client requests detailed event data on behalf of the SIEM or logging solution in the Common Event Format (CEF).",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "CiscoFirepowerEstreamerCEF",
                      "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\""
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Firewall Blocked Events",
                      "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DeviceAction != \"Allow\""
                    },
                    {
                      "description": "File Malware Events",
                      "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where Activity == \"File Malware Event\""
                    },
                    {
                      "description": "Outbound Web Traffic Port 80",
                      "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DestinationPort == \"80\""
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CommonSecurityLog (CiscoFirepowerEstreamerCEF)",
                      "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "read": true,
                          "write": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
                      "innerSteps": [
                        {
                          "title": "1.1 Select or create a Linux machine",
                          "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
                        },
                        {
                          "title": "1.2 Install the CEF collector on the Linux machine",
                          "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 25226 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                          "instructions": [
                            {
                              "parameters": {
                                "fillWith": [
                                  "WorkspaceId",
                                  "PrimaryKey"
                                ],
                                "label": "Run the following command to install and apply the CEF collector:",
                                "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                              },
                              "type": "CopyableLabel"
                            }
                          ]
                        }
                      ],
                      "title": "1. Linux Syslog agent configuration"
                    },
                    {
                      "description": "Install and configure the Firepower eNcore eStreamer client, for more details see full install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html)",
                      "innerSteps": [
                        {
                          "title": "2.1 Download the Firepower Connector from github",
                          "description": "Download the latest version of the Firepower eNcore connector for Microsoft Sentinel [here](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector).  If you plan on using python3 use the [python3 eStreamer connector](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector/tree/python3)"
                        },
                        {
                          "title": "2.2 Create a pkcs12 file using the Azure/VM Ip Address",
                          "description": "Create a pkcs12 certificate using the public IP of the VM instance in Firepower under System->Integration->eStreamer, for more information please see install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049443)"
                        },
                        {
                          "title": "2.3  Test Connectivity between the Azure/VM Client and the FMC",
                          "description": "Copy the pkcs12 file from the FMC to the Azure/VM instance and run the test utility (./encore.sh test) to ensure a connection can be established, for more details please see the setup [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049430)"
                        },
                        {
                          "title": "2.4 Configure encore to stream data to the agent",
                          "description": "Configure encore to stream data via TCP to the Microsoft Agent, this should be enabled by default, however, additional ports and streaming protocols can configured depending on your network security posture, it is also possible to save the data to the file system, for more information please see [Configure Encore](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049433)"
                        }
                      ],
                      "title": "2. Install the Firepower eNcore client"
                    },
                    {
                      "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Run the following command to validate your connectivity:",
                            "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                          },
                          "type": "CopyableLabel"
                        }
                      ],
                      "title": "3. Validate connection"
                    },
                    {
                      "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
                      "title": "4. Secure your machine "
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cisco Firepower EStreamer",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cisco"
                },
                "support": {
                  "name": "Cisco",
                  "tier": "Partner",
                  "link": "https://www.cisco.com/c/en_in/support/index.html"
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Cisco Firepower EStreamer",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cisco"
        },
        "support": {
          "name": "Cisco",
          "tier": "Partner",
          "link": "https://www.cisco.com/c/en_in/support/index.html"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Cisco Firepower eStreamer",
          "publisher": "Cisco",
          "descriptionMarkdown": "eStreamer is a Client Server API designed for the Cisco Firepower NGFW Solution. The eStreamer client requests detailed event data on behalf of the SIEM or logging solution in the Common Event Format (CEF).",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "CiscoFirepowerEstreamerCEF",
              "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\""
            }
          ],
          "dataTypes": [
            {
              "name": "CommonSecurityLog (CiscoFirepowerEstreamerCEF)",
              "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Firewall Blocked Events",
              "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DeviceAction != \"Allow\""
            },
            {
              "description": "File Malware Events",
              "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where Activity == \"File Malware Event\""
            },
            {
              "description": "Outbound Web Traffic Port 80",
              "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DestinationPort == \"80\""
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "read": true,
                  "write": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
              "innerSteps": [
                {
                  "title": "1.1 Select or create a Linux machine",
                  "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
                },
                {
                  "title": "1.2 Install the CEF collector on the Linux machine",
                  "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 25226 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                  "instructions": [
                    {
                      "parameters": {
                        "fillWith": [
                          "WorkspaceId",
                          "PrimaryKey"
                        ],
                        "label": "Run the following command to install and apply the CEF collector:",
                        "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ],
              "title": "1. Linux Syslog agent configuration"
            },
            {
              "description": "Install and configure the Firepower eNcore eStreamer client, for more details see full install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html)",
              "innerSteps": [
                {
                  "title": "2.1 Download the Firepower Connector from github",
                  "description": "Download the latest version of the Firepower eNcore connector for Microsoft Sentinel [here](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector).  If you plan on using python3 use the [python3 eStreamer connector](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector/tree/python3)"
                },
                {
                  "title": "2.2 Create a pkcs12 file using the Azure/VM Ip Address",
                  "description": "Create a pkcs12 certificate using the public IP of the VM instance in Firepower under System->Integration->eStreamer, for more information please see install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049443)"
                },
                {
                  "title": "2.3  Test Connectivity between the Azure/VM Client and the FMC",
                  "description": "Copy the pkcs12 file from the FMC to the Azure/VM instance and run the test utility (./encore.sh test) to ensure a connection can be established, for more details please see the setup [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049430)"
                },
                {
                  "title": "2.4 Configure encore to stream data to the agent",
                  "description": "Configure encore to stream data via TCP to the Microsoft Agent, this should be enabled by default, however, additional ports and streaming protocols can configured depending on your network security posture, it is also possible to save the data to the file system, for more information please see [Configure Encore](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049433)"
                }
              ],
              "title": "2. Install the Firepower eNcore client"
            },
            {
              "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Run the following command to validate your connectivity:",
                    "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                  },
                  "type": "CopyableLabel"
                }
              ],
              "title": "3. Validate connection"
            },
            {
              "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
              "title": "4. Secure your machine "
            }
          ],
          "id": "[variables('_uiConfigId1')]"
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('playbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "LogicAppsCustomConnector"
      },
      "properties": {
        "description": "CiscoFirepowerConnector",
        "displayName": "CiscoFirepowerConnector"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('playbookTemplateSpecName1'),'/',variables('playbookVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "LogicAppsCustomConnector"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('playbookTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "CiscoFirepowerConnector Playbook with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion1')]",
          "parameters": {
            "CustomConnectorName": {
              "defaultValue": "CiscoFirepowerConnector",
              "type": "string",
              "metadata": {
                "description": "Name of the Cisco Firepower Connector"
              }
            },
            "ServiceEndpoint": {
              "type": "string",
              "metadata": {
                "description": "URL of the Cisco Firepower REST API"
              }
            }
          },
          "variables": {
            "description": "",
            "_description": "[[variables('description')]",
            "operationId-CiscoFmcAuthGenerateTokenV1": "CiscoFmcAuthGenerateTokenV1",
            "_operationId-CiscoFmcAuthGenerateTokenV1": "[[variables('operationId-CiscoFmcAuthGenerateTokenV1')]",
            "operationId-CiscoFmcAuthRefreshTokenV1": "CiscoFmcAuthRefreshTokenV1",
            "_operationId-CiscoFmcAuthRefreshTokenV1": "[[variables('operationId-CiscoFmcAuthRefreshTokenV1')]",
            "operationId-CiscoFmcAuthRevokeAccessV1": "CiscoFmcAuthRevokeAccessV1",
            "_operationId-CiscoFmcAuthRevokeAccessV1": "[[variables('operationId-CiscoFmcAuthRevokeAccessV1')]",
            "operationId-CiscoFmcDeleteObjectFQDNV1": "CiscoFmcDeleteObjectFQDNV1",
            "_operationId-CiscoFmcDeleteObjectFQDNV1": "[[variables('operationId-CiscoFmcDeleteObjectFQDNV1')]",
            "operationId-CiscoFmcGetObjectFQDNV1": "CiscoFmcGetObjectFQDNV1",
            "_operationId-CiscoFmcGetObjectFQDNV1": "[[variables('operationId-CiscoFmcGetObjectFQDNV1')]",
            "operationId-CiscoFmcPutObjectFQDNV1": "CiscoFmcPutObjectFQDNV1",
            "_operationId-CiscoFmcPutObjectFQDNV1": "[[variables('operationId-CiscoFmcPutObjectFQDNV1')]",
            "operationId-CiscoFmcGetObjectFQDNsV1": "CiscoFmcGetObjectFQDNsV1",
            "_operationId-CiscoFmcGetObjectFQDNsV1": "[[variables('operationId-CiscoFmcGetObjectFQDNsV1')]",
            "operationId-CiscoFmcPostObjectFQDNV1": "CiscoFmcPostObjectFQDNV1",
            "_operationId-CiscoFmcPostObjectFQDNV1": "[[variables('operationId-CiscoFmcPostObjectFQDNV1')]",
            "operationId-CiscoFmcDeleteObjectNetworkGroupV1": "CiscoFmcDeleteObjectNetworkGroupV1",
            "_operationId-CiscoFmcDeleteObjectNetworkGroupV1": "[[variables('operationId-CiscoFmcDeleteObjectNetworkGroupV1')]",
            "operationId-CiscoFmcGetObjectNetworkGroupV1": "CiscoFmcGetObjectNetworkGroupV1",
            "_operationId-CiscoFmcGetObjectNetworkGroupV1": "[[variables('operationId-CiscoFmcGetObjectNetworkGroupV1')]",
            "operationId-CiscoFmcPutObjectNetworkGroupV1": "CiscoFmcPutObjectNetworkGroupV1",
            "_operationId-CiscoFmcPutObjectNetworkGroupV1": "[[variables('operationId-CiscoFmcPutObjectNetworkGroupV1')]",
            "operationId-CiscoFmcGetObjectNetworkGroupsV1": "CiscoFmcGetObjectNetworkGroupsV1",
            "_operationId-CiscoFmcGetObjectNetworkGroupsV1": "[[variables('operationId-CiscoFmcGetObjectNetworkGroupsV1')]",
            "operationId-CiscoFmcPostObjectNetworkGroupV1": "CiscoFmcPostObjectNetworkGroupV1",
            "_operationId-CiscoFmcPostObjectNetworkGroupV1": "[[variables('operationId-CiscoFmcPostObjectNetworkGroupV1')]",
            "operationId-CiscoFmcDeleteObjectNetworkV1": "CiscoFmcDeleteObjectNetworkV1",
            "_operationId-CiscoFmcDeleteObjectNetworkV1": "[[variables('operationId-CiscoFmcDeleteObjectNetworkV1')]",
            "operationId-CiscoFmcGetObjectNetworkV1": "CiscoFmcGetObjectNetworkV1",
            "_operationId-CiscoFmcGetObjectNetworkV1": "[[variables('operationId-CiscoFmcGetObjectNetworkV1')]",
            "operationId-CiscoFmcPutObjectNetworkV1": "CiscoFmcPutObjectNetworkV1",
            "_operationId-CiscoFmcPutObjectNetworkV1": "[[variables('operationId-CiscoFmcPutObjectNetworkV1')]",
            "operationId-CiscoFmcGetObjectNetworksV1": "CiscoFmcGetObjectNetworksV1",
            "_operationId-CiscoFmcGetObjectNetworksV1": "[[variables('operationId-CiscoFmcGetObjectNetworksV1')]",
            "operationId-CiscoFmcPostObjectNetworkV1": "CiscoFmcPostObjectNetworkV1",
            "_operationId-CiscoFmcPostObjectNetworkV1": "[[variables('operationId-CiscoFmcPostObjectNetworkV1')]",
            "operationId-CiscoFmcDeleteObjectRangeV1": "CiscoFmcDeleteObjectRangeV1",
            "_operationId-CiscoFmcDeleteObjectRangeV1": "[[variables('operationId-CiscoFmcDeleteObjectRangeV1')]",
            "operationId-CiscoFmcGetObjectRangeV1": "CiscoFmcGetObjectRangeV1",
            "_operationId-CiscoFmcGetObjectRangeV1": "[[variables('operationId-CiscoFmcGetObjectRangeV1')]",
            "operationId-CiscoFmcPutObjectRangeV1": "CiscoFmcPutObjectRangeV1",
            "_operationId-CiscoFmcPutObjectRangeV1": "[[variables('operationId-CiscoFmcPutObjectRangeV1')]",
            "operationId-CiscoFmcGetObjectRangesV1": "CiscoFmcGetObjectRangesV1",
            "_operationId-CiscoFmcGetObjectRangesV1": "[[variables('operationId-CiscoFmcGetObjectRangesV1')]",
            "operationId-CiscoFmcPostObjectRangeV1": "CiscoFmcPostObjectRangeV1",
            "_operationId-CiscoFmcPostObjectRangeV1": "[[variables('operationId-CiscoFmcPostObjectRangeV1')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "playbookContentId1": "CiscoFirepowerConnector",
            "playbookId1": "[[resourceId('Microsoft.Web/customApis', parameters('CustomConnectorName'))]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/customApis",
              "apiVersion": "2016-06-01",
              "name": "[[parameters('CustomConnectorName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "connectionParameters": {
                  "username": {
                    "type": "securestring",
                    "uiDefinition": {
                      "displayName": "username",
                      "description": "The username for this API",
                      "tooltip": "Provide the username",
                      "constraints": {
                        "tabIndex": 2,
                        "clearText": true,
                        "required": "true"
                      }
                    }
                  },
                  "password": {
                    "type": "securestring",
                    "uiDefinition": {
                      "displayName": "password",
                      "description": "The password for this API",
                      "tooltip": "Provide the password",
                      "constraints": {
                        "tabIndex": 3,
                        "clearText": false,
                        "required": "true"
                      }
                    }
                  }
                },
                "backendService": {
                  "serviceUrl": "[[parameters('ServiceEndpoint')]"
                },
                "brandColor": "#ffffff",
                "displayName": "[[parameters('CustomConnectorName')]",
                "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAADnCAIAAABqltZ3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA6JSURBVHhe7Z07jB1JFYaXh4h4CUG8GxNgC4mIACeIgMAOkAjXCSK0kZBAbLDONsNGAhHaIoDQm5F4Za+wZMPitQ0akBdjy15kVn7MeGbn6bFn+EUd95bPvV2vrup7j+//6ciaubf6dHfVV9XVD/e8sk+INWgtsQetJfagtcQetJbYg9YSe9BaYg9aS+xBa4k9aC2xB60l9qC1xB60ltiD1hJ70FpiD1pL7EFriT1oLbEHrSX2oLXEHrSW2IPWEnvQWmIPWkvsQWuJPWgtsQetJfagtcQetJbYg9YSe9BaYg9aS+xBa4k9aC2xB60l9qC1xB60ltiD1hJ70FpiD1pL7EFriT1oLbEHrSX2oLXEHrSW2IPWEnvQWmIPWkvsQWuJPWgtsQetJfagtcQetJbYg9YSe9BaYg9aS+xBa4k9aC2xB60l9qC1xB5Wrd3Z2//Nh1vf+svKVy48/OL5h9/888ov72ziQzKVZ/v7v/9o+9vvrXz13YefP//gG5eX37i5sfbUan1ZtfbYjfVXzj1Q8cO/r8nX5EXeur2p6grx3fcfy9fWMGntzc1nn55oAxfvr+1KIfKcj5/uYXxVFeXijw+fSCFTmLT2Dx9tq9rv4rf/2ZJC5DmXHu+qWuriZ/9al0KmMGkt6lrVfhc//ufHUog8Bz1Z1VIX37M5STBp7c/7rf3RP2it5ld3p0xqXXz/6qoUMgWtffmhtXMBrc2C1s4FtDYLWjsX0NosaO1cQGuzoLVzAa3NgtbOBbQ2C1o7F9DaLGjtXEBrs6C1cwGtzYLWzgW0NgtaO5Tzy09O3No4dOXxkeur+OH21jP5Iofq1q7s7p26u3l0aQ0bdvzG+pl72/LFrLm6tuuqC1FcXS2sPX1v21UX/kXVyadjMaq1b/57Q9Xaly88PHt/R75Opq61UPa1i49UnoOXl+Xr2XHyzhTboIt8nUxda1FdqByVBxWIz6VEe8azFqOs2lUXEFdKJFPX2teX1lQSF+hjUmIWYFhV2+MC1ZU74ta1dur/IkHgcynRnvGsnRxou4DQUiiNutaqDF1856+zfPYUY6rani5yj051rT0wMdC6wHArJdoznrWHr62q/ewCh0IplEZFa/uGNBdSaBYEOnnuQaCutSqDH1KiPeNZi6FL7WQXuc1Q0dq+eYsLKTQLaG0AWktr81AZ/JAS7aG1tDYPlcEPKdEeWktr81AZ/JAS7aG1tDYPlcEPKdEeWktr81AZ/JAS7aG1tDYPlcEPKdGeDGvRwEPu2i2atQOra6GsRUVdWMmorri1yHXk+ic3CA5eXr5a9C6tBbG2VnUtiLW3t54duvKJGPg55X51xFq0weSTJQW3wsGCWDv1hmeBuItgLeyCSypJil0Ra/ueLDl8LXtvF8HaqU9pIQqeIFsEa4vtilj76sRA24WUSGYRrA3sY/qkzbEI1hbbFbFW5fIj96i3CNaqxf3AiqRQGotgrVrcDynRQ7m1uc1Aa6VQGrQ2AK2ltXmoDH5IiWTU4n5IiR5oLa3NQ2XwQ0okoxb3Q0r0QGtpbR4qgx9SIhm1uB9SogdaS2vzUBn8kBLJqMX9kBI90Fpam4fK4IeUSEYt7oeU6IHW0to8VAY/pEQyanE/pEQPtJbW5qEy+CElklGL+yEleqC1tDYPlcEPKZGMWtwPKdFDxNovndcPN3SR+wBN4H+W575PpaK12AuVoQvsuxRKJnCLktZOErBLSvQQsbbv+QY0j5RIpu/JEkTuzeGK1oI+1XBwkBLJ9KlW0AHO3t9RSbrI7QB1re07Zh7If0Koz65oqoi1fQfQgpdzYVSb2rcK9rautX2qle2jSuIid3QEK7t7U6sLfSz3QZy61vaNPgX7WGxXxFqA1Go0Ktg+B2YCqiWQueDZ07rWgsnxo/itVdgd9YhtcXWh5qtUV11rweSrvgqeXHWofcTPKdPFuLUAnRs9DLWPf3OnswqkwmYhFaJgMHNUtxbABrdVdfdxeCrUkkuFH3JHWUd1awGqyymBKOhIPgV2JVk7b7Sw9iWmhbWzhda+/NDauYDWZkFr5wJamwWtnQtobRa0di7A2bSq/S5yb7MtApce76pa6uKt22P/IZAqmLR27ene196dcgX+C+cf3n9S/rqXl5Wdvf2vX5rylobPnHuwtP5UCpnCpLXgd//d/uw7L7TBp849+PWHW/I1eZF3lp987sXqQrxxs/D2x8yxai24sfH0px+sH762ivjJB+vvrQ661v3Sc3vr2S9ubvzgb6uYyx67sf6nlbyHGeYKw9aShYXWEnvQWmIPWkvsQWuJPWgtsQetJfagtcQetJbYg9YSe9BaYg9aS+xBa4k9aC2xB60lEQa+0qEFM7Z2ZXfvzL3tE7c2jlxfPXTlcfeX/vAzAh/iqws5T4IiIcr3hRQqAo2HTT26tOb/BU3Eaxcf4RN8jk19+/5O9Ta+uraLzAhXJ26lqCj3K9Z76u7mwPdoKLAXx2+sI7n/Zz3dGvE5Vjdzj2djrZPV/3uz0UCVycJB+l4d5UIKZXL2/s7kn2UNBArLkgOAGfDj4LS/bzo1YFXxW54cWCP6RuKeorfM0N0ZWIvG6MbUrJDlg9S1Fg2D3qKSpIQsXwS6NIY0lTAlCl4C6cAaYaHKlhIYd1DhkmVERrUWe5g+eEyGZAlS0drT97bV4ukhKfLBIaisSyPKrMWRpHiNLmA8vJd0ozCetUMkcCGJgtSyduDWSpZMyga8LnKtLR7UJwPzirpz6zAjWTtcWYTkClLFWjTnwOFHEuUwUFlElrWY/GRN1qOBGhtN3DGsraIsQtIFqWLtm/1vl08MSZTMcGUR6daiWw6ZqvXFaOI2tzasUVZIxiDDrUWLqqUCceDy8tQ3ekuuNCZfYlwW6dZmXb3JCog7why3rbXYgYqHIUkaZLi1gdcxuYAcky9AxgEXqz55Z/P1pbWsd/ZX7NWJ1tbqJH2ReI1yCG2tTa8gtDQKowldQAscpvGJ/7Z4SRokLIEUChKeHkBKKVeJ9F59+NoqekVXRZh3YVOxPd1gn2JtuH78ePXiI6wRq0BbILAi9YcOAoFtk/W1oaG1GH7UzkwN1HV4MoRvoS/aRn4PMtxaNJVayo+6h7/EGT92P7xeWIXNTrG278/O+IGqRveQBV4EbRGuHxfoirJAGxpam3JO01c7xQy3Fm2vlvKj7g2h6EALgbBHUjpGtEeljCPQOponpbM1HW4bWhu9eFRdWTDc2vCsBucxUm4wGLdUchVQtu4peXQcSZ+RY3TvZiZTA0OyFG1AK2uj86fqE0THcGvRl9RSKg5eXj5TYyAJdw8EzJCilQiPI5i2Zs1/oiNu3eOSTytro9260S4NtzY6BLqAAUeX1oaMheErplkXIlKI7lf6VKQjfH7W4ljqaGVteHbY7vAx3FqQfrKMwNz0xK2Svyum8qioPi8M10ziya4inLNdK7eyNjyQVD/2dVSxNvHUXkXW0Bsd+eperADhmU/xhE3l8SPlmkYZraxVO6Ci3YynirUg5QrR1Dh1N+mwGN7O6tMDEJ6zFY8j/gV1Fe2uf83GWinUgFrWYqgLtEc4MOhKln7C29lilArP2bA9Ui6T8OVbKVQbWhuieMTFwCYpeqC1Q5iNtdUnbR11rQVImHVy1kV4FhTeTpwVSLl6hGcIxef74RMYKVSbVtaGW3rOz8YmQdrwoDIZ4fOb8HYiqnfssLXHiv7PGXqmyuNHi9m5o5W14eNRo1sMoJG1Dph0+t52ur5h81RhFSNf+So7cwpfl7B35cvuXYYUoCN2MHxLExE+pITP9qqfgIfHRUR0Lj5JeHpg7y5D9AhY8Ya+zzjWOq6u7YbFDXsQvaNbfbgNHwBzH+iO/v+LITcOw7SyFkSHopQrRLmMaS0I348IWxvt2NCobsNH755g7Ew8BkZT4cRGijagobXRSQIi8Zp8OiNbGz7sRo+50UvCEBd7JKVjREdKFFD5JyOlq6DV1FKTUf1A4dPQ2uhEygUmcOFHqNBsGJVRm/J7EENjLYiOWC4OXQk9OA8X3Yt8Uq7yRqclCFT18RvrU9eI6kV7qfKTgcNs1mQjl4bWgpTh1gXqAmqe+P9bvRDoze7NVn4dSdIgw61FhsQ3gqEkGlitwo+UC3zpd+BQG+41W66KUD/4FR9225BiLWRKv/yMzK5R1Iqi0e48zNHW2qw6ioYkDTLc2q6noZ1cm719f8eJ0gU+DJ8+u5CMQTCkqaWKI8VaEK6i4ZG4GUNoay2oWEeSMUhFawdG+jXplKN2SqTrknvHJD0wN2h0TdOnubUgcfYWDUkXZH6szWq84gce/Mga5KqsUQWUrXvRo48xrAVVxJVcQebE2oIbpHBOJcmN3ENzXXGhbLsb9YqRrAUQN3oFNxySKMg8WFt8v3qgRgUTylrijjbKOsazFmDHhpycSZYgM7cWi0uiIob07QJrAQbIgaMJZslNr3NNMqq1DjRMmbuyfJAZWoudwtolywBgQNn5WZm1oHiN2OXRZgU+M7AWoJrgbvqZLAaDxAeIZmIttq164+Fk7uSdzfSruRBo4DCftUbscpUuWsZsrO2Avth5VDdqAUMFAjWCBnA/40PUY9aEySXsCykUwyVBv8KGYebnNgbhjqRoV7dt+DY9ZzGQyW2J2wZnldsGBMZIfFv3YhMqvNtxf3Wj7XKUGVtLSAG0ltiD1hJ70FpiD1pL7EFriT1oLbEHrSX2oLXEHrSW2IPWEnvQWmIPWkvsQWuJPWgtsQetJfagtcQetJbYg9YSe9BaYg9aS+xBa4k9aC2xB60l9qC1xB60ltiD1hJ70FpiD1pL7EFriT1oLbEHrSX2oLXEHrSW2IPWEnvQWmIPWkvsQWuJPWgtsQetJfagtcQetJbYg9YSe9BaYg9aS+xBa4k9aC2xB60l9qC1xB60ltiD1hJ70FpiD1pL7EFriT1oLbEHrSX2oLXEHrSW2IPWEnvQWmKN/f3/AcF47O5yKIOoAAAAAElFTkSuQmCC",
                "swagger": {
                  "swagger": "2.0",
                  "info": {
                    "title": "Cisco Firepower Management Center REST API",
                    "version": "v1"
                  },
                  "paths": {
                    "/api/fmc_platform/v1/auth/generatetoken": {
                      "post": {
                        "tags": [
                          "Auth"
                        ],
                        "summary": "Generate token",
                        "description": "Firepower Management Center REST API authentication tokens are valid for 30 minutes, and can be refreshed up to three times.",
                        "operationId": "[[variables('_operationId-CiscoFmcAuthGenerateTokenV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "headers": {
                              "X-auth-access-token": {
                                "description": "Authentication token value",
                                "type": "string"
                              },
                              "X-auth-refresh-token": {
                                "description": "Refresh token value",
                                "type": "string"
                              },
                              "DOMAIN_UUID": {
                                "description": "Domain UUID",
                                "type": "string"
                              }
                            }
                          },
                          "204": {
                            "description": "Success",
                            "headers": {
                              "X-auth-access-token": {
                                "description": "Authentication token value",
                                "type": "string"
                              },
                              "X-auth-refresh-token": {
                                "description": "Refresh token value",
                                "type": "string"
                              },
                              "DOMAIN_UUID": {
                                "description": "Domain UUID",
                                "type": "string"
                              }
                            }
                          },
                          "401": {
                            "description": "Unauthorized",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {
                            "basic_auth": "[variables('TemplateEmptyArray')]"
                          }
                        ]
                      }
                    },
                    "/api/fmc_platform/v1/auth/refreshtoken": {
                      "post": {
                        "tags": [
                          "Auth"
                        ],
                        "summary": "Refresh token",
                        "description": "Firepower Management Center REST API authentication tokens are valid for 30 minutes, and can be refreshed up to three times.",
                        "operationId": "[[variables('_operationId-CiscoFmcAuthRefreshTokenV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-refresh-token",
                            "description": "Refresh token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "headers": {
                              "X-auth-access-token": {
                                "description": "Authentication token value",
                                "type": "string"
                              },
                              "X-auth-refresh-token": {
                                "description": "Refresh token value",
                                "type": "string"
                              },
                              "DOMAIN_UUID": {
                                "description": "Domain UUID",
                                "type": "string"
                              }
                            }
                          },
                          "204": {
                            "description": "Success",
                            "headers": {
                              "X-auth-access-token": {
                                "description": "Authentication token value",
                                "type": "string"
                              },
                              "X-auth-refresh-token": {
                                "description": "Refresh token value",
                                "type": "string"
                              },
                              "DOMAIN_UUID": {
                                "description": "Domain UUID",
                                "type": "string"
                              }
                            }
                          },
                          "401": {
                            "description": "Unauthorized",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_platform/v1/auth/revokeaccess": {
                      "post": {
                        "tags": [
                          "Auth"
                        ],
                        "summary": "Revoke access",
                        "description": "Revoke access for a token",
                        "operationId": "[[variables('_operationId-CiscoFmcAuthRevokeAccessV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success"
                          },
                          "204": {
                            "description": "Success"
                          },
                          "401": {
                            "description": "Unauthorized",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/fqdns/{objectId}": {
                      "delete": {
                        "tags": [
                          "ObjectsFQDNs"
                        ],
                        "summary": "Deletes the FQDN object associated with the specified ID",
                        "description": "Deletes the FQDN object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcDeleteObjectFQDNV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a FQDN object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/FQDNObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "get": {
                        "tags": [
                          "ObjectsFQDNs"
                        ],
                        "summary": "Retrieves the FQDN object associated with the specified ID",
                        "description": "Retrieves the FQDN object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectFQDNV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a FQDN object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "overrideTargetId",
                            "description": "[[variables('_description')]",
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/FQDNObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "put": {
                        "tags": [
                          "ObjectsFQDNs"
                        ],
                        "summary": "Modifies the FQDN object associated with the specified ID",
                        "description": "Modifies the FQDN object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcPutObjectFQDNV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a FQDN object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of FQDN object",
                            "schema": {
                              "$ref": "#/definitions/FQDNObjectPut"
                            }
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/FQDNObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/fqdns": {
                      "get": {
                        "tags": [
                          "ObjectsFQDNs"
                        ],
                        "summary": "Retrieves list of all FQDN objects",
                        "description": "Retrieves list of all FQDN objects",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectFQDNsV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "filter",
                            "description": "To be used in conjunction with \\\"unusedOnly:true\\\" to search for unused objects and \\\"nameOrValue:{nameOrValue}\\\" to search for both name and value.",
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "offset",
                            "description": "Index of first item to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "limit",
                            "description": "Number of items to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "expanded",
                            "description": "If set to true, the GET response displays a list of objects with additional attributes.",
                            "type": "boolean"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/FQDNObjectListContainer"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "post": {
                        "tags": [
                          "ObjectsFQDNs"
                        ],
                        "summary": "Create the FQDN object",
                        "description": "Create the FQDN object",
                        "operationId": "[[variables('_operationId-CiscoFmcPostObjectFQDNV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of FQDN object",
                            "schema": {
                              "$ref": "#/definitions/FQDNObjectPost"
                            }
                          }
                        ],
                        "responses": {
                          "201": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/FQDNObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/networkgroups/{objectId}": {
                      "delete": {
                        "tags": [
                          "ObjectsNetworkGroups"
                        ],
                        "summary": "Deletes the network group object associated with the specified ID",
                        "description": "Deletes the network group object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcDeleteObjectNetworkGroupV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a network group",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroup"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "get": {
                        "tags": [
                          "ObjectsNetworkGroups"
                        ],
                        "summary": "Retrieves the network group object associated with the specified ID",
                        "description": "Retrieves the network group object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectNetworkGroupV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a network group",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "overrideTargetId",
                            "description": "[[variables('_description')]",
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroup"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "put": {
                        "tags": [
                          "ObjectsNetworkGroups"
                        ],
                        "summary": "Modifies the network group object associated with the specified ID",
                        "description": "Modifies the network group object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcPutObjectNetworkGroupV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a network group",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of network group",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroupPut"
                            }
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroup"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/networkgroups": {
                      "get": {
                        "tags": [
                          "ObjectsNetworkGroups"
                        ],
                        "summary": "Retrieves list of all network group objects",
                        "description": "Retrieves list of all network group objects",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectNetworkGroupsV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "filter",
                            "description": "To be used in conjunction with \\\"unusedOnly:true\\\" to search for unused objects and \\\"nameOrValue:{nameOrValue}\\\" to search for both name and value.",
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "offset",
                            "description": "Index of first item to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "limit",
                            "description": "Number of items to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "expanded",
                            "description": "If set to true, the GET response displays a list of objects with additional attributes.",
                            "type": "boolean"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroupListContainer"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "post": {
                        "tags": [
                          "ObjectsNetworkGroups"
                        ],
                        "summary": "Create the network group object",
                        "description": "Create the network group object",
                        "operationId": "[[variables('_operationId-CiscoFmcPostObjectNetworkGroupV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of network group",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroupPost"
                            }
                          }
                        ],
                        "responses": {
                          "201": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkGroup"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/networks/{objectId}": {
                      "delete": {
                        "tags": [
                          "ObjectsNetworks"
                        ],
                        "summary": "Deletes the network object associated with the specified ID",
                        "description": "Deletes the network object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcDeleteObjectNetworkV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a network object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "get": {
                        "tags": [
                          "ObjectsNetworks"
                        ],
                        "summary": "Retrieves the network object associated with the specified ID",
                        "description": "Retrieves the network object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectNetworkV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a network object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "overrideTargetId",
                            "description": "[[variables('_description')]",
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "put": {
                        "tags": [
                          "ObjectsNetworks"
                        ],
                        "summary": "Modifies the network object associated with the specified ID",
                        "description": "Modifies the network object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcPutObjectNetworkV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a network object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of network object",
                            "schema": {
                              "$ref": "#/definitions/NetworkObjectPut"
                            }
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/networks": {
                      "get": {
                        "tags": [
                          "ObjectsNetworks"
                        ],
                        "summary": "Retrieves list of all network objects",
                        "description": "Retrieves list of all network objects",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectNetworksV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "filter",
                            "description": "To be used in conjunction with \\\"unusedOnly:true\\\" to search for unused objects and \\\"nameOrValue:{nameOrValue}\\\" to search for both name and value.",
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "offset",
                            "description": "Index of first item to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "limit",
                            "description": "Number of items to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "expanded",
                            "description": "If set to true, the GET response displays a list of objects with additional attributes.",
                            "type": "boolean"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkObjectListContainer"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "post": {
                        "tags": [
                          "ObjectsNetworks"
                        ],
                        "summary": "Create the network object",
                        "description": "Create the network object",
                        "operationId": "[[variables('_operationId-CiscoFmcPostObjectNetworkV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of network object",
                            "schema": {
                              "$ref": "#/definitions/NetworkObjectPost"
                            }
                          }
                        ],
                        "responses": {
                          "201": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/NetworkObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/ranges/{objectId}": {
                      "delete": {
                        "tags": [
                          "ObjectsRanges"
                        ],
                        "summary": "Deletes the range object associated with the specified ID",
                        "description": "Deletes the range object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcDeleteObjectRangeV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a range object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/RangeObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "get": {
                        "tags": [
                          "ObjectsRanges"
                        ],
                        "summary": "Retrieves the range object associated with the specified ID",
                        "description": "Retrieves the range object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectRangeV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a range object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "overrideTargetId",
                            "description": "[[variables('_description')]",
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/RangeObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "put": {
                        "tags": [
                          "ObjectsRanges"
                        ],
                        "summary": "Modifies the range object associated with the specified ID",
                        "description": "Modifies the range object associated with the specified ID",
                        "operationId": "[[variables('_operationId-CiscoFmcPutObjectRangeV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "path",
                            "name": "objectId",
                            "description": "Identifier for a range object",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of range object",
                            "schema": {
                              "$ref": "#/definitions/RangeObjectPut"
                            }
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/RangeObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    },
                    "/api/fmc_config/v1/domain/{domainUUID}/object/ranges": {
                      "get": {
                        "tags": [
                          "ObjectsRanges"
                        ],
                        "summary": "Retrieves list of all range objects",
                        "description": "Retrieves list of all range objects",
                        "operationId": "[[variables('_operationId-CiscoFmcGetObjectRangesV1')]",
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "filter",
                            "description": "To be used in conjunction with \\\"unusedOnly:true\\\" to search for unused objects and \\\"nameOrValue:{nameOrValue}\\\" to search for both name and value.",
                            "type": "string"
                          },
                          {
                            "in": "query",
                            "name": "offset",
                            "description": "Index of first item to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "limit",
                            "description": "Number of items to return.",
                            "type": "integer",
                            "format": "int32"
                          },
                          {
                            "in": "query",
                            "name": "expanded",
                            "description": "If set to true, the GET response displays a list of objects with additional attributes.",
                            "type": "boolean"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          }
                        ],
                        "responses": {
                          "200": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/RangeObjectListContainer"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      },
                      "post": {
                        "tags": [
                          "ObjectsRanges"
                        ],
                        "summary": "Create the range object",
                        "description": "Create the range object",
                        "operationId": "[[variables('_operationId-CiscoFmcPostObjectRangeV1')]",
                        "consumes": [
                          "application/json"
                        ],
                        "produces": [
                          "application/json"
                        ],
                        "parameters": [
                          {
                            "in": "path",
                            "name": "domainUUID",
                            "description": "Domain UUID",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "header",
                            "name": "X-auth-access-token",
                            "description": "Authentication token value",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "in": "body",
                            "name": "body",
                            "description": "Input representation of range object",
                            "schema": {
                              "$ref": "#/definitions/RangeObjectPost"
                            }
                          }
                        ],
                        "responses": {
                          "201": {
                            "description": "Success",
                            "schema": {
                              "$ref": "#/definitions/RangeObject"
                            }
                          },
                          "default": {
                            "description": "default",
                            "schema": {
                              "$ref": "#/definitions/ErrorModel"
                            }
                          }
                        },
                        "security": [
                          {}
                        ]
                      }
                    }
                  },
                  "definitions": {
                    "ErrorMessagesContainer": {
                      "type": "object",
                      "properties": {
                        "description": {
                          "type": "string",
                          "x-ms-summary": "Description"
                        }
                      },
                      "x-ms-summary": "Messages"
                    },
                    "ErrorResponse": {
                      "type": "object",
                      "properties": {
                        "category": {
                          "enum": [
                            "FRAMEWORK",
                            "OTHER"
                          ],
                          "type": "string",
                          "x-ms-summary": "Category"
                        },
                        "messages": {
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/ErrorMessagesContainer"
                          },
                          "x-ms-summary": "Messages"
                        },
                        "severity": {
                          "enum": [
                            "ERROR",
                            "WARN"
                          ],
                          "type": "string",
                          "x-ms-summary": "Severity"
                        }
                      },
                      "x-ms-summary": "Error"
                    },
                    "ErrorModel": {
                      "type": "object",
                      "properties": {
                        "error": {
                          "$ref": "#/definitions/ErrorResponse"
                        }
                      }
                    },
                    "ILinks": {
                      "description": "This defines the self referencing links for the given resource.",
                      "type": "object",
                      "properties": {
                        "parent": {
                          "description": "Full resource URL path to reference the parent (if any) for this resource.",
                          "type": "string",
                          "x-ms-summary": "Parent"
                        },
                        "self": {
                          "description": "Full resource URL path to reference this particular resource.",
                          "type": "string",
                          "x-ms-summary": "Self"
                        }
                      },
                      "x-ms-summary": "Links"
                    },
                    "MetadataUser": {
                      "description": "This object defines details about the user.",
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "Name of the user.",
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "id": {
                          "description": "The unique UUID of the user",
                          "type": "string",
                          "x-ms-summary": "ID"
                        },
                        "type": {
                          "description": "The user type (fixed).",
                          "type": "string",
                          "x-ms-summary": "Type"
                        }
                      },
                      "x-ms-summary": "Last user"
                    },
                    "Domain": {
                      "description": "The details about the domain.",
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "Name of the domain.",
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "id": {
                          "description": "Unique UUID of this domain",
                          "type": "string",
                          "x-ms-summary": "ID"
                        },
                        "type": {
                          "description": "Domain type definition (fixed).",
                          "type": "string",
                          "x-ms-summary": "Type"
                        }
                      },
                      "x-ms-summary": "Domain"
                    },
                    "Readonly": {
                      "description": "Defines the read only conditions if the referenced resource is read only.",
                      "type": "object",
                      "properties": {
                        "reason": {
                          "description": "Reason the resource is read only - SYSTEM (if it is system defined), RBAC (if user RBAC permissions make it read only) or DOMAIN (if resource is read only in current domain).",
                          "enum": [
                            "SYSTEM",
                            "RBAC",
                            "DOMAIN"
                          ],
                          "type": "string",
                          "x-ms-summary": "Reason"
                        },
                        "state": {
                          "description": "True if this resource us read only and false otherwise.",
                          "type": "boolean",
                          "x-ms-summary": "State"
                        }
                      },
                      "x-ms-summary": "Read-only"
                    },
                    "Metadata": {
                      "description": "Defines read only details about the object - whether it is system defined, last user who modified the object etc.",
                      "type": "object",
                      "properties": {
                        "lastUser": {
                          "$ref": "#/definitions/MetadataUser"
                        },
                        "domain": {
                          "$ref": "#/definitions/Domain"
                        },
                        "readOnly": {
                          "$ref": "#/definitions/Readonly"
                        },
                        "timestamp": {
                          "format": "int32",
                          "description": "The last updated timestamp.",
                          "type": "integer",
                          "x-ms-summary": "Timestamp"
                        }
                      },
                      "x-ms-summary": "Metadata"
                    },
                    "ParentReference": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "id": {
                          "description": "Unique identifier representing resource.",
                          "type": "string",
                          "x-ms-summary": "ID"
                        },
                        "type": {
                          "description": "Response object associated with resource.",
                          "type": "string",
                          "x-ms-summary": "Type"
                        }
                      },
                      "x-ms-summary": "Parent"
                    },
                    "TargetReference": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "id": {
                          "description": "Unique identifier representing resource.",
                          "type": "string",
                          "x-ms-summary": "ID"
                        },
                        "type": {
                          "description": "Response object associated with resource.",
                          "type": "string",
                          "x-ms-summary": "Type"
                        }
                      },
                      "x-ms-summary": "Target"
                    },
                    "IOverride": {
                      "description": "Defines the override details for this object.",
                      "type": "object",
                      "properties": {
                        "parent": {
                          "$ref": "#/definitions/ParentReference"
                        },
                        "target": {
                          "$ref": "#/definitions/TargetReference"
                        }
                      },
                      "x-ms-summary": "Overrides"
                    },
                    "FQDNObject": {
                      "description": "A model representing FQDN Network object definition.",
                      "type": "object",
                      "properties": {
                        "metadata": {
                          "$ref": "#/definitions/Metadata"
                        },
                        "dnsResolution": {
                          "description": "DNS resolution: Resolve within IPv4 and IPv6, Resolve within IPv4 addresses only, Resolve within IPv6 addresses only",
                          "enum": [
                            "IPV4_ONLY",
                            "IPV6_ONLY",
                            "IPV4_AND_IPV6"
                          ],
                          "type": "string",
                          "x-ms-summary": "DNS resolution",
                          "x-ms-visibility": "important"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "overrides": {
                          "$ref": "#/definitions/IOverride"
                        },
                        "id": {
                          "description": "Unique identifier representing response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "type": {
                          "description": "Type associated with resource: FQDNObject.",
                          "default": "FQDN",
                          "enum": [
                            "FQDN"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "value": {
                          "description": "Actual value of the FQDN.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "ParentReferencePost": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "id": {
                          "description": "Unique identifier representing resource.",
                          "type": "string",
                          "x-ms-summary": "ID"
                        },
                        "type": {
                          "description": "Response object associated with resource.",
                          "type": "string",
                          "x-ms-summary": "Type"
                        }
                      },
                      "x-ms-summary": "Parent"
                    },
                    "TargetReferencePost": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "id": {
                          "description": "Unique identifier representing resource.",
                          "type": "string",
                          "x-ms-summary": "ID"
                        },
                        "type": {
                          "description": "Response object associated with resource.",
                          "type": "string",
                          "x-ms-summary": "Type"
                        }
                      },
                      "x-ms-summary": "Target"
                    },
                    "OverridePost": {
                      "description": "Defines the override details for this object.",
                      "type": "object",
                      "properties": {
                        "parent": {
                          "$ref": "#/definitions/ParentReferencePost"
                        },
                        "target": {
                          "$ref": "#/definitions/TargetReferencePost"
                        }
                      },
                      "x-ms-summary": "Overrides"
                    },
                    "FQDNObjectPut": {
                      "description": "A model representing FQDN Network object definition.",
                      "required": [
                        "dnsResolution",
                        "id",
                        "name",
                        "type",
                        "value"
                      ],
                      "type": "object",
                      "properties": {
                        "id": {
                          "description": "Unique identifier representing response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "value": {
                          "description": "Actual value of the FQDN.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "dnsResolution": {
                          "description": "DNS resolution: Resolve within IPv4 and IPv6, Resolve within IPv4 addresses only, Resolve within IPv6 addresses only",
                          "default": "IPV4_AND_IPV6",
                          "enum": [
                            "IPV4_AND_IPV6",
                            "IPV4_ONLY",
                            "IPV6_ONLY"
                          ],
                          "type": "string",
                          "x-ms-summary": "DNS resolution",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: FQDNObject.",
                          "default": "FQDN",
                          "enum": [
                            "FQDN"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "PagingContainer": {
                      "type": "object",
                      "properties": {
                        "pages": {
                          "format": "int32",
                          "type": "integer",
                          "x-ms-summary": "Pages"
                        },
                        "offset": {
                          "format": "int32",
                          "type": "integer",
                          "x-ms-summary": "Offset"
                        },
                        "limit": {
                          "format": "int32",
                          "type": "integer",
                          "x-ms-summary": "Limit"
                        },
                        "count": {
                          "format": "int32",
                          "type": "integer",
                          "x-ms-summary": "Count"
                        }
                      },
                      "x-ms-summary": "Paging"
                    },
                    "FQDNObjectListContainer": {
                      "type": "object",
                      "properties": {
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "paging": {
                          "$ref": "#/definitions/PagingContainer"
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/FQDNObject"
                          },
                          "x-ms-summary": "FQDN items"
                        }
                      }
                    },
                    "FQDNObjectPost": {
                      "description": "A model representing FQDN Network object definition.",
                      "required": [
                        "dnsResolution",
                        "name",
                        "type",
                        "value"
                      ],
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "value": {
                          "description": "Actual value of the FQDN.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "dnsResolution": {
                          "description": "DNS resolution: Resolve within IPv4 and IPv6, Resolve within IPv4 addresses only, Resolve within IPv6 addresses only",
                          "default": "IPV4_AND_IPV6",
                          "enum": [
                            "IPV4_AND_IPV6",
                            "IPV4_ONLY",
                            "IPV6_ONLY"
                          ],
                          "type": "string",
                          "x-ms-summary": "DNS resolution",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: FQDNObject.",
                          "default": "FQDN",
                          "enum": [
                            "FQDN"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "NetworkGroupNetworkAddress": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "enum": [
                            "FQDN",
                            "Host",
                            "Network",
                            "NetworkGroup",
                            "Range"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "name": {
                          "type": "string",
                          "x-ms-summary": "Name"
                        },
                        "id": {
                          "type": "string",
                          "x-ms-summary": "ID"
                        }
                      },
                      "x-ms-summary": "Objects"
                    },
                    "INetworkAddressLiteral": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "enum": [
                            "Host",
                            "Network"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "value": {
                          "type": "string",
                          "x-ms-summary": "Value"
                        }
                      },
                      "x-ms-summary": "Literals"
                    },
                    "NetworkGroup": {
                      "description": "A model representing Network group definition.",
                      "type": "object",
                      "properties": {
                        "metadata": {
                          "$ref": "#/definitions/Metadata"
                        },
                        "objects": {
                          "description": "The list of member network objects",
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/NetworkGroupNetworkAddress"
                          },
                          "x-ms-summary": "Objects",
                          "x-ms-visibility": "important"
                        },
                        "literals": {
                          "description": "List of network values in group.",
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/INetworkAddressLiteral"
                          },
                          "x-ms-summary": "Literals",
                          "x-ms-visibility": "important"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "overrides": {
                          "$ref": "#/definitions/IOverride"
                        },
                        "id": {
                          "description": "Unique identifier of response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "type": {
                          "description": "Type associated with resource: NetworkGroup.",
                          "default": "NetworkGroup",
                          "enum": [
                            "NetworkGroup"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "NetworkGroupPut": {
                      "description": "A model representing Network group definition.",
                      "required": [
                        "id",
                        "name",
                        "type"
                      ],
                      "type": "object",
                      "properties": {
                        "id": {
                          "description": "Unique identifier of network group.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "objects": {
                          "description": "The list of member network objects.",
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/NetworkGroupNetworkAddress"
                          },
                          "x-ms-summary": "Objects",
                          "x-ms-visibility": "important"
                        },
                        "literals": {
                          "description": "List of network values in group.",
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/INetworkAddressLiteral"
                          },
                          "x-ms-summary": "Literals",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: NetworkGroup.",
                          "default": "NetworkGroup",
                          "enum": [
                            "NetworkGroup"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "NetworkGroupListContainer": {
                      "type": "object",
                      "properties": {
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "paging": {
                          "$ref": "#/definitions/PagingContainer"
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/NetworkGroup"
                          },
                          "x-ms-summary": "Network group items"
                        }
                      }
                    },
                    "NetworkGroupPost": {
                      "description": "A model representing Network group definition.",
                      "required": [
                        "name",
                        "type"
                      ],
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User chosen resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "objects": {
                          "description": "The list of member network objects.",
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/NetworkGroupNetworkAddress"
                          },
                          "x-ms-summary": "Objects",
                          "x-ms-visibility": "important"
                        },
                        "literals": {
                          "description": "List of network values in group.",
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/INetworkAddressLiteral"
                          },
                          "x-ms-summary": "Literals",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: NetworkGroup.",
                          "default": "NetworkGroup",
                          "enum": [
                            "NetworkGroup"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "NetworkObject": {
                      "description": "A model representing Network object definition.",
                      "type": "object",
                      "properties": {
                        "metadata": {
                          "$ref": "#/definitions/Metadata"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "overrides": {
                          "$ref": "#/definitions/IOverride"
                        },
                        "id": {
                          "description": "Unique identifier representing response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "type": {
                          "description": "Type associated with resource: NetworkObject.",
                          "default": "Network",
                          "enum": [
                            "Network"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "value": {
                          "description": "Actual value of the network.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "NetworkObjectPut": {
                      "description": "A model representing Network object definition.",
                      "required": [
                        "id",
                        "name",
                        "type",
                        "value"
                      ],
                      "type": "object",
                      "properties": {
                        "id": {
                          "description": "Unique identifier representing response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "value": {
                          "description": "Actual value of the network.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: NetworkObject.",
                          "default": "Network",
                          "enum": [
                            "Network"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "NetworkObjectListContainer": {
                      "type": "object",
                      "properties": {
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "paging": {
                          "$ref": "#/definitions/PagingContainer"
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/NetworkObject"
                          },
                          "x-ms-summary": "Network items"
                        }
                      }
                    },
                    "NetworkObjectPost": {
                      "description": "A model representing Network object definition.",
                      "required": [
                        "name",
                        "type",
                        "value"
                      ],
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "value": {
                          "description": "Actual value of the network.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: NetworkObject.",
                          "default": "Network",
                          "enum": [
                            "Network"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "RangeObject": {
                      "description": "A model representing Range Network object definition.",
                      "type": "object",
                      "properties": {
                        "metadata": {
                          "$ref": "#/definitions/Metadata"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "overrides": {
                          "$ref": "#/definitions/IOverride"
                        },
                        "id": {
                          "description": "Unique identifier representing response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "type": {
                          "description": "Type associated with resource: RangeObject.",
                          "default": "Range",
                          "enum": [
                            "Range"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "value": {
                          "description": "Actual value of the range.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "RangeObjectPut": {
                      "description": "A model representing Range Network object definition.",
                      "required": [
                        "id",
                        "name",
                        "type",
                        "value"
                      ],
                      "type": "object",
                      "properties": {
                        "id": {
                          "description": "Unique identifier representing response object.",
                          "type": "string",
                          "x-ms-summary": "ID",
                          "x-ms-visibility": "important"
                        },
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "value": {
                          "description": "Actual value of the range.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: RangeObject.",
                          "default": "Range",
                          "enum": [
                            "Range"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    },
                    "RangeObjectListContainer": {
                      "type": "object",
                      "properties": {
                        "links": {
                          "$ref": "#/definitions/ILinks"
                        },
                        "paging": {
                          "$ref": "#/definitions/PagingContainer"
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/definitions/RangeObject"
                          },
                          "x-ms-summary": "Range items"
                        }
                      }
                    },
                    "RangeObjectPost": {
                      "description": "A model representing Range Network object definition.",
                      "required": [
                        "name",
                        "type",
                        "value"
                      ],
                      "type": "object",
                      "properties": {
                        "name": {
                          "description": "User assigned resource name.",
                          "type": "string",
                          "x-ms-summary": "Name",
                          "x-ms-visibility": "important"
                        },
                        "value": {
                          "description": "Actual value of the range.",
                          "type": "string",
                          "x-ms-summary": "Value",
                          "x-ms-visibility": "important"
                        },
                        "description": {
                          "description": "User provided resource description.",
                          "type": "string",
                          "x-ms-summary": "Description"
                        },
                        "type": {
                          "description": "Type associated with resource: RangeObject.",
                          "default": "Range",
                          "enum": [
                            "Range"
                          ],
                          "type": "string",
                          "x-ms-summary": "Type"
                        },
                        "overridable": {
                          "description": "Boolean indicating whether object values can be overridden.",
                          "type": "boolean",
                          "x-ms-summary": "Overrideable"
                        },
                        "overrides": {
                          "$ref": "#/definitions/OverridePost"
                        },
                        "overrideTargetId": {
                          "description": "Unique identifier of domain or device when override assigned to child domain. Used as path parameter to GET override details for a specific object on a specific target (device or domain).",
                          "type": "string",
                          "x-ms-summary": "Override target ID"
                        }
                      }
                    }
                  },
                  "securityDefinitions": {
                    "basic_auth": {
                      "type": "basic",
                      "description": "Basic Authorization header"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[[concat(variables('workspace-name'),'/Microsoft.SecurityInsights/',concat('LogicAppsCustomConnector-', last(split(variables('playbookId1'),'/'))))]",
              "properties": {
                "parentId": "[[variables('playbookId1')]",
                "contentId": "[variables('_playbookContentId1')]",
                "kind": "LogicAppsCustomConnector",
                "version": "[variables('playbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cisco Firepower EStreamer",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cisco"
                },
                "support": {
                  "name": "Cisco",
                  "tier": "Partner",
                  "link": "https://www.cisco.com/c/en_in/support/index.html"
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('playbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Playbook"
      },
      "properties": {
        "description": "BlockURL-CiscoFirepower-NetworkGroup playbook",
        "displayName": "BlockURL-CiscoFirepower-NetworkGroup playbook"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('playbookTemplateSpecName2'),'/',variables('playbookVersion2'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Playbook"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('playbookTemplateSpecName2'))]"
      ],
      "properties": {
        "description": "BlockURL-CiscoFirepower-NetworkGroup Playbook with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion2')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "BlockURL-CiscoFirepower-NetworkGroup",
              "type": "String",
              "metadata": {
                "description": "Name of the Logic Apps resource to be created"
              }
            },
            "Cisco Firepower Connector name": {
              "defaultValue": "CiscoFirepowerConnector",
              "type": "String",
              "metadata": {
                "description": "Cisco Firepower Connector name"
              }
            },
            "Network Group object name": {
              "type": "String",
              "metadata": {
                "description": "Network Group object name"
              }
            }
          },
          "variables": {
            "AzureSentinelConnectionName": "[[concat('azuresentinel-', parameters('PlaybookName'))]",
            "CiscoFirepowerConnectionName": "[[concat('ciscofirepowerconnector-', parameters('PlaybookName'))]",
            "defaultValue": "",
            "_defaultValue": "[[variables('defaultValue')]",
            "connection-1": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-1": "[[variables('connection-1')]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('Cisco Firepower Connector name'))]",
            "_connection-2": "[[variables('connection-2')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('AzureSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('AzureSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-1')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('CiscoFirepowerConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('CiscoFirepowerConnectionName'))]"
              ],
              "tags": {
                "hidden-SentinelTemplateName": "BlockURL-CiscoFirepower",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "properties": {
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    },
                    "Network Group object name": {
                      "defaultValue": "[[variables('_defaultValue')]",
                      "type": "String"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Entities_-_Get_URLs": {
                      "type": "ApiConnection",
                      "inputs": {
                        "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/entities/url"
                      }
                    },
                    "Entities_has_any_URLs": {
                      "actions": {
                        "For_each_over_URLs": {
                          "foreach": "@body('Entities_-_Get_URLs')?['URLs']",
                          "actions": {
                            "Append_Extracted_domain_to_FQDNs_array_variable": {
                              "runAfter": {
                                "If_Extract_domain_middle_has_a_path": [
                                  "Succeeded"
                                ]
                              },
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "FQDNs",
                                "value": "@variables('Extracted domain')"
                              }
                            },
                            "If_Extract_domain_initial_starts_with_www": {
                              "actions": {
                                "Set_Extract_domain_middle_variable_without_www": {
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Extract domain middle",
                                    "value": "@{replace(variables('Extract domain initial'), 'www.', '')}"
                                  }
                                }
                              },
                              "runAfter": {
                                "If_Url_starts_with_https": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Set_Extract_domain_middle_variable_to_Extract_domain_initial": {
                                    "type": "SetVariable",
                                    "inputs": {
                                      "name": "Extract domain middle",
                                      "value": "@variables('Extract domain initial')"
                                    }
                                  }
                                }
                              },
                              "expression": {
                                "and": [
                                  {
                                    "startsWith": [
                                      "@variables('Extract domain initial')",
                                      "www."
                                    ]
                                  }
                                ]
                              },
                              "type": "If"
                            },
                            "If_Extract_domain_middle_has_a_path": {
                              "actions": {
                                "Set_Extracted_domain_variable_without_path": {
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Extracted domain",
                                    "value": "@{substring(variables('Extract domain middle'), 0, int(indexOf(variables('Extract domain middle'), '/')))}"
                                  }
                                }
                              },
                              "runAfter": {
                                "If_Extract_domain_initial_starts_with_www": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Set_Extracted_domain_variable_to_Extract_domain_middle": {
                                    "type": "SetVariable",
                                    "inputs": {
                                      "name": "Extracted domain",
                                      "value": "@variables('Extract domain middle')"
                                    }
                                  }
                                }
                              },
                              "expression": {
                                "and": [
                                  {
                                    "contains": [
                                      "@variables('Extract domain middle')",
                                      "/"
                                    ]
                                  }
                                ]
                              },
                              "type": "If"
                            },
                            "If_Url_starts_with_https": {
                              "actions": {
                                "Set_Extract_domain_initial_variable_without_https": {
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Extract domain initial",
                                    "value": "@{replace(items('For_each_over_URLs')?['Url'], 'https://', '')}"
                                  }
                                }
                              },
                              "runAfter": {
                                "Set_Extracted_domain_variable_to_empty": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "If_Url_starts_with_http": {
                                    "actions": {
                                      "Set_Extract_domain_initial_variable_without_http": {
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Extract domain initial",
                                          "value": "@{replace(items('For_each_over_URLs')?['Url'], 'http://', '')}"
                                        }
                                      }
                                    },
                                    "else": {
                                      "actions": {
                                        "Set_Extract_domain_initial_variable_to_Url": {
                                          "type": "SetVariable",
                                          "inputs": {
                                            "name": "Extract domain initial",
                                            "value": "@{items('For_each_over_URLs')?['Url']}"
                                          }
                                        }
                                      }
                                    },
                                    "expression": {
                                      "and": [
                                        {
                                          "startsWith": [
                                            "@items('For_each_over_URLs')?['Url']",
                                            "http://"
                                          ]
                                        }
                                      ]
                                    },
                                    "type": "If"
                                  }
                                }
                              },
                              "expression": {
                                "and": [
                                  {
                                    "startsWith": [
                                      "@items('For_each_over_URLs')?['Url']",
                                      "https://"
                                    ]
                                  }
                                ]
                              },
                              "type": "If"
                            },
                            "Set_Extract_domain_initial_variable_to_empty": {
                              "type": "SetVariable",
                              "inputs": {
                                "name": "Extract domain initial",
                                "value": "''"
                              }
                            },
                            "Set_Extract_domain_middle_variable_to_empty": {
                              "runAfter": {
                                "Set_Extract_domain_initial_variable_to_empty": [
                                  "Succeeded"
                                ]
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "Extract domain middle",
                                "value": "''"
                              }
                            },
                            "Set_Extracted_domain_variable_to_empty": {
                              "runAfter": {
                                "Set_Extract_domain_middle_variable_to_empty": [
                                  "Succeeded"
                                ]
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "Extracted domain",
                                "value": "''"
                              }
                            }
                          },
                          "type": "Foreach",
                          "description": "In this for each we go over all the URLs and clean them up. Remove 'https://' or 'http://' form the start, also remove the path. Then we'll be left with a FQDN we store in the FQDNs array.",
                          "runtimeConfiguration": {
                            "concurrency": {
                              "repetitions": 1
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "Initialize_Extracted_domain_variable": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Add_comment_to_incident_(V3):_No_URLs_found": {
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "incidentArmId": "@triggerBody()?['object']?['id']",
                                "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\nThe incident did not have any entities with URLs.</p>"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/Incidents/Comment"
                            }
                          },
                          "Terminate:_No_URLs_found": {
                            "runAfter": {
                              "Add_comment_to_incident_(V3):_No_URLs_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "Terminate",
                            "inputs": {
                              "runStatus": "Cancelled"
                            }
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Entities_-_Get_URLs')?['URLs'])",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "If the Entities does not have any URLs for this incident, we terminate the Logic App. If we do have URLs we clean them up to FQDNs."
                    },
                    "Filter_Network_group_object_items_array": {
                      "runAfter": {
                        "If_Network_group_object_items_array_is_null": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Retrieves_list_of_all_network_group_objects')?['items']",
                        "where": "@equals(item()?['name'], variables('Network Group object name'))"
                      },
                      "description": "The filter with nameOrValue will also return items that start with the name, for example the 'Network Group Object name' is 'TEST' and there is a network group object named 'TEST_2' that will also be returned."
                    },
                    "Found_the_network_group_object_by_name": {
                      "actions": {
                        "Add_comment_to_incident_(V3)": {
                          "runAfter": {
                            "Modifies_the_network_group_object_associated_with_the_specified_ID": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\n<span style=\"font-size: 14px\">The following FQDNs were found in the Incident:<br>\n</span><span style=\"font-size: 14px\">@{variables('fqdnActionComment')}</span><span style=\"font-size: 14px\"></span></p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          }
                        },
                        "For_each_over_FQDNs": {
                          "foreach": "@variables('FQDNs')",
                          "actions": {
                            "Filter_Network_Group_object_Objects_with_FQDN": {
                              "runAfter": {
                                "Set_FQDN_Name_variable": [
                                  "Succeeded"
                                ]
                              },
                              "type": "Query",
                              "inputs": {
                                "from": "@variables('Network Group object Objects')",
                                "where": "@and(equals(item()?['type'], 'FQDN'), equals(item()?['name'], variables('fqdnName')))"
                              }
                            },
                            "If_Network_Group_object_Objects_contains_FQDN": {
                              "actions": {
                                "Append_to_fqdnActionComment_string_variable_already_blocked_message": {
                                  "type": "AppendToStringVariable",
                                  "inputs": {
                                    "name": "fqdnActionComment",
                                    "value": "@{items('For_each_over_FQDNs')} - is already blocked in Cisco Firepower"
                                  }
                                }
                              },
                              "runAfter": {
                                "Filter_Network_Group_object_Objects_with_FQDN": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Append_to_string_variable": {
                                    "runAfter": {
                                      "If_any_FQDN_items_found": [
                                        "Succeeded"
                                      ]
                                    },
                                    "type": "AppendToStringVariable",
                                    "inputs": {
                                      "name": "fqdnActionComment",
                                      "value": "@{items('For_each_over_FQDNs')} - blocked in Cisco Firepower\n"
                                    }
                                  },
                                  "If_any_FQDN_items_found": {
                                    "actions": {
                                      "Filter_FQDN_items_array": {
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@body('Retrieves_list_of_all_FQDN_objects')?['items']",
                                          "where": "@equals(item()?['name'], variables('fqdnName'))"
                                        }
                                      },
                                      "Found_existing_FQDN_object": {
                                        "actions": {
                                          "Append_existing_FQDN_to_Network_Group_Object_Objects_array_variable": {
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Network Group Object Objects",
                                              "value": {
                                                "id": "@{body('Filter_FQDN_items_array')[0]?['id']}",
                                                "name": "@{body('Filter_FQDN_items_array')[0]?['name']}",
                                                "type": "FQDN"
                                              }
                                            }
                                          }
                                        },
                                        "runAfter": {
                                          "Filter_FQDN_items_array": [
                                            "Succeeded"
                                          ]
                                        },
                                        "else": {
                                          "actions": {
                                            "Append_new_FQDN_to_Network_Group_Object_Objects_array_variable": {
                                              "runAfter": {
                                                "Create_the_FQDN_object": [
                                                  "Succeeded"
                                                ]
                                              },
                                              "type": "AppendToArrayVariable",
                                              "inputs": {
                                                "name": "Network Group Object Objects",
                                                "value": {
                                                  "id": "@{body('Create_the_FQDN_object')?['id']}",
                                                  "name": "@{body('Create_the_FQDN_object')?['name']}",
                                                  "type": "FQDN"
                                                }
                                              }
                                            },
                                            "Create_the_FQDN_object": {
                                              "type": "ApiConnection",
                                              "inputs": {
                                                "body": {
                                                  "dnsResolution": "IPV4_AND_IPV6",
                                                  "name": "@variables('fqdnName')",
                                                  "type": "FQDN",
                                                  "value": "@{items('For_each_over_FQDNs')}"
                                                },
                                                "headers": {
                                                  "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                                                },
                                                "host": {
                                                  "connection": {
                                                    "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                                                  }
                                                },
                                                "method": "post",
                                                "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/fqdns"
                                              }
                                            }
                                          }
                                        },
                                        "expression": {
                                          "and": [
                                            {
                                              "greater": [
                                                "@length(body('Filter_FQDN_items_array'))",
                                                0
                                              ]
                                            }
                                          ]
                                        },
                                        "type": "If"
                                      }
                                    },
                                    "runAfter": {
                                      "Retrieves_list_of_all_FQDN_objects": [
                                        "Succeeded"
                                      ]
                                    },
                                    "else": {
                                      "actions": {
                                        "Append_new_FQDN_to_Network_Group_Object_Objects_array_variable_2": {
                                          "runAfter": {
                                            "Create_the_FQDN_object_2": [
                                              "Succeeded"
                                            ]
                                          },
                                          "type": "AppendToArrayVariable",
                                          "inputs": {
                                            "name": "Network Group Object Objects",
                                            "value": {
                                              "id": "@{body('Create_the_FQDN_object_2')?['id']}",
                                              "name": "@{body('Create_the_FQDN_object_2')?['name']}",
                                              "type": "FQDN"
                                            }
                                          }
                                        },
                                        "Create_the_FQDN_object_2": {
                                          "type": "ApiConnection",
                                          "inputs": {
                                            "body": {
                                              "dnsResolution": "IPV4_AND_IPV6",
                                              "name": "@variables('fqdnName')",
                                              "type": "FQDN",
                                              "value": "@{items('For_each_over_FQDNs')}"
                                            },
                                            "headers": {
                                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                                            },
                                            "host": {
                                              "connection": {
                                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                                              }
                                            },
                                            "method": "post",
                                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/fqdns"
                                          }
                                        }
                                      }
                                    },
                                    "expression": {
                                      "and": [
                                        {
                                          "greaterOrEquals": [
                                            "@body('Retrieves_list_of_all_FQDN_objects')?['paging']?['limit']",
                                            1
                                          ]
                                        }
                                      ]
                                    },
                                    "type": "If"
                                  },
                                  "Retrieves_list_of_all_FQDN_objects": {
                                    "type": "ApiConnection",
                                    "inputs": {
                                      "headers": {
                                        "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                                      },
                                      "host": {
                                        "connection": {
                                          "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                                        }
                                      },
                                      "method": "get",
                                      "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/fqdns",
                                      "queries": {
                                        "filter": "nameOrValue:@{variables('fqdnName')}"
                                      }
                                    }
                                  }
                                }
                              },
                              "expression": {
                                "and": [
                                  {
                                    "greater": [
                                      "@length(body('Filter_Network_Group_Object_Objects_with_FQDN'))",
                                      0
                                    ]
                                  }
                                ]
                              },
                              "type": "If"
                            },
                            "Set_FQDN_Name_variable": {
                              "type": "SetVariable",
                              "inputs": {
                                "name": "fqdnName",
                                "value": "@{concat(variables('fqdnNamePrefix'), items('For_each_over_FQDNs'))}"
                              }
                            }
                          },
                          "runAfter": {
                            "Set_Network_Group_object_Objects_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach",
                          "runtimeConfiguration": {
                            "concurrency": {
                              "repetitions": 1
                            }
                          }
                        },
                        "Modifies_the_network_group_object_associated_with_the_specified_ID": {
                          "runAfter": {
                            "For_each_over_FQDNs": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "description": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['description']",
                              "id": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['id']",
                              "literals": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['literals']",
                              "name": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['name']",
                              "objects": "@variables('Network Group Object Objects')",
                              "overridable": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['overridable']",
                              "type": "NetworkGroup"
                            },
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['id'])}"
                          }
                        },
                        "Retrieves_the_network_group_object_associated_with_the_specified_ID": {
                          "runAfter": {
                            "Set_Network_Group_Object_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "get",
                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(variables('Network Group object')?['id'])}"
                          }
                        },
                        "Set_Network_Group_Object_variable": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Network Group Object",
                            "value": "@body('Filter_Network_group_object_items_array')[0]"
                          }
                        },
                        "Set_Network_Group_object_Objects_variable": {
                          "runAfter": {
                            "Retrieves_the_network_group_object_associated_with_the_specified_ID": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Network Group Object Objects",
                            "value": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['objects']"
                          }
                        },
                        "Update_incident": {
                          "runAfter": {
                            "Add_comment_to_incident_(V3)": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "classification": {
                                "ClassificationAndReason": "True Positive - Suspicious Activity",
                                "ClassificationReasonText": "URLs/FQDNs in incident automaticly blocked"
                              },
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "status": "Closed"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/Incidents"
                          }
                        }
                      },
                      "runAfter": {
                        "Filter_Network_group_object_items_array": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Add_comment_to_incident_(V3):_Network_Group_object_not_found": {
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "incidentArmId": "@triggerBody()?['object']?['id']",
                                "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary<br>\n</strong></span><span style=\"font-size: 12px\">We could not find the Network Group object with name: '</span><span style=\"font-size: 12px\">@{variables('Network Group object name')}</span><span style=\"font-size: 12px\">'</span></p>"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/Incidents/Comment"
                            }
                          },
                          "Revoke_access:_Network_Group_object_not_found": {
                            "runAfter": {
                              "Add_comment_to_incident_(V3):_Network_Group_object_not_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                              "headers": {
                                "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/api/fmc_platform/v1/auth/revokeaccess"
                            }
                          },
                          "Terminate:_Network_Group_object_not_found": {
                            "runAfter": {
                              "Revoke_access:_Network_Group_object_not_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "Terminate",
                            "inputs": {
                              "runError": {
                                "message": "Network Group object not found"
                              },
                              "runStatus": "Failed"
                            }
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Filter_Network_group_object_items_array'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Generate_token": {
                      "runAfter": {
                        "Initialize_Network_Group_object_Objects_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/api/fmc_platform/v1/auth/generatetoken"
                      }
                    },
                    "If_Network_group_object_items_array_is_null": {
                      "actions": {
                        "Add_comment_to_incident_(V3):_Network_Group_object_not_found_2": {
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\nWe could not find the Network Group object with name: '@{variables('Network Group object name')}'</p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel_1']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          }
                        },
                        "Revoke_access:_Network_Group_object_not_found_2": {
                          "runAfter": {
                            "Add_comment_to_incident_(V3):_Network_Group_object_not_found_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/fmc_platform/v1/auth/revokeaccess"
                          }
                        },
                        "Terminate:_Network_Group_object_not_found_2": {
                          "runAfter": {
                            "Revoke_access:_Network_Group_object_not_found_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "Terminate",
                          "inputs": {
                            "runError": {
                              "message": "Network Group object not found"
                            },
                            "runStatus": "Failed"
                          }
                        }
                      },
                      "runAfter": {
                        "Retrieves_list_of_all_network_group_objects": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@body('Retrieves_list_of_all_network_group_objects')?['items']",
                              "@null"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Initialize_Extract_domain_initial_variable": {
                      "runAfter": {
                        "Initialize_FQDNs_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Extract domain initial",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Initialize_Extract_domain_middle_variable": {
                      "runAfter": {
                        "Initialize_Extract_domain_initial_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Extract domain middle",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Initialize_Extracted_domain_variable": {
                      "runAfter": {
                        "Initialize_Extract_domain_middle_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Extracted domain",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Initialize_FQDN_name_prefix_variable": {
                      "runAfter": {
                        "Initialize_Network_Group_object_name_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "fqdnNamePrefix",
                            "type": "string",
                            "value": "LogicApp_"
                          }
                        ]
                      }
                    },
                    "Initialize_FQDN_name_variable": {
                      "runAfter": {
                        "Initialize_FQDN_name_prefix_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "fqdnName",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Initialize_FQDNs_variable": {
                      "runAfter": {
                        "Entities_-_Get_URLs": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "FQDNs",
                            "type": "array",
                            "value": "[variables('TemplateEmptyArray')]"
                          }
                        ]
                      }
                    },
                    "Initialize_Network_Group_object_Objects_variable": {
                      "runAfter": {
                        "Initialize_Network_Group_object_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group object Objects",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Initialize_Network_Group_object_name_variable": {
                      "runAfter": {
                        "Entities_has_any_URLs": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group object name",
                            "type": "string",
                            "value": "@parameters('Network Group object name')"
                          }
                        ]
                      }
                    },
                    "Initialize_Network_Group_object_variable": {
                      "runAfter": {
                        "Initialize_fqdnActionComment_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group object",
                            "type": "object"
                          }
                        ]
                      }
                    },
                    "Initialize_fqdnActionComment_variable": {
                      "runAfter": {
                        "Initialize_FQDN_name_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "fqdnActionComment",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Retrieves_list_of_all_network_group_objects": {
                      "runAfter": {
                        "Generate_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups",
                        "queries": {
                          "filter": "nameOrValue:@{variables('Network Group object name')}"
                        }
                      }
                    },
                    "Revoke_access": {
                      "runAfter": {
                        "Found_the_network_group_object_by_name": [
                          "Succeeded",
                          "Failed",
                          "Skipped",
                          "TimedOut"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/api/fmc_platform/v1/auth/revokeaccess"
                      }
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                        "connectionName": "[[variables('AzureSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      },
                      "Cisco-Firepower-connector": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('CiscoFirepowerConnectionName'))]",
                        "connectionName": "[[variables('CiscoFirepowerConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('Cisco Firepower Connector name'))]"
                      }
                    }
                  },
                  "Network Group object name": {
                    "value": "[[parameters('Network Group object name')]"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId2'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId2')]",
                "contentId": "[variables('_playbookContentId2')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cisco Firepower EStreamer",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cisco"
                },
                "support": {
                  "name": "Cisco",
                  "tier": "Partner",
                  "link": "https://www.cisco.com/c/en_in/support/index.html"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "kind": "LogicAppsCustomConnector",
                      "contentId": "[variables('_CiscoFirepowerConnector')]",
                      "version": "[variables('playbookVersion1')]"
                    }
                  ]
                }
              }
            }
          ],
          "metadata": {
            "title": "Block URL - Cisco Firepower",
            "description": "This playbook allows blocking of FQDNs in Cisco Firepower, using a **Network Group object**. This allows making changes to a Network Group selected members, instead of making Access List Entries. The Network Group object itself should be part of an Access List Entry.",
            "mainSteps": [
              "1. For the URLs of the incident, extract the FQDN",
              "2. Check if FQDNs are already selected for the Network Group object",
              "3. For the FQDNs not already selected for the Network Group object, check if there is an existing FQDN object in Cisco Firepower, if it does not exist create it",
              "4. Add the FQDN object to the Network Group object, so it gets blocked",
              "5. Comment is added to Microsoft Sentinel incident"
            ],
            "prerequisites": [
              "1. Cisco Firepower custom connector needs to be deployed prior to the deployment of this playbook, in the same resource group and region. Relevant instructions can be found in the connector doc pages.",
              "2. In Cisco Firepower there needs to be a Network Group object. [Creating Network Objects](https://www.cisco.com/c/en/us/td/docs/security/firepower/630/configuration/guide/fpmc-config-guide-v63/reusable_objects.html#ariaid-title15)"
            ],
            "lastUpdateTime": "2022-07-20T00:00:00Z",
            "entities": [
              "Url"
            ],
            "tags": [
              "Remediation"
            ],
            "postDeployment": [
              "**a. Authorize connections**",
              "Once deployment is complete, you will need to authorize each connection.",
              "1. Click the Microsoft Sentinel connection resource",
              "2. Click edit API connection",
              "3. Click Authorize",
              "4. Sign in",
              "5. Click Save",
              "6. Repeat steps for other connections such as Cisco Firepower (For authorizing the Cisco Firepower API connection, the username and password needs to be provided).",
              "**b. Configurations in Microsoft Sentinel**",
              "1. In Microsoft sentinel analytical rules should be configured to trigger an incident with URL Entity.",
              "2. Configure the automation rules to trigger this playbook."
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Block URL - Cisco Firepower",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('playbookTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Playbook"
      },
      "properties": {
        "description": "BlockIP-CiscoFirepower playbook",
        "displayName": "BlockIP-CiscoFirepower playbook"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('playbookTemplateSpecName3'),'/',variables('playbookVersion3'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Playbook"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('playbookTemplateSpecName3'))]"
      ],
      "properties": {
        "description": "BlockIP-CiscoFirepower Playbook with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion3')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "BlockIP-CiscoFirepower",
              "type": "String",
              "metadata": {
                "description": "Name of the Logic Apps resource to be created"
              }
            },
            "Cisco Firepower Connector name": {
              "defaultValue": "CiscoFirepowerConnector",
              "type": "String",
              "metadata": {
                "description": "Cisco Firepower Connector name"
              }
            },
            "Network Group object name": {
              "type": "String",
              "metadata": {
                "description": "Network Group object name"
              }
            }
          },
          "variables": {
            "AzureSentinelConnectionName": "[[concat('azuresentinel-', parameters('PlaybookName'))]",
            "CiscoFirepowerConnectionName": "[[concat('ciscofirepowerconnector-', parameters('PlaybookName'))]",
            "defaultValue": "",
            "_defaultValue": "[[variables('defaultValue')]",
            "connection-1": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-1": "[[variables('connection-1')]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('Cisco Firepower Connector name'))]",
            "_connection-2": "[[variables('connection-2')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('AzureSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('AzureSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-1')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('CiscoFirepowerConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('CiscoFirepowerConnectionName'))]"
              ],
              "tags": {
                "hidden-SentinelTemplateName": "BlockIP-CiscoFirepower",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "properties": {
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    },
                    "Network Group object name": {
                      "defaultValue": "[[variables('_defaultValue')]",
                      "type": "String"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Entities_-_Get_IPs": {
                      "type": "ApiConnection",
                      "inputs": {
                        "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/entities/ip"
                      }
                    },
                    "Entities_has_any_IPs": {
                      "runAfter": {
                        "Entities_-_Get_IPs": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Add_comment_to_incident_(V3):_No_IPs_found": {
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "incidentArmId": "@triggerBody()?['object']?['id']",
                                "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\nThe incident did not have any entities with IPs.</p>"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/Incidents/Comment"
                            }
                          },
                          "Terminate": {
                            "runAfter": {
                              "Add_comment_to_incident_(V3):_No_IPs_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "Terminate",
                            "inputs": {
                              "runStatus": "Cancelled"
                            },
                            "description": "Since we don't have any IPs, all other actions can be skipped."
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Entities_-_Get_IPs')?['IPs'])",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "If the Entities does not have any IPs for this incident, we terminate the Logic App"
                    },
                    "Filter_Network_group_object_items_array": {
                      "runAfter": {
                        "If_Network_group_object_items_array_is_null": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Retrieves_list_of_all_network_group_objects')?['items']",
                        "where": "@equals(item()?['name'], variables('Network Group object name'))"
                      },
                      "description": "The filter with nameOrValue will also return items that start with the name, for example the 'Network Group object name' is 'TEST' and there is a network group object named 'TEST_2' that will also be returned."
                    },
                    "Found_the_network_group_object_by_name": {
                      "actions": {
                        "Add_comment_to_incident_(V3)": {
                          "runAfter": {
                            "Modifies_the_network_group_object_associated_with_the_specified_ID": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\n<span style=\"font-size: 14px\">The following IPs were found in the Incident:<br>\n</span><span style=\"font-size: 14px\">@{variables('ipAddressesActionComment')}</span><span style=\"font-size: 14px\"></span></p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          }
                        },
                        "For_each_over_IPs": {
                          "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
                          "actions": {
                            "Filter_Network_Group_Object_Literals_with_IP_array": {
                              "type": "Query",
                              "inputs": {
                                "from": "@variables('Network Group Object Literals')",
                                "where": "@and(equals(item()?['type'], 'Host'), equals(item()?['value'], items('For_each_over_IPs')?['Address']))"
                              }
                            },
                            "If_Network_Group_Object_Literals_contains_IP": {
                              "actions": {
                                "Append_to_string_variable_2": {
                                  "type": "AppendToStringVariable",
                                  "inputs": {
                                    "name": "ipAddressesActionComment",
                                    "value": "@{items('For_each_over_IPs')?['Address']} - is already blocked in Cisco Firepower"
                                  }
                                }
                              },
                              "runAfter": {
                                "Filter_Network_Group_Object_Literals_with_IP_array": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Append_to_array_variable": {
                                    "type": "AppendToArrayVariable",
                                    "inputs": {
                                      "name": "Network Group Object Literals",
                                      "value": {
                                        "type": "Host",
                                        "value": "@{items('For_each_over_IPs')?['Address']}"
                                      }
                                    }
                                  },
                                  "Append_to_string_variable": {
                                    "runAfter": {
                                      "Append_to_array_variable": [
                                        "Succeeded"
                                      ]
                                    },
                                    "type": "AppendToStringVariable",
                                    "inputs": {
                                      "name": "ipAddressesActionComment",
                                      "value": "@{items('For_each_over_IPs')?['Address']} - blocked in Cisco Firepower\n"
                                    }
                                  }
                                }
                              },
                              "expression": {
                                "and": [
                                  {
                                    "greater": [
                                      "@length(body('Filter_Network_Group_Object_Literals_with_IP_array'))",
                                      0
                                    ]
                                  }
                                ]
                              },
                              "type": "If"
                            }
                          },
                          "runAfter": {
                            "Set_Network_Group_Object_Literals_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach"
                        },
                        "Modifies_the_network_group_object_associated_with_the_specified_ID": {
                          "runAfter": {
                            "For_each_over_IPs": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "description": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['description']",
                              "id": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['id']",
                              "literals": "@variables('Network Group Object Literals')",
                              "name": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['name']",
                              "objects": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['objects']",
                              "overridable": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['overridable']",
                              "type": "NetworkGroup"
                            },
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['id'])}"
                          }
                        },
                        "Retrieves_the_network_group_object_associated_with_the_specified_ID": {
                          "runAfter": {
                            "Set_Network_Group_Object_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "get",
                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(variables('Network Group Object')?['id'])}"
                          }
                        },
                        "Set_Network_Group_Object_Literals_variable": {
                          "runAfter": {
                            "Retrieves_the_network_group_object_associated_with_the_specified_ID": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Network Group Object Literals",
                            "value": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['literals']"
                          }
                        },
                        "Set_Network_Group_Object_variable": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Network Group Object",
                            "value": "@body('Filter_Network_group_object_items_array')[0]"
                          }
                        },
                        "Update_incident": {
                          "runAfter": {
                            "Add_comment_to_incident_(V3)": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "classification": {
                                "ClassificationAndReason": "True Positive - Suspicious Activity",
                                "ClassificationReasonText": "IPs in incident automaticly blocked"
                              },
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "status": "Closed"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/Incidents"
                          }
                        }
                      },
                      "runAfter": {
                        "Filter_Network_group_object_items_array": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Add_comment_to_incident_(V3):_Network_Group_object_not_found": {
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "incidentArmId": "@triggerBody()?['object']?['id']",
                                "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary<br>\n</strong></span><span style=\"font-size: 12px\">We could not find the Network Group object with name: '</span><span style=\"font-size: 12px\">@{variables('Network Group object name')}</span><span style=\"font-size: 12px\">'</span></p>"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/Incidents/Comment"
                            }
                          },
                          "Revoke_access:_Network_Group_object_not_found": {
                            "runAfter": {
                              "Add_comment_to_incident_(V3):_Network_Group_object_not_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                              "headers": {
                                "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['CiscoFirepowerConnector']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/api/fmc_platform/v1/auth/revokeaccess"
                            }
                          },
                          "Terminate:_Network_Group_object_not_found": {
                            "runAfter": {
                              "Revoke_access:_Network_Group_object_not_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "Terminate",
                            "inputs": {
                              "runError": {
                                "message": "Network Group object not found"
                              },
                              "runStatus": "Failed"
                            }
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Filter_Network_group_object_items_array'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Generate_token": {
                      "runAfter": {
                        "Initialize_Network_Group_Object_Literals_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/api/fmc_platform/v1/auth/generatetoken"
                      }
                    },
                    "If_Network_group_object_items_array_is_null": {
                      "actions": {
                        "Add_comment_to_incident_(V3):_Network_Group_object_not_found_2": {
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\nWe could not find the Network Group object with name: '@{variables('Network Group object name')}'</p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel_1']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          }
                        },
                        "Revoke_access:_Network_Group_object_not_found_2": {
                          "runAfter": {
                            "Add_comment_to_incident_(V3):_Network_Group_object_not_found_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['CiscoFirepowerConnector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/fmc_platform/v1/auth/revokeaccess"
                          }
                        },
                        "Terminate:_Network_Group_object_not_found_2": {
                          "runAfter": {
                            "Revoke_access:_Network_Group_object_not_found_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "Terminate",
                          "inputs": {
                            "runError": {
                              "message": "Network Group object not found"
                            },
                            "runStatus": "Failed"
                          }
                        }
                      },
                      "runAfter": {
                        "Retrieves_list_of_all_network_group_objects": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@body('Retrieves_list_of_all_network_group_objects')?['items']",
                              "@null"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Initialize_Network_Group_Object_Literals_variable": {
                      "runAfter": {
                        "Initialize_Network_Group_Object_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group Object Literals",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Initialize_Network_Group_Object_name_variable": {
                      "runAfter": {
                        "Entities_has_any_IPs": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group object name",
                            "type": "string",
                            "value": "@parameters('Network Group object name')"
                          }
                        ]
                      }
                    },
                    "Initialize_Network_Group_Object_variable": {
                      "runAfter": {
                        "Initialize_ipAddressesActionComment_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group Object",
                            "type": "object"
                          }
                        ]
                      }
                    },
                    "Initialize_ipAddressesActionComment_variable": {
                      "runAfter": {
                        "Initialize_Network_Group_Object_name_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "ipAddressesActionComment",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Retrieves_list_of_all_network_group_objects": {
                      "runAfter": {
                        "Generate_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups",
                        "queries": {
                          "filter": "nameOrValue:@{variables('Network Group object name')}"
                        }
                      }
                    },
                    "Revoke_access": {
                      "runAfter": {
                        "Found_the_network_group_object_by_name": [
                          "Succeeded",
                          "Failed",
                          "Skipped",
                          "TimedOut"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/api/fmc_platform/v1/auth/revokeaccess"
                      }
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                        "connectionName": "[[variables('AzureSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      },
                      "Cisco-Firepower-connector": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('CiscoFirepowerConnectionName'))]",
                        "connectionName": "[[variables('CiscoFirepowerConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('Cisco Firepower Connector name'))]"
                      }
                    }
                  },
                  "Network Group object name": {
                    "value": "[[parameters('Network Group object name')]"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId3'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId3')]",
                "contentId": "[variables('_playbookContentId3')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cisco Firepower EStreamer",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cisco"
                },
                "support": {
                  "name": "Cisco",
                  "tier": "Partner",
                  "link": "https://www.cisco.com/c/en_in/support/index.html"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "kind": "LogicAppsCustomConnector",
                      "contentId": "[variables('_CiscoFirepowerConnector')]",
                      "version": "[variables('playbookVersion1')]"
                    }
                  ]
                }
              }
            }
          ],
          "metadata": {
            "title": "Block IP - Cisco Firepower",
            "description": "This playbook allows blocking of IPs in Cisco Firepower, using a **Network Group object**. This allows making changes to a Network Group selected members, instead of making Access List Entries. The Network Group object itself should be part of an Access List Entry.",
            "mainSteps": [
              "When a new Microsoft Sentinel incident is created, this playbook gets triggered and performs below actions.",
              "1. For the IPs we check if they are already selected for the Network Group object",
              "2. For the IPs not already selected for the Network Group object, add it so it gets blocked",
              "3. Comment is added to Microsoft Sentinel incident",
              "![Microsoft Sentinel comment](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20Firepower%20EStreamer/Playbooks/CiscoFirepower-BlockFQDN-NetworkGroup/Images/BlockFQDN-NetworkGroup-AzureSentinel-Comments.png)",
              "** IP is added to Cisco Firepower Network Group object:**",
              "![Cisco Firepower Network Group object](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20Firepower%20EStreamer/Playbooks/CiscoFirepower-BlockFQDN-NetworkGroup/Images/BlockFQDN-NetworkGroup-CiscoFirepowerAdd.png)"
            ],
            "prerequisites": [
              "1. Cisco Firepower custom connector needs to be deployed prior to the deployment of this playbook, in the same resource group and region. Relevant instructions can be found in the connector doc pages.",
              "2. In Cisco Firepower there needs to be a Network Group object. [Creating Network Objects](https://www.cisco.com/c/en/us/td/docs/security/firepower/630/configuration/guide/fpmc-config-guide-v63/reusable_objects.html#ariaid-title15)"
            ],
            "postDeployment": [
              "**a. Authorize connections**",
              "Once deployment is complete, you will need to authorize each connection.",
              "1. Click the Microsoft Sentinel connection resource",
              "2. Click edit API connection",
              "3. Click Authorize",
              "4. Sign in",
              "5. Click Save",
              "6. Repeat steps for other connections such as Cisco Firepower (For authorizing the Cisco Firepower API connection, the username and password needs to be provided)",
              "**b. Configurations in Microsoft Sentinel**",
              "1. In Microsoft Sentinel analytical rules should be configured to trigger an incident with IP Entity.",
              "2. Configure the automation rules to trigger this playbook"
            ],
            "lastUpdateTime": "2022-07-20T00:00:00Z",
            "entities": [
              "Ip"
            ],
            "tags": [
              "Remediation"
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Block IP - Cisco Firepower",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('playbookTemplateSpecName4')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Playbook"
      },
      "properties": {
        "description": "CiscoFirepower-BlockIP-Teams playbook",
        "displayName": "CiscoFirepower-BlockIP-Teams playbook"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('playbookTemplateSpecName4'),'/',variables('playbookVersion4'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Playbook"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('playbookTemplateSpecName4'))]"
      ],
      "properties": {
        "description": "CiscoFirepower-BlockIP-Teams Playbook with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion4')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "CiscoFirepower-BlockIP-Teams",
              "type": "String",
              "metadata": {
                "description": "Name of the Logic Apps resource to be created"
              }
            },
            "Cisco Firepower Connector name": {
              "defaultValue": "CiscoFirepowerConnector",
              "type": "String",
              "metadata": {
                "description": "Cisco Firepower Connector name"
              }
            },
            "Network Group object name": {
              "type": "String",
              "metadata": {
                "description": "Network Group object name"
              }
            }
          },
          "variables": {
            "AzureSentinelConnectionName": "[[concat('azuresentinel-', parameters('PlaybookName'))]",
            "TeamsConnectionName": "[[concat('teamsconnector-', parameters('PlaybookName'))]",
            "CiscoFirepowerConnectionName": "[[concat('ciscofirepowerconnector-', parameters('PlaybookName'))]",
            "defaultValue": "",
            "_defaultValue": "[[variables('defaultValue')]",
            "connection-1": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-1": "[[variables('connection-1')]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/teams')]",
            "_connection-2": "[[variables('connection-2')]",
            "connection-3": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('Cisco Firepower Connector name'))]",
            "_connection-3": "[[variables('connection-3')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('AzureSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('AzureSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-1')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('TeamsConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('CiscoFirepowerConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "api": {
                  "id": "[[variables('_connection-3')]"
                }
              }
            },
            {
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('TeamsConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('CiscoFirepowerConnectionName'))]"
              ],
              "tags": {
                "LogicAppsCategory": "security",
                "hidden-SentinelTemplateName": "BlockIP-Firepower-Teams",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "properties": {
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    },
                    "Network Group object name": {
                      "defaultValue": "[[variables('_defaultValue')]",
                      "type": "String"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Entities_-_Get_IPs": {
                      "type": "ApiConnection",
                      "inputs": {
                        "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/entities/ip"
                      }
                    },
                    "Entities_has_any_IPs": {
                      "runAfter": {
                        "Entities_-_Get_IPs": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Add_comment_to_incident_(V3):_No_IPs_found": {
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "incidentArmId": "@triggerBody()?['object']?['id']",
                                "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\nThe incident did not have any entities with IPs.</p>"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/Incidents/Comment"
                            }
                          },
                          "Terminate:_No_IPs_found": {
                            "runAfter": {
                              "Add_comment_to_incident_(V3):_No_IPs_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "Terminate",
                            "inputs": {
                              "runStatus": "Cancelled"
                            },
                            "description": "Since we don't have any IPs, all other actions can be skipped."
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Entities_-_Get_IPs')?['IPs'])",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If",
                      "description": "If the Entities does not have any IPs for this incident, we terminate the Logic App"
                    },
                    "Filter_Network_group_object_items_array": {
                      "runAfter": {
                        "If_Network_group_object_items_array_is_null": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Retrieves_list_of_all_network_group_objects')?['items']",
                        "where": "@equals(item()?['name'], variables('Network Group object name'))"
                      },
                      "description": "The filter with nameOrValue will also return items that start with the name, for example the 'Network Group object name' is 'TEST' and there is a network group object named 'TEST_2' that will also be returned."
                    },
                    "For_each_over_IPs": {
                      "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
                      "actions": {
                        "Append_to_ipAddresses_variable": {
                          "runAfter": {
                            "If_Network_Group_Object_Literals_contains_IP": [
                              "Succeeded"
                            ]
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "ipAddresses",
                            "value": {
                              "IPAddress": "@{items('For_each_over_IPs')?['Address']}",
                              "controlName": "ipAddressAction@{variables('forEachIndex')}",
                              "existsInNetworkGroupObject": "@if(greater(length(body('Filter_Network_Group_Object_Literals_with_IP_array')), 0), true, false)"
                            }
                          }
                        },
                        "Filter_Network_Group_Object_Literals_with_IP_array": {
                          "type": "Query",
                          "inputs": {
                            "from": "@variables('Network Group Object Literals')",
                            "where": "@and(equals(item()?['type'], 'Host'), equals(item()?['value'], items('For_each_over_IPs')?['Address']))"
                          }
                        },
                        "If_Network_Group_Object_Literals_contains_IP": {
                          "actions": {
                            "Append_to_adaptiveCardIPAddressItems_variable_remove_block": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "adaptiveCardIPAddressItems",
                                "value": {
                                  "columns": [
                                    {
                                      "items": [
                                        {
                                          "text": "Unblock '@{items('For_each_over_IPs')?['Address']}'?",
                                          "type": "TextBlock",
                                          "wrap": true
                                        }
                                      ],
                                      "type": "Column",
                                      "width": "stretch"
                                    },
                                    {
                                      "items": [
                                        {
                                          "choices": [
                                            {
                                              "title": "Ignore",
                                              "value": "ignore"
                                            },
                                            {
                                              "title": "Unblock",
                                              "value": "unblock"
                                            }
                                          ],
                                          "id": "ipAddressAction@{variables('forEachIndex')}",
                                          "placeholder": "Placeholder text",
                                          "type": "Input.ChoiceSet",
                                          "value": "ignore"
                                        }
                                      ],
                                      "type": "Column",
                                      "width": "stretch"
                                    }
                                  ],
                                  "type": "ColumnSet"
                                }
                              }
                            }
                          },
                          "runAfter": {
                            "Filter_Network_Group_Object_Literals_with_IP_array": [
                              "Succeeded"
                            ]
                          },
                          "else": {
                            "actions": {
                              "Append_to_adaptiveCardIPAddressItems_variable_add_block": {
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "adaptiveCardIPAddressItems",
                                  "value": {
                                    "columns": [
                                      {
                                        "items": [
                                          {
                                            "text": "Block '@{items('For_each_over_IPs')?['Address']}'?",
                                            "type": "TextBlock",
                                            "wrap": true
                                          }
                                        ],
                                        "type": "Column",
                                        "width": "stretch"
                                      },
                                      {
                                        "items": [
                                          {
                                            "choices": [
                                              {
                                                "title": "Ignore",
                                                "value": "ignore"
                                              },
                                              {
                                                "title": "Block",
                                                "value": "block"
                                              }
                                            ],
                                            "id": "ipAddressAction@{variables('forEachIndex')}",
                                            "placeholder": "Placeholder text",
                                            "type": "Input.ChoiceSet",
                                            "value": "ignore"
                                          }
                                        ],
                                        "type": "Column",
                                        "width": "stretch"
                                      }
                                    ],
                                    "type": "ColumnSet"
                                  }
                                }
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "greater": [
                                  "@length(body('Filter_Network_Group_Object_Literals_with_IP_array'))",
                                  0
                                ]
                              }
                            ]
                          },
                          "type": "If"
                        },
                        "Increment_variable": {
                          "runAfter": {
                            "Append_to_ipAddresses_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "IncrementVariable",
                          "inputs": {
                            "name": "forEachIndex",
                            "value": 1
                          }
                        }
                      },
                      "runAfter": {
                        "Initialize_and_set_Network_Group_Object_Literals_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach",
                      "runtimeConfiguration": {
                        "concurrency": {
                          "repetitions": 1
                        }
                      }
                    },
                    "Found_the_network_group_object_by_name": {
                      "runAfter": {
                        "Filter_Network_group_object_items_array": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Add_comment_to_incident_(V3):_Network_Group_object_not_found": {
                            "type": "ApiConnection",
                            "inputs": {
                              "body": {
                                "incidentArmId": "@triggerBody()?['object']?['id']",
                                "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary<br>\n</strong></span><span style=\"font-size: 12px\">We could not find the Network Group object with name: '</span><span style=\"font-size: 12px\">@{variables('Network Group object name')}</span><span style=\"font-size: 12px\">'</span></p>"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/Incidents/Comment"
                            }
                          },
                          "Revoke_access:_Network_Group_object_not_found": {
                            "runAfter": {
                              "Add_comment_to_incident_(V3):_Network_Group_object_not_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                              "headers": {
                                "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                              },
                              "host": {
                                "connection": {
                                  "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                                }
                              },
                              "method": "post",
                              "path": "/api/fmc_platform/v1/auth/revokeaccess"
                            }
                          },
                          "Terminate:_Network_Group_object_not_found": {
                            "runAfter": {
                              "Revoke_access:_Network_Group_object_not_found": [
                                "Succeeded"
                              ]
                            },
                            "type": "Terminate",
                            "inputs": {
                              "runError": {
                                "message": "Network Group object not found"
                              },
                              "runStatus": "Failed"
                            }
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(body('Filter_Network_group_object_items_array'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Generate_token": {
                      "runAfter": {
                        "Initialize_ipAddressesActionComment_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/api/fmc_platform/v1/auth/generatetoken"
                      }
                    },
                    "If_Network_group_object_items_array_is_null": {
                      "actions": {
                        "Add_comment_to_incident_(V3):_Network_Group_object_not_found_2": {
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\nWe could not find the Network Group object with name: '@{variables('Network Group object name')}'</p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          }
                        },
                        "Revoke_access:_Network_Group_object_not_found_2": {
                          "runAfter": {
                            "Add_comment_to_incident_(V3):_Network_Group_object_not_found_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['CiscoFirepowerConnector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/fmc_platform/v1/auth/revokeaccess"
                          }
                        },
                        "Terminate:_Network_Group_object_not_found_2": {
                          "runAfter": {
                            "Revoke_access:_Network_Group_object_not_found_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "Terminate",
                          "inputs": {
                            "runError": {
                              "message": "Network Group object not found"
                            },
                            "runStatus": "Failed"
                          }
                        }
                      },
                      "runAfter": {
                        "Retrieves_list_of_all_network_group_objects": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "",
                              ""
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "If_PostToTeams_submit_action_is_Submit": {
                      "actions": {
                        "Add_comment_to_incident_(V3)": {
                          "runAfter": {
                            "Revoke_access_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p><span style=\"font-size: 16px\"><strong>Cisco Firepower playbook run summary</strong></span><br>\n<span style=\"font-size: 14px\">The following IPs were found in the Incident:<br>\n</span><span style=\"font-size: 14px\">@{variables('ipAddressesActionComment')}</span><span style=\"font-size: 14px\"></span></p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          }
                        },
                        "For_each_over_ipAddresses": {
                          "foreach": "@variables('ipAddresses')",
                          "actions": {
                            "Switch": {
                              "cases": {
                                "Case_block": {
                                  "case": "block",
                                  "actions": {
                                    "Filter_Network_Group_Object_Literals_with_IP_for_block": {
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Network Group Object Literals')",
                                        "where": "@and(equals(item()?['type'], 'Host'), equals(item()?['value'], items('For_each_over_IPAddresses')?['IPAddress']))"
                                      }
                                    },
                                    "If_Network_Group_Object_Literals_contains_IP_for_block": {
                                      "actions": {
                                        "Append_to_ipAddressesActionComment_already_blocked": {
                                          "type": "AppendToStringVariable",
                                          "inputs": {
                                            "name": "ipAddressesActionComment",
                                            "value": "@{items('For_each_over_IPAddresses')?['IPAddress']} - is already blocked in Cisco Firepower"
                                          }
                                        }
                                      },
                                      "runAfter": {
                                        "Filter_Network_Group_Object_Literals_with_IP_for_block": [
                                          "Succeeded"
                                        ]
                                      },
                                      "else": {
                                        "actions": {
                                          "Append_to_Network_Group_Object_Literals_item_to_block": {
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Network Group Object Literals",
                                              "value": {
                                                "type": "Host",
                                                "value": "@{items('For_each_over_IPAddresses')?['IPAddress']}"
                                              }
                                            }
                                          },
                                          "Append_to_ipAddressesActionComment_blocked": {
                                            "runAfter": {
                                              "Append_to_Network_Group_Object_Literals_item_to_block": [
                                                "Succeeded"
                                              ]
                                            },
                                            "type": "AppendToStringVariable",
                                            "inputs": {
                                              "name": "ipAddressesActionComment",
                                              "value": "@{items('For_each_over_IPAddresses')?['IPAddress']} - blocked in Cisco Firepower"
                                            }
                                          }
                                        }
                                      },
                                      "expression": {
                                        "and": [
                                          {
                                            "greater": [
                                              "@length(body('Filter_Network_Group_Object_Literals_with_IP_for_block'))",
                                              0
                                            ]
                                          }
                                        ]
                                      },
                                      "type": "If"
                                    }
                                  }
                                },
                                "Case_unblock": {
                                  "case": "unblock",
                                  "actions": {
                                    "Append_to_ipAddressesActionComment_unblocked": {
                                      "runAfter": {
                                        "Set_Network_Group_Object_Literals_with_filtered_to_unblock": [
                                          "Succeeded"
                                        ]
                                      },
                                      "type": "AppendToStringVariable",
                                      "inputs": {
                                        "name": "ipAddressesActionComment",
                                        "value": "@{items('For_each_over_IPAddresses')?['IPAddress']} - unblocked in Cisco Firepower"
                                      }
                                    },
                                    "Filter_Network_Group_Object_Literals_to_unblock": {
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Network Group Object Literals')",
                                        "where": "@not(and(equals(item()?['type'], 'Host'), equals(item()?['value'], items('For_each_over_IPAddresses')?['IPAddress'])))"
                                      }
                                    },
                                    "Set_Network_Group_Object_Literals_with_filtered_to_unblock": {
                                      "runAfter": {
                                        "Filter_Network_Group_Object_Literals_to_unblock": [
                                          "Succeeded"
                                        ]
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Network Group Object Literals",
                                        "value": "@body('Filter_Network_Group_Object_Literals_to_unblock')"
                                      }
                                    }
                                  }
                                }
                              },
                              "default": {
                                "actions": {
                                  "Append_no_action_taken_comment_to_ipAddressActionComment": {
                                    "type": "AppendToStringVariable",
                                    "inputs": {
                                      "name": "ipAddressesActionComment",
                                      "value": "@{items('For_each_over_ipAddresses')['IPAddress']} - no action taken in Cisco Firepower\n"
                                    }
                                  }
                                }
                              },
                              "expression": "@outputs('PostToTeams')['body']['data'][item()['controlName']]",
                              "type": "Switch"
                            }
                          },
                          "runAfter": {
                            "Set_Network_Group_Object_Literals_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "Foreach"
                        },
                        "Generate_token_2": {
                          "type": "ApiConnection",
                          "inputs": {
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/fmc_platform/v1/auth/generatetoken"
                          }
                        },
                        "Modifies_the_network_group_object_associated_with_the_specified_ID": {
                          "runAfter": {
                            "For_each_over_ipAddresses": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "description": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['description']",
                              "id": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['id']",
                              "literals": "@variables('Network Group Object Literals')",
                              "name": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['name']",
                              "objects": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['objects']",
                              "overridable": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['overridable']",
                              "type": "NetworkGroup"
                            },
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token_2')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token_2')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['id'])}"
                          }
                        },
                        "Retrieves_the_network_group_object_associated_with_the_specified_ID_2": {
                          "runAfter": {
                            "Generate_token_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token_2')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "get",
                            "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token_2')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(variables('Network Group Object')?['id'])}"
                          }
                        },
                        "Revoke_access_2": {
                          "runAfter": {
                            "Modifies_the_network_group_object_associated_with_the_specified_ID": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "headers": {
                              "X-auth-access-token": "@outputs('Generate_token_2')['headers']['X-auth-access-token']"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/api/fmc_platform/v1/auth/revokeaccess"
                          }
                        },
                        "Set_Network_Group_Object_Literals_variable": {
                          "runAfter": {
                            "Retrieves_the_network_group_object_associated_with_the_specified_ID_2": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Network Group Object Literals",
                            "value": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID_2')?['literals']"
                          }
                        },
                        "Update_incident": {
                          "runAfter": {
                            "Add_comment_to_incident_(V3)": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "classification": {
                                "ClassificationAndReason": "@{body('PostToTeams')['data']['incidentStatus']}"
                              },
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "severity": "@{body('PostToTeams')['data']['incidentSeverity']}",
                              "status": "Closed"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/Incidents"
                          }
                        }
                      },
                      "runAfter": {
                        "PostToTeams": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@body('PostToTeams')['submitActionId']",
                              "Submit"
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Initialize_Adaptive_Card_IP_Address_variable": {
                      "runAfter": {
                        "Initialize_ipAddresses_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "adaptiveCardIPAddressItems",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Initialize_For_Each_index_variable": {
                      "runAfter": {
                        "Initialize_Adaptive_Card_IP_Address_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "forEachIndex",
                            "type": "integer",
                            "value": 0
                          }
                        ]
                      }
                    },
                    "Initialize_Network_Group_Object_name_variable": {
                      "runAfter": {
                        "Entities_has_any_IPs": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group object name",
                            "type": "string",
                            "value": "@parameters('Network Group object name')"
                          }
                        ]
                      }
                    },
                    "Initialize_and_set_Network_Group_Object_Literals_variable": {
                      "runAfter": {
                        "Revoke_access": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group Object Literals",
                            "type": "array",
                            "value": "@body('Retrieves_the_network_group_object_associated_with_the_specified_ID')?['literals']"
                          }
                        ]
                      }
                    },
                    "Initialize_and_set_Network_Group_Object_variable": {
                      "runAfter": {
                        "Found_the_network_group_object_by_name": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Network Group Object",
                            "type": "object",
                            "value": "@body('Filter_Network_group_object_items_array')[0]"
                          }
                        ]
                      }
                    },
                    "Initialize_ipAddressesActionComment_variable": {
                      "runAfter": {
                        "Initialize_For_Each_index_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "ipAddressesActionComment",
                            "type": "string"
                          }
                        ]
                      }
                    },
                    "Initialize_ipAddresses_variable": {
                      "runAfter": {
                        "Initialize_Network_Group_Object_name_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "ipAddresses",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "PostToTeams": {
                      "runAfter": {
                        "For_each_over_IPs": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "body": {
                            "messageBody": "{\n    \"type\": \"AdaptiveCard\",\n    \"body\": [\n        {\n            \"type\": \"TextBlock\",\n            \"size\": \"Large\",\n            \"weight\": \"Bolder\",\n            \"text\": \"Suspicious IP - Microsoft Sentinel\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"@{triggerBody()?['object']?['properties']?['severity']} incident @{triggerBody()?['object']?['properties']?['title']}\",\n            \"wrap\": true,\n            \"weight\": \"Bolder\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Incident description\",\n            \"wrap\": true,\n            \"weight\": \"Bolder\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"@{triggerBody()?['object']?['properties']?['description']}\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Alert product names\",\n            \"wrap\": true,\n            \"weight\": \"Bolder\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"@{join(triggerBody()?['object']?['properties']?['additionalData']?['alertProductNames'], ', ')}\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"[Click here to view the Incident](@{triggerBody()?['object']?['properties']?['incidentUrl']})\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"size\": \"Medium\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"Incident configuration:\",\n                            \"wrap\": true\n                        }\n                    ],\n                    \"width\": \"auto\"\n                }\n            ]\n        },\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"style\": \"Person\",\n                            \"url\": \"https://connectoricons-prod.azureedge.net/releases/v1.0.1391/1.0.1391.2130/azuresentinel/icon.png\",\n                            \"size\": \"Small\"\n                        }\n                    ],\n                    \"width\": \"auto\"\n                }\n            ]\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Close Microsoft Sentinel incident?\"\n        },\n        {\n            \"choices\": [\n                {\n                    \"title\": \"False Positive - Inaccurate Data\",\n                    \"value\": \"False Positive - Inaccurate Data\"\n                },\n                {\n                    \"title\": \"False Positive - Incorrect Alert Logic\",\n                    \"value\": \"False Positive - Incorrect Alert Logic\"\n                },\n                {\n                    \"title\": \"True Positive - Suspicious Activity\",\n                    \"value\": \"True Positive - Suspicious Activity\"\n                },\n                {\n                    \"title\": \"Benign Positive - Suspicious But Expected\",\n                    \"value\": \"Benign Positive - Suspicious But Expected\"\n                },\n                {\n                    \"title\": \"Undetermined\",\n                    \"value\": \"Undetermined\"\n                }\n            ],\n            \"id\": \"incidentStatus\",\n            \"style\": \"compact\",\n            \"type\": \"Input.ChoiceSet\",\n            \"value\": \"Benign Positive - Suspicious But Expected\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Change Microsoft Sentinel Incident Severity?\"\n        },\n        {\n            \"choices\": [\n                {\n                    \"title\": \"High\",\n                    \"value\": \"High\"\n                },\n                {\n                    \"title\": \"Medium\",\n                    \"value\": \"Medium\"\n                },\n                {\n                    \"title\": \"Low\",\n                    \"value\": \"Low\"\n                },\n                {\n                    \"title\": \"Informational\",\n                    \"value\": \"Informational\"\n                }\n            ],\n            \"id\": \"incidentSeverity\",\n            \"style\": \"compact\",\n            \"type\": \"Input.ChoiceSet\",\n            \"value\": \"@{triggerBody()?['object']?['properties']?['severity']}\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Cisco Firepower Actions\",\n            \"weight\": \"Bolder\"\n        },\n        {\n            \"type\": \"Image\",\n            \"url\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAAkCAYAAAAw55zoAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAiLSURBVGhD7VkJcF1VGf7efdmTtklem61Jq03bpIUWyyKabgRwpoJOh2EUtIPVgsuIC1NmQIo4biPMIIhaprZFFEVL6zbjMK0KxTRFKnXoCKVpkqYJSbO+bC/be9nei99/7klzeUveckOd6fDNvLybc885/3/+8+/PMUXABtq9k7jpyAVsKEjH/vUFevTSYvPhFsghqm9ZYg7YgKG/E8aO452o7RnFM2/04M2+MT166fCTM/2obhrC8aZh/Ph0nx5NHLYFkmQ4ACc/yQbGA7aULSGQsjDBjwMBNWIPtgXiUByZsDxeOswxfdsCudwQk0Be6/JhwoY5nOodhWfcr/+LH3UD42gbmdT/xY/WkQm1RyyIKpCdJ91Yf6ABKXtq9Eh8ePpsP675zTnk7DmLwQSE8rfWEZQ/W4fifWdjPpQVb/ePoWRfrdrjCPeKhqgCebVrFMhKVs+JMFTd6TXXpxj4l9unR2PHsU6uyUwC0pNQ1RH9QME4LvS5VvY42j4HAkmVKCKg96QjjxspEoE0kqf3igMpF+lzvdWDxwhFXy+7uNcsUAI5HWv+ED8/MeECbdw3GUPQfI/oC23hQWA8/EY31j5XDwdt9P+BvzQPYcneWmTsPoPescQdb6Jw+yYVbeHhaLsXxnHxEfNp4+MBuEcT9+SJQpwmsmjjqc6YbHyucbSDPoa0hYeXSd+w+ghnAjZqF6aP4Ye0Y7HxuYaiqc5N+pSLEVBlkWAK4cq8mfd8TiAVse4Zbn9S1U+yf+gEK/1EylDrmnD8B/NnqIFJ/qHJZCWH3pAakfe07yypGeKEIdKfoMPk/ulh1juFgjhU5ihpztD3iiW93hqxYoWKbFwreySHWZ8qoVPyI/IgvBq/3VSI8kVpePzmxWEZ+mNlEa7IT8MjmwtRmEFbjxP7KvJxbXEmvnjtQmzIT9ejM3jq+nxULMnCtqtcuKUkS4/O4DvrFuKGZfNw2+ps3LV8gR6NHdtXLMDWVdm4cdl8/ODqhXp0Bp8kzTvX5mL90ix8l7Rs90NufakNhxkp5AZOfuqDuG5h6KHfS0j5v/PVTvX8WEUeHlzjUs+JIn4bCEKq7CAqSZPKTqZXusTInFZ5MfkETDoYtjVk1B/AbUfbsbEgHbvW2rudRCFNKnHIv6b524VtgVxusK9jlxneF0gQ3hdIEOLyIX9n3dHFeieXuX9FXrr6tqJn1E9nP6UcnOQskUqBl9pG0MGiKpu58hXZKSidn6LfhMcAo0hVp081mArSk1BZlIGkCHsLvEyyXmah5mHkW8Y6bUN+hn4THTEJpPLIBVSdG1CddZX3y5KRSdTcU4ZV2al6FlD2p0bUt7FYYgh8a8dKrMlN029MPPZWLx46xpxBQqU6EPfx+fHExxZj55W55iQL2liSbzx8AU3S5BHaktUKbe8kpu5fa06yoI8CqHixBXVSJEoIFhqSr/NzLxPD3R/J1zMjY1aTGWSy5dhTgypqhnOe2fVSPzkIsTRnSDHmEo2RbJaf4Hd/fmcID1V1wJDKVtYLo35+OC1c4+eE24fiX9ahaWAcTum4yRrhVr6lAxYE6ea59teirn/MnC8CFF7Jp5GZhKf/24uiFxr07MgQEhFRcIAbUAhO3qifN7kqJxXfWJOL7WVMoUnQKweKEd8jQyKoAOuibSsXwEPtGvrSKrxyRyk2FYaqdMUfGuHgwQweyu/1YzPN5D6m97eXzg9bpZULr9zfIfPJ6w2LWS4w3c+jQAJjAThTk9DhmcC2Yx16RXhENJm/tgxjK9XPme5UBA5uKcanWQ9YMUnG1A9VGhUvNuOE9EBpMrWfLUWZxZyKXzhvds5p389UFuLuldn6TSge+E83Hj/VA4OXEaBfati2PMTPCNsOrVmPvtmLXSfc0stQ81vuWoES3QcW3H/SjSdP9VIoBvzDNLevr+ZoqFYKImrIgUbWJ9QCP7VACp9gYQiswoiGm3jDUu84ech7XmlH3u8b8AgPHQ6HmkibphHg/G9dtyis050WhuB3jYNid2r+o+vz3yUMwRMfzkMWzUYpNOeps0VARIG0SI9RaFILPlGSaQ7awHNMqzOp0n7eIOtwdFPrfkhNcOw+o34qsOIibZ5gCyvlaGgeouaJgNT80IpZsJUVtemzHGgYNPun4RBRIDniQEWi3OAdITgHGP7cCvx8cyHyMuh8Gb7FJMTu1xxq1DNMSDhWoAa2UMWjQYX/i7yGP+x5GddKpQrCCIgokE0FVHFqh8HFe9+2/6v6NL62Ogddn1mO9i+UUcW5v/BGv1LrmdGSjdI3kdukyd73uluPRsaNRTPzv/qa2QqwomV4Av9uHoJTog7N6uOzaF1EgTzAaKI6VQLas+PZOhyk7XUxoWoYHMeDVPdz/I4VwR111WyisOVi5U+mhFON71/NqpmmJfz3MecookOWjngPteo0zevz1e+OFD+6ZpHSOOlvdVCjlhw8rxrG58nfz2r6sfT5BjjEXHnBLkZKa+4UjFkTs721HnzlH60wmIOoSCd9D/Ugz37U7yjDCovDmy3K5D5/Dv1ktjjHnN/aNwYHVV2Rp6pPcS8r7vhnOw6d9ZhRTu5lggLV9yMXNfXNK/U/JkSTfspLcorztM6nVFW0Erbpm9rvLp+18xdRQwRfLs/G/i0lCEi4FGGI7UlHSGyfBjktm2l4pfcqWsWPaLAV0xrQygSqVZwa/5+Sxg7ntt1Zqt5ZcbCyCPeuczFMci5NSuYr2pJwhcFT1+dh10fz4RdfYZ1Pm5RQLAzVb18ZtQ0acy3zC2pLVYcXbm6+iMlO+YIUfPtDLvI346D21XnQzAP4KJiHr8qFK22G+K/qB1Dd5VM/DEmtUZiRjJsZincwSZsNMnd3jQcnulnLUHhFzFLXuVLDpvqCMaqHtBVf7x5V85dmJuNWRsnbPzBPz5gNwP8ALmtxI+CtGLcAAAAASUVORK5CYII=\",\n            \"size\": \"Medium\"\n        },\n        {\n            \"type\": \"Container\",\n            \"items\": @{variables('adaptiveCardIPAddressItems')}\n        }\n    ],\n    \"actions\": [\n        {\n            \"type\": \"Action.Submit\",\n            \"title\": \"Submit\"\n        },\n        {\n            \"type\": \"Action.Submit\",\n            \"title\": \"Ignore\"\n        }\n    ],\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n    \"version\": \"1.2\"\n}",
                            "recipient": {
                              "channelId": "19:b976c4b202d94ed9b9e0bedd821b7064@thread.tacv2"
                            },
                            "shouldUpdateCard": true,
                            "updateMessage": "Thanks for your response, it is being processed."
                          },
                          "notificationUrl": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['teams']['connectionId']"
                          }
                        },
                        "path": "/flowbot/actions/flowcontinuation/recipienttypes/channel/$subscriptions",
                        "queries": {
                          "groupId": "0ec3f88b-85af-406a-9698-ed6683f01b05"
                        }
                      }
                    },
                    "Retrieves_list_of_all_network_group_objects": {
                      "runAfter": {
                        "Generate_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups",
                        "queries": {
                          "filter": "nameOrValue:@{variables('Network Group object name')}"
                        }
                      }
                    },
                    "Retrieves_the_network_group_object_associated_with_the_specified_ID": {
                      "runAfter": {
                        "Initialize_and_set_Network_Group_Object_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/api/fmc_config/v1/domain/@{encodeURIComponent(outputs('Generate_token')['headers']['DOMAIN_UUID'])}/object/networkgroups/@{encodeURIComponent(variables('Network Group Object')?['id'])}"
                      }
                    },
                    "Revoke_access": {
                      "runAfter": {
                        "Retrieves_the_network_group_object_associated_with_the_specified_ID": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "X-auth-access-token": "@outputs('Generate_token')['headers']['X-auth-access-token']"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['Cisco-Firepower-connector']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/api/fmc_platform/v1/auth/revokeaccess"
                      }
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                        "connectionName": "[[variables('AzureSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      },
                      "Cisco-Firepower-connector": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('CiscoFirepowerConnectionName'))]",
                        "connectionName": "[[variables('CiscoFirepowerConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('Cisco Firepower Connector name'))]"
                      },
                      "teams": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('TeamsConnectionName'))]",
                        "connectionName": "[[variables('TeamsConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/teams')]"
                      }
                    }
                  },
                  "Network Group object name": {
                    "value": "[[parameters('Network Group object name')]"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId4'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId4')]",
                "contentId": "[variables('_playbookContentId4')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion4')]",
                "source": {
                  "kind": "Solution",
                  "name": "Cisco Firepower EStreamer",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Cisco"
                },
                "support": {
                  "name": "Cisco",
                  "tier": "Partner",
                  "link": "https://www.cisco.com/c/en_in/support/index.html"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "kind": "LogicAppsCustomConnector",
                      "contentId": "[variables('_CiscoFirepowerConnector')]",
                      "version": "[variables('playbookVersion1')]"
                    }
                  ]
                }
              }
            }
          ],
          "metadata": {
            "title": "Block IP - Take Action from Teams - Cisco Firepower",
            "description": "This playbook allows blocking of IPs in Cisco Firepower, using a **Network Group object**. This allows making changes to a Network Group selected members, instead of making Access List Entries. The Network Group object itself should be part of an Access List Entry.",
            "mainSteps": [
              "When a new Microsoft Sentinel incident is created, this playbook gets triggered and performs below actions.",
              "1. For the IPs we check if they are already selected for the Network Group object",
              "2. An adaptive card is sent to a Teams channel with information about the incident and giving the option to ignore an IP, or depending on it's current status block it by adding it to the Network Group object or unblock it by removing it from the Network Group object",
              "![Teams Adaptive Card preview](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20Firepower%20EStreamer/Playbooks/CiscoFirepower-BlockIP-Teams/Images/BlockIP-Teams-AdaptiveCard.png)",
              "3. The chosen changes are applied to the Network Group object",
              "4. Comment is added to Microsoft Sentinel incident ![Microsoft Sentinel comment](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20Firepower%20EStreamer/Playbooks/CiscoFirepower-BlockIP-Teams/Images/BlockIP-Teams-AzureSentinel-Comments.png)",
              "** IP is added to Cisco Firepower Network Group object:**",
              "![Cisco Firepower Network Group object](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20Firepower%20EStreamer/Playbooks/CiscoFirepower-BlockFQDN-NetworkGroup/Images/BlockFQDN-NetworkGroup-CiscoFirepowerAdd.png)",
              "**Playbook overview:**",
              "![Playbook overview](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20Firepower%20EStreamer/Playbooks/CiscoFirepower-BlockIP-Teams/Images/BlockIP-Teams-LogicApp.png)"
            ],
            "prerequisites": [
              "1. Cisco Firepower custom connector needs to be deployed prior to the deployment of this playbook, in the same resource group and region. Relevant instructions can be found in the connector doc pages.",
              "2. In Cisco Firepower there needs to be a Network Group object. [Creating Network Objects](https://www.cisco.com/c/en/us/td/docs/security/firepower/630/configuration/guide/fpmc-config-guide-v63/reusable_objects.html#ariaid-title15)"
            ],
            "lastUpdateTime": "2022-07-20T00:00:00Z",
            "entities": [
              "Ip"
            ],
            "tags": [
              "Remediation",
              "Response from teams"
            ],
            "postDeployment": [
              "**a. Authorize connections**",
              "Once deployment is complete, you will need to authorize each connection.",
              "1. Click the Microsoft Sentinel connection resource",
              "2. Click edit API connection",
              "3. Click Authorize",
              "4. Sign in",
              "5. Click Save",
              "6. Repeat steps for other connections such as Teams and Cisco Firepower (For authorizing the Cisco Firepower API connection, the username and password needs to be provided)",
              "**b. Select Teams channel**",
              "The Teams channel to which the adaptive card will be posted will need to be configured.",
              "1. Click the Azure Logic app resource",
              "2. Edit the Logic App",
              "3. Find the 'PostToTeams' action",
              "4. Select a Team and Channel",
              "5. Save the Logic App",
              "**c. Configurations in Microsoft Sentinel**",
              "1. In Microsoft Sentinel analytical rules should be configured to trigger an incident with IP Entity.",
              "2. Configure the automation rules to trigger this playbook"
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Block IP - Take Action from Teams - Cisco Firepower",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "2.0.3",
        "kind": "Solution",
        "contentSchemaVersion": "2.0.0",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Cisco Firepower EStreamer",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Cisco"
        },
        "support": {
          "name": "Cisco",
          "tier": "Partner",
          "link": "https://www.cisco.com/c/en_in/support/index.html"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "LogicAppsCustomConnector",
              "contentId": "[variables('_CiscoFirepowerConnector')]",
              "version": "[variables('playbookVersion1')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CiscoFirepower-BlockFQDN-NetworkGroup')]",
              "version": "[variables('playbookVersion2')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CiscoFirepower-BlockIP-NetworkGroup')]",
              "version": "[variables('playbookVersion3')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CiscoFirepower-BlockIP-Teams')]",
              "version": "[variables('playbookVersion4')]"
            }
          ]
        },
        "firstPublishDate": "2022-05-25",
        "providers": [
          "Cisco"
        ],
        "categories": {
          "domains": [
            "Security - Network"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
