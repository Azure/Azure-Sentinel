[
	{
		"name": "OneLoginDCR",
		"apiVersion": "2021-09-01-preview",
		"type": "Microsoft.Insights/dataCollectionRules",
		"location": "{{location}}",
		"properties": {
			"dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
			"streamDeclarations": {
				"Custom-OneLogin_API": {
					"columns": [
							{
								"name": "account_id",
								"type": "int",
								"description": "Account that triggered the event."
							},
							{
								"name": "TimeGenerated",
								"type": "datetime",
								"description": "DateTime"
							},
							{
								"name": "actor_system",
								"type": "string",
								"description": "Acting system that triggered the event when the actor is not a user."
							},
							{
								"name": "actor_user_id",
								"type": "int",
								"description": "ID of the user whose action triggered the event."
							},
							{
								"name": "actor_user_name",
								"type": "string",
								"description": "First and last name of the user whose action triggered the event."
							},
							{
								"name": "app_id",
								"type": "int",
								"description": "ID of the app involved in the event, if applicable."
							},
							{
								"name": "assuming_acting_user_id",
								"type": "int",
								"description": "ID of the user who assumed the role of the acting user to trigger the event, if applicable."
							},
							{
								"name": "client_id",
								"type": "string",
								"description": "Client ID used to generate the access token that made the API call that generated the event."
							},
							{
								"name": "created_at",
								"type": "datetime",
								"description": "ISO8601 Time and date at which the event was created. This value is autogenerated by OneLogin."
							},
							{
								"name": "custom_message",
								"type": "string",
								"description": "More details about the event."
							},
							{
								"name": "error_description",
								"type": "string",
								"description": "Provisioning error details, if applicable."
							},
							{
								"name": "event_type_id",
								"type": "int",
								"description": "Type of event triggered."
							},
							{
								"name": "group_id",
								"type": "int",
								"description": "ID of a group involved in the event."
							},
							{
								"name": "id",
								"type": "int",
								"description": "Events unique ID in OneLogin. Autogenerated by OneLogin."
							},
							{
								"name": "ipaddr",
								"type": "string",
								"description": "IP address of the machine used to trigger the event."
							},
							{
								"name": "notes",
								"type": "string",
								"description": "More details about the event."
							},
							{
								"name": "otp_device_id",
								"type": "int",
								"description": "ID of a device involved in the event."
							},
							{
								"name": "otp_device_name",
								"type": "string",
								"description": "Name of a device involved in the event."
							},
							{
								"name": "policy_id",
								"type": "int",
								"description": "ID of the policy involved in the event."
							},
							{
								"name": "policy_name",
								"type": "string",
								"description": "Name of the policy involved in the event."
							},
							{
								"name": "resource_type_id",
								"type": "int",
								"description": "ID of the resource (user, role, group, and so forth) associated with the event."
							},
							{
								"name": "role_id",
								"type": "int",
								"description": "ID of a role involved in the event."
							},
							{
								"name": "role_name",
								"type": "string",
								"description": "Name of a role involved in the event."
							},
							{
								"name": "user_id",
								"type": "int",
								"description": "ID of the user that was acted upon to trigger the event."
							},
							{
								"name": "user_name",
								"type": "string",
								"description": "First and last name of the user that was acted upon to trigger the event."
							},
							{
								"name": "risk_cookie_id",
								"type": "string",
								"description": "Risk cookie ID."
							},
							{
								"name": "assumed_by_superadmin_or_reseller",
								"type": "int",
								"description": "Indicates if the event was assumed by a super admin or reseller."
							},
							{
								"name": "certificate_id",
								"type": "int",
								"description": "Certificate ID involved in the event."
							},
							{
								"name": "mapping_id",
								"type": "int",
								"description": "Mapping ID involved in the event."
							},
							{
								"name": "radius_config_id",
								"type": "int",
								"description": "RADIUS configuration ID."
							},
							{
								"name": "risk_score",
								"type": "int",
								"description": "Risk score associated with the event."
							},
							{
								"name": "param",
								"type": "string",
								"description": "Additional parameters."
							},
							{
								"name": "adc_id",
								"type": "int",
								"description": "ADC ID."
							},
							{
								"name": "solved",
								"type": "boolean",
								"description": "Indicates if the event was resolved."
							},
							{
								"name": "service_directory_id",
								"type": "int",
								"description": "Service directory ID."
							},
							{
								"name": "object_id",
								"type": "int",
								"description": "Object ID."
							},
							{
								"name": "user_field_id",
								"type": "int",
								"description": "User field ID."
							},
							{
								"name": "risk_reasons",
								"type": "string",
								"description": "Reasons for the risk score."
							},
							{
								"name": "policy_type",
								"type": "string",
								"description": "Type of policy."
							},
							{
								"name": "resolved_at",
								"type": "datetime",
								"description": "Time and date when the event was resolved."
							},
							{
								"name": "trusted_idp_id",
								"type": "int",
								"description": "Trusted IDP ID."
							},
							{
								"name": "privilege_id",
								"type": "int",
								"description": "Privilege ID."
							},
							{
								"name": "proxy_ip",
								"type": "string",
								"description": "Proxy IP address."
							},
							{
								"name": "directory_sync_run_id",
								"type": "int",
								"description": "Directory sync run ID."
							}
						]
				}
			},
			"destinations": {
				"logAnalytics": [
					{
						"workspaceResourceId": "{{workspaceResourceId}}",
						"name": "clv2ws1"
					}
				]
			},
			"dataFlows": [
				{
					"streams": [
						"Custom-OneLogin_API"
					],
					"destinations": [
						"clv2ws1"
					],
					"transformKql" : "source| extend TimeGenerated = now(),OneLoginID=id",
					"outputStream": "Custom-OneLoginEvent_CL"
				}
			]
		}
	}
]
