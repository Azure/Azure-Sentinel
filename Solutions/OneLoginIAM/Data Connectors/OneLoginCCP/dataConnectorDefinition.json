{
    "name": "1PasswordCCPDefinition",
    "apiVersion": "2022-09-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "location": "{{location}}",
    "kind": "Customizable",
    "availability": {
        "isPreview": true
    },
	"properties": {
		"connectorUiConfig": {
			"id": "OneLoginEvent",
			"title": "OneLoginEvent (using REST API)",
			"publisher": "Microsoft",
			"descriptionMarkdown": "The [OneLogin](https://www.onelogin.com/) data connector provides the capability to ingest common OneLogin IAM Platform events into Microsoft Sentinel through Webhooks. The OneLogin Event Webhook API which is also known as the Event Broadcaster will send batches of events in near real-time to an endpoint that you specify. When a change occurs in the OneLogin, an HTTPS POST request with event information is sent to a callback data connector URL. Refer to [Webhooks documentation](https://developers.onelogin.com/api-docs/1/events/webhooks) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
			"graphQueriesTableName": "OneLoginEvent_CL",
			"graphQueries": [
				{
					"metricName": "Total events received",
					"legend": "Get Events",
					"baseQuery": "{{graphQueriesTableName}}"
				}
			],
			"sampleQueries": [
				{
					"description": "Get Sample of JumpCloud Events",
					"query": "{{graphQueriesTableName}}\n  | take 10"
				}
			],
			"dataTypes": [
				{
					"name": "{{graphQueriesTableName}}",
					"lastDataReceivedQuery": "{{graphQueriesTableName}}\n       | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
				}
			],
			"connectivityCriteria": [
				{
					"type": "HasDataConnectors"
				}
			],
			"availability": {
				"isPreview": false
			},
			"permissions": {
				"resourceProvider": [
					{
						"provider": "Microsoft.OperationalInsights/workspaces",
						"permissionsDisplayText": "Read and Write permissions are required.",
						"providerDisplayName": "Workspace",
						"scope": "Workspace",
						"requiredPermissions": {
							"write": true,
							"read": true,
							"delete": true
						}
					},
					{
						"provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
						"permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
						"providerDisplayName": "Keys",
						"scope": "Workspace",
						"requiredPermissions": {
							"action": true
						}
					}
				]
			},
			"instructionSteps": [
				{
					"description": "The [OneLogin](https://www.onelogin.com/) data connector provides the capability to ingest common OneLogin IAM Platform events into Microsoft Sentinel through Webhooks. The OneLogin Event Webhook API which is also known as the Event Broadcaster will send batches of events in near real-time to an endpoint that you specify. When a change occurs in the OneLogin, an HTTPS POST request with event information is sent to a callback data connector URL. Refer to [Webhooks documentation](https://developers.onelogin.com/api-docs/1/events/webhooks) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
					"instructions": [
						{
							"parameters": {
								"label": "Domain",
								"placeholder": "DomainName",
								"type": "text",
								"name": "BaseUrl"
							},
							"type": "Textbox"
						},
						{
							
							"parameters": {
								"label": "API Key",
								"placeholder": "ApiKey",
								"type": "securestring",
								"name": "ApiToken"
							},
							"type": "Textbox"
						},
						{
							"parameters": {
								"label": "toggle",
								"name": "toggle"
							},
							"type": "ConnectionToggleButton"
						}
					],
					"title": "Connect OneLogin events to Microsoft Sentinel"
				}
			]
		}
	}
}