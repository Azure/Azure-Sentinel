[
	{
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"apiVersion": "2022-10-01-preview",
		"name": "OneLoginAPIRequest",
		"kind": "RestApiPoller",
		"properties": {
			"connectorDefinitionName": "OneLoginEvent",
			"dataType": "OneLoginEvent_CL",
			"dcrConfig": {
				"streamName": "Custom-OneLogin_API",
				"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
				"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			},
            "auth": {
                "type": "APIKey",
                "ApiKey": "{{ApiToken}}",
                "ApiKeyName": "Authorization",
                "ApiKeyIdentifier": "Bearer"
            },
			"request": {
				"apiEndpoint": "https://{{BaseUrl}}/api/1/events",
				"httpMethod": "GET",
				"queryWindowInMin": 10,
				"queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
				"startTimeAttributeName": "since",
				"endTimeAttributeName": "until",
				"rateLimitQps": 15,
				"retryCount": 3,
				"timeoutInSeconds": 60,
				"headers": {
					"Accept": "application/json",
			        "User-Agent": "Scuba-Microsoft"
				}
			},
			"paging": {
				"pagingType": "NextPageToken",
				"nextPageParaName": "after_cursor",
				"nextPageTokenJsonPath": "$.pagination.after_cursor",
				"hasNextFlagJsonPath": "$.pagination.next_link"
			},
            "response": {
				"format": "json",
                "eventsJsonPaths": [
                    "$.data[*]"
                ]
            }
		}
	}
]
