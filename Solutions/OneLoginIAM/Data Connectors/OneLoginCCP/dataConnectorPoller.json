[
	{
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"apiVersion": "2022-10-01-preview",
		"name": "OneLoginAPIRequest",
		"kind": "RestApiPoller",
		"properties": {
			"connectorDefinitionName": "OneLoginEvent",
			"dataType": "OneLoginEvent_CL",
			"dcrConfig": {
				"streamName": "Custom-OneLogin_API",
				"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
				"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			},
			"auth": {
                "type": "OAuth2",
				"clientId": "{{clientId}}",
                "clientSecret": "{{clientSecret}}",
				"GrantType": "client_credentials",
				"TokenEndpoint": "https://{{BaseUrl}}/auth/oauth2/v2/token",
				"tokenEndpointHeaders": {
					"Content-Type": "application/x-www-form-urlencoded",
					"Accept": "application/json"
				},
				"scope": "token"
			},
			"request": {
				"apiEndpoint": "https://{{BaseUrl}}/api/1/events",
				"httpMethod": "GET",
				"queryWindowInMin": 10,
				"queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
				"startTimeAttributeName": "since",
				"endTimeAttributeName": "until",
				"rateLimitQps": 15,
				"retryCount": 3,
				"timeoutInSeconds": 60,
				"headers": {
					"Accept": "application/json"
				}
			},
			"paging": {
				"pagingType": "NextPageToken",
				"nextPageParaName": "after_cursor",
				"nextPageTokenJsonPath": "$.pagination.after_cursor",
				"hasNextFlagJsonPath": "$.pagination.next_link"
			},
            "response": {
				"format": "json",
                "eventsJsonPaths": [
                    "$.data[*]"
                ]
            }
		}
	}
]
