{
  "$schema": "https://aka.ms/sentinelConnectorDefinitionSchema",
  "id": "[resourceId('Microsoft.SecurityInsights/dataConnectors', 'PLCEventLogging')]",
  "connectorId": "PLCEventLogging",
  "connectorVersion": "1.0.0",
  "name": "PLC Event Logging",
  "publisher": "Pathlock Inc.",
  "descriptionMarkdown": "This connector ingests PLC event logs from Pathlock via Azure Monitor Data Collection Endpoint (DCE) and Data Collection Rule (DCR).",
  "graphQueriesTableName": "PLCEventLogging_CL",
  "graphQueries": [
    {
      "metricName": "Total events",
      "legend": "PLC Event Logs",
      "baseQuery": "PLCEventLogging_CL | count"
    }
  ],
  "dataTypes": [
    {
      "name": "PLCEventLogging_CL",
      "lastDataReceivedQuery": "PLCEventLogging_CL | summarize Time = max(TimeGenerated)"
    }
  ],
  "sampleQueries": [
    {
      "description": "All PLC event logs",
      "query": "PLCEventLogging_CL | take 10"
    }
  ],
  "availability": { "status": 1, "isPreview": false },
  "permissions": {
    "resourceProvider": [
      "Microsoft.OperationalInsights/workspaces",
      "Microsoft.Insights/dataCollectionRules",
      "Microsoft.Insights/dataCollectionEndpoints"
    ],
    "custom": [
      { "name": "Microsoft Sentinel", "description": "Required for accessing Sentinel workspace data." }
    ]
  },
  "dataConnectorProperties": {
    "dataTypes": [
      { "name": "PLCEventLogging_CL", "ingestionMode": "DCR-based" }
    ],
    "supportedTier": "All"
  }
}
