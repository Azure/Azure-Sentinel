{
  "$schema": "https://raw.githubusercontent.com/Microsoft/Application-Insights-Workbooks/master/schema/workbook.json",
  "version": "Notebook/1.0",
  "parameters": [
    {
      "id": "workspaceName",
      "type": 1,
      "label": "Workspace Name",
      "defaultValue": "{Log Analytics Workspace Name}",
      "typeSettings": {
        "resourceType": "microsoft.operationalinsights/workspaces"
      }
    },
	{
      "id": "TimeRange",
      "type": 4,
      "label": "Time Range",
      "defaultValue": "30d",
      "typeSettings": {
        "selectableValues": [
          { "duration": "PT5M", "label": "Last 5 minutes" },
          { "duration": "PT1H", "label": "Last hour" },
          { "duration": "P1D", "label": "Last 24 hours" },
          { "duration": "P7D", "label": "Last 7 days" },
          { "duration": "P30D", "label": "Last 30 days" }
        ]
      }
    }
  ],
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## SentinelEventLoggingWorkbook\n---\nThe workbook is used to represent the event information gathered in Pathlock Cloud application. It shows the data in tabular as well as graphical format. "
      },
      "name": "text - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "PLCEventLogging_CL\r\n| where TimeGenerated >= datetime('{TimeRange:start}') and TimeGenerated <= datetime('{TimeRange:end}')\r\n| summarize EventCount = count() by EventType, SystemName\r\n| order by EventType asc, EventCount desc",
        "size": 1,
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "barchart",
		"timeContext": {
          "durationMs": 2592000000
        }
      },
      "name": "query - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "PLCEventLogging_CL\r\n| where TimeGenerated >= datetime('{TimeRange:start}') and TimeGenerated <= datetime('{TimeRange:end}')\r\n| take 100",
        "size": 1,
        "timeContext": {
          "durationMs": 2592000000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Type",
              "formatter": 5
            },
            {
              "columnMatch": "TenantId",
              "formatter": 5
            },
            {
              "columnMatch": "_ResourceId",
              "formatter": 5
            }
          ]
        }
      },
      "name": "query - 4"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "PLCEventLogging_CL\r\n| where TimeGenerated >= datetime('{TimeRange:start}') and TimeGenerated <= datetime('{TimeRange:end}')\r\n| summarize EventCount = count() by Severity, EventType\r\n| order by Severity asc, EventCount desc",
        "size": 0,
        "timeContext": {
          "durationMs": 2592000000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "unstackedbar"
      },
      "name": "query - 3"
    }
  ],
  "fallbackResourceIds": [
    "[resourceId('microsoft.operationalinsights/workspaces', parameters('workspaceName'))]"
  ],
  "fromTemplateId": "sentinel-UserWorkbook"
}