{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Netskope",
    "comments": "Solution template for Netskope"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Netskope",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "solutionId": "netskope.netskope_mss",
    "_solutionId": "[variables('solutionId')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "uiConfigId1": "Netskope",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "Netskope",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1')))]",
    "dataConnectorVersion1": "1.0.0",
    "TemplateEmptyArray": "[json('[]')]",
    "workbookVersion1": "1.0",
    "workbookContentId1": "NetskopeWorkbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1')))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "parserVersion1": "1.0.0",
    "parserContentId1": "Netskope-Parser",
    "_parserContentId1": "[variables('parserContentId1')]",
    "parserName1": "Netskope",
    "_parserName1": "[concat(parameters('workspace'),'/',variables('parserName1'))]",
    "parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
    "_parserId1": "[variables('parserId1')]",
    "parserTemplateSpecName1": "[concat(parameters('workspace'),'-pr-',uniquestring(variables('_parserContentId1')))]"
  },
  "resources": [
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "DataConnector"
      },
      "properties": {
        "description": "Netskope data connector with template",
        "displayName": "Netskope template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('dataConnectorTemplateSpecName1'),'/',variables('dataConnectorVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "DataConnector"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('dataConnectorTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "Netskope data connector with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Netskope (using Azure Functions)",
                  "publisher": "Netskope",
                  "descriptionMarkdown": "The [Netskope Cloud Security Platform](https://www.netskope.com/platform) connector provides the capability to ingest Netskope logs and events into Microsoft Sentinel. The connector provides visibility into Netskope Platform Events and Alerts in Microsoft Sentinel to improve monitoring and investigation capabilities.",
                  "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "Netskope",
                      "baseQuery": "Netskope_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Top 10 Users",
                      "query": "Netskope\n | summarize count() by SrcUserName \n | top 10 by count_"
                    },
                    {
                      "description": "Top 10 Alerts",
                      "query": "Netskope\n | where isnotempty(AlertName) \n | summarize count() by AlertName \n| top 10 by count_"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Netskope_CL",
                      "lastDataReceivedQuery": "Netskope_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Netskope_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "Netskope API Token",
                        "description": "A Netskope API Token is required. [See the documentation to learn more about Netskope API](https://innovatechcloud.goskope.com/docs/Netskope_Help/en/rest-api-v1-overview.html). **Note:** A Netskope account is required"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to Netskope to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Netskope and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Netskope/Parsers/Netskope.txt), on the second line of the query, enter the hostname(s) of your Netskope device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Netskope API**\n\n [Follow these instructions](https://docs.netskope.com/en/rest-api-v1-overview.html) provided by Netskope to obtain an API Token. **Note:** A Netskope account is required"
                    },
                    {
                      "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Netskope connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Netskope API Authorization Token, readily available.",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "This method provides an automated deployment of the Netskope connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-netskope-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Key**, and **URI**.\n - Use the following schema for the `uri` value: `https://<Tenant Name>.goskope.com` Replace `<Tenant Name>` with your domain.\n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion.\n - The default **Log Types** is set to pull all 6 available log types (`alert, page, application, audit, infrastructure, network`), remove any are not required. \n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. After successfully deploying the connector, download the Kusto Function to normalize the data fields. [Follow the steps](https://aka.ms/sentinelgithubparsersnetskope) to use the Kusto function alias, **Netskope**.",
                      "title": "Option 1 - Azure Resource Manager (ARM) Template"
                    },
                    {
                      "description": "This method provides the step-by-step instructions to deploy the Netskope connector manually with Azure Function.",
                      "title": "Option 2 - Manual Deployment of Azure Functions"
                    },
                    {
                      "description": "**1. Create a Function App**\n\n1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\n2. In the **Basics** tab, ensure Runtime stack is set to **Powershell Core**. \n3. In the **Hosting** tab, ensure the **Consumption (Serverless)** plan type is selected.\n4. Make other preferrable configuration changes, if needed, then click **Create**."
                    },
                    {
                      "description": "**2. Import Function App Code**\n\n1. In the newly created Function App, select **Functions** on the left pane and click **+ Add**.\n2. Select **Timer Trigger**.\n3. Enter a unique Function **Name** and modify the cron schedule, if needed. The default value is set to run the Function App every 5 minutes. (Note: the Timer trigger should match the `timeInterval` value below to prevent overlapping data), click **Create**.\n4. Click on **Code + Test** on the left pane. \n5. Copy the [Function App Code](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Netskope/Data%20Connectors/Netskope/AzureFunctionNetskope/run.ps1) and paste into the Function App `run.ps1` editor.\n5. Click **Save**."
                    },
                    {
                      "description": "**3. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following seven (7) application settings individually, with their respective string values (case-sensitive): \n\t\tapikey\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\ttimeInterval\n\t\tlogTypes\n\t\tlogAnalyticsUri (optional)\n> - Enter the URI that corresponds to your region. The `uri` value must follow the following schema: `https://<Tenant Name>.goskope.com` - There is no need to add subsquent parameters to the Uri, the Function App will dynamically append the parameteres in the proper format.\n> - Set the `timeInterval` (in minutes) to the default value of `5` to correspond to the default Timer Trigger of every `5` minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly to prevent overlapping data ingestion. \n> - Set the `logTypes` to `alert, page, application, audit, infrastructure, network` - This list represents all the avaliable log types. Select the log types based on logging requirements, seperating each by a single comma.\n> - Note: If using Azure Key Vault, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**.\n5. After successfully deploying the connector, download the Kusto Function to normalize the data fields. [Follow the steps](https://aka.ms/sentinelgithubparsersnetskope) to use the Kusto function alias, **Netskope**."
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskope",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Netskope",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Netskope (using Azure Functions)",
          "publisher": "Netskope",
          "descriptionMarkdown": "The [Netskope Cloud Security Platform](https://www.netskope.com/platform) connector provides the capability to ingest Netskope logs and events into Microsoft Sentinel. The connector provides visibility into Netskope Platform Events and Alerts in Microsoft Sentinel to improve monitoring and investigation capabilities.",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "Netskope",
              "baseQuery": "Netskope_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Netskope_CL",
              "lastDataReceivedQuery": "Netskope_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Netskope_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Top 10 Users",
              "query": "Netskope\n | summarize count() by SrcUserName \n | top 10 by count_"
            },
            {
              "description": "Top 10 Alerts",
              "query": "Netskope\n | where isnotempty(AlertName) \n | summarize count() by AlertName \n| top 10 by count_"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "Netskope API Token",
                "description": "A Netskope API Token is required. [See the documentation to learn more about Netskope API](https://innovatechcloud.goskope.com/docs/Netskope_Help/en/rest-api-v1-overview.html). **Note:** A Netskope account is required"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to Netskope to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Netskope and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Netskope/Parsers/Netskope.txt), on the second line of the query, enter the hostname(s) of your Netskope device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Netskope API**\n\n [Follow these instructions](https://docs.netskope.com/en/rest-api-v1-overview.html) provided by Netskope to obtain an API Token. **Note:** A Netskope account is required"
            },
            {
              "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Netskope connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Netskope API Authorization Token, readily available.",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "This method provides an automated deployment of the Netskope connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-netskope-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Key**, and **URI**.\n - Use the following schema for the `uri` value: `https://<Tenant Name>.goskope.com` Replace `<Tenant Name>` with your domain.\n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion.\n - The default **Log Types** is set to pull all 6 available log types (`alert, page, application, audit, infrastructure, network`), remove any are not required. \n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. After successfully deploying the connector, download the Kusto Function to normalize the data fields. [Follow the steps](https://aka.ms/sentinelgithubparsersnetskope) to use the Kusto function alias, **Netskope**.",
              "title": "Option 1 - Azure Resource Manager (ARM) Template"
            },
            {
              "description": "This method provides the step-by-step instructions to deploy the Netskope connector manually with Azure Function.",
              "title": "Option 2 - Manual Deployment of Azure Functions"
            },
            {
              "description": "**1. Create a Function App**\n\n1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\n2. In the **Basics** tab, ensure Runtime stack is set to **Powershell Core**. \n3. In the **Hosting** tab, ensure the **Consumption (Serverless)** plan type is selected.\n4. Make other preferrable configuration changes, if needed, then click **Create**."
            },
            {
              "description": "**2. Import Function App Code**\n\n1. In the newly created Function App, select **Functions** on the left pane and click **+ Add**.\n2. Select **Timer Trigger**.\n3. Enter a unique Function **Name** and modify the cron schedule, if needed. The default value is set to run the Function App every 5 minutes. (Note: the Timer trigger should match the `timeInterval` value below to prevent overlapping data), click **Create**.\n4. Click on **Code + Test** on the left pane. \n5. Copy the [Function App Code](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Netskope/Data%20Connectors/Netskope/AzureFunctionNetskope/run.ps1) and paste into the Function App `run.ps1` editor.\n5. Click **Save**."
            },
            {
              "description": "**3. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following seven (7) application settings individually, with their respective string values (case-sensitive): \n\t\tapikey\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\ttimeInterval\n\t\tlogTypes\n\t\tlogAnalyticsUri (optional)\n> - Enter the URI that corresponds to your region. The `uri` value must follow the following schema: `https://<Tenant Name>.goskope.com` - There is no need to add subsquent parameters to the Uri, the Function App will dynamically append the parameteres in the proper format.\n> - Set the `timeInterval` (in minutes) to the default value of `5` to correspond to the default Timer Trigger of every `5` minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly to prevent overlapping data ingestion. \n> - Set the `logTypes` to `alert, page, application, audit, infrastructure, network` - This list represents all the avaliable log types. Select the log types based on logging requirements, seperating each by a single comma.\n> - Note: If using Azure Key Vault, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**.\n5. After successfully deploying the connector, download the Kusto Function to normalize the data fields. [Follow the steps](https://aka.ms/sentinelgithubparsersnetskope) to use the Kusto function alias, **Netskope**."
            }
          ],
          "id": "[variables('_uiConfigId1')]",
          "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution."
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Workbook"
      },
      "properties": {
        "description": "Netskope Workbook with template",
        "displayName": "Netskope workbook template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('workbookTemplateSpecName1'),'/',variables('workbookVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Workbook"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('workbookTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "NetskopeEventsWorkbook with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Gain insights and comprehensive monitoring into Netskope events data by analyzing traffic and user activities.\nThis workbook provides insights into various Netskope events types such as Cloud Firewall, Network Private Access, Applications, Security Alerts as well as Web Transactions.\nYou can use this workbook to get visibility in to your Netskope Security Cloud and quickly identify threats, anamolies, traffic patterns, cloud application useage, blocked URL addresses and more."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"# Netskope Events\\nThe Netskope Events workbook has the following components:\\n### Network Events: \\nProvides insight into cloud firewall and network private access events.\\n### Application Events: \\nProvides insights into application usage; specifically by devices, users, users and traffic patterns.\\n###  Security Alerts: \\nProvides visibility into security incidents and violations and the ability to identify effects of a breach.\\n### Web Transactions:\\nProvide granular information about the web sites that users have accessed.\",\"style\":\"info\"},\"name\":\"text - 2\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"tabStyle\":\"bigger\",\"links\":[{\"id\":\"5f83eaaf-12a1-40f0-aa28-49205c862664\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Network Events\",\"subTarget\":\"Network Events\",\"style\":\"link\"},{\"id\":\"27da20b3-9380-4f04-ae43-b8e3afa7f9d1\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Application Events\",\"subTarget\":\"Application Events\",\"style\":\"link\"},{\"id\":\"26b633c0-0eca-458c-b511-06ee39ac2bd0\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Security Alerts\",\"subTarget\":\"Security Alerts\",\"style\":\"link\"},{\"id\":\"313991f3-5e35-42b2-a00c-deb1e88f5c2a\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Web Transactions\",\"subTarget\":\"Web Transcations\",\"style\":\"link\"}]},\"name\":\"links - 10\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"af56e016-34e8-4776-8a90-79f17a31c40f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":7776000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by device_s\\n\",\"size\":2,\"title\":\"Device Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Device Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by os_s\",\"size\":2,\"title\":\"OS Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"OS Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by browser_s\\n\",\"size\":2,\"title\":\"Browser Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Browser Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by ccl_s\",\"size\":2,\"title\":\"Cloud Confidence Level Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"ccl_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"cci_d\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"ccl_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"cci_d\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"33\",\"name\":\"Cloud Confidence Level Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by activity_s\\n\",\"size\":2,\"title\":\"Top Application Activities\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"Application Activities\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by app_s\\n\",\"size\":2,\"title\":\"Top Applications Accessed\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"gridSettings\":{\"labelSettings\":[{\"columnId\":\"TimeGenerated\",\"label\":\"Time Generated\"},{\"columnId\":\"Category\",\"label\":\"Category\"},{\"columnId\":\"count\",\"label\":\"Count\"}]},\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Applications Accessed\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count() by Category\",\"size\":2,\"title\":\"Top Applications Categories\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"gridSettings\":{\"labelSettings\":[{\"columnId\":\"TimeGenerated\",\"label\":\"Time Generated\"},{\"columnId\":\"Category\",\"label\":\"Category\"},{\"columnId\":\"count\",\"label\":\"Count\"}]},\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Applications Categories\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\" and ccl_s == \\\"poor\\\"\\n| summarize Count = count () by bin(TimeGenerated, {TimeRange:grain}), app_s\",\"size\":2,\"title\":\"Top Applications Accessed by Users with Poor CCI Over Time\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"67\",\"name\":\"Applications Accessed by Users with Poor CCI\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"application\\\"\\n| summarize Count = count(access_method_s) by user_s, access_method_s\\n\\n\",\"size\":2,\"title\":\"Top Users by Access Method\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"gridSettings\":{\"labelSettings\":[{\"columnId\":\"user_s\",\"label\":\"User\"}]},\"sortBy\":\"[variables('TemplateEmptyArray')]\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"access_method_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"access_method_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Total\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"xAxis\":\"access_method_s\",\"xSettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":false}}}}},\"name\":\"Top Users by Access Method\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"page\\\"\\n| summarize TotalBytes = sum (numbytes_d/1024/1024) by bin(TimeGenerated, {TimeRange:grain}), app_s\\n| top 10 by TotalBytes \",\"size\":2,\"title\":\"Top Applications by Traffic Volume\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"xAxis\":\"TimeGenerated\",\"yAxis\":[\"TotalBytes\"],\"xSettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}},\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}}},\"name\":\"Top Applications by Traffic Volume\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"page\\\"\\n| summarize TotalBytes = sum (numbytes_d/1024/1024) by bin(TimeGenerated, {TimeRange:grain}), user_s\\n| top 10 by TotalBytes \",\"size\":2,\"title\":\"Top Users by Traffic Volume\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"xAxis\":\"TimeGenerated\",\"yAxis\":[\"TotalBytes\"],\"xSettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}},\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}}},\"name\":\"Top Users by Traffic Volume\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Application Events\"},\"name\":\"Application Events\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"9dd14451-b5c7-48bd-adbf-a5a7d239a498\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Cloud Firewall\",\"subTarget\":\"Cloud Firewall\",\"style\":\"link\"},{\"id\":\"8ed347bc-8e58-4f13-abf2-a76cc6c28aeb\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Network Private Access\",\"subTarget\":\"Network Private Access\",\"style\":\"link\"}]},\"name\":\"links - 23\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"9d8ed5ac-2177-4252-8e02-a28761cc4cc9\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":7776000000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| summarize numbytes_d = sum (numbytes_d/1024.0/1024.0) by app_s\\n\",\"size\":2,\"title\":\"Top Private Applications by Total Bytes\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumSignificantDigits\":2}}}}},\"customWidth\":\"33\",\"name\":\"Private Applications by Total Bytes\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| summarize client_bytes_d = sum (client_bytes_d/1024.0/1024.0) by app_s\\n\",\"size\":2,\"title\":\"Top Private Applications By Uploaded Bytes\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumSignificantDigits\":2}}}}},\"customWidth\":\"33\",\"name\":\"Private Applications By Uploaded Bytes\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| summarize server_bytes_d = sum (server_bytes_d/1024.0/1024.0) by app_s\",\"size\":2,\"title\":\"Top Private Applications By Downloaded Bytes\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumSignificantDigits\":2}}}}},\"customWidth\":\"33\",\"name\":\"Private Applications By Downloaded Bytes\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| distinct policy_s, app_s\\n| summarize count = count() by policy_s, app_s\",\"size\":2,\"title\":\"Most Used Policies\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"query - 18\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| project TimeGenerated, network_session_id_s, user_s\\n| summarize NetworkSessions=dcount(network_session_id_s) by bin(TimeGenerated,{TimeRange:grain}), user=user_s\\n| top 10 by NetworkSessions\",\"size\":2,\"title\":\"Top Users By Session Count\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"Users By Session Count\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| project TimeGenerated, network_session_id_s, app_s, dsthost_s\\n| summarize AppSessions=dcount(network_session_id_s) by dsthost_s\\n| top 10 by AppSessions\",\"size\":2,\"title\":\"Top Applications By Session Count\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"Applications By Session Count\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| summarize AppHit = count() by bin(TimeGenerated, {TimeRange:grain}), app_s\\n\",\"size\":2,\"title\":\"Private Applications and Policy Hits\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"dsthost_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"numbytes_d\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"dsthost_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Recived MB\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"xAxis\":\"TimeGenerated\",\"yAxis\":[\"AppHit\"],\"xSettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}},\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}}},\"name\":\"Private Applications and Policy Hits\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL \\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| project TimeGenerated, user_s, app_s\\n| summarize UserCount=dcount(user_s) by bin(TimeGenerated, {TimeRange:grain}), app_s\",\"size\":2,\"title\":\"Daily User Count for Private Applications\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"Daily User Count for Private Applications\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\" and action_s == \\\"allow\\\"\\n| summarize TotalBytes = sum (numbytes_d/1024.0/1024.0) by bin(TimeGenerated, {TimeRange:grain}), app_s\\n\",\"size\":2,\"title\":\"Top Private Applications Traffic Volume\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"dsthost_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"numbytes_d\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"dsthost_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Recived MB\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"xAxis\":\"TimeGenerated\",\"yAxis\":[\"TotalBytes\"],\"xSettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}},\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}}},\"name\":\"Private Applications Traffic Volume\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL \\n| where event_type_s == \\\"network\\\" and publisher_name_s != \\\"\\\"\\n//| summarize any(dstport_d) by dsthost_s, ip_protocol_s\\n| distinct publisher_name_s, policy_s, dsthost_s, dstport_d, ip_protocol_s\\n| sort by publisher_name_s asc, dstport_d asc\\n\",\"size\":0,\"title\":\"Private Applications Ports\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"publisher_name_s\",\"label\":\"Publisher Name\"},{\"columnId\":\"policy_s\",\"label\":\"Policy Name\"},{\"columnId\":\"dsthost_s\",\"label\":\"Destination Host\"},{\"columnId\":\"dstport_d\",\"label\":\"Destination Port\"},{\"columnId\":\"ip_protocol_s\",\"label\":\"Protocol\"}]},\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"publisher_name_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"dstport_d\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"name\":\"query - 13\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Network Private Access\"},\"name\":\"Network Private Access\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"d2694df1-7d4f-4fcf-be0a-f239d5c4401f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":7776000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"label\":\"Time Range\"},{\"id\":\"949c6b79-4304-4a4d-a094-2cb0557b7d79\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"SourceIP\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"Netskope_Events_CL\\n| where srcip_s  != \\\"\\\"\\n| summarize Count = count() by srcip_s\\n| project Value = srcip_s, Label = strcat(srcip_s, \\\" count: \\\", Count)\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"All\",\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"],\"label\":\"Source IP\"},{\"id\":\"2a39eab8-b0ae-4dd3-9e20-d84f0de5e749\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"SourcePort\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"Netskope_Events_CL\\n| where srcip_s  != \\\"\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\")\\n| where srcport_d  != \\\"\\\" \\n| summarize Count = count() by srcport_d\\n| project Value = srcport_d, Label = strcat(\\\"Port: \\\",srcport_d, \\\" count: \\\", Count)\\n\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"All\",\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"],\"label\":\"Source Port\"},{\"id\":\"05f8797b-984a-458d-9348-aad0a7aed886\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"DestinationIP\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"Netskope_Events_CL\\n| where dstip_s  != \\\"\\\"\\n| summarize Count = count() by dstip_s\\n| project Value = dstip_s, Label = strcat(dstip_s, \\\" count: \\\", Count)\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"All\",\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"],\"label\":\"Destination IP\"},{\"id\":\"a50afb6e-78e6-45f1-9bdc-402ac458ef0a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"DestinationPort\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"Netskope_Events_CL\\n| where dstip_s  != \\\"\\\"\\n| where (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\")\\n| where dstport_d  != \\\"\\\" \\n| summarize Count = count() by dstport_d\\n| project Value = dstport_d, Label = strcat(\\\"Port: \\\",dstport_d, \\\" count: \\\", Count)\\n\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"All\",\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"value::all\"],\"label\":\"Destination Port\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| summarize Count = count() by ip_protocol_s\\n| sort by Count desc\\n| top 10 by Count\",\"size\":2,\"title\":\"Top Blocked Protocols\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"Blocked Protocols\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| where access_method_s != \\\"null\\\"\\n| summarize Count = count() by  access_method_s\\n| order by Count\\n| take 10\",\"size\":2,\"title\":\"Top Blocked By Access Method\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"selAccessMethod\",\"exportDefaultValue\":\"*\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"33\",\"name\":\"Blocked By Access Method\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| summarize Count = count() by dst_country_s\\n| sort by Count desc\\n| top 10 by Count\",\"size\":2,\"title\":\"Top Blocked Destination Countries\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"selCountry\",\"exportDefaultValue\":\"*\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"dst_region_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"dst_region_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}},\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"dst_country_s\",\"latitude\":\"Count\",\"longitude\":\"Count\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Average\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"Count\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"categorical\"}}},\"customWidth\":\"33\",\"name\":\"Blocked Destination Countries\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL \\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where dst_country_s == '{selCountry}'\\n| project src_country_s, dst_country_s, dst_region_s, dsthost_s, dstip_s, dstport_d, ip_protocol_s, policy_s, access_method_s, traffic_type_s, user_s, userip_s\\n//| take 10\",\"size\":2,\"title\":\"Show Blocked Details by Country\",\"noDataMessage\":\"Select Country\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"src_country_s\",\"label\":\"Source Country\"},{\"columnId\":\"dst_country_s\",\"label\":\"Destination Country\"},{\"columnId\":\"dst_region_s\",\"label\":\"Destination Region\"},{\"columnId\":\"dsthost_s\",\"label\":\"Destination Host\"},{\"columnId\":\"dstip_s\",\"label\":\"Destination IP\"},{\"columnId\":\"dstport_d\",\"label\":\"Destination Port\"},{\"columnId\":\"ip_protocol_s\",\"label\":\"Protcol\"},{\"columnId\":\"policy_s\",\"label\":\"Policy Name\"},{\"columnId\":\"access_method_s\",\"label\":\"Access Method\"},{\"columnId\":\"traffic_type_s\",\"label\":\"Traffic Type\"},{\"columnId\":\"user_s\",\"label\":\"User\"},{\"columnId\":\"userip_s\",\"label\":\"User IP\"}]}},\"name\":\"Show Blocked Details by Country\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| summarize Count = count() by dst_region_s\\n| sort by Count desc\\n| top 10 by Count\",\"size\":2,\"title\":\"Top Blocked Destination Regions\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"dst_region_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"dst_region_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}},\"mapSettings\":{\"locInfo\":\"LatLong\",\"latitude\":\"Count\",\"longitude\":\"Count\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"Count\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"Blocked Destination Regions\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| where dstip_s  != \\\"\\\" \\n| summarize Count = count() by dstip_s\\n| sort by Count desc\\n| top 10 by Count\",\"size\":2,\"title\":\"Top Blocked Destination IP Addresses\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"Blocked Destination IP Addresses\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| where dstport_d   != \\\"null\\\" \\n| extend dst_port = tostring(toint(dstport_d))\\n| summarize Count = count() by dst_port\\n| order by Count desc\\n| take 10\",\"size\":2,\"title\":\"Top Blocked Destination Ports\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"dst_port\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"dst_port\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"Blocked Destination Ports\",\"styleSettings\":{\"margin\":\"0\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| where srcip_s  != \\\"\\\" \\n| summarize Count = count() by srcip_s\\n| sort by Count desc\\n| top 10 by Count\",\"size\":2,\"title\":\"Top Blocked Source IP Addresses\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}}},\"customWidth\":\"33\",\"name\":\"Blocked Source IP Addresses\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL\\n| where event_type_s == \\\"network\\\" and action_s == \\\"block\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| where srcport_d != \\\"null\\\" \\n| extend src_port = tostring(toint(srcport_d))\\n| summarize Count = count() by  src_port\\n| order by Count desc\\n| top 10 by Count desc nulls last\",\"size\":2,\"title\":\"Top Blocked Source Ports\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"dst_port\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"dst_port\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":10,\"ySettings\":{\"numberFormatSettings\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true}}}},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"Blocked Source Ports\",\"styleSettings\":{\"margin\":\"0\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Events_CL \\n| where event_type_s == \\\"network\\\" and traffic_type_s == \\\"non-web\\\" and action_s == \\\"allow\\\"\\n| where (srcip_s in ({SourceIP}) or '{SourceIP:label}' == \\\"All\\\") and (srcport_d in ({SourcePort}) or '{SourcePort:label}' == \\\"All\\\") and (dstip_s in ({DestinationIP}) or '{DestinationIP:label}' == \\\"All\\\") and (dstport_d in ({DestinationPort}) or '{DestinationPort:label}' == \\\"All\\\")\\n| where policy_s != \\\"default\\\" \\n//| summarize count()  by bin(TimeGenerated, {TimeRange:grain}), policy_s\\n| summarize count()  by policy_s\",\"size\":2,\"title\":\"Non-Default Firewall Policies Getting Triggered\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"count_\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"Non-Default Firewall Policies Getting Triggered\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Cloud Firewall\"},\"name\":\"Cloud Firewall\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Network Events\"},\"name\":\"Network Events\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"fb58eb7d-4b4e-4b9e-8ccf-d1b519798721\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":7776000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 25\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"db048291-ae29-4351-baad-78e8d7044120\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Overview\",\"subTarget\":\"Overview\",\"style\":\"link\"},{\"id\":\"58bfee18-a20c-4869-8f28-c33c981049fe\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Malware\",\"subTarget\":\"Malware\",\"style\":\"link\"},{\"id\":\"beb6a698-1509-4daf-96e8-275001abf02f\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Data Loss Prevention\",\"subTarget\":\"Data Loss Prevention\",\"style\":\"link\"},{\"id\":\"5f149675-5fa2-4c65-b6eb-c36fa8035b7f\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Malsite\",\"subTarget\":\"Malsite\",\"style\":\"link\"},{\"id\":\"65da146b-5655-48f9-8032-376fe4168375\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Compromised Credentials\",\"subTarget\":\"Compromised Credentials\",\"style\":\"link\"},{\"id\":\"addc1833-256c-4996-b9b9-0cadb5f3a1dd\",\"cellValue\":\"selTab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Behavior Analytics\",\"subTarget\":\"Behavior Analytics\",\"style\":\"link\"}]},\"name\":\"links - 25\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_s == \\\"yes\\\"\\n| summarize Count = count() by alert_type_s\\n| sort by Count desc\\n\",\"size\":2,\"title\":\"Alert Type Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Alert Type Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| summarize Count = count() by app_s\\n| top 10 by Count\\n\",\"size\":2,\"title\":\"Top 10 Applications by Alerts\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 Applications by Alerts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| summarize Count = count() by alert_name_s\\n| top 10 by Count\\n\",\"size\":2,\"title\":\"Top 10 Alerts\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"alert_name_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"alert_name_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 Alerts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| summarize Count = count() by user_s\\n| top 10 by Count\\n\",\"size\":2,\"title\":\"Top 10 Users By Alerts\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"alert_name_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"alert_name_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 Users By Alerts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| summarize Count = count() by src_country_s\",\"size\":2,\"title\":\"Alerts Location by Source Country\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"map\",\"sortBy\":\"[variables('TemplateEmptyArray')]\",\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"src_country_s\",\"latitude\":\"src_latitude_d\",\"longitude\":\"src_longitude_d\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"labelSettings\":\"src_country_s\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"nodeColorField\":\"Count\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"67\",\"name\":\"Alerts Location by Source Country\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| summarize Count = count() by bin(TimeGenerated, {TimeRange:grain}), alert_type_s\\n\",\"size\":2,\"title\":\"Alert Types Over Time\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"Alert Types Over Time\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Overview\"},\"name\":\"Alert Overview\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count(malware_type_s) by malware_type_s\\n| sort by Count desc\",\"size\":2,\"title\":\"Malware Types Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malware Types Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count(activity_s) by activity_s\\n| sort by Count desc\",\"size\":2,\"title\":\"Malware Activities Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malware Activities Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count() by malware_name_s\\n| sort by Count desc\",\"size\":2,\"title\":\"Malware Names Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malware Names Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count() by malware_severity_s\\n| sort by Count desc\",\"size\":2,\"title\":\"Malware Severity Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"33\",\"name\":\"Malware Severity Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count() by file_type_s\\n| top 10 by Count\",\"size\":2,\"title\":\"Top 10 Affected FileTypes\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":0}},\"customWidth\":\"33\",\"name\":\"Top 10 Affected FileTypes\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count() by app_s\\n| sort by Count desc\",\"size\":2,\"title\":\"Malware Incidents by Applications\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malware Incidents by Applications\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count() by user_s\\n| sort by Count desc\\n| top 10 by Count\",\"size\":2,\"title\":\"Top 10 Users Triggered Malware Events\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 Users Triggered Malware Events\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| summarize Count = count() by bin(TimeGenerated, {TimeRange:grain}), malware_name_s\\n\",\"size\":2,\"title\":\"Blocked Malwares Over Time\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"malware\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"67\",\"name\":\"Blocked Malwares Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Malware\\\"\\n| where malware_name_s == '{malware}'\\n| project TimeGenerated, user_s, app_name_s, activity_s, detection_engine_s, detection_type_s, file_name_s, file_type_s, malware_severity_s, malware_name_s\",\"size\":0,\"title\":\"Blocked Malware Log Details\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"TimeGenerated\",\"label\":\"TimeGenerated\"},{\"columnId\":\"user_s\",\"label\":\"User\"},{\"columnId\":\"app_name_s\",\"label\":\"App_Name\"},{\"columnId\":\"activity_s\",\"label\":\"Activity\"},{\"columnId\":\"detection_engine_s\",\"label\":\"Detection_Engine\"},{\"columnId\":\"detection_type_s\",\"label\":\"Detection_Type\"},{\"columnId\":\"file_name_s\",\"label\":\"File_Name\"},{\"columnId\":\"file_type_s\",\"label\":\"File_Type\"},{\"columnId\":\"malware_severity_s\",\"label\":\"Severity\"},{\"columnId\":\"malware_name_s\",\"label\":\"Malware_Name\"}]}},\"name\":\"Blocked Malware Log Details\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Malware\"},\"name\":\"Malware\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"malsite\\\"\\n| summarize Count = count() by malsite_category_s\",\"size\":2,\"title\":\"Malsite Blocked by Category\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malsite Blocked by Category\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"malsite\\\"\\n| summarize Count = count() by severity_level_s\",\"size\":2,\"title\":\"Malsite Blocked by Severity\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"severity\",\"exportDefaultValue\":\"*\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malsite Blocked by Severity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"malsite\\\"\\n| summarize Count = count() by malsite_country_s\",\"size\":2,\"title\":\"Malsite Blocked by Destination Location\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Malsite Blocked by Destination Location\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"malsite\\\"\\n| where severity_level_s == '{severity}'\\n| project TimeGenerated, user_s, url_s, malsite_category_s, malsite_country_s, malsite_ip_host_s, threat_match_value_s, severity_level_s\\n\",\"size\":0,\"title\":\"Malsite Incidents Details by Severity Level\",\"noDataMessage\":\"Select Severity Level\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"user_s\",\"label\":\"User\"},{\"columnId\":\"url_s\",\"label\":\"URL\"},{\"columnId\":\"malsite_category_s\",\"label\":\"Category\"},{\"columnId\":\"malsite_country_s\",\"label\":\"Country\"},{\"columnId\":\"malsite_ip_host_s\",\"label\":\"IP\"},{\"columnId\":\"threat_match_value_s\",\"label\":\"Threat Match\"},{\"columnId\":\"severity_level_s\",\"label\":\"Severity\"}]}},\"name\":\"Malsite Incidents Details by Severity Level\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"malsite\\\"\\n| summarize Count = count() by user_s\",\"size\":2,\"title\":\"Top 10 Users Accessing Malsites\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"user\",\"exportDefaultValue\":\"*\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 Users Accessing Malsites\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"malsite\\\"\\n| where user_s == '{user}'\\n| summarize count() by bin(TimeGenerated, {TimeRange:grain}), user_s\\n\",\"size\":2,\"title\":\"User Accessing Malsites Over time\",\"noDataMessage\":\"Select User\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\"},\"customWidth\":\"67\",\"name\":\"User Accessing Malsites Over time\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Malsite\"},\"name\":\"Malsite\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by app_s\",\"size\":2,\"title\":\"DLP Incidents by Applications\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"DLP Incidents by Applications\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by dlp_rule_severity_s\",\"size\":2,\"title\":\"DLP Incidents By Severity\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"severity\",\"exportDefaultValue\":\"*\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"DLP Incidents By Severity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by activity_s\",\"size\":2,\"title\":\"DLP Incidents by Activity\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"DLP Incidents by Activity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| where dlp_rule_severity_s == '{severity}'\\n| project TimeGenerated, dlp_rule_s, dlp_rule_severity_s, dlp_file_s, object_type_s, activity_s, user_s, from_user_s\",\"size\":2,\"title\":\"DLP Incididents Details by Severity\",\"noDataMessage\":\"Select Severity\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"TimeGenerated\",\"label\":\"TimeGenerated\"},{\"columnId\":\"dlp_rule_s\",\"label\":\"DLP Rule\"},{\"columnId\":\"dlp_rule_severity_s\",\"label\":\"Severity\"},{\"columnId\":\"dlp_file_s\",\"label\":\"File Name\"},{\"columnId\":\"object_type_s\",\"label\":\"File Type\"},{\"columnId\":\"activity_s\",\"label\":\"Activity\"},{\"columnId\":\"user_s\",\"label\":\"User\"},{\"columnId\":\"from_user_s\",\"label\":\"From User\"}]}},\"name\":\"DLP Incididents Details by Severity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by os_s\",\"size\":2,\"title\":\"DLP Incidents by OS\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"DLP Incidents by OS\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by dlp_rule_s\\n| top 10 by Count\",\"size\":2,\"title\":\"Top 10 DLP Rules Triggered\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 DLP Rules Triggered\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by dlp_profile_s\\n| top 10 by Count\",\"size\":2,\"title\":\"Top 10 DLP Profiles\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 DLP Profiles\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by user_s\\n| top 10 by Count\",\"size\":2,\"title\":\"Top 10 Users Triggered DLP Events\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 Users Triggered DLP Events\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by dlp_file_s\\n| top 10 by Count\\n\",\"size\":2,\"title\":\"Top 10 DLP Incidents by File\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 DLP Incidents by File\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by policy_s\\n| top 10 by Count\\n\",\"size\":2,\"title\":\"Top 10 DLP Incidents by Policy Voilations\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top 10 DLP Incidents by Policy Voilations\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"DLP\\\"\\n| summarize Count = count() by bin(TimeGenerated, {TimeRange:grain}), policy_s\",\"size\":2,\"title\":\"DLP Incidents by Policy Over Time\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"DLP Incidents by Policy Over Time\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Data Loss Prevention\"},\"name\":\"Data Loss Prevention\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Compromised Credential\\\"\\n| summarize Count = count() by alert_name_s\\n| sort by Count desc\",\"size\":2,\"title\":\"Compromised Credentials by Source of Info\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Compromised Credentials by Source of Info\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Compromised Credential\\\"\\n| project breach_date_t, alert_name_s, breach_description_s, breach_id_g, breach_score_d\\n| top 10 by breach_score_d desc \",\"size\":2,\"title\":\"Top 10 breaches by Breach Score\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"labelSettings\":[{\"columnId\":\"breach_date_t\",\"label\":\"Breach_Date\"},{\"columnId\":\"alert_name_s\",\"label\":\"Alert_Name\"},{\"columnId\":\"breach_description_s\",\"label\":\"Description\"},{\"columnId\":\"breach_id_g\",\"label\":\"Breach_id\"},{\"columnId\":\"breach_score_d\",\"label\":\"Breach_Score\"}]}},\"customWidth\":\"67\",\"name\":\"Top 10 breaches by Breach Score\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"Compromised Credential\\\"\\n| project TimeGenerated, alert_name_s, user_s, breach_id_g, breach_date_t, breach_score_d, matched_username_s, breach_media_references_s, breach_target_references_s\",\"size\":0,\"title\":\"Compromised Credentials\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"labelSettings\":[{\"columnId\":\"TimeGenerated\",\"label\":\"Alert_Date\"},{\"columnId\":\"alert_name_s\",\"label\":\"Alert_Name\"},{\"columnId\":\"user_s\",\"label\":\"User\"},{\"columnId\":\"breach_id_g\",\"label\":\"Breach_id\"},{\"columnId\":\"breach_date_t\",\"label\":\"Breach_Date\"},{\"columnId\":\"breach_score_d\",\"label\":\"Breach_Score\"},{\"columnId\":\"matched_username_s\",\"label\":\"Matched_Username\"},{\"columnId\":\"breach_media_references_s\",\"label\":\"Media_Reference\"},{\"columnId\":\"breach_target_references_s\",\"label\":\"Target_Reference\"}]}},\"name\":\"Compromised Credentials\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Compromised Credentials\"},\"name\":\"Compromised Credentials\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| summarize Count = count () by activity_s\",\"size\":2,\"title\":\"Anomalies by Activity\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Anomalies by Activity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| summarize Count = count () by app_s\",\"size\":2,\"title\":\"Anomalies by App\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Anomalies by App\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| summarize Count = count () by Category\",\"size\":2,\"title\":\"Anomalies by Category\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Anomalies by Category\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| summarize Count = count () by alert_name_s\",\"size\":2,\"title\":\"Anomalies by Alert Names\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"alertname\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Anomalies by Alert Names\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| where alert_name_s == '{alertname}'\\n| summarize Count = count () by TimeGenerated, srcip_s, user_s, from_user_s, app_s, severity_s, alert_name_s\",\"size\":2,\"title\":\"Users by Anomaly Alert Name\",\"noDataMessage\":\"Select Alert Name\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"TimeGenerated\",\"label\":\"TimeGenerated\"},{\"columnId\":\"srcip_s\",\"label\":\"Source IP\"},{\"columnId\":\"user_s\",\"label\":\"User\"},{\"columnId\":\"from_user_s\",\"label\":\"From_User\"},{\"columnId\":\"app_s\",\"label\":\"Application\"},{\"columnId\":\"severity_s\",\"label\":\"Severity\"},{\"columnId\":\"alert_name_s\",\"label\":\"Alert_Name\"},{\"columnId\":\"Count\",\"label\":\"Count\"}]}},\"customWidth\":\"67\",\"name\":\"Users by Anomaly Alert Name\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| summarize Count = count () by severity_s\",\"size\":2,\"title\":\"Anomalies by Severity Level\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Anomalies by Severity Level\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_Alerts_CL\\n| where alert_type_s == \\\"uba\\\"\\n| summarize count() by bin(TimeGenerated, {TimeRange:grain}), severity_s\",\"size\":2,\"title\":\"Anomalies Over Time\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"customWidth\":\"67\",\"name\":\"Anomalies Over Time\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Behavior Analytics\"},\"name\":\"UBA\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Security Alerts\"},\"name\":\"Alerts\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"0f03bf28-2c13-4018-ac1b-4dbec5b168fc\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":7776000000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL \\n| summarize Count = count() by x_c_browser_s\\n\",\"size\":2,\"title\":\"Browser Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Browser Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL \\n| summarize Count = count() by x_c_device_s\\n\",\"size\":2,\"title\":\"Device Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Device Breakdown\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL \\n| summarize Count = count() by cs_host_s\\n\",\"size\":2,\"title\":\"Top Hosts\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top Hosts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL \\n| summarize Count = count() by x_cs_app_s\",\"size\":2,\"title\":\"Top Apps\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"app\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10}},\"customWidth\":\"33\",\"name\":\"Top Apps\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL \\n| summarize Count = count() by cs_method_s\",\"size\":2,\"title\":\"HTTP Methods by Names\",\"timeContextFromParameter\":\"TimeRange\",\"exportFieldName\":\"series\",\"exportParameterName\":\"method\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"33\",\"name\":\"HTTP Methods by Names\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL\\n| where cs_method_s == '{method}' and x_cs_app_s == '{app}'\\n| summarize Count = count() by TimeGenerated, cs_username_s, x_cs_app_s,cs_method_s \\n| sort by Count desc\",\"size\":2,\"title\":\"Users by App and HTTP Method\",\"noDataMessage\":\"No Record Found\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"filter\":true,\"labelSettings\":[{\"columnId\":\"cs_username_s\",\"label\":\"User\"},{\"columnId\":\"x_cs_app_s\",\"label\":\"App\"},{\"columnId\":\"cs_method_s\",\"label\":\"HTTP_Method\"},{\"columnId\":\"Count\",\"label\":\"Count\"}]}},\"customWidth\":\"33\",\"name\":\"Users by App and HTTP Method\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Netskope_WebTX_CL\\n| summarize TotalBytes = sum (toint(bytes_s)/1024.0/1024.0) by bin(TimeGenerated, {TimeRange:grain}), x_cs_app_s\",\"size\":2,\"title\":\"App Traffic Volume\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"xAxis\":\"TimeGenerated\",\"yAxis\":[\"TotalBytes\"],\"ySettings\":{\"numberFormatSettings\":{\"unit\":38,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}}},\"name\":\"App Traffic Volume\"}]},\"conditionalVisibility\":{\"parameterName\":\"selTab\",\"comparison\":\"isEqualTo\",\"value\":\"Web Transcations\"},\"name\":\"Web Transactions\"}],\"fromTemplateId\":\"sentinel-Netskope\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=NetskopeWorkbook; logoFileName=Netskope_logo.svg; description=Gain insights and comprehensive monitoring into Netskope events data by analyzing traffic and user activities.\nThis workbook provides insights into various Netskope events types such as Cloud Firewall, Network Private Access, Applications, Security Alerts as well as Web Transactions.\nYou can use this workbook to get visibility in to your Netskope Security Cloud and quickly identify threats, anamolies, traffic patterns, cloud application useage, blocked URL addresses and more.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0; title=Netskope; templateRelativePath=NetskopeEvents.json; subtitle=; provider=Netskope}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskope",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Netskope_Events_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Netskope_Alerts_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "Netskope_WebTX_CL",
                      "kind": "DataType"
                    }
                  ]
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs",
      "apiVersion": "2022-02-01",
      "name": "[variables('parserTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Parser"
      },
      "properties": {
        "description": "Netskope Data Parser with template",
        "displayName": "Netskope Data Parser template"
      }
    },
    {
      "type": "Microsoft.Resources/templateSpecs/versions",
      "apiVersion": "2022-02-01",
      "name": "[concat(variables('parserTemplateSpecName1'),'/',variables('parserVersion1'))]",
      "location": "[parameters('workspace-location')]",
      "tags": {
        "hidden-sentinelWorkspaceId": "[variables('workspaceResourceId')]",
        "hidden-sentinelContentType": "Parser"
      },
      "dependsOn": [
        "[resourceId('Microsoft.Resources/templateSpecs', variables('parserTemplateSpecName1'))]"
      ],
      "properties": {
        "description": "Netskope Data Parser with template version 2.0.3",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('_parserName1')]",
              "apiVersion": "2020-08-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Netskope",
                "category": "Samples",
                "functionAlias": "Netskope",
                "query": "\nNetskope_CL\r\n| project SourceSystem, TimeGenerated, Type, TenantId,\r\nInsertionEpochTimestamp = column_ifexists(\"_insertion_epoch_timestamp_d\", \"\"),\r\nAccessMethod = column_ifexists(\"access_method_s\", \"\"),\r\nAcked = column_ifexists(\"acked_s\", \"\"),\r\nActivity = column_ifexists(\"activity_s\", \"\"),\r\nAlertName = column_ifexists(\"alert_name_s\", \"\"),\r\nAlert = column_ifexists(\"alert_s\", \"\"),\r\nAlertType = column_ifexists(\"alert_type_s\", \"\"),\r\nAppName = column_ifexists(\"app_s\", \"\"),\r\nAppCategory = column_ifexists(\"appcategory_s\", \"\"),\r\nBrowser = column_ifexists(\"browser_s\", \"\"),\r\nBrowserVersion = column_ifexists(\"browser_version_s\", \"\"),\r\nBypassTraffic = column_ifexists(\"bypass_traffic_s\", \"\"),\r\nCcl = column_ifexists(\"ccl_s\", \"\"),\r\nClientBytes = column_ifexists(\"client_bytes_d\", \"\"),\r\nCount = column_ifexists(\"count_d\", \"\"),\r\nDevice = column_ifexists(\"device_s\", \"\"),\r\nDomain = column_ifexists(\"domain_s\", \"\"),\r\nDstGeoCountry = column_ifexists(\"dst_country_s\", \"\"),\r\nDstGeoLatitude = column_ifexists(\"dst_latitude_d\", \"\"),\r\nDstGeoLocation = column_ifexists(\"dst_location_s\", \"\"),\r\nDstGeoLongitude = column_ifexists(\"dst_longitude_d\", \"\"),\r\nDstGeoRegion = column_ifexists(\"dst_region_s\", \"\"),\r\nDstGeoTimezone = column_ifexists(\"dst_timezone_s\", \"\"),\r\nDstGeoZipcode = column_ifexists(\"dst_zipcode_s\", \"\"),\r\nDstIpAddr = column_ifexists(\"dstip_s\", \"\"),\r\nDstPort = column_ifexists(\"dstport_d\", \"\"),\r\nFromUser = column_ifexists(\"from_user_s\", \"\"),\r\nHostname = column_ifexists(\"hostname_s\", \"\"),\r\nHttpTransactionCount = column_ifexists(\"http_transaction_count_d\", \"\"),\r\nLatencyMax = column_ifexists(\"latency_max_d\", \"\"),\r\nLatencyMin = column_ifexists(\"latency_min_d\", \"\"),\r\nLatencyTotal = column_ifexists(\"latency_total_d\", \"\"),\r\nNumBytes = column_ifexists(\"numbytes_d\", \"\"),\r\nObject = column_ifexists(\"object_s\", \"\"),\r\nObjectType = column_ifexists(\"object_type_s\", \"\"),\r\nOrg = column_ifexists(\"org_s\", \"\"),\r\nOrganizationUnit = column_ifexists(\"organization_unit_s\", \"\"),\r\nOs = column_ifexists(\"os_s\", \"\"),\r\nOsVersion = column_ifexists(\"os_version_s\", \"\"),\r\nPage = column_ifexists(\"page_s\", \"\"),\r\nPolicy = column_ifexists(\"policy_s\", \"\"),\r\nReqCnt = column_ifexists(\"req_cnt_d\", \"\"),\r\nRespCnt = column_ifexists(\"resp_cnt_d\", \"\"),\r\nServerBytes = column_ifexists(\"server_bytes_d\", \"\"),\r\nSite = column_ifexists(\"site_s\", \"\"),\r\nSrcGeoCountry = column_ifexists(\"src_country_s\", \"\"),\r\nSrcGeoLatitude = column_ifexists(\"src_latitude_d\", \"\"),\r\nSrcGeoLocation = column_ifexists(\"src_location_s\", \"\"),\r\nSrcGeoLongitude = column_ifexists(\"src_longitude_d\", \"\"),\r\nSrcGeoRegion = column_ifexists(\"src_region_s\", \"\"),\r\nSrcGeoTimezone = column_ifexists(\"src_timezone_s\", \"\"),\r\nSrcGeoZipcode = column_ifexists(\"src_zipcode_s\", \"\"),\r\nSrcIpAddr = column_ifexists(\"srcip_s\", \"\"),\r\nTimestamp = column_ifexists(\"timestamp_d\", \"\"),\r\nToUser = column_ifexists(\"to_user_s\", \"\"),\r\nTrafficType = column_ifexists(\"traffic_type_s\", \"\"),\r\nLogType = column_ifexists(\"type_s\", \"\"),\r\nUrNormalized = column_ifexists(\"ur_normalized_s\", \"\"),\r\nUrl = column_ifexists(\"url_s\", \"\"),\r\nUserGenerated = column_ifexists(\"user_generated_s\", \"\"),\r\nUser = column_ifexists(\"user_s\", \"\"),\r\nUserAgent = column_ifexists(\"useragent_s\", \"\"),\r\nUserIp = column_ifexists(\"userip_s\", \"\"),\r\nUserKey = column_ifexists(\"userkey_s\", \"\"),\r\nIaasAssetTags = column_ifexists(\"iaas_asset_tags_s\", \"\"),\r\nDlpIsUniqueCount = column_ifexists(\"dlp_is_unique_count_s\", \"\"),\r\nFilePasswdProtected = column_ifexists(\"file_passwd_protected_s\", \"\"),\r\nMalicious = column_ifexists(\"malicious_s\", \"\"),\r\nManagedApp = column_ifexists(\"managed_app_s\", \"\"),\r\nShared = column_ifexists(\"shared_s\", \"\"),\r\nModified = column_ifexists(\"modified_s\", \"\"),\r\nConnEndtime = column_ifexists(\"conn_endtime_s\", \"\"),\r\nConnStarttime = column_ifexists(\"conn_starttime_s\", \"\"),\r\nMalsiteLatitude = column_ifexists(\"malsite_latitude_s\", \"\"),\r\nMalsiteLongitude = column_ifexists(\"malsite_longitude_s\", \"\"),\r\nMalsiteReputation = column_ifexists(\"malsite_reputation_s\", \"\"),\r\nBreachDate = column_ifexists(\"breach_date_d\", \"\"),\r\nBreachScore = column_ifexists(\"breach_score_d\", \"\"),\r\nConnDuration = column_ifexists(\"conn_duration_d\", \"\"),\r\nDlpFingerprintScore = column_ifexists(\"dlp_fingerprint_score_d\", \"\"),\r\nDlpRuleCount = column_ifexists(\"dlp_rule_count_d\", \"\"),\r\nDlpRuleScore = column_ifexists(\"dlp_rule_score_d\", \"\"),\r\nDlpUniqueCount = column_ifexists(\"dlp_unique_count_d\", \"\"),\r\nDstGeoipSrc = column_ifexists(\"dst_geoip_src_d\", \"\"),\r\nExternalCollaboratorCount = column_ifexists(\"external_collaborator_count_d\", \"\"),\r\nFileSize = column_ifexists(\"file_size_d\", \"\"),\r\nInternalCollaboratorCount = column_ifexists(\"internal_collaborator_count_d\", \"\"),\r\nMalsiteActive = column_ifexists(\"malsite_active_d\", \"\"),\r\nMalsiteConfidence = column_ifexists(\"malsite_confidence_d\", \"\"),\r\nMalsiteConsecutive = column_ifexists(\"malsite_consecutive_d\", \"\"),\r\nMalsiteFirstSeen = column_ifexists(\"malsite_first_seen_d\", \"\"),\r\nMalsiteHostility = column_ifexists(\"malsite_hostility_d\", \"\"),\r\nMalsiteLastSeen = column_ifexists(\"malsite_last_seen_d\", \"\"),\r\nObjectCount = column_ifexists(\"object_count_d\", \"\"),\r\nPathId = column_ifexists(\"path_id_d\", \"\"),\r\nPolicyId = column_ifexists(\"policy_id_d\", \"\"),\r\nQuarantineProfileId = column_ifexists(\"quarantine_profile_id_d\", \"\"),\r\nRequestId = column_ifexists(\"request_id_d\", \"\"),\r\nRequestIdNew = column_ifexists(\"requestid_s\", \"\"),\r\nRiskLevelId = column_ifexists(\"risk_level_id_d\", \"\"),\r\nRunId = column_ifexists(\"run_id_d\", \"\"),\r\nSaProfileId = column_ifexists(\"sa_profile_id_d\", \"\"),\r\nSaRuleId = column_ifexists(\"sa_rule_id_d\", \"\"),\r\nSessionId = column_ifexists(\"session_id_d\", \"\"),\r\nSessionid = column_ifexists(\"sessionid_d\", \"\"),\r\nSeverityId = column_ifexists(\"severity_id_d\", \"\"),\r\nSeverityLevelId = column_ifexists(\"severity_level_id_d\", \"\"),\r\nSrcGeoIpSrc = column_ifexists(\"src_geoip_src_d\", \"\"),\r\nSuppressionEndTime = column_ifexists(\"suppression_end_time_d\", \"\"),\r\nSuppressionStartTime = column_ifexists(\"suppression_start_time_d\", \"\"),\r\nThreatSourceId = column_ifexists(\"threat_source_id_d\", \"\"),\r\nThreshold = column_ifexists(\"threshold_d\", \"\"),\r\nTotalCollaboratorCount = column_ifexists(\"total_collaborator_count_d\", \"\"),\r\nBinTimestamp = column_ifexists(\"bin_timestamp_d\", \"\"),\r\nBrowserSessionId = column_ifexists(\"browser_session_id_d\", \"\"),\r\nBrowserSessionIdNew = column_ifexists(\"browser_sessionid_s\", \"\"),\r\nConnectionId = column_ifexists(\"connection_id_d\", \"\"),\r\nConnectionIdNew = column_ifexists(\"connectionid_s\", \"\"),\r\nLastTimestamp = column_ifexists(\"last_timestamp_d\", \"\"),\r\nScanTime = column_ifexists(\"scan_time_d\", \"\"),\r\nThresholdTime = column_ifexists(\"threshold_time_d\", \"\"),\r\nAccountId = column_ifexists(\"account_id_d\", \"\"),\r\nAccountName = column_ifexists(\"account_name_s\", \"\"),\r\nActUser = column_ifexists(\"act_user_s\", \"\"),\r\nAction = column_ifexists(\"action_s\", \"\"),\r\nActivityStatus = column_ifexists(\"activity_status_s\", \"\"),\r\nActivityType = column_ifexists(\"activity_type_s\", \"\"),\r\nAppSessionId = column_ifexists(\"app_session_id_d\", \"\"),\r\nAppSessionIdNew = column_ifexists(\"app_sessionid_s\", \"\"),\r\nAttachment = column_ifexists(\"attachment_s\", \"\"),\r\nAuditCategory = column_ifexists(\"audit_category_s\", \"\"),\r\nAuditType = column_ifexists(\"audit_type_s\", \"\"),\r\nBreachId = column_ifexists(\"breach_id_s\", \"\"),\r\nBreachMediaReferences = column_ifexists(\"breach_media_references_s\", \"\"),\r\nBreachTargetReferences = column_ifexists(\"breach_target_references_s\", \"\"),\r\nChannel = column_ifexists(\"channel_s\", \"\"),\r\nDataType = column_ifexists(\"data_type_s\", \"\"),\r\nDetectionEngine = column_ifexists(\"detection_engine_s\", \"\"),\r\nDetectionType = column_ifexists(\"detection_type_s\", \"\"),\r\nDeviceClassification = column_ifexists(\"device_classification_s\", \"\"),\r\nDlpFile = column_ifexists(\"dlp_file_s\", \"\"),\r\nDlpFingerprintClassification = column_ifexists(\"dlp_fingerprint_classification_s\", \"\"),\r\nDlpFingerprintMatch = column_ifexists(\"dlp_fingerprint_match_s\", \"\"),\r\nDlpIncidentId = column_ifexists(\"dlp_incident_id_d\", \"\"),\r\nDlpIncidentIdNew = column_ifexists(\"dlp_incidentid_s\", \"\"),\r\nDlpParentId = column_ifexists(\"dlp_parent_id_d\", \"\"),\r\nDlpParentIdNew = column_ifexists(\"dlp_parentid_s\", \"\"),\r\nDlpProfile = column_ifexists(\"dlp_profile_s\", \"\"),\r\nDlpRule = column_ifexists(\"dlp_rule_s\", \"\"),\r\nDlpRuleSeverity = column_ifexists(\"dlp_rule_severity_s\", \"\"),\r\nDownloadApp = column_ifexists(\"download_app_s\", \"\"),\r\nDstHostname = column_ifexists(\"dsthost_s\", \"\"),\r\nDynamicClassification = column_ifexists(\"dynamic_classification_s\", \"\"),\r\nEncryptFailure = column_ifexists(\"encrypt_failure_s\", \"\"),\r\nEnterprise = column_ifexists(\"enterprise_s\", \"\"),\r\nEnterpriseId = column_ifexists(\"enterprise_id_s\", \"\"),\r\nEventType = column_ifexists(\"event_type_s\", \"\"),\r\nExposure = column_ifexists(\"exposure_s\", \"\"),\r\nFileId = column_ifexists(\"file_id_s\", \"\"),\r\nFileLang = column_ifexists(\"file_lang_s\", \"\"),\r\nFilePath = column_ifexists(\"file_path_s\", \"\"),\r\nFileType = column_ifexists(\"file_type_s\", \"\"),\r\nFileName = column_ifexists(\"filename_s\", \"\"),\r\nFromObject = column_ifexists(\"from_object_s\", \"\"),\r\nFromUserCategory = column_ifexists(\"from_user_category_s\", \"\"),\r\nFromlogs = column_ifexists(\"fromlogs_s\", \"\"),\r\nInstance = column_ifexists(\"instance_s\", \"\"),\r\nInstanceId = column_ifexists(\"instance_id_s\", \"\"),\r\nInstanceName = column_ifexists(\"instance_name_s\", \"\"),\r\nInstanceType = column_ifexists(\"instance_type_s\", \"\"),\r\nJustificationReason = column_ifexists(\"justification_reason_s\", \"\"),\r\nJustificationType = column_ifexists(\"justification_type_s\", \"\"),\r\nLastApp = column_ifexists(\"last_app_s\", \"\"),\r\nLastCountry = column_ifexists(\"last_country_s\", \"\"),\r\nLastDevice = column_ifexists(\"last_device_s\", \"\"),\r\nLastLocation = column_ifexists(\"last_location_s\", \"\"),\r\nLastRegion = column_ifexists(\"last_region_s\", \"\"),\r\nLegalHoldProfileName = column_ifexists(\"legal_hold_profile_name_s\", \"\"),\r\nLhCustodianEmail = column_ifexists(\"lh_custodian_email_s\", \"\"),\r\nLhCustodianName = column_ifexists(\"lh_custodian_name_s\", \"\"),\r\nLhDestApp = column_ifexists(\"lh_dest_app_s\", \"\"),\r\nLhDestInstance = column_ifexists(\"lh_dest_instance_s\", \"\"),\r\nLhFileid = column_ifexists(\"lh_fileid_s\", \"\"),\r\nLhFilename = column_ifexists(\"lh_filename_s\", \"\"),\r\nLhFilepath = column_ifexists(\"lh_filepath_s\", \"\"),\r\nLhOriginalFilename = column_ifexists(\"lh_original_filename_s\", \"\"),\r\nLhShared = column_ifexists(\"lh_shared_s\", \"\"),\r\nLhSharedWith = column_ifexists(\"lh_shared_with_s\", \"\"),\r\nLhVersion = column_ifexists(\"lh_version_s\", \"\"),\r\nLocalMd5 = column_ifexists(\"local_md5_s\", \"\"),\r\nLocalSha1 = column_ifexists(\"local_sha1_s\", \"\"),\r\nLocalSha256 = column_ifexists(\"local_sha256_s\", \"\"),\r\nLogFileName = column_ifexists(\"log_file_name_s\", \"\"),\r\nLoginType = column_ifexists(\"logintype_s\", \"\"),\r\nLoginUrl = column_ifexists(\"loginurl_s\", \"\"),\r\nMalsiteAsNumber = column_ifexists(\"malsite_as_number_s\", \"\"),\r\nMalsiteCategory = column_ifexists(\"malsite_category_s\", \"\"),\r\nMalsiteCity = column_ifexists(\"malsite_city_s\", \"\"),\r\nMalsiteCountry = column_ifexists(\"malsite_country_s\", \"\"),\r\nMalsiteDnsServer = column_ifexists(\"malsite_dns_server_s\", \"\"),\r\nMalsiteId = column_ifexists(\"malsite_id_s\", \"\"),\r\nMalsiteIpHost = column_ifexists(\"malsite_ip_host_s\", \"\"),\r\nMalsiteIsp = column_ifexists(\"malsite_isp_s\", \"\"),\r\nMalsiteRegion = column_ifexists(\"malsite_region_s\", \"\"),\r\nMalwareId = column_ifexists(\"malware_id_s\", \"\"),\r\nMalwareName = column_ifexists(\"malware_name_s\", \"\"),\r\nMalwareProfile = column_ifexists(\"malware_profile_s\", \"\"),\r\nMalwareSeverity = column_ifexists(\"malware_severity_s\", \"\"),\r\nMalwareType = column_ifexists(\"malware_type_s\", \"\"),\r\nManagementid = column_ifexists(\"managementID_s\", \"\"),\r\nMd5 = column_ifexists(\"md5_s\", \"\"),\r\nMimeType = column_ifexists(\"mime_type_s\", \"\"),\r\nNewValue = column_ifexists(\"new_value_s\", \"\"),\r\nNsActivity = column_ifexists(\"ns_activity_s\", \"\"),\r\nNsdeviceuid = column_ifexists(\"nsdeviceuid_s\", \"\"),\r\nObjectId = column_ifexists(\"object_id_s\", \"\"),\r\nOldValue = column_ifexists(\"old_value_s\", \"\"),\r\nOrigTy = column_ifexists(\"orig_ty_s\", \"\"),\r\nOriginalFilePath = column_ifexists(\"original_file_path_s\", \"\"),\r\nOwner = column_ifexists(\"owner_s\", \"\"),\r\nProfileEmails = column_ifexists(\"profile_emails_s\", \"\"),\r\nProfileId = column_ifexists(\"profile_id_s\", \"\"),\r\nQAdmin = column_ifexists(\"q_admin_s\", \"\"),\r\nQApp = column_ifexists(\"q_app_s\", \"\"),\r\nQInstance = column_ifexists(\"q_instance_s\", \"\"),\r\nQOriginalFilename = column_ifexists(\"q_original_filename_s\", \"\"),\r\nQOriginalFilepath = column_ifexists(\"q_original_filepath_s\", \"\"),\r\nQOriginalShared = column_ifexists(\"q_original_shared_s\", \"\"),\r\nQOriginalVersion = column_ifexists(\"q_original_version_s\", \"\"),\r\nQuarantineActionReason = column_ifexists(\"quarantine_action_reason_s\", \"\"),\r\nQuarantineFailure = column_ifexists(\"quarantine_failure_s\", \"\"),\r\nQuarantineFileId = column_ifexists(\"quarantine_file_id_s\", \"\"),\r\nQuarantineFileName = column_ifexists(\"quarantine_file_name_s\", \"\"),\r\nQuarantineProfile = column_ifexists(\"quarantine_profile_s\", \"\"),\r\nReferer = column_ifexists(\"referer_s\", \"\"),\r\nRegionId = column_ifexists(\"region_id_s\", \"\"),\r\nRegionName = column_ifexists(\"region_name_s\", \"\"),\r\nResourceCategory = column_ifexists(\"resource_category_s\", \"\"),\r\nRetroScanName = column_ifexists(\"retro_scan_name_s\", \"\"),\r\nRiskLevel = column_ifexists(\"risk_level_s\", \"\"),\r\nRole = column_ifexists(\"role_s\", \"\"),\r\nSaProfileName = column_ifexists(\"sa_profile_name_s\", \"\"),\r\nSaRuleName = column_ifexists(\"sa_rule_name_s\", \"\"),\r\nSaRuleSeverity = column_ifexists(\"sa_rule_severity_s\", \"\"),\r\nScanType = column_ifexists(\"scan_type_s\", \"\"),\r\nScopes = column_ifexists(\"scopes_s\", \"\"),\r\nSeverity = column_ifexists(\"severity_s\", \"\"),\r\nSeverityLevel = column_ifexists(\"severity_level_s\", \"\"),\r\nSharedCredentialUser = column_ifexists(\"shared_credential_user_s\", \"\"),\r\nSharedDomains = column_ifexists(\"shared_domains_s\", \"\"),\r\nSharedType = column_ifexists(\"shared_type_s\", \"\"),\r\nSharedWith = column_ifexists(\"shared_with_s\", \"\"),\r\nSslDecryptPolicy = column_ifexists(\"ssl_decrypt_policy_s\", \"\"),\r\nSubType = column_ifexists(\"sub_type_s\", \"\"),\r\nSuppressionKey = column_ifexists(\"suppression_key_s\", \"\"),\r\nTeam = column_ifexists(\"team_s\", \"\"),\r\nTelemetryApp = column_ifexists(\"telemetry_app_s\", \"\"),\r\nThreatMatchField = column_ifexists(\"threat_match_field_s\", \"\"),\r\nTitle = column_ifexists(\"title_s\", \"\"),\r\nToObject = column_ifexists(\"to_object_s\", \"\"),\r\nToUserCategory = column_ifexists(\"to_user_category_s\", \"\"),\r\nTransactionId = column_ifexists(\"transaction_id_d\", \"\"),\r\nTransactionIdNew = column_ifexists(\"transactionid_s\", \"\"),\r\nTssMode = column_ifexists(\"tss_mode_s\", \"\"),\r\nTunnelId = column_ifexists(\"tunnel_id_s\", \"\"),\r\nUrl2Activity = column_ifexists(\"Url2Activity_s\", \"\"),\r\nUserCategory = column_ifexists(\"user_category_s\", \"\"),\r\nUserId = column_ifexists(\"user_id_s\", \"\"),\r\nUserName = column_ifexists(\"user_name_s\", \"\"),\r\nUserNormalized = column_ifexists(\"user_normalized_s\", \"\"),\r\nUserRole = column_ifexists(\"user_role_s\", \"\"),\r\nViolatingUser = column_ifexists(\"violating_user_s\", \"\"),\r\nViolatingUserType = column_ifexists(\"violating_user_type_s\", \"\"),\r\nWebUrl = column_ifexists(\"web_url_s\", \"\"),\r\nWorkspace = column_ifexists(\"workspace_s\", \"\"),\r\nWorkspaceId = column_ifexists(\"workspace_id_s\", \"\"),\r\nZipPassword = column_ifexists(\"zip_password_s\", \"\")\r\n\r\n\r\n",
                "version": 1,
                "tags": [
                  {
                    "name": "description",
                    "value": "Netskope"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('_parserId1'),'/'))))]",
              "dependsOn": [
                "[variables('_parserName1')]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
                "contentId": "[variables('_parserContentId1')]",
                "kind": "Parser",
                "version": "[variables('parserVersion1')]",
                "source": {
                  "name": "Netskope",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2021-06-01",
      "name": "[variables('_parserName1')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Netskope",
        "category": "Samples",
        "functionAlias": "Netskope",
        "query": "\nNetskope_CL\r\n| project SourceSystem, TimeGenerated, Type, TenantId,\r\nInsertionEpochTimestamp = column_ifexists(\"_insertion_epoch_timestamp_d\", \"\"),\r\nAccessMethod = column_ifexists(\"access_method_s\", \"\"),\r\nAcked = column_ifexists(\"acked_s\", \"\"),\r\nActivity = column_ifexists(\"activity_s\", \"\"),\r\nAlertName = column_ifexists(\"alert_name_s\", \"\"),\r\nAlert = column_ifexists(\"alert_s\", \"\"),\r\nAlertType = column_ifexists(\"alert_type_s\", \"\"),\r\nAppName = column_ifexists(\"app_s\", \"\"),\r\nAppCategory = column_ifexists(\"appcategory_s\", \"\"),\r\nBrowser = column_ifexists(\"browser_s\", \"\"),\r\nBrowserVersion = column_ifexists(\"browser_version_s\", \"\"),\r\nBypassTraffic = column_ifexists(\"bypass_traffic_s\", \"\"),\r\nCcl = column_ifexists(\"ccl_s\", \"\"),\r\nClientBytes = column_ifexists(\"client_bytes_d\", \"\"),\r\nCount = column_ifexists(\"count_d\", \"\"),\r\nDevice = column_ifexists(\"device_s\", \"\"),\r\nDomain = column_ifexists(\"domain_s\", \"\"),\r\nDstGeoCountry = column_ifexists(\"dst_country_s\", \"\"),\r\nDstGeoLatitude = column_ifexists(\"dst_latitude_d\", \"\"),\r\nDstGeoLocation = column_ifexists(\"dst_location_s\", \"\"),\r\nDstGeoLongitude = column_ifexists(\"dst_longitude_d\", \"\"),\r\nDstGeoRegion = column_ifexists(\"dst_region_s\", \"\"),\r\nDstGeoTimezone = column_ifexists(\"dst_timezone_s\", \"\"),\r\nDstGeoZipcode = column_ifexists(\"dst_zipcode_s\", \"\"),\r\nDstIpAddr = column_ifexists(\"dstip_s\", \"\"),\r\nDstPort = column_ifexists(\"dstport_d\", \"\"),\r\nFromUser = column_ifexists(\"from_user_s\", \"\"),\r\nHostname = column_ifexists(\"hostname_s\", \"\"),\r\nHttpTransactionCount = column_ifexists(\"http_transaction_count_d\", \"\"),\r\nLatencyMax = column_ifexists(\"latency_max_d\", \"\"),\r\nLatencyMin = column_ifexists(\"latency_min_d\", \"\"),\r\nLatencyTotal = column_ifexists(\"latency_total_d\", \"\"),\r\nNumBytes = column_ifexists(\"numbytes_d\", \"\"),\r\nObject = column_ifexists(\"object_s\", \"\"),\r\nObjectType = column_ifexists(\"object_type_s\", \"\"),\r\nOrg = column_ifexists(\"org_s\", \"\"),\r\nOrganizationUnit = column_ifexists(\"organization_unit_s\", \"\"),\r\nOs = column_ifexists(\"os_s\", \"\"),\r\nOsVersion = column_ifexists(\"os_version_s\", \"\"),\r\nPage = column_ifexists(\"page_s\", \"\"),\r\nPolicy = column_ifexists(\"policy_s\", \"\"),\r\nReqCnt = column_ifexists(\"req_cnt_d\", \"\"),\r\nRespCnt = column_ifexists(\"resp_cnt_d\", \"\"),\r\nServerBytes = column_ifexists(\"server_bytes_d\", \"\"),\r\nSite = column_ifexists(\"site_s\", \"\"),\r\nSrcGeoCountry = column_ifexists(\"src_country_s\", \"\"),\r\nSrcGeoLatitude = column_ifexists(\"src_latitude_d\", \"\"),\r\nSrcGeoLocation = column_ifexists(\"src_location_s\", \"\"),\r\nSrcGeoLongitude = column_ifexists(\"src_longitude_d\", \"\"),\r\nSrcGeoRegion = column_ifexists(\"src_region_s\", \"\"),\r\nSrcGeoTimezone = column_ifexists(\"src_timezone_s\", \"\"),\r\nSrcGeoZipcode = column_ifexists(\"src_zipcode_s\", \"\"),\r\nSrcIpAddr = column_ifexists(\"srcip_s\", \"\"),\r\nTimestamp = column_ifexists(\"timestamp_d\", \"\"),\r\nToUser = column_ifexists(\"to_user_s\", \"\"),\r\nTrafficType = column_ifexists(\"traffic_type_s\", \"\"),\r\nLogType = column_ifexists(\"type_s\", \"\"),\r\nUrNormalized = column_ifexists(\"ur_normalized_s\", \"\"),\r\nUrl = column_ifexists(\"url_s\", \"\"),\r\nUserGenerated = column_ifexists(\"user_generated_s\", \"\"),\r\nUser = column_ifexists(\"user_s\", \"\"),\r\nUserAgent = column_ifexists(\"useragent_s\", \"\"),\r\nUserIp = column_ifexists(\"userip_s\", \"\"),\r\nUserKey = column_ifexists(\"userkey_s\", \"\"),\r\nIaasAssetTags = column_ifexists(\"iaas_asset_tags_s\", \"\"),\r\nDlpIsUniqueCount = column_ifexists(\"dlp_is_unique_count_s\", \"\"),\r\nFilePasswdProtected = column_ifexists(\"file_passwd_protected_s\", \"\"),\r\nMalicious = column_ifexists(\"malicious_s\", \"\"),\r\nManagedApp = column_ifexists(\"managed_app_s\", \"\"),\r\nShared = column_ifexists(\"shared_s\", \"\"),\r\nModified = column_ifexists(\"modified_s\", \"\"),\r\nConnEndtime = column_ifexists(\"conn_endtime_s\", \"\"),\r\nConnStarttime = column_ifexists(\"conn_starttime_s\", \"\"),\r\nMalsiteLatitude = column_ifexists(\"malsite_latitude_s\", \"\"),\r\nMalsiteLongitude = column_ifexists(\"malsite_longitude_s\", \"\"),\r\nMalsiteReputation = column_ifexists(\"malsite_reputation_s\", \"\"),\r\nBreachDate = column_ifexists(\"breach_date_d\", \"\"),\r\nBreachScore = column_ifexists(\"breach_score_d\", \"\"),\r\nConnDuration = column_ifexists(\"conn_duration_d\", \"\"),\r\nDlpFingerprintScore = column_ifexists(\"dlp_fingerprint_score_d\", \"\"),\r\nDlpRuleCount = column_ifexists(\"dlp_rule_count_d\", \"\"),\r\nDlpRuleScore = column_ifexists(\"dlp_rule_score_d\", \"\"),\r\nDlpUniqueCount = column_ifexists(\"dlp_unique_count_d\", \"\"),\r\nDstGeoipSrc = column_ifexists(\"dst_geoip_src_d\", \"\"),\r\nExternalCollaboratorCount = column_ifexists(\"external_collaborator_count_d\", \"\"),\r\nFileSize = column_ifexists(\"file_size_d\", \"\"),\r\nInternalCollaboratorCount = column_ifexists(\"internal_collaborator_count_d\", \"\"),\r\nMalsiteActive = column_ifexists(\"malsite_active_d\", \"\"),\r\nMalsiteConfidence = column_ifexists(\"malsite_confidence_d\", \"\"),\r\nMalsiteConsecutive = column_ifexists(\"malsite_consecutive_d\", \"\"),\r\nMalsiteFirstSeen = column_ifexists(\"malsite_first_seen_d\", \"\"),\r\nMalsiteHostility = column_ifexists(\"malsite_hostility_d\", \"\"),\r\nMalsiteLastSeen = column_ifexists(\"malsite_last_seen_d\", \"\"),\r\nObjectCount = column_ifexists(\"object_count_d\", \"\"),\r\nPathId = column_ifexists(\"path_id_d\", \"\"),\r\nPolicyId = column_ifexists(\"policy_id_d\", \"\"),\r\nQuarantineProfileId = column_ifexists(\"quarantine_profile_id_d\", \"\"),\r\nRequestId = column_ifexists(\"request_id_d\", \"\"),\r\nRequestIdNew = column_ifexists(\"requestid_s\", \"\"),\r\nRiskLevelId = column_ifexists(\"risk_level_id_d\", \"\"),\r\nRunId = column_ifexists(\"run_id_d\", \"\"),\r\nSaProfileId = column_ifexists(\"sa_profile_id_d\", \"\"),\r\nSaRuleId = column_ifexists(\"sa_rule_id_d\", \"\"),\r\nSessionId = column_ifexists(\"session_id_d\", \"\"),\r\nSessionid = column_ifexists(\"sessionid_d\", \"\"),\r\nSeverityId = column_ifexists(\"severity_id_d\", \"\"),\r\nSeverityLevelId = column_ifexists(\"severity_level_id_d\", \"\"),\r\nSrcGeoIpSrc = column_ifexists(\"src_geoip_src_d\", \"\"),\r\nSuppressionEndTime = column_ifexists(\"suppression_end_time_d\", \"\"),\r\nSuppressionStartTime = column_ifexists(\"suppression_start_time_d\", \"\"),\r\nThreatSourceId = column_ifexists(\"threat_source_id_d\", \"\"),\r\nThreshold = column_ifexists(\"threshold_d\", \"\"),\r\nTotalCollaboratorCount = column_ifexists(\"total_collaborator_count_d\", \"\"),\r\nBinTimestamp = column_ifexists(\"bin_timestamp_d\", \"\"),\r\nBrowserSessionId = column_ifexists(\"browser_session_id_d\", \"\"),\r\nBrowserSessionIdNew = column_ifexists(\"browser_sessionid_s\", \"\"),\r\nConnectionId = column_ifexists(\"connection_id_d\", \"\"),\r\nConnectionIdNew = column_ifexists(\"connectionid_s\", \"\"),\r\nLastTimestamp = column_ifexists(\"last_timestamp_d\", \"\"),\r\nScanTime = column_ifexists(\"scan_time_d\", \"\"),\r\nThresholdTime = column_ifexists(\"threshold_time_d\", \"\"),\r\nAccountId = column_ifexists(\"account_id_d\", \"\"),\r\nAccountName = column_ifexists(\"account_name_s\", \"\"),\r\nActUser = column_ifexists(\"act_user_s\", \"\"),\r\nAction = column_ifexists(\"action_s\", \"\"),\r\nActivityStatus = column_ifexists(\"activity_status_s\", \"\"),\r\nActivityType = column_ifexists(\"activity_type_s\", \"\"),\r\nAppSessionId = column_ifexists(\"app_session_id_d\", \"\"),\r\nAppSessionIdNew = column_ifexists(\"app_sessionid_s\", \"\"),\r\nAttachment = column_ifexists(\"attachment_s\", \"\"),\r\nAuditCategory = column_ifexists(\"audit_category_s\", \"\"),\r\nAuditType = column_ifexists(\"audit_type_s\", \"\"),\r\nBreachId = column_ifexists(\"breach_id_s\", \"\"),\r\nBreachMediaReferences = column_ifexists(\"breach_media_references_s\", \"\"),\r\nBreachTargetReferences = column_ifexists(\"breach_target_references_s\", \"\"),\r\nChannel = column_ifexists(\"channel_s\", \"\"),\r\nDataType = column_ifexists(\"data_type_s\", \"\"),\r\nDetectionEngine = column_ifexists(\"detection_engine_s\", \"\"),\r\nDetectionType = column_ifexists(\"detection_type_s\", \"\"),\r\nDeviceClassification = column_ifexists(\"device_classification_s\", \"\"),\r\nDlpFile = column_ifexists(\"dlp_file_s\", \"\"),\r\nDlpFingerprintClassification = column_ifexists(\"dlp_fingerprint_classification_s\", \"\"),\r\nDlpFingerprintMatch = column_ifexists(\"dlp_fingerprint_match_s\", \"\"),\r\nDlpIncidentId = column_ifexists(\"dlp_incident_id_d\", \"\"),\r\nDlpIncidentIdNew = column_ifexists(\"dlp_incidentid_s\", \"\"),\r\nDlpParentId = column_ifexists(\"dlp_parent_id_d\", \"\"),\r\nDlpParentIdNew = column_ifexists(\"dlp_parentid_s\", \"\"),\r\nDlpProfile = column_ifexists(\"dlp_profile_s\", \"\"),\r\nDlpRule = column_ifexists(\"dlp_rule_s\", \"\"),\r\nDlpRuleSeverity = column_ifexists(\"dlp_rule_severity_s\", \"\"),\r\nDownloadApp = column_ifexists(\"download_app_s\", \"\"),\r\nDstHostname = column_ifexists(\"dsthost_s\", \"\"),\r\nDynamicClassification = column_ifexists(\"dynamic_classification_s\", \"\"),\r\nEncryptFailure = column_ifexists(\"encrypt_failure_s\", \"\"),\r\nEnterprise = column_ifexists(\"enterprise_s\", \"\"),\r\nEnterpriseId = column_ifexists(\"enterprise_id_s\", \"\"),\r\nEventType = column_ifexists(\"event_type_s\", \"\"),\r\nExposure = column_ifexists(\"exposure_s\", \"\"),\r\nFileId = column_ifexists(\"file_id_s\", \"\"),\r\nFileLang = column_ifexists(\"file_lang_s\", \"\"),\r\nFilePath = column_ifexists(\"file_path_s\", \"\"),\r\nFileType = column_ifexists(\"file_type_s\", \"\"),\r\nFileName = column_ifexists(\"filename_s\", \"\"),\r\nFromObject = column_ifexists(\"from_object_s\", \"\"),\r\nFromUserCategory = column_ifexists(\"from_user_category_s\", \"\"),\r\nFromlogs = column_ifexists(\"fromlogs_s\", \"\"),\r\nInstance = column_ifexists(\"instance_s\", \"\"),\r\nInstanceId = column_ifexists(\"instance_id_s\", \"\"),\r\nInstanceName = column_ifexists(\"instance_name_s\", \"\"),\r\nInstanceType = column_ifexists(\"instance_type_s\", \"\"),\r\nJustificationReason = column_ifexists(\"justification_reason_s\", \"\"),\r\nJustificationType = column_ifexists(\"justification_type_s\", \"\"),\r\nLastApp = column_ifexists(\"last_app_s\", \"\"),\r\nLastCountry = column_ifexists(\"last_country_s\", \"\"),\r\nLastDevice = column_ifexists(\"last_device_s\", \"\"),\r\nLastLocation = column_ifexists(\"last_location_s\", \"\"),\r\nLastRegion = column_ifexists(\"last_region_s\", \"\"),\r\nLegalHoldProfileName = column_ifexists(\"legal_hold_profile_name_s\", \"\"),\r\nLhCustodianEmail = column_ifexists(\"lh_custodian_email_s\", \"\"),\r\nLhCustodianName = column_ifexists(\"lh_custodian_name_s\", \"\"),\r\nLhDestApp = column_ifexists(\"lh_dest_app_s\", \"\"),\r\nLhDestInstance = column_ifexists(\"lh_dest_instance_s\", \"\"),\r\nLhFileid = column_ifexists(\"lh_fileid_s\", \"\"),\r\nLhFilename = column_ifexists(\"lh_filename_s\", \"\"),\r\nLhFilepath = column_ifexists(\"lh_filepath_s\", \"\"),\r\nLhOriginalFilename = column_ifexists(\"lh_original_filename_s\", \"\"),\r\nLhShared = column_ifexists(\"lh_shared_s\", \"\"),\r\nLhSharedWith = column_ifexists(\"lh_shared_with_s\", \"\"),\r\nLhVersion = column_ifexists(\"lh_version_s\", \"\"),\r\nLocalMd5 = column_ifexists(\"local_md5_s\", \"\"),\r\nLocalSha1 = column_ifexists(\"local_sha1_s\", \"\"),\r\nLocalSha256 = column_ifexists(\"local_sha256_s\", \"\"),\r\nLogFileName = column_ifexists(\"log_file_name_s\", \"\"),\r\nLoginType = column_ifexists(\"logintype_s\", \"\"),\r\nLoginUrl = column_ifexists(\"loginurl_s\", \"\"),\r\nMalsiteAsNumber = column_ifexists(\"malsite_as_number_s\", \"\"),\r\nMalsiteCategory = column_ifexists(\"malsite_category_s\", \"\"),\r\nMalsiteCity = column_ifexists(\"malsite_city_s\", \"\"),\r\nMalsiteCountry = column_ifexists(\"malsite_country_s\", \"\"),\r\nMalsiteDnsServer = column_ifexists(\"malsite_dns_server_s\", \"\"),\r\nMalsiteId = column_ifexists(\"malsite_id_s\", \"\"),\r\nMalsiteIpHost = column_ifexists(\"malsite_ip_host_s\", \"\"),\r\nMalsiteIsp = column_ifexists(\"malsite_isp_s\", \"\"),\r\nMalsiteRegion = column_ifexists(\"malsite_region_s\", \"\"),\r\nMalwareId = column_ifexists(\"malware_id_s\", \"\"),\r\nMalwareName = column_ifexists(\"malware_name_s\", \"\"),\r\nMalwareProfile = column_ifexists(\"malware_profile_s\", \"\"),\r\nMalwareSeverity = column_ifexists(\"malware_severity_s\", \"\"),\r\nMalwareType = column_ifexists(\"malware_type_s\", \"\"),\r\nManagementid = column_ifexists(\"managementID_s\", \"\"),\r\nMd5 = column_ifexists(\"md5_s\", \"\"),\r\nMimeType = column_ifexists(\"mime_type_s\", \"\"),\r\nNewValue = column_ifexists(\"new_value_s\", \"\"),\r\nNsActivity = column_ifexists(\"ns_activity_s\", \"\"),\r\nNsdeviceuid = column_ifexists(\"nsdeviceuid_s\", \"\"),\r\nObjectId = column_ifexists(\"object_id_s\", \"\"),\r\nOldValue = column_ifexists(\"old_value_s\", \"\"),\r\nOrigTy = column_ifexists(\"orig_ty_s\", \"\"),\r\nOriginalFilePath = column_ifexists(\"original_file_path_s\", \"\"),\r\nOwner = column_ifexists(\"owner_s\", \"\"),\r\nProfileEmails = column_ifexists(\"profile_emails_s\", \"\"),\r\nProfileId = column_ifexists(\"profile_id_s\", \"\"),\r\nQAdmin = column_ifexists(\"q_admin_s\", \"\"),\r\nQApp = column_ifexists(\"q_app_s\", \"\"),\r\nQInstance = column_ifexists(\"q_instance_s\", \"\"),\r\nQOriginalFilename = column_ifexists(\"q_original_filename_s\", \"\"),\r\nQOriginalFilepath = column_ifexists(\"q_original_filepath_s\", \"\"),\r\nQOriginalShared = column_ifexists(\"q_original_shared_s\", \"\"),\r\nQOriginalVersion = column_ifexists(\"q_original_version_s\", \"\"),\r\nQuarantineActionReason = column_ifexists(\"quarantine_action_reason_s\", \"\"),\r\nQuarantineFailure = column_ifexists(\"quarantine_failure_s\", \"\"),\r\nQuarantineFileId = column_ifexists(\"quarantine_file_id_s\", \"\"),\r\nQuarantineFileName = column_ifexists(\"quarantine_file_name_s\", \"\"),\r\nQuarantineProfile = column_ifexists(\"quarantine_profile_s\", \"\"),\r\nReferer = column_ifexists(\"referer_s\", \"\"),\r\nRegionId = column_ifexists(\"region_id_s\", \"\"),\r\nRegionName = column_ifexists(\"region_name_s\", \"\"),\r\nResourceCategory = column_ifexists(\"resource_category_s\", \"\"),\r\nRetroScanName = column_ifexists(\"retro_scan_name_s\", \"\"),\r\nRiskLevel = column_ifexists(\"risk_level_s\", \"\"),\r\nRole = column_ifexists(\"role_s\", \"\"),\r\nSaProfileName = column_ifexists(\"sa_profile_name_s\", \"\"),\r\nSaRuleName = column_ifexists(\"sa_rule_name_s\", \"\"),\r\nSaRuleSeverity = column_ifexists(\"sa_rule_severity_s\", \"\"),\r\nScanType = column_ifexists(\"scan_type_s\", \"\"),\r\nScopes = column_ifexists(\"scopes_s\", \"\"),\r\nSeverity = column_ifexists(\"severity_s\", \"\"),\r\nSeverityLevel = column_ifexists(\"severity_level_s\", \"\"),\r\nSharedCredentialUser = column_ifexists(\"shared_credential_user_s\", \"\"),\r\nSharedDomains = column_ifexists(\"shared_domains_s\", \"\"),\r\nSharedType = column_ifexists(\"shared_type_s\", \"\"),\r\nSharedWith = column_ifexists(\"shared_with_s\", \"\"),\r\nSslDecryptPolicy = column_ifexists(\"ssl_decrypt_policy_s\", \"\"),\r\nSubType = column_ifexists(\"sub_type_s\", \"\"),\r\nSuppressionKey = column_ifexists(\"suppression_key_s\", \"\"),\r\nTeam = column_ifexists(\"team_s\", \"\"),\r\nTelemetryApp = column_ifexists(\"telemetry_app_s\", \"\"),\r\nThreatMatchField = column_ifexists(\"threat_match_field_s\", \"\"),\r\nTitle = column_ifexists(\"title_s\", \"\"),\r\nToObject = column_ifexists(\"to_object_s\", \"\"),\r\nToUserCategory = column_ifexists(\"to_user_category_s\", \"\"),\r\nTransactionId = column_ifexists(\"transaction_id_d\", \"\"),\r\nTransactionIdNew = column_ifexists(\"transactionid_s\", \"\"),\r\nTssMode = column_ifexists(\"tss_mode_s\", \"\"),\r\nTunnelId = column_ifexists(\"tunnel_id_s\", \"\"),\r\nUrl2Activity = column_ifexists(\"Url2Activity_s\", \"\"),\r\nUserCategory = column_ifexists(\"user_category_s\", \"\"),\r\nUserId = column_ifexists(\"user_id_s\", \"\"),\r\nUserName = column_ifexists(\"user_name_s\", \"\"),\r\nUserNormalized = column_ifexists(\"user_normalized_s\", \"\"),\r\nUserRole = column_ifexists(\"user_role_s\", \"\"),\r\nViolatingUser = column_ifexists(\"violating_user_s\", \"\"),\r\nViolatingUserType = column_ifexists(\"violating_user_type_s\", \"\"),\r\nWebUrl = column_ifexists(\"web_url_s\", \"\"),\r\nWorkspace = column_ifexists(\"workspace_s\", \"\"),\r\nWorkspaceId = column_ifexists(\"workspace_id_s\", \"\"),\r\nZipPassword = column_ifexists(\"zip_password_s\", \"\")\r\n\r\n\r\n",
        "version": 1
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('_parserId1'),'/'))))]",
      "dependsOn": [
        "[variables('_parserId1')]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
        "contentId": "[variables('_parserContentId1')]",
        "kind": "Parser",
        "version": "[variables('parserVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Netskope",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "2.0.3",
        "kind": "Solution",
        "contentSchemaVersion": "2.0.0",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Netskope",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('_parserContentId1')]",
              "version": "[variables('parserVersion1')]"
            }
          ]
        },
        "firstPublishDate": "2022-05-05",
        "providers": [
          "Netskope"
        ],
        "categories": {
          "domains": [
            "Security - Network"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
