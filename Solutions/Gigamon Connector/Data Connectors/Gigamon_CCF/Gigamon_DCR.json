{
    "name": "GigamonCustomDCR",
    "apiVersion": "2023-03-11",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "[parameters('workspace-location')]",
    "properties": {
        "streamDeclarations": {
            "Custom-Gigamon": {
                "columns": [
                    { "name": "TimeGenerated", "type": "datetime" },
                    { "name": "RawData", "type": "string" },
                    { "name": "ts", "type": "string" },
                    { "name": "vendor", "type": "string" },
                    { "name": "version", "type": "string" },
                    { "name": "generator", "type": "string" },
                    { "name": "dst_mac", "type": "string" },
                    { "name": "src_mac", "type": "string" },
                    { "name": "device_inbound_interface", "type": "string" },
                    { "name": "app_id", "type": "string" },
                    { "name": "src_ipv6", "type": "string" },
                    { "name": "dst_ipv6", "type": "string" },
                    { "name": "ip_version", "type": "string" },
                    { "name": "next_hdr_v6", "type": "string" },
                    { "name": "src_bytes", "type": "string" },
                    { "name": "dst_bytes", "type": "string" },
                    { "name": "src_packets", "type": "string" },
                    { "name": "dst_packets", "type": "string" },
                    { "name": "start_time", "type": "string" },
                    { "name": "end_time", "type": "string" },
                    { "name": "intf_name", "type": "string" },
                    { "name": "egress_intf_id", "type": "string" },
                    { "name": "app_name", "type": "string" },
                    { "name": "id", "type": "string" },
                    { "name": "seq_num", "type": "string" },
                    { "name": "src_ip", "type": "string" },
                    { "name": "dst_ip", "type": "string" },
                    { "name": "protocol", "type": "string" },
                    { "name": "src_port", "type": "string" },
                    { "name": "dst_port", "type": "string" },
                    { "name": "dns_name", "type": "string" },
                    { "name": "dns_host", "type": "string" },
                    { "name": "dns_host_addr", "type": "string" },
                    { "name": "dns_host_type", "type": "string" },
                    { "name": "dns_reply_code", "type": "string" },
                    { "name": "dns_ttl", "type": "string" },
                    { "name": "dns_flags", "type": "string" },
                    { "name": "dns_opcode", "type": "string" },
                    { "name": "dns_class", "type": "string" },
                    { "name": "dns_host_class", "type": "string" },
                    { "name": "dns_host_raw", "type": "string" },
                    { "name": "dns_query", "type": "string" },
                    { "name": "dns_query_type", "type": "string" },
                    { "name": "app_tags", "type": "string" },
                    { "name": "ssl_handshake_type", "type": "string" },
                    { "name": "ssl_cipher_suite_id", "type": "string" },
                    { "name": "ssl_protocol_version", "type": "string" },
                    { "name": "ssl_ext_sig_algorithms_len", "type": "string" },
                    { "name": "ssl_ext_sig_algorithm_scheme", "type": "string" },
                    { "name": "ssl_ext_sig_algorithm_hash", "type": "string" },
                    { "name": "ssl_ext_sig_algorithm_sig", "type": "string" },
                    { "name": "ssl_fingerprint_ja3", "type": "string" },
                    { "name": "ssl_fingerprint_ja3s", "type": "string" },
                    { "name": "ssl_key_share_group", "type": "string" },
                    { "name": "ssl_fingerprint_ja3_full", "type": "string" },
                    { "name": "ssl_fingerprint_ja3s_full", "type": "string" },
                    { "name": "tcp_flags", "type": "string" },
                    { "name": "ssl_common_name", "type": "string" },
                    { "name": "ssl_issuer", "type": "string" },
                    { "name": "ssl_validity_not_before", "type": "string" },
                    { "name": "ssl_validity_not_after", "type": "string" },
                    { "name": "ssl_certificate_raw", "type": "string" },
                    { "name": "ssl_organization_name", "type": "string" },
                    { "name": "ssl_content_type", "type": "string" },
                    { "name": "ssl_common_name_raw", "type": "string" },
                    { "name": "ssl_certificate_subject_cn", "type": "string" },
                    { "name": "ssl_certificate_subject_o", "type": "string" },
                    { "name": "ssl_certificate_subject_c", "type": "string" },
                    { "name": "ssl_certificate_dn_issuer", "type": "string" },
                    { "name": "ssl_certificate_issuer_c", "type": "string" },
                    { "name": "ssl_certificate_subject_key_algo_raw", "type": "string" },
                    { "name": "ssl_certificate_subject_key_algo_oid_raw", "type": "string" },
                    { "name": "ssl_certificate_subject_key_algo_oid", "type": "string" },
                    { "name": "ssl_certificate_subject_key_size", "type": "string" },
                    { "name": "ssl_certificate_subject_key_value_raw", "type": "string" },
                    { "name": "ssl_certificate_algo_raw", "type": "string" },
                    { "name": "ssl_certificate_algo_oid_raw", "type": "string" },
                    { "name": "ssl_certificate_algo_oid", "type": "string" },
                    { "name": "ssl_session_id", "type": "string" },
                    { "name": "src_inner_bytes", "type": "string" },
                    { "name": "mpls", "type": "string" },
                    { "name": "tcp_sport", "type": "string" },
                    { "name": "tcp_dport", "type": "string" },
                    { "name": "udp_sport", "type": "string" },
                    { "name": "udp_dport", "type": "string" },
                    { "name": "app_family", "type": "string" },
                    { "name": "dst_inner_bytes", "type": "string" },
                    { "name": "total_bytes", "type": "string" },
                    { "name": "total_packets", "type": "string" },
                    { "name": "ingress_vlan_id", "type": "string" },
                    { "name": "ip_ttl", "type": "string" },
                    { "name": "tcp_flags", "type": "string" },
                    { "name": "ip_hdr_len", "type": "string" },
                    { "name": "ip_frag_flags", "type": "string" },
                    { "name": "tcp_ack_id", "type": "string" },
                    { "name": "tcp_hdr_len", "type": "string" },
                    { "name": "tcp_seq_no", "type": "string" },
                    { "name": "tcp_win_size", "type": "string" },
                    { "name": "udp_msg_len", "type": "string" },
                    { "name": "flow_start_usec", "type": "string" },
                    { "name": "flow_end_usec", "type": "string" },
                    { "name": "flow_start_sec", "type": "string" },
                    { "name": "flow_end_sec", "type": "string" },
                    { "name": "outer_src_ip", "type": "string" },
                    { "name": "outer_dst_ip", "type": "string" },
                    { "name": "tcpflagsyn", "type": "string" },
                    { "name": "tcpflagsynack", "type": "string" },
                    { "name": "tcpflagfin", "type": "string" },
                    { "name": "tcpflagrst", "type": "string" },
                    { "name": "tcp_rtt", "type": "string" },
                    { "name": "tcp_loss_count", "type": "string" },
                    { "name": "ip_wrong_crc", "type": "string" },
                    { "name": "dnp3_invalid_codes", "type": "string" },
                    { "name": "dnp3_al_function_code", "type": "string" },
                    { "name": "dnp3_dl_function_code", "type": "string" },
                    { "name": "dnp3_dl_dir", "type": "string" },
                    { "name": "dnp3_invalid_codes", "type": "string" },
                    { "name": "dnp3_dl_dir", "type": "string" },
                    { "name": "modbus_function_code", "type": "string" },
                    { "name": "modbus_function_code", "type": "string" },
                    { "name": "modbus_exception_code", "type": "string" },
                    { "name": "SSL_version", "type": "string" },
                    { "name": "http_code", "type": "string" },
                    { "name": "http_rtt", "type": "string" },
                    { "name": "tcp_rtt_app", "type": "string" },
                    { "name": "tcp_flag_reset", "type": "string" },
                    { "name": "dns_response_time", "type": "string" },
                    { "name": "tcp_flag_reset", "type": "string" },
                    { "name": "http_content_encoding", "type": "string" },
                    { "name": "snmp_version", "type": "string" },
                    { "name": "smb_version", "type": "string" },
                    { "name": "http_version", "type": "string" },
                    { "name": "hl7_version", "type": "string" },
                    { "name": "hl7_msg_seg_name", "type": "string" },
                    { "name": "dicom_pdu_data_pdv_elem_val_cs", "type": "string" },
                    { "name": "dicom_pdu_data_pdv_elem_val_pn", "type": "string" }
                ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "[variables('workspaceResourceId')]",
                    "name": "gigamonws1"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-Gigamon"
                ],
                "destinations": [
                    "gigamonws1"
                ],
                "transformKql": "source | extend TimeGenerated = now()",
                "outputStream": "Custom-GigamonV2_CL"
            }
        ],
        "dataCollectionEndpointId": "{{dataCollectionEndpointsId}}"
    }
}
