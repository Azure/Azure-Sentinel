{
  "Name": "Web Shells Threat Protection",
  "Author": "Microsoft - support@microsoft.com",
  "Logo": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Azure_Sentinel.svg\" width=\"75px\" height=\"75px\">",
  "Description": "The Web Shells Threat Protection solution contains security content that helps proactive and reactive detection of Web Shells used by attackers. Web Shells are malicious scripts that attackers use to compromise internet facing servers. These are commonly used as a backdoor into the targeted web applications and servers. Microsoft Security Research has highlighted the threat, usage and detection of Web Shells in an enterprise environment in the following blogs: \n\n - [Web shell attacks continue to rise](https://www.microsoft.com/en-us/security/blog/2021/02/11/web-shell-attacks-continue-to-rise/) \n\n - [Analyzing attacks taking advantage of the Exchange Server vulnerabilities](https://www.microsoft.com/en-us/security/blog/2021/03/25/analyzing-attacks-taking-advantage-of-the-exchange-server-vulnerabilities/)\n\n**Pre-requisites:**\n\n This is a [domain solution](https://learn.microsoft.com/en-us/azure/sentinel/sentinel-solutions-catalog#domain-solutions) and does not include any data connectors. The content in this solution supports the connectors listed below. Install one or more of the listed solutions, to unlock the value provided by this solution. \r\n \r\n 1. [Microsoft 365 Defender](https://ms.portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/azuresentinel.azure-sentinel-solution-microsoft365defender-preview/resourceGroupId//resourceGroupLocation//dontDiscardJourney~/false/_provisioningContext~/%7B%22initialValues%22%3A%7B%22subscriptionIds%22%3A%5B%22419581d6-4853-49bd-83b6-d94bb8a77887%22%2C%224383ac89-7cd1-48c1-8061-b0b3c5ccfd97%22%5D%2C%22resourceGroupNames%22%3A%5B%5D%2C%22locationNames%22%3A%5B%22eastus2%22%2C%22eastus%22%5D%7D%2C%22telemetryId%22%3A%22b952618b-0985-4537-9bd2-c0858defc009%22%2C%22marketplaceItem%22%3A%7B%22categoryIds%22%3A%5B%5D%2C%22id%22%3A%22Microsoft.Portal%22%2C%22itemDisplayName%22%3A%22NoMarketplace%22%2C%22products%22%3A%5B%5D%2C%22version%22%3A%22%22%2C%22productsWithNoPricing%22%3A%5B%5D%2C%22publisherDisplayName%22%3A%22Microsoft.Portal%22%2C%22deploymentName%22%3A%22NoMarketplace%22%2C%22launchingContext%22%3A%7B%22telemetryId%22%3A%22b952618b-0985-4537-9bd2-c0858defc009%22%2C%22source%22%3A%5B%5D%2C%22galleryItemId%22%3A%22%22%7D%2C%22deploymentTemplateFileUris%22%3A%7B%7D%2C%22uiMetadata%22%3Anull%7D%7D) \n\n 2. [ Windows Security Events ](https://ms.portal.azure.com/#create/azuresentinel.azure-sentinel-solution-securityevents-previewazure-sentinel-solution-securityevents) \n\n 3. [Azure Web Application Firewall](https://ms.portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/azuresentinel.azure-sentinel-solution-azurewebapplicationfirewal-preview/resourceGroupId//resourceGroupLocation//dontDiscardJourney~/false/_provisioningContext~/%7B%22initialValues%22%3A%7B%22subscriptionIds%22%3A%5B%22419581d6-4853-49bd-83b6-d94bb8a77887%22%2C%224383ac89-7cd1-48c1-8061-b0b3c5ccfd97%22%5D%2C%22resourceGroupNames%22%3A%5B%5D%2C%22locationNames%22%3A%5B%22eastus2%22%2C%22eastus%22%5D%7D%2C%22telemetryId%22%3A%22ecf2b342-1a70-4017-83f6-fac53d7bb009%22%2C%22marketplaceItem%22%3A%7B%22categoryIds%22%3A%5B%5D%2C%22id%22%3A%22Microsoft.Portal%22%2C%22itemDisplayName%22%3A%22NoMarketplace%22%2C%22products%22%3A%5B%5D%2C%22version%22%3A%22%22%2C%22productsWithNoPricing%22%3A%5B%5D%2C%22publisherDisplayName%22%3A%22Microsoft.Portal%22%2C%22deploymentName%22%3A%22NoMarketplace%22%2C%22launchingContext%22%3A%7B%22telemetryId%22%3A%22ecf2b342-1a70-4017-83f6-fac53d7bb009%22%2C%22source%22%3A%5B%5D%2C%22galleryItemId%22%3A%22%22%7D%2C%22deploymentTemplateFileUris%22%3A%7B%7D%2C%22uiMetadata%22%3Anull%7D%7D) \n\n**Keywords:** WebDAV, SysAid, Mercury, CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065, SUPERNOVA, SpringShell, CVE-2022-22965",
  "Hunting Queries": [
    "Hunting Queries/Possible webshell drop.yaml",
    "Hunting Queries/exchange-iis-worker-dropping-webshell.yaml",
    "Hunting Queries/PotentialWebshell.yaml",
    "Hunting Queries/SpringshellWebshellUsage.yaml",
    "Hunting Queries/umworkerprocess-creating-webshell.yaml",
    "Hunting Queries/WebShellActivity.yaml"
  ],
  "Analytic Rules": [
    "Analytic Rules/PotentialMercury_Webshell.yaml",
    "Analytic Rules/MaliciousAlertLinkedWebRequests.yaml",
    "Analytic Rules/Supernovawebshell.yaml"
  ],
  "BasePath": "C:\\GitHub\\Azure-Sentinel\\solutions\\Web Shells Threat Protection",
  "Version": "2.0.0",
  "Metadata": "SolutionMetadata.json",
  "TemplateSpec": true,
  "Is1PConnector": true
}