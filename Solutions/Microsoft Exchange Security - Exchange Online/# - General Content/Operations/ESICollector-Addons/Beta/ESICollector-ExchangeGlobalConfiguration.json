{
    "SolutionMetadata":
	{
		"JSonVersion":"1.0",
		"JsonUpdateDate":"27/09/2022",
		"Description":"All Audit Functions around Global Exchange Configuration and servers",
		"VersionInformation":{
			"1.0":{
				"Tracking":["First version of the file"],
				"MigrationMessageFromLastVersion":"N/A"
			}
		}
	},
	"AuditFunctionProtectedArea":
	{
		"ContentCheckSum":"8C7746FB8488D4AE99B3B0D6CB0751526F1A98F6EF4CACFEF62A2F6E6A95E60E"
	},
    "AuditFunctions":[
        {
			"Section":"AdminAuditLog",
			"Cmdlet":"Get-AdminAuditLogConfig",
			"PropertySelection":["Name","AdminAuditLogEnabled","LogLevel","AdminAuditLogCmdlets","AdminAuditLogExcludedCmdlets","AdminAuditLogAgeLimit","WhenCreated","WhenChanged"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"All"
		},
		{
			"Section":"RemoteDomain",
			"Cmdlet":"Get-RemoteDomain",
			"PropertySelection":["name","DomainName","AutoForwardEnabled","WhenCreated","WhenChanged"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"All"
		},
		{
			"Section":"AcceptedDomain",
			"Cmdlet":"Get-AcceptedDomain",
			"PropertySelection":["name","DomainName","DomainType","MatchSubDomains","WhenCreated","WhenChanged"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"All"
		},
		{
			"Section":"OrganizationConfig",
			"Cmdlet":"Get-OrganizationConfig",
			"PropertySelection":["EnableDownloadDomains","MapiHttpEnabled","PublicFoldersEnabled","MailTipsAllTipsEnabled","MailTipsExternalRecipientsTipsEnabled","MailTipsGroupMetricsEnabled","MailTipsLargeAudienceThreshold","MailTipsMailboxSourcedTipsEnabled","WhenCreated","WhenChanged"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"All"
		},
		{
			"Section":"ExchangeServers",
			"Cmdlet":"Get-ExchangeServer",
			"PropertySelection":["Name","Id","DistinguishedName","OrganizationalUnit","Fqdn","IsE14OrLater","IsE15OrLater","IsMailboxServer","ServerRole","WhenCreated","WhenChanged","Admindisplayversion","Site"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"PartConfPerm",
			"Cmdlet":"$DNTocheck = @('CN=Microsoft Exchange,CN=Services,CN=Configuration,#ForestDN#','CN=#ExchOrgName#,CN=Microsoft Exchange,CN=Services,CN=Configuration,#ForestDN#','CN=Administrative Groups,CN=#ExchOrgName#,CN=Microsoft Exchange,CN=Services,CN=Configuration,#ForestDN#','CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=#ExchOrgName#,CN=Microsoft Exchange,CN=Services,CN=Configuration,#ForestDN#','CN=Databases,CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=#ExchOrgName#,CN=Microsoft Exchange,CN=Services,CN=Configuration,#ForestDN#');$ExchSrvListDN =@(foreach ($srv in (Get-ExchangeServer)){(Get-ExchangeServer -identity $srv).distinguishedName});$DNTocheck +=$ExchSrvListDN ;$resPArtConf =@(); foreach ($DNtocheckEntry in $DNTocheck){$resPArtConf += Get-ADPermission -Identity $DNtocheckEntry};$resPArtConf",
			"PropertySelection":["Identity","User","AccessRights","ExtendedRights","Deny","isInherited","InheritanceType"],
			"CustomExpressionForSelection":[
				{"Name":"UserString","Expression":"$_.User.ToString()"},
				{"Name":"AccessRightsString","Expression":"$_.AccessRights | %{ $_.ToString()}"},
				{"Name":"ExtendedRightsString","Expression":"$_.ExtendedRights | %{ if($null -ne $_) {$_.ToString()}}"}
			],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"ExchVersion",
			"Cmdlet":"invoke-command -ComputerName #TargetServer#  -ScriptBlock {Get-Command Exsetup.exe | ForEach {$_.FileVersionInfo}}",
			"PropertySelection":["ProductVersion"],
			"CustomExpressionForSelection":[
				{"Name":"Server","Expression":"$TargetServer"}
			],
			"ProcessPerServer":"True",
			"ProcessingCategory":"On-Premises"
		}
    ]
}
