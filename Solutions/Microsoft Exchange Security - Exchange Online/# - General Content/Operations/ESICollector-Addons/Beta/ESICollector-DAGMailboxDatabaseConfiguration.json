{
    "SolutionMetadata":
	{
		"JSonVersion":"1.0",
		"JsonUpdateDate":"27/09/2022",
		"Description":"All Audit Functions DAG and Mailbox Databases",
		"VersionInformation":{
			"1.0":{
				"Tracking":["First version of the file"],
				"MigrationMessageFromLastVersion":"N/A"
			}
		}
	},
	"AuditFunctionProtectedArea":
	{
		"ContentCheckSum":"2B0E663B4545873F3D084A0BA86178CF0701D815B7526736F5AB6D184AE7498A"
	},
    "AuditFunctions":[
        {
			"Section":"MbxDBJournaling",
			"Cmdlet":"Get-Mailboxdatabase",
			"PropertySelection":["Identity","JournalRecipient","WhenCreated","WhenChanged"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"MailboxDatabaseReceiveAs",
			"Cmdlet":"Get-MailboxDatabase -IncludePreExchange2013  | Get-ADPermission | ? {$_.ExtendedRights -like \"Receive-AS\" -and $_.Deny -eq $false }",
			"PropertySelection":["Identity","User","Deny","isInherited"],
			"CustomExpressionForSelection":[
				{"Name":"UserString","Expression":"$_.User.ToString()"}
			],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"MailboxDatabaseSendAs",
			"Cmdlet":"Get-MailboxDatabase -IncludePreExchange2013  | Get-ADPermission | ? {$_.ExtendedRights -like \"Send-AS\" -and $_.Deny -eq $false }",
			"PropertySelection":["Identity","User","Deny","isInherited"],
			"CustomExpressionForSelection":[
				{"Name":"UserString","Expression":"$_.User.ToString()"}
			],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"DAGEncryption",
			"Cmdlet":"Get-DatabaseAvailabilityGroup",
			"PropertySelection":["Name","NetworkEncryption","AutoDagBitlockerEnabled"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"MailboxDatabases",
			"Cmdlet":"Get-MailboxDatabase",
			"PropertySelection":["Name,DistinguishedName,Server,WhenCreated,WhenChanged"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		},
		{
			"Section":"DAG",
			"Cmdlet":"Get-DatabaseAvailabilityGroup",
			"PropertySelection":["Identity","Servers","DatacenterActivationMode","WitnessServer","WitnessDirectory","AlternateWitnessServer","AlternateWitnessDirectory","WitnessShareInUse","NetworkCompression","NetworkEncryption","OperationalServers","ServersInMaintenance","StoppedMailboxServers","StartedMailboxServer","DatabaseAvailabilityGroupIpv4Addresses","DatabaseAvailabilityGroupIpAddresses","AllowCrossSiteRpcClientAccess","PrimaryActiveManager","ThirdPartyReplication","NetworkNames","ReplicationPort"],
			"ProcessPerServer":"false",
			"ProcessingCategory":"On-Premises"
		}
    ]
}
