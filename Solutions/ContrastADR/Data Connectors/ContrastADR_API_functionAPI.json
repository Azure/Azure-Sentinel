{
    "id": "ContrastADR",
    "title": "ContrastADR",
    "publisher": "Contrast Security",
    "descriptionMarkdown": "The ContrastADR data connector provides the capability to ingest Contrast ADR attack events into Microsoft Sentinel using the ContrastADR Webhook. ContrastADR data connector can enrich the incoming webhook data with ContrastADR API enrichment calls.",
    "graphQueries": [
        {
            "metricName": "Total data received",
            "legend": "ContrastADR_CL",
            "baseQuery": "ContrastADR_CL"
        }
    ],
    "sampleQueries": [
        {
            "description" : "All ContrastADR logs",
            "query": "ContrastADR_CL\n| sort by TimeGenerated desc"
        }
    ],
    "dataTypes": [
        {
            "name": "ContrastADR_CL",
            "lastDataReceivedQuery": "ContrastADR_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
        }
    ],
    "connectivityCriterias": [
        {
            "type": "IsConnectedQuery",
            "value": [
                "ContrastADR_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
        }
    ],
    "availability": {
        "status": 1,
        "isPreview": true
    },
    "permissions": {
        "resourceProvider": [
            {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                    "write": true,
                    "read": true,
                    "delete": true
                }
            },
            {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                    "action": true
                }
            }
        ],
        "customs": [
            {
                "name": "Include custom pre-requisites if the connectivity requires - else delete customs",
                "description": "Description for any custom pre-requisite"
            }
        ]
    },
    "instructionSteps": [
        {
            "title": "",
            "description": "Yet to be decided",
            "instructions": [
                {
                    "parameters": {
                        "fillWith": [
                            "WorkspaceId"
                        ],
                        "label": "Workspace ID"
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "fillWith": [
                            "PrimaryKey"
                        ],
                        "label": "Primary Key"
                    },
                    "type": "CopyableLabel"
                },
                {
                      "parameters": {
                          "fillWith": [
                              "CONTRAST_HOSTNAME"
                          ],
                          "label": "Contrast ADR hostname"
                      },
                      "type": "CopyableLabel"
                  },
                  {
                      "parameters": {
                          "fillWith": [
                              "CONTRAST_USER_NAME"
                          ],
                          "label": "Contrast ADR username"
                      },
                      "type": "CopyableLabel"
                  },
                  {
                      "parameters": {
                          "fillWith": [
                              "CONTRAST_API_KEY"
                          ],
                          "label": "Contrast ADR API key"
                      },
                      "type": "CopyableLabel"
                  },
                  {
                        "parameters": {
                            "fillWith": [
                                "CONTRAST_SERVICE_KEY"
                            ],
                            "label": "Contrast ADR servicekey"
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "ENRICHMENT_DATA_SUBSCRIPTION"
                            ],
                            "label": "Contrast Enrichment subscription"
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "EXCLUDED_FEILDS"
                            ],
                            "label": "Contrast excluded feilds"
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "LOG_TYPE"
                            ],
                            "label": "Log type"
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "RETRY_INTERVAL"
                            ],
                            "label": "Retry Interval"
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "RETRY_TIMES"
                            ],
                            "label": "Retry times "
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "SHARED_KEY"
                            ],
                            "label": "Shared key "
                        },
                        "type": "CopyableLabel"
                    },
                    {
                        "parameters": {
                            "fillWith": [
                                "TIMEOUT"
                            ],
                            "label": "Timeout"
                        },
                        "type": "CopyableLabel"
                    }

            ]
        }
    ]

}