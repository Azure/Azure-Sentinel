id: a3a13f8a-2b91-4be6-88ce-00a84c5e2105
Function:
  Title: Corelight WEIRD Aggregated Events
  Version: '1.1.0'
  LastUpdated: '2025-11-26'
Category: Microsoft Sentinel Parser
FunctionName: corelight_weird_agg
FunctionAlias: corelight_weird_agg
FunctionQuery: |
    let dummy_table = datatable(TimeGenerated: datetime, uid_s: string) [];
    let corelight_weird_agg = view () {
        union isfuzzy=true
            Corelight_v2_weird_agg_CL,
            dummy_table
        | summarize arg_max(TimeGenerated, *) by uid_s
        | extend
            path=column_ifexists("_path_s", ""),
            system_name=column_ifexists("_system_name_s", ""),
            id_orig_h=column_ifexists("id_orig_h_s", ""),
            id_orig_p=column_ifexists("id_orig_p_d", real(null)),
            id_resp_h=column_ifexists("id_resp_h_s", ""),
            id_resp_p=column_ifexists("id_resp_p_d", real(null)),
            name=column_ifexists("name_s", ""),
            uid=column_ifexists("uid_s", ""),
            addl=column_ifexists("addl_s", ""),
            notice=column_ifexists("notice_b", ""),
            peer=column_ifexists("peer_s", ""),
            source=column_ifexists("source_s", "")
        | extend
            EventVendor="Corelight",
            EventProduct="CorelightSensor",
            EventType="weird_agg",
            ts = TimeGenerated
        | project
            path,
            system_name,
            id_orig_h,
            id_orig_p,
            id_resp_h,
            id_resp_p,
            name,
            uid,
            addl,
            notice,
            peer,
            source,
            EventVendor,
            EventProduct,
            EventType,
            ts,
            TimeGenerated
    };
    corelight_weird_agg