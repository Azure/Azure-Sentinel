id: 045c4b91-4629-464b-871e-f1befb319108
Function:
  Title: Corelight Metrics Interface Events
  Version: '1.0.0'
  LastUpdated: '2024-12-09'
Category: Microsoft Sentinel Parser
FunctionName: corelight_corelight_metrics_iface
FunctionAlias: corelight_corelight_metrics_iface
FunctionQuery: |
    let dummy_table = datatable(TimeGenerated: datetime, uid_s: string) [];
    let corelight_corelight_metrics_iface = view () {
        union isfuzzy=true Corelight_v2_corelight_metrics_iface_CL, dummy_table
        | extend
            path = column_ifexists("_path_s", ""),
            system_name = column_ifexists("_system_name_s", ""),
            write_ts = column_ifexists("_write_ts_t", ""),
            ts = column_ifexists("ts_t",""),
            mgmt_in_bytes = column_ifexists("mgmt_in_bytes_d", real(null)),
            mgmt_in_bytes_mbps = column_ifexists("mgmt_in_bytes_mbps_d", real(null)),
            mgmt_in_packets = column_ifexists("mgmt_in_packets_d", real(null)),
            mgmt_in_packets_kpps = column_ifexists("mgmt_in_packets_kpps_d", real(null)),
            mgmt_out_bytes = column_ifexists("mgmt_out_bytes_d", real(null)),
            mgmt_out_bytes_mbps = column_ifexists("mgmt_out_bytes_mbps_d", real(null)),
            mgmt_out_packets = column_ifexists("mgmt_out_packets_d", real(null)),
            mgmt_out_packets_kpps = column_ifexists("mgmt_out_packets_kpps_d", real(null)),
            monitor_total_bytes = column_ifexists("monitor_total_bytes_d", real(null)),
            monitor_total_drops = column_ifexists("monitor_total_drops_d", real(null)),
            monitor_total_drops_kpps = column_ifexists("monitor_total_drops_kpps_d", real(null)),
            monitor_total_kpps = column_ifexists("monitor_total_kpps_d", real(null)),
            monitor_total_mbps = column_ifexists("monitor_total_mbps_d", real(null)),
            monitor_total_packets = column_ifexists("monitor_total_packets_d", real(null)),
            monitor_nic_drops = column_ifexists("monitor_nic_drops_d", real(null)),
            monitor_nic_drops_kpps = column_ifexists("monitor_nic_drops_kpps_d", real(null)),
            monitor_port_1_bytes = column_ifexists("monitor_port_1_bytes_d", real(null)),
            monitor_port_1_kpps = column_ifexists("monitor_port_1_kpps_d", real(null)),
            monitor_port_1_malformed = column_ifexists("monitor_port_1_malformed_d", real(null)),
            monitor_port_1_malformed_kpps = column_ifexists("monitor_port_1_malformed_kpps_d", real(null)),
            monitor_port_1_mbps = column_ifexists("monitor_port_1_mbps_d", real(null)),
            monitor_port_1_packets = column_ifexists("monitor_port_1_packets_d", real(null)),
            monitor_port_2_bytes = column_ifexists("monitor_port_2_bytes_d", real(null)),
            monitor_port_2_kpps = column_ifexists("monitor_port_2_kpps_d", real(null)),
            monitor_port_2_malformed = column_ifexists("monitor_port_2_malformed_d", real(null)),
            monitor_port_2_malformed_kpps = column_ifexists("monitor_port_2_malformed_kpps_d", real(null)),
            monitor_port_2_mbps = column_ifexists("monitor_port_2_mbps_d", real(null)),
            monitor_port_2_packets = column_ifexists("monitor_port_2_packets_d", real(null)),
            monitor_port_3_bytes = column_ifexists("monitor_port_3_bytes_d", real(null)),
            monitor_port_3_kpps = column_ifexists("monitor_port_3_kpps_d", real(null)),
            monitor_port_3_malformed = column_ifexists("monitor_port_3_malformed_d", real(null)),
            monitor_port_3_malformed_kpps = column_ifexists("monitor_port_3_malformed_kpps_d", real(null)),
            monitor_port_3_mbps = column_ifexists("monitor_port_3_mbps_d", real(null)),
            monitor_port_3_packets = column_ifexists("monitor_port_3_packets_d", real(null)),
            monitor_port_4_bytes = column_ifexists("monitor_port_4_bytes_d", real(null)),
            monitor_port_4_kpps = column_ifexists("monitor_port_4_kpps_d", real(null)),
            monitor_port_4_malformed = column_ifexists("monitor_port_4_malformed_d", real(null)),
            monitor_port_4_malformed_kpps = column_ifexists("monitor_port_4_malformed_kpps_d", real(null)),
            monitor_port_4_mbps = column_ifexists("monitor_port_4_mbps_d", real(null)),
            monitor_port_4_packets = column_ifexists("monitor_port_4_packets_d", real(null)),
            monitor_processor_1_temperature = column_ifexists("monitor_processor_1_temperature_d", real(null)),
            monitor_processor_2_temperature = column_ifexists("monitor_processor_2_temperature_d", real(null)),
            monitor_resource_drops = column_ifexists("monitor_resource_drops_d", real(null)),
            monitor_resource_drops_kpps = column_ifexists("monitor_resource_drops_kpps_d", real(null)),
            monitor_total_shunted = column_ifexists("monitor_total_shunted_d", real(null)),
            monitor_total_shunted_kpps = column_ifexists("monitor_total_shunted_kpps_d", real(null)),
            monitor_dropper_total_activated_count = column_ifexists("monitor_dropper_total_activated_count_d", real(null)),
            monitor_dropper_total_drops_by_age = column_ifexists("monitor_dropper_total_drops_by_age_d", real(null)),
            monitor_flows_change = column_ifexists("monitor_flows_change_d", real(null)),
            monitor_flows_shunted = column_ifexists("monitor_flows_shunted_d", real(null)),
            monitor_port_1_rxpower = column_ifexists("monitor_port_1_rxpower_d", real(null)),
            monitor_port_2_rxpower = column_ifexists("monitor_port_2_rxpower_d", real(null)),
            monitor_port_3_rxpower = column_ifexists("monitor_port_3_rxpower_d", real(null)),
            monitor_port_4_rxpower = column_ifexists("monitor_port_4_rxpower_d", real(null)),
            monitor_zeek_packet_delay = column_ifexists("monitor_zeek_packet_delay_d", real(null)),
            id_orig_h = column_ifexists("id_orig_h_s", ""),
            id_orig_p = column_ifexists("id_orig_p_d", real(null)),
            id_resp_h = column_ifexists("id_resp_h_s", ""),
            id_resp_p = column_ifexists("id_resp_p_d", real(null))
        | extend
            EventVendor = "Corelight",
            EventProduct = "CorelightSensor",
            EventType = "corelight_metrics_iface",
            src = id_orig_h,
            src_ip = id_orig_h,
            src_port = id_orig_p,
            dest = id_resp_h,
            dest_ip = id_resp_h,
            dest_port = id_resp_p,
            sensor_name = coalesce(system_name, "unknown")
        | project
            TimeGenerated,
            path,
            system_name,
            write_ts,
            ts,
            mgmt_in_bytes,
            mgmt_in_bytes_mbps,
            mgmt_in_packets,
            mgmt_in_packets_kpps,
            mgmt_out_bytes,
            mgmt_out_bytes_mbps,
            mgmt_out_packets,
            mgmt_out_packets_kpps,
            monitor_total_bytes,
            monitor_total_drops,
            monitor_total_drops_kpps,
            monitor_total_kpps,
            monitor_total_mbps,
            monitor_total_packets,
            monitor_nic_drops,
            monitor_nic_drops_kpps,
            monitor_port_1_bytes,
            monitor_port_1_kpps,
            monitor_port_1_malformed,
            monitor_port_1_malformed_kpps,
            monitor_port_1_mbps,
            monitor_port_1_packets,
            monitor_port_2_bytes,
            monitor_port_2_kpps,
            monitor_port_2_malformed,
            monitor_port_2_malformed_kpps,
            monitor_port_2_mbps,
            monitor_port_2_packets,
            monitor_port_3_bytes,
            monitor_port_3_kpps,
            monitor_port_3_malformed,
            monitor_port_3_malformed_kpps,
            monitor_port_3_mbps,
            monitor_port_3_packets,
            monitor_port_4_bytes,
            monitor_port_4_kpps,
            monitor_port_4_malformed,
            monitor_port_4_malformed_kpps,
            monitor_port_4_mbps,
            monitor_port_4_packets,
            monitor_processor_1_temperature,
            monitor_processor_2_temperature,
            monitor_resource_drops,
            monitor_resource_drops_kpps,
            monitor_total_shunted,
            monitor_total_shunted_kpps,
            monitor_dropper_total_activated_count,
            monitor_dropper_total_drops_by_age,
            monitor_flows_change,
            monitor_flows_shunted,
            monitor_port_1_rxpower,
            monitor_port_2_rxpower,
            monitor_port_3_rxpower,
            monitor_port_4_rxpower,
            monitor_zeek_packet_delay,
            id_orig_h,
            id_orig_p,
            id_resp_h,
            id_resp_p,
            EventVendor,
            EventProduct,
            EventType,
            src,
            src_ip,
            src_port,
            dest,
            dest_ip,
            dest_port,
            sensor_name 
    };
    corelight_corelight_metrics_iface