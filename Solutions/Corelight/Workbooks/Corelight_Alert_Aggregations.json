{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Importing CSV Data into Watchlists\r\n\r\nThis workbook requires you to import two CSV files into specific Watchlists:\r\n1. [**CorelightAggregationsEnrichment1.csv**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Corelight/Watchlists/Corelight-AggregationsEnrichment/CorelightAggregationsEnrichment1.csv) ->  CorelightAggregationsEnrichment1 Watchlist\r\n2. [**CorelightAggregationsEnrichment2.csv**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Corelight/Watchlists/Corelight-AggregationsEnrichment/CorelightAggregationsEnrichment2.csv) -> CorelightAggregationsEnrichment2 Watchlist\r\n\r\n## Import Process\r\n- Navigate to Microsoft Sentinel\r\n- Access the Watchlists section\r\n- Select the appropriate Watchlist (**CorelightAggregationsEnrichment1** or **CorelightAggregationsEnrichment2**)\r\n- Choose **Update watchlist** -> **Bulk update**\r\n- Upload the corresponding CSV file\r\n- Proceed through **Next: Review + create**\r\n- Finalize by clicking **Update**\r\n\r\nRepeat these steps for both Watchlists to ensure all data is properly imported.",
              "style": "upsell"
            },
            "name": "text - 15"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "36e84397-67da-4e0a-a937-09b53cb254a1",
                  "version": "KqlParameterItem/1.0",
                  "name": "GlobalTimeRange",
                  "label": "Global Time Range",
                  "type": 4,
                  "isRequired": true,
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ],
                    "allowCustom": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": {
                    "durationMs": 86400000
                  }
                },
                {
                  "id": "200f46f2-a573-4d60-b2f7-5a8c38227709",
                  "version": "KqlParameterItem/1.0",
                  "name": "Entity",
                  "type": 1,
                  "isRequired": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "resultValType": "static",
                        "resultVal": "*"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "id": "809c41ab-35ed-4052-9f41-83d0b2b887e2",
                  "version": "KqlParameterItem/1.0",
                  "name": "ImpactScore",
                  "label": "Impact Score",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "corelight_suri_aggregations\r\n| mv-expand sid\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}')) and isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist        ('CorelightAggregationsEnrichment2')) on sid\r\n| where isnotempty(impact_score)\r\n| distinct impact_score\r\n| sort by impact_score desc",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "*",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "GlobalTimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "value::all"
                  ]
                },
                {
                  "id": "2e98349b-57ed-4ec4-bce7-85a452c2fea1",
                  "version": "KqlParameterItem/1.0",
                  "name": "Category",
                  "type": 2,
                  "isRequired": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "corelight_suri_aggregations\r\n| mv-expand sid\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}')) and isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist        ('CorelightAggregationsEnrichment2')) on sid\r\n| where isnotempty(category)\r\n| distinct category\r\n| sort by category asc",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "*",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "GlobalTimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": "value::all"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 0"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}')) and\r\n        isnotempty(did)\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| distinct did\r\n| count",
              "size": 3,
              "showAnalytics": true,
              "title": "Alert Groupings",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}')) and\r\n        isnotempty(uid)\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| distinct uid\r\n| count",
              "size": 3,
              "showAnalytics": true,
              "title": "Impacted Connections",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| where local_resp == \"true\"\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| count",
              "size": 3,
              "showAnalytics": true,
              "title": "Impacted Internal Hosts",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}')) and\r\n        isnotempty(technique_number)\r\n| distinct technique_number\r\n| count",
              "size": 3,
              "showAnalytics": true,
              "title": "MITRE Techniques",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| summarize impact_score = max(impact_score)\r\n| extend impact_score = iif(isempty(impact_score), \"N/A\", impact_score)",
              "size": 3,
              "showAnalytics": true,
              "title": "Highest Impact Score",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "impact_score",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}')) and\r\n        isnotempty(category)\r\n| summarize Count = count() by category\r\n| top 1 by Count",
              "size": 3,
              "showAnalytics": true,
              "title": "Most Seen Category",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "category",
                  "formatter": 4,
                  "formatOptions": {
                    "palette": "blue"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| count",
              "size": 3,
              "showAnalytics": true,
              "title": "Alerts/Signatures",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}')) and\r\n        isnotempty(cve_number)\r\n| count",
              "size": 3,
              "showAnalytics": true,
              "title": "Alerts with CVEs",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "greenRed"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| extend cve_creation_date = todatetime(cve_creation_date)\r\n| summarize Oldest_CVE_Date = min(cve_creation_date)\r\n| extend Oldest_CVE_Date = iff(isempty(Oldest_CVE_Date), \"N/A\", format_datetime(Oldest_CVE_Date, 'yyyy-MM-dd'))",
              "size": 3,
              "showAnalytics": true,
              "title": "Oldest CVE Date",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Oldest_CVE_Date",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal"
                    }
                  },
                  "dateFormat": {
                    "showUtcTime": true,
                    "formatName": "shortDatePattern"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}'))\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}')) and\r\n        isnotempty(impact_score)\r\n| summarize avg_impact_score = avg(toreal(impact_score))\r\n| project avg_impact_score = iff(isnan(avg_impact_score), toreal(0), round(avg_impact_score, 2))",
              "size": 3,
              "showAnalytics": true,
              "title": "Average Impact Score",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "avg_impact_score",
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "colors",
                    "thresholdsGrid": [
                      {
                        "operator": ">=",
                        "thresholdValue": "7",
                        "representation": "brown",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": ">=",
                        "thresholdValue": "4",
                        "representation": "orange",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "green",
                        "text": "{0}{1}"
                      }
                    ],
                    "compositeBarSettings": {
                      "labelText": "",
                      "columnSettings": [
                        {
                          "columnName": "avg_impact_score",
                          "color": "lightBlue"
                        }
                      ]
                    }
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal"
                    }
                  }
                },
                "showBorder": false,
                "size": "auto"
              }
            },
            "customWidth": "20",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1) or did == ('{Entity}')) and\r\n        isnotempty(did)\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| summarize [\"MITRE Technique\"] = make_set_if(technique_name, isnotempty(technique_name)), Categories = make_set_if(category, isnotempty(category)), Signatures = make_set_if(signatures, isnotempty(signatures)), Impact = make_set_if(impact_score, isnotempty(impact_score)), Connections = dcount(uid) by did\r\n| extend [\"MITRE Technique\"] = strcat_array([\"MITRE Technique\"], \", \"), Categories = strcat_array(Categories, \", \"), Signatures = strcat_array(Signatures, \", \"),\r\n         Impact = strcat_array(Impact, \", \")\r\n| project-rename [\"Aggregation ID\"] = did",
              "size": 0,
              "showAnalytics": true,
              "title": "Alert Aggregations Data",
              "timeContextFromParameter": "GlobalTimeRange",
              "showRefreshButton": true,
              "exportFieldName": "Aggregation ID",
              "exportParameterName": "agg_id",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "rowLimit": 10000,
                "filter": true
              }
            },
            "name": "query - 11",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "#### Click on above Aggregation ID to view *Alert Aggregation Details*",
              "style": "info"
            },
            "name": "text - 14"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Alert Aggregation Details",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "print '{agg_id}'",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Aggregation ID",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "print_0",
                        "formatter": 4,
                        "formatOptions": {
                          "palette": "blue"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "print \"Suricata\"",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Alert Type",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "print_0",
                        "formatter": 4,
                        "formatOptions": {
                          "palette": "blue"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}' and isnotempty(uid)\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| distinct uid\r\n| count",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Total Connections",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenRed"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid, id_orig_h = orig_h\r\n| where isnotempty(sid) and isnotempty(id_orig_h)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| distinct tostring(id_orig_h)\r\n| count",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Unique Sources",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenRed"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid, id_resp_h = resp_h\r\n| where isnotempty(sid) and isnotempty(id_resp_h)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| distinct tostring(id_resp_h)\r\n| count",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Unique Destinations",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenRed"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| where isnotempty(cve_number)\r\n| distinct cve_number\r\n| count",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Noted CVEs",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "Count",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenRed"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| summarize cve_impact_score = max(cve_impact_score)\r\n| extend cve_impact_score = iif(isempty(cve_impact_score), \"N/A\", cve_impact_score)",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Highest CVE Impact Score",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "cve_impact_score",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenRed"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "25",
                  "name": "query - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| summarize impact_score = max(impact_score)\r\n| extend impact_score = iif(isempty(impact_score), \"N/A\", impact_score)",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Highest Impact Score",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "leftContent": {
                        "columnMatch": "impact_score",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "greenRed"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "20",
                  "name": "query - 1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}')) and\r\n        isnotempty(attack_reason)\r\n| distinct [\"Attack Reason\"] = attack_reason",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Alert Insight",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "table",
                    "gridSettings": {
                      "rowLimit": 10000,
                      "filter": true
                    },
                    "textSettings": {
                      "style": "editor"
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| summarize arg_max(TimeGenerated, *) by did\r\n| mv-expand sid\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))      \r\n| project SID = sid, Signature = substring(signatures, 1, strlen(signatures)-2), [\"Impact Score\"] = impact_score, [\"MITRE Attack Phase\"] = attack_phase,\r\n          Category = category, [\"MITRE Technique\"] = technique_name, [\"Technique #\"] = technique_number, [\"Traffic Direction\"] = traffic_direction",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Associated Suricata Alerts",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SID",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "GenericDetails",
                            "linkIsContextBlade": true
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "filter": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 9",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "corelight_suri_aggregations\r\n| where ('*' == ('{Entity}') or (array_index_of(orig_h,('{Entity}')) != -1) or (array_index_of(resp_h,('{Entity}')) != -1))\r\n| where did == '{agg_id}'\r\n| mv-expand sid\r\n| where isnotempty(sid)\r\n| extend sid = tostring(sid)\r\n| lookup (union isfuzzy=true _GetWatchlist('CorelightAggregationsEnrichment1'), _GetWatchlist('CorelightAggregationsEnrichment2')) on sid\r\n| where ('*' in ({ImpactScore}) or impact_score in ({ImpactScore})) and\r\n        ('*' == ('{Category}') or category == ('{Category}'))\r\n| extend orig_h = strcat_array(orig_h, \",\"), resp_h = strcat_array(resp_h, \",\")\r\n| project UID = uid, Timestamp = format_datetime(todatetime((array_sort_desc(ts))[0]), 'MM-dd-yyyy HH:mm:ss'), Source = orig_h, Destination = resp_h\r\n",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Associated Connections",
                    "timeContextFromParameter": "GlobalTimeRange",
                    "showRefreshButton": true,
                    "exportFieldName": "UID",
                    "exportParameterName": "uid",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "rowLimit": 10000,
                      "filter": true
                    }
                  },
                  "name": "query - 10",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": "#### Click a connection from above to see the associated logs. Log types with data are highlighted green. If a Suricata payload is found for a given session, it will appear in the lower panel labeled Payload.",
                    "style": "info"
                  },
                  "name": "text - 25"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Connection Details by UIDs",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let dummy_table = datatable(uid_s: string, TenantId: string, SourceSystem: string, MG: string, ManagementGroupName: string, Computer: string, RawData: string, _ResourceId: string)[];\r\n\r\nunion isfuzzy=true\r\nCorelight*, dummy_table\r\n| where uid_s == ('{uid}')\r\n| project-away TenantId, SourceSystem, MG, ManagementGroupName, Computer, RawData, _ResourceId\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "All Logs per UID",
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 12",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suricata_corelight\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(isnotempty(payload), 1, 0)\r\n);\r\nprint \"Payload\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "payload_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 15"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suri_aggregations\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(paths contains \"conn\", 1, 0)\r\n);\r\nprint \"Conn\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "conn_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suri_aggregations\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(paths contains \"http\", 1, 0)\r\n);\r\nprint \"HTTP\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "http_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suri_aggregations\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(paths contains \"ssl\", 1, 0)\r\n);\r\nprint \"SSL\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "ssl_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suri_aggregations\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(paths contains \"dns\", 1, 0)\r\n);\r\nprint \"DNS\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "dns_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suri_aggregations\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(array_index_of(paths, \"files\") != -1, 1, 0)\r\n);\r\nprint \"Files\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "files_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let check = toscalar(\r\n       corelight_suri_aggregations\r\n       | where uid == ('{uid}')\r\n       | project verify = iif(paths contains \"smb\", 1, 0)\r\n);\r\nprint \"SMB\", check",
                          "size": 3,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "exportFieldName": "print_1",
                          "exportParameterName": "smb_value",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "print_0",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "colors",
                                "thresholdsGrid": [
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "==",
                                    "thresholdValue": "1",
                                    "representation": "green",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "sourceColumn": "print_1",
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "gray",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "foreground",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_1",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "13",
                        "conditionalVisibility": {
                          "parameterName": "uid",
                          "comparison": "isNotEqualTo"
                        },
                        "name": "query - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "corelight_conn\r\n| where uid == ('{uid}')\r\n| project spcap_url",
                          "size": 3,
                          "showAnalytics": true,
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "spcap_url",
                              "formatter": 7,
                              "formatOptions": {
                                "linkTarget": "Url",
                                "linkLabel": "SPCAP Viewer"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "statSettings": {
                            "valueField": "print_0",
                            "valueAggregation": "None",
                            "linkSettings": {
                              "linkTarget": "Url"
                            },
                            "colorSettings": {
                              "type": "thresholds",
                              "mode": "background",
                              "heatmapPalette": "greenRed",
                              "thresholdsGrid": [
                                {
                                  "sourceColumn": "print_2",
                                  "operator": "==",
                                  "thresholdValue": "1",
                                  "representation": "green"
                                },
                                {
                                  "sourceColumn": "print_2",
                                  "operator": "==",
                                  "thresholdValue": "0",
                                  "representation": "gray"
                                }
                              ]
                            },
                            "iconSettings": {
                              "thresholdsGrid": []
                            },
                            "tagText": "",
                            "valueFontStyle": "auto"
                          }
                        },
                        "customWidth": "9",
                        "conditionalVisibility": {
                          "parameterName": "conn_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 27"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let base64conversion = dynamic({'=': '000000',\r\n'A': '000000',\r\n'B': '000001',\r\n'C': '000010',\r\n'D': '000011',\r\n'E': '000100',\r\n'F': '000101',\r\n'G': '000110',\r\n'H': '000111',\r\n'I': '001000',\r\n'J': '001001',\r\n'K': '001010',\r\n'L': '001011',\r\n'M': '001100',\r\n'N': '001101',\r\n'O': '001110',\r\n'P': '001111',\r\n'Q': '010000',\r\n'R': '010001',\r\n'S': '010010',\r\n'T': '010011',\r\n'U': '010100',\r\n'V': '010101',\r\n'W': '010110',\r\n'X': '010111',\r\n'Y': '011000',\r\n'Z': '011001',\r\n'a': '011010',\r\n'b': '011011',\r\n'c': '011100',\r\n'd': '011101',\r\n'e': '011110',\r\n'f': '011111',\r\n'g': '100000',\r\n'h': '100001',\r\n'i': '100010',\r\n'j': '100011',\r\n'k': '100100',\r\n'l': '100101',\r\n'm': '100110',\r\n'n': '100111',\r\n'o': '101000',\r\n'p': '101001',\r\n'q': '101010',\r\n'r': '101011',\r\n's': '101100',\r\n't': '101101',\r\n'u': '101110',\r\n'v': '101111',\r\n'w': '110000',\r\n'x': '110001',\r\n'y': '110010',\r\n'z': '110011',\r\n'0': '110100',\r\n'1': '110101',\r\n'2': '110110',\r\n'3': '110111',\r\n'4': '111000',\r\n'5': '111001',\r\n'6': '111010',\r\n'7': '111011',\r\n'8': '111100',\r\n'9': '111101',\r\n'+': '111110',\r\n'/': '111111',\r\n'00001010': '`',\r\n'00100000': '~',\r\n'00100001': '!',\r\n'00100010': '\"',\r\n'00100011': '#',\r\n'00100100': '$',\r\n'00100101': '%',\r\n'00100110': '&',\r\n'00100111': \"'\",\r\n'00101000': '(',\r\n'00101001': ')',\r\n'00101010': '*',\r\n'00101011': '+',\r\n'00101100':',',\r\n'00101101': '-',\r\n'00101110': '.',\r\n'00101111': '/',\r\n'00110000': '0',\r\n'00110001': '1',\r\n'00110010': '2',\r\n'00110011': '3',\r\n'00110100': '4',\r\n'00110101': '5',\r\n'00110110': '6',\r\n'00110111': '7',\r\n'00111000': '8',\r\n'00111001': '9',\r\n'00111010': ':',\r\n'00111011': ';',\r\n'00111100': '<',\r\n'00111101': '=',\r\n'00111110': '>',\r\n'00111111': '?',\r\n'01000000': '@',\r\n'01000001': 'A',\r\n'01000010': 'B',\r\n'01000011': 'C',\r\n'01000100': 'D',\r\n'01000101': 'E',\r\n'01000110': 'F',\r\n'01000111': 'G',\r\n'01001000': 'H',\r\n'01001001': 'I',\r\n'01001010': 'J',\r\n'01001011': 'K',\r\n'01001100': 'L',\r\n'01001101': 'M',\r\n'01001110': 'N',\r\n'01001111': 'O',\r\n'01010000': 'P',\r\n'01010001': 'Q',\r\n'01010010': 'R',\r\n'01010011': 'S',\r\n'01010100': 'T',\r\n'01010101': 'U',\r\n'01010110': 'V',\r\n'01010111': 'W',\r\n'01011000': 'X',\r\n'01011001': 'Y',\r\n'01011010': 'Z',\r\n'01011011': '[',\r\n'01011100': '\\\\',\r\n'01011101': ']',\r\n'01011110': '^',\r\n'01011111': '_',\r\n'01100000': '@',\r\n'01100001': 'a',\r\n'01100010': 'b',\r\n'01100011': 'c',\r\n'01100100': 'd',\r\n'01100101': 'e',\r\n'01100110': 'f',\r\n'01100111': 'g',\r\n'01101000': 'h',\r\n'01101001': 'i',\r\n'01101010': 'j',\r\n'01101011': 'k',\r\n'01101100': 'l',\r\n'01101101': 'm',\r\n'01101110': 'n',\r\n'01101111': 'o',\r\n'01110000': 'p',\r\n'01110001': 'q',\r\n'01110010': 'r',\r\n'01110011': 's',\r\n'01110100': 't',\r\n'01110101': 'u',\r\n'01110110': 'v',\r\n'01110111': 'w',\r\n'01111000': 'x',\r\n'01111001': 'y',\r\n'01111010': 'z '});\r\n\r\ncorelight_suricata_corelight\r\n| where uid == ('{uid}') and isnotempty(signature_id)\r\n| extend decoded_payload = iif(isempty(payload), \"No payload available\", \"\"), len = strlen(payload)\r\n| mv-expand char_index = range(0, len-1, 1) to typeof(int)\r\n| extend bin_combined = base64conversion[substring(payload, char_index, 1)]\r\n| summarize bin_combined = make_list(bin_combined) by decoded_payload, signature_id\r\n| extend bin_chunked = split(replace_regex(strcat_array(bin_combined, \"\"), \"(.{8})\", @\"\\1,\"),\",\")\r\n| mv-expand bin_chunked\r\n| extend ascii = base64conversion[tostring(bin_chunked)]\r\n| summarize ascii = make_list(ascii) by decoded_payload, signature_id\r\n| extend ascii = replace(\"~\", \" \", strcat_array(ascii, \"\"))\r\n| extend decoded_payload = iif(isempty(decoded_payload), ascii, decoded_payload)\r\n| project [\"Signature ID\"] = signature_id, [\"Decoded Payload\"] = decoded_payload\r\n\r\n\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Payload Found in UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "payload_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 26",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "corelight_conn\r\n| where uid == ('{uid}')\r\n| extend tunnel_parents = strcat_array(todynamic(tunnel_parents), \", \"), suri_ids = strcat_array(todynamic(suri_ids), \", \"),\r\n         apps = strcat_array(todynamic(apps), \", \"), app = strcat_array(app, \", \"), id_orig_h_n_vals = strcat_array(todynamic(id_orig_h_n_vals), \", \"),\r\n         id_resp_h_n_vals = strcat_array(todynamic(id_resp_h_n_vals), \", \")\r\n",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Connection Details For UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "conn_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 19",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "corelight_http\r\n| where uid == ('{uid}')\r\n| extend proxied = strcat_array(todynamic(proxied), \", \"), orig_mime_types = strcat_array(todynamic(orig_mime_types), \", \"),\r\n         orig_fuids = strcat_array(todynamic(orig_fuids), \", \"), resp_fuids = strcat_array(todynamic(resp_fuids), \", \"),\r\n         tags = strcat_array(todynamic(tags), \", \"), resp_mime_types = strcat_array(todynamic(resp_mime_types), \", \"),\r\n         http_content_type = strcat_array(todynamic(http_content_type), \", \"), server_headers = strcat_array(todynamic(server_headers), \", \"),\r\n         client_headers = strcat_array(todynamic(client_headers), \", \"), resp_filenames = strcat_array(todynamic(resp_filenames), \", \"),\r\n         orig_filenames = strcat_array(todynamic(orig_filenames), \", \"), object = strcat_array(todynamic(object), \", \")",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "HTTP Details For UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "http_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 19",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "corelight_ssl\r\n| where uid == ('{uid}')\r\n| extend cert_chain_fps = strcat_array(todynamic(cert_chain_fps), \",\"), client_cert_chain_fps = strcat_array(todynamic(client_cert_chain_fps), \",\"), fingerprint = strcat_array(todynamic(fingerprint), \",\")",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "SSL Details For UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "ssl_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 19",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "corelight_dns\r\n| where uid == ('{uid}')\r\n| extend TTLs = strcat_array(todynamic(TTLs), \",\"), answers = strcat_array(todynamic(answers), \",\"), ttl = strcat_array(todynamic(ttl), \",\")",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "DNS Details For UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "dns_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 19",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "corelight_files\r\n| where uid == ('{uid}')\r\n| extend analyzers = strcat_array(todynamic(analyzers), \", \"), tx_hosts = strcat_array(todynamic(tx_hosts), \", \"),\r\n         rx_hosts = strcat_array(todynamic(rx_hosts), \", \"), conn_uids = strcat_array(todynamic(conn_uids), \", \"), \r\n         extracted = strcat_array(todynamic(extracted), \", \"), dest_host = strcat_array(todynamic(dest_host), \", \"),\r\n         src_host = strcat_array(todynamic(src_host), \", \")",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "Files Details For UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "files_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 19",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "union isfuzzy = true corelight_smb_files, corelight_smb_mapping\r\n| where uid == ('{uid}')",
                          "size": 0,
                          "showAnalytics": true,
                          "title": "SMB Details For UID: {uid}",
                          "timeContextFromParameter": "GlobalTimeRange",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "rowLimit": 10000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "smb_value",
                          "comparison": "isEqualTo",
                          "value": "1"
                        },
                        "name": "query - 19",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "uid",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "Connection Details by UIDs"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "agg_id",
              "comparison": "isNotEqualTo"
            },
            "name": "Alert Aggregation Details"
          },
          {
            "type": 1,
            "content": {
              "json": "📝 **Refresh the web page to fetch details of recently collected events**"
            },
            "name": "text - 5"
          }
        ]
      },
      "name": "Alert Aggregations"
    }
  ],
  "fromTemplateId": "sentinel-Corelight_Alert_Aggregations",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}