{
  "id": "Corelight",
  "title": "Corelight",
  "publisher": "Corelight",
  "descriptionMarkdown": "The [Corelight](https://corelight.com/) data connector enables incident responders and threat hunters who use Microsoft Sentinel to work faster and more effectively. The data connector enables ingestion of events from [Zeek](https://zeek.org/) and [Suricata](https://suricata-ids.org/) via Corelight Sensors into Microsoft Sentinel.",
  "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**Corelight**](https://aka.ms/sentinel-Corelight-parser) which is deployed with the Microsoft Sentinel Solution.",
  "graphQueries": [
    {
      "metricName": "Total data received",
      "legend": "Corelight_CL",
      "baseQuery": "Corelight"
    }
  ],
  "sampleQueries": [
    {
      "description": "Top 10 Clients (Source IP)",
      "query": "Corelight\n\t| summarize count() by id_orig_h\n\t| top 10 by count_"
    }
  ],
  "dataTypes": [
    {
      "name": "corelight_bacnet",
      "lastDataReceivedQuery": "corelight_bacnet\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_capture_loss",
      "lastDataReceivedQuery": "corelight_capture_loss\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_cip",
      "lastDataReceivedQuery": "corelight_cip\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_conn_long",
      "lastDataReceivedQuery": "corelight_conn_long\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_conn_red",
      "lastDataReceivedQuery": "corelight_conn_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_conn",
      "lastDataReceivedQuery": "corelight_conn\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_corelight_burst",
      "lastDataReceivedQuery": "corelight_corelight_burst\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_corelight_overall_capture_loss",
      "lastDataReceivedQuery": "corelight_corelight_overall_capture_loss\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_corelight_profiling",
      "lastDataReceivedQuery": "corelight_corelight_profiling\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_datared",
      "lastDataReceivedQuery": "corelight_datared\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dce_rpc",
      "lastDataReceivedQuery": "corelight_dce_rpc\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dga",
      "lastDataReceivedQuery": "corelight_dga\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dhcp",
      "lastDataReceivedQuery": "corelight_dhcp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dnp3",
      "lastDataReceivedQuery": "corelight_dnp3\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dns_red",
      "lastDataReceivedQuery": "corelight_dns_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dns",
      "lastDataReceivedQuery": "corelight_dns\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_dpd",
      "lastDataReceivedQuery": "corelight_dpd\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_encrypted_dns",
      "lastDataReceivedQuery": "corelight_encrypted_dns\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_enip_debug",
      "lastDataReceivedQuery": "corelight_enip_debug\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_enip_list_identity",
      "lastDataReceivedQuery": "corelight_enip_list_identity\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_enip",
      "lastDataReceivedQuery": "corelight_enip\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_etc_viz",
      "lastDataReceivedQuery": "corelight_etc_viz\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_files_red",
      "lastDataReceivedQuery": "corelight_files_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_files",
      "lastDataReceivedQuery": "corelight_files\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ftp",
      "lastDataReceivedQuery": "corelight_ftp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_generic_dns_tunnels",
      "lastDataReceivedQuery": "corelight_generic_dns_tunnels\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_generic_icmp_tunnels",
      "lastDataReceivedQuery": "corelight_generic_icmp_tunnels\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_http2",
      "lastDataReceivedQuery": "corelight_http2\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_http_red",
      "lastDataReceivedQuery": "corelight_http_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_http",
      "lastDataReceivedQuery": "corelight_http\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_icmp_specific_tunnels",
      "lastDataReceivedQuery": "corelight_icmp_specific_tunnels\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_intel",
      "lastDataReceivedQuery": "corelight_intel\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ipsec",
      "lastDataReceivedQuery": "corelight_ipsec\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_irc",
      "lastDataReceivedQuery": "corelight_irc\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_iso_cotp",
      "lastDataReceivedQuery": "corelight_iso_cotp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_kerberos",
      "lastDataReceivedQuery": "corelight_kerberos\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_certs",
      "lastDataReceivedQuery": "corelight_known_certs\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_devices",
      "lastDataReceivedQuery": "corelight_known_devices\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_domains",
      "lastDataReceivedQuery": "corelight_known_domains\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_hosts",
      "lastDataReceivedQuery": "corelight_known_hosts\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_names",
      "lastDataReceivedQuery": "corelight_known_names\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_remotes",
      "lastDataReceivedQuery": "corelight_known_remotes\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_services",
      "lastDataReceivedQuery": "corelight_known_services\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_known_users",
      "lastDataReceivedQuery": "corelight_known_users\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_local_subnets_dj",
      "lastDataReceivedQuery": "corelight_local_subnets_dj\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_local_subnets_graphs",
      "lastDataReceivedQuery": "corelight_local_subnets_graphs\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_local_subnets",
      "lastDataReceivedQuery": "corelight_local_subnets\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_log4shell",
      "lastDataReceivedQuery": "corelight_log4shell\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_modbus",
      "lastDataReceivedQuery": "corelight_modbus\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_mqtt_connect",
      "lastDataReceivedQuery": "corelight_mqtt_connect\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_mqtt_publish",
      "lastDataReceivedQuery": "corelight_mqtt_publish\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_mqtt_subscribe",
      "lastDataReceivedQuery": "corelight_mqtt_subscribe\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_mysql",
      "lastDataReceivedQuery": "corelight_mysql\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_notice",
      "lastDataReceivedQuery": "corelight_notice\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ntlm",
      "lastDataReceivedQuery": "corelight_ntlm\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ntp",
      "lastDataReceivedQuery": "corelight_ntp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ocsp",
      "lastDataReceivedQuery": "corelight_ocsp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_openflow",
      "lastDataReceivedQuery": "corelight_openflow\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_packet_filter",
      "lastDataReceivedQuery": "corelight_packet_filter\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_pe",
      "lastDataReceivedQuery": "corelight_pe\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_profinet_dce_rpc",
      "lastDataReceivedQuery": "corelight_profinet_dce_rpc\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_profinet_debug",
      "lastDataReceivedQuery": "corelight_profinet_debug\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_profinet",
      "lastDataReceivedQuery": "corelight_profinet\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_radius",
      "lastDataReceivedQuery": "corelight_radius\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_rdp",
      "lastDataReceivedQuery": "corelight_rdp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_reporter",
      "lastDataReceivedQuery": "corelight_reporter\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_rfb",
      "lastDataReceivedQuery": "corelight_rfb\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_s7comm",
      "lastDataReceivedQuery": "corelight_s7comm\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_signatures",
      "lastDataReceivedQuery": "corelight_signatures\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_sip",
      "lastDataReceivedQuery": "corelight_sip\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_smartpcap_stats",
      "lastDataReceivedQuery": "corelight_smartpcap_stats\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_smartpcap",
      "lastDataReceivedQuery": "corelight_smartpcap\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_smb_files",
      "lastDataReceivedQuery": "corelight_smb_files\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_smb_mapping",
      "lastDataReceivedQuery": "corelight_smb_mapping\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_smtp_links",
      "lastDataReceivedQuery": "corelight_smtp_links\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_smtp",
      "lastDataReceivedQuery": "corelight_smtp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_snmp",
      "lastDataReceivedQuery": "corelight_snmp\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_socks",
      "lastDataReceivedQuery": "corelight_socks\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_software",
      "lastDataReceivedQuery": "corelight_software\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_specific_dns_tunnels",
      "lastDataReceivedQuery": "corelight_specific_dns_tunnels\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ssh",
      "lastDataReceivedQuery": "corelight_ssh\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ssl_red",
      "lastDataReceivedQuery": "corelight_ssl_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_ssl",
      "lastDataReceivedQuery": "corelight_ssl\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_stats",
      "lastDataReceivedQuery": "corelight_stats\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_stepping",
      "lastDataReceivedQuery": "corelight_stepping\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_stun_nat",
      "lastDataReceivedQuery": "corelight_stun_nat\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_stun",
      "lastDataReceivedQuery": "corelight_stun\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_suricata_corelight",
      "lastDataReceivedQuery": "corelight_suricata_corelight\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_suricata_eve",
      "lastDataReceivedQuery": "corelight_suricata_eve\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_suricata_stats",
      "lastDataReceivedQuery": "corelight_suricata_stats\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_suricata_zeek_stats",
      "lastDataReceivedQuery": "corelight_suricata_zeek_stats\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_syslog",
      "lastDataReceivedQuery": "corelight_syslog\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_tds_rpc",
      "lastDataReceivedQuery": "corelight_tds_rpc\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_tds_sql_batch",
      "lastDataReceivedQuery": "corelight_tds_sql_batch\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_tds",
      "lastDataReceivedQuery": "corelight_tds\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_traceroute",
      "lastDataReceivedQuery": "corelight_traceroute\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_tunnel",
      "lastDataReceivedQuery": "corelight_tunnel\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "Corelight",
      "lastDataReceivedQuery": "Corelight\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_unknown_smartpcap",
      "lastDataReceivedQuery": "corelight_unknown_smartpcap\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_util_stats",
      "lastDataReceivedQuery": "corelight_util_stats\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_vpn",
      "lastDataReceivedQuery": "corelight_vpn\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_weird_red",
      "lastDataReceivedQuery": "corelight_weird_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_weird_stats",
      "lastDataReceivedQuery": "corelight_weird_stats\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_weird",
      "lastDataReceivedQuery": "corelight_weird\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_wireguard",
      "lastDataReceivedQuery": "corelight_wireguard\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_x509_red",
      "lastDataReceivedQuery": "corelight_x509_red\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_x509",
      "lastDataReceivedQuery": "corelight_x509\n\t| summarize Time=max(TimeGenerated)"
    },
    {
      "name": "corelight_zeek_doctor",
      "lastDataReceivedQuery": "corelight_zeek_doctor\n\t| summarize Time=max(TimeGenerated)"
    }
  ],
  "connectivityCriterias": [
    {
      "type": "IsConnectedQuery",
      "value": [
        "Corelight\n\t| summarize LastLogReceived = max(TimeGenerated)\n\t| project IsConnected = LastLogReceived > ago(30m)"
      ]
    }
  ],
  "availability": {
    "status": 1,
    "isPreview": false
  },
  "permissions": {
    "resourceProvider": [
      {
        "provider": "Microsoft.OperationalInsights/workspaces",
        "permissionsDisplayText": "read and write permissions are required.",
        "providerDisplayName": "Workspace",
        "scope": "Workspace",
        "requiredPermissions": {
          "write": true,
          "read": true,
          "delete": true
        }
      },
      {
        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
        "providerDisplayName": "Keys",
        "scope": "Workspace",
        "requiredPermissions": {
          "action": true
        }
      }
    ]
  },
  "instructionSteps": [
    {
      "title": "",
      "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**Corelight**](https://aka.ms/sentinel-Corelight-parser) which is deployed with the Microsoft Sentinel Solution.",
      "instructions": []
    },
    {
      "title": "1. Get the files",
      "description": "Contact your TAM, SE, or info@corelight.com to get the files needed for the Sentinel integration"
    },
    {
      "title": "2. Replay sample data",
      "description": "Replay sample data to create the needed tables in your Log Analytics workspace",
      "instructions": [
        {
          "parameters": {
            "fillWith": [
              "WorkspaceId",
              "PrimaryKey"
            ],
            "label": "Send sample data (only needed once per Log Analytics workspace)",
            "value": "./send_samples.py --workspace-id {0} --workspace-key {1}"
          },
          "type": "CopyableLabel"
        }
      ]
    },
    {
      "title": "3. Install custom exporter",
      "description": "Install the custom exporter or the logstash container"
    },
    {
      "title": "4. Configure the Corelight Sensor to send logs to the Azure Log Analytics Agent",
      "description": "Using the following values, configure your Corelight Sensor to use the Sentinel exporter. Alternatively, you can configure the logstash container with these values and configure your sensor to send JSON over TCP to that container on the appropriate port",
      "instructions": [
        {
          "parameters": {
            "fillWith": [
              "WorkspaceId"
            ],
            "label": "Workspace ID"
          },
          "type": "CopyableLabel"
        },
        {
          "parameters": {
            "fillWith": [
              "PrimaryKey"
            ],
            "label": "Primary Workspace Key"
          },
          "type": "CopyableLabel"
        }
      ]
    }
  ]
}
