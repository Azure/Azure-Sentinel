id: f8e7d6c5-b4a3-4122-8110-0987654321fe
name: Successful logins to SOC PRime platform from bad IP addresses
description: |
    'This rule identifies successful logins from IP addresses previously flagged as malicious (e.g., botnets, TOR exit nodes, or known malicious IPs)'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: SOCPrimeAuditLogsDataConnector
    dataTypes:
      - SOCPrimeAuditLogs_CL
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - Initial Access
relevantTechniques:
  - T1078
query: |
  let blacklistIPs = _GetWatchlist('blacklistOfIps')
  | project IPAddress = column_ifexists('ip', 'IPAddress');
  SOCPrimeAuditLogs_CL
  | where EventName == "Logged in to the SOC Prime Platform"
  | where IPAddress in (blacklistIPs)
  | project TimeGenerated, EventName, UserEmail, UserName, SourceIP, Uri, Type
version: 1.0.0
kind: Scheduled