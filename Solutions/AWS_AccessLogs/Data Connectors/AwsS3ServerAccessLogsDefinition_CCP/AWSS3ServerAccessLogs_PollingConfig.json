[
	{
		"name": "AwsS3 Access Logs Polling Config",
		"apiVersion": "2024-09-01",
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"location": "{{location}}",
		"kind": "AmazonWebServicesS3",
		"properties": {
			"connectorDefinitionName": "AwsS3ServerAccessLogsDefinition",
			"dataTypes": {
				"logs": {
					"state": "enabled"
				}
			},
			"dcrConfig": {
				"streamName": "SENTINEL_AWSS3SERVERACCESS",
				"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
				"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			},
			"destinationTable": "AWSS3ServerAccess",
			"dataFormat": {
                "Format": "csv",
                "CsvDelimiter": " ",
                "IsCompressed": false,
                "compressType": "None",
                "HasCsvHeader": false
            },
			"roleArn": "{{roleArn}}",
			"sqsUrls": [
				"{{queueUrl}}"
			]
		}
	}
]
