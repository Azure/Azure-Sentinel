id: 54c70d21-696f-4f03-9238-9d7118d079fe
name: Rubrik Critical Anomaly
version: 1.0.0
kind: Scheduled
description: |
  'Rubrik Critical Anomaly rule matches Severity and if Critical severity found then generate the incident for each object.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: RubrikSecurityCloudAzureFunctions
    dataTypes: 
      - RubrikAnomalyData
queryFrequency: 10m
queryPeriod: 10m
triggerOperator: gt
triggerThreshold: 0
tactics: 
  - Persistence
relevantTechniques:
  - T1546
query: |
       Rubrik_Anomaly_Data_CL
       | where severity_s == "critical"
eventGroupingSettings:
  aggregationKind: AlertPerResult
customDetails:
  ClusterIdentifier: custom_details_clusterId_g
  ObjectId: custom_details_objectId_g
  ObjectName: custom_details_objectName_s
  ObjectType: custom_details_objectType_s
  ClusterName: custom_details_clusterName_s
incidentConfiguration:
  createIncident: true