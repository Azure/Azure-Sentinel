{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Microsoft - support@microsoft.com",
    "comments": "Solution template for Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Fortiweb-workbook",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "email": "support@microsoft.com",
    "_email": "[variables('email')]",
    "_solutionName": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
    "_solutionVersion": "3.0.0",
    "solutionId": "azuresentinel.azure-sentinel-solution-fortiwebcloud",
    "_solutionId": "[variables('solutionId')]",
    "FortiWebCustomConnector": "FortiWebCustomConnector",
    "_FortiWebCustomConnector": "[variables('FortiWebCustomConnector')]",
    "TemplateEmptyArray": "[json('[]')]",
    "blanks": "[replace('b', 'b', '')]",
    "playbookVersion1": "1.0",
    "playbookContentId1": "FortiWebCustomConnector",
    "_playbookContentId1": "[variables('playbookContentId1')]",
    "playbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-lc-',uniquestring(variables('_playbookContentId1'))),variables('playbookVersion1')))]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "_playbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','lc','-', uniqueString(concat(variables('_solutionId'),'-','LogicAppsCustomConnector','-',variables('_playbookContentId1'),'-', variables('playbookVersion1'))))]",
    "FortiWeb-BlockIP-URL": "FortiWeb-BlockIP-URL",
    "_FortiWeb-BlockIP-URL": "[variables('FortiWeb-BlockIP-URL')]",
    "playbookVersion2": "1.0",
    "playbookContentId2": "FortiWeb-BlockIP-URL",
    "_playbookContentId2": "[variables('playbookContentId2')]",
    "playbookId2": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId2'))]",
    "playbookTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId2'))),variables('playbookVersion2')))]",
    "_playbookcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId2'),'-', variables('playbookVersion2'))))]",
    "FortiWeb-enrichment": "FortiWeb-enrichment",
    "_FortiWeb-enrichment": "[variables('FortiWeb-enrichment')]",
    "playbookVersion3": "1.0",
    "playbookContentId3": "FortiWeb-enrichment",
    "_playbookContentId3": "[variables('playbookContentId3')]",
    "playbookId3": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId3'))]",
    "playbookTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId3'))),variables('playbookVersion3')))]",
    "_playbookcontentProductId3": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId3'),'-', variables('playbookVersion3'))))]",
    "uiConfigId1": "FortinetFortiWeb",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "FortinetFortiWeb",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))),variables('dataConnectorVersion1')))]",
    "dataConnectorVersion1": "1.0.0",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "parserName1": "Fortiweb",
    "_parserName1": "[concat(parameters('workspace'),'/',variables('parserName1'))]",
    "parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
    "_parserId1": "[variables('parserId1')]",
    "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-pr-',uniquestring(variables('_parserContentId1'))),variables('parserVersion1')))]",
    "parserVersion1": "1.0.0",
    "parserContentId1": "Fortiweb-Parser",
    "_parserContentId1": "[variables('parserContentId1')]",
    "_parsercontentProductId1": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('_parserContentId1'),'-', variables('parserVersion1'))))]",
    "analyticRuleVersion1": "1.0.0",
    "analyticRulecontentId1": "86e9409f-b9ea-4e9a-8b72-5132ba43bcae",
    "_analyticRulecontentId1": "[variables('analyticRulecontentId1')]",
    "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', variables('analyticRulecontentId1'))]",
    "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-ar-',uniquestring(variables('_analyticRulecontentId1'))),variables('analyticRuleVersion1')))]",
    "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-',variables('_analyticRulecontentId1'),'-', variables('analyticRuleVersion1'))))]",
    "huntingQueryVersion1": "1.0.0",
    "huntingQuerycontentId1": "3rg4d567-0e82-4664-aca0-dc121a7th3ht",
    "_huntingQuerycontentId1": "[variables('huntingQuerycontentId1')]",
    "huntingQueryId1": "[resourceId('Microsoft.OperationalInsights/savedSearches', variables('_huntingQuerycontentId1'))]",
    "huntingQueryTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-hq-',uniquestring(variables('_huntingQuerycontentId1'))),variables('huntingQueryVersion1')))]",
    "_huntingQuerycontentProductId1": "[concat(take(variables('_solutionId'),50),'-','hq','-', uniqueString(concat(variables('_solutionId'),'-','HuntingQuery','-',variables('_huntingQuerycontentId1'),'-', variables('huntingQueryVersion1'))))]",
    "huntingQueryVersion2": "1.0.0",
    "huntingQuerycontentId2": "9fc7d945-0e82-4664-aca0-dc121a7rt5nt",
    "_huntingQuerycontentId2": "[variables('huntingQuerycontentId2')]",
    "huntingQueryId2": "[resourceId('Microsoft.OperationalInsights/savedSearches', variables('_huntingQuerycontentId2'))]",
    "huntingQueryTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-hq-',uniquestring(variables('_huntingQuerycontentId2'))),variables('huntingQueryVersion2')))]",
    "_huntingQuerycontentProductId2": "[concat(take(variables('_solutionId'),50),'-','hq','-', uniqueString(concat(variables('_solutionId'),'-','HuntingQuery','-',variables('_huntingQuerycontentId2'),'-', variables('huntingQueryVersion2'))))]",
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "Fortiweb-workbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))),variables('workbookVersion1')))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "FortiWebCustomConnector Playbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion1')]",
          "parameters": {
            "CustomConnectorName": {
              "defaultValue": "FortiWebCloud",
              "type": "String",
              "metadata": {
                "description": "Name of the custom connector, if you want to change the default name, make sure to use the same in all FortiWebCloud automation playbooks as well"
              }
            },
            "FortiwebURL": {
              "defaultValue": "api.fortiweb-cloud.com",
              "type": "String",
              "metadata": {
                "description": "Enter your FortiWebCloud url for example: api.fortiweb-cloud.com. Do NOT prefix with https:// or http:// etc"
              }
            }
          },
          "variables": {
            "api_host": "[[parameters('FortiwebURL')]",
            "operationId-GetRequestLimits": "GetRequestLimits",
            "_operationId-GetRequestLimits": "[[variables('operationId-GetRequestLimits')]",
            "operationId-UpdateRequestLimits": "UpdateRequestLimits",
            "_operationId-UpdateRequestLimits": "[[variables('operationId-UpdateRequestLimits')]",
            "operationId-GetUrlAccess": "GetUrlAccess",
            "_operationId-GetUrlAccess": "[[variables('operationId-GetUrlAccess')]",
            "operationId-UpdateUrlAccess": "UpdateUrlAccess",
            "_operationId-UpdateUrlAccess": "[[variables('operationId-UpdateUrlAccess')]",
            "operationId-GetIpProtection": "GetIpProtection",
            "_operationId-GetIpProtection": "[[variables('operationId-GetIpProtection')]",
            "operationId-UpdateIpProtection": "UpdateIpProtection",
            "_operationId-UpdateIpProtection": "[[variables('operationId-UpdateIpProtection')]",
            "operationId-GetKnownBotInfo": "GetKnownBotInfo",
            "_operationId-GetKnownBotInfo": "[[variables('operationId-GetKnownBotInfo')]",
            "operationId-GetBotDetection": "GetBotDetection",
            "_operationId-GetBotDetection": "[[variables('operationId-GetBotDetection')]",
            "operationId-UpdateBotDetection": "UpdateBotDetection",
            "_operationId-UpdateBotDetection": "[[variables('operationId-UpdateBotDetection')]",
            "operationId-GetMachineLearningBotDetection": "GetMachineLearningBotDetection",
            "_operationId-GetMachineLearningBotDetection": "[[variables('operationId-GetMachineLearningBotDetection')]",
            "operationId-UpdateMachineLearningBotDetection": "UpdateMachineLearningBotDetection",
            "_operationId-UpdateMachineLearningBotDetection": "[[variables('operationId-UpdateMachineLearningBotDetection')]",
            "operationId-GetBiometricsBasedDetection": "GetBiometricsBasedDetection",
            "_operationId-GetBiometricsBasedDetection": "[[variables('operationId-GetBiometricsBasedDetection')]",
            "operationId-UpdateBiometricsBasedDetection": "UpdateBiometricsBasedDetection",
            "_operationId-UpdateBiometricsBasedDetection": "[[variables('operationId-UpdateBiometricsBasedDetection')]",
            "operationId-GetBotDeception": "GetBotDeception",
            "_operationId-GetBotDeception": "[[variables('operationId-GetBotDeception')]",
            "operationId-UpdateBotDeception": "UpdateBotDeception",
            "_operationId-UpdateBotDeception": "[[variables('operationId-UpdateBotDeception')]",
            "operationId-GetDdosPrevention": "GetDdosPrevention",
            "_operationId-GetDdosPrevention": "[[variables('operationId-GetDdosPrevention')]",
            "operationId-UpdateDdosPrevention": "UpdateDdosPrevention",
            "_operationId-UpdateDdosPrevention": "[[variables('operationId-UpdateDdosPrevention')]",
            "operationId-GetCustomRule": "GetCustomRule",
            "_operationId-GetCustomRule": "[[variables('operationId-GetCustomRule')]",
            "operationId-UpdateCustomRule": "UpdateCustomRule",
            "_operationId-UpdateCustomRule": "[[variables('operationId-UpdateCustomRule')]",
            "operationId-GetWebsocketSecurity": "GetWebsocketSecurity",
            "_operationId-GetWebsocketSecurity": "[[variables('operationId-GetWebsocketSecurity')]",
            "operationId-UpdateWebsocketSecurity": "UpdateWebsocketSecurity",
            "_operationId-UpdateWebsocketSecurity": "[[variables('operationId-UpdateWebsocketSecurity')]",
            "operationId-GetAttackLogsList": "GetAttackLogsList",
            "_operationId-GetAttackLogsList": "[[variables('operationId-GetAttackLogsList')]",
            "operationId-GetAttackLogDetail": "GetAttackLogDetail",
            "_operationId-GetAttackLogDetail": "[[variables('operationId-GetAttackLogDetail')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "playbookContentId1": "FortiWebCustomConnector",
            "playbookId1": "[[resourceId('Microsoft.Web/customApis', parameters('CustomConnectorName'))]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "type": "Microsoft.Web/customApis",
              "apiVersion": "2016-06-01",
              "name": "[[parameters('CustomConnectorName')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "connectionParameters": {
                  "api_key": {
                    "type": "securestring",
                    "uiDefinition": {
                      "displayName": "API Key",
                      "description": "The API Key for FortiWebCloud api",
                      "tooltip": "API Key starts with Basic <<api key>>",
                      "constraints": {
                        "tabIndex": 2,
                        "clearText": false,
                        "required": "true"
                      }
                    }
                  }
                },
                "capabilities": "[variables('TemplateEmptyArray')]",
                "description": "[[concat(parameters('CustomConnectorName'), ' connector provides an API that uses Representational State Transfer (RESTful API) design principles to access and modify the settings of ', parameters('CustomConnectorName'), ' applications.\n\nNote: For better understanding , check https://apidoc.fortiweb-cloud.com/')]",
                "displayName": "[[parameters('CustomConnectorName')]",
                "iconUri": "data:image/png;base64,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",
                "backendService": {
                  "serviceUrl": "[[[uri(concat('https://', variables('api_host')),'')]"
                },
                "apiType": "Rest",
                "swagger": {
                  "swagger": "2.0",
                  "info": {
                    "version": "1.0.0",
                    "title": "FortiWebCloud",
                    "description": "FortiWebCloud connector provides an API that uses Representational State Transfer (RESTful API) design principles to access and modify the settings of FortiWeb applications.\n\nNote: For better understanding , check https://apidoc.fortiweb-cloud.com/"
                  },
                  "host": "[[parameters('FortiwebURL')]",
                  "basePath": "/",
                  "schemes": [
                    "https"
                  ],
                  "consumes": "[variables('TemplateEmptyArray')]",
                  "produces": [
                    "application/json"
                  ],
                  "paths": {
                    "/v1/application/{ep_id}/requestlimits": {
                      "get": {
                        "summary": "Get Request Limits",
                        "description": "Get Request Limits",
                        "operationId": "[[variables('_operationId-GetRequestLimits')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update Request Limits",
                        "description": "Update Request Limits",
                        "operationId": "[[variables('_operationId-UpdateRequestLimits')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "AllowMethodPolicy": {
                                  "type": "object",
                                  "properties": {
                                    "allow-method": {
                                      "type": "string",
                                      "description": "allow-method"
                                    }
                                  },
                                  "description": "AllowMethodPolicy"
                                },
                                "HttpProtocolParameterRestriction": {
                                  "type": "object",
                                  "properties": {
                                    "illegal-byte-in-url-check": {
                                      "type": "string",
                                      "description": "illegal-byte-in-url-check"
                                    },
                                    "number-of-ranges-in-range-header": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "number-of-ranges-in-range-header"
                                    },
                                    "max-header-line-request": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-header-line-request"
                                    },
                                    "max-http-header-name-length": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-http-header-name-length"
                                    },
                                    "malformed-url-check": {
                                      "type": "string",
                                      "description": "malformed-url-check"
                                    },
                                    "max-url-param-name-len": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-url-param-name-len"
                                    },
                                    "max-http-header-value-length": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-http-header-value-length"
                                    },
                                    "max-http-header-length": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-http-header-length"
                                    },
                                    "duplicate-paramname-check": {
                                      "type": "string",
                                      "description": "duplicate-paramname-check"
                                    },
                                    "null-byte-in-url-check": {
                                      "type": "string",
                                      "description": "null-byte-in-url-check"
                                    },
                                    "max-url-param-value-len": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-url-param-value-len"
                                    },
                                    "max-url-parameter-length": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-url-parameter-length"
                                    },
                                    "max-cookie-in-request": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-cookie-in-request"
                                    },
                                    "max-url-parameter": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-url-parameter"
                                    },
                                    "redundant-header-check": {
                                      "type": "string",
                                      "description": "redundant-header-check"
                                    },
                                    "max-http-request-filename-length": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "max-http-request-filename-length"
                                    }
                                  },
                                  "description": "HttpProtocolParameterRestriction"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "AllowMethodPolicy": {
                                  "allow-method": "get post head options"
                                },
                                "HttpProtocolParameterRestriction": {
                                  "illegal-byte-in-url-check": "enable",
                                  "number-of-ranges-in-range-header": 5,
                                  "max-header-line-request": 32,
                                  "max-http-header-name-length": 50,
                                  "malformed-url-check": "enable",
                                  "max-url-param-name-len": 4096,
                                  "max-http-header-value-length": 4096,
                                  "max-http-header-length": 8192,
                                  "duplicate-paramname-check": "enable",
                                  "null-byte-in-url-check": "enable",
                                  "max-url-param-value-len": 4096,
                                  "max-url-parameter-length": 8191,
                                  "max-cookie-in-request": 121,
                                  "max-url-parameter": 128,
                                  "redundant-header-check": "enable",
                                  "max-http-request-filename-length": 2048
                                }
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/urlaccess": {
                      "get": {
                        "summary": "Get URL Access",
                        "description": "Get URL Access",
                        "operationId": "[[variables('_operationId-GetUrlAccess')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "detail": {
                                  "type": "string",
                                  "description": "detail"
                                },
                                "result": {
                                  "type": "object",
                                  "properties": {
                                    "_status": {
                                      "type": "string",
                                      "description": "_status"
                                    },
                                    "template_status": {
                                      "type": "string",
                                      "description": "template_status"
                                    },
                                    "urlaccess": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "name": {
                                            "type": "string",
                                            "description": "name"
                                          },
                                          "action": {
                                            "type": "string",
                                            "description": "action"
                                          },
                                          "reg-exp": {
                                            "type": "string",
                                            "description": "reg-exp"
                                          }
                                        }
                                      },
                                      "description": "urlaccess"
                                    }
                                  },
                                  "description": "result"
                                }
                              }
                            }
                          }
                        }
                      },
                      "put": {
                        "summary": "Update URL Access",
                        "description": "Update URL Access",
                        "operationId": "[[variables('_operationId-UpdateUrlAccess')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "urlaccess": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "action": {
                                        "type": "string",
                                        "description": "action",
                                        "title": "[variables('blanks')]",
                                        "enum": [
                                          "pass",
                                          "alert_deny",
                                          "deny_no_log",
                                          "continue"
                                        ]
                                      },
                                      "name": {
                                        "type": "string",
                                        "description": "name"
                                      },
                                      "reg-exp": {
                                        "type": "string",
                                        "description": "reg-exp"
                                      }
                                    }
                                  },
                                  "description": "urlaccess"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "urlaccess": [
                                  {
                                    "action": "pass",
                                    "name": "rule1",
                                    "reg-exp": "/abc"
                                  }
                                ]
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/ipprotection": {
                      "get": {
                        "summary": "Get IP Protection",
                        "description": "Get IP Protection",
                        "operationId": "[[variables('_operationId-GetIpProtection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "detail": {
                                  "type": "string",
                                  "description": "detail"
                                },
                                "result": {
                                  "type": "object",
                                  "properties": {
                                    "_status": {
                                      "type": "string",
                                      "description": "_status"
                                    },
                                    "IPProtection": {
                                      "type": "object",
                                      "properties": {
                                        "geo-ip-block": {
                                          "type": "object",
                                          "properties": {
                                            "members": {
                                              "type": "array",
                                              "items": {
                                                "type": "string"
                                              },
                                              "description": "members"
                                            }
                                          },
                                          "description": "geo-ip-block"
                                        },
                                        "ip-list": {
                                          "type": "object",
                                          "properties": {
                                            "block-period": {
                                              "type": "integer",
                                              "format": "int32",
                                              "description": "block-period"
                                            },
                                            "members": {
                                              "type": "array",
                                              "items": {
                                                "type": "object",
                                                "properties": {
                                                  "type": {
                                                    "type": "string",
                                                    "description": "type"
                                                  },
                                                  "name": {
                                                    "type": "string",
                                                    "description": "name"
                                                  },
                                                  "ip": {
                                                    "type": "string",
                                                    "description": "ip"
                                                  }
                                                }
                                              },
                                              "description": "members"
                                            }
                                          },
                                          "description": "ip-list"
                                        },
                                        "ip-reputation": {
                                          "type": "string",
                                          "description": "ip-reputation"
                                        }
                                      },
                                      "description": "IPProtection"
                                    },
                                    "template_status": {
                                      "type": "string",
                                      "description": "template_status"
                                    }
                                  },
                                  "description": "result"
                                }
                              }
                            }
                          }
                        }
                      },
                      "put": {
                        "summary": "Update IP Protection",
                        "description": "Update IP Protection",
                        "operationId": "[[variables('_operationId-UpdateIpProtection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "IPProtection": {
                                  "type": "object",
                                  "properties": {
                                    "ip-reputation": {
                                      "type": "string",
                                      "description": "ip-reputation"
                                    },
                                    "geo-ip-block": {
                                      "type": "object",
                                      "properties": {
                                        "members": {
                                          "type": "array",
                                          "items": {
                                            "type": "string",
                                            "description": "Geo IP members",
                                            "title": "[variables('blanks')]",
                                            "default": "Geo IP members"
                                          },
                                          "description": "members"
                                        }
                                      },
                                      "description": "geo-ip-block"
                                    },
                                    "ip-list": {
                                      "type": "object",
                                      "properties": {
                                        "members": {
                                          "type": "array",
                                          "items": {
                                            "type": "object",
                                            "properties": {
                                              "type": {
                                                "type": "string",
                                                "description": "type",
                                                "title": "[variables('blanks')]",
                                                "enum": [
                                                  "trust-ip",
                                                  "block-ip",
                                                  "allow-only-ip"
                                                ]
                                              },
                                              "name": {
                                                "type": "string",
                                                "description": "name"
                                              },
                                              "ip": {
                                                "type": "string",
                                                "description": "ip"
                                              }
                                            }
                                          },
                                          "description": "members"
                                        }
                                      },
                                      "description": "ip-list"
                                    }
                                  },
                                  "description": "IPProtection"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "IPProtection": {
                                  "ip-reputation": "enable",
                                  "geo-ip-block": {
                                    "members": [
                                      "Antigua And Barbuda",
                                      "Aland Islands",
                                      "Afghanistan"
                                    ]
                                  },
                                  "ip-list": {
                                    "members": [
                                      {
                                        "type": "allow-only-ip",
                                        "name": "3",
                                        "ip": "4.1.1.1-4.1.1.17,4.1.1.19,3::4-3::14"
                                      },
                                      {
                                        "type": "block-ip",
                                        "name": "2",
                                        "ip": "3.1.1.1,3.1.1.11-3.1.1.17,2::2-2::14"
                                      },
                                      {
                                        "type": "allow-only-ip",
                                        "name": "3",
                                        "ip": "4.1.1.1-4.1.1.17,4.1.1.19,3::4-3::14"
                                      }
                                    ]
                                  }
                                }
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/misc/knownbot-info/": {
                      "get": {
                        "summary": "Get Known Bot Info",
                        "description": "Get Known Bot Info",
                        "operationId": "[[variables('_operationId-GetKnownBotInfo')]",
                        "parameters": [
                          {
                            "name": "bot-type",
                            "default": "{{bot-type}}",
                            "in": "query",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "category",
                            "default": "{{category}}",
                            "in": "query",
                            "type": "string",
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/botdetection": {
                      "get": {
                        "summary": "Get Bot Detection",
                        "description": "Get Bot Detection",
                        "operationId": "[[variables('_operationId-GetBotDetection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update Bot Detection",
                        "description": "Update Bot Detection",
                        "operationId": "[[variables('_operationId-UpdateBotDetection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "Predefined-Vulnerability Scanning": {
                                  "type": "string",
                                  "description": "Predefined-Vulnerability Scanning"
                                },
                                "exception rule": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "signature_name": {
                                        "type": "string",
                                        "description": "signature_name"
                                      },
                                      "signature_id": {
                                        "type": "string",
                                        "description": "signature_id"
                                      },
                                      "url": {
                                        "type": "object",
                                        "properties": {
                                          "value": {
                                            "type": "string",
                                            "description": "value"
                                          },
                                          "operator": {
                                            "type": "string",
                                            "description": "operator"
                                          },
                                          "status": {
                                            "type": "string",
                                            "description": "status"
                                          }
                                        },
                                        "description": "url"
                                      },
                                      "parameter": {
                                        "type": "object",
                                        "properties": {
                                          "value": {
                                            "type": "string",
                                            "description": "value"
                                          },
                                          "operator": {
                                            "type": "string",
                                            "description": "operator"
                                          },
                                          "status": {
                                            "type": "string",
                                            "description": "status"
                                          }
                                        },
                                        "description": "parameter"
                                      }
                                    }
                                  },
                                  "description": "exception rule"
                                },
                                "known-bad-bots": {
                                  "type": "string",
                                  "description": "known-bad-bots"
                                },
                                "botdetection": {
                                  "type": "string",
                                  "description": "botdetection"
                                },
                                "Predefined-Content-Scraping": {
                                  "type": "string",
                                  "description": "Predefined-Content-Scraping"
                                },
                                "challenge": {
                                  "type": "string",
                                  "description": "challenge"
                                },
                                "Predefined-Crawler": {
                                  "type": "string",
                                  "description": "Predefined-Crawler"
                                },
                                "Predefined-Slow-Attack": {
                                  "type": "string",
                                  "description": "Predefined-Slow-Attack"
                                },
                                "Predefined-Credential-Based-Brute-Force": {
                                  "type": "string",
                                  "description": "Predefined-Credential-Based-Brute-Force"
                                },
                                "brute-login-request-file": {
                                  "type": "string",
                                  "description": "brute-login-request-file"
                                },
                                "brute-login-occurrence-num": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "brute-login-occurrence-num"
                                },
                                "brute-login-within": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "brute-login-within"
                                },
                                "known-search-engine": {
                                  "type": "string",
                                  "description": "known-search-engine"
                                },
                                "action": {
                                  "type": "string",
                                  "description": "action"
                                }
                              },
                              "default": {
                                "Predefined-Vulnerability Scanning": "enable",
                                "exception rule": [
                                  {
                                    "signature_name": "Known Bad Bots",
                                    "signature_id": "110000004",
                                    "url": {
                                      "value": "/newbot",
                                      "operator": "STRING_MATCH",
                                      "status": "enable"
                                    },
                                    "parameter": {
                                      "value": "abc",
                                      "operator": "STRING_MATCH",
                                      "status": "enable"
                                    }
                                  }
                                ],
                                "known-bad-bots": "enable",
                                "botdetection": "enable",
                                "Predefined-Content-Scraping": "enable",
                                "challenge": "RBE",
                                "Predefined-Crawler": "enable",
                                "Predefined-Slow-Attack": "enable",
                                "Predefined-Credential-Based-Brute-Force": "enable",
                                "brute-login-request-file": "^/login.(php|asp|aspx|jsp)",
                                "brute-login-occurrence-num": 10,
                                "brute-login-within": 60,
                                "known-search-engine": "enable",
                                "action": "deny_no_log"
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/mlbotdetection": {
                      "get": {
                        "summary": "GET Machine Learning Bot Detection",
                        "description": "GET Machine Learning Bot Detection",
                        "operationId": "[[variables('_operationId-GetMachineLearningBotDetection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update Machine Learning Bot Detection",
                        "description": "Update Machine Learning Bot Detection",
                        "operationId": "[[variables('_operationId-UpdateMachineLearningBotDetection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "detection_status": {
                                  "type": "string",
                                  "description": "detection_status"
                                },
                                "identification_method": {
                                  "type": "string",
                                  "description": "identification_method"
                                },
                                "model_type": {
                                  "type": "string",
                                  "description": "model_type"
                                },
                                "detection_setting": {
                                  "type": "object",
                                  "properties": {
                                    "anomaly_setting": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "anomaly_setting"
                                    },
                                    "challenge": {
                                      "type": "string",
                                      "description": "challenge"
                                    },
                                    "action": {
                                      "type": "string",
                                      "description": "action"
                                    },
                                    "block_duration": {
                                      "type": "integer",
                                      "format": "int32",
                                      "description": "block_duration"
                                    }
                                  },
                                  "description": "detection_setting"
                                },
                                "source_ip": {
                                  "type": "array",
                                  "description": "source_ip"
                                },
                                "exception_urls": {
                                  "type": "array",
                                  "description": "exception_urls"
                                },
                                "template_status": {
                                  "type": "string",
                                  "description": "template_status"
                                }
                              },
                              "default": {
                                "detection_status": "enable",
                                "identification_method": "IP",
                                "model_type": "Strict",
                                "detection_setting": {
                                  "anomaly_setting": 3,
                                  "challenge": "Disable",
                                  "action": "alert",
                                  "block_duration": 0
                                },
                                "source_ip": "[variables('TemplateEmptyArray')]",
                                "exception_urls": "[variables('TemplateEmptyArray')]",
                                "template_status": "disable"
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/biometricsbaseddetection": {
                      "get": {
                        "summary": "Get Biometrics Based Detection",
                        "description": "Get Biometrics Based Detection",
                        "operationId": "[[variables('_operationId-GetBiometricsBasedDetection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update Biometrics Based Detection",
                        "description": "Update Biometrics Based Detection",
                        "operationId": "[[variables('_operationId-UpdateBiometricsBasedDetection')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "keyboard": {
                                  "type": "string",
                                  "description": "keyboard"
                                },
                                "event-collection-time": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "event-collection-time"
                                },
                                "url-list": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "name": {
                                        "type": "string",
                                        "description": "name"
                                      },
                                      "url": {
                                        "type": "string",
                                        "description": "url"
                                      }
                                    }
                                  },
                                  "description": "url-list"
                                },
                                "bot-effective-time": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "bot-effective-time"
                                },
                                "scroll": {
                                  "type": "string",
                                  "description": "scroll"
                                },
                                "mouse-movement": {
                                  "type": "string",
                                  "description": "mouse-movement"
                                },
                                "screen-touch": {
                                  "type": "string",
                                  "description": "screen-touch"
                                },
                                "click": {
                                  "type": "string",
                                  "description": "click"
                                },
                                "action": {
                                  "type": "string",
                                  "description": "action"
                                },
                                "template_status": {
                                  "type": "string",
                                  "description": "template_status"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "keyboard": "enable",
                                "event-collection-time": 15,
                                "url-list": [
                                  {
                                    "name": "1",
                                    "url": "/test"
                                  }
                                ],
                                "bot-effective-time": 5,
                                "scroll": "enable",
                                "mouse-movement": "enable",
                                "screen-touch": "enable",
                                "click": "enable",
                                "action": "alert",
                                "template_status": "disable"
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/botdeception": {
                      "get": {
                        "summary": "Get Bot Deception",
                        "description": "Get Bot Deception",
                        "operationId": "[[variables('_operationId-GetBotDeception')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update Bot Deception",
                        "description": "Update Bot Deception",
                        "operationId": "[[variables('_operationId-UpdateBotDeception')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "template_status": {
                                  "type": "string",
                                  "description": "template_status"
                                },
                                "action": {
                                  "type": "string",
                                  "description": "action"
                                },
                                "botdeception": {
                                  "type": "object",
                                  "properties": {
                                    "url-list": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "type": {
                                            "type": "string",
                                            "description": "type"
                                          },
                                          "url": {
                                            "type": "string",
                                            "description": "url"
                                          }
                                        }
                                      },
                                      "description": "url-list"
                                    },
                                    "deception-url": {
                                      "type": "string",
                                      "description": "deception-url"
                                    }
                                  },
                                  "description": "botdeception"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "template_status": "disable",
                                "action": "alert",
                                "botdeception": {
                                  "url-list": [
                                    {
                                      "type": "regex-expression",
                                      "url": "/t1"
                                    }
                                  ],
                                  "deception-url": "/TU"
                                }
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/ddosprevention": {
                      "get": {
                        "summary": "Get DDos Prevention",
                        "description": "Get DDos Prevention",
                        "operationId": "[[variables('_operationId-GetDdosPrevention')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Accept",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Accept"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update DDos Prevention",
                        "description": "Update DDos Prevention",
                        "operationId": "[[variables('_operationId-UpdateDdosPrevention')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "application-layer-dos-prevention": {
                                  "type": "string",
                                  "description": "application-layer-dos-prevention"
                                },
                                "layer4-access-limit-rule": {
                                  "type": "string",
                                  "description": "layer4-access-limit-rule"
                                },
                                "access-limit-share-ip": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "access-limit-share-ip"
                                },
                                "http-connection-flood-check-rule": {
                                  "type": "string",
                                  "description": "http-connection-flood-check-rule"
                                },
                                "http-connection-threshold": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "http-connection-threshold"
                                },
                                "http-request-flood-prevention-rule": {
                                  "type": "string",
                                  "description": "http-request-flood-prevention-rule"
                                },
                                "access-limit-in-http-session": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "access-limit-in-http-session"
                                },
                                "bot-recognition": {
                                  "type": "string",
                                  "description": "bot-recognition"
                                },
                                "block-period": {
                                  "type": "integer",
                                  "format": "int32",
                                  "description": "block-period"
                                },
                                "action": {
                                  "type": "string",
                                  "description": "action"
                                }
                              },
                              "default": {
                                "application-layer-dos-prevention": "disable",
                                "layer4-access-limit-rule": "enable",
                                "access-limit-share-ip": 50,
                                "http-connection-flood-check-rule": "enable",
                                "http-connection-threshold": 100,
                                "http-request-flood-prevention-rule": "enable",
                                "access-limit-in-http-session": 500,
                                "bot-recognition": "real-browser-enforcement",
                                "block-period": 999,
                                "action": "block_period"
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/customrule": {
                      "get": {
                        "summary": "Get Custom Rule",
                        "description": "Get Custom Rule",
                        "operationId": "[[variables('_operationId-GetCustomRule')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update Custom Rule",
                        "description": "Update Custom Rule",
                        "operationId": "[[variables('_operationId-UpdateCustomRule')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "custom_rules": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "bot-recognition": {
                                        "type": "string",
                                        "description": "bot-recognition"
                                      },
                                      "action": {
                                        "type": "string",
                                        "description": "action"
                                      },
                                      "block-period": {
                                        "type": "integer",
                                        "format": "int32",
                                        "description": "block-period"
                                      },
                                      "rules": {
                                        "type": "array",
                                        "items": {
                                          "type": "object",
                                          "properties": {
                                            "id": {
                                              "type": "string",
                                              "description": "id"
                                            },
                                            "source-ip": {
                                              "type": "string",
                                              "description": "source-ip"
                                            },
                                            "exclusive-match": {
                                              "type": "string",
                                              "description": "exclusive-match"
                                            },
                                            "filter_type": {
                                              "type": "string",
                                              "description": "filter_type"
                                            },
                                            "reverse-match": {
                                              "type": "string",
                                              "description": "reverse-match"
                                            },
                                            "request-file": {
                                              "type": "string",
                                              "description": "request-file"
                                            },
                                            "header-field-check": {
                                              "type": "string",
                                              "description": "header-field-check"
                                            },
                                            "header-name-type": {
                                              "type": "string",
                                              "description": "header-name-type"
                                            },
                                            "predefined-header": {
                                              "type": "string",
                                              "description": "predefined-header"
                                            },
                                            "header-value": {
                                              "type": "string",
                                              "description": "header-value"
                                            },
                                            "pre-header-rev-match": {
                                              "type": "string",
                                              "description": "pre-header-rev-match"
                                            },
                                            "custom-header-name": {
                                              "type": "string",
                                              "description": "custom-header-name"
                                            },
                                            "cus-header-rev-match": {
                                              "type": "string",
                                              "description": "cus-header-rev-match"
                                            },
                                            "http-method-check": {
                                              "type": "string",
                                              "description": "http-method-check"
                                            },
                                            "http-method-value": {
                                              "type": "string",
                                              "description": "http-method-value"
                                            },
                                            "http-method-rev-match": {
                                              "type": "string",
                                              "description": "http-method-rev-match"
                                            },
                                            "access-rate-limit": {
                                              "type": "string",
                                              "description": "access-rate-limit"
                                            },
                                            "http-transaction-timeout": {
                                              "type": "string",
                                              "description": "http-transaction-timeout"
                                            },
                                            "response-code": {
                                              "type": "string",
                                              "description": "response-code"
                                            },
                                            "packet-interval-timeout": {
                                              "type": "string",
                                              "description": "packet-interval-timeout"
                                            },
                                            "name": {
                                              "type": "string",
                                              "description": "name"
                                            },
                                            "value": {
                                              "type": "string",
                                              "description": "value"
                                            },
                                            "content-type-set": {
                                              "type": "string",
                                              "description": "content-type-set"
                                            },
                                            "occurrence-num": {
                                              "type": "integer",
                                              "format": "int32",
                                              "description": "occurrence-num"
                                            },
                                            "within": {
                                              "type": "integer",
                                              "format": "int32",
                                              "description": "within"
                                            },
                                            "cross-site-scripting": {
                                              "type": "string",
                                              "description": "cross-site-scripting"
                                            },
                                            "sql-injection": {
                                              "type": "string",
                                              "description": "sql-injection"
                                            },
                                            "generic-attacks": {
                                              "type": "string",
                                              "description": "generic-attacks"
                                            },
                                            "known-exploits": {
                                              "type": "string",
                                              "description": "known-exploits"
                                            },
                                            "trojans": {
                                              "type": "string",
                                              "description": "trojans"
                                            }
                                          }
                                        },
                                        "description": "rules"
                                      },
                                      "name": {
                                        "type": "string",
                                        "description": "name"
                                      }
                                    }
                                  },
                                  "description": "custom_rules"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "custom_rules": [
                                  {
                                    "bot-recognition": "disabled",
                                    "action": "alert_deny",
                                    "block-period": 60,
                                    "rules": [
                                      {
                                        "id": "11",
                                        "source-ip": "20.2.3.5-20.2.3.40",
                                        "exclusive-match": "no",
                                        "filter_type": "security-rules",
                                        "reverse-match": "yes",
                                        "request-file": "/testfile",
                                        "header-field-check": "enable",
                                        "header-name-type": "custom",
                                        "predefined-header": "Accept",
                                        "header-value": "regxxx",
                                        "pre-header-rev-match": "enable",
                                        "custom-header-name": "xxcustom",
                                        "cus-header-rev-match": "enable",
                                        "http-method-check": "enable",
                                        "http-method-value": "xfe",
                                        "http-method-rev-match": "enable",
                                        "access-rate-limit": "113",
                                        "http-transaction-timeout": "123",
                                        "response-code": "200-400",
                                        "packet-interval-timeout": "13",
                                        "name": "fexx",
                                        "value": "noneed",
                                        "content-type-set": "text/plain text/html",
                                        "occurrence-num": 113,
                                        "within": 36,
                                        "cross-site-scripting": "enable",
                                        "sql-injection": "enable",
                                        "generic-attacks": "enable",
                                        "known-exploits": "enable",
                                        "trojans": "enable"
                                      },
                                      {
                                        "id": "2",
                                        "filter_type": "url-filter",
                                        "reverse-match": "yes",
                                        "request-file": "/testfile"
                                      },
                                      {
                                        "id": "3",
                                        "filter_type": "http-header-filter",
                                        "header-field-check": "enable",
                                        "header-name-type": "predefined",
                                        "predefined-header": "Accept",
                                        "header-value": "regxxx",
                                        "pre-header-rev-match": "enable"
                                      },
                                      {
                                        "id": "12",
                                        "filter_type": "http-header-filter",
                                        "header-field-check": "enable",
                                        "header-name-type": "custom",
                                        "custom-header-name": "xxcustom",
                                        "header-value": "regxxx",
                                        "cus-header-rev-match": "enable",
                                        "http-method-check": "enable",
                                        "http-method-value": "xfe",
                                        "http-method-rev-match": "enable"
                                      },
                                      {
                                        "id": "4",
                                        "filter_type": "access-limit-filter",
                                        "access-rate-limit": "113"
                                      },
                                      {
                                        "id": "13",
                                        "filter_type": "http-header-filter",
                                        "http-method-check": "enable",
                                        "http-method-value": "xfe",
                                        "http-method-rev-match": "enable"
                                      },
                                      {
                                        "id": "5",
                                        "filter_type": "http-transaction",
                                        "http-transaction-timeout": "123"
                                      },
                                      {
                                        "id": "6",
                                        "filter_type": "response-code",
                                        "response-code": "200-400"
                                      },
                                      {
                                        "id": "7",
                                        "filter_type": "packet-interval",
                                        "packet-interval-timeout": "13"
                                      },
                                      {
                                        "id": "8",
                                        "filter_type": "parameter",
                                        "name": "fexx",
                                        "value": "noneed"
                                      },
                                      {
                                        "id": "9",
                                        "filter_type": "content-type",
                                        "content-type-set": "text/plain text/html"
                                      },
                                      {
                                        "id": "10",
                                        "filter_type": "occurrence",
                                        "occurrence-num": 113,
                                        "within": 36
                                      },
                                      {
                                        "id": "11",
                                        "filter_type": "security-rules",
                                        "cross-site-scripting": "enable",
                                        "sql-injection": "enable",
                                        "generic-attacks": "enable",
                                        "known-exploits": "enable",
                                        "trojans": "enable"
                                      }
                                    ],
                                    "name": "rule1"
                                  }
                                ]
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/websocketsecurity": {
                      "get": {
                        "summary": "Get WebSocket Security",
                        "description": "Get WebSocket Security",
                        "operationId": "[[variables('_operationId-GetWebsocketSecurity')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      },
                      "put": {
                        "summary": "Update WebSocket Security",
                        "description": "Update WebSocket Security",
                        "operationId": "[[variables('_operationId-UpdateWebsocketSecurity')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "default": "{{ep_id}}",
                            "in": "path",
                            "type": "string",
                            "required": true
                          },
                          {
                            "name": "Content-Type",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Content-Type"
                          },
                          {
                            "name": "body",
                            "in": "body",
                            "schema": {
                              "type": "object",
                              "properties": {
                                "_status": {
                                  "type": "string",
                                  "description": "_status"
                                },
                                "action": {
                                  "type": "string",
                                  "description": "action"
                                },
                                "WebSocketSecurity": {
                                  "type": "object",
                                  "properties": {
                                    "rule-list": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "seq": {
                                            "type": "integer",
                                            "format": "int32",
                                            "description": "seq"
                                          },
                                          "allow-plain-text": {
                                            "type": "string",
                                            "description": "allow-plain-text"
                                          },
                                          "block-extensions": {
                                            "type": "string",
                                            "description": "block-extensions"
                                          },
                                          "allowed-origin-list": {
                                            "type": "array",
                                            "items": {
                                              "type": "object",
                                              "properties": {
                                                "name": {
                                                  "type": "string",
                                                  "description": "name"
                                                },
                                                "origin": {
                                                  "type": "string",
                                                  "description": "origin"
                                                }
                                              }
                                            },
                                            "description": "allowed-origin-list"
                                          },
                                          "name": {
                                            "type": "string",
                                            "description": "name"
                                          },
                                          "enable-attack-signatures": {
                                            "type": "string",
                                            "description": "enable-attack-signatures"
                                          },
                                          "block-websocket-traffic": {
                                            "type": "string",
                                            "description": "block-websocket-traffic"
                                          },
                                          "url": {
                                            "type": "string",
                                            "description": "url"
                                          },
                                          "allow-binary-text": {
                                            "type": "string",
                                            "description": "allow-binary-text"
                                          }
                                        }
                                      },
                                      "description": "rule-list"
                                    }
                                  },
                                  "description": "WebSocketSecurity"
                                }
                              },
                              "default": {
                                "_status": "enable",
                                "action": "alert",
                                "WebSocketSecurity": {
                                  "rule-list": [
                                    {
                                      "seq": 1,
                                      "allow-plain-text": "enable",
                                      "block-extensions": "disable",
                                      "allowed-origin-list": [
                                        {
                                          "name": "1",
                                          "origin": "ore"
                                        }
                                      ],
                                      "name": "rule1",
                                      "enable-attack-signatures": "enable",
                                      "block-websocket-traffic": "enable",
                                      "url": "/test111111",
                                      "allow-binary-text": "enable"
                                    }
                                  ]
                                }
                              }
                            },
                            "required": true
                          }
                        ],
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        }
                      }
                    },
                    "/v1/application/{ep_id}/attack_logs": {
                      "get": {
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        },
                        "summary": "Get Attack Logs List",
                        "description": "Get Attack Logs List",
                        "operationId": "[[variables('_operationId-GetAttackLogsList')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "in": "path",
                            "required": true,
                            "type": "string",
                            "default": "{{ep_id}}"
                          },
                          {
                            "name": "size",
                            "in": "query",
                            "required": true,
                            "type": "string",
                            "default": "{{size}}"
                          },
                          {
                            "name": "page",
                            "in": "query",
                            "required": true,
                            "type": "string",
                            "default": "{{page}}"
                          },
                          {
                            "name": "filter",
                            "in": "query",
                            "required": true,
                            "type": "string",
                            "default": "{{filter}}"
                          },
                          {
                            "name": "Accept",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Accept"
                          }
                        ]
                      }
                    },
                    "/v1/application/{ep_id}/attack_logs/{msg_id}": {
                      "get": {
                        "responses": {
                          "default": {
                            "description": "default"
                          }
                        },
                        "summary": "Get Attack Log Detail",
                        "description": "Get Attack Log Detail",
                        "operationId": "[[variables('_operationId-GetAttackLogDetail')]",
                        "parameters": [
                          {
                            "name": "ep_id",
                            "in": "path",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "name": "msg_id",
                            "in": "path",
                            "required": true,
                            "type": "string"
                          },
                          {
                            "name": "Accept",
                            "in": "header",
                            "required": true,
                            "type": "string",
                            "default": "application/json",
                            "description": "Accept"
                          }
                        ]
                      }
                    }
                  },
                  "securityDefinitions": {
                    "API Key": {
                      "type": "apiKey",
                      "in": "header",
                      "name": "Authorization"
                    }
                  },
                  "security": [
                    {
                      "API Key": "[variables('TemplateEmptyArray')]"
                    }
                  ],
                  "tags": "[variables('TemplateEmptyArray')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[[concat(variables('workspace-name'),'/Microsoft.SecurityInsights/',concat('LogicAppsCustomConnector-', last(split(variables('playbookId1'),'/'))))]",
              "properties": {
                "parentId": "[[variables('playbookId1')]",
                "contentId": "[variables('_playbookContentId1')]",
                "kind": "LogicAppsCustomConnector",
                "version": "[variables('playbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId1')]",
        "contentKind": "LogicAppsCustomConnector",
        "displayName": "FortiWebCustomConnector",
        "contentProductId": "[variables('_playbookcontentProductId1')]",
        "id": "[variables('_playbookcontentProductId1')]",
        "version": "[variables('playbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "FortiWeb-BlockIP-URL Playbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion2')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "FortiWeb-BlockIP-URL",
              "type": "string"
            },
            "ep_id": {
              "type": "string",
              "metadata": {
                "description": "Enter value for ep_id"
              }
            },
            "CustomConnectorName": {
              "defaultValue": "FortiWebCloud",
              "type": "string",
              "metadata": {
                "description": "Name of the custom connector, if you want to change the default name, make sure to use the same in all FortiWebCloud automation playbooks as well"
              }
            }
          },
          "variables": {
            "FortiwebConnectionName": "[[concat('Fortiweb-', parameters('PlaybookName'))]",
            "MicrosoftSentinelConnectionName": "[[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('CustomConnectorName'))]",
            "_connection-2": "[[variables('connection-2')]",
            "connection-3": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuresentinel')]",
            "_connection-3": "[[variables('connection-3')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "provisioningState": "Succeeded",
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    },
                    "ep_id": {
                      "type": "string",
                      "defaultValue": "[[parameters('ep_id')]"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Condition": {
                      "actions": {
                        "Add_comment_(IP)_to_incident_(V3)": {
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p>Ip mentioned below has been blocked succesfully &nbsp;,<br>\n@{outputs('Creating_formatted_payload_')}</p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          },
                          "runAfter": {
                            "Update_IP_Protection": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection"
                        },
                        "Creating_formatted_payload_": {
                          "runAfter": {
                            "converting_array_to_string_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "Compose",
                          "inputs": [
                            {
                              "ip": "@body('converting_array_to_string_variable')",
                              "name": "99",
                              "type": "block-ip"
                            }
                          ]
                        },
                        "Ip_members_combined_payload": {
                          "runAfter": {
                            "Creating_formatted_payload_": [
                              "Succeeded"
                            ]
                          },
                          "type": "Compose",
                          "inputs": "@union(variables('oldipmembers'),outputs('Creating_formatted_payload_'))"
                        },
                        "Setting_value_of_OldGeoMembers_variable": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "OldGeoMembers",
                            "value": "@body('Get_IP_protection_2')?['result']?['IPProtection']?['geo-ip-block']?['members']"
                          }
                        },
                        "Setting_value_of_oldipmembers_variable": {
                          "runAfter": {
                            "Setting_value_of_OldGeoMembers_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "oldipmembers",
                            "value": "@body('Get_IP_protection_2')?['result']?['IPProtection']?['ip-list']?['members']"
                          }
                        },
                        "Update_IP_Protection": {
                          "runAfter": {
                            "Ip_members_combined_payload": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "IPProtection": {
                                "geo-ip-block": {
                                  "members": "@variables('OldGeoMembers')"
                                },
                                "ip-list": {
                                  "members": "@outputs('Ip_members_combined_payload')"
                                }
                              }
                            },
                            "headers": {
                              "Content-Type": "application/json"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['FortiWeb']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/v1/application/@{encodeURIComponent(parameters('ep_id'))}/ipprotection"
                          }
                        },
                        "converting_array_to_string_variable": {
                          "runAfter": {
                            "Setting_value_of_oldipmembers_variable": [
                              "Succeeded"
                            ]
                          },
                          "type": "Join",
                          "inputs": {
                            "from": "@variables('tempvariable')",
                            "joinWith": ","
                          }
                        }
                      },
                      "runAfter": {
                        "declaring_oldipmembers_variable": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(variables('tempvariable'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Condition_6": {
                      "actions": {
                        "Add_comment_(URL)_to_incident_(V3)_2": {
                          "inputs": {
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "message": "<p>URL's &nbsp;has been blocked succesfully .<br>\n</p>"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/Incidents/Comment"
                          },
                          "runAfter": {
                            "Update_URL_Access": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection"
                        },
                        "For_each_-_creating_payload": {
                          "foreach": "@variables('tempurl')",
                          "actions": {
                            "Append_to_array_variable_6": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "urlpayload",
                                "value": {
                                  "action": "alert_deny",
                                  "name": "@items('For_each_-_creating_payload')",
                                  "reg-exp": "@items('For_each_-_creating_payload')"
                                }
                              }
                            }
                          },
                          "type": "Foreach"
                        },
                        "Update_URL_Access": {
                          "runAfter": {
                            "combining_all_URL's_-_final_payload": [
                              "Succeeded"
                            ]
                          },
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "urlaccess": "@outputs('combining_all_URL''s_-_final_payload')"
                            },
                            "headers": {
                              "Content-Type": "application/json"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['FortiWeb']['connectionId']"
                              }
                            },
                            "method": "put",
                            "path": "/v1/application/@{encodeURIComponent(parameters('ep_id'))}/urlaccess"
                          }
                        },
                        "combining_all_URL's_-_final_payload": {
                          "runAfter": {
                            "For_each_-_creating_payload": [
                              "Succeeded"
                            ]
                          },
                          "type": "Compose",
                          "inputs": "@union(variables('urlpayload'),body('Get_URL_Access')?['result']?['urlaccess'])"
                        }
                      },
                      "runAfter": {
                        "For_each_-_filtering_URL's": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "and": [
                          {
                            "greater": [
                              "@length(variables('tempurl'))",
                              0
                            ]
                          }
                        ]
                      },
                      "type": "If"
                    },
                    "Declaring_NewURL_variable": {
                      "runAfter": {
                        "Declaring_newIp_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "newurl",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Declaring_newIp_variable": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "newIp",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Declaring_oldblockip_variable": {
                      "runAfter": {
                        "Declaring_NewURL_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "oldblockip",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "For_each_-_filtering_IP's": {
                      "foreach": "@variables('newIp')",
                      "actions": {
                        "Condition_3": {
                          "actions": {
                            "Append_to_array_variable_2": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "tempvariable",
                                "value": "@items('For_each_-_filtering_IP''s')"
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "not": {
                                  "contains": [
                                    "@body('Join')",
                                    "@items('For_each_-_filtering_IP''s')"
                                  ]
                                }
                              }
                            ]
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Join": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "For_each_-_filtering_URL's": {
                      "foreach": "@variables('newurl')",
                      "actions": {
                        "Condition_5": {
                          "actions": {
                            "Append_to_array_variable_5": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "tempurl",
                                "value": "@items('For_each_-_filtering_URL''s')"
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "not": {
                                  "contains": [
                                    "@variables('oldurl')",
                                    "@items('For_each_-_filtering_URL''s')"
                                  ]
                                }
                              }
                            ]
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "For_each_-get_all_old_URL_blocked": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "For_each_-_get_all_new_blocking_ip's": {
                      "foreach": "@body('Parse_JSON')",
                      "actions": {
                        "Switch": {
                          "cases": {
                            "Case": {
                              "case": "Ip",
                              "actions": {
                                "create_array_of_IP's_-_blocking": {
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "newIp",
                                    "value": "@items('For_each_-_get_all_new_blocking_ip''s')?['properties']?['address']"
                                  }
                                }
                              }
                            }
                          },
                          "expression": "@items('For_each_-_get_all_new_blocking_ip''s')['kind']",
                          "type": "Switch"
                        }
                      },
                      "runAfter": {
                        "Parse_JSON": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "For_each_-_get_all_new_blocking_url's": {
                      "foreach": "@body('Parse_JSON')",
                      "actions": {
                        "Switch_2": {
                          "cases": {
                            "Case": {
                              "case": "Url",
                              "actions": {
                                "Append_to_array_variable_3": {
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "newurl",
                                    "value": "@items('For_each_-_get_all_new_blocking_url''s')?['properties']?['friendlyName']"
                                  }
                                }
                              }
                            }
                          },
                          "expression": "@items('For_each_-_get_all_new_blocking_url''s')['kind']",
                          "type": "Switch"
                        }
                      },
                      "runAfter": {
                        "Parse_JSON": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "For_each_-get_all_old_URL_blocked": {
                      "foreach": "@body('Get_URL_Access')?['result']?['urlaccess']",
                      "actions": {
                        "Condition_4": {
                          "actions": {
                            "Append_to_array_variable_4": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "oldurl",
                                "value": "@items('For_each_-get_all_old_URL_blocked')?['reg-exp']"
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "contains": [
                                  "@items('For_each_-get_all_old_URL_blocked')?['action']",
                                  "deny"
                                ]
                              }
                            ]
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Get_URL_Access": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Get_IP_protection_2": {
                      "runAfter": {
                        "For_each_-_get_all_new_blocking_ip's": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['FortiWeb']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/v1/application/@{encodeURIComponent(parameters('ep_id'))}/ipprotection"
                      }
                    },
                    "Get_URL_Access": {
                      "runAfter": {
                        "For_each_-_get_all_new_blocking_url's": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "headers": {
                          "Content-Type": "application/json"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['FortiWeb']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/v1/application/@{encodeURIComponent(parameters('ep_id'))}/urlaccess"
                      }
                    },
                    "Get_all_old_blocking_ip's": {
                      "foreach": "@body('Get_IP_protection_2')?['result']?['IPProtection']?['ip-list']?['members']",
                      "actions": {
                        "Condition_2": {
                          "actions": {
                            "Append_to_array_variable": {
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "oldblockip",
                                "value": "@items('Get_all_old_blocking_ip''s')?['ip']"
                              }
                            },
                            "Compose": {
                              "runAfter": {
                                "Append_to_array_variable": [
                                  "Succeeded"
                                ]
                              },
                              "type": "Compose",
                              "inputs": "@variables('oldblockip')"
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "equals": [
                                  "@items('Get_all_old_blocking_ip''s')?['type']",
                                  "block-ip"
                                ]
                              }
                            ]
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Get_IP_protection_2": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Initialize_variable": {
                      "runAfter": {
                        "declaring_oldURL_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "tempvariable",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "Join": {
                      "runAfter": {
                        "Get_all_old_blocking_ip's": [
                          "Succeeded"
                        ]
                      },
                      "type": "Join",
                      "inputs": {
                        "from": "@variables('oldblockip')",
                        "joinWith": ","
                      }
                    },
                    "Parse_JSON": {
                      "runAfter": {
                        "declaring_url_payload": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "schema": {
                          "items": {
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "kind": {
                                "type": "string"
                              },
                              "properties": {
                                "properties": {
                                  "address": {
                                    "type": "string"
                                  },
                                  "friendlyName": {
                                    "type": "string"
                                  }
                                },
                                "type": "object"
                              },
                              "type": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "type",
                              "kind",
                              "properties"
                            ],
                            "type": "object"
                          },
                          "type": "array"
                        }
                      }
                    },
                    "declaring_OldGeoMembers_variable": {
                      "runAfter": {
                        "For_each_-_filtering_IP's": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "OldGeoMembers",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "declaring_oldURL_variable": {
                      "runAfter": {
                        "Declaring_oldblockip_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "oldurl",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "declaring_oldipmembers_variable": {
                      "runAfter": {
                        "declaring_OldGeoMembers_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "oldipmembers",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "declaring_url_payload": {
                      "runAfter": {
                        "initializing_temp_url_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "urlpayload",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "initializing_temp_url_variable": {
                      "runAfter": {
                        "Initialize_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "tempurl",
                            "type": "array"
                          }
                        ]
                      }
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "FortiWeb": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('FortiwebConnectionName'))]",
                        "connectionName": "[[variables('FortiwebConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('CustomConnectorName'))]"
                      },
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                        "connectionName": "[[variables('MicrosoftSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "name": "[[parameters('PlaybookName')]",
              "type": "Microsoft.Logic/workflows",
              "location": "[[variables('workspace-location-inline')]",
              "identity": {
                "type": "SystemAssigned"
              },
              "tags": {
                "hidden-SentinelTemplateName": "testfortiwebsoar",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "apiVersion": "2017-07-01",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('FortiwebConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]"
              ]
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('FortiwebConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('FortiwebConnectionName')]",
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('MicrosoftSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('MicrosoftSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-3')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId2'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId2')]",
                "contentId": "[variables('_playbookContentId2')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "kind": "LogicAppsCustomConnector",
                      "contentId": "[variables('_FortiWebCustomConnector')]",
                      "version": "[variables('playbookVersion1')]"
                    }
                  ]
                }
              }
            }
          ],
          "metadata": {
            "title": "Block IP & URL on fortiweb cloud",
            "description": "This Playbook Provides the automation on blocking the suspicious/malicious IP and URL on fortiweb cloud waf",
            "prerequisites": [
              "1. FortiwebCloud Custom Connector needs to be deployed prior to the deployment of this playbook under the same subscription.",
              "2. API key. To get API Key, login into your FortiWeb cloud instance dashboard and navigate to Global --> system settings --> API Key."
            ],
            "postDeployment": [
              "1. Once deployment is complete, you will need to authorize each connection.",
              "2. Navigate to playbook --> API Connections --> Select connections one by one --> Edit API Connection --> (if required) Enter API key or credentials --> Save"
            ],
            "lastUpdateTime": "2022-08-18T00:00:00Z",
            "entities": [
              "ip",
              "url"
            ],
            "tags": [
              "Enrichment",
              "Fortiweb",
              "WAF",
              "Cloud WAF",
              "Block IP",
              "Block URL"
            ],
            "releaseNotes": {
              "version": "1.0",
              "title": "[variables('blanks')]",
              "notes": [
                "Initial version"
              ]
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId2')]",
        "contentKind": "Playbook",
        "displayName": "FortiWeb-BlockIP-URL",
        "contentProductId": "[variables('_playbookcontentProductId2')]",
        "id": "[variables('_playbookcontentProductId2')]",
        "version": "[variables('playbookVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "FortiWeb-enrichment Playbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion3')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "FortiWeb-enrichment",
              "type": "string",
              "metadata": {
                "description": "Name of the Playbook"
              }
            },
            "ep_id": {
              "type": "string",
              "metadata": {
                "description": "Enter value for ep_id"
              }
            },
            "CustomConnectorName": {
              "defaultValue": "FortiWebCloud",
              "type": "string",
              "metadata": {
                "description": "Name of the custom connector, if you want to change the default name, make sure to use the same in all FortiWebCloud automation playbooks as well"
              }
            }
          },
          "variables": {
            "FortiwebConnectionName": "[[concat('Fortiweb-', parameters('PlaybookName'))]",
            "MicrosoftSentinelConnectionName": "[[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('CustomConnectorName'))]",
            "_connection-2": "[[variables('connection-2')]",
            "connection-3": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuresentinel')]",
            "_connection-3": "[[variables('connection-3')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "provisioningState": "Succeeded",
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    },
                    "ep_id": {
                      "type": "string",
                      "defaultValue": "[[parameters('ep_id')]"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "Add_comment_to_incident_(V3)": {
                      "runAfter": {
                        "Create_HTML_table": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "body": {
                          "incidentArmId": "@triggerBody()?['object']?['id']",
                          "message": "<p>@{body('Create_HTML_table')}</p>"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/Incidents/Comment"
                      }
                    },
                    "Create_HTML_table": {
                      "runAfter": {
                        "For_each": [
                          "Succeeded"
                        ]
                      },
                      "type": "Table",
                      "inputs": {
                        "format": "HTML",
                        "from": "@variables('result')"
                      }
                    },
                    "Declaring_variable_for_storing_information": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "result",
                            "type": "array"
                          }
                        ]
                      }
                    },
                    "For_each": {
                      "foreach": "@body('Parse_JSON_2')",
                      "actions": {
                        "Condition": {
                          "actions": {
                            "For_each_2": {
                              "foreach": "@body('Parsing_attack_logs')?['hits']",
                              "actions": {
                                "Append_to_array_variable": {
                                  "runAfter": {
                                    "Parse_attack_log_details": [
                                      "Succeeded"
                                    ]
                                  },
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "result",
                                    "value": {
                                      "app_name": "@body('Parse_attack_log_details')?['app_name']",
                                      "country_flag": "@body('Parse_attack_log_details')?['country_flag']",
                                      "dst_port": "@body('Parse_attack_log_details')?['dst_port']",
                                      "es_region": "@body('Parse_attack_log_details')?['es_region']",
                                      "fwb_ip": "@body('Parse_attack_log_details')?['fwb_ip']",
                                      "fwb_region": "@body('Parse_attack_log_details')?['fwb_region']",
                                      "http_host": "@body('Parse_attack_log_details')?['http_host']",
                                      "login_user": "@body('Parse_attack_log_details')?['login_user']",
                                      "msg": "@body('Parse_attack_log_details')?['msg']",
                                      "signature_id": "@body('Parse_attack_log_details')?['signature_id']",
                                      "src_ip": "@body('Parse_attack_log_details')?['src_ip']",
                                      "src_port": "@body('Parse_attack_log_details')?['src_port']",
                                      "threat_level": "@body('Parse_attack_log_details')?['threat_level']",
                                      "timestamp": "@body('Parse_attack_log_details')?['timestamp']",
                                      "user_id": "@body('Parse_attack_log_details')?['user_id']",
                                      "user_name": "@body('Parse_attack_log_details')?['user_name']"
                                    }
                                  }
                                },
                                "Get_Attack_Log_Detail": {
                                  "type": "ApiConnection",
                                  "inputs": {
                                    "headers": {
                                      "Accept": "application/json"
                                    },
                                    "host": {
                                      "connection": {
                                        "name": "@parameters('$connections')['FortiWeb']['connectionId']"
                                      }
                                    },
                                    "method": "get",
                                    "path": "/v1/application/@{encodeURIComponent(parameters('ep_id'))}/attack_logs/@{encodeURIComponent(items('For_each_2')?['msg_id'])}"
                                  }
                                },
                                "Parse_attack_log_details": {
                                  "runAfter": {
                                    "Get_Attack_Log_Detail": [
                                      "Succeeded"
                                    ]
                                  },
                                  "type": "ParseJson",
                                  "inputs": {
                                    "content": "@body('Get_Attack_Log_Detail')",
                                    "schema": {
                                      "properties": {
                                        "action": {
                                          "type": "string"
                                        },
                                        "app_name": {
                                          "type": "string"
                                        },
                                        "backend_service": {
                                          "type": "string"
                                        },
                                        "bot_info": {
                                          "type": "string"
                                        },
                                        "cluster_id": {
                                          "type": "integer"
                                        },
                                        "country_flag": {
                                          "type": "string"
                                        },
                                        "date_time": {
                                          "type": "string"
                                        },
                                        "dst_port": {
                                          "type": "string"
                                        },
                                        "ep_domain": {
                                          "type": "string"
                                        },
                                        "ep_id": {
                                          "type": "string"
                                        },
                                        "es_region": {
                                          "type": "string"
                                        },
                                        "fwb_ip": {
                                          "type": "string"
                                        },
                                        "fwb_platform": {
                                          "type": "string"
                                        },
                                        "fwb_region": {
                                          "type": "string"
                                        },
                                        "http_agent": {
                                          "type": "string"
                                        },
                                        "http_host": {
                                          "type": "string"
                                        },
                                        "http_method": {
                                          "type": "string"
                                        },
                                        "http_refer": {
                                          "type": "string"
                                        },
                                        "http_url": {
                                          "type": "string"
                                        },
                                        "http_version": {
                                          "type": "string"
                                        },
                                        "instance_id": {
                                          "type": "string"
                                        },
                                        "length": {
                                          "type": "integer"
                                        },
                                        "log_id": {
                                          "type": "string"
                                        },
                                        "login_user": {
                                          "type": "string"
                                        },
                                        "main_type": {
                                          "type": "string"
                                        },
                                        "ml_log_arglen": {
                                          "type": "string"
                                        },
                                        "ml_log_hmm_probability": {
                                          "type": "string"
                                        },
                                        "ml_log_sample_arglen_mean": {
                                          "type": "string"
                                        },
                                        "ml_log_sample_prob_mean": {
                                          "type": "string"
                                        },
                                        "ml_svm_accuracy": {
                                          "type": "string"
                                        },
                                        "ml_svm_log_main_types": {
                                          "type": "string"
                                        },
                                        "msg": {
                                          "type": "string"
                                        },
                                        "msg_id": {
                                          "type": "string"
                                        },
                                        "owasp_top10": {
                                          "type": "string"
                                        },
                                        "packet": {
                                          "properties": {
                                            "args": {
                                              "type": "array"
                                            },
                                            "cookies": {
                                              "items": {
                                                "properties": {
                                                  "key": {
                                                    "type": "string"
                                                  },
                                                  "value": {
                                                    "type": "string"
                                                  }
                                                },
                                                "required": [
                                                  "value",
                                                  "key"
                                                ],
                                                "type": "object"
                                              },
                                              "type": "array"
                                            },
                                            "files": {
                                              "type": "array"
                                            },
                                            "head": {
                                              "properties": {
                                                "Accept-Encoding:": {
                                                  "type": "string"
                                                },
                                                "Accept-Language:": {
                                                  "type": "string"
                                                },
                                                "Accept:": {
                                                  "type": "string"
                                                },
                                                "Connection:": {
                                                  "type": "string"
                                                },
                                                "Cookie:": {
                                                  "type": "string"
                                                },
                                                "GET ": {
                                                  "type": "string"
                                                },
                                                "Host:": {
                                                  "type": "string"
                                                },
                                                "If-Modified-Since:": {
                                                  "type": "string"
                                                },
                                                "Sec-Fetch-Dest:": {
                                                  "type": "string"
                                                },
                                                "Sec-Fetch-Mode:": {
                                                  "type": "string"
                                                },
                                                "Sec-Fetch-Site:": {
                                                  "type": "string"
                                                },
                                                "Sec-Fetch-User:": {
                                                  "type": "string"
                                                },
                                                "Upgrade-Insecure-Requests:": {
                                                  "type": "string"
                                                },
                                                "User-Agent:": {
                                                  "type": "string"
                                                },
                                                "sec-ch-ua-mobile:": {
                                                  "type": "string"
                                                },
                                                "sec-ch-ua-platform:": {
                                                  "type": "string"
                                                },
                                                "sec-ch-ua:": {
                                                  "type": "string"
                                                }
                                              },
                                              "type": "object"
                                            },
                                            "match_info": {
                                              "type": "string"
                                            }
                                          },
                                          "type": "object"
                                        },
                                        "policy_name": {
                                          "type": "string"
                                        },
                                        "service": {
                                          "type": "string"
                                        },
                                        "signature_cve_id": {
                                          "type": "string"
                                        },
                                        "signature_id": {
                                          "type": "string"
                                        },
                                        "src_ip": {
                                          "type": "string"
                                        },
                                        "src_port": {
                                          "type": "string"
                                        },
                                        "srccountry": {
                                          "type": "string"
                                        },
                                        "sub_type": {
                                          "type": "string"
                                        },
                                        "threat_level": {
                                          "type": "string"
                                        },
                                        "threat_weight": {
                                          "type": "string"
                                        },
                                        "timestamp": {
                                          "type": "string"
                                        },
                                        "user_id": {
                                          "type": "string"
                                        },
                                        "user_name": {
                                          "type": "string"
                                        }
                                      },
                                      "type": "object"
                                    }
                                  }
                                }
                              },
                              "runAfter": {
                                "Parsing_attack_logs": [
                                  "Succeeded"
                                ]
                              },
                              "type": "Foreach"
                            },
                            "Get_Attack_Logs_List": {
                              "type": "ApiConnection",
                              "inputs": {
                                "headers": {
                                  "Accept": "application/json"
                                },
                                "host": {
                                  "connection": {
                                    "name": "@parameters('$connections')['FortiWeb']['connectionId']"
                                  }
                                },
                                "method": "get",
                                "path": "/v1/application/@{encodeURIComponent(parameters('ep_id'))}/attack_logs",
                                "queries": {
                                  "filter": [
                                    {
                                      "id": "src_ip",
                                      "logic": {
                                        "is": {
                                          "string": true
                                        },
                                        "search": "string"
                                      },
                                      "value": [
                                        "@{items('For_each')?['properties']?['address']}"
                                      ]
                                    }
                                  ],
                                  "page": "1",
                                  "size": "20"
                                }
                              }
                            },
                            "Parsing_attack_logs": {
                              "runAfter": {
                                "Get_Attack_Logs_List": [
                                  "Succeeded"
                                ]
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@body('Get_Attack_Logs_List')",
                                "schema": {
                                  "properties": {
                                    "hits": {
                                      "items": {
                                        "properties": {
                                          "_id": {
                                            "type": "string"
                                          },
                                          "action": {
                                            "type": "string"
                                          },
                                          "country_flag": {
                                            "type": "string"
                                          },
                                          "date_time": {
                                            "type": "string"
                                          },
                                          "fwb_ip": {
                                            "type": "string"
                                          },
                                          "http_url": {
                                            "type": "string"
                                          },
                                          "msg": {
                                            "type": "string"
                                          },
                                          "msg_id": {
                                            "type": "string"
                                          },
                                          "src_ip": {
                                            "type": "string"
                                          },
                                          "threat_level": {
                                            "type": "string"
                                          }
                                        },
                                        "required": [
                                          "msg",
                                          "src_ip",
                                          "threat_level",
                                          "date_time",
                                          "action",
                                          "msg_id",
                                          "fwb_ip",
                                          "country_flag",
                                          "http_url",
                                          "_id"
                                        ],
                                        "type": "object"
                                      },
                                      "type": "array"
                                    },
                                    "total": {
                                      "type": "integer"
                                    }
                                  },
                                  "type": "object"
                                }
                              }
                            }
                          },
                          "expression": {
                            "and": [
                              {
                                "equals": [
                                  "@items('For_each')['kind']",
                                  "Ip"
                                ]
                              }
                            ]
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Parse_JSON_2": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Parse_JSON_2": {
                      "runAfter": {
                        "Declaring_variable_for_storing_information": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "schema": {
                          "items": {
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "kind": {
                                "type": "string"
                              },
                              "properties": {
                                "properties": {
                                  "address": {
                                    "type": "string"
                                  },
                                  "friendlyName": {
                                    "type": "string"
                                  }
                                },
                                "type": "object"
                              },
                              "type": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "type",
                              "kind",
                              "properties"
                            ],
                            "type": "object"
                          },
                          "type": "array"
                        }
                      }
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "FortiWeb": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('FortiwebConnectionName'))]",
                        "connectionName": "[[variables('FortiwebConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Web/customApis/', parameters('CustomConnectorName'))]"
                      },
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                        "connectionName": "[[variables('MicrosoftSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "name": "[[parameters('PlaybookName')]",
              "type": "Microsoft.Logic/workflows",
              "location": "[[variables('workspace-location-inline')]",
              "identity": {
                "type": "SystemAssigned"
              },
              "tags": {
                "hidden-SentinelTemplateName": "FortiWeb-encrichment",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "apiVersion": "2017-07-01",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('FortiwebConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]"
              ]
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('FortiwebConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('FortiwebConnectionName')]",
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('MicrosoftSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('MicrosoftSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-3')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId3'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId3')]",
                "contentId": "[variables('_playbookContentId3')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "kind": "LogicAppsCustomConnector",
                      "contentId": "[variables('_FortiWebCustomConnector')]",
                      "version": "[variables('playbookVersion1')]"
                    }
                  ]
                }
              }
            }
          ],
          "metadata": {
            "title": "Fetch Threat Intel from fortiwebcloud",
            "description": "This playbook provides/updates the threat intel and essential details in comments section of triggered incident so that SOC analysts can directly take corrective measure to stop the attack",
            "prerequisites": [
              "1. FortiwebCloud Custom Connector needs to be deployed prior to the deployment of this playbook under the same subscription.",
              "2. API key. To get API Key, login into your FortiWeb cloud instance dashboard and navigate to Global --> system settings --> API Key."
            ],
            "postDeployment": [
              "1. Once deployment is complete, you will need to authorize each connection.",
              "2. Navigate to playbook --> API Connections --> Select connections one by one --> Edit API Connection --> (if required) Enter API key or credentials --> Save"
            ],
            "lastUpdateTime": "2022-07-21T00:00:00Z",
            "entities": [
              "ip",
              "url"
            ],
            "tags": [
              "Enrichment",
              "Notification",
              "ThreatIntelligence",
              "FortiwebCloud",
              "WAF"
            ],
            "releaseNotes": {
              "version": "1.0",
              "title": "[variables('blanks')]",
              "notes": [
                "Initial version"
              ]
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId3')]",
        "contentKind": "Playbook",
        "displayName": "FortiWeb-enrichment",
        "contentProductId": "[variables('_playbookcontentProductId3')]",
        "id": "[variables('_playbookcontentProductId3')]",
        "version": "[variables('playbookVersion3')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Fortinet FortiWeb Web Application Firewall",
                  "publisher": "Microsoft",
                  "descriptionMarkdown": "The [fortiweb](https://www.fortinet.com/products/web-application-firewall/fortiweb) data connector provides the capability to ingest Threat Analytics and events into Microsoft Sentinel.",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "FortiWeb",
                      "baseQuery": "Fortiweb"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Top 10 Threats",
                      "query": "Fortiweb\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CommonSecurityLog (Fortiweb)",
                      "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct == \"Fortiweb\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "CommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct == \"Fortiweb\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "read": true,
                          "write": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
                      "innerSteps": [
                        {
                          "title": "1.1 Select or create a Linux machine",
                          "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
                        },
                        {
                          "title": "1.2 Install the CEF collector on the Linux machine",
                          "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                          "instructions": [
                            {
                              "parameters": {
                                "fillWith": [
                                  "WorkspaceId",
                                  "PrimaryKey"
                                ],
                                "label": "Run the following command to install and apply the CEF collector:",
                                "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                              },
                              "type": "CopyableLabel"
                            }
                          ]
                        }
                      ],
                      "title": "1. Linux Syslog agent configuration"
                    },
                    {
                      "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.",
                      "title": "2. Forward Common Event Format (CEF) logs to Syslog agent"
                    },
                    {
                      "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Run the following command to validate your connectivity:",
                            "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                          },
                          "type": "CopyableLabel"
                        }
                      ],
                      "title": "3. Validate connection"
                    },
                    {
                      "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
                      "title": "4. Secure your machine "
                    }
                  ],
                  "metadata": {
                    "id": "6rcd2f13-ret9-46a7-8c6e-aa5d86b8f1g9",
                    "version": "1.0.0",
                    "kind": "dataConnector",
                    "source": {
                      "kind": "solution"
                    },
                    "author": {
                      "name": "Microsoft"
                    },
                    "support": {
                      "tier": "developer",
                      "name": "Microsoft"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "Fortinet FortiWeb Web Application Firewall",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "tier": "Microsoft",
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "link": "https://support.microsoft.com/"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Fortinet FortiWeb Web Application Firewall",
          "publisher": "Microsoft",
          "descriptionMarkdown": "The [fortiweb](https://www.fortinet.com/products/web-application-firewall/fortiweb) data connector provides the capability to ingest Threat Analytics and events into Microsoft Sentinel.",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "FortiWeb",
              "baseQuery": "Fortiweb"
            }
          ],
          "dataTypes": [
            {
              "name": "CommonSecurityLog (Fortiweb)",
              "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct == \"Fortiweb\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "CommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct == \"Fortiweb\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Top 10 Threats",
              "query": "Fortiweb\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "read": true,
                  "write": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
              "innerSteps": [
                {
                  "title": "1.1 Select or create a Linux machine",
                  "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
                },
                {
                  "title": "1.2 Install the CEF collector on the Linux machine",
                  "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                  "instructions": [
                    {
                      "parameters": {
                        "fillWith": [
                          "WorkspaceId",
                          "PrimaryKey"
                        ],
                        "label": "Run the following command to install and apply the CEF collector:",
                        "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ],
              "title": "1. Linux Syslog agent configuration"
            },
            {
              "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.",
              "title": "2. Forward Common Event Format (CEF) logs to Syslog agent"
            },
            {
              "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Run the following command to validate your connectivity:",
                    "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                  },
                  "type": "CopyableLabel"
                }
              ],
              "title": "3. Validate connection"
            },
            {
              "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
              "title": "4. Secure your machine "
            }
          ],
          "id": "[variables('_uiConfigId1')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Fortiweb Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('_parserName1')]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Fortiweb",
                "category": "Samples",
                "functionAlias": "Fortiweb",
                "query": "\nCommonSecurityLog\r\n| project-away EventType\r\n| where DeviceVendor =~ 'Fortinet' and DeviceProduct has 'Fortiweb'\r\n| extend EventVendor = 'Fortinet'\r\n| extend EventProduct = 'Fortiweb'\r\n| extend EventSchemaVersion = 0.2\r\n| extend EventCount = 1\r\n| extend DeviceCustomNumber1 = coalesce(column_ifexists(\"FieldDeviceCustomNumber1\", long(null)),DeviceCustomNumber1),\r\n         DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)),DeviceCustomNumber2),\r\n         DeviceCustomNumber3 = coalesce(column_ifexists(\"FieldDeviceCustomNumber3\", long(null)),DeviceCustomNumber3),\r\n         ExternalID = coalesce(column_ifexists(\"ExtID\", \"\"),tostring(ExternalID))\r\n| extend Threatweight = iff(DeviceCustomNumber1Label =~ \"threatWeight\",DeviceCustomNumber1,long(null))\r\n         ,Length = iff(DeviceCustomNumber2Label =~ \"length\",DeviceCustomNumber2,long(null))\r\n         ,SignatureID = iff(DeviceCustomNumber3Label =~ \"signatureID\",DeviceCustomNumber3,long(null))\r\n         ,AppName = iff(DeviceCustomString1Label =~ \"appName\",DeviceCustomString1,'')\r\n         ,srcCountry = iff(DeviceCustomString2Label =~ \"srcCountry\",DeviceCustomString2,'')\r\n         ,mainType = iff(DeviceCustomString3Label =~ \"mainType\",DeviceCustomString3,'')\r\n         ,subType = iff(DeviceCustomString4Label =~ \"subType\",DeviceCustomString4,'')\r\n         ,ThreatLevel = iff(DeviceCustomString5Label =~ \"threatLevel\",DeviceCustomString5,'')\r\n         ,owaspTop10 = iff(DeviceCustomString6Label =~ \"owaspTop10\",DeviceCustomString6,'')\r\n| parse-kv AdditionalExtensions as (cat:string) with (pair_delimiter=';', kv_delimiter='=')\r\n| extend EventEndTime = todatetime(ReceiptTime),\r\n         EventType = coalesce(column_ifexists(\"DeviceEventCategory\", \"\"),cat)\r\n| project-rename EventProductVersion=DeviceVersion\r\n                , EventOriginalType=DeviceEventClassID\r\n                , EventSeverity=LogSeverity\r\n                , EventMessage=Message\r\n                , DstPortNumber=DestinationPort\r\n                , DstIpAddr=DestinationIP\r\n                , DstDvcHostname=DestinationHostName\r\n                , DstUserName=DestinationUserName\r\n                , DvcIpAddr=DeviceAddress\r\n                , DvcAction=DeviceAction\r\n                , DvcHostname=DeviceName\r\n                , DstMacAddr=DestinationMACAddress\r\n                , NetworkApplicationProtocol=Protocol\r\n                , SrcPortNumber=SourcePort\r\n                , SrcIpAddr=SourceIP\r\n                , SrcMacAddr=SourceMACAddress\r\n                , EventId=ExternalID\r\n                , SrcDvcHostname=SourceHostName\r\n                , EventSubType=Activity\r\n| project-away AdditionalExtensions\r\n            , ReceiptTime\r\n            , cat\r\n            , Device*",
                "functionParameters": "",
                "version": 1,
                "tags": [
                  {
                    "name": "description",
                    "value": "Fortiweb"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('_parserId1'),'/'))))]",
              "dependsOn": [
                "[variables('_parserName1')]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
                "contentId": "[variables('_parserContentId1')]",
                "kind": "Parser",
                "version": "[variables('parserVersion1')]",
                "source": {
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_parserContentId1')]",
        "contentKind": "Parser",
        "displayName": "Fortiweb",
        "contentProductId": "[variables('_parsercontentProductId1')]",
        "id": "[variables('_parsercontentProductId1')]",
        "version": "[variables('parserVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('_parserName1')]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Fortiweb",
        "category": "Samples",
        "functionAlias": "Fortiweb",
        "query": "\nCommonSecurityLog\r\n| project-away EventType\r\n| where DeviceVendor =~ 'Fortinet' and DeviceProduct has 'Fortiweb'\r\n| extend EventVendor = 'Fortinet'\r\n| extend EventProduct = 'Fortiweb'\r\n| extend EventSchemaVersion = 0.2\r\n| extend EventCount = 1\r\n| extend DeviceCustomNumber1 = coalesce(column_ifexists(\"FieldDeviceCustomNumber1\", long(null)),DeviceCustomNumber1),\r\n         DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)),DeviceCustomNumber2),\r\n         DeviceCustomNumber3 = coalesce(column_ifexists(\"FieldDeviceCustomNumber3\", long(null)),DeviceCustomNumber3),\r\n         ExternalID = coalesce(column_ifexists(\"ExtID\", \"\"),tostring(ExternalID))\r\n| extend Threatweight = iff(DeviceCustomNumber1Label =~ \"threatWeight\",DeviceCustomNumber1,long(null))\r\n         ,Length = iff(DeviceCustomNumber2Label =~ \"length\",DeviceCustomNumber2,long(null))\r\n         ,SignatureID = iff(DeviceCustomNumber3Label =~ \"signatureID\",DeviceCustomNumber3,long(null))\r\n         ,AppName = iff(DeviceCustomString1Label =~ \"appName\",DeviceCustomString1,'')\r\n         ,srcCountry = iff(DeviceCustomString2Label =~ \"srcCountry\",DeviceCustomString2,'')\r\n         ,mainType = iff(DeviceCustomString3Label =~ \"mainType\",DeviceCustomString3,'')\r\n         ,subType = iff(DeviceCustomString4Label =~ \"subType\",DeviceCustomString4,'')\r\n         ,ThreatLevel = iff(DeviceCustomString5Label =~ \"threatLevel\",DeviceCustomString5,'')\r\n         ,owaspTop10 = iff(DeviceCustomString6Label =~ \"owaspTop10\",DeviceCustomString6,'')\r\n| parse-kv AdditionalExtensions as (cat:string) with (pair_delimiter=';', kv_delimiter='=')\r\n| extend EventEndTime = todatetime(ReceiptTime),\r\n         EventType = coalesce(column_ifexists(\"DeviceEventCategory\", \"\"),cat)\r\n| project-rename EventProductVersion=DeviceVersion\r\n                , EventOriginalType=DeviceEventClassID\r\n                , EventSeverity=LogSeverity\r\n                , EventMessage=Message\r\n                , DstPortNumber=DestinationPort\r\n                , DstIpAddr=DestinationIP\r\n                , DstDvcHostname=DestinationHostName\r\n                , DstUserName=DestinationUserName\r\n                , DvcIpAddr=DeviceAddress\r\n                , DvcAction=DeviceAction\r\n                , DvcHostname=DeviceName\r\n                , DstMacAddr=DestinationMACAddress\r\n                , NetworkApplicationProtocol=Protocol\r\n                , SrcPortNumber=SourcePort\r\n                , SrcIpAddr=SourceIP\r\n                , SrcMacAddr=SourceMACAddress\r\n                , EventId=ExternalID\r\n                , SrcDvcHostname=SourceHostName\r\n                , EventSubType=Activity\r\n| project-away AdditionalExtensions\r\n            , ReceiptTime\r\n            , cat\r\n            , Device*",
        "functionParameters": "",
        "version": 1,
        "tags": [
          {
            "name": "description",
            "value": "Fortiweb"
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('_parserId1'),'/'))))]",
      "dependsOn": [
        "[variables('_parserId1')]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), variables('parserName1'))]",
        "contentId": "[variables('_parserContentId1')]",
        "kind": "Parser",
        "version": "[variables('parserVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "tier": "Microsoft",
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "link": "https://support.microsoft.com/"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Fortiweb - WAF Allowed threat_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRulecontentId1')]",
              "apiVersion": "2022-04-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Detects WAF \"Allowed\" action on threat events.",
                "displayName": "Fortiweb - WAF Allowed threat",
                "enabled": false,
                "query": "Fortiweb\n| where EventType =~ 'Attack'\n| where DvcAction =~ 'Allow'\n| summarize count() by SrcIpAddr\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "FortiWeb",
                    "dataTypes": [
                      "Fortiweb"
                    ]
                  }
                ],
                "tactics": [
                  "InitialAccess"
                ],
                "techniques": [
                  "T1190",
                  "T1133"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "SrcIpAddr"
                      }
                    ],
                    "entityType": "IP"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleId1'),'/'))))]",
              "properties": {
                "description": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel Analytics Rule 1",
                "parentId": "[variables('analyticRuleId1')]",
                "contentId": "[variables('_analyticRulecontentId1')]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_analyticRulecontentId1')]",
        "contentKind": "AnalyticsRule",
        "displayName": "Fortiweb - WAF Allowed threat",
        "contentProductId": "[variables('_analyticRulecontentProductId1')]",
        "id": "[variables('_analyticRulecontentProductId1')]",
        "version": "[variables('analyticRuleVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('huntingQueryTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "owaspTop10-Threatsyaml_HuntingQueries Hunting Query with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('huntingQueryVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.OperationalInsights/savedSearches",
              "apiVersion": "2022-10-01",
              "name": "Fortinet_FortiWeb_Cloud_WAF-as-a-Service_connector_for_Microsoft_Sentinel_Hunting_Query_1",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Fortiweb - identify owasp10 vulnerabilities",
                "category": "Hunting Queries",
                "query": "let MinCount = 10;\nFortiweb\n| where TimeGenerated > ago(24h)\n| where isnotempty(owaspTop10)\n| summarize owaspCount=count() by owaspTop10,EventSubType , SrcIpAddr\n| where owaspCount > MinCount\n| extend IP_0_Address = SrcIpAddr\n",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": "Query searches threats and helps to identify threats matching owaspTop10 vulnerabilities."
                  },
                  {
                    "name": "tactics",
                    "value": "InitialAccess"
                  },
                  {
                    "name": "techniques",
                    "value": "T1190"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('HuntingQuery-', last(split(variables('huntingQueryId1'),'/'))))]",
              "properties": {
                "description": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel Hunting Query 1",
                "parentId": "[variables('huntingQueryId1')]",
                "contentId": "[variables('_huntingQuerycontentId1')]",
                "kind": "HuntingQuery",
                "version": "[variables('huntingQueryVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_huntingQuerycontentId1')]",
        "contentKind": "HuntingQuery",
        "displayName": "Fortiweb - identify owasp10 vulnerabilities",
        "contentProductId": "[variables('_huntingQuerycontentProductId1')]",
        "id": "[variables('_huntingQuerycontentProductId1')]",
        "version": "[variables('huntingQueryVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('huntingQueryTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Unexpected Countries_HuntingQueries Hunting Query with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('huntingQueryVersion2')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.OperationalInsights/savedSearches",
              "apiVersion": "2022-10-01",
              "name": "Fortinet_FortiWeb_Cloud_WAF-as-a-Service_connector_for_Microsoft_Sentinel_Hunting_Query_2",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Fortiweb - Unexpected countries",
                "category": "Hunting Queries",
                "query": "let blocked_country = dynamic(['countryname1', 'countryname2']);\nFortiweb\n| where srcCountry in (blocked_country)\n| where DvcAction !has 'Block'\n| summarize count() by SrcIpAddr\n| extend IP_0_Address = SrcIpAddr\n",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": "Query searches requests by country and helps to identify requests coming from unexpected countries."
                  },
                  {
                    "name": "tactics",
                    "value": "InitialAccess"
                  },
                  {
                    "name": "techniques",
                    "value": "T1190,T1133"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('HuntingQuery-', last(split(variables('huntingQueryId2'),'/'))))]",
              "properties": {
                "description": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel Hunting Query 2",
                "parentId": "[variables('huntingQueryId2')]",
                "contentId": "[variables('_huntingQuerycontentId2')]",
                "kind": "HuntingQuery",
                "version": "[variables('huntingQueryVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_huntingQuerycontentId2')]",
        "contentKind": "HuntingQuery",
        "displayName": "Fortiweb - Unexpected countries",
        "contentProductId": "[variables('_huntingQuerycontentProductId2')]",
        "id": "[variables('_huntingQuerycontentProductId2')]",
        "version": "[variables('huntingQueryVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Fortiweb-workbookWorkbook Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "This workbook depends on a parser based on a Kusto Function to work as expected [**Fortiweb**](https://aka.ms/sentinel-FortiwebDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"**NOTE**: This workbook depends on a parser based on a Kusto Function to work as expected [**Fortiweb**](https://aka.ms/sentinel-FortiwebDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.\"},\"name\":\"text - 0\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"2088f290-65ee-4357-badb-55ce732a5004\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Fortiweb Threats Overview\",\"subTarget\":\"Fortiweb_threat_overview\",\"style\":\"link\"}]},\"name\":\"links - 1\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"c64d5d3d-90c6-484a-ab88-c70652b75b6e\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":3628800000,\"endTime\":\"2022-12-13T17:55:00Z\"},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| summarize count() by EventSubType\",\"size\":0,\"title\":\"Attack Type\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"25\",\"name\":\"Attack Type\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where isnotempty(RequestClientApplication)\\n| summarize count() by RequestClientApplication \",\"size\":0,\"title\":\"Client Application\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"25\",\"name\":\"Client Application\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where isnotempty(RequestMethod)\\n| summarize count() by RequestMethod \",\"size\":0,\"title\":\"Request Methods\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"25\",\"name\":\"Request Methods\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where isnotempty(owaspTop10)\\n| summarize count() by owaspTop10 \",\"size\":0,\"title\":\"Owasp Top 10 - Vulnerabilities\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"25\",\"name\":\"owaspTop10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where EventType =~ \\\"attack\\\"\\n| summarize count() by ThreatLevel\",\"size\":0,\"title\":\"Threat Level\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"25\",\"name\":\"Threat Level\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where EventType == \\\"attack\\\"\\n| summarize count() by srcCountry\",\"size\":0,\"title\":\"Threat Source- Countries\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"25\",\"name\":\"Threat Source- Countries\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where EventType == \\\"attack\\\"\\n| summarize count() by SrcIpAddr\",\"size\":0,\"title\":\"Top Threat Client IPs\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"25\",\"name\":\"Top Threat Client IPs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where EventType =~ \\\"attack\\\"\\n| summarize count() by DvcAction\",\"size\":0,\"title\":\"Actions against Threats\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"25\",\"name\":\"Actions against Threats\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Fortiweb\\n| where EventType =~ \\\"attack\\\"\\n| project TimeGenerated, ThreatType = EventSubType,ThreatSubType = subType , ThreatSeverity = EventSeverity,Action = DvcAction, SourceIPAddress = SrcIpAddr, SourceCountry = srcCountry, ClientApplication = RequestClientApplication\\n| limit 200\",\"size\":0,\"title\":\"Top 200 Threat Details\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":200,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"title\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"100\",\"name\":\"Top 200 Threat Details\"}],\"fromTemplateId\":\"sentinel-FortiwebWorkbook\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=Fortiweb-workbook; logoFileName=Azure_Sentinel.svg; description=This workbook depends on a parser based on a Kusto Function to work as expected [**Fortiweb**](https://aka.ms/sentinel-FortiwebDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Fortiweb-workbook; templateRelativePath=Fortiweb-workbook.json; subtitle=; provider=Microsoft}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "tier": "Microsoft",
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "link": "https://support.microsoft.com/"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "CommonSecurityLog",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "FortinetFortiWeb",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.0",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
        "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
        "descriptionHtml": "<p><strong>Note:</strong> <em>There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</em></p>\n<p>The <a href=\"https://www.fortinet.com/products/web-application-firewall/fortiweb\">Fortinet FortiWeb Cloud</a> solution for Microsoft Sentinel provides an automated approach for SecOps analysts to remediate attacks at application level by blocking suspicious IP and URL and also empowers to gather threat intelligence data for malicious IP activity. By leveraging the FortiWeb API, the connector can automate these security operations, tasks using Sentinel Playbooks which can dramatically reduce the window that attackers can take advantage of.</p>\n<p>For questions about <a href=\"https://azuremarketplace.microsoft.com/en-us/marketplace/apps/fortinet.fortinet_waas?tab=Overview\">FortiWeb Cloud</a>, please contact Fortinet at <a href=\"mailto:azuresales@fortinet.com\">azuresales@fortinet.com</a>.</p>\n<p><strong>Data Connectors:</strong> 1, <strong>Parsers:</strong> 1, <strong>Workbooks:</strong> 1, <strong>Analytic Rules:</strong> 1, <strong>Hunting Queries:</strong> 2, <strong>Custom Azure Logic Apps Connectors:</strong> 1, <strong>Playbooks:</strong> 2</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Azure_Sentinel.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Fortinet FortiWeb Cloud WAF-as-a-Service connector for Microsoft Sentinel",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com/"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "LogicAppsCustomConnector",
              "contentId": "[variables('_FortiWebCustomConnector')]",
              "version": "[variables('playbookVersion1')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_FortiWeb-BlockIP-URL')]",
              "version": "[variables('playbookVersion2')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_FortiWeb-enrichment')]",
              "version": "[variables('playbookVersion3')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('_parserContentId1')]",
              "version": "[variables('parserVersion1')]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRulecontentId1')]",
              "version": "[variables('analyticRuleVersion1')]"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_huntingQuerycontentId1')]",
              "version": "[variables('huntingQueryVersion1')]"
            },
            {
              "kind": "HuntingQuery",
              "contentId": "[variables('_huntingQuerycontentId2')]",
              "version": "[variables('huntingQueryVersion2')]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            }
          ]
        },
        "firstPublishDate": "2022-05-23",
        "providers": [
          "Microsoft"
        ],
        "categories": {
          "domains": [
            "Security - Automation (SOAR)"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
