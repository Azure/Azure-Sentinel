{
    "name": "CyeraDSPM",
    "apiVersion": "2024-01-01-preview",
    "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
        "connectorUiConfig": {
            "id": "CyeraDSPM",
            "title": "Cyera DSPM Azure Sentinel Data Connector",
            "publisher": "Cyera Inc",
            "descriptionMarkdown": "The [Cyera DSPM](https://api.cyera.io/) data connector allows you to connect to your Cyera's DSPM instance and ingesting Classifications, Assets, Issues, and Identity Definitions into Microsoft Sentinel. The data connector is built on Microsoft Sentinel's Codeless Connector Platform and uses the Cyera's API to fetch Cyera's [DSPM Telemetry](https://www.cyera.com/) once recieced can be correlated with security events creating custom columns so that queries don't need to parse it again, thus resulting in better performance.",
            "graphQueries": [
                {
                    "metricName": "Total classification definitions received",
                    "legend": "Cyera DSPM Activities Logs",
                    "baseQuery": "CyeraDSPMClassifications_CL"
                },
                {
                    "metricName": "Total datastore assets received",
                    "legend": "Cyera DSPM Activities Logs",
                    "baseQuery": "CyeraDSPMAssets_CL"
                },
                {
                    "metricName": "Total Cyera identified issues received",
                    "legend": "Cyera DSPM Activities Logs",
                    "baseQuery": "CyeraDSPMIssues_CL"
                },
                {
                    "metricName": "Total identities received",
                    "legend": "Cyera DSPM Activities Logs",
                    "baseQuery": "CyeraDSPMIdentities_CL"
                }
            ],
            "sampleQueries": [
                {
                    "description": "Get Sample of Cyera DSPM Classification Definitions",
                    "query": "CyeraDSPMClassifications_CL | take 10"
                },
                {
                    "description": "Get Sample of Cyera DSPM Datastore Assets",
                    "query": "CyeraDSPMAssets_CL | take 10"
                },
                {
                    "description": "Get Sample of Cyera DSPM Issues Identified",
                    "query": "CyeraDSPMIssues_CL | take 10"
                },
                {
                    "description": "Get Sample of Cyera DSPM Identities",
                    "query": "CyeraDSPMIdentities_CL | take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "CyeraDSPMClassifications_CL",
                    "lastDataReceivedQuery": "CyeraDSPMClassifications_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                },
                {
                    "name": "CyeraDSPMAssets_CL",
                    "lastDataReceivedQuery": "CyeraDSPMAssets_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                },
                {
                    "name": "CyeraDSPMIssues_CL",
                    "lastDataReceivedQuery": "CyeraDSPMIssues_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                },
                {
                    "name": "CyeraDSPMIdentities_CL",
                    "lastDataReceivedQuery": "CyeraDSPMIdentities_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors"
                }
            ],
            "availability": {
                "isPreview": false
            },
            "permissions": {
                "tenant": null,
                "licenses": null,
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "read": true,
                            "write": true,
                            "delete": true,
                            "action": false
                        }
                    }
                ]
            },
            "instructionSteps": [
                {
                    "title": "Cyera DSPM Authentication",
                    "description": "Connect to your Cyera DSPM tenenant via Personal Access Tokens",
                    "instructions": [
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Cyera Personal Access Token Client ID",
                                "placeholder": "client_id",
                                "type": "text",
                                "name": "username"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Cyera Personal Access Token Secret Key",
                                "placeholder": "secret_key",
                                "type": "password",
                                "name": "password"
                            }
                        },
                        {
                            "type": "ConnectionToggleButton",
                            "parameters": {
                                "connectLabel": "Connect",
                                "name": "toggle"
                            }
                        }
                    ],
          "innerSteps": null
        }
      ],
      "isConnectivityCriteriasMatchSome": false
        }
    }
}