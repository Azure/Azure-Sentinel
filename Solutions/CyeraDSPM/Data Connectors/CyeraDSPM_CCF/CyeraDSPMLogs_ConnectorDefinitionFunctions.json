{
    "id": "CyeraFunctionsConnector",
    "kind": "Customizable",
    "name": "CyeraFunctionsConnector",
    "properties": {
      "connectorUiConfig": {
        "availability": {
          "isPreview": false,
          "status": 1
        },
        "connectivityCriteria": [
          {
            "type": "IsConnectedQuery",
            "value": [
              "CyeraClassifications_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
          },
          {
            "type": "IsConnectedQuery",
            "value": [
              "CyeraAssets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
          },
          {
            "type": "IsConnectedQuery",
            "value": [
              "CyeraAssets_MS_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
          },
          {
            "type": "IsConnectedQuery",
            "value": [
              "CyeraIssues_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
          },
          {
            "type": "IsConnectedQuery",
            "value": [
              "CyeraIdentities_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
          }
        ],
        "dataTypes": [
          {
            "lastDataReceivedQuery": "CyeraClassifications_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
            "name": "CyeraClassifications_CL"
          },
          {
            "lastDataReceivedQuery": "CyeraAssets_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
            "name": "CyeraAssets_CL"
          },
          {
            "lastDataReceivedQuery": "CyeraAssets_MS_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
            "name": "CyeraAssets_MS_CL"
          },
          {
            "lastDataReceivedQuery": "CyeraIssues_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
            "name": "CyeraIssues_CL"
          },
          {
            "lastDataReceivedQuery": "CyeraIdentities_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
            "name": "CyeraIdentities_CL"
          }
        ],
        "descriptionMarkdown": "The **Cyera DSPM Azure Function Connector** enables seamless ingestion of Cyera’s **Data Security Posture Management (DSPM)** telemetry — *Assets*, *Identities*, *Issues*, and *Classifications* — into **Microsoft Sentinel**.\\n\\nThis connector uses an **Azure Function App** to call Cyera’s REST API on a schedule, fetch the latest DSPM telemetry, and send it to Sentinel through the **Azure Monitor Logs Ingestion API** via a **Data Collection Endpoint (DCE)** and **Data Collection Rule (DCR, kind: Direct)** — no agents required.\\n\\n**Tables created/used**\\n\\n| Entity | Table | Purpose |\\n|---|---|---|\\n| Assets | `CyeraAssets_CL` | Raw asset metadata and data-store context |\\n| Identities | `CyeraIdentities_CL` | Identity definitions and sensitivity context |\\n| Issues | `CyeraIssues_CL` | Findings and remediation details |\\n| Classifications | `CyeraClassifications_CL` | Data class & sensitivity definitions |\\n| MS View | `CyeraAssets_MS_CL` | Normalized asset view for dashboards |\\n\\n> **Note:** This connector should only be used if directed by your Cyera CSE and otherwise use CCF based connector **Cyera DSPM Azure Sentinel Data Connector** which aligns with Microsoft’s recommended Direct ingestion path for Sentinel.",
        "graphQueries": [
          {
            "baseQuery": "CyeraClassifications_CL",
            "legend": "Total Cyera Classification Records",
            "metricName": "cyera_functions_classifications"
          },
          {
            "baseQuery": "CyeraAssets_CL",
            "legend": "Total Cyera Assets Records",
            "metricName": "cyera_functions_assets"
          },
          {
            "baseQuery": "CyeraAssets_MS_CL",
            "legend": "Total Cyera Asset MS Records",
            "metricName": "cyera_functions_assets_ms"
          },
          {
            "baseQuery": "CyeraIssues_CL",
            "legend": "Total Cyera Issue Records",
            "metricName": "cyera_functions_issues"
          },
          {
            "baseQuery": "CyeraIdentities_CL",
            "legend": "Total Cyera Identities Records",
            "metricName": "cyera_functions_identities"
          }
        ],
        "id": "CyeraFunctionsConnector",
        "instructionSteps": [
          {
            "description": ">**NOTE:** This connector uses an **Azure Function App** and the **Azure Monitor Logs Ingestion API** (DCE + DCR, kind: Direct). Function runtime and data egress may incur charges. See [Azure Functions pricing](https://azure.microsoft.com/pricing/details/functions/).",
            "innerSteps": null,
            "instructions": null,
            "title": "Note"
          },
          {
            "description": ">**(Optional)** Store Cyera API credentials in **Azure Key Vault** and reference them from the Function App. See [Key Vault references](https://learn.microsoft.com/azure/app-service/app-service-key-vault-references).",
            "innerSteps": null,
            "instructions": null,
            "title": "Optional Step"
          },
          {
            "description": "1) Generate a **Personal Access Token** [Generating Personal Access Token](https://support.cyera.io/hc/en-us/articles/19446274608919-Personal-and-API-Tokens) in your Cyera tenant.\\n2) Note **API Base URL**, **Client ID**, and **Client Secret**.",
            "innerSteps": null,
            "instructions": null,
            "title": "STEP 1 — Prepare Cyera API Access"
          },
          {
            "description": "> Before deploying, have these values handy:",
            "innerSteps": null,
            "instructions": [
              {
                "parameters": {
                  "name": "functionName",
                  "label": "CyeraFunctionsConnector"
                },
                "type": "Textbox"
              },
              {
                "parameters": {
                  "name": "workspaceName",
                  "label": "Workspace Name"
                },
                "type": "Textbox"
              },
              {
                "parameters": {
                  "name": "workspaceLocation",
                  "label": "Workspace Location"
                },
                "type": "Textbox"
              },
              {
                "parameters": {
                  "name": "cyeraBaseUrl",
                  "fillWith": [
                    "https://api.cyera.io"
                  ],
                  "label": "Cyera Base URL"
                },
                "type": "Textbox"
              },
              {
                "parameters": {
                  "name": "clientId",
                  "label": "Cyera Personal Access Token Client ID"
                },
                "type": "Textbox"
              },
              {
                "parameters": {
                  "name": "clientSecret",
                  "label": "Cyera Personal Access Token Secret"
                },
                "type": "Textbox"
              }
            ],
            "title": "STEP 2 — Choose ONE deployment option"
          },
          {
            "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the Cyera DSPM Functions and all required resources to support the connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fjoshua-acklin-cyera%2FAzure-Sentinel%2Frefs%2Fheads%2Fcyera-dspm%2FSolutions%2FCyeraDSPM%2FData%2520Connectors%2FCyeraDSPM_Functions%2FCyeraFunctionDeployment.json?FunctionName=testtesttest)\n2. Select the preferred **FunctionName** and **Workspace Name**. \n3. Enter the **Workspace Location**, **Cyera API Base Url**, **Personal Access Token Client ID**, and **Personal Access Token Secret**. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
            "innerSteps": null,
            "instructions": null,
            "title": "Option 1"
          },
          {
            "description": "Follow the [install pack’s step-by-step guide](https://raw.githubusercontent.com/joshua-acklin-cyera/Azure-Sentinel/refs/heads/cyera-dspm/Solutions/CyeraDSPM/Data%20Connectors/CyeraDSPM_Functions/INSTALL.md).\\n\\n1) Create/update the 5 custom tables, data collection rule with format `sentinel-dce-<functuion_name>`, and data collection endpoint with format `sentinel-dcr-<functuion_name>` using the scripts in [install-pack-v0_7_0/scripts](https://raw.githubusercontent.com/joshua-acklin-cyera/Azure-Sentinel/refs/heads/cyera-dspm/Solutions/CyeraDSPM/Data%20Connectors/CyeraDSPM_Functions/install-pack-v0_7_0.zip).\\n2) Deploy the Azure Function from the repo`s Function folder (Timer-trigger; schedule typically 5–15 minutes).\\n3) Configure Function App settings:\\n   - `CyeraBaseUrl` — Cyera API Base URL\\n   - `CyeraClientId` — Client ID (PAT)\\n   - `CyeraSecret` — Client Secret (PAT)\\n   - `DCR_IMMUTABLE_ID` — DCR immutable ID\\n   - `DCE_ENDPOINT` — Logs ingestion endpoint URL\\n   - `STREAM_ASSETS`=`Custom-CyeraAssets`, `STREAM_IDENTITIES`=`Custom-CyeraIdentities`, `STREAM_ISSUES`=`Custom-CyeraIssues`, `STREAM_CLASSIFICATIONS`=`Custom-CyeraClassifications`\\n4) Save and Start the Function App.",
            "innerSteps": null,
            "instructions": null,
            "title": "Option 2 — Manual Deployment"
          }
        ],
        "isConnectivityCriteriasMatchSome": false,
        "logo": "https://raw.githubusercontent.com/joshua-acklin-cyera/Azure-Sentinel/refs/heads/cyera-dspm/Logos/cyera_icon.svg",
        "permissions": {
          "customs": null,
          "licenses": null,
          "resourceProvider": [
            {
              "permissionsDisplayText": "Read and Write permissions are required.",
              "provider": "Microsoft.OperationalInsights/workspaces",
              "providerDisplayName": "Workspace",
              "requiredPermissions": {
                "action": false,
                "delete": true,
                "read": true,
                "write": true
              },
              "scope": "Workspace"
            }
          ],
          "tenant": null
        },
        "publisher": "Cyera Inc",
        "title": "Cyera DSPM Sentinel Data Connector - Azure Functions"
      },
      "createdTimeUtc": "2025-10-31T15:13:26.3235458Z",
      "lastModifiedUtc": "2025-10-31T15:13:26.3235458Z"
    },
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions"
}