[{
    "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'CyeraDSPMPollerClassifications')]",
    "apiVersion": "2023-02-01-preview",
    "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
    "location": "[parameters('workspace-location')]",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "CyeraDSPMCCF",
        "dcrConfig": {
            "streamName": "Custom-CyeraClassifications_SRC",
            "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
            "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
        },
        "dataType": "CyeraClassifications_CL",
        "auth": {
            "type": "JwtToken",
            "userName": {
                "key": "clientId",
                "value": "[[parameters('username')]"
            },
            "password": {
                "key": "secret",
                "value": "[[parameters('password')]"
            },
            "TokenEndpoint": "https://api.cyera.io/v1/login",
            "Headers": {
                "Accept": "application/json"
            },
            "IsCredentialsInHeaders": false,
            "IsJsonRequest": true,
            "JwtTokenJsonPath": "$.jwt",
            "RequestTimeoutInSeconds": 30
        },
        "request": {
            "apiEndpoint": "https://api.cyera.io/v1/classifications",
            "httpMethod": "GET",
            "queryParameters": {
                "offset": 0,
                "limit": 100
            },
            "queryWindowInMin": 5,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
            "rateLimitQps": 1,
            "retryCount": 3,
            "timeoutInSeconds": 120,
            "headers": {
                "Accept": "application/json",
                "User-Agent": "cyera-sentinel-connector/1.6.1"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.results"
            ],
            "format": "json"
        }
    }
},
{
    "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'CyeraDSPMPollerAssets')]",
    "apiVersion": "2023-02-01-preview",
    "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
    "location": "[parameters('workspace-location')]",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "CyeraDSPMCCF",
        "dcrConfig": {
            "streamName": "Custom-CyeraAssets_SRC",
            "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
            "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
        },
        "dataType": "CyeraAssets_CL",
        "auth": {
            "type": "JwtToken",
            "userName": {
                "key": "clientId",
                "value": "[[parameters('username')]"
            },
            "password": {
                "key": "secret",
                "value": "[[parameters('password')]"
            },
            "TokenEndpoint": "https://api.cyera.io/v1/login",
            "Headers": {
                "Accept": "application/json"
            },
            "IsCredentialsInHeaders": false,
            "IsJsonRequest": true,
            "JwtTokenJsonPath": "$.jwt",
            "RequestTimeoutInSeconds": 30
        },
        "request": {
            "apiEndpoint": "https://api.cyera.io/v2/datastores",
            "httpMethod": "GET",
            "queryParameters": {
                "offset": 0,
                "limit": 1000
            },
            "queryWindowInMin": 5,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
            "rateLimitQps": 1,
            "retryCount": 3,
            "timeoutInSeconds": 120,
            "headers": {
                "Accept": "application/json",
                "User-Agent": "cyera-sentinel-connector/1.6.1"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.results"
            ],
            "format": "json"
        }
    }
},
{
    "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'CyeraDSPMPollerIssues')]",
    "apiVersion": "2023-02-01-preview",
    "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
    "location": "[parameters('workspace-location')]",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "CyeraDSPMCCF",
        "dcrConfig": {
            "streamName": "Custom-CyeraIssues_SRC",
            "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
            "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
        },
        "dataType": "CyeraIssues_CL",
        "auth": {
            "type": "JwtToken",
            "userName": {
                "key": "clientId",
                "value": "[[parameters('username')]"
            },
            "password": {
                "key": "secret",
                "value": "[[parameters('password')]"
            },
            "TokenEndpoint": "https://api.cyera.io/v1/login",
            "Headers": {
                "Accept": "application/json"
            },
            "IsCredentialsInHeaders": false,
            "IsJsonRequest": true,
            "JwtTokenJsonPath": "$.jwt",
            "RequestTimeoutInSeconds": 30
        },
        "request": {
            "apiEndpoint": "https://api.cyera.io/v3/issues",
            "httpMethod": "GET",
            "queryParameters": {
                "offset": 0,
                "limit": 100
            },
            "queryWindowInMin": 5,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
            "rateLimitQps": 1,
            "retryCount": 3,
            "timeoutInSeconds": 120,
            "headers": {
                "Accept": "application/json",
                "User-Agent": "cyera-sentinel-connector/1.6.1"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.results"
            ],
            "format": "json"
        }
    }
},
{
    "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'CyeraDSPMPollerIdentities')]",
    "apiVersion": "2023-02-01-preview",
    "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
    "location": "[parameters('workspace-location')]",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "CyeraDSPMCCF",
        "dcrConfig": {
            "streamName": "Custom-CyeraIdentities_SRC",
            "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
            "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
        },
        "dataType": "CyeraIdentities_CL",
        "auth": {
            "type": "JwtToken",
            "userName": {
                "key": "clientId",
                "value": "[[parameters('username')]"
            },
            "password": {
                "key": "secret",
                "value": "[[parameters('password')]"
            },
            "TokenEndpoint": "https://api.cyera.io/v1/login",
            "Headers": {
                "Accept": "application/json"
            },
            "IsCredentialsInHeaders": false,
            "IsJsonRequest": true,
            "JwtTokenJsonPath": "$.jwt",
            "RequestTimeoutInSeconds": 30
        },
        "request": {
            "apiEndpoint": "https://api.cyera.io/v1/identities",
            "httpMethod": "GET",
            "queryParameters": {
                "offset": 0,
                "limit": 100
            },
            "queryWindowInMin": 5,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
            "rateLimitQps": 1,
            "retryCount": 3,
            "timeoutInSeconds": 120,
            "headers": {
                "Accept": "application/json",
                "User-Agent": "cyera-sentinel-connector/1.6.1"
            }
        },
        "response": {
            "eventsJsonPaths": [
                "$.results"
            ],
            "format": "json"
        }
    }
}]