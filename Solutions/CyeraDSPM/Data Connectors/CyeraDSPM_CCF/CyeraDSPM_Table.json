{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": { "workspace-location": { "type": "string" } },
    "variables": {},
    "resources": [
        {
            "name": "CyeraClassifications_CL",
            "apiVersion": "2022-10-01",
            "type": "Microsoft.OperationalInsights/workspaces/tables",
            "location": "[parameters('workspace-location')]",
            "kind": null,
            "properties": {
                "schema": {
                    "name": "CyeraClassifications_CL",
                    "columns": [
                        { "name": "TimeGenerated", "type": "datetime" },
                        { "name": "uid", "type": "string" },
                        { "name": "dataClassName", "type": "string" },
                        { "name": "classificationName", "type": "string" },
                        { "name": "name", "type": "string" },
                        { "name": "sensitivity", "type": "string" },
                        { "name": "sensitivityDisplayName", "type": "string" },
                        { "name": "defaultSensitivity", "type": "string" },
                        { "name": "defaultSensitivityDisplayName", "type": "string" },
                        { "name": "dataCategory", "type": "string" },
                        { "name": "classificationGroup", "type": "string" },
                        { "name": "classificationLevel", "type": "string" },
                        { "name": "learned", "type": "boolean" },
                        { "name": "collections", "type": "dynamic" },
                        { "name": "customCollections", "type": "dynamic" },
                        { "name": "frameworks", "type": "dynamic" },
                        { "name": "context", "type": "dynamic" }
                    ]
                }
            }
        },
        {
            "name": "CyeraAssets_MS_CL",
            "apiVersion": "2022-10-01",
            "type": "Microsoft.OperationalInsights/workspaces/tables",
            "location": "[parameters('workspace-location')]",
            "kind": null,
            "properties": {
                "schema": {
                    "name": "CyeraAssets_MS_CL",
                    "columns": [
                        { "name": "TimeGenerated", "type": "datetime" },
                        { "name": "AssetID", "type": "string" },
                        { "name": "AssetName", "type": "string" },
                        { "name": "Workload", "type": "string" },
                        { "name": "SubWorkload", "type": "string" },
                        { "name": "Location", "type": "string" },
                        { "name": "Risks", "type": "int" },
                        { "name": "SensitivityLabel", "type": "string" },
                        { "name": "AssetOwner", "type": "string" },
                        { "name": "Provider", "type": "string" },
                        { "name": "AdditionalFields", "type": "dynamic" },
                        { "name": "AADTenantID", "type": "string" },
                        { "name": "IsAssetRemoved", "type": "boolean" },
                        { "name": "FeedType", "type": "string" }
                    ]
                }
            }
        },
        {
            "name": "CyeraAssets_CL",
            "apiVersion": "2022-10-01",
            "type": "Microsoft.OperationalInsights/workspaces/tables",
            "location": "[parameters('workspace-location')]",
            "kind": null,
            "properties": {
                "schema": {
                    "name": "CyeraAssets_CL",
                    "columns": [
                        { "name": "TimeGenerated", "type": "datetime" },
                        { "name": "uid", "type": "string" },
                        { "name": "name", "type": "string" },
                        { "name": "type_s", "type": "string" },
                        { "name": "provider", "type": "string" },
                        { "name": "infrastructure", "type": "string" },
                        { "name": "engine", "type": "string" },
                        { "name": "regions", "type": "dynamic" },
                        { "name": "account", "type": "dynamic" },
                        { "name": "classificationGroups", "type": "dynamic" },
                        { "name": "cloudProviderTags", "type": "dynamic" },
                        { "name": "owner", "type": "string" },
                        { "name": "dataType", "type": "string" },
                        { "name": "discoveredDate", "type": "datetime" },
                        { "name": "createdDate", "type": "datetime" },
                        { "name": "cloudProviderUrl", "type": "string" },
                        { "name": "scanningState", "type": "string" },
                        { "name": "ghost", "type": "bool" },
                        { "name": "vpc", "type": "dynamic" },
                        { "name": "sensitivity", "type": "string" },
                        { "name": "sensitivityDisplayName", "type": "string" },
                        { "name": "recordCountBySensitivity", "type": "dynamic" },
                        { "name": "issues", "type": "dynamic" },
                        { "name": "userTags", "type": "dynamic" },
                        { "name": "collections", "type": "dynamic" },
                        { "name": "customCollections", "type": "dynamic" },
                        { "name": "frameworks", "type": "dynamic" },
                        { "name": "learned", "type": "bool" },
                        { "name": "classificationLevel", "type": "string" },
                        { "name": "encrypted", "type": "bool" },
                        { "name": "sslEnforced", "type": "string" },
                        { "name": "logging", "type": "string" },
                        { "name": "publicAccessibilityState", "type": "string" },
                        { "name": "lastDataRefresh", "type": "datetime" },
                        { "name": "lastModifiedTime", "type": "datetime" },
                        { "name": "lastModifiedDate", "type": "datetime" },
                        { "name": "lastScannedDate", "type": "datetime" },
                        { "name": "driveId", "type": "string" },
                        { "name": "arn", "type": "string" },
                        { "name": "rdsEndpoint", "type": "string" },
                        { "name": "azureId", "type": "string" },
                        { "name": "datastoreSizeInGiB", "type": "real" },
                        { "name": "projectIds", "type": "dynamic" },
                        { "name": "datastoreOwners", "type": "dynamic" },
                        { "name": "autoScan", "type": "bool" },
                        { "name": "siteName", "type": "string" },
                        { "name": "userId", "type": "string" },
                        { "name": "siteId", "type": "string" },
                        { "name": "resourceId", "type": "string" },
                        { "name": "region", "type": "string" }
                    ]
                }
            }
        },
        {
            "name": "CyeraIssues_CL",
            "apiVersion": "2022-10-01",
            "type": "Microsoft.OperationalInsights/workspaces/tables",
            "location": "[parameters('workspace-location')]",
            "kind": null,
            "properties": {
                "schema": {
                    "name": "CyeraIssues_CL",
                    "columns": [
                        { "name": "TimeGenerated", "type": "datetime" },
                        { "name": "provider", "type": "string" },
                        { "name": "infrastructure", "type": "string" },
                        { "name": "engine", "type": "string" },
                        { "name": "regions", "type": "dynamic" },
                        { "name": "account", "type": "dynamic" },
                        { "name": "classificationGroups", "type": "dynamic" },
                        { "name": "cloudProviderTags", "type": "dynamic" },
                        { "name": "owner", "type": "string" },
                        { "name": "uid", "type": "string" },
                        { "name": "name", "type": "string" },
                        { "name": "severity", "type": "string" },
                        { "name": "createdDate", "type": "datetime" },
                        { "name": "updatedDate", "type": "datetime" },
                        { "name": "status", "type": "string" },
                        { "name": "riskStatus", "type": "string" },
                        { "name": "resolution", "type": "string" },
                        { "name": "resolutionNote", "type": "string" },
                        { "name": "datastoreName", "type": "string" },
                        { "name": "datastoreUid", "type": "string" },
                        { "name": "risk", "type": "dynamic" },
                        { "name": "data", "type": "dynamic" },
                        { "name": "datastoreCloudProviderTags", "type": "dynamic" },
                        { "name": "datastoreUserTags", "type": "dynamic" },
                        { "name": "datastoreOwners", "type": "dynamic" },
                        { "name": "remediationAdvice", "type": "string" },
                        { "name": "policyUid", "type": "string" },
                        { "name": "itsmTickets", "type": "dynamic" }
                    ]
                }
            }
        },
        {
            "name": "CyeraIdentities_CL",
            "apiVersion": "2022-10-01",
            "type": "Microsoft.OperationalInsights/workspaces/tables",
            "location": "[parameters('workspace-location')]",
            "kind": null,
            "properties": {
                "schema": {
                    "name": "CyeraIdentities_CL",
                    "columns": [
                        { "name": "TimeGenerated", "type": "datetime" },
                        { "name": "uid", "type": "string" },
                        { "name": "category", "type": "string" },
                        { "name": "displayName", "type": "string" },
                        { "name": "displayId", "type": "string" },
                        { "name": "scopeNamespace", "type": "string" },
                        { "name": "scopeDisplayName", "type": "string" },
                        { "name": "scopeId", "type": "string" },
                        { "name": "trustLevel", "type": "string" },
                        { "name": "isStale", "type": "boolean" },
                        { "name": "isEnabled", "type": "boolean" },
                        { "name": "multiFactorAuthenticationStatus", "type": "string" },
                        { "name": "membersCount", "type": "dynamic" },
                        { "name": "hasCopilot", "type": "boolean" },
                        { "name": "lastActiveTime", "type": "datetime" },
                        { "name": "creationTime", "type": "datetime" },
                        { "name": "description", "type": "string" },
                        { "name": "isAdmin", "type": "boolean" },
                        { "name": "classificationGroupsNames", "type": "dynamic" },
                        { "name": "sensitivity", "type": "string" },
                        { "name": "sensitiveRecords", "type": "real" },
                        { "name": "sensitivityBreakdown", "type": "dynamic" },
                        { "name": "lastPasswordUpdateTime", "type": "datetime" },
                        { "name": "jobTitle", "type": "string" },
                        { "name": "department", "type": "string" },
                        { "name": "officeLocation", "type": "string" },
                        { "name": "country", "type": "string" },
                        { "name": "hasMultipleParents", "type": "boolean" },
                        { "name": "domain", "type": "string" },
                        { "name": "businessFunction", "type": "string" },
                        { "name": "seniorityLevel", "type": "string" },
                        { "name": "issueCountBySeverity", "type": "dynamic" },
                        { "name": "reportsTo", "type": "string" },
                        { "name": "managerId", "type": "string" }
                    ]
                }
            }
        }
    ]
}


