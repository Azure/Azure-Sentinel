id: 3b381d0c-a650-4f74-b7c6-13c731f3ea48
Function:
  Title: Parser for TenableVMAssets
  Version: '1.0.0'
  LastUpdated: '2025-05-23'
Category: Microsoft Sentinel Parser
FunctionName: TenableVMAssets
FunctionAlias: TenableVMAssets
FunctionQuery: |
    Tenable_VM_Asset_CL
    | extend 
        EventVendor="TenableIO",
        EventProduct="Assets",
        EventType='AssetExport',
        AgentName=column_ifexists('agent_names', ''),
        AgentUUID=column_ifexists('agent_uuid', ''),
        AWSAvailabilityZone=column_ifexists('aws_availability_zone', ''),
        AWSEC2InstanceAMI=column_ifexists('aws_ec2_instance_ami_id', ''),
        AWSEC2InstanceGroupName=column_ifexists('aws_ec2_instance_group_name', ''),
        AWSEC2InstanceID=column_ifexists('aws_ec2_instance_id', ''),
        AWSEC2InstanceStateName=column_ifexists('aws_ec2_instance_state_name', ''),
        AWSEC2InstanceType=column_ifexists('aws_ec2_instance_type', ''),
        AWSOwnerID=column_ifexists('aws_owner_id', ''),
        AWSRegion=column_ifexists('aws_region', ''),
        AWSSubnetID=column_ifexists('aws_subnet_id', ''),
        AWSVPCID=column_ifexists('aws_vpc_id', ''),
        AzureResourceID=column_ifexists('azure_resource_id', ''),
        AzureVMID=column_ifexists('azure_vm_id', ''),
        BIOSUUID=column_ifexists('bios_uuid',''),
        Computer=column_ifexists('Computer', ''),
        CreatedAtTime=column_ifexists('created_at', ''),
        DeletedAtTime=column_ifexists('deleted_at', ''),
        DeletedBy=column_ifexists('deleted_by', ''),
        FirstScanTime=column_ifexists('first_scan_time', ''),
        FirstSeen=column_ifexists('first_seen', ''),
        FQDNs=column_ifexists('fqdns', ''),
        GCPInstanceID=column_ifexists('gcp_instance_id', ''),
        GCPProjectID=column_ifexists('gcp_project_id', ''),
        GCPZone=column_ifexists('gcp_zone', ''),
        HasAgent=column_ifexists('has_agent', ''),
        HasPluginResults=column_ifexists('has_plugin_results', ''),
        ID=column_ifexists('id', ''),
        InstalledSoftware=column_ifexists('installed_software', ''),
        IPV4s=column_ifexists('ipv4s', ''),
        IPV6s=column_ifexists('ipv6s', ''),
        LastAuthenticatedScanDate=column_ifexists('last_authenticated_scan_date', ''),
        LastLicensedScanDate=column_ifexists('last_licensed_scan_date', ''),
        LastScanID=column_ifexists('last_scan_id',''),
        LastScanDate=column_ifexists('last_scan_time', ''),
        LastScheduleID=column_ifexists('last_schedule_id', ''),
        LastSeenDate=column_ifexists('last_seen', ''),
        MACAddresses=column_ifexists('mac_addresses', ''),
        ManufacturerTPMIDs=column_ifexists('manufacturer_tpm_ids', ''),
        NetBIOSNames=column_ifexists('netbios_names', ''),
        NetworkID=column_ifexists('network_id', ''),
        NetworkInterfaces=column_ifexists('network_interfaces', ''),
        NetworkName=column_ifexists('network_name', ''),
        OperatingSystems=column_ifexists('operating_systems', ''),
        QualysAssetIDs=column_ifexists('qualys_asset_ids', ''),
        QualysHostIDs=column_ifexists('qualys_host_ids', ''),
        ServiceNowSysID=column_ifexists('servicenow_sysid', ''),
        Sources=column_ifexists('sources', ''),
        SSHFingerprints=column_ifexists('ssh_fingerprints', ''),
        SymantecEPHardwareKeys=column_ifexists('symantec_ep_hardware_keys', ''),
        SystemTypes=column_ifexists('system_types', ''),
        Tags=column_ifexists('tags', ''),
        TerminatedAt=column_ifexists('terminated_at', ''),
        TerminatedBy=column_ifexists('terminated_by', ''),
        UpdatedAt=column_ifexists('updated_at', '')
    | project
        FQDNs,
        AzureResourceID,
        AzureVMID,
        OperatingSystems,
        IPV4s,
        NetworkName,
        InstalledSoftware,
        FirstSeen,
        LastSeenDate,
        FirstScanTime,
        LastScanDate,
        LastAuthenticatedScanDate,
        LastLicensedScanDate,
        HasPluginResults,
        HasAgent,
        TimeGenerated, 
        EventVendor,
        EventProduct,
        EventType,
        AgentName,
        AgentUUID,
        AWSAvailabilityZone,
        AWSEC2InstanceAMI,
        AWSEC2InstanceGroupName,
        AWSEC2InstanceID,
        AWSEC2InstanceStateName,
        AWSEC2InstanceType,
        AWSOwnerID,
        AWSRegion,
        AWSSubnetID,
        AWSVPCID,
        BIOSUUID,
        Computer,
        CreatedAtTime,
        DeletedAtTime,
        DeletedBy,
        GCPInstanceID,
        GCPProjectID,
        GCPZone,
        ID,
        IPV6s,
        LastScanID,
        LastScheduleID,
        MACAddresses,
        ManufacturerTPMIDs,
        NetBIOSNames,
        NetworkID,
        NetworkInterfaces,
        QualysAssetIDs,
        QualysHostIDs,
        ServiceNowSysID,
        Sources,
        SSHFingerprints,
        SymantecEPHardwareKeys,
        SystemTypes,
        Tags,
        TerminatedAt,
        TerminatedBy,
        UpdatedAt