id: 0c75ae72-bca4-4b53-a4f5-7c6d34e8b9cb
Function:
  Title: Parser for TenableVMVulnerabilities
  Version: '1.0.0'
  LastUpdated: '2025-05-23'
Category: Microsoft Sentinel Parser
FunctionName: TenableVMVulnerabilities
FunctionAlias: TenableVMVulnerabilities
FunctionQuery: |
    Tenable_VM_Vuln_CL
    | extend 
        EventVendor="TenableIO",
        EventProduct="Vulnerabilities",
        EventType='VulnerabilityExport',
        AssetAgentUUID=column_ifexists('asset_agent_uuid', ''),
        AssetBIOSUUID=column_ifexists('asset_bios_uuid', ''),
        AssetDeviceType=column_ifexists('asset_device_type', ''),
        AssetFQDN=column_ifexists('asset_fqdn', ''),
        AssetHostname=column_ifexists('asset_hostname', ''),
        AssetIPV4=column_ifexists('asset_ipv4', ''),
        AssetIPV6=column_ifexists('asset_ipv6', ''),
        AssetLastAuthenticatedScanDate=column_ifexists('asset_last_authenticated_results', ''),
        AssetLastUnauthenticatedScanDate=column_ifexists('asset_last_unauthenticated_results', ''),
        AssetMACAddress=column_ifexists('asset_mac_address', ''),
        AssetNetBIOSName=column_ifexists('asset_netbios_name', ''),
        AssetNetworkID=column_ifexists('asset_network_id', ''),
        AssetOperatingSystem=column_ifexists('asset_operating_system', ''),
        AssetTracked=column_ifexists('asset_tracked', ''),
        AssetUUID=column_ifexists('asset_uuid', ''),
        Computer=column_ifexists('Computer', ''),
        FirstFoundDate=column_ifexists('first_found', ''),
        IndexedDate=column_ifexists('indexed', ''),
        LastFixedDate=column_ifexists('last_fixed', ''),
        LastFoundDate=column_ifexists('last_found', ''),
        Output=column_ifexists('output', ''),
        PluginBugtraqID=column_ifexists('plugin_bid', ''),
        PluginCanvasPackage=column_ifexists('plugin_canvas_package', ''),
        PluginChecksForDefaultAccount=column_ifexists('plugin_checks_for_default_account', ''),
        PluginChecksForMalware=column_ifexists('plugin_checks_for_malware', ''),
        PluginCPE=column_ifexists('plugin_cpe', ''),
        PluginCVE=column_ifexists('plugin_cve', ''),
        PluginCVSS3BaseScore=column_ifexists('plugin_cvss3_base_score', ''),
        PluginCVSS3TemporalScore=column_ifexists('plugin_cvss3_temporal_score', ''),
        PluginCVSS3TemporalVectorExploitability=column_ifexists('plugin_cvss3_temporal_vector_exploitability', ''),
        PluginCVSS3TemporalVectorRaw=column_ifexists('plugin_cvss3_temporal_vector_raw', ''),
        PluginCVSS3TemporalVectorRemediationLevel=column_ifexists('plugin_cvss3_temporal_vector_remediation_level', ''),
        PluginCVSS3TemporalVectorReportConfidence=column_ifexists('plugin_cvss3_temporal_vector_report_confidence', ''),
        PluginCVSS3VectorAccessComplexity=column_ifexists('plugin_cvss3_vector_access_complexity', ''),
        PluginCVSS3VectorAccessVector=column_ifexists('plugin_cvss3_vector_access_vector', ''),
        PluginCVSS3VectorAvailabilityImpact=column_ifexists('plugin_cvss3_vector_availability_impact', ''),
        PluginCVSS3VectorConfidentialityImpact=column_ifexists('plugin_cvss3_vector_confidentiality_impact', ''),
        PluginCVSS3VectorIntegrityImpact=column_ifexists('plugin_cvss3_vector_integrity_impact', ''),
        PluginCVSS3VectorRaw=column_ifexists('plugin_cvss3_vector_raw', ''),
        PluginCVSSBaseScore=column_ifexists('plugin_cvss_base_score', ''),
        PluginCVSSTemporalScore=column_ifexists('plugin_cvss_temporal_score', ''),
        PluginCVSSTemporalVectorRemediationLevel=column_ifexists('plugin_cvss_temporal_vector_remediation_level', ''),
        PluginCVSSTemporalVectorReportConfidence=column_ifexists('plugin_cvss_temporal_vector_report_confidence', ''),
        PluginCVSSVectorAccessComplexity=column_ifexists('plugin_cvss_vector_access_complexity', ''),
        PluginCVSSVectorAccessVector=column_ifexists('plugin_cvss_vector_access_vector', ''),
        PluginCVSSVectorAuthentication=column_ifexists('plugin_cvss_vector_authentication', ''),
        PluginCVSSVectorAvailabilityImpact=column_ifexists('plugin_cvss_vector_availability_impact', ''),
        PluginCVSSVectorConfidentialityImpact=column_ifexists('plugin_cvss_vector_confidentiality_impact', ''),
        PluginCVSSVectorIntegrityImpact=column_ifexists('plugin_cvss_vector_integrity_impact', ''),
        PluginCVSSVectorRaw=column_ifexists('plugin_cvss_vector_raw', ''),
        PluginDescription=column_ifexists('plugin_description', ''),
        PluginExploitabilityEase=column_ifexists('plugin_exploitability_ease', ''),
        PluginExploitedByMalware=column_ifexists('plugin_exploited_by_malware', ''),
        PluginExploitedByNessus=column_ifexists('plugin_exploited_by_nessus', ''),
        PluginExploitAvailable=column_ifexists('plugin_exploit_available', ''),
        PluginExploitFrameworkCanvas=column_ifexists('plugin_exploit_framework_canvas', ''),
        PluginExploitFrameworkMetasploit=column_ifexists('plugin_exploit_framework_metasploit', ''),
        PluginFamilyID=column_ifexists('plugin_family_id', ''),
        PluginFamily=column_ifexists('plugin_family', ''),
        PluginHasPatch=column_ifexists('plugin_has_patch', ''),
        PluginID=column_ifexists('plugin_id', ''),
        PluginInTheNews=column_ifexists('plugin_in_the_news', ''),
        PluginMetasploitName=column_ifexists('plugin_metasploit_name', ''),
        PluginMicrosoftBulletin=column_ifexists('plugin_ms_bulletin', ''),
        PluginName=column_ifexists('plugin_name', ''),
        PluginPatchPublicationDate=column_ifexists('plugin_patch_publication_date', ''),
        PluginPublicationDate=column_ifexists('plugin_publication_date', ''),
        PluginRiskFactor=column_ifexists('plugin_risk_factor', ''),
        PluginSeeAlso=column_ifexists('plugin_see_also', ''),
        PluginSolution=column_ifexists('plugin_solution', ''),
        PluginSTIGSeverity=column_ifexists('plugin_stig_severity', ''),
        PluginSynopsis=column_ifexists('plugin_synopsis', ''),
        PluginType=column_ifexists('plugin_type', ''),
        PluginUnsupportedByVendor=column_ifexists('plugin_unsupported_by_vendor', ''),
        PluginUbuntuSecurityNotice=column_ifexists('plugin_usn', ''),
        PluginVersion=column_ifexists('plugin_version', ''),
        PluginVPRDriversAgeOfVulnLowerBound=column_ifexists('plugin_vpr_drivers_age_of_vuln_lower_bound', ''),
        PluginVPRDriversAgeOfVulnUpperBound=column_ifexists('plugin_vpr_drivers_age_of_vuln_upper_bound', ''),
        PluginVPRDriversCVSS3ImpactScore=column_ifexists('plugin_vpr_drivers_cvss3_impact_score', ''),
        PluginVPRDriversCVSSImpactScorePredicted=column_ifexists('plugin_vpr_drivers_cvss_impact_score_predicted', ''),
        PluginVPRDriversExploitCodeMaturity=column_ifexists('plugin_vpr_drivers_exploit_code_maturity', ''),
        PluginVPRDriversProductCoverage=column_ifexists('plugin_vpr_drivers_product_coverage', ''),
        PluginVPRDriversThreatIntensityLast28=column_ifexists('plugin_vpr_drivers_threat_intensity_last28', ''),
        PluginVPRDriversThreatRecencyLowerBound=column_ifexists('plugin_vpr_drivers_threat_recency_lower_bound', ''),
        PluginVPRDriversThreatRecencyUpperBound=column_ifexists('plugin_vpr_drivers_threat_recency_upper_bound', ''),
        PluginVPRDriversThreatSourcesLast28=column_ifexists('plugin_vpr_drivers_threat_sources_last28', ''),
        PluginVPRScore=column_ifexists('plugin_vpr_score', ''),
        PluginVPRUpdatedDate=column_ifexists('plugin_vpr_updated', ''),
        PluginVPRPublicationDate=column_ifexists('plugin_vuln_publication_date', ''),
        PluginXRefs=column_ifexists('plugin_xrefs', ''),
        PortNumber=column_ifexists('port_port', ''),
        PortProtocol=column_ifexists('port_protocol', ''),
        PortService=column_ifexists('port_service', ''),
        ScanCompletedAtTime=column_ifexists('scan_completed_at', ''),
        ScanScheduleUUID=column_ifexists('scan_schedule_uuid', ''),
        ScanID=column_ifexists('scan_uuid', ''),
        SeverityDefaultID=column_ifexists('severity_default_id', ''),
        SeverityID=column_ifexists('severity_id', ''),
        SeverityModificationType=column_ifexists('severity_modification_type', ''),
        Severity=column_ifexists('severity', ''),
        State=column_ifexists('state', '')
    | project
        AssetFQDN,
        AssetIPV4,
        AssetOperatingSystem,
        Severity,
        State,
        PluginID,
        PluginName,
        PluginCVE,
        PluginCPE,
        PluginVPRScore,
        PluginCVSS3BaseScore,
        PluginCVSSBaseScore,
        PluginFamily,
        PluginDescription,
        PluginSolution,
        FirstFoundDate,
        IndexedDate,
        LastFixedDate,
        LastFoundDate,
        AssetLastAuthenticatedScanDate,
        AssetLastUnauthenticatedScanDate,
        AssetAgentUUID,
        AssetBIOSUUID,
        AssetDeviceType,
        AssetHostname,
        AssetIPV6,
        AssetMACAddress,
        AssetNetBIOSName,
        AssetNetworkID,
        AssetTracked,
        AssetUUID,
        Computer,
        Output,
        PluginBugtraqID,
        PluginCanvasPackage,
        PluginChecksForDefaultAccount,
        PluginChecksForMalware,
        PluginCVSS3TemporalScore,
        PluginCVSS3TemporalVectorExploitability,
        PluginCVSS3TemporalVectorRaw,
        PluginCVSS3TemporalVectorRemediationLevel,
        PluginCVSS3TemporalVectorReportConfidence,
        PluginCVSS3VectorAccessComplexity,
        PluginCVSS3VectorAccessVector,
        PluginCVSS3VectorAvailabilityImpact,
        PluginCVSS3VectorConfidentialityImpact,
        PluginCVSS3VectorIntegrityImpact,
        PluginCVSS3VectorRaw,
        PluginCVSSTemporalScore,
        PluginCVSSTemporalVectorRemediationLevel,
        PluginCVSSTemporalVectorReportConfidence,
        PluginCVSSVectorAccessComplexity,
        PluginCVSSVectorAccessVector,
        PluginCVSSVectorAuthentication,
        PluginCVSSVectorAvailabilityImpact,
        PluginCVSSVectorConfidentialityImpact,
        PluginCVSSVectorIntegrityImpact,
        PluginCVSSVectorRaw,
        PluginExploitabilityEase,
        PluginExploitedByMalware,
        PluginExploitedByNessus,
        PluginExploitAvailable,
        PluginExploitFrameworkCanvas,
        PluginExploitFrameworkMetasploit,
        PluginFamilyID,
        PluginHasPatch,
        PluginInTheNews,
        PluginMetasploitName,
        PluginMicrosoftBulletin,
        PluginPatchPublicationDate,
        PluginPublicationDate,
        PluginRiskFactor,
        PluginSeeAlso,
        PluginSTIGSeverity,
        PluginSynopsis,
        PluginType,
        PluginUnsupportedByVendor,
        PluginUbuntuSecurityNotice,
        PluginVersion,
        PluginVPRDriversAgeOfVulnLowerBound,
        PluginVPRDriversAgeOfVulnUpperBound,
        PluginVPRDriversCVSS3ImpactScore,
        PluginVPRDriversCVSSImpactScorePredicted,
        PluginVPRDriversExploitCodeMaturity,
        PluginVPRDriversProductCoverage,
        PluginVPRDriversThreatIntensityLast28,
        PluginVPRDriversThreatRecencyLowerBound,
        PluginVPRDriversThreatRecencyUpperBound,
        PluginVPRDriversThreatSourcesLast28,
        PluginVPRUpdatedDate,
        PluginVPRPublicationDate,
        PluginXRefs,
        PortNumber,
        PortProtocol,
        PortService,
        ScanCompletedAtTime,
        ScanScheduleUUID,
        ScanID,
        SeverityDefaultID,
        SeverityID,
        SeverityModificationType,
        EventVendor,
        EventProduct,
        EventType