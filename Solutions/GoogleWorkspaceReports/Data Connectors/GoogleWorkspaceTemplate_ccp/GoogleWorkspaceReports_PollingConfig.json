[
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceAccessTransparency",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "tokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "authorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "authorizationEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/access_transparency",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceAdmin",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/admin",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceCalendar",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/calendar",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 360,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceChat",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/chat",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 1440,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceDrive",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/drive",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceGCP",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/gcp",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceGPlus",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/gplus",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceGroups",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/groups",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceGroupsEnterprise",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/groups_enterprise",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceJamboard",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/jamboard",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceLogin",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/login",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 360,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceMeet",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/meet",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceMobile",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/mobile",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceRules",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/rules",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceSAML",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/saml",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceToken",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/token",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceUserAccounts",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/user_accounts",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 180,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceContextAwareAccess",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/context_aware_access",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceChrome",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/chrome",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceDataStudio",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/data_studio",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2024-09-01",
    "name": "{{innerWorkspace}}/Microsoft.SecurityInsights/GoogleWorkspaceKeep",
    "kind": "RestApiPoller",
    "location": "{{location}}",
    "properties": {
      "connectorDefinitionName": "GoogleWorkspaceCCPDefinition",
      "dataType": "GoogleWorkspaceReports",
      "dcrConfig": {
        "streamName": "SENTINEL_GOOGLEWORKSPACEREPORTS",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
      },
      "auth": {
        "type": "OAuth2",
        "IsClientSecretInHeader": "true",
        "IsCredentialsInHeaders": "true",
        "ClientSecret": "{{clientSecret}}",
        "ClientId": "{{clientId}}",
        "AuthorizationCode": "{{authorizationCode}}",
        "GrantType": "authorization_code",
        "TokenEndpoint": "https://accounts.google.com/o/oauth2/token",
        "TokenEndpointHeaders": {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        "AuthorizationEndpoint": "https://accounts.google.com/o/oauth2/auth",
        "TokenEndpointQueryParameters": {
          "prompt": "consent",
          "access_type": "offline"
        },
        "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
        "redirectUri": "https://portal.azure.com/TokenAuthorize/ExtensionName/Microsoft_Azure_Security_Insights"
      },
      "request": {
        "apiEndpoint": "https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/keep",
        "httpMethod": "GET",
        "queryParameters": {
          "maxResults": 1000,
          "startTime": "{_QueryWindowStartTime}",
          "endTime": "{_QueryWindowEndTime}"
        },
        "queryWindowInMin": 10,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",
        "startTimeAttributeName": "startTime",
        "endTimeAttributeName": "endTime",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json"
        }
      },
      "extra": {
        "transformName": "/ASI/GoogleWorkspace/OneDetectionPerRow"
      },
      "response": {
        "eventsJsonPaths": [
          "$.items"
        ]
      },
      "paging": {
        "pagingType": "NextPageToken",
        "nextPageTokenJsonPath": "$.nextPageToken",
        "nextPageParaName": "pageToken"
      }
    }
  }
]