{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Microsoft - support@microsoft.com",
    "comments": "Solution template for CrowdStrike Falcon Endpoint Protection"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "CrowdStrike Falcon Endpoint Protection",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "email": "support@microsoft.com",
    "_email": "[variables('email')]",
    "_solutionName": "CrowdStrike Falcon Endpoint Protection",
    "_solutionVersion": "3.1.8",
    "solutionId": "azuresentinel.azure-sentinel-solution-crowdstrikefalconep",
    "_solutionId": "[variables('solutionId')]",
    "uiConfigId1": "CrowdstrikeReplicatorv2",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "CrowdstrikeReplicatorv2",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))))]",
    "dataConnectorVersion1": "1.0.1",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "uiConfigId2": "CrowdStrikeFalconAdversaryIntelligence",
    "_uiConfigId2": "[variables('uiConfigId2')]",
    "dataConnectorContentId2": "CrowdStrikeFalconAdversaryIntelligence",
    "_dataConnectorContentId2": "[variables('dataConnectorContentId2')]",
    "dataConnectorId2": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
    "_dataConnectorId2": "[variables('dataConnectorId2')]",
    "dataConnectorTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId2'))))]",
    "dataConnectorVersion2": "1.0.0",
    "_dataConnectorcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId2'),'-', variables('dataConnectorVersion2'))))]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "dataConnectorCCPVersion": "1.0.0",
    "_dataConnectorContentIdConnectorDefinition3": "CrowdStrikeFalconS3CCPDefinition",
    "dataConnectorTemplateNameConnectorDefinition3": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition3')))]",
    "_dataConnectorContentIdConnections3": "CrowdStrikeFalconS3CCPDefinitionConnections",
    "dataConnectorTemplateNameConnections3": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections3')))]",
    "dataCollectionEndpointId3": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "blanks": "[replace('b', 'b', '')]",
    "TemplateEmptyObject": "[json('{}')]",
    "_dataConnectorContentIdConnectorDefinition4": "CrowdStrikeAPICCPDefinition",
    "dataConnectorTemplateNameConnectorDefinition4": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition4')))]",
    "_dataConnectorContentIdConnections4": "CrowdStrikeAPICCPDefinitionConnections",
    "dataConnectorTemplateNameConnections4": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections4')))]",
    "dataCollectionEndpointId4": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "parserObject1": {
      "_parserName1": "[concat(parameters('workspace'),'/','CrowdStrikeFalconEventStream Data Parser')]",
      "_parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdStrikeFalconEventStream Data Parser')]",
      "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CrowdStrikeFalconEventStream-Parser')))]",
      "parserVersion1": "1.0.0",
      "parserContentId1": "CrowdStrikeFalconEventStream-Parser"
    },
    "parserObject2": {
      "_parserName2": "[concat(parameters('workspace'),'/','CrowdstrikeReplicator Data Parser')]",
      "_parserId2": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdstrikeReplicator Data Parser')]",
      "parserTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CrowdStrikeReplicator-Parser')))]",
      "parserVersion2": "2.0.0",
      "parserContentId2": "CrowdStrikeReplicator-Parser"
    },
    "parserObject3": {
      "_parserName3": "[concat(parameters('workspace'),'/','CrowdStrikeReplicatorV2 Data Parser')]",
      "_parserId3": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdStrikeReplicatorV2 Data Parser')]",
      "parserTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('CrowdStrikeReplicatorV2-Parser')))]",
      "parserVersion3": "1.0.0",
      "parserContentId3": "CrowdStrikeReplicatorV2-Parser"
    },
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "CrowdStrikeFalconEndpointProtectionWorkbook",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.4",
      "_analyticRulecontentId1": "4465ebde-b381-45f7-ad08-7d818070a11c",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '4465ebde-b381-45f7-ad08-7d818070a11c')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('4465ebde-b381-45f7-ad08-7d818070a11c')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','4465ebde-b381-45f7-ad08-7d818070a11c','-', '1.0.4')))]"
    },
    "analyticRuleObject2": {
      "analyticRuleVersion2": "1.0.4",
      "_analyticRulecontentId2": "f7d298b2-726c-42a5-bbac-0d7f9950f527",
      "analyticRuleId2": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', 'f7d298b2-726c-42a5-bbac-0d7f9950f527')]",
      "analyticRuleTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('f7d298b2-726c-42a5-bbac-0d7f9950f527')))]",
      "_analyticRulecontentProductId2": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','f7d298b2-726c-42a5-bbac-0d7f9950f527','-', '1.0.4')))]"
    },
    "CrowdStrike_Base": "CrowdStrike_Base",
    "_CrowdStrike_Base": "[variables('CrowdStrike_Base')]",
    "playbookVersion1": "1.0",
    "playbookContentId1": "CrowdStrike_Base",
    "_playbookContentId1": "[variables('playbookContentId1')]",
    "playbookId1": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId1'))]",
    "playbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId1'))))]",
    "_playbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId1'),'-', variables('playbookVersion1'))))]",
    "CrowdStrike_Enrichment_GetDeviceInformation": "CrowdStrike_Enrichment_GetDeviceInformation",
    "_CrowdStrike_Enrichment_GetDeviceInformation": "[variables('CrowdStrike_Enrichment_GetDeviceInformation')]",
    "TemplateEmptyArray": "[json('[]')]",
    "playbookVersion2": "1.0",
    "playbookContentId2": "CrowdStrike_Enrichment_GetDeviceInformation",
    "_playbookContentId2": "[variables('playbookContentId2')]",
    "playbookId2": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId2'))]",
    "playbookTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId2'))))]",
    "_playbookcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId2'),'-', variables('playbookVersion2'))))]",
    "CrowdStrike_ContainHost": "CrowdStrike_ContainHost",
    "_CrowdStrike_ContainHost": "[variables('CrowdStrike_ContainHost')]",
    "playbookVersion3": "1.0",
    "playbookContentId3": "CrowdStrike_ContainHost",
    "_playbookContentId3": "[variables('playbookContentId3')]",
    "playbookId3": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId3'))]",
    "playbookTemplateSpecName3": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId3'))))]",
    "_playbookcontentProductId3": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId3'),'-', variables('playbookVersion3'))))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdStrike Falcon Endpoint Protection data connector with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "CrowdStrike Falcon Data Replicator (CrowdStrike Managed AWS-S3) (using Azure Functions)",
                  "publisher": "Crowdstrike",
                  "descriptionMarkdown": "This connector enables the ingestion of FDR data into Microsoft Sentinel using Azure Functions to support the assessment of potential security risks, analysis of collaboration activities, identification of configuration issues, and other operational insights.<p><span style='color:red; font-weight:bold;'>NOTE:</span></p><div style='margin-left:20px;'><p>1. CrowdStrike FDR license must be available & enabled.</p><p>2. The connector uses a Key & Secret based authentication and is suitable for CrowdStrike Managed buckets.</p><p>3. For environments that use a fully owned AWS S3 bucket, Microsoft recommends using the <strong>CrowdStrike Falcon Data Replicator (AWS S3)</strong> connector.</p></div>",
                  "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **CrowdstrikeReplicator** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-crowdstrikereplicator-parser).",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "CrowdStrikeReplicatorV2",
                      "baseQuery": "CrowdStrikeReplicatorV2"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Data Replicator - All Activities",
                      "query": "CrowdStrikeReplicatorV2 \n | sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CrowdStrike_Additional_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Additional_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimNetworkSessionLogs",
                      "lastDataReceivedQuery": "ASimNetworkSessionLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimDnsActivityLogs",
                      "lastDataReceivedQuery": "ASimDnsActivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimAuditEventLogs",
                      "lastDataReceivedQuery": "ASimAuditEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimFileEventLogs",
                      "lastDataReceivedQuery": "ASimFileEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimAuthenticationEventLogs",
                      "lastDataReceivedQuery": "ASimAuthenticationEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimProcessEventLogs",
                      "lastDataReceivedQuery": "ASimProcessEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimRegistryEventLogs",
                      "lastDataReceivedQuery": "ASimRegistryEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "ASimUserManagementActivityLogs",
                      "lastDataReceivedQuery": "ASimUserManagementActivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Secondary_Data_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Secondary_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "CrowdStrikeReplicatorV2(starttime=ago(3d)) \n    |take 1\n   | project IsConnected = true  "
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "SQS and AWS S3 account credentials/permissions",
                        "description": "**AWS_SECRET**, **AWS_REGION_NAME**, **AWS_KEY**, **QUEUE_URL** is required.  [See the documentation to learn more about data pulling](https://www.crowdstrike.com/blog/tech-center/intro-to-falcon-data-replicator/). To start, contact CrowdStrike support. At your request they will create a CrowdStrike managed Amazon Web Services (AWS) S3 bucket for short term storage purposes as well as a SQS (simple queue service) account for monitoring changes to the S3 bucket."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to the AWS SQS / S3 to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details.\n\n>**(Optional Step)** Securely store API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "1. Configure FDR in CrowdStrike - You must contact the [CrowdStrike support team](https://supportportal.crowdstrike.com/) to enable CrowdStrike FDR.\n\t - Once CrowdStrike FDR is enabled,  from the CrowdStrike console, navigate to Support --> API Clients and Keys. \n\t - You need to Create new credentials to copy the AWS Access Key ID, AWS Secret Access Key, SQS Queue URL and AWS Region. \n2.  Register AAD application - For DCR to authentiate to ingest data into log analytics, you must use AAD application. \n\t - [Follow the instructions here](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-azure-ad-application) (steps 1-5) to get **AAD Tenant Id**, **AAD Client Id** and **AAD Client Secret**. \n\t - For **AAD Principal** Id of this application, access the AAD App through [AAD Portal](https://aad.portal.azure.com/#view/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/~/AppAppsPreview/menuId/) and capture Object Id from the application overview page.",
                      "title": "Prerequisites"
                    },
                    {
                      "description": "Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function",
                      "title": "Deployment Options"
                    },
                    {
                      "description": "Use this method for automated deployment of the Crowdstrike Falcon Data Replicator connector V2 using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy-gov) \t\t\t\n2. Provide the required details such as Microsoft Sentinel Workspace, CrowdStrike AWS credentials, Azure AD Application details and ingestion configurations \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group. It is recommended to create a new Resource Group for deployment of function app and associated resources.\n3. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n4. Click **Purchase** to deploy.",
                      "title": "Option 1 - Azure Resource Manager (ARM) Template"
                    },
                    {
                      "description": "Use the following step-by-step instructions to deploy the Crowdstrike Falcon Data Replicator connector manually with Azure Functions (Deployment via Visual Studio Code).",
                      "title": "Option 2 - Manual Deployment of Azure Functions"
                    },
                    {
                      "description": "**1. Deploy DCE, DCR and Custom Tables for data ingestion**\n\n1. Deploy the required DCE,  DCR(s) and the Custom Tables by using the [Data Collection Resource ARM template](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy-data-resource) \n2. After successful deployment of DCE and DCR(s), get the below information and keep it handy (required during Azure Functions app deployment).\n\t - DCE log ingestion - Follow the instructions available at [Create data collection endpoint](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-data-collection-endpoint) (Step 3).\n\t - Immutable Ids of one or more DCRs (as applicable) - Follow the instructions available at [Collect information from the DCR](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#collect-information-from-the-dcr) (Stpe 2)."
                    },
                    {
                      "description": "**2. Deploy a Function App**\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                    },
                    {
                      "description": "**3. Configure the Function App**\n\n1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select ** New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAWS_KEY\n\t\tAWS_SECRET\n\t\tAWS_REGION_NAME\n\t\tQUEUE_URL\n\t\tUSER_SELECTION_REQUIRE_RAW //True if raw data is required\n\t\tUSER_SELECTION_REQUIRE_SECONDARY //True if secondary data is required\n\t\tMAX_QUEUE_MESSAGES_MAIN_QUEUE // 100 for consumption and 150 for Premium\n\t\tMAX_SCRIPT_EXEC_TIME_MINUTES // add the value of 10 here\n\t\tAZURE_TENANT_ID\n\t\tAZURE_CLIENT_ID\n\t\tAZURE_CLIENT_SECRET\n\t\tDCE_INGESTION_ENDPOINT\n\t\tNORMALIZED_DCR_ID\n\t\tRAW_DATA_DCR_ID\n\t\tEVENT_TO_TABLE_MAPPING_LINK // File is present on github. Add if the file can be accessed using internet\n\t\tREQUIRED_FIELDS_SCHEMA_LINK //File is present on github. Add if the file can be accessed using internet\n\t\tSchedule //Add value as '0 */1 * * * *' to ensure the function runs every minute.\n5. Once all application settings have been entered, click **Save**."
                    }
                  ],
                  "metadata": {
                    "version": "1.0.1"
                  }
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "CrowdStrike Falcon Data Replicator (CrowdStrike Managed AWS-S3) (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "CrowdStrike Falcon Endpoint Protection",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "CrowdStrike Falcon Data Replicator (CrowdStrike Managed AWS-S3) (using Azure Functions)",
          "publisher": "Crowdstrike",
          "descriptionMarkdown": "This connector enables the ingestion of FDR data into Microsoft Sentinel using Azure Functions to support the assessment of potential security risks, analysis of collaboration activities, identification of configuration issues, and other operational insights.<p><span style='color:red; font-weight:bold;'>NOTE:</span></p><div style='margin-left:20px;'><p>1. CrowdStrike FDR license must be available & enabled.</p><p>2. The connector uses a Key & Secret based authentication and is suitable for CrowdStrike Managed buckets.</p><p>3. For environments that use a fully owned AWS S3 bucket, Microsoft recommends using the <strong>CrowdStrike Falcon Data Replicator (AWS S3)</strong> connector.</p></div>",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "CrowdStrikeReplicatorV2",
              "baseQuery": "CrowdStrikeReplicatorV2"
            }
          ],
          "dataTypes": [
            {
              "name": "CrowdStrike_Additional_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Additional_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimNetworkSessionLogs",
              "lastDataReceivedQuery": "ASimNetworkSessionLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimDnsActivityLogs",
              "lastDataReceivedQuery": "ASimDnsActivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimAuditEventLogs",
              "lastDataReceivedQuery": "ASimAuditEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimFileEventLogs",
              "lastDataReceivedQuery": "ASimFileEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimAuthenticationEventLogs",
              "lastDataReceivedQuery": "ASimAuthenticationEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimProcessEventLogs",
              "lastDataReceivedQuery": "ASimProcessEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimRegistryEventLogs",
              "lastDataReceivedQuery": "ASimRegistryEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "ASimUserManagementActivityLogs",
              "lastDataReceivedQuery": "ASimUserManagementActivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Secondary_Data_CL",
              "lastDataReceivedQuery": "CrowdStrike_Secondary_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "CrowdStrikeReplicatorV2(starttime=ago(3d)) \n    |take 1\n   | project IsConnected = true  "
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Data Replicator - All Activities",
              "query": "CrowdStrikeReplicatorV2 \n | sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "SQS and AWS S3 account credentials/permissions",
                "description": "**AWS_SECRET**, **AWS_REGION_NAME**, **AWS_KEY**, **QUEUE_URL** is required.  [See the documentation to learn more about data pulling](https://www.crowdstrike.com/blog/tech-center/intro-to-falcon-data-replicator/). To start, contact CrowdStrike support. At your request they will create a CrowdStrike managed Amazon Web Services (AWS) S3 bucket for short term storage purposes as well as a SQS (simple queue service) account for monitoring changes to the S3 bucket."
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to the AWS SQS / S3 to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details.\n\n>**(Optional Step)** Securely store API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "1. Configure FDR in CrowdStrike - You must contact the [CrowdStrike support team](https://supportportal.crowdstrike.com/) to enable CrowdStrike FDR.\n\t - Once CrowdStrike FDR is enabled,  from the CrowdStrike console, navigate to Support --> API Clients and Keys. \n\t - You need to Create new credentials to copy the AWS Access Key ID, AWS Secret Access Key, SQS Queue URL and AWS Region. \n2.  Register AAD application - For DCR to authentiate to ingest data into log analytics, you must use AAD application. \n\t - [Follow the instructions here](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-azure-ad-application) (steps 1-5) to get **AAD Tenant Id**, **AAD Client Id** and **AAD Client Secret**. \n\t - For **AAD Principal** Id of this application, access the AAD App through [AAD Portal](https://aad.portal.azure.com/#view/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/~/AppAppsPreview/menuId/) and capture Object Id from the application overview page.",
              "title": "Prerequisites"
            },
            {
              "description": "Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function",
              "title": "Deployment Options"
            },
            {
              "description": "Use this method for automated deployment of the Crowdstrike Falcon Data Replicator connector V2 using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy-gov) \t\t\t\n2. Provide the required details such as Microsoft Sentinel Workspace, CrowdStrike AWS credentials, Azure AD Application details and ingestion configurations \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group. It is recommended to create a new Resource Group for deployment of function app and associated resources.\n3. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n4. Click **Purchase** to deploy.",
              "title": "Option 1 - Azure Resource Manager (ARM) Template"
            },
            {
              "description": "Use the following step-by-step instructions to deploy the Crowdstrike Falcon Data Replicator connector manually with Azure Functions (Deployment via Visual Studio Code).",
              "title": "Option 2 - Manual Deployment of Azure Functions"
            },
            {
              "description": "**1. Deploy DCE, DCR and Custom Tables for data ingestion**\n\n1. Deploy the required DCE,  DCR(s) and the Custom Tables by using the [Data Collection Resource ARM template](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy-data-resource) \n2. After successful deployment of DCE and DCR(s), get the below information and keep it handy (required during Azure Functions app deployment).\n\t - DCE log ingestion - Follow the instructions available at [Create data collection endpoint](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-data-collection-endpoint) (Step 3).\n\t - Immutable Ids of one or more DCRs (as applicable) - Follow the instructions available at [Collect information from the DCR](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#collect-information-from-the-dcr) (Stpe 2)."
            },
            {
              "description": "**2. Deploy a Function App**\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
            },
            {
              "description": "**3. Configure the Function App**\n\n1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select ** New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAWS_KEY\n\t\tAWS_SECRET\n\t\tAWS_REGION_NAME\n\t\tQUEUE_URL\n\t\tUSER_SELECTION_REQUIRE_RAW //True if raw data is required\n\t\tUSER_SELECTION_REQUIRE_SECONDARY //True if secondary data is required\n\t\tMAX_QUEUE_MESSAGES_MAIN_QUEUE // 100 for consumption and 150 for Premium\n\t\tMAX_SCRIPT_EXEC_TIME_MINUTES // add the value of 10 here\n\t\tAZURE_TENANT_ID\n\t\tAZURE_CLIENT_ID\n\t\tAZURE_CLIENT_SECRET\n\t\tDCE_INGESTION_ENDPOINT\n\t\tNORMALIZED_DCR_ID\n\t\tRAW_DATA_DCR_ID\n\t\tEVENT_TO_TABLE_MAPPING_LINK // File is present on github. Add if the file can be accessed using internet\n\t\tREQUIRED_FIELDS_SCHEMA_LINK //File is present on github. Add if the file can be accessed using internet\n\t\tSchedule //Add value as '0 */1 * * * *' to ensure the function runs every minute.\n5. Once all application settings have been entered, click **Save**."
            }
          ],
          "id": "[variables('_uiConfigId1')]",
          "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **CrowdstrikeReplicator** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-crowdstrikereplicator-parser)."
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdStrike Falcon Endpoint Protection data connector with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion2')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId2'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId2')]",
                  "title": "CrowdStrike Falcon Adversary Intelligence  (using Azure Functions)",
                  "publisher": "CrowdStrike",
                  "descriptionMarkdown": "The [CrowdStrike](https://www.crowdstrike.com/) Falcon Indicators of Compromise connector retrieves the Indicators of Compromise from the Falcon Intel API and uploads them [Microsoft Sentinel Threat Intel](https://learn.microsoft.com/en-us/azure/sentinel/understand-threat-intelligence).",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "Crowdstrike Indicators of Compromise",
                      "baseQuery": "ThreatIntelligenceIndicator\n            | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Threat Intel - Crowdstrike Indicators of Compromise",
                      "query": "ThreatIntelligenceIndicator\n | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n | sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "IndicatorsOfCompromise",
                      "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n              | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n              | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "ThreatIntelligenceIndicator\n            | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "CrowdStrike API Client ID and Client Secret",
                        "description": "**CROWDSTRIKE_CLIENT_ID**, **CROWDSTRIKE_CLIENT_SECRET**, **CROWDSTRIKE_BASE_URL**. CrowdStrike credentials must have Indicators (Falcon Intelligence) read scope."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": "**STEP 1 - [Generate CrowdStrike API credentials](https://www.crowdstrike.com/blog/tech-center/get-access-falcon-apis/).**\n"
                    },
                    {
                      "description": "Make sure 'Indicators (Falcon Intelligence)' scope has 'read' selected"
                    },
                    {
                      "description": "**STEP 2 - [Register an Entra App](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app) with client secret.**\n"
                    },
                    {
                      "description": "Provide the Entra App principal with 'Microsoft Sentinel Contributor' role assignment on the respective log analytics workspace. [How to assign roles on Azure](https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal)."
                    },
                    {
                      "description": "**STEP 3 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the CrowdStrike Falcon Indicator of Compromise connector, have the Workspace ID (can be copied from the following).",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Use this method for automated deployment of the CrowdStrike Falcon Adversary Intelligence connector connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CrowdStrikeFalconAdversaryIntelligence-azuredeploy)\n2. Provide the following parameters: CrowdStrikeClientId, CrowdStrikeClientSecret, CrowdStrikeBaseUrl, WorkspaceId, TenantId, Indicators, AadClientId, AadClientSecret, LookBackDays",
                      "title": "Option 1 - Azure Resource Manager (ARM) Template"
                    },
                    {
                      "description": "Use the following step-by-step instructions to deploy the CrowdStrike Falcon Adversary Intelligence connector manually with Azure Functions (Deployment via Visual Studio Code).",
                      "title": "Option 2 - Manual Deployment of Azure Functions"
                    },
                    {
                      "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CrowdStrikeFalconAdversaryIntelligence-Functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CrowdStrikeFalconIOCXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.12.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
                    },
                    {
                      "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCROWDSTRIKE_CLIENT_ID\n\t\tCROWDSTRIKE_CLIENT_SECRET\n\t\tCROWDSTRIKE_BASE_URL\n\t\tTENANT_ID\n\t\tINDICATORS\n\t\tWorkspaceKey\n\t\tAAD_CLIENT_ID\n\t\tAAD_CLIENT_SECRET \n\t\tLOOK_BACK_DAYS \n\t\tWORKSPACE_ID  \n4. Once all application settings have been entered, click **Save**."
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId2'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
                "contentId": "[variables('_dataConnectorContentId2')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId2')]",
        "contentKind": "DataConnector",
        "displayName": "CrowdStrike Falcon Adversary Intelligence  (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId2')]",
        "id": "[variables('_dataConnectorcontentProductId2')]",
        "version": "[variables('dataConnectorVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId2'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId2')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
        "contentId": "[variables('_dataConnectorContentId2')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion2')]",
        "source": {
          "kind": "Solution",
          "name": "CrowdStrike Falcon Endpoint Protection",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId2'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "CrowdStrike Falcon Adversary Intelligence  (using Azure Functions)",
          "publisher": "CrowdStrike",
          "descriptionMarkdown": "The [CrowdStrike](https://www.crowdstrike.com/) Falcon Indicators of Compromise connector retrieves the Indicators of Compromise from the Falcon Intel API and uploads them [Microsoft Sentinel Threat Intel](https://learn.microsoft.com/en-us/azure/sentinel/understand-threat-intelligence).",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "Crowdstrike Indicators of Compromise",
              "baseQuery": "ThreatIntelligenceIndicator\n            | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'"
            }
          ],
          "dataTypes": [
            {
              "name": "IndicatorsOfCompromise",
              "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n              | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n              | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "ThreatIntelligenceIndicator\n            | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Threat Intel - Crowdstrike Indicators of Compromise",
              "query": "ThreatIntelligenceIndicator\n | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n | sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "CrowdStrike API Client ID and Client Secret",
                "description": "**CROWDSTRIKE_CLIENT_ID**, **CROWDSTRIKE_CLIENT_SECRET**, **CROWDSTRIKE_BASE_URL**. CrowdStrike credentials must have Indicators (Falcon Intelligence) read scope."
              }
            ]
          },
          "instructionSteps": [
            {
              "description": "**STEP 1 - [Generate CrowdStrike API credentials](https://www.crowdstrike.com/blog/tech-center/get-access-falcon-apis/).**\n"
            },
            {
              "description": "Make sure 'Indicators (Falcon Intelligence)' scope has 'read' selected"
            },
            {
              "description": "**STEP 2 - [Register an Entra App](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app) with client secret.**\n"
            },
            {
              "description": "Provide the Entra App principal with 'Microsoft Sentinel Contributor' role assignment on the respective log analytics workspace. [How to assign roles on Azure](https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal)."
            },
            {
              "description": "**STEP 3 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the CrowdStrike Falcon Indicator of Compromise connector, have the Workspace ID (can be copied from the following).",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Use this method for automated deployment of the CrowdStrike Falcon Adversary Intelligence connector connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CrowdStrikeFalconAdversaryIntelligence-azuredeploy)\n2. Provide the following parameters: CrowdStrikeClientId, CrowdStrikeClientSecret, CrowdStrikeBaseUrl, WorkspaceId, TenantId, Indicators, AadClientId, AadClientSecret, LookBackDays",
              "title": "Option 1 - Azure Resource Manager (ARM) Template"
            },
            {
              "description": "Use the following step-by-step instructions to deploy the CrowdStrike Falcon Adversary Intelligence connector manually with Azure Functions (Deployment via Visual Studio Code).",
              "title": "Option 2 - Manual Deployment of Azure Functions"
            },
            {
              "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CrowdStrikeFalconAdversaryIntelligence-Functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CrowdStrikeFalconIOCXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.12.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
            },
            {
              "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCROWDSTRIKE_CLIENT_ID\n\t\tCROWDSTRIKE_CLIENT_SECRET\n\t\tCROWDSTRIKE_BASE_URL\n\t\tTENANT_ID\n\t\tINDICATORS\n\t\tWorkspaceKey\n\t\tAAD_CLIENT_ID\n\t\tAAD_CLIENT_SECRET \n\t\tLOOK_BACK_DAYS \n\t\tWORKSPACE_ID  \n4. Once all application settings have been entered, click **Save**."
            }
          ],
          "id": "[variables('_uiConfigId2')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition3'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition3')]",
        "displayName": "CrowdStrike Falcon Data Replicator (AWS S3) (via Codeless Connector Framework)",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition3'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "CrowdStrikeFalconS3CCPDefinition",
                  "title": "CrowdStrike Falcon Data Replicator (AWS S3) (via Codeless Connector Framework)",
                  "publisher": "Microsoft",
                  "descriptionMarkdown": "The Crowdstrike Falcon Data Replicator (S3) connector provides the capability to ingest FDR event datainto Microsoft Sentinel from the AWS S3 bucket where the FDR logs have been streamed. The connector provides ability to get events from Falcon Agents which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.<p><span style='color:red; font-weight:bold;'>NOTE:</span></p><div style='margin-left:20px;'><p>1. CrowdStrike FDR license must be available & enabled.</p><p>2. The connector requires an IAM role to be configured on AWS to allow access to the AWS S3 bucket and may not be suitable for environments that leverage CrowdStrike - managed buckets.</p><p>3. For environments that leverage CrowdStrike-managed buckets, please configure the <strong>CrowdStrike Falcon Data Replicator (CrowdStrike-Managed AWS S3)</strong> connector.</p></div>",
                  "graphQueriesTableName": "CrowdStrike_Additional_Events_CL",
                  "graphQueries": [
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 User Logs",
                      "baseQuery": "CrowdStrike_User_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Secondary Logs",
                      "baseQuery": "CrowdStrike_Secondary_Data_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Additional Logs",
                      "baseQuery": "CrowdStrike_Additional_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Auth Logs",
                      "baseQuery": "CrowdStrike_Auth_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Registry Logs ",
                      "baseQuery": "CrowdStrike_Registry_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Process Logs",
                      "baseQuery": "CrowdStrike_Process_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Network Logs",
                      "baseQuery": "CrowdStrike_Network_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 File Logs",
                      "baseQuery": "CrowdStrike_File_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Audit Logs",
                      "baseQuery": "CrowdStrike_Audit_Events_CL"
                    },
                    {
                      "metricName": "Total events received",
                      "legend": "CrowdStrike Falcon S3 Logs Test",
                      "baseQuery": "CrowdStrike_DNS_Events_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_User_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Additional_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Registry_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Process_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Network_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Audit_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Auth_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_File_Events_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_Secondary_Data_CL\n | take 10"
                    },
                    {
                      "description": "Get Sample of CrowdStrike Falcon S3 Logs",
                      "query": "CrowdStrike_DNS_Events_CL\n | take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "CrowdStrike_User_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_User_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Additional_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Additional_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Registry_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Registry_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Process_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Process_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Network_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Network_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_File_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_File_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_DNS_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_DNS_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Auth_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Auth_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Secondary_Data_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Secondary_Data_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrike_Audit_Events_CL",
                      "lastDataReceivedQuery": "CrowdStrike_Audit_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "read": true,
                          "write": true,
                          "delete": true,
                          "action": false
                        }
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "instructions": [
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### Requirements: \n In order to use the Falcon Data Replicator feature the following are required: \n 1. **Subscription:** \n 1.1.  Falcon Data Replicator. \n 1.2. Falcon Insight XDR. \n 2. **Roles:** \n 2.1. Falcon Administrator."
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### 1. Setup your CrowdStrike & AWS environments \n To configure access on AWS, use the following two templates provided to set up the AWS environment. This will enable sending logs from an S3 bucket to your Log Analytics Workspace.\n #### For each template, create Stack in AWS: \n 1. Go to [AWS CloudFormation Stacks](https://aka.ms/awsCloudFormationLink#/stacks/create). \n 2. Choose the Specify template option, then Upload a template file by clicking on Choose file and selecting the appropriate CloudFormation template file provided below. click Choose file and select the downloaded template. \n 3. Click 'Next' and 'Create stack'."
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "Make sure that your bucket will be created in the same AWS region as your Falcon CID where the FDR feed is provisioned. \n | CrowdStrike region | AWS region | \n |-----------------|-----------|\n | US-1 | us-west-1    |\n | US-2 | us-west-2 | \n | EU-1 | eu-central-1 "
                          }
                        },
                        {
                          "type": "CopyableLabel",
                          "parameters": {
                            "label": "Template 1: OpenID connect authentication deployment",
                            "isMultiLine": true,
                            "fillWith": [
                              "Oidc"
                            ]
                          }
                        },
                        {
                          "type": "CopyableLabel",
                          "parameters": {
                            "label": "Template 2: AWS CrowdStrike resources deployment",
                            "isMultiLine": true,
                            "fillWith": [
                              "CrowdStrike"
                            ]
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### Using your own S3 Bucket \n In order to use your own S3 bucket you can refernace the following guide [Use your own S3 bucket](https://falcon.us-2.crowdstrike.com/documentation/page/fa572b1c/falcon-data-replicator#g4f79236) or follow this steps: \n 1. Create support case with the following Name: **Using Self S3 bucket for FDR** \n 2. Add the following information: \n 2.1. The Falcon CID where your FDR feed is provisioned \n 2.2. Indicate which types of events you wish to have provided in this new FDR feed. \n 2.3. Indicate which types of events you wish to have provided in this new FDR feed. \n 2.4. Do not use any partitions. "
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": " | Event type      | S3 prefix | \n |-----------------|-----------|\n | Primary Events | data/    |\n | Secondary Events | fdrv2/ "
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### 2. Connect new collectors \n To enable AWS S3 for Microsoft Sentinel, click the Add new collector button, fill the required information in the context pane and click on Connect."
                          }
                        },
                        {
                          "type": "DataConnectorsGrid",
                          "parameters": {
                            "mapping": [
                              {
                                "columnValue": "properties.roleArn",
                                "columnName": "Role ARN"
                              },
                              {
                                "columnValue": "properties.sqsUrls[0]",
                                "columnName": "Queue URL"
                              },
                              {
                                "columnValue": "properties.dcrConfig.streamName",
                                "columnName": "Stream name"
                              }
                            ],
                            "menuItems": [
                              "DeleteConnector"
                            ]
                          }
                        },
                        {
                          "type": "ContextPane",
                          "parameters": {
                            "contextPaneType": "DataConnectorsContextPane",
                            "title": "Add new controller",
                            "subtitle": "AWS S3 connector",
                            "label": "Add new collector",
                            "instructionSteps": [
                              {
                                "title": "Account details",
                                "instructions": [
                                  {
                                    "type": "Textbox",
                                    "parameters": {
                                      "label": "Role ARN",
                                      "type": "text",
                                      "name": "roleArn",
                                      "validations": {
                                        "required": true
                                      }
                                    }
                                  },
                                  {
                                    "type": "Textbox",
                                    "parameters": {
                                      "label": "Queue URL",
                                      "type": "text",
                                      "name": "queueUrl",
                                      "validations": {
                                        "required": true
                                      }
                                    }
                                  },
                                  {
                                    "type": "Dropdown",
                                    "parameters": {
                                      "label": "Data type",
                                      "type": "text",
                                      "name": "streamName",
                                      "required": true,
                                      "placeholder": "Select a data type",
                                      "options": [
                                        {
                                          "key": "Custom-CrowdstrikeStream",
                                          "text": "Primary Events"
                                        },
                                        {
                                          "key": "Custom-CrowdStrikeSecondary",
                                          "text": "Secondary Events"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ],
                  "isConnectivityCriteriasMatchSome": false
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition3')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition3'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition3')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections3')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "crowdStrikeFalconS3DCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "streamDeclarations": {
                  "Custom-CrowdstrikeStream": {
                    "columns": [
                      {
                        "name": "event_simpleName",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "string"
                      },
                      {
                        "name": "aip",
                        "type": "string"
                      },
                      {
                        "name": "aid",
                        "type": "string"
                      },
                      {
                        "name": "UserName",
                        "type": "string"
                      },
                      {
                        "name": "event_platform",
                        "type": "string"
                      },
                      {
                        "name": "ContextTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "name",
                        "type": "string"
                      },
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "ContextProcessId",
                        "type": "string"
                      },
                      {
                        "name": "ContextThreadId",
                        "type": "string"
                      },
                      {
                        "name": "Entitlements",
                        "type": "string"
                      },
                      {
                        "name": "cid",
                        "type": "string"
                      },
                      {
                        "name": "OciContainerId",
                        "type": "string"
                      },
                      {
                        "name": "TreeId",
                        "type": "string"
                      },
                      {
                        "name": "DomainName",
                        "type": "string"
                      },
                      {
                        "name": "RequestType",
                        "type": "string"
                      },
                      {
                        "name": "IP4Records",
                        "type": "string"
                      },
                      {
                        "name": "QueryStatus",
                        "type": "string"
                      },
                      {
                        "name": "FirstIP4Record",
                        "type": "string"
                      },
                      {
                        "name": "DnsRequestCount",
                        "type": "string"
                      },
                      {
                        "name": "IP6Records",
                        "type": "string"
                      },
                      {
                        "name": "InterfaceIndex",
                        "type": "string"
                      },
                      {
                        "name": "DualRequest",
                        "type": "string"
                      },
                      {
                        "name": "DnsResponseType",
                        "type": "string"
                      },
                      {
                        "name": "EventOrigin",
                        "type": "string"
                      },
                      {
                        "name": "RespondingDnsServer",
                        "type": "string"
                      },
                      {
                        "name": "CNAMERecords",
                        "type": "string"
                      },
                      {
                        "name": "FirstIP6Record",
                        "type": "string"
                      },
                      {
                        "name": "AdditionalFields",
                        "type": "string"
                      },
                      {
                        "name": "CloudErrorCode",
                        "type": "string"
                      },
                      {
                        "name": "LogonType",
                        "type": "string"
                      },
                      {
                        "name": "UserPrincipal",
                        "type": "string"
                      },
                      {
                        "name": "UserIsAdmin",
                        "type": "string"
                      },
                      {
                        "name": "LogonTime",
                        "type": "string"
                      },
                      {
                        "name": "LogonDomain",
                        "type": "string"
                      },
                      {
                        "name": "RemoteAccount",
                        "type": "string"
                      },
                      {
                        "name": "UserSid",
                        "type": "string"
                      },
                      {
                        "name": "UserFlags",
                        "type": "string"
                      },
                      {
                        "name": "LogonServer",
                        "type": "string"
                      },
                      {
                        "name": "LogonId",
                        "type": "string"
                      },
                      {
                        "name": "SessionId",
                        "type": "string"
                      },
                      {
                        "name": "AuthenticationPackage",
                        "type": "string"
                      },
                      {
                        "name": "AuthenticationId",
                        "type": "string"
                      },
                      {
                        "name": "PasswordLastSet",
                        "type": "string"
                      },
                      {
                        "name": "UserLogonFlags",
                        "type": "string"
                      },
                      {
                        "name": "LoginSessionId",
                        "type": "string"
                      },
                      {
                        "name": "UID",
                        "type": "string"
                      },
                      {
                        "name": "AuthenticationUuid",
                        "type": "string"
                      },
                      {
                        "name": "AuthenticationIdMac",
                        "type": "string"
                      },
                      {
                        "name": "CommandLine",
                        "type": "string"
                      },
                      {
                        "name": "ClientComputerName",
                        "type": "string"
                      },
                      {
                        "name": "WmiConsumerType",
                        "type": "string"
                      },
                      {
                        "name": "WmiFilterType",
                        "type": "string"
                      },
                      {
                        "name": "EtwRawProcessId",
                        "type": "string"
                      },
                      {
                        "name": "ImageFileName",
                        "type": "string"
                      },
                      {
                        "name": "OriginalParentAuthenticationId",
                        "type": "string"
                      },
                      {
                        "name": "ParentAuthenticationId",
                        "type": "string"
                      },
                      {
                        "name": "OriginalUserSid",
                        "type": "string"
                      },
                      {
                        "name": "SHA256HashData",
                        "type": "string"
                      },
                      {
                        "name": "TargetFileName",
                        "type": "string"
                      },
                      {
                        "name": "Status",
                        "type": "string"
                      },
                      {
                        "name": "ErrorText",
                        "type": "string"
                      },
                      {
                        "name": "WmiProviderType",
                        "type": "string"
                      },
                      {
                        "name": "RawProcessId",
                        "type": "string"
                      },
                      {
                        "name": "UmppaInjectionType",
                        "type": "string"
                      },
                      {
                        "name": "ErrorStatus",
                        "type": "string"
                      },
                      {
                        "name": "SourceFileName",
                        "type": "string"
                      },
                      {
                        "name": "WmiQuery",
                        "type": "string"
                      },
                      {
                        "name": "WmiNamespaceName",
                        "type": "string"
                      },
                      {
                        "name": "ServiceDisplayName",
                        "type": "string"
                      },
                      {
                        "name": "ErrorCode",
                        "type": "string"
                      },
                      {
                        "name": "TargetProcessId",
                        "type": "string"
                      },
                      {
                        "name": "TokenType",
                        "type": "string"
                      },
                      {
                        "name": "InterfaceGuid",
                        "type": "string"
                      },
                      {
                        "name": "RpcClientProcessId",
                        "type": "string"
                      },
                      {
                        "name": "RpcClientThreadId",
                        "type": "string"
                      },
                      {
                        "name": "SourceProcessId",
                        "type": "string"
                      },
                      {
                        "name": "EtwRawThreadId",
                        "type": "string"
                      },
                      {
                        "name": "SourceThreadId",
                        "type": "string"
                      },
                      {
                        "name": "RawThreadId",
                        "type": "string"
                      },
                      {
                        "name": "OriginalContentLength",
                        "type": "string"
                      },
                      {
                        "name": "ContentSHA256HashData",
                        "type": "string"
                      },
                      {
                        "name": "ScriptContentName",
                        "type": "string"
                      },
                      {
                        "name": "HostProcessType",
                        "type": "string"
                      },
                      {
                        "name": "ParentCommandLine",
                        "type": "string"
                      },
                      {
                        "name": "ParentImageFileName",
                        "type": "string"
                      },
                      {
                        "name": "GrandparentImageFileName",
                        "type": "string"
                      },
                      {
                        "name": "GrandparentCommandLine",
                        "type": "string"
                      },
                      {
                        "name": "ScriptContentBytes",
                        "type": "string"
                      },
                      {
                        "name": "ExecutableBytes",
                        "type": "string"
                      },
                      {
                        "name": "CallStackModuleNames",
                        "type": "string"
                      },
                      {
                        "name": "KernelTime",
                        "type": "string"
                      },
                      {
                        "name": "ScriptContentSource",
                        "type": "string"
                      },
                      {
                        "name": "OriginalFilename",
                        "type": "string"
                      },
                      {
                        "name": "ScreenshotType",
                        "type": "string"
                      },
                      {
                        "name": "TaskName",
                        "type": "string"
                      },
                      {
                        "name": "TaskExecCommand",
                        "type": "string"
                      },
                      {
                        "name": "TaskXml",
                        "type": "string"
                      },
                      {
                        "name": "TaskExecArguments",
                        "type": "string"
                      },
                      {
                        "name": "KeyObject",
                        "type": "string"
                      },
                      {
                        "name": "PublicKeys",
                        "type": "string"
                      },
                      {
                        "name": "RegPostObjectName",
                        "type": "string"
                      },
                      {
                        "name": "RegKeyName",
                        "type": "string"
                      },
                      {
                        "name": "RegRootObjectName",
                        "type": "string"
                      },
                      {
                        "name": "ExtendedKeyUsages",
                        "type": "string"
                      },
                      {
                        "name": "RegCreateDisposition",
                        "type": "string"
                      },
                      {
                        "name": "FileSigningTime",
                        "type": "string"
                      },
                      {
                        "name": "RegCreateOptions",
                        "type": "string"
                      },
                      {
                        "name": "SignInfoFlags",
                        "type": "string"
                      },
                      {
                        "name": "Certificate",
                        "type": "string"
                      },
                      {
                        "name": "OdsActionType",
                        "type": "string"
                      },
                      {
                        "name": "FileSubType",
                        "type": "string"
                      },
                      {
                        "name": "TargetAddress",
                        "type": "string"
                      },
                      {
                        "name": "Size",
                        "type": "string"
                      },
                      {
                        "name": "CompanyName",
                        "type": "string"
                      },
                      {
                        "name": "FileVersion",
                        "type": "string"
                      },
                      {
                        "name": "ProductSku",
                        "type": "string"
                      },
                      {
                        "name": "ProductName",
                        "type": "string"
                      },
                      {
                        "name": "EventMax",
                        "type": "string"
                      },
                      {
                        "name": "PlatformId",
                        "type": "string"
                      },
                      {
                        "name": "BuildType",
                        "type": "string"
                      },
                      {
                        "name": "ProductType",
                        "type": "string"
                      },
                      {
                        "name": "AttemptNumber",
                        "type": "string"
                      },
                      {
                        "name": "OSVersionFileData",
                        "type": "string"
                      },
                      {
                        "name": "OSVersionString",
                        "type": "string"
                      },
                      {
                        "name": "OSVersionFileName",
                        "type": "string"
                      },
                      {
                        "name": "IntegrityLevel",
                        "type": "string"
                      },
                      {
                        "name": "RemotePort",
                        "type": "string"
                      },
                      {
                        "name": "Protocol",
                        "type": "string"
                      },
                      {
                        "name": "VolumeDeviceType",
                        "type": "string"
                      },
                      {
                        "name": "VolumeName",
                        "type": "string"
                      },
                      {
                        "name": "VolumeDeviceObjectFlags",
                        "type": "string"
                      },
                      {
                        "name": "Length",
                        "type": "string"
                      },
                      {
                        "name": "ServiceObjectName",
                        "type": "string"
                      },
                      {
                        "name": "ServiceDescription",
                        "type": "string"
                      },
                      {
                        "name": "ServiceSecurity",
                        "type": "string"
                      },
                      {
                        "name": "ServiceImagePath",
                        "type": "string"
                      },
                      {
                        "name": "ServiceStart",
                        "type": "string"
                      },
                      {
                        "name": "ServiceType",
                        "type": "string"
                      },
                      {
                        "name": "ServiceFailureActions",
                        "type": "string"
                      },
                      {
                        "name": "ServiceErrorControl",
                        "type": "string"
                      },
                      {
                        "name": "ServiceGroup",
                        "type": "string"
                      },
                      {
                        "name": "ProcessIntegrityLevel",
                        "type": "string"
                      },
                      {
                        "name": "MD5HashData",
                        "type": "string"
                      },
                      {
                        "name": "CloudRequestId",
                        "type": "string"
                      },
                      {
                        "name": "VolumeSessionUUID",
                        "type": "string"
                      },
                      {
                        "name": "VolumeFileSystemDevice",
                        "type": "string"
                      },
                      {
                        "name": "VolumeSnapshotName",
                        "type": "string"
                      },
                      {
                        "name": "VolumeIsEncrypted",
                        "type": "string"
                      },
                      {
                        "name": "VolumeFileSystemDriver",
                        "type": "string"
                      },
                      {
                        "name": "VolumeSnapshotTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "VolumeRealDeviceName",
                        "type": "string"
                      },
                      {
                        "name": "VolumeEncryptionStatus",
                        "type": "string"
                      },
                      {
                        "name": "RemoteAddressIP4",
                        "type": "string"
                      },
                      {
                        "name": "IsOnRemovableDisk",
                        "type": "string"
                      },
                      {
                        "name": "QuarantinedFileExtendedState",
                        "type": "string"
                      },
                      {
                        "name": "DeviceId",
                        "type": "string"
                      },
                      {
                        "name": "LocalAddressIP4",
                        "type": "string"
                      },
                      {
                        "name": "NetworkGuid",
                        "type": "string"
                      },
                      {
                        "name": "InterfaceAlias",
                        "type": "string"
                      },
                      {
                        "name": "PermanentPhysicalAddress",
                        "type": "string"
                      },
                      {
                        "name": "InterfaceType",
                        "type": "string"
                      },
                      {
                        "name": "MediaType",
                        "type": "string"
                      },
                      {
                        "name": "AccessType",
                        "type": "string"
                      },
                      {
                        "name": "ConnectionType",
                        "type": "string"
                      },
                      {
                        "name": "PhysicalAddress",
                        "type": "string"
                      },
                      {
                        "name": "DirectionType",
                        "type": "string"
                      },
                      {
                        "name": "CreationTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "BaseReachableTime",
                        "type": "string"
                      },
                      {
                        "name": "TunnelType",
                        "type": "string"
                      },
                      {
                        "name": "NetworkInterfaceGuid",
                        "type": "string"
                      },
                      {
                        "name": "PhysicalMediumType",
                        "type": "string"
                      },
                      {
                        "name": "LocalAddressIP6",
                        "type": "string"
                      },
                      {
                        "name": "DefaultGatewayIP6",
                        "type": "string"
                      },
                      {
                        "name": "ModuleNativePath",
                        "type": "string"
                      },
                      {
                        "name": "DotnetModuleFlags",
                        "type": "string"
                      },
                      {
                        "name": "FirmwareSize",
                        "type": "string"
                      },
                      {
                        "name": "ImageAnalysisRequestTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "FirmwareType",
                        "type": "string"
                      },
                      {
                        "name": "ProcessCount",
                        "type": "string"
                      },
                      {
                        "name": "EtwTargetRawProcessId",
                        "type": "string"
                      },
                      {
                        "name": "MinorFunction",
                        "type": "string"
                      },
                      {
                        "name": "FileObject",
                        "type": "string"
                      },
                      {
                        "name": "MajorFunction",
                        "type": "string"
                      },
                      {
                        "name": "SHA1HashData",
                        "type": "string"
                      },
                      {
                        "name": "SignatureState",
                        "type": "string"
                      },
                      {
                        "name": "AuthenticodeHashData",
                        "type": "string"
                      },
                      {
                        "name": "ToBeSignedAlgorithm",
                        "type": "string"
                      },
                      {
                        "name": "ToBeSignedHash",
                        "type": "string"
                      },
                      {
                        "name": "SignInfoRequestFlags",
                        "type": "string"
                      },
                      {
                        "name": "HashAlgorithm",
                        "type": "string"
                      },
                      {
                        "name": "RegObjectName",
                        "type": "string"
                      },
                      {
                        "name": "RegValueName",
                        "type": "string"
                      },
                      {
                        "name": "RegType",
                        "type": "string"
                      },
                      {
                        "name": "RegClassificationIndex",
                        "type": "string"
                      },
                      {
                        "name": "RegClassificationFlags",
                        "type": "string"
                      },
                      {
                        "name": "RegOperationType",
                        "type": "string"
                      },
                      {
                        "name": "RegClassification",
                        "type": "string"
                      },
                      {
                        "name": "RegStringValue",
                        "type": "string"
                      },
                      {
                        "name": "Facility",
                        "type": "string"
                      },
                      {
                        "name": "File",
                        "type": "string"
                      },
                      {
                        "name": "BatchTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "LastUpdateInstalledTime",
                        "type": "string"
                      },
                      {
                        "name": "RawTargetProcessId",
                        "type": "string"
                      },
                      {
                        "name": "TargetThreadId",
                        "type": "string"
                      },
                      {
                        "name": "ApcContextFileName",
                        "type": "string"
                      },
                      {
                        "name": "RawTargetThreadId",
                        "type": "string"
                      },
                      {
                        "name": "InjectedThreadFlag",
                        "type": "string"
                      },
                      {
                        "name": "DownloadServer",
                        "type": "string"
                      },
                      {
                        "name": "DownloadPath",
                        "type": "string"
                      },
                      {
                        "name": "DownloadPort",
                        "type": "string"
                      },
                      {
                        "name": "RuleMatchCount",
                        "type": "string"
                      },
                      {
                        "name": "VolumeMountPoint",
                        "type": "string"
                      },
                      {
                        "name": "VolumeDriveLetter",
                        "type": "string"
                      },
                      {
                        "name": "DiskParentDeviceInstanceId",
                        "type": "string"
                      },
                      {
                        "name": "BoundingLimitCount",
                        "type": "string"
                      },
                      {
                        "name": "TargetDirectoryName",
                        "type": "string"
                      },
                      {
                        "name": "ReflectivePeTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "ProcessExecuteFlags",
                        "type": "string"
                      },
                      {
                        "name": "TargetIntegrityLevel",
                        "type": "string"
                      },
                      {
                        "name": "TargetAuthenticationId",
                        "type": "string"
                      },
                      {
                        "name": "ImageBaseName",
                        "type": "string"
                      },
                      {
                        "name": "ConnectionDirection",
                        "type": "string"
                      },
                      {
                        "name": "ConnectionFlags",
                        "type": "string"
                      },
                      {
                        "name": "LocalPort",
                        "type": "string"
                      },
                      {
                        "name": "AppName",
                        "type": "string"
                      },
                      {
                        "name": "AppVersion",
                        "type": "string"
                      },
                      {
                        "name": "UpdateFlag",
                        "type": "string"
                      },
                      {
                        "name": "AppProductId",
                        "type": "string"
                      },
                      {
                        "name": "AppPath",
                        "type": "string"
                      },
                      {
                        "name": "InstallDate",
                        "type": "string"
                      },
                      {
                        "name": "AppType",
                        "type": "string"
                      },
                      {
                        "name": "AppSource",
                        "type": "string"
                      },
                      {
                        "name": "AppProvider",
                        "type": "string"
                      },
                      {
                        "name": "AppIdentificationData",
                        "type": "string"
                      },
                      {
                        "name": "CommandCloudTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "CommandSequenceTotal",
                        "type": "string"
                      },
                      {
                        "name": "CommandCode",
                        "type": "string"
                      },
                      {
                        "name": "CommandEndTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "CommandStartTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "CommandSequenceNumber",
                        "type": "string"
                      },
                      {
                        "name": "CommandName",
                        "type": "string"
                      },
                      {
                        "name": "CommandStdOut",
                        "type": "string"
                      },
                      {
                        "name": "CommandStdErr",
                        "type": "string"
                      },
                      {
                        "name": "QuarantinedFileState",
                        "type": "string"
                      },
                      {
                        "name": "QuarantinedFileName",
                        "type": "string"
                      },
                      {
                        "name": "FileSystemOperationType",
                        "type": "string"
                      },
                      {
                        "name": "TargetSHA256HashData",
                        "type": "string"
                      },
                      {
                        "name": "TargetCommandLineParameters",
                        "type": "string"
                      },
                      {
                        "name": "RegConfigValueType",
                        "type": "string"
                      },
                      {
                        "name": "RegConfigFlags",
                        "type": "string"
                      },
                      {
                        "name": "RegConfigClass",
                        "type": "string"
                      },
                      {
                        "name": "RegConfigIndex",
                        "type": "string"
                      },
                      {
                        "name": "RegKeyChangeType",
                        "type": "string"
                      },
                      {
                        "name": "Options",
                        "type": "string"
                      },
                      {
                        "name": "Information",
                        "type": "string"
                      },
                      {
                        "name": "FileIdentifier",
                        "type": "string"
                      },
                      {
                        "name": "ShareAccess",
                        "type": "string"
                      },
                      {
                        "name": "FileAttributes",
                        "type": "string"
                      },
                      {
                        "name": "ImageTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "ExclusionType",
                        "type": "string"
                      },
                      {
                        "name": "CommandHistory",
                        "type": "string"
                      },
                      {
                        "name": "FirstCommand",
                        "type": "string"
                      },
                      {
                        "name": "CommandCount",
                        "type": "string"
                      },
                      {
                        "name": "DeviceProductId",
                        "type": "string"
                      },
                      {
                        "name": "BluetoothDeviceType",
                        "type": "string"
                      },
                      {
                        "name": "BluetoothDeviceAddressType",
                        "type": "string"
                      },
                      {
                        "name": "BluetoothDeviceAddress",
                        "type": "string"
                      },
                      {
                        "name": "BluetoothDeviceName",
                        "type": "string"
                      },
                      {
                        "name": "DeviceVendorId",
                        "type": "string"
                      },
                      {
                        "name": "AmsiStatusCode",
                        "type": "string"
                      },
                      {
                        "name": "AmsiRegistrationState",
                        "type": "string"
                      },
                      {
                        "name": "SourceEndpointNetworkType",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountUserPrincipal",
                        "type": "string"
                      },
                      {
                        "name": "ActiveDirectoryAuthenticationMethod",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountType",
                        "type": "string"
                      },
                      {
                        "name": "TargetAccountObjectSid",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountObjectSid",
                        "type": "string"
                      },
                      {
                        "name": "AggregationWindowTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountDomain",
                        "type": "string"
                      },
                      {
                        "name": "TargetAccountType",
                        "type": "string"
                      },
                      {
                        "name": "NtlmAvFlags",
                        "type": "string"
                      },
                      {
                        "name": "AggregationLatestTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "DeviceTimeStamp",
                        "type": "string"
                      },
                      {
                        "name": "ParentHubInstanceId",
                        "type": "string"
                      },
                      {
                        "name": "DeviceProduct",
                        "type": "string"
                      },
                      {
                        "name": "ParentHubPort",
                        "type": "string"
                      },
                      {
                        "name": "DeviceProtocol",
                        "type": "string"
                      },
                      {
                        "name": "DcPolicyFlags",
                        "type": "string"
                      },
                      {
                        "name": "DeviceVersion",
                        "type": "string"
                      },
                      {
                        "name": "DeviceInstanceId",
                        "type": "string"
                      },
                      {
                        "name": "DeviceUserSid",
                        "type": "string"
                      },
                      {
                        "name": "DeviceUserAuthenticationId",
                        "type": "string"
                      },
                      {
                        "name": "SocketType",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountSamAccountName",
                        "type": "string"
                      },
                      {
                        "name": "KerberosRequestTicketValidityPeriod",
                        "type": "string"
                      },
                      {
                        "name": "DelegatorAccountObjectSid",
                        "type": "string"
                      },
                      {
                        "name": "DelegatorAccountSamAccountName",
                        "type": "string"
                      },
                      {
                        "name": "DesiredKerberosEncryptionTypes",
                        "type": "string"
                      },
                      {
                        "name": "DcPropertyIdInterfaceType",
                        "type": "string"
                      },
                      {
                        "name": "DcSensorInterfaceType",
                        "type": "string"
                      },
                      {
                        "name": "AmsScanTypeId",
                        "type": "string"
                      },
                      {
                        "name": "AmsStatus",
                        "type": "string"
                      },
                      {
                        "name": "LdapSecurityType",
                        "type": "string"
                      },
                      {
                        "name": "ObjectTypeEtw",
                        "type": "string"
                      },
                      {
                        "name": "SessionProcessId",
                        "type": "string"
                      },
                      {
                        "name": "ModuleCharacteristics",
                        "type": "string"
                      },
                      {
                        "name": "HostUrl",
                        "type": "string"
                      },
                      {
                        "name": "FileFormatString",
                        "type": "string"
                      },
                      {
                        "name": "MemoryScanFlags",
                        "type": "string"
                      },
                      {
                        "name": "AmsDeviceType",
                        "type": "string"
                      },
                      {
                        "name": "AsepFlags",
                        "type": "string"
                      },
                      {
                        "name": "AsepValueType",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountBadPasswordCount",
                        "type": "string"
                      },
                      {
                        "name": "SourceAccountBadPasswordTime",
                        "type": "string"
                      },
                      {
                        "name": "EndpointDescriptorAddress",
                        "type": "string"
                      },
                      {
                        "name": "EndpointDescriptorAttributes",
                        "type": "string"
                      },
                      {
                        "name": "ConfigurationDescriptorValue",
                        "type": "string"
                      },
                      {
                        "name": "ConfigurationDescriptorAttributes",
                        "type": "string"
                      },
                      {
                        "name": "ConfigurationDescriptorName",
                        "type": "string"
                      },
                      {
                        "name": "ConfigurationDescriptorNumInterfaces",
                        "type": "string"
                      },
                      {
                        "name": "DcTypeOrLocation",
                        "type": "string"
                      },
                      {
                        "name": "AgentLocalTime",
                        "type": "string"
                      },
                      {
                        "name": "ComputerName",
                        "type": "string"
                      },
                      {
                        "name": "ChassisType",
                        "type": "string"
                      },
                      {
                        "name": "ThreadStartBytes",
                        "type": "string"
                      },
                      {
                        "name": "BaseTime",
                        "type": "string"
                      },
                      {
                        "name": "TpmType",
                        "type": "string"
                      },
                      {
                        "name": "UTCTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "SubjectDN",
                        "type": "string"
                      },
                      {
                        "name": "SignatureDigestEncryptAlg",
                        "type": "string"
                      },
                      {
                        "name": "SignInfoFlagSignHashMismatch",
                        "type": "string"
                      },
                      {
                        "name": "SubjectSerialNumber",
                        "type": "string"
                      },
                      {
                        "name": "IssuerDN",
                        "type": "string"
                      },
                      {
                        "name": "SubjectCN",
                        "type": "string"
                      },
                      {
                        "name": "ExternalApiType",
                        "type": "string"
                      },
                      {
                        "name": "SignInfoFlagSelfSigned",
                        "type": "string"
                      },
                      {
                        "name": "product_type_desc",
                        "type": "string"
                      },
                      {
                        "name": "event_type",
                        "type": "string"
                      },
                      {
                        "name": "StartTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "HostnameField",
                        "type": "string"
                      },
                      {
                        "name": "OriginSourceIpAddress",
                        "type": "string"
                      },
                      {
                        "name": "SHA1String",
                        "type": "string"
                      },
                      {
                        "name": "ProcessStartTime",
                        "type": "string"
                      },
                      {
                        "name": "ProcessEndTime",
                        "type": "string"
                      },
                      {
                        "name": "DnsRequests",
                        "type": "string"
                      },
                      {
                        "name": "PatternDispositionFlags",
                        "type": "string"
                      },
                      {
                        "name": "FileName",
                        "type": "string"
                      },
                      {
                        "name": "LocalIP",
                        "type": "string"
                      },
                      {
                        "name": "FilePath",
                        "type": "string"
                      },
                      {
                        "name": "EventUUID",
                        "type": "string"
                      },
                      {
                        "name": "MD5String",
                        "type": "string"
                      },
                      {
                        "name": "SeverityName",
                        "type": "string"
                      },
                      {
                        "name": "Severity",
                        "type": "string"
                      },
                      {
                        "name": "SHA256String",
                        "type": "string"
                      },
                      {
                        "name": "NetworkAccesses",
                        "type": "string"
                      },
                      {
                        "name": "MACAddress",
                        "type": "string"
                      },
                      {
                        "name": "ProcessId",
                        "type": "string"
                      },
                      {
                        "name": "BillingType",
                        "type": "string"
                      },
                      {
                        "name": "RegNumericValue",
                        "type": "string"
                      },
                      {
                        "name": "RegBinaryValue",
                        "type": "string"
                      },
                      {
                        "name": "RpcOpClassification",
                        "type": "string"
                      },
                      {
                        "name": "RemoteAddressIP6",
                        "type": "string"
                      },
                      {
                        "name": "UserLogoffType",
                        "type": "string"
                      },
                      {
                        "name": "LogoffTime",
                        "type": "string"
                      },
                      {
                        "name": "PrivilegesBitmask",
                        "type": "string"
                      },
                      {
                        "name": "SubStatus",
                        "type": "string"
                      },
                      {
                        "name": "LocalSession",
                        "type": "string"
                      },
                      {
                        "name": "EnabledPrivilegesBitmask",
                        "type": "string"
                      },
                      {
                        "name": "UserGroupsBitmask",
                        "type": "string"
                      },
                      {
                        "name": "LinkedAuthenticationId",
                        "type": "string"
                      },
                      {
                        "name": "FileWrittenFlags",
                        "type": "string"
                      },
                      {
                        "name": "ClientId",
                        "type": "string"
                      },
                      {
                        "name": "IsOnNetwork",
                        "type": "string"
                      },
                      {
                        "name": "TemporaryFileName",
                        "type": "string"
                      },
                      {
                        "name": "MSOfficeSubType",
                        "type": "string"
                      },
                      {
                        "name": "GID",
                        "type": "string"
                      },
                      {
                        "name": "UnixMode",
                        "type": "string"
                      },
                      {
                        "name": "USN",
                        "type": "string"
                      },
                      {
                        "name": "FileCategory",
                        "type": "string"
                      },
                      {
                        "name": "ELFSubType",
                        "type": "string"
                      },
                      {
                        "name": "IsTransactedFile",
                        "type": "string"
                      },
                      {
                        "name": "MachOSubType",
                        "type": "string"
                      },
                      {
                        "name": "NewFileIdentifier",
                        "type": "string"
                      },
                      {
                        "name": "Tags",
                        "type": "string"
                      },
                      {
                        "name": "VnodeType",
                        "type": "string"
                      },
                      {
                        "name": "FileEventType",
                        "type": "string"
                      },
                      {
                        "name": "RemoteAddressString",
                        "type": "string"
                      },
                      {
                        "name": "FirewallAction",
                        "type": "string"
                      },
                      {
                        "name": "NegateLocalAddress",
                        "type": "string"
                      },
                      {
                        "name": "RemoteAddressMaskIP6",
                        "type": "string"
                      },
                      {
                        "name": "LocalAddressMaskIP6",
                        "type": "string"
                      },
                      {
                        "name": "NegateRemoteAddress",
                        "type": "string"
                      },
                      {
                        "name": "IcmpCode",
                        "type": "string"
                      },
                      {
                        "name": "IcmpType",
                        "type": "string"
                      },
                      {
                        "name": "RemoteAddressMaskIP4",
                        "type": "string"
                      },
                      {
                        "name": "LocalAddressMaskIP4",
                        "type": "string"
                      },
                      {
                        "name": "InContext",
                        "type": "string"
                      },
                      {
                        "name": "NeighborList",
                        "type": "string"
                      },
                      {
                        "name": "TcpConnectErrorCode",
                        "type": "string"
                      },
                      {
                        "name": "NegateInterface",
                        "type": "string"
                      },
                      {
                        "name": "HbfwRuleId",
                        "type": "string"
                      },
                      {
                        "name": "NetworkProfile",
                        "type": "string"
                      },
                      {
                        "name": "PolicyIdentifier",
                        "type": "string"
                      },
                      {
                        "name": "HbfwRuleFlags",
                        "type": "string"
                      },
                      {
                        "name": "RuleAction",
                        "type": "string"
                      },
                      {
                        "name": "ParentBaseFileName",
                        "type": "string"
                      },
                      {
                        "name": "InjecteeImageFileName",
                        "type": "string"
                      },
                      {
                        "name": "InjectorImageFileName",
                        "type": "string"
                      },
                      {
                        "name": "ParentProcessId",
                        "type": "string"
                      },
                      {
                        "name": "ConHostProcessId",
                        "type": "string"
                      },
                      {
                        "name": "WritingProcessId",
                        "type": "string"
                      },
                      {
                        "name": "WritingProcessImageFileName",
                        "type": "string"
                      },
                      {
                        "name": "WritingProcessCommandLine",
                        "type": "string"
                      },
                      {
                        "name": "ModuleName",
                        "type": "string"
                      },
                      {
                        "name": "TemplateInstanceId",
                        "type": "string"
                      },
                      {
                        "name": "ProcessGroupId",
                        "type": "string"
                      },
                      {
                        "name": "CreateProcessType",
                        "type": "string"
                      },
                      {
                        "name": "ZoneIdentifier",
                        "type": "string"
                      },
                      {
                        "name": "MappedFromUserMode",
                        "type": "string"
                      },
                      {
                        "name": "LoadingProcessOriginalFilename",
                        "type": "string"
                      },
                      {
                        "name": "ImageDirectoryClassification",
                        "type": "string"
                      },
                      {
                        "name": "ModuleLoadMechanism",
                        "type": "string"
                      },
                      {
                        "name": "PatternIdList",
                        "type": "string"
                      },
                      {
                        "name": "ScreenshotsTakenCount",
                        "type": "string"
                      },
                      {
                        "name": "ExitCode",
                        "type": "string"
                      },
                      {
                        "name": "NetworkListenCount",
                        "type": "string"
                      },
                      {
                        "name": "SuspiciousRawDiskReadCount",
                        "type": "string"
                      },
                      {
                        "name": "NetworkBindCount",
                        "type": "string"
                      },
                      {
                        "name": "NetworkRecvAcceptCount",
                        "type": "string"
                      },
                      {
                        "name": "ContextData",
                        "type": "string"
                      },
                      {
                        "name": "NewExecutableWrittenCount",
                        "type": "string"
                      },
                      {
                        "name": "ExeAndServiceCount",
                        "type": "string"
                      },
                      {
                        "name": "NetworkCloseCount",
                        "type": "string"
                      },
                      {
                        "name": "SuspectStackCount",
                        "type": "string"
                      },
                      {
                        "name": "CLICreationCount",
                        "type": "string"
                      },
                      {
                        "name": "UnsignedModuleLoadCount",
                        "type": "string"
                      },
                      {
                        "name": "UserTime",
                        "type": "string"
                      },
                      {
                        "name": "AllocateVirtualMemoryCount",
                        "type": "string"
                      },
                      {
                        "name": "ServiceEventCount",
                        "type": "string"
                      },
                      {
                        "name": "SnapshotFileOpenCount",
                        "type": "string"
                      },
                      {
                        "name": "RemovableDiskFileWrittenCount",
                        "type": "string"
                      },
                      {
                        "name": "InjectedDllCount",
                        "type": "string"
                      },
                      {
                        "name": "UserMemoryProtectExecutableCount",
                        "type": "string"
                      },
                      {
                        "name": "NetworkCapableAsepWriteCount",
                        "type": "string"
                      },
                      {
                        "name": "SetThreadContextCount",
                        "type": "string"
                      },
                      {
                        "name": "SuspiciousCredentialModuleLoadCount",
                        "type": "string"
                      },
                      {
                        "name": "FileDeletedCount",
                        "type": "string"
                      },
                      {
                        "name": "UserMemoryAllocateExecutableCount",
                        "type": "string"
                      },
                      {
                        "name": "NetworkConnectCountUdp",
                        "type": "string"
                      },
                      {
                        "name": "SuspiciousFontLoadCount",
                        "type": "string"
                      },
                      {
                        "name": "ConHostId",
                        "type": "string"
                      },
                      {
                        "name": "NetworkConnectCount",
                        "type": "string"
                      },
                      {
                        "name": "CreateProcessCount",
                        "type": "string"
                      },
                      {
                        "name": "DirectoryEnumeratedCount",
                        "type": "string"
                      },
                      {
                        "name": "SuspiciousDnsRequestCount",
                        "type": "string"
                      },
                      {
                        "name": "DocumentFileWrittenCount",
                        "type": "string"
                      },
                      {
                        "name": "ExecutableDeletedCount",
                        "type": "string"
                      },
                      {
                        "name": "RegKeySecurityDecreasedCount",
                        "type": "string"
                      },
                      {
                        "name": "InjectedThreadCount",
                        "type": "string"
                      },
                      {
                        "name": "ThreadStartAddress",
                        "type": "string"
                      },
                      {
                        "name": "PayloadClassification",
                        "type": "string"
                      },
                      {
                        "name": "PayloadClassificationFlags",
                        "type": "string"
                      },
                      {
                        "name": "UserMemoryProtectExecutableRemoteCount",
                        "type": "string"
                      },
                      {
                        "name": "WellKnownTargetFunction",
                        "type": "string"
                      },
                      {
                        "name": "SmbShareName",
                        "type": "string"
                      },
                      {
                        "name": "ShareName",
                        "type": "string"
                      },
                      {
                        "name": "UploadId",
                        "type": "string"
                      },
                      {
                        "name": "FirewallRule",
                        "type": "string"
                      },
                      {
                        "name": "FirewallRuleId",
                        "type": "string"
                      },
                      {
                        "name": "FirewallOption",
                        "type": "string"
                      },
                      {
                        "name": "DeviceSerialNumber",
                        "type": "string"
                      },
                      {
                        "name": "EnvironmentVariableName",
                        "type": "string"
                      },
                      {
                        "name": "SamAccountName",
                        "type": "string"
                      },
                      {
                        "name": "FirewallOptionNumericValue",
                        "type": "string"
                      },
                      {
                        "name": "FirewallOptionStringValue",
                        "type": "string"
                      },
                      {
                        "name": "FileVaultIsEnabled",
                        "type": "string"
                      },
                      {
                        "name": "EnvironmentVariableValue",
                        "type": "string"
                      },
                      {
                        "name": "ConfigStateData",
                        "type": "string"
                      },
                      {
                        "name": "ActiveDirectoryOuDn",
                        "type": "string"
                      },
                      {
                        "name": "SmbClientName",
                        "type": "string"
                      },
                      {
                        "name": "SharePath",
                        "type": "string"
                      },
                      {
                        "name": "ShareData",
                        "type": "string"
                      },
                      {
                        "name": "UserMemoryAllocateExecutableRemoteCount",
                        "type": "string"
                      },
                      {
                        "name": "FalconServiceState",
                        "type": "string"
                      },
                      {
                        "name": "IOServiceClass",
                        "type": "string"
                      },
                      {
                        "name": "IOServicePath",
                        "type": "string"
                      },
                      {
                        "name": "IOServiceProperties",
                        "type": "string"
                      },
                      {
                        "name": "IOServiceName",
                        "type": "string"
                      },
                      {
                        "name": "AccountDomain",
                        "type": "string"
                      },
                      {
                        "name": "AccountObjectGuid",
                        "type": "string"
                      },
                      {
                        "name": "AccountObjectSid",
                        "type": "string"
                      },
                      {
                        "name": "AddressFamily",
                        "type": "string"
                      },
                      {
                        "name": "FirewallProfile",
                        "type": "string"
                      },
                      {
                        "name": "UserRid",
                        "type": "string"
                      },
                      {
                        "name": "GroupRid",
                        "type": "string"
                      },
                      {
                        "name": "DomainSid",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-CrowdStrikeSecondary": {
                    "columns": [
                      {
                        "name": "FolderName",
                        "type": "string"
                      },
                      {
                        "name": "AdditionalFields",
                        "type": "string"
                      },
                      {
                        "name": "AgentLoadFlags",
                        "type": "string"
                      },
                      {
                        "name": "AgentLocalTime",
                        "type": "string"
                      },
                      {
                        "name": "AgentTimeOffset",
                        "type": "string"
                      },
                      {
                        "name": "AgentVersion",
                        "type": "string"
                      },
                      {
                        "name": "BiosManufacturer",
                        "type": "string"
                      },
                      {
                        "name": "BiosVersion",
                        "type": "string"
                      },
                      {
                        "name": "ChassisType",
                        "type": "string"
                      },
                      {
                        "name": "City",
                        "type": "string"
                      },
                      {
                        "name": "ComputerName",
                        "type": "string"
                      },
                      {
                        "name": "ConfigBuild",
                        "type": "string"
                      },
                      {
                        "name": "ConfigIDBuild",
                        "type": "string"
                      },
                      {
                        "name": "Continent",
                        "type": "string"
                      },
                      {
                        "name": "Country",
                        "type": "string"
                      },
                      {
                        "name": "FalconGroupingTags",
                        "type": "string"
                      },
                      {
                        "name": "FirstSeen",
                        "type": "string"
                      },
                      {
                        "name": "HostHiddenStatus",
                        "type": "string"
                      },
                      {
                        "name": "MachineDomain",
                        "type": "string"
                      },
                      {
                        "name": "OU",
                        "type": "string"
                      },
                      {
                        "name": "PointerSize",
                        "type": "string"
                      },
                      {
                        "name": "ProductType",
                        "type": "string"
                      },
                      {
                        "name": "SensorGroupingTags",
                        "type": "string"
                      },
                      {
                        "name": "ServicePackMajor",
                        "type": "string"
                      },
                      {
                        "name": "SiteName",
                        "type": "string"
                      },
                      {
                        "name": "SystemManufacturer",
                        "type": "string"
                      },
                      {
                        "name": "SystemProductName",
                        "type": "string"
                      },
                      {
                        "name": "Timezone",
                        "type": "string"
                      },
                      {
                        "name": "Version",
                        "type": "string"
                      },
                      {
                        "name": "aid",
                        "type": "string"
                      },
                      {
                        "name": "aip",
                        "type": "string"
                      },
                      {
                        "name": "cid",
                        "type": "string"
                      },
                      {
                        "name": "event_platform",
                        "type": "string"
                      },
                      {
                        "name": "CompanyName",
                        "type": "string"
                      },
                      {
                        "name": "FileName",
                        "type": "string"
                      },
                      {
                        "name": "FileVersion",
                        "type": "string"
                      },
                      {
                        "name": "ProductName",
                        "type": "string"
                      },
                      {
                        "name": "ProductVersion",
                        "type": "string"
                      },
                      {
                        "name": "SHA256HashData",
                        "type": "string"
                      },
                      {
                        "name": "detectionCount",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "externalIP",
                        "type": "string"
                      },
                      {
                        "name": "installationTimestamp",
                        "type": "string"
                      },
                      {
                        "name": "SoftwareType",
                        "type": "string"
                      },
                      {
                        "name": "Category",
                        "type": "string"
                      },
                      {
                        "name": "GatewayIP",
                        "type": "string"
                      },
                      {
                        "name": "GatewayMAC",
                        "type": "string"
                      },
                      {
                        "name": "InterfaceAlias",
                        "type": "string"
                      },
                      {
                        "name": "InterfaceDescription",
                        "type": "string"
                      },
                      {
                        "name": "LocalAddressIP4",
                        "type": "string"
                      },
                      {
                        "name": "MAC",
                        "type": "string"
                      },
                      {
                        "name": "MACPrefix",
                        "type": "string"
                      },
                      {
                        "name": "CurrentLocalIP",
                        "type": "string"
                      },
                      {
                        "name": "FirstDiscoveredDate",
                        "type": "string"
                      },
                      {
                        "name": "LastDiscoveredBy",
                        "type": "string"
                      },
                      {
                        "name": "discovererCount",
                        "type": "string"
                      },
                      {
                        "name": "discoverer_aid",
                        "type": "string"
                      },
                      {
                        "name": "discoverer_devicetype",
                        "type": "string"
                      },
                      {
                        "name": "localipCount",
                        "type": "string"
                      },
                      {
                        "name": "subnet",
                        "type": "string"
                      }
                    ]
                  }
                },
                "dataSources": "[variables('TemplateEmptyObject')]",
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n|  where event_simpleName in ('RawBindIP6', 'RawBindIP4', 'NetworkReceiveAcceptIP6', 'NetworkReceiveAcceptIP4', 'NetworkListenIP6', 'NetworkListenIP4', 'NetworkConnectIP6', 'NetworkConnectIP4', 'NetworkCloseIP6', 'NetworkCloseIP4', 'LocalIpAddressRemovedIP6', 'LocalIpAddressRemovedIP4', 'FirewallRuleIP6Matched', 'FirewallRuleIP4Matched', 'FirewallDeleteRuleIP6', 'FirewallDeleteRuleIP4', 'FirewallSetRuleIP6', 'FirewallSetRuleIP4') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),        \r\n        BoundingLimitCount = tolong(BoundingLimitCount),        \r\n        RemotePort = tolong(RemotePort),\r\n        LocalPort = tolong(LocalPort),\r\n        InterfaceIndex = tolong(InterfaceIndex),\r\n        RuleMatchCount = tolong(RuleMatchCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Network_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('UserIdentity', 'ActiveDirectoryInteractiveDomainLogon', 'PeVersionInfo', 'ActiveDirectoryAuthenticationFailure', 'ActiveDirectoryAuthentication', 'NeighborListIP6', 'NeighborListIP4', 'SuspiciousUserRemoteAPCAttempt', 'ServiceStarted', 'ScriptControlScanTelemetry', 'ScheduledTaskRegistered', 'ScheduledTaskModified', 'ScheduledTaskDeleted', 'KernelServiceStarted', 'HostedServiceStopped', 'HostedServiceStarted', 'DriverLoad', 'CustomIOAFileWrittenDetectionInfoEvent', 'CustomIOABasicProcessDetectionInfoEvent', 'CreateThreadReflectiveDll', 'CreateThreadNoStartImage', 'CreateThreadKernelNoStartImage', 'CreateService', 'BITSJobCreated', 'RegistryOperationDetectInfo', 'SnapshotVolumeMounted', 'SmbServerV1AuditEtw', 'RemovableMediaVolumeMounted', 'FsVolumeUnmounted', 'FsVolumeMounted', 'FirmwareRegionMeasured', 'FirmwareImageAnalyzed', 'AsepValueUpdate', 'AsepKeyUpdate', 'AmsiRegistrationStatus', 'WroteExeAndGeneratedServiceEvent', 'WmiProviderRegistrationEtw', 'WmiFilterConsumerBindingEtw', 'WfpFilterTamperingFilterDeleted', 'WfpFilterTamperingFilterAdded') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp), \r\n        BaseTime = todouble(BaseTime),\r\n        CommandCloudTimeStamp = todouble(CommandCloudTimeStamp),       \r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        ProcessCount = tolong(ProcessCount), \r\n        CommandCount = tolong(CommandCount),\r\n        SourceAccountBadPasswordCount = tolong(SourceAccountBadPasswordCount),\r\n        LogonTime = todouble(LogonTime),\r\n        KernelTime = todouble(KernelTime),\r\n        FileSigningTime = todouble(FileSigningTime),\r\n        VolumeSnapshotTimeStamp = todouble(VolumeSnapshotTimeStamp),\r\n        CreationTimeStamp = todouble(CreationTimeStamp),\r\n        BaseReachableTime = tolong(BaseReachableTime),\r\n        BatchTimestamp = todouble(BatchTimestamp),\r\n        ReflectivePeTimestamp = todouble(ReflectivePeTimestamp),\r\n        CommandEndTimeStamp = todouble(CommandEndTimeStamp),\r\n        CommandStartTimeStamp = todouble(CommandStartTimeStamp),\r\n        AggregationWindowTimestamp = todouble(AggregationWindowTimestamp),\r\n        AggregationLatestTimestamp = todouble(AggregationLatestTimestamp),\r\n        ImageAnalysisRequestTimestamp = todouble(ImageAnalysisRequestTimestamp),\r\n        ImageTimeStamp = todouble(ImageTimeStamp),\r\n        UTCTimestamp = todouble(UTCTimestamp),\r\n        DeviceTimeStamp = todouble(DeviceTimeStamp),\r\n        AgentLocalTime = todouble(AgentLocalTime),\r\n        StartTimestamp = todouble(StartTimestamp),\r\n        CommandSequenceTotal = toint(CommandSequenceTotal),\r\n        ProcessStartTime = todouble(ProcessStartTime),        \r\n        ProcessEndTime = todouble(ProcessEndTime),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Additional_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('DnsRequest', 'SuspiciousDnsRequest') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n    CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        DnsRequestCount = tolong(DnsRequestCount),\r\n        InterfaceIndex = tolong(InterfaceIndex),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_DNS_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('ZipFileWritten', 'XarFileWritten', 'SourceCodeFileWritten', 'IsoExtensionFileWritten', 'ImgExtensionFileWritten', 'UnixFileWritten', 'PythonFileWritten', 'WebScriptFileWritten', 'RegistryHiveFileWritten', 'ADExplorerFileWritten', 'CrxFileWritten', 'DexFileWritten', 'VmdkFileWritten', 'VdiFileWritten', 'TiffFileWritten', 'TarFileWritten', 'SuspiciousPeFileWritten', 'SuspiciousEseFileWritten', 'SldFileWritten', 'SevenZipFileWritten', 'RtfFileWritten', 'RpmFileWritten', 'RarFileWritten', 'RansomwareRenameFile', 'RansomwareOpenFile', 'RansomwareFileAccessPattern', 'RansomwareCreateFile', 'PngFileWritten', 'PeFileWritten', 'PdfFileWritten', 'OoxmlFileWritten', 'OleFileWritten', 'NewScriptWritten', 'NewExecutableWritten', 'NewExecutableRenamed', 'MSXlsxFileWritten', 'MSVsdxFileWritten', 'MSPptxFileWritten', 'MsiFileWritten', 'MSDocxFileWritten', 'MachOFileWritten', 'LnkFileWritten', 'JpegFileWritten', 'JavaClassFileWritten', 'JarFileWritten', 'IdwFileWritten', 'GzipFileWritten', 'GifFileWritten', 'GenericFileWritten', 'FileDetectInfo', 'EseFileWritten', 'EmailFileWritten', 'EmailArchiveFileWritten', 'ELFFileWritten', 'DxfFileWritten', 'DwgFileWritten', 'DmpFileWritten', 'DmgFileWritten', 'DirectoryCreate', 'DebFileWritten', 'CriticalFileModified', 'CriticalFileAccessed', 'CabFileWritten', 'BZip2FileWritten', 'BmpFileWritten', 'BlfFileWritten', 'AsepFileChange', 'ArjFileWritten', 'ArcFileWritten') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        Size = tolong(Size),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_File_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('UserLogonFailed2', 'UserLogonFailed', 'UserLogon', 'UserLogoff', 'IoSessionLoggedOn')  | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        LogonTime = todouble(LogonTime),\r\n        LogoffTime = todouble(LogoffTime),\r\n        EtwRawThreadId = tolong(EtwRawThreadId),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Auth_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('WmiCreateProcess', 'UnsignedModuleLoad', 'TerminateProcess', 'SyntheticProcessRollup2', 'ProcessSelfDeleted', 'ProcessRollup2', 'ProcessInjection', 'ProcessBlocked', 'ModuleLoadV3DetectInfo', 'FileWrittenAndExecutedInContainer', 'ExecutableDeleted', 'EndOfProcess') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),        \r\n        BoundingLimitCount = tolong(BoundingLimitCount),        \r\n        ProcessStartTime = todouble(ProcessStartTime),        \r\n        ProcessEndTime = todouble(ProcessEndTime),\r\n        FileSigningTime = todouble(FileSigningTime),\r\n        ScreenshotsTakenCount = tolong(ScreenshotsTakenCount),\r\n        NetworkListenCount = tolong(NetworkListenCount),\r\n        SuspiciousRawDiskReadCount = tolong(SuspiciousRawDiskReadCount),\r\n        NetworkBindCount = tolong(NetworkBindCount),\r\n        NetworkRecvAcceptCount = tolong(NetworkRecvAcceptCount),\r\n        NewExecutableWrittenCount = tolong(NewExecutableWrittenCount),\r\n        ExeAndServiceCount = tolong(ExeAndServiceCount),\r\n        NetworkCloseCount = tolong(NetworkCloseCount),\r\n        SuspectStackCount = tolong(SuspectStackCount),\r\n        CLICreationCount = tolong(CLICreationCount),\r\n        UnsignedModuleLoadCount = tolong(UnsignedModuleLoadCount),\r\n        UserTime = tolong(UserTime),\r\n        AllocateVirtualMemoryCount = tolong(AllocateVirtualMemoryCount),\r\n        ServiceEventCount = tolong(ServiceEventCount),\r\n        SnapshotFileOpenCount = tolong(SnapshotFileOpenCount),\r\n        RemovableDiskFileWrittenCount = tolong(RemovableDiskFileWrittenCount),\r\n        InjectedDllCount = tolong(InjectedDllCount),\r\n        UserMemoryProtectExecutableCount = tolong(UserMemoryProtectExecutableCount),\r\n        NetworkCapableAsepWriteCount = tolong(NetworkCapableAsepWriteCount),\r\n        DnsRequestCount = tolong(DnsRequestCount),\r\n        SetThreadContextCount = tolong(SetThreadContextCount),        \r\n        SuspiciousCredentialModuleLoadCount = tolong(SuspiciousCredentialModuleLoadCount),\r\n        FileDeletedCount = tolong(FileDeletedCount),\r\n        UserMemoryAllocateExecutableCount = tolong(UserMemoryAllocateExecutableCount),\r\n        NetworkConnectCountUdp = tolong(NetworkConnectCountUdp),\r\n        SuspiciousFontLoadCount = tolong(SuspiciousFontLoadCount),        \r\n        NetworkConnectCount = tolong(NetworkConnectCount),\r\n        CreateProcessCount = tolong(CreateProcessCount),        \r\n        KernelTime = tolong(KernelTime),\r\n        DirectoryEnumeratedCount = tolong(DirectoryEnumeratedCount),\r\n        SuspiciousDnsRequestCount = tolong(SuspiciousDnsRequestCount),\r\n        DocumentFileWrittenCount = tolong(DocumentFileWrittenCount),\r\n        UserMemoryProtectExecutableRemoteCount = tolong(UserMemoryProtectExecutableRemoteCount),\r\n        UserMemoryAllocateExecutableRemoteCount = tolong(UserMemoryAllocateExecutableRemoteCount),\r\n        ExecutableDeletedCount = tolong(ExecutableDeletedCount),        \r\n        InjectedThreadCount = tolong(InjectedThreadCount),\r\n        RegKeySecurityDecreasedCount = tolong(RegKeySecurityDecreasedCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Process_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ( 'RegSystemConfigValueUpdate', 'RegGenericValueUpdate') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        RegNumericValue = toint(RegNumericValue),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Registry_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('VolumeSnapshotDeleted', 'VolumeSnapshotCreated', 'SmbServerShareOpenedEtw', 'SmbClientShareOpenedEtw', 'SmbClientShareClosedEtw', 'ProvisioningStarted', 'ProvisioningEnded', 'OsfmDownloadComplete', 'NetShareSecurityModify', 'NetShareDelete', 'NetShareAdd', 'MemoryScanEnabled', 'ManifestDownloadComplete', 'LfoUploadStart', 'FileRenameInfo', 'FileOpenInfo', 'FileDeleteInfo', 'FileCreateInfo', 'IoSessionConnected', 'IOServiceRegister', 'InstallServiceDownloadComplete', 'InstallBundleDownloadComplete', 'HostnameChanged', 'FirewallSetRule', 'FirewallEnabled', 'FirewallDisabled', 'FirewallDeleteRule', 'FirewallChangeOption', 'FileVaultStatus', 'EventLogCleared', 'DcUsbDeviceWhitelisted', 'DcUsbDeviceDisconnected', 'DcBluetoothDeviceDisconnected', 'DcBluetoothDeviceConnected', 'CriticalEnvironmentVariableChanged', 'ConfigStateUpdate', 'ActiveDirectoryAccountUnlocked', 'ActiveDirectoryAccountPasswordUpdate', 'ActiveDirectoryAccountOuUpdate', 'ActiveDirectoryAccountNameUpdate', 'ActiveDirectoryAccountLocked', 'ActiveDirectoryAccountEnabled', 'ActiveDirectoryAccountDisabled', 'ActiveDirectoryAccountDepartmentUpdate', 'ActiveDirectoryAccountCreated') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        FileVaultIsEnabled = tobool(FileVaultIsEnabled),\r\n        AttemptNumber = tolong(AttemptNumber),\r\n        DeviceTimeStamp = todouble(DeviceTimeStamp),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Audit_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ( 'UserAccountDeleted', 'UserAccountCreated', 'UserAccountAddedToGroup') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_User_Events_CL"
                  },
                  {
                    "streams": [
                      "Custom-CrowdStrikeSecondary"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source\r\n| extend TimeGenerated = now(),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Secondary_Data_CL"
                  }
                ],
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId3')]"
              }
            },
            {
              "name": "CrowdStrike_Additional_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Additional_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "SystemUptimeSeconds",
                      "type": "long"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "TamperFilterFlags",
                      "type": "string"
                    },
                    {
                      "name": "LogonType",
                      "type": "string"
                    },
                    {
                      "name": "UserPrincipal",
                      "type": "string"
                    },
                    {
                      "name": "UserIsAdmin",
                      "type": "string"
                    },
                    {
                      "name": "LogonTime",
                      "type": "real"
                    },
                    {
                      "name": "LogonDomain",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAccount",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "UserCanonical",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "UserSid",
                      "type": "string"
                    },
                    {
                      "name": "UserFlags",
                      "type": "string"
                    },
                    {
                      "name": "LogonServer",
                      "type": "string"
                    },
                    {
                      "name": "LogonId",
                      "type": "string"
                    },
                    {
                      "name": "SessionId",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationPackage",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "PasswordLastSet",
                      "type": "string"
                    },
                    {
                      "name": "UserLogonFlags",
                      "type": "string"
                    },
                    {
                      "name": "LoginSessionId",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationUuidAsString",
                      "type": "string"
                    },
                    {
                      "name": "UID",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationUuid",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationIdMac",
                      "type": "string"
                    },
                    {
                      "name": "CommandLine",
                      "type": "string"
                    },
                    {
                      "name": "ClientComputerName",
                      "type": "string"
                    },
                    {
                      "name": "WmiConsumerType",
                      "type": "string"
                    },
                    {
                      "name": "WmiFilterType",
                      "type": "string"
                    },
                    {
                      "name": "EtwRawProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "OriginalParentAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "ParentAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "OriginalUserSid",
                      "type": "string"
                    },
                    {
                      "name": "SHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "TargetFileName",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "ErrorText",
                      "type": "string"
                    },
                    {
                      "name": "CloudErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "EtwEventCount",
                      "type": "long"
                    },
                    {
                      "name": "WmiProviderType",
                      "type": "string"
                    },
                    {
                      "name": "RawProcessId",
                      "type": "string"
                    },
                    {
                      "name": "UmppaInjectionType",
                      "type": "string"
                    },
                    {
                      "name": "ErrorStatus",
                      "type": "string"
                    },
                    {
                      "name": "TotalCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "EventOrigin",
                      "type": "string"
                    },
                    {
                      "name": "SourceFileName",
                      "type": "string"
                    },
                    {
                      "name": "WmiQuery",
                      "type": "string"
                    },
                    {
                      "name": "WmiNamespaceName",
                      "type": "string"
                    },
                    {
                      "name": "AntiTamperStateFlag",
                      "type": "string"
                    },
                    {
                      "name": "ServiceDisplayName",
                      "type": "string"
                    },
                    {
                      "name": "ErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "TargetProcessId",
                      "type": "string"
                    },
                    {
                      "name": "TokenType",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceGuid",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientProcessId",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceVersion",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientThreadId",
                      "type": "string"
                    },
                    {
                      "name": "RpcOpNum",
                      "type": "string"
                    },
                    {
                      "name": "RpcNestingLevel",
                      "type": "string"
                    },
                    {
                      "name": "EventMax",
                      "type": "string"
                    },
                    {
                      "name": "SourceProcessId",
                      "type": "string"
                    },
                    {
                      "name": "EtwRawThreadId",
                      "type": "string"
                    },
                    {
                      "name": "SourceThreadId",
                      "type": "string"
                    },
                    {
                      "name": "RawThreadId",
                      "type": "string"
                    },
                    {
                      "name": "OriginalContentLength",
                      "type": "string"
                    },
                    {
                      "name": "ContentSHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "ScriptContentName",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "HostProcessType",
                      "type": "string"
                    },
                    {
                      "name": "ParentCommandLine",
                      "type": "string"
                    },
                    {
                      "name": "ParentImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "GrandparentImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "GrandparentCommandLine",
                      "type": "string"
                    },
                    {
                      "name": "SuspectStackFlag",
                      "type": "string"
                    },
                    {
                      "name": "ScriptContentBytes",
                      "type": "string"
                    },
                    {
                      "name": "ExecutableBytes",
                      "type": "string"
                    },
                    {
                      "name": "CallStackModuleNames",
                      "type": "string"
                    },
                    {
                      "name": "KernelTime",
                      "type": "real"
                    },
                    {
                      "name": "ScriptControlErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "ScriptContentSource",
                      "type": "string"
                    },
                    {
                      "name": "OriginalFilename",
                      "type": "string"
                    },
                    {
                      "name": "ScreenshotType",
                      "type": "string"
                    },
                    {
                      "name": "TaskName",
                      "type": "string"
                    },
                    {
                      "name": "TaskExecCommand",
                      "type": "string"
                    },
                    {
                      "name": "TaskXml",
                      "type": "string"
                    },
                    {
                      "name": "TaskAuthor",
                      "type": "string"
                    },
                    {
                      "name": "TaskExecArguments",
                      "type": "string"
                    },
                    {
                      "name": "KeyObject",
                      "type": "string"
                    },
                    {
                      "name": "PublicKeys",
                      "type": "string"
                    },
                    {
                      "name": "RegPostObjectName",
                      "type": "string"
                    },
                    {
                      "name": "RegKeyName",
                      "type": "string"
                    },
                    {
                      "name": "RegRootObjectName",
                      "type": "string"
                    },
                    {
                      "name": "ExtendedKeyUsages",
                      "type": "string"
                    },
                    {
                      "name": "RegCreateDisposition",
                      "type": "string"
                    },
                    {
                      "name": "FileSigningTime",
                      "type": "real"
                    },
                    {
                      "name": "DesiredAccess",
                      "type": "string"
                    },
                    {
                      "name": "RegCreateOptions",
                      "type": "string"
                    },
                    {
                      "name": "SignInfoFlags",
                      "type": "string"
                    },
                    {
                      "name": "Certificate",
                      "type": "string"
                    },
                    {
                      "name": "OdsActionType",
                      "type": "string"
                    },
                    {
                      "name": "PatternHandlingErrorType",
                      "type": "string"
                    },
                    {
                      "name": "FileSubType",
                      "type": "string"
                    },
                    {
                      "name": "Object1Type",
                      "type": "string"
                    },
                    {
                      "name": "TargetAddress",
                      "type": "string"
                    },
                    {
                      "name": "Size",
                      "type": "string"
                    },
                    {
                      "name": "OciContainersStoppedCount",
                      "type": "long"
                    },
                    {
                      "name": "OciContainersStartedCount",
                      "type": "long"
                    },
                    {
                      "name": "VersionInfo",
                      "type": "string"
                    },
                    {
                      "name": "CompanyName",
                      "type": "string"
                    },
                    {
                      "name": "FixedFileVersion",
                      "type": "string"
                    },
                    {
                      "name": "FileVersion",
                      "type": "string"
                    },
                    {
                      "name": "ProductSku",
                      "type": "string"
                    },
                    {
                      "name": "PointerSize",
                      "type": "string"
                    },
                    {
                      "name": "ProductName",
                      "type": "string"
                    },
                    {
                      "name": "SubBuildNumber",
                      "type": "string"
                    },
                    {
                      "name": "PlatformId",
                      "type": "string"
                    },
                    {
                      "name": "BuildType",
                      "type": "string"
                    },
                    {
                      "name": "MajorVersion",
                      "type": "string"
                    },
                    {
                      "name": "ProductType",
                      "type": "string"
                    },
                    {
                      "name": "MinorVersion",
                      "type": "string"
                    },
                    {
                      "name": "CheckedBuild",
                      "type": "string"
                    },
                    {
                      "name": "BuildNumber",
                      "type": "string"
                    },
                    {
                      "name": "OSVersionFileData",
                      "type": "string"
                    },
                    {
                      "name": "OSVersionString",
                      "type": "string"
                    },
                    {
                      "name": "OSVersionFileName",
                      "type": "string"
                    },
                    {
                      "name": "IntegrityLevel",
                      "type": "string"
                    },
                    {
                      "name": "RemotePort",
                      "type": "string"
                    },
                    {
                      "name": "Protocol",
                      "type": "string"
                    },
                    {
                      "name": "VolumeDeviceType",
                      "type": "string"
                    },
                    {
                      "name": "VolumeName",
                      "type": "string"
                    },
                    {
                      "name": "VolumeDeviceObjectFlags",
                      "type": "string"
                    },
                    {
                      "name": "ByteOffset",
                      "type": "string"
                    },
                    {
                      "name": "VolumeDeviceCharacteristics",
                      "type": "string"
                    },
                    {
                      "name": "VolumeSectorSize",
                      "type": "string"
                    },
                    {
                      "name": "PatternDisposition",
                      "type": "string"
                    },
                    {
                      "name": "VolumeFileSystemType",
                      "type": "string"
                    },
                    {
                      "name": "Length",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "ServiceObjectName",
                      "type": "string"
                    },
                    {
                      "name": "ServiceDescription",
                      "type": "string"
                    },
                    {
                      "name": "ServiceSecurity",
                      "type": "string"
                    },
                    {
                      "name": "ServiceImagePath",
                      "type": "string"
                    },
                    {
                      "name": "ServiceStart",
                      "type": "string"
                    },
                    {
                      "name": "ServiceType",
                      "type": "string"
                    },
                    {
                      "name": "ServiceFailureActions",
                      "type": "string"
                    },
                    {
                      "name": "ServiceErrorControl",
                      "type": "string"
                    },
                    {
                      "name": "ServiceGroup",
                      "type": "string"
                    },
                    {
                      "name": "ProcessIntegrityLevel",
                      "type": "string"
                    },
                    {
                      "name": "MD5HashData",
                      "type": "string"
                    },
                    {
                      "name": "NamedPipeOperationType",
                      "type": "string"
                    },
                    {
                      "name": "PhysicalCoreCount",
                      "type": "long"
                    },
                    {
                      "name": "LfoUploadFlags",
                      "type": "string"
                    },
                    {
                      "name": "AttemptNumber",
                      "type": "string"
                    },
                    {
                      "name": "CloudRequestId",
                      "type": "string"
                    },
                    {
                      "name": "VolumeSessionUUID",
                      "type": "string"
                    },
                    {
                      "name": "VolumeFileSystemDevice",
                      "type": "string"
                    },
                    {
                      "name": "VolumeSnapshotName",
                      "type": "string"
                    },
                    {
                      "name": "VolumeIsEncrypted",
                      "type": "string"
                    },
                    {
                      "name": "VolumeFileSystemDriver",
                      "type": "string"
                    },
                    {
                      "name": "VolumeSnapshotTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "VolumeRealDeviceName",
                      "type": "string"
                    },
                    {
                      "name": "VolumeEncryptionStatus",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "IsOnRemovableDisk",
                      "type": "string"
                    },
                    {
                      "name": "QuarantinedFileExtendedState",
                      "type": "string"
                    },
                    {
                      "name": "PrimaryModule",
                      "type": "string"
                    },
                    {
                      "name": "DeviceId",
                      "type": "string"
                    },
                    {
                      "name": "LocalAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "ValidLifetime",
                      "type": "string"
                    },
                    {
                      "name": "MaxReassemblySize",
                      "type": "string"
                    },
                    {
                      "name": "NetworkGuid",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceAlias",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceIndex",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceFlags",
                      "type": "string"
                    },
                    {
                      "name": "PermanentPhysicalAddress",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceType",
                      "type": "string"
                    },
                    {
                      "name": "MediaType",
                      "type": "string"
                    },
                    {
                      "name": "AccessType",
                      "type": "string"
                    },
                    {
                      "name": "IpEntryFlags",
                      "type": "string"
                    },
                    {
                      "name": "PreferredLifetime",
                      "type": "string"
                    },
                    {
                      "name": "ConnectionType",
                      "type": "string"
                    },
                    {
                      "name": "PhysicalAddress",
                      "type": "string"
                    },
                    {
                      "name": "DirectionType",
                      "type": "string"
                    },
                    {
                      "name": "IfType",
                      "type": "string"
                    },
                    {
                      "name": "RetransmitTime",
                      "type": "long"
                    },
                    {
                      "name": "CreationTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "BaseReachableTime",
                      "type": "long"
                    },
                    {
                      "name": "PhysicalAddressLength",
                      "type": "string"
                    },
                    {
                      "name": "TunnelType",
                      "type": "string"
                    },
                    {
                      "name": "NetworkInterfaceGuid",
                      "type": "string"
                    },
                    {
                      "name": "PhysicalMediumType",
                      "type": "string"
                    },
                    {
                      "name": "TotalDiskSpace",
                      "type": "int"
                    },
                    {
                      "name": "LocalAddressIP6",
                      "type": "string"
                    },
                    {
                      "name": "DefaultGatewayIP6",
                      "type": "string"
                    },
                    {
                      "name": "ModuleNativePath",
                      "type": "string"
                    },
                    {
                      "name": "DotnetModuleFlags",
                      "type": "string"
                    },
                    {
                      "name": "AssemblyFlags",
                      "type": "string"
                    },
                    {
                      "name": "FirmwareSize",
                      "type": "string"
                    },
                    {
                      "name": "ImageAnalysisRequestTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "FirmwareType",
                      "type": "string"
                    },
                    {
                      "name": "MeasurementType",
                      "type": "string"
                    },
                    {
                      "name": "Timeout",
                      "type": "string"
                    },
                    {
                      "name": "SuppressType",
                      "type": "string"
                    },
                    {
                      "name": "ProcessCount",
                      "type": "long"
                    },
                    {
                      "name": "EtwTargetRawProcessId",
                      "type": "string"
                    },
                    {
                      "name": "MinorFunction",
                      "type": "string"
                    },
                    {
                      "name": "FileObject",
                      "type": "string"
                    },
                    {
                      "name": "IrpFlags",
                      "type": "string"
                    },
                    {
                      "name": "MajorFunction",
                      "type": "string"
                    },
                    {
                      "name": "OperationFlags",
                      "type": "string"
                    },
                    {
                      "name": "SignatureErrorState",
                      "type": "string"
                    },
                    {
                      "name": "SHA1HashData",
                      "type": "string"
                    },
                    {
                      "name": "SignatureState",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticodeHashData",
                      "type": "string"
                    },
                    {
                      "name": "ToBeSignedAlgorithm",
                      "type": "string"
                    },
                    {
                      "name": "ToBeSignedHash",
                      "type": "string"
                    },
                    {
                      "name": "SignInfoRequestFlags",
                      "type": "string"
                    },
                    {
                      "name": "SignerInfoCount",
                      "type": "long"
                    },
                    {
                      "name": "HashAlgorithm",
                      "type": "string"
                    },
                    {
                      "name": "RegObjectName",
                      "type": "string"
                    },
                    {
                      "name": "RegValueName",
                      "type": "string"
                    },
                    {
                      "name": "RegType",
                      "type": "string"
                    },
                    {
                      "name": "RegClassificationIndex",
                      "type": "string"
                    },
                    {
                      "name": "RegClassificationFlags",
                      "type": "string"
                    },
                    {
                      "name": "RegOperationType",
                      "type": "string"
                    },
                    {
                      "name": "RegClassification",
                      "type": "string"
                    },
                    {
                      "name": "RegStringValue",
                      "type": "string"
                    },
                    {
                      "name": "Facility",
                      "type": "string"
                    },
                    {
                      "name": "File",
                      "type": "string"
                    },
                    {
                      "name": "BatchTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "SpotlightBatchType",
                      "type": "string"
                    },
                    {
                      "name": "LastUpdateInstalledTime",
                      "type": "string"
                    },
                    {
                      "name": "PendingUpdateIds",
                      "type": "string"
                    },
                    {
                      "name": "LastPendingUpdateInstalledTime",
                      "type": "string"
                    },
                    {
                      "name": "InstalledUpdateIds",
                      "type": "string"
                    },
                    {
                      "name": "InstalledUpdateExtendedStatus",
                      "type": "string"
                    },
                    {
                      "name": "UninstallPendingUpdateIds",
                      "type": "string"
                    },
                    {
                      "name": "RawTargetProcessId",
                      "type": "string"
                    },
                    {
                      "name": "TargetThreadId",
                      "type": "string"
                    },
                    {
                      "name": "ApcContextFileName",
                      "type": "string"
                    },
                    {
                      "name": "RawTargetThreadId",
                      "type": "string"
                    },
                    {
                      "name": "FirmwareAnalysisErrorLocation",
                      "type": "string"
                    },
                    {
                      "name": "FirmwareAnalysisErrorSource",
                      "type": "string"
                    },
                    {
                      "name": "FirmwareAnalysisErrorReason",
                      "type": "string"
                    },
                    {
                      "name": "InjectedThreadFlag",
                      "type": "string"
                    },
                    {
                      "name": "ApcFlags",
                      "type": "string"
                    },
                    {
                      "name": "DownloadServer",
                      "type": "string"
                    },
                    {
                      "name": "DownloadPath",
                      "type": "string"
                    },
                    {
                      "name": "DownloadPort",
                      "type": "string"
                    },
                    {
                      "name": "RemediationTriggerTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "VolumeMountPoint",
                      "type": "string"
                    },
                    {
                      "name": "VolumeDriveLetter",
                      "type": "string"
                    },
                    {
                      "name": "DiskParentDeviceInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "PtStatusFlags",
                      "type": "string"
                    },
                    {
                      "name": "PtCompatibilityFlags",
                      "type": "string"
                    },
                    {
                      "name": "TargetDirectoryName",
                      "type": "string"
                    },
                    {
                      "name": "ThreadStartBytes",
                      "type": "string"
                    },
                    {
                      "name": "MaxUsedRam",
                      "type": "string"
                    },
                    {
                      "name": "UsedDiskSpace",
                      "type": "string"
                    },
                    {
                      "name": "AverageUsedRam",
                      "type": "string"
                    },
                    {
                      "name": "AverageCpuUsage",
                      "type": "string"
                    },
                    {
                      "name": "AvailableDiskSpace",
                      "type": "string"
                    },
                    {
                      "name": "MaxCpuUsage",
                      "type": "string"
                    },
                    {
                      "name": "ReflectivePeTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "ProcessExecuteFlags",
                      "type": "string"
                    },
                    {
                      "name": "DriverPreventionStatusFlags",
                      "type": "string"
                    },
                    {
                      "name": "TargetIntegrityLevel",
                      "type": "string"
                    },
                    {
                      "name": "TargetAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "ImageBaseName",
                      "type": "string"
                    },
                    {
                      "name": "ConnectionDirection",
                      "type": "string"
                    },
                    {
                      "name": "ConnectionFlags",
                      "type": "string"
                    },
                    {
                      "name": "LocalPort",
                      "type": "string"
                    },
                    {
                      "name": "MemoryDescriptionFlags",
                      "type": "string"
                    },
                    {
                      "name": "AppName",
                      "type": "string"
                    },
                    {
                      "name": "AppVersion",
                      "type": "string"
                    },
                    {
                      "name": "UpdateFlag",
                      "type": "string"
                    },
                    {
                      "name": "AppPathFlag",
                      "type": "string"
                    },
                    {
                      "name": "AppUpdateIds",
                      "type": "string"
                    },
                    {
                      "name": "AppProductId",
                      "type": "string"
                    },
                    {
                      "name": "AppPath",
                      "type": "string"
                    },
                    {
                      "name": "InstallDate",
                      "type": "string"
                    },
                    {
                      "name": "AppType",
                      "type": "string"
                    },
                    {
                      "name": "AppSource",
                      "type": "string"
                    },
                    {
                      "name": "AppProvider",
                      "type": "string"
                    },
                    {
                      "name": "AppIdentificationData",
                      "type": "string"
                    },
                    {
                      "name": "AppArchitecture",
                      "type": "string"
                    },
                    {
                      "name": "CommandCloudTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "CommandSequenceTotal",
                      "type": "int"
                    },
                    {
                      "name": "CommandCode",
                      "type": "string"
                    },
                    {
                      "name": "CommandEndTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "CommandStartTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "CommandSequenceNumber",
                      "type": "string"
                    },
                    {
                      "name": "CommandName",
                      "type": "string"
                    },
                    {
                      "name": "CommandStdOut",
                      "type": "string"
                    },
                    {
                      "name": "CommandStdErr",
                      "type": "string"
                    },
                    {
                      "name": "QuarantinedFileState",
                      "type": "string"
                    },
                    {
                      "name": "QuarantinedFileName",
                      "type": "string"
                    },
                    {
                      "name": "FileSystemOperationType",
                      "type": "string"
                    },
                    {
                      "name": "FsOperationClassificationFlags",
                      "type": "string"
                    },
                    {
                      "name": "TargetSHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "TargetCommandLineParameters",
                      "type": "string"
                    },
                    {
                      "name": "RegConfigValueType",
                      "type": "string"
                    },
                    {
                      "name": "RegConfigFlags",
                      "type": "string"
                    },
                    {
                      "name": "RegConfigClass",
                      "type": "string"
                    },
                    {
                      "name": "RegConfigIndex",
                      "type": "string"
                    },
                    {
                      "name": "RegKeyChangeType",
                      "type": "string"
                    },
                    {
                      "name": "Options",
                      "type": "string"
                    },
                    {
                      "name": "Information",
                      "type": "string"
                    },
                    {
                      "name": "FileIdentifier",
                      "type": "string"
                    },
                    {
                      "name": "ShareAccess",
                      "type": "string"
                    },
                    {
                      "name": "FileAttributes",
                      "type": "string"
                    },
                    {
                      "name": "HandleCreateAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "FileEcpBitmask",
                      "type": "string"
                    },
                    {
                      "name": "ProvisioningDuration",
                      "type": "string"
                    },
                    {
                      "name": "AgentLoadFlags",
                      "type": "string"
                    },
                    {
                      "name": "EtwProvidersError",
                      "type": "string"
                    },
                    {
                      "name": "EtwProvidersEnabled",
                      "type": "string"
                    },
                    {
                      "name": "EtwProviders",
                      "type": "string"
                    },
                    {
                      "name": "DriverLoadFlags",
                      "type": "string"
                    },
                    {
                      "name": "ImageTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "ExclusionType",
                      "type": "string"
                    },
                    {
                      "name": "CommandHistory",
                      "type": "string"
                    },
                    {
                      "name": "FirstCommand",
                      "type": "string"
                    },
                    {
                      "name": "CommandCountMax",
                      "type": "long"
                    },
                    {
                      "name": "CommandCount",
                      "type": "long"
                    },
                    {
                      "name": "DeviceProductId",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceType",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceAddressType",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceAddress",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceName",
                      "type": "string"
                    },
                    {
                      "name": "DeviceVendorId",
                      "type": "string"
                    },
                    {
                      "name": "AmsiStatusCode",
                      "type": "string"
                    },
                    {
                      "name": "AmsiRegistrationState",
                      "type": "string"
                    },
                    {
                      "name": "SourceEndpointNetworkType",
                      "type": "string"
                    },
                    {
                      "name": "TargetAccountObjectGuid",
                      "type": "string"
                    },
                    {
                      "name": "SourceAccountUserPrincipal",
                      "type": "string"
                    },
                    {
                      "name": "SourceEndpointAccountObjectSid",
                      "type": "string"
                    },
                    {
                      "name": "ActiveDirectoryAuthenticationMethod",
                      "type": "string"
                    },
                    {
                      "name": "SourceAccountType",
                      "type": "string"
                    },
                    {
                      "name": "AggregationEarliestTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "TargetAccountObjectSid",
                      "type": "string"
                    },
                    {
                      "name": "SourceAccountObjectSid",
                      "type": "string"
                    },
                    {
                      "name": "AggregationWindowTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "SourceAccountDomain",
                      "type": "string"
                    },
                    {
                      "name": "TargetAccountType",
                      "type": "string"
                    },
                    {
                      "name": "NtlmAvFlags",
                      "type": "string"
                    },
                    {
                      "name": "SourceAccountObjectGuid",
                      "type": "string"
                    },
                    {
                      "name": "AggregationLatestTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "DeviceTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "ParentHubInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "DeviceProduct",
                      "type": "string"
                    },
                    {
                      "name": "ParentHubPort",
                      "type": "string"
                    },
                    {
                      "name": "DeviceProtocol",
                      "type": "string"
                    },
                    {
                      "name": "DcPolicyFlags",
                      "type": "string"
                    },
                    {
                      "name": "DeviceVersion",
                      "type": "string"
                    },
                    {
                      "name": "DeviceInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "DeviceUserSid",
                      "type": "string"
                    },
                    {
                      "name": "DeviceUserAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "SocketType",
                      "type": "string"
                    },
                    {
                      "name": "SourceAccountSamAccountName",
                      "type": "string"
                    },
                    {
                      "name": "KerberosRequestTicketValidityPeriod",
                      "type": "string"
                    },
                    {
                      "name": "DelegatorAccountObjectSid",
                      "type": "string"
                    },
                    {
                      "name": "DelegatorAccountObjectGuid",
                      "type": "string"
                    },
                    {
                      "name": "DelegatorAccountSamAccountName",
                      "type": "string"
                    },
                    {
                      "name": "DesiredKerberosEncryptionTypes",
                      "type": "string"
                    },
                    {
                      "name": "DcPropertyIdInterfaceType",
                      "type": "string"
                    },
                    {
                      "name": "DcSensorInterfaceType",
                      "type": "string"
                    },
                    {
                      "name": "DomainName",
                      "type": "string"
                    },
                    {
                      "name": "AmsScanTypeId",
                      "type": "string"
                    },
                    {
                      "name": "AmsStatus",
                      "type": "string"
                    },
                    {
                      "name": "AmsScanSubtypeId",
                      "type": "string"
                    },
                    {
                      "name": "VnodeModificationType",
                      "type": "string"
                    },
                    {
                      "name": "LdapSecurityType",
                      "type": "string"
                    },
                    {
                      "name": "StackLimit",
                      "type": "string"
                    },
                    {
                      "name": "ObjectTypeEtw",
                      "type": "string"
                    },
                    {
                      "name": "SessionProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ModuleCharacteristics",
                      "type": "string"
                    },
                    {
                      "name": "HostUrl",
                      "type": "string"
                    },
                    {
                      "name": "FileFormatString",
                      "type": "string"
                    },
                    {
                      "name": "MemoryScanFlags",
                      "type": "string"
                    },
                    {
                      "name": "AmsDeviceType",
                      "type": "string"
                    },
                    {
                      "name": "AsepFlags",
                      "type": "string"
                    },
                    {
                      "name": "AsepValueType",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationFailureMsErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "SourceAccountBadPasswordCount",
                      "type": "long"
                    },
                    {
                      "name": "SourceAccountBadPasswordTime",
                      "type": "string"
                    },
                    {
                      "name": "EndpointDescriptorInterval",
                      "type": "string"
                    },
                    {
                      "name": "EndpointDescriptorMaxPacketSize",
                      "type": "string"
                    },
                    {
                      "name": "EndpointDescriptorAddress",
                      "type": "string"
                    },
                    {
                      "name": "EndpointDescriptorAttributes",
                      "type": "string"
                    },
                    {
                      "name": "ConfigurationDescriptorValue",
                      "type": "string"
                    },
                    {
                      "name": "ConfigurationDescriptorAttributes",
                      "type": "string"
                    },
                    {
                      "name": "ConfigurationDescriptorName",
                      "type": "string"
                    },
                    {
                      "name": "ConfigurationDescriptorNumInterfaces",
                      "type": "string"
                    },
                    {
                      "name": "ConfigurationDescriptorMaxPowerDraw",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceDescriptorNumber",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceDescriptorAlternateSetting",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceDescriptorNumEndpoints",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceDescriptorName",
                      "type": "string"
                    },
                    {
                      "name": "DcTypeOrLocation",
                      "type": "string"
                    },
                    {
                      "name": "SideChannelMitigationFlags",
                      "type": "string"
                    },
                    {
                      "name": "AgentLocalTime",
                      "type": "real"
                    },
                    {
                      "name": "ComputerName",
                      "type": "string"
                    },
                    {
                      "name": "ChassisType",
                      "type": "string"
                    },
                    {
                      "name": "TpmFirmwareVersion",
                      "type": "string"
                    },
                    {
                      "name": "BaseTime",
                      "type": "real"
                    },
                    {
                      "name": "TpmType",
                      "type": "string"
                    },
                    {
                      "name": "SignInfoFlagUnknownError",
                      "type": "string"
                    },
                    {
                      "name": "UTCTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "SubjectDN",
                      "type": "string"
                    },
                    {
                      "name": "SignatureDigestEncryptAlg",
                      "type": "string"
                    },
                    {
                      "name": "SignInfoFlagSignHashMismatch",
                      "type": "string"
                    },
                    {
                      "name": "SubjectSerialNumber",
                      "type": "string"
                    },
                    {
                      "name": "IssuerDN",
                      "type": "string"
                    },
                    {
                      "name": "SubjectCN",
                      "type": "string"
                    },
                    {
                      "name": "ExternalApiType",
                      "type": "string"
                    },
                    {
                      "name": "SignInfoFlagSelfSigned",
                      "type": "string"
                    },
                    {
                      "name": "product_type_desc",
                      "type": "string"
                    },
                    {
                      "name": "event_type",
                      "type": "string"
                    },
                    {
                      "name": "StartTimestamp",
                      "type": "real"
                    },
                    {
                      "name": "HostnameField",
                      "type": "string"
                    },
                    {
                      "name": "OriginSourceIpAddress",
                      "type": "string"
                    },
                    {
                      "name": "SHA1String",
                      "type": "string"
                    },
                    {
                      "name": "ProcessStartTime",
                      "type": "real"
                    },
                    {
                      "name": "ProcessEndTime",
                      "type": "real"
                    },
                    {
                      "name": "DnsRequests",
                      "type": "string"
                    },
                    {
                      "name": "PatternDispositionFlags",
                      "type": "string"
                    },
                    {
                      "name": "FileName",
                      "type": "string"
                    },
                    {
                      "name": "LocalIP",
                      "type": "string"
                    },
                    {
                      "name": "FilePath",
                      "type": "string"
                    },
                    {
                      "name": "EventUUID",
                      "type": "string"
                    },
                    {
                      "name": "MD5String",
                      "type": "string"
                    },
                    {
                      "name": "SeverityName",
                      "type": "string"
                    },
                    {
                      "name": "Severity",
                      "type": "string"
                    },
                    {
                      "name": "SHA256String",
                      "type": "string"
                    },
                    {
                      "name": "NetworkAccesses",
                      "type": "string"
                    },
                    {
                      "name": "MACAddress",
                      "type": "string"
                    },
                    {
                      "name": "ProcessId",
                      "type": "string"
                    },
                    {
                      "name": "BillingType",
                      "type": "string"
                    },
                    {
                      "name": "RegNumericValue",
                      "type": "string"
                    },
                    {
                      "name": "RegBinaryValue",
                      "type": "string"
                    },
                    {
                      "name": "RpcOpClassification",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_Audit_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Audit_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "VolumeSnapshotName",
                      "type": "string"
                    },
                    {
                      "name": "SmbShareName",
                      "type": "string"
                    },
                    {
                      "name": "ShareName",
                      "type": "string"
                    },
                    {
                      "name": "UploadId",
                      "type": "string"
                    },
                    {
                      "name": "SessionId",
                      "type": "string"
                    },
                    {
                      "name": "ComputerName",
                      "type": "string"
                    },
                    {
                      "name": "FirewallRule",
                      "type": "string"
                    },
                    {
                      "name": "FirewallRuleId",
                      "type": "string"
                    },
                    {
                      "name": "FirewallOption",
                      "type": "string"
                    },
                    {
                      "name": "SourceFileName",
                      "type": "string"
                    },
                    {
                      "name": "TargetFileName",
                      "type": "string"
                    },
                    {
                      "name": "DeviceVendorId",
                      "type": "string"
                    },
                    {
                      "name": "DeviceProductId",
                      "type": "string"
                    },
                    {
                      "name": "DeviceSerialNumber",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceAddress",
                      "type": "string"
                    },
                    {
                      "name": "EnvironmentVariableName",
                      "type": "string"
                    },
                    {
                      "name": "SamAccountName",
                      "type": "string"
                    },
                    {
                      "name": "FirewallOptionNumericValue",
                      "type": "string"
                    },
                    {
                      "name": "FirewallOptionStringValue",
                      "type": "string"
                    },
                    {
                      "name": "FileVaultIsEnabled",
                      "type": "boolean"
                    },
                    {
                      "name": "EnvironmentVariableValue",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateData",
                      "type": "string"
                    },
                    {
                      "name": "ActiveDirectoryOuDn",
                      "type": "string"
                    },
                    {
                      "name": "ActiveDirectoryDepartment",
                      "type": "string"
                    },
                    {
                      "name": "SHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "CommandLine",
                      "type": "string"
                    },
                    {
                      "name": "VolumeName",
                      "type": "string"
                    },
                    {
                      "name": "VolumeDriveLetter",
                      "type": "string"
                    },
                    {
                      "name": "TokenType",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceGuid",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientProcessId",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceVersion",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientThreadId",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "ImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "RpcOpNum",
                      "type": "string"
                    },
                    {
                      "name": "RpcNestingLevel",
                      "type": "string"
                    },
                    {
                      "name": "ClientComputerName",
                      "type": "string"
                    },
                    {
                      "name": "DomainName",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP6",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "SmbClientName",
                      "type": "string"
                    },
                    {
                      "name": "AgentLoadFlags",
                      "type": "string"
                    },
                    {
                      "name": "ProvisioningDuration",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "ErrorText",
                      "type": "string"
                    },
                    {
                      "name": "CloudErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "SharePath",
                      "type": "string"
                    },
                    {
                      "name": "ShareMaxCount",
                      "type": "long"
                    },
                    {
                      "name": "ShareRemark",
                      "type": "string"
                    },
                    {
                      "name": "ShareData",
                      "type": "string"
                    },
                    {
                      "name": "IntelTDTEnabled",
                      "type": "string"
                    },
                    {
                      "name": "FalconServiceState",
                      "type": "string"
                    },
                    {
                      "name": "LfoUploadFlags",
                      "type": "string"
                    },
                    {
                      "name": "AttemptNumber",
                      "type": "long"
                    },
                    {
                      "name": "Size",
                      "type": "string"
                    },
                    {
                      "name": "Tags",
                      "type": "string"
                    },
                    {
                      "name": "CloudRequestId",
                      "type": "string"
                    },
                    {
                      "name": "LocalSession",
                      "type": "string"
                    },
                    {
                      "name": "IOServiceClass",
                      "type": "string"
                    },
                    {
                      "name": "IOServicePath",
                      "type": "string"
                    },
                    {
                      "name": "IOServiceProperties",
                      "type": "string"
                    },
                    {
                      "name": "IOServiceName",
                      "type": "string"
                    },
                    {
                      "name": "Protocol",
                      "type": "string"
                    },
                    {
                      "name": "ChannelDiffStatusList",
                      "type": "string"
                    },
                    {
                      "name": "AccountDomain",
                      "type": "string"
                    },
                    {
                      "name": "AccountObjectGuid",
                      "type": "string"
                    },
                    {
                      "name": "AccountObjectSid",
                      "type": "string"
                    },
                    {
                      "name": "TotalCount",
                      "type": "long"
                    },
                    {
                      "name": "ErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "EventOrigin",
                      "type": "string"
                    },
                    {
                      "name": "AddressFamily",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceType",
                      "type": "string"
                    },
                    {
                      "name": "DeviceTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "DeviceInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "BluetoothDeviceAddressType",
                      "type": "string"
                    },
                    {
                      "name": "DeviceVersion",
                      "type": "string"
                    },
                    {
                      "name": "DeviceDescriptorSetHash",
                      "type": "string"
                    },
                    {
                      "name": "DeviceManufacturer",
                      "type": "string"
                    },
                    {
                      "name": "DeviceProduct",
                      "type": "string"
                    },
                    {
                      "name": "DeviceUserSid",
                      "type": "string"
                    },
                    {
                      "name": "DeviceUserAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "FirewallProfile",
                      "type": "string"
                    },
                    {
                      "name": "ShareAccess",
                      "type": "string"
                    },
                    {
                      "name": "DesiredAccess",
                      "type": "string"
                    },
                    {
                      "name": "GID",
                      "type": "string"
                    },
                    {
                      "name": "UID",
                      "type": "string"
                    },
                    {
                      "name": "UnixMode",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_Auth_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Auth_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "LogonType",
                      "type": "string"
                    },
                    {
                      "name": "LogonTime",
                      "type": "real"
                    },
                    {
                      "name": "UserIsAdmin",
                      "type": "string"
                    },
                    {
                      "name": "LogonDomain",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAccount",
                      "type": "string"
                    },
                    {
                      "name": "ClientComputerName",
                      "type": "string"
                    },
                    {
                      "name": "UserPrincipal",
                      "type": "string"
                    },
                    {
                      "name": "RawProcessId",
                      "type": "string"
                    },
                    {
                      "name": "UserSid",
                      "type": "string"
                    },
                    {
                      "name": "LogonServer",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationPackage",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "UserLogonFlags",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP6",
                      "type": "string"
                    },
                    {
                      "name": "UserLogoffType",
                      "type": "string"
                    },
                    {
                      "name": "LogoffTime",
                      "type": "real"
                    },
                    {
                      "name": "SessionId",
                      "type": "string"
                    },
                    {
                      "name": "UserFlags",
                      "type": "string"
                    },
                    {
                      "name": "PrivilegesBitmask",
                      "type": "string"
                    },
                    {
                      "name": "PasswordLastSet",
                      "type": "string"
                    },
                    {
                      "name": "EventOrigin",
                      "type": "string"
                    },
                    {
                      "name": "TargetProcessId",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "EtwRawProcessId",
                      "type": "string"
                    },
                    {
                      "name": "EtwRawThreadId",
                      "type": "long"
                    },
                    {
                      "name": "SubStatus",
                      "type": "string"
                    },
                    {
                      "name": "LocalSession",
                      "type": "string"
                    },
                    {
                      "name": "EnabledPrivilegesBitmask",
                      "type": "string"
                    },
                    {
                      "name": "UserGroupsBitmask",
                      "type": "string"
                    },
                    {
                      "name": "LinkedAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "UserCanonical",
                      "type": "string"
                    },
                    {
                      "name": "LoginSessionId",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationUuidAsString",
                      "type": "string"
                    },
                    {
                      "name": "UID",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationUuid",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationIdMac",
                      "type": "string"
                    },
                    {
                      "name": "ResendToCloud",
                      "type": "string"
                    },
                    {
                      "name": "LogonId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHashA1",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_DNS_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_DNS_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "DomainName",
                      "type": "string"
                    },
                    {
                      "name": "RequestType",
                      "type": "string"
                    },
                    {
                      "name": "IP4Records",
                      "type": "string"
                    },
                    {
                      "name": "QueryStatus",
                      "type": "string"
                    },
                    {
                      "name": "FirstIP4Record",
                      "type": "string"
                    },
                    {
                      "name": "DnsRequestCount",
                      "type": "long"
                    },
                    {
                      "name": "IP6Records",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceIndex",
                      "type": "long"
                    },
                    {
                      "name": "DualRequest",
                      "type": "string"
                    },
                    {
                      "name": "DnsResponseType",
                      "type": "string"
                    },
                    {
                      "name": "EventOrigin",
                      "type": "string"
                    },
                    {
                      "name": "RespondingDnsServer",
                      "type": "string"
                    },
                    {
                      "name": "CNAMERecords",
                      "type": "string"
                    },
                    {
                      "name": "FirstIP6Record",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_File_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_File_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "TargetFileName",
                      "type": "string"
                    },
                    {
                      "name": "FileOperatorSid",
                      "type": "string"
                    },
                    {
                      "name": "Size",
                      "type": "long"
                    },
                    {
                      "name": "FileWrittenFlags",
                      "type": "string"
                    },
                    {
                      "name": "OperationFlags",
                      "type": "string"
                    },
                    {
                      "name": "SHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "SourceFileName",
                      "type": "string"
                    },
                    {
                      "name": "CommandLine",
                      "type": "string"
                    },
                    {
                      "name": "OriginalFilename",
                      "type": "string"
                    },
                    {
                      "name": "ClientId",
                      "type": "string"
                    },
                    {
                      "name": "TargetDirectoryName",
                      "type": "string"
                    },
                    {
                      "name": "UID",
                      "type": "string"
                    },
                    {
                      "name": "Status",
                      "type": "string"
                    },
                    {
                      "name": "ImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "IsOnRemovableDisk",
                      "type": "string"
                    },
                    {
                      "name": "MinorFunction",
                      "type": "string"
                    },
                    {
                      "name": "IsOnNetwork",
                      "type": "string"
                    },
                    {
                      "name": "FileIdentifier",
                      "type": "string"
                    },
                    {
                      "name": "TokenType",
                      "type": "string"
                    },
                    {
                      "name": "DiskParentDeviceInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "FileObject",
                      "type": "string"
                    },
                    {
                      "name": "IrpFlags",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "FileEcpBitmask",
                      "type": "string"
                    },
                    {
                      "name": "MajorFunction",
                      "type": "string"
                    },
                    {
                      "name": "TemporaryFileName",
                      "type": "string"
                    },
                    {
                      "name": "VolumeSessionUUID",
                      "type": "string"
                    },
                    {
                      "name": "PatternId",
                      "type": "string"
                    },
                    {
                      "name": "EventOrigin",
                      "type": "string"
                    },
                    {
                      "name": "MSOfficeSubType",
                      "type": "string"
                    },
                    {
                      "name": "GID",
                      "type": "string"
                    },
                    {
                      "name": "UnixMode",
                      "type": "string"
                    },
                    {
                      "name": "USN",
                      "type": "string"
                    },
                    {
                      "name": "FileCategory",
                      "type": "string"
                    },
                    {
                      "name": "ShareAccess",
                      "type": "string"
                    },
                    {
                      "name": "DesiredAccess",
                      "type": "string"
                    },
                    {
                      "name": "ELFSubType",
                      "type": "string"
                    },
                    {
                      "name": "IsTransactedFile",
                      "type": "string"
                    },
                    {
                      "name": "MachOSubType",
                      "type": "string"
                    },
                    {
                      "name": "VnodeModificationType",
                      "type": "string"
                    },
                    {
                      "name": "NewFileIdentifier",
                      "type": "string"
                    },
                    {
                      "name": "Options",
                      "type": "string"
                    },
                    {
                      "name": "Information",
                      "type": "string"
                    },
                    {
                      "name": "FileAttributes",
                      "type": "string"
                    },
                    {
                      "name": "Tags",
                      "type": "string"
                    },
                    {
                      "name": "FixedFileVersion",
                      "type": "string"
                    },
                    {
                      "name": "HandleCreateAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "FileFlags",
                      "type": "string"
                    },
                    {
                      "name": "VnodeType",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_Network_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Network_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "ConnectionDirection",
                      "type": "string"
                    },
                    {
                      "name": "RemotePort",
                      "type": "long"
                    },
                    {
                      "name": "LocalAddressIP6",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP6",
                      "type": "string"
                    },
                    {
                      "name": "LocalPort",
                      "type": "long"
                    },
                    {
                      "name": "Protocol",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressString",
                      "type": "string"
                    },
                    {
                      "name": "FirewallAction",
                      "type": "string"
                    },
                    {
                      "name": "NegateLocalAddress",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressMaskIP6",
                      "type": "string"
                    },
                    {
                      "name": "LocalAddressMaskIP6",
                      "type": "string"
                    },
                    {
                      "name": "NegateRemoteAddress",
                      "type": "string"
                    },
                    {
                      "name": "IcmpCode",
                      "type": "string"
                    },
                    {
                      "name": "IcmpType",
                      "type": "string"
                    },
                    {
                      "name": "LocalAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressMaskIP4",
                      "type": "string"
                    },
                    {
                      "name": "LocalAddressMaskIP4",
                      "type": "string"
                    },
                    {
                      "name": "PhysicalAddress",
                      "type": "string"
                    },
                    {
                      "name": "ConnectionFlags",
                      "type": "string"
                    },
                    {
                      "name": "InContext",
                      "type": "string"
                    },
                    {
                      "name": "EventOrigin",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceIndex",
                      "type": "long"
                    },
                    {
                      "name": "NetLuidIndex",
                      "type": "long"
                    },
                    {
                      "name": "NeighborList",
                      "type": "string"
                    },
                    {
                      "name": "TcpConnectErrorCode",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceAlias",
                      "type": "string"
                    },
                    {
                      "name": "NegateInterface",
                      "type": "string"
                    },
                    {
                      "name": "IsUnique",
                      "type": "string"
                    },
                    {
                      "name": "LocalPortRangeStart",
                      "type": "string"
                    },
                    {
                      "name": "LocalPortRangeOperation",
                      "type": "string"
                    },
                    {
                      "name": "RemotePortRangeOperation",
                      "type": "string"
                    },
                    {
                      "name": "RemotePortRangeStart",
                      "type": "string"
                    },
                    {
                      "name": "HbfwRuleId",
                      "type": "string"
                    },
                    {
                      "name": "NetworkProfile",
                      "type": "string"
                    },
                    {
                      "name": "PolicyIdentifier",
                      "type": "string"
                    },
                    {
                      "name": "HbfwRuleFlags",
                      "type": "string"
                    },
                    {
                      "name": "ImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "CommandLine",
                      "type": "string"
                    },
                    {
                      "name": "RuleAction",
                      "type": "string"
                    },
                    {
                      "name": "RuleMatchCount",
                      "type": "long"
                    },
                    {
                      "name": "RuleMatchCountSinceLastReport",
                      "type": "long"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_Process_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Process_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "UserSid",
                      "type": "string"
                    },
                    {
                      "name": "ParentBaseFileName",
                      "type": "string"
                    },
                    {
                      "name": "SHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "MD5HashData",
                      "type": "string"
                    },
                    {
                      "name": "SHA1HashData",
                      "type": "string"
                    },
                    {
                      "name": "CommandLine",
                      "type": "string"
                    },
                    {
                      "name": "InjecteeImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "InjectorImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "IntegrityLevel",
                      "type": "string"
                    },
                    {
                      "name": "ParentProcessId",
                      "type": "string"
                    },
                    {
                      "name": "TargetProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ConHostProcessId",
                      "type": "string"
                    },
                    {
                      "name": "WritingProcessId",
                      "type": "string"
                    },
                    {
                      "name": "SourceProcessId",
                      "type": "string"
                    },
                    {
                      "name": "TargetFileName",
                      "type": "string"
                    },
                    {
                      "name": "ImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "WritingProcessImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "WritingProcessCommandLine",
                      "type": "string"
                    },
                    {
                      "name": "OriginalFilename",
                      "type": "string"
                    },
                    {
                      "name": "ProcessStartTime",
                      "type": "real"
                    },
                    {
                      "name": "ProcessEndTime",
                      "type": "real"
                    },
                    {
                      "name": "ModuleName",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "TokenType",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ParentCommandLine",
                      "type": "string"
                    },
                    {
                      "name": "TemplateInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "ParentImageFileName",
                      "type": "string"
                    },
                    {
                      "name": "PatternId",
                      "type": "string"
                    },
                    {
                      "name": "Tags",
                      "type": "string"
                    },
                    {
                      "name": "ProcessGroupId",
                      "type": "string"
                    },
                    {
                      "name": "RawProcessId",
                      "type": "string"
                    },
                    {
                      "name": "SyntheticPR2Flags",
                      "type": "string"
                    },
                    {
                      "name": "ImageSubsystem",
                      "type": "string"
                    },
                    {
                      "name": "SourceThreadId",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticodeHashData",
                      "type": "string"
                    },
                    {
                      "name": "SessionId",
                      "type": "string"
                    },
                    {
                      "name": "ParentAuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "SignInfoFlags",
                      "type": "string"
                    },
                    {
                      "name": "CallStackModuleNamesVersion",
                      "type": "string"
                    },
                    {
                      "name": "CsaProcessDataCollectionInstanceId",
                      "type": "string"
                    },
                    {
                      "name": "CallStackModuleNames",
                      "type": "string"
                    },
                    {
                      "name": "CreateProcessType",
                      "type": "string"
                    },
                    {
                      "name": "ZoneIdentifier",
                      "type": "string"
                    },
                    {
                      "name": "HostUrl",
                      "type": "string"
                    },
                    {
                      "name": "TargetThreadId",
                      "type": "string"
                    },
                    {
                      "name": "SignatureErrorState",
                      "type": "string"
                    },
                    {
                      "name": "ModuleCharacteristics",
                      "type": "string"
                    },
                    {
                      "name": "PublicKeys",
                      "type": "string"
                    },
                    {
                      "name": "ExtendedKeyUsages",
                      "type": "string"
                    },
                    {
                      "name": "SignatureState",
                      "type": "string"
                    },
                    {
                      "name": "MappedFromUserMode",
                      "type": "string"
                    },
                    {
                      "name": "FileSigningTime",
                      "type": "real"
                    },
                    {
                      "name": "Certificate",
                      "type": "string"
                    },
                    {
                      "name": "FileIdentifier",
                      "type": "string"
                    },
                    {
                      "name": "ExecutableBytes",
                      "type": "string"
                    },
                    {
                      "name": "LoadingProcessOriginalFilename",
                      "type": "string"
                    },
                    {
                      "name": "ModuleTagsAsString",
                      "type": "string"
                    },
                    {
                      "name": "ImageDirectoryClassification",
                      "type": "string"
                    },
                    {
                      "name": "ParentProcessPatternIdList",
                      "type": "string"
                    },
                    {
                      "name": "ModuleLoadMechanism",
                      "type": "string"
                    },
                    {
                      "name": "PatternIdList",
                      "type": "string"
                    },
                    {
                      "name": "ScreenshotsTakenCount",
                      "type": "long"
                    },
                    {
                      "name": "ExitCode",
                      "type": "string"
                    },
                    {
                      "name": "NetworkListenCount",
                      "type": "long"
                    },
                    {
                      "name": "SuspiciousRawDiskReadCount",
                      "type": "long"
                    },
                    {
                      "name": "NetworkBindCount",
                      "type": "long"
                    },
                    {
                      "name": "NetworkRecvAcceptCount",
                      "type": "long"
                    },
                    {
                      "name": "ContextData",
                      "type": "string"
                    },
                    {
                      "name": "NewExecutableWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "ExeAndServiceCount",
                      "type": "long"
                    },
                    {
                      "name": "NetworkCloseCount",
                      "type": "long"
                    },
                    {
                      "name": "SuspectStackCount",
                      "type": "long"
                    },
                    {
                      "name": "CLICreationCount",
                      "type": "long"
                    },
                    {
                      "name": "UnsignedModuleLoadCount",
                      "type": "long"
                    },
                    {
                      "name": "UserTime",
                      "type": "long"
                    },
                    {
                      "name": "AllocateVirtualMemoryCount",
                      "type": "long"
                    },
                    {
                      "name": "ServiceEventCount",
                      "type": "long"
                    },
                    {
                      "name": "SnapshotFileOpenCount",
                      "type": "long"
                    },
                    {
                      "name": "RemovableDiskFileWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "InjectedDllCount",
                      "type": "long"
                    },
                    {
                      "name": "ModuleLoadCount",
                      "type": "long"
                    },
                    {
                      "name": "UserMemoryProtectExecutableCount",
                      "type": "long"
                    },
                    {
                      "name": "NetworkCapableAsepWriteCount",
                      "type": "long"
                    },
                    {
                      "name": "DnsRequestCount",
                      "type": "long"
                    },
                    {
                      "name": "ArchiveFileWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "SetThreadContextCount",
                      "type": "long"
                    },
                    {
                      "name": "SuspiciousCredentialModuleLoadCount",
                      "type": "long"
                    },
                    {
                      "name": "FileDeletedCount",
                      "type": "long"
                    },
                    {
                      "name": "UserMemoryAllocateExecutableCount",
                      "type": "long"
                    },
                    {
                      "name": "DirectoryCreatedCount",
                      "type": "long"
                    },
                    {
                      "name": "NetworkConnectCountUdp",
                      "type": "long"
                    },
                    {
                      "name": "QueueApcCount",
                      "type": "long"
                    },
                    {
                      "name": "SuspiciousFontLoadCount",
                      "type": "long"
                    },
                    {
                      "name": "ConHostId",
                      "type": "string"
                    },
                    {
                      "name": "NetworkConnectCount",
                      "type": "long"
                    },
                    {
                      "name": "BinaryExecutableWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "CycleTime",
                      "type": "long"
                    },
                    {
                      "name": "PrivilegedProcessHandleCount",
                      "type": "long"
                    },
                    {
                      "name": "MaxThreadCount",
                      "type": "long"
                    },
                    {
                      "name": "GenericFileWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "ScriptEngineInvocationCount",
                      "type": "long"
                    },
                    {
                      "name": "RunDllInvocationCount",
                      "type": "long"
                    },
                    {
                      "name": "CreateProcessCount",
                      "type": "long"
                    },
                    {
                      "name": "KernelTime",
                      "type": "long"
                    },
                    {
                      "name": "DirectoryEnumeratedCount",
                      "type": "long"
                    },
                    {
                      "name": "AsepWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "SuspiciousDnsRequestCount",
                      "type": "long"
                    },
                    {
                      "name": "DocumentFileWrittenCount",
                      "type": "long"
                    },
                    {
                      "name": "ProtectVirtualMemoryCount",
                      "type": "long"
                    },
                    {
                      "name": "UserMemoryProtectExecutableRemoteCount",
                      "type": "long"
                    },
                    {
                      "name": "UserMemoryAllocateExecutableRemoteCount",
                      "type": "long"
                    },
                    {
                      "name": "ExecutableDeletedCount",
                      "type": "long"
                    },
                    {
                      "name": "RegKeySecurityDecreasedCount",
                      "type": "long"
                    },
                    {
                      "name": "InjectedThreadCount",
                      "type": "long"
                    },
                    {
                      "name": "NetworkModuleLoadCount",
                      "type": "long"
                    },
                    {
                      "name": "ThreadStartAddress",
                      "type": "string"
                    },
                    {
                      "name": "ThreadExecutionControlType",
                      "type": "string"
                    },
                    {
                      "name": "PayloadClassification",
                      "type": "string"
                    },
                    {
                      "name": "PayloadClassificationFlags",
                      "type": "string"
                    },
                    {
                      "name": "MemoryDescriptionFlags",
                      "type": "string"
                    },
                    {
                      "name": "WellKnownTargetFunction",
                      "type": "string"
                    },
                    {
                      "name": "RemoteAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_Registry_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Registry_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "RegObjectName",
                      "type": "string"
                    },
                    {
                      "name": "RegValueName",
                      "type": "string"
                    },
                    {
                      "name": "RegClassificationFlags",
                      "type": "string"
                    },
                    {
                      "name": "RegOperationType",
                      "type": "string"
                    },
                    {
                      "name": "TokenType",
                      "type": "string"
                    },
                    {
                      "name": "RegStringValue",
                      "type": "string"
                    },
                    {
                      "name": "RegType",
                      "type": "string"
                    },
                    {
                      "name": "RegClassificationIndex",
                      "type": "string"
                    },
                    {
                      "name": "AuthenticationId",
                      "type": "string"
                    },
                    {
                      "name": "RegNumericValue",
                      "type": "int"
                    },
                    {
                      "name": "RegBinaryValue",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_Secondary_Data_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_Secondary_Data_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "FolderName",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    },
                    {
                      "name": "AgentLoadFlags",
                      "type": "string"
                    },
                    {
                      "name": "AgentLocalTime",
                      "type": "string"
                    },
                    {
                      "name": "AgentTimeOffset",
                      "type": "string"
                    },
                    {
                      "name": "AgentVersion",
                      "type": "string"
                    },
                    {
                      "name": "BiosManufacturer",
                      "type": "string"
                    },
                    {
                      "name": "BiosVersion",
                      "type": "string"
                    },
                    {
                      "name": "ChassisType",
                      "type": "string"
                    },
                    {
                      "name": "City",
                      "type": "string"
                    },
                    {
                      "name": "ComputerName",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "ConfigIDBuild",
                      "type": "string"
                    },
                    {
                      "name": "Continent",
                      "type": "string"
                    },
                    {
                      "name": "Country",
                      "type": "string"
                    },
                    {
                      "name": "FalconGroupingTags",
                      "type": "string"
                    },
                    {
                      "name": "FirstSeen",
                      "type": "string"
                    },
                    {
                      "name": "HostHiddenStatus",
                      "type": "string"
                    },
                    {
                      "name": "MachineDomain",
                      "type": "string"
                    },
                    {
                      "name": "OU",
                      "type": "string"
                    },
                    {
                      "name": "PointerSize",
                      "type": "string"
                    },
                    {
                      "name": "ProductType",
                      "type": "string"
                    },
                    {
                      "name": "SensorGroupingTags",
                      "type": "string"
                    },
                    {
                      "name": "ServicePackMajor",
                      "type": "string"
                    },
                    {
                      "name": "SiteName",
                      "type": "string"
                    },
                    {
                      "name": "SystemManufacturer",
                      "type": "string"
                    },
                    {
                      "name": "SystemProductName",
                      "type": "string"
                    },
                    {
                      "name": "Timezone",
                      "type": "string"
                    },
                    {
                      "name": "Version",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "CompanyName",
                      "type": "string"
                    },
                    {
                      "name": "FileName",
                      "type": "string"
                    },
                    {
                      "name": "FileVersion",
                      "type": "string"
                    },
                    {
                      "name": "ProductName",
                      "type": "string"
                    },
                    {
                      "name": "ProductVersion",
                      "type": "string"
                    },
                    {
                      "name": "SHA256HashData",
                      "type": "string"
                    },
                    {
                      "name": "detectionCount",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "externalIP",
                      "type": "string"
                    },
                    {
                      "name": "installationTimestamp",
                      "type": "string"
                    },
                    {
                      "name": "SoftwareType",
                      "type": "string"
                    },
                    {
                      "name": "Category",
                      "type": "string"
                    },
                    {
                      "name": "GatewayIP",
                      "type": "string"
                    },
                    {
                      "name": "GatewayMAC",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceAlias",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceDescription",
                      "type": "string"
                    },
                    {
                      "name": "LocalAddressIP4",
                      "type": "string"
                    },
                    {
                      "name": "MAC",
                      "type": "string"
                    },
                    {
                      "name": "MACPrefix",
                      "type": "string"
                    },
                    {
                      "name": "CurrentLocalIP",
                      "type": "string"
                    },
                    {
                      "name": "FirstDiscoveredDate",
                      "type": "string"
                    },
                    {
                      "name": "LastDiscoveredBy",
                      "type": "string"
                    },
                    {
                      "name": "discovererCount",
                      "type": "string"
                    },
                    {
                      "name": "discoverer_aid",
                      "type": "string"
                    },
                    {
                      "name": "discoverer_devicetype",
                      "type": "string"
                    },
                    {
                      "name": "localipCount",
                      "type": "string"
                    },
                    {
                      "name": "subnet",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrike_User_Events_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "CrowdStrike_User_Events_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "DateTime",
                      "isDefaultDisplay": true,
                      "description": "The timestamp (UTC) reflecting the time in which the event was generated."
                    },
                    {
                      "name": "event_simpleName",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "long"
                    },
                    {
                      "name": "aip",
                      "type": "string"
                    },
                    {
                      "name": "aid",
                      "type": "string"
                    },
                    {
                      "name": "UserName",
                      "type": "string"
                    },
                    {
                      "name": "event_platform",
                      "type": "string"
                    },
                    {
                      "name": "ContextTimeStamp",
                      "type": "real"
                    },
                    {
                      "name": "name",
                      "type": "string"
                    },
                    {
                      "name": "ConfigBuild",
                      "type": "string"
                    },
                    {
                      "name": "CrowdStrikeId",
                      "type": "string"
                    },
                    {
                      "name": "ConfigStateHash",
                      "type": "string"
                    },
                    {
                      "name": "ContextProcessId",
                      "type": "string"
                    },
                    {
                      "name": "ContextThreadId",
                      "type": "string"
                    },
                    {
                      "name": "BoundingLimitCount",
                      "type": "long"
                    },
                    {
                      "name": "BoundingLimitDuration",
                      "type": "string"
                    },
                    {
                      "name": "Entitlements",
                      "type": "string"
                    },
                    {
                      "name": "EffectiveTransmissionClass",
                      "type": "string"
                    },
                    {
                      "name": "cid",
                      "type": "string"
                    },
                    {
                      "name": "OciContainerId",
                      "type": "string"
                    },
                    {
                      "name": "TreeId",
                      "type": "string"
                    },
                    {
                      "name": "UserRid",
                      "type": "string"
                    },
                    {
                      "name": "GroupRid",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceVersion",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientThreadId",
                      "type": "string"
                    },
                    {
                      "name": "RpcOpNum",
                      "type": "string"
                    },
                    {
                      "name": "InterfaceGuid",
                      "type": "string"
                    },
                    {
                      "name": "RpcClientProcessId",
                      "type": "string"
                    },
                    {
                      "name": "RpcNestingLevel",
                      "type": "string"
                    },
                    {
                      "name": "DomainSid",
                      "type": "string"
                    },
                    {
                      "name": "AdditionalFields",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition3'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition3'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "CrowdStrikeFalconS3CCPDefinition",
          "title": "CrowdStrike Falcon Data Replicator (AWS S3) (via Codeless Connector Framework)",
          "publisher": "Microsoft",
          "descriptionMarkdown": "The Crowdstrike Falcon Data Replicator (S3) connector provides the capability to ingest FDR event datainto Microsoft Sentinel from the AWS S3 bucket where the FDR logs have been streamed. The connector provides ability to get events from Falcon Agents which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.<p><span style='color:red; font-weight:bold;'>NOTE:</span></p><div style='margin-left:20px;'><p>1. CrowdStrike FDR license must be available & enabled.</p><p>2. The connector requires an IAM role to be configured on AWS to allow access to the AWS S3 bucket and may not be suitable for environments that leverage CrowdStrike - managed buckets.</p><p>3. For environments that leverage CrowdStrike-managed buckets, please configure the <strong>CrowdStrike Falcon Data Replicator (CrowdStrike-Managed AWS S3)</strong> connector.</p></div>",
          "graphQueriesTableName": "CrowdStrike_Additional_Events_CL",
          "graphQueries": [
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 User Logs",
              "baseQuery": "CrowdStrike_User_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Secondary Logs",
              "baseQuery": "CrowdStrike_Secondary_Data_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Additional Logs",
              "baseQuery": "CrowdStrike_Additional_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Auth Logs",
              "baseQuery": "CrowdStrike_Auth_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Registry Logs ",
              "baseQuery": "CrowdStrike_Registry_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Process Logs",
              "baseQuery": "CrowdStrike_Process_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Network Logs",
              "baseQuery": "CrowdStrike_Network_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 File Logs",
              "baseQuery": "CrowdStrike_File_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Audit Logs",
              "baseQuery": "CrowdStrike_Audit_Events_CL"
            },
            {
              "metricName": "Total events received",
              "legend": "CrowdStrike Falcon S3 Logs Test",
              "baseQuery": "CrowdStrike_DNS_Events_CL"
            }
          ],
          "sampleQueries": [
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_User_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Additional_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Registry_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Process_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Network_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Audit_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Auth_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_File_Events_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_Secondary_Data_CL\n | take 10"
            },
            {
              "description": "Get Sample of CrowdStrike Falcon S3 Logs",
              "query": "CrowdStrike_DNS_Events_CL\n | take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "CrowdStrike_User_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_User_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Additional_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Additional_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Registry_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Registry_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Process_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Process_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Network_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Network_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_File_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_File_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_DNS_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_DNS_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Auth_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Auth_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Secondary_Data_CL",
              "lastDataReceivedQuery": "CrowdStrike_Secondary_Data_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrike_Audit_Events_CL",
              "lastDataReceivedQuery": "CrowdStrike_Audit_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "read": true,
                  "write": true,
                  "delete": true,
                  "action": false
                }
              }
            ]
          },
          "instructionSteps": [
            {
              "instructions": [
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### Requirements: \n In order to use the Falcon Data Replicator feature the following are required: \n 1. **Subscription:** \n 1.1.  Falcon Data Replicator. \n 1.2. Falcon Insight XDR. \n 2. **Roles:** \n 2.1. Falcon Administrator."
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### 1. Setup your CrowdStrike & AWS environments \n To configure access on AWS, use the following two templates provided to set up the AWS environment. This will enable sending logs from an S3 bucket to your Log Analytics Workspace.\n #### For each template, create Stack in AWS: \n 1. Go to [AWS CloudFormation Stacks](https://aka.ms/awsCloudFormationLink#/stacks/create). \n 2. Choose the Specify template option, then Upload a template file by clicking on Choose file and selecting the appropriate CloudFormation template file provided below. click Choose file and select the downloaded template. \n 3. Click 'Next' and 'Create stack'."
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "Make sure that your bucket will be created in the same AWS region as your Falcon CID where the FDR feed is provisioned. \n | CrowdStrike region | AWS region | \n |-----------------|-----------|\n | US-1 | us-west-1    |\n | US-2 | us-west-2 | \n | EU-1 | eu-central-1 "
                  }
                },
                {
                  "type": "CopyableLabel",
                  "parameters": {
                    "label": "Template 1: OpenID connect authentication deployment",
                    "isMultiLine": true,
                    "fillWith": [
                      "Oidc"
                    ]
                  }
                },
                {
                  "type": "CopyableLabel",
                  "parameters": {
                    "label": "Template 2: AWS CrowdStrike resources deployment",
                    "isMultiLine": true,
                    "fillWith": [
                      "CrowdStrike"
                    ]
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### Using your own S3 Bucket \n In order to use your own S3 bucket you can refernace the following guide [Use your own S3 bucket](https://falcon.us-2.crowdstrike.com/documentation/page/fa572b1c/falcon-data-replicator#g4f79236) or follow this steps: \n 1. Create support case with the following Name: **Using Self S3 bucket for FDR** \n 2. Add the following information: \n 2.1. The Falcon CID where your FDR feed is provisioned \n 2.2. Indicate which types of events you wish to have provided in this new FDR feed. \n 2.3. Indicate which types of events you wish to have provided in this new FDR feed. \n 2.4. Do not use any partitions. "
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": " | Event type      | S3 prefix | \n |-----------------|-----------|\n | Primary Events | data/    |\n | Secondary Events | fdrv2/ "
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### 2. Connect new collectors \n To enable AWS S3 for Microsoft Sentinel, click the Add new collector button, fill the required information in the context pane and click on Connect."
                  }
                },
                {
                  "type": "DataConnectorsGrid",
                  "parameters": {
                    "mapping": [
                      {
                        "columnValue": "properties.roleArn",
                        "columnName": "Role ARN"
                      },
                      {
                        "columnValue": "properties.sqsUrls[0]",
                        "columnName": "Queue URL"
                      },
                      {
                        "columnValue": "properties.dcrConfig.streamName",
                        "columnName": "Stream name"
                      }
                    ],
                    "menuItems": [
                      "DeleteConnector"
                    ]
                  }
                },
                {
                  "type": "ContextPane",
                  "parameters": {
                    "contextPaneType": "DataConnectorsContextPane",
                    "title": "Add new controller",
                    "subtitle": "AWS S3 connector",
                    "label": "Add new collector",
                    "instructionSteps": [
                      {
                        "title": "Account details",
                        "instructions": [
                          {
                            "type": "Textbox",
                            "parameters": {
                              "label": "Role ARN",
                              "type": "text",
                              "name": "roleArn",
                              "validations": {
                                "required": true
                              }
                            }
                          },
                          {
                            "type": "Textbox",
                            "parameters": {
                              "label": "Queue URL",
                              "type": "text",
                              "name": "queueUrl",
                              "validations": {
                                "required": true
                              }
                            }
                          },
                          {
                            "type": "Dropdown",
                            "parameters": {
                              "label": "Data type",
                              "type": "text",
                              "name": "streamName",
                              "required": true,
                              "placeholder": "Select a data type",
                              "options": [
                                {
                                  "key": "Custom-CrowdstrikeStream",
                                  "text": "Primary Events"
                                },
                                {
                                  "key": "Custom-CrowdStrikeSecondary",
                                  "text": "Secondary Events"
                                }
                              ]
                            }
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            }
          ],
          "isConnectivityCriteriasMatchSome": false
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition3')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition3'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition3')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections3')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections3'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections3')]",
        "displayName": "CrowdStrike Falcon Data Replicator (AWS S3) (via Codeless Connector Framework)",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "streamName": {
              "type": "array"
            },
            "connectorDefinitionName": {
              "defaultValue": "CrowdStrike Falcon Data Replicator (AWS S3) (via Codeless Connector Framework)",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "roleArn": {
              "defaultValue": "roleArn",
              "type": "securestring",
              "minLength": 1
            },
            "queueUrl": {
              "defaultValue": "queueUrl",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections3": "[variables('_dataConnectorContentIdConnections3')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections3')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections3'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections3')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CrowdStrikeS3FalconPolling', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "AmazonWebServicesS3",
              "properties": {
                "connectorDefinitionName": "CrowdStrikeFalconS3CCPDefinition",
                "dataTypes": {
                  "logs": {
                    "state": "enabled"
                  }
                },
                "dcrConfig": {
                  "streamName": "[[parameters('streamName')[0]]",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "destinationTable": "[[concat(parameters('streamName')[0],'_CL')]",
                "dataFormat": {
                  "Format": "Json",
                  "IsCompressed": true,
                  "compressType": "Gzip"
                },
                "roleArn": "[[parameters('roleArn')]",
                "sqsUrls": [
                  "[[parameters('queueUrl')]"
                ]
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections3'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition4'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition4')]",
        "displayName": "CrowdStrike API Data Connector (via Codeless Connector Framework)",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition4'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "CrowdStrikeAPICCPDefinition",
                  "title": "CrowdStrike API Data Connector (via Codeless Connector Framework)",
                  "publisher": "Microsoft",
                  "descriptionMarkdown": "The [CrowdStrike Data Connector](https://www.crowdstrike.com/) allows ingesting logs from the CrowdStrike API into Microsoft Sentinel. This connector is built on the Microsoft Sentinel Codeless Connector Platform and uses the CrowdStrike API to fetch logs for Alerts, Detections, Hosts, Incidents, and Vulnerabilities. It supports DCR-based ingestion time transformations so that queries can run more efficiently.",
                  "graphQueriesTableName": "CrowdStrikeVulnerabilities",
                  "graphQueries": [
                    {
                      "metricName": "Total Vulnerability logs received",
                      "legend": "CrowdStrike Vulnerability Logs",
                      "baseQuery": "{{graphQueriesTableName}}"
                    },
                    {
                      "metricName": "Total Alert logs received",
                      "legend": "CrowdStrike Alert Logs",
                      "baseQuery": "CrowdStrikeAlerts"
                    },
                    {
                      "metricName": "Total Incident logs received",
                      "legend": "CrowdStrike Incident Logs",
                      "baseQuery": "CrowdStrikeIncidents"
                    },
                    {
                      "metricName": "Total Detection logs received",
                      "legend": "CrowdStrike Detection Logs",
                      "baseQuery": "CrowdStrikeDetections"
                    },
                    {
                      "metricName": "Total Host logs received",
                      "legend": "CrowdStrike Host Logs",
                      "baseQuery": "CrowdStrikeHosts"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Get sample of CrowdStrike Vulnerability logs",
                      "query": "{{graphQueriesTableName}}\n | take 10"
                    },
                    {
                      "description": "Get sample of CrowdStrike Alert logs",
                      "query": "CrowdStrikeAlerts\n | take 10"
                    },
                    {
                      "description": "Get sample of CrowdStrike Incident logs",
                      "query": "CrowdStrikeIncidents\n | take 10"
                    },
                    {
                      "description": "Get sample of CrowdStrike Detection logs",
                      "query": "CrowdStrikeDetections\n | take 10"
                    },
                    {
                      "description": "Get sample of CrowdStrike Host logs",
                      "query": "CrowdStrikeHosts\n | take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "{{graphQueriesTableName}}",
                      "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrikeAlerts",
                      "lastDataReceivedQuery": "CrowdStrikeAlerts\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrikeIncidents",
                      "lastDataReceivedQuery": "CrowdStrikeIncidents\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrikeDetections",
                      "lastDataReceivedQuery": "CrowdStrikeDetections\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "CrowdStrikeHosts",
                      "lastDataReceivedQuery": "CrowdStrikeHosts\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "availability": {
                    "isPreview": true,
                    "status": 1
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true,
                          "action": false
                        }
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "Configuration steps for the CrowdStrike API",
                      "description": "Follow the instructions below to obtain your CrowdStrike API credentials.",
                      "instructions": [
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### 1. Retrieve API URL\nLog in to your CrowdStrike Console and navigate to the API section to copy your Base API URL."
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### 2. Retrieve Client Credentials\nObtain your Client ID and Client Secret from the API credentials section in your CrowdStrike account."
                          }
                        },
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "Base API URL",
                            "placeholder": "https://api.us-2.crowdstrike.com",
                            "type": "text",
                            "name": "apiUrl",
                            "validations": {
                              "required": true
                            }
                          }
                        },
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "Client ID",
                            "placeholder": "Your Client ID",
                            "type": "text",
                            "name": "clientId",
                            "validations": {
                              "required": true
                            }
                          }
                        },
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "Client Secret",
                            "placeholder": "Your Client Secret",
                            "type": "password",
                            "name": "clientSecret",
                            "validations": {
                              "required": true
                            }
                          }
                        },
                        {
                          "type": "ConnectionToggleButton",
                          "parameters": {
                            "connectLabel": "Connect",
                            "disconnectLabel": "Disconnect",
                            "name": "toggle"
                          }
                        }
                      ]
                    }
                  ],
                  "isConnectivityCriteriasMatchSome": false
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition4')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition4'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition4')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections4')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "CrowdStrikeDCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId4')]",
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Microsoft-SentinelCrowdStrikeVulnerabilities"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ]
                  },
                  {
                    "streams": [
                      "Microsoft-SentinelCrowdStrikeAlerts"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ]
                  },
                  {
                    "streams": [
                      "Microsoft-SentinelCrowdStrikeIncidents"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ]
                  },
                  {
                    "streams": [
                      "Microsoft-SentinelCrowdStrikeDetections"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ]
                  },
                  {
                    "streams": [
                      "Microsoft-SentinelCrowdStrikeHosts"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ]
                  }
                ]
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition4'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition4'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "CrowdStrikeAPICCPDefinition",
          "title": "CrowdStrike API Data Connector (via Codeless Connector Framework)",
          "publisher": "Microsoft",
          "descriptionMarkdown": "The [CrowdStrike Data Connector](https://www.crowdstrike.com/) allows ingesting logs from the CrowdStrike API into Microsoft Sentinel. This connector is built on the Microsoft Sentinel Codeless Connector Platform and uses the CrowdStrike API to fetch logs for Alerts, Detections, Hosts, Incidents, and Vulnerabilities. It supports DCR-based ingestion time transformations so that queries can run more efficiently.",
          "graphQueriesTableName": "CrowdStrikeVulnerabilities",
          "graphQueries": [
            {
              "metricName": "Total Vulnerability logs received",
              "legend": "CrowdStrike Vulnerability Logs",
              "baseQuery": "{{graphQueriesTableName}}"
            },
            {
              "metricName": "Total Alert logs received",
              "legend": "CrowdStrike Alert Logs",
              "baseQuery": "CrowdStrikeAlerts"
            },
            {
              "metricName": "Total Incident logs received",
              "legend": "CrowdStrike Incident Logs",
              "baseQuery": "CrowdStrikeIncidents"
            },
            {
              "metricName": "Total Detection logs received",
              "legend": "CrowdStrike Detection Logs",
              "baseQuery": "CrowdStrikeDetections"
            },
            {
              "metricName": "Total Host logs received",
              "legend": "CrowdStrike Host Logs",
              "baseQuery": "CrowdStrikeHosts"
            }
          ],
          "sampleQueries": [
            {
              "description": "Get sample of CrowdStrike Vulnerability logs",
              "query": "{{graphQueriesTableName}}\n | take 10"
            },
            {
              "description": "Get sample of CrowdStrike Alert logs",
              "query": "CrowdStrikeAlerts\n | take 10"
            },
            {
              "description": "Get sample of CrowdStrike Incident logs",
              "query": "CrowdStrikeIncidents\n | take 10"
            },
            {
              "description": "Get sample of CrowdStrike Detection logs",
              "query": "CrowdStrikeDetections\n | take 10"
            },
            {
              "description": "Get sample of CrowdStrike Host logs",
              "query": "CrowdStrikeHosts\n | take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "{{graphQueriesTableName}}",
              "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrikeAlerts",
              "lastDataReceivedQuery": "CrowdStrikeAlerts\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrikeIncidents",
              "lastDataReceivedQuery": "CrowdStrikeIncidents\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrikeDetections",
              "lastDataReceivedQuery": "CrowdStrikeDetections\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "CrowdStrikeHosts",
              "lastDataReceivedQuery": "CrowdStrikeHosts\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "availability": {
            "isPreview": true,
            "status": 1
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true,
                  "action": false
                }
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Configuration steps for the CrowdStrike API",
              "description": "Follow the instructions below to obtain your CrowdStrike API credentials.",
              "instructions": [
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### 1. Retrieve API URL\nLog in to your CrowdStrike Console and navigate to the API section to copy your Base API URL."
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### 2. Retrieve Client Credentials\nObtain your Client ID and Client Secret from the API credentials section in your CrowdStrike account."
                  }
                },
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "Base API URL",
                    "placeholder": "https://api.us-2.crowdstrike.com",
                    "type": "text",
                    "name": "apiUrl",
                    "validations": {
                      "required": true
                    }
                  }
                },
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "Client ID",
                    "placeholder": "Your Client ID",
                    "type": "text",
                    "name": "clientId",
                    "validations": {
                      "required": true
                    }
                  }
                },
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "Client Secret",
                    "placeholder": "Your Client Secret",
                    "type": "password",
                    "name": "clientSecret",
                    "validations": {
                      "required": true
                    }
                  }
                },
                {
                  "type": "ConnectionToggleButton",
                  "parameters": {
                    "connectLabel": "Connect",
                    "disconnectLabel": "Disconnect",
                    "name": "toggle"
                  }
                }
              ]
            }
          ],
          "isConnectivityCriteriasMatchSome": false
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition4')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition4'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition4')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections4')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections4'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections4')]",
        "displayName": "CrowdStrike API Data Connector (via Codeless Connector Framework)",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "connectorDefinitionName": {
              "defaultValue": "CrowdStrike API Data Connector (via Codeless Connector Framework)",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "apiUrl": {
              "defaultValue": "apiUrl",
              "type": "securestring",
              "minLength": 1
            },
            "clientId": {
              "defaultValue": "clientId",
              "type": "securestring",
              "minLength": 1
            },
            "clientSecret": {
              "defaultValue": "clientSecret",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections4": "[variables('_dataConnectorContentIdConnections4')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections4')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections4'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections4')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CrowdStrikeVulnerabilitiesPoller', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "auth": {
                  "type": "OAuth2",
                  "ClientId": "[[parameters('clientId')]",
                  "ClientSecret": "[[parameters('clientSecret')]",
                  "GrantType": "client_credentials",
                  "TokenEndpoint": "[[concat(parameters('apiUrl'),'/oauth2/token')]",
                  "TokenEndpointHeaders": {
                    "Accept": "application/json",
                    "Content-Type": "application/x-www-form-urlencoded"
                  }
                },
                "request": {
                  "apiEndpoint": "[[concat(parameters('apiUrl'),'/spotlight/combined/vulnerabilities/v1')]",
                  "httpMethod": "GET",
                  "rateLimitQPS": 1,
                  "rateLimitConfig": {
                    "evaluation": {
                      "checkMode": "OnlyWhen429"
                    },
                    "extraction": {
                      "source": "CustomHeaders",
                      "headers": {
                        "limit": {
                          "name": "X-RateLimit-Limit",
                          "format": "Integer"
                        },
                        "remaining": {
                          "name": "X-RateLimit-Remaining",
                          "format": "Integer"
                        },
                        "reset": {
                          "name": "X-RateLimit-RetryAfter",
                          "format": "UnixTimeSeconds"
                        }
                      }
                    },
                    "retryStrategy": {
                      "useResetOrRetryAfterHeaders": true
                    }
                  },
                  "queryWindowInMin": 15,
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "retryCount": 5,
                  "timeoutInSeconds": 90,
                  "headers": {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
                  },
                  "queryParameters": {
                    "filter": "updated_timestamp:>'{_QueryWindowStartTime}'+updated_timestamp:<='{_QueryWindowEndTime}'",
                    "sort": "updated_timestamp.asc"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.resources"
                  ],
                  "format": "json"
                },
                "paging": {
                  "pagingType": "NextPageToken",
                  "nextPageTokenJsonPath": "$.meta.pagination.after",
                  "NextPageParaName": "after",
                  "pageSize": 500,
                  "pageSizeParameterName": "limit"
                },
                "connectorDefinitionName": "CrowdStrikeAPICCPDefinition",
                "dataType": "CrowdStrikeVulnerabilities",
                "dcrConfig": {
                  "streamName": "SENTINEL_CROWDSTRIKEVULNERABILITIES",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CrowdStrikeAlertsPoller', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "auth": {
                  "type": "OAuth2",
                  "ClientId": "[[parameters('clientId')]",
                  "ClientSecret": "[[parameters('clientSecret')]",
                  "GrantType": "client_credentials",
                  "TokenEndpoint": "[[concat(parameters('apiUrl'),'/oauth2/token')]",
                  "TokenEndpointHeaders": {
                    "Accept": "application/json",
                    "Content-Type": "application/x-www-form-urlencoded"
                  }
                },
                "request": {
                  "apiEndpoint": "[[concat(parameters('apiUrl'),'/alerts/combined/alerts/v1')]",
                  "httpMethod": "POST",
                  "rateLimitQPS": 1,
                  "rateLimitConfig": {
                    "evaluation": {
                      "checkMode": "OnlyWhen429"
                    },
                    "extraction": {
                      "source": "CustomHeaders",
                      "headers": {
                        "limit": {
                          "name": "X-RateLimit-Limit",
                          "format": "Integer"
                        },
                        "remaining": {
                          "name": "X-RateLimit-Remaining",
                          "format": "Integer"
                        },
                        "reset": {
                          "name": "X-RateLimit-RetryAfter",
                          "format": "UnixTimeSeconds"
                        }
                      }
                    },
                    "retryStrategy": {
                      "useResetOrRetryAfterHeaders": true
                    }
                  },
                  "queryWindowInMin": 15,
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "retryCount": 5,
                  "timeoutInSeconds": 120,
                  "isPostPayloadJson": true,
                  "headers": {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
                  },
                  "queryParametersTemplate": "{\r\n                    \"filter\": \"created_timestamp:>'{_QueryWindowStartTime}'+created_timestamp:<='{_QueryWindowEndTime}'\",\r\n                    \"sort\": \"created_timestamp.asc\"\r\n                }"
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.resources"
                  ],
                  "format": "json"
                },
                "paging": {
                  "pagingType": "PersistentToken",
                  "nextPageTokenJsonPath": "$.meta.pagination.after",
                  "nextPageParaName": "after",
                  "pageSize": 500
                },
                "connectorDefinitionName": "CrowdStrikeAPICCPDefinition",
                "dataType": "CrowdStrikeAlerts",
                "dcrConfig": {
                  "streamName": "SENTINEL_CROWDSTRIKEALERTS",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CrowdStrikeIncidentsPoller', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "auth": {
                  "type": "OAuth2",
                  "ClientId": "[[parameters('clientId')]",
                  "ClientSecret": "[[parameters('clientSecret')]",
                  "GrantType": "client_credentials",
                  "TokenEndpoint": "[[concat(parameters('apiUrl'),'/oauth2/token')]",
                  "TokenEndpointHeaders": {
                    "Accept": "application/json",
                    "Content-Type": "application/x-www-form-urlencoded"
                  }
                },
                "request": {
                  "apiEndpoint": "[[concat(parameters('apiUrl'),'/incidents/queries/incidents/v1')]",
                  "httpMethod": "GET",
                  "rateLimitQPS": 1,
                  "rateLimitConfig": {
                    "evaluation": {
                      "checkMode": "OnlyWhen429"
                    },
                    "extraction": {
                      "source": "CustomHeaders",
                      "headers": {
                        "limit": {
                          "name": "X-RateLimit-Limit",
                          "format": "Integer"
                        },
                        "remaining": {
                          "name": "X-RateLimit-Remaining",
                          "format": "Integer"
                        },
                        "reset": {
                          "name": "X-RateLimit-RetryAfter",
                          "format": "UnixTimeSeconds"
                        }
                      }
                    },
                    "retryStrategy": {
                      "useResetOrRetryAfterHeaders": true
                    }
                  },
                  "queryWindowInMin": 15,
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "retryCount": 5,
                  "timeoutInSeconds": 90,
                  "headers": {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
                  },
                  "queryParameters": {
                    "filter": "modified_timestamp:>'{_QueryWindowStartTime}'+modified_timestamp:<='{_QueryWindowEndTime}'",
                    "sort": "modified_timestamp.asc"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    ""
                  ],
                  "format": "json"
                },
                "paging": {
                  "pagingType": "Offset",
                  "offsetParaName": "offset",
                  "pageSize": 500,
                  "pageSizeParameterName": "limit"
                },
                "stepInfo": {
                  "stepType": "Nested",
                  "nextSteps": [
                    {
                      "stepId": "incidents_details",
                      "stepPlaceholdersParsingKql": "source | project res = parse_json(data) | project resources = res['resources'] | mvexpand resources | project Url_PlaceHolder = resources"
                    }
                  ]
                },
                "stepCollectorConfigs": {
                  "incidents_details": {
                    "shouldJoinNestedData": false,
                    "request": {
                      "apiEndpoint": "[[concat(parameters('apiUrl'),'/incidents/entities/incidents/GET/v1')]",
                      "httpMethod": "POST",
                      "rateLimitQPS": 1,
                      "queryWindowInMin": 5,
                      "retryCount": 5,
                      "timeoutInSeconds": 90,
                      "logResponseContent": true,
                      "isPostPayloadJson": true,
                      "headers": {
                        "Content-Type": "application/json",
                        "Accept": "application/json",
                        "User-Agent": "scuba"
                      },
                      "queryParametersTemplate": "{'ids': ['$Url_PlaceHolder$']}"
                    },
                    "response": {
                      "eventsJsonPaths": [
                        "$.resources"
                      ],
                      "format": "json"
                    }
                  }
                },
                "connectorDefinitionName": "CrowdStrikeAPICCPDefinition",
                "dataType": "CrowdStrikeIncidents",
                "dcrConfig": {
                  "streamName": "SENTINEL_CROWDSTRIKEINCIDENTS",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CrowdStrikeDetectionsPoller', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "auth": {
                  "type": "OAuth2",
                  "ClientId": "[[parameters('clientId')]",
                  "ClientSecret": "[[parameters('clientSecret')]",
                  "GrantType": "client_credentials",
                  "TokenEndpoint": "[[concat(parameters('apiUrl'),'/oauth2/token')]",
                  "TokenEndpointHeaders": {
                    "Accept": "application/json",
                    "Content-Type": "application/x-www-form-urlencoded"
                  }
                },
                "request": {
                  "apiEndpoint": "[[concat(parameters('apiUrl'),'/alerts/combined/alerts/v1')]",
                  "httpMethod": "POST",
                  "rateLimitQPS": 1,
                  "rateLimitConfig": {
                    "evaluation": {
                      "checkMode": "OnlyWhen429"
                    },
                    "extraction": {
                      "source": "CustomHeaders",
                      "headers": {
                        "limit": {
                          "name": "X-RateLimit-Limit",
                          "format": "Integer"
                        },
                        "remaining": {
                          "name": "X-RateLimit-Remaining",
                          "format": "Integer"
                        },
                        "reset": {
                          "name": "X-RateLimit-RetryAfter",
                          "format": "UnixTimeSeconds"
                        }
                      }
                    },
                    "retryStrategy": {
                      "useResetOrRetryAfterHeaders": true
                    }
                  },
                  "queryWindowInMin": 15,
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "retryCount": 5,
                  "timeoutInSeconds": 120,
                  "isPostPayloadJson": true,
                  "headers": {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
                  },
                  "queryParametersTemplate": "{\r\n                    \"filter\": \"product:'epp'+created_timestamp:>'{_QueryWindowStartTime}'+created_timestamp:<='{_QueryWindowEndTime}'+type:'ldt'\",\r\n                    \"sort\": \"created_timestamp.asc\"\r\n                }"
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.resources"
                  ],
                  "format": "json"
                },
                "paging": {
                  "pagingType": "PersistentToken",
                  "nextPageTokenJsonPath": "$.meta.pagination.after",
                  "nextPageParaName": "after",
                  "pageSize": 500
                },
                "connectorDefinitionName": "CrowdStrikeAPICCPDefinition",
                "dataType": "CrowdStrikeDetections",
                "dcrConfig": {
                  "streamName": "SENTINEL_CROWDSTRIKEDETECTIONS",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'CrowdStrikeHostsPoller', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "auth": {
                  "type": "OAuth2",
                  "ClientId": "[[parameters('clientId')]",
                  "ClientSecret": "[[parameters('clientSecret')]",
                  "GrantType": "client_credentials",
                  "TokenEndpoint": "[[concat(parameters('apiUrl'),'/oauth2/token')]",
                  "TokenEndpointHeaders": {
                    "Accept": "application/json",
                    "Content-Type": "application/x-www-form-urlencoded"
                  }
                },
                "request": {
                  "apiEndpoint": "[[concat(parameters('apiUrl'),'/devices/combined/devices/v1')]",
                  "httpMethod": "GET",
                  "rateLimitQPS": 1,
                  "rateLimitConfig": {
                    "evaluation": {
                      "checkMode": "OnlyWhen429"
                    },
                    "extraction": {
                      "source": "CustomHeaders",
                      "headers": {
                        "limit": {
                          "name": "X-RateLimit-Limit",
                          "format": "Integer"
                        },
                        "remaining": {
                          "name": "X-RateLimit-Remaining",
                          "format": "Integer"
                        },
                        "reset": {
                          "name": "X-RateLimit-RetryAfter",
                          "format": "UnixTimeSeconds"
                        }
                      }
                    },
                    "retryStrategy": {
                      "useResetOrRetryAfterHeaders": true
                    }
                  },
                  "queryWindowInMin": 15,
                  "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                  "retryCount": 5,
                  "timeoutInSeconds": 90,
                  "headers": {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
                  },
                  "queryParameters": {
                    "filter": "last_seen:>'{_QueryWindowStartTime}'+last_seen:<='{_QueryWindowEndTime}'",
                    "sort": "last_seen.asc"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.resources"
                  ],
                  "format": "json"
                },
                "paging": {
                  "pagingType": "NextPageToken",
                  "nextPageTokenJsonPath": "$.meta.pagination.next",
                  "NextPageParaName": "offset",
                  "pageSize": 500,
                  "pageSizeParameterName": "limit"
                },
                "connectorDefinitionName": "CrowdStrikeAPICCPDefinition",
                "dataType": "CrowdStrikeHosts",
                "dcrConfig": {
                  "streamName": "SENTINEL_CROWDSTRIKEHOSTS",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections4'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject1').parserTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdStrikeFalconEventStream Data Parser with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject1').parserVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject1')._parserName1]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Parser for CrowdStrikeFalconEventStream",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "CrowdStrikeFalconEventStream",
                "query": "CommonSecurityLog\n| where DeviceVendor == \"CrowdStrike\" and DeviceProduct == \"FalconHost\"\n| extend DeviceCustomNumber1 = coalesce(column_ifexists(\"FieldDeviceCustomNumber1\", long(null)),DeviceCustomNumber1),\n         DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)),DeviceCustomNumber2),\n         DeviceCustomNumber3 = coalesce(column_ifexists(\"FieldDeviceCustomNumber3\", long(null)),DeviceCustomNumber3)\n// Additional Extensions\n| extend EventType = extract(@\"cat=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         Outcome = extract(@\"outcome=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         Technique = extract(@\"reason=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         PatternDisposition = extract(@\"CSMTRPatternDisposition=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         SessionStartTime = unixtime_seconds_todatetime(toint(extract(@\"sessionStartTimestamp=([^;]+)(\\;|$)\",1,AdditionalExtensions))),\n         SessionEndTime = unixtime_seconds_todatetime(toint(extract(@\"sessionEndTimestamp=([^;]+)(\\;|$)\",1,AdditionalExtensions)))\n| extend EventType = coalesce(column_ifexists(\"DeviceEventCategory\",\"\"),EventType), \n         Outcome = coalesce(column_ifexists(\"EventOutcome\",\"\"),Outcome),\n\t\t Technique = coalesce(column_ifexists(\"Reason\",\"\"),Technique)\n// Device Custom Number Values\n| extend ParentProcessId = iif(DeviceCustomNumber1Label == \"ParentProcessId\" , DeviceCustomNumber1, toint(\"\")),\n         ChildProcessId = iif(DeviceCustomNumber2Label == \"ProcessId\" , DeviceCustomNumber2, toint(\"\")),\n         Offset = iif(DeviceCustomNumber3Label == \"Offset\", DeviceCustomNumber3, toint(\"\"))\n| project-away DeviceCustomNumber1Label, DeviceCustomNumber1,DeviceCustomNumber2Label, DeviceCustomNumber2,DeviceCustomNumber3Label, DeviceCustomNumber3\n// Device Custom Date Values\n| extend EventTimestamp = iif(DeviceCustomDate1Label == \"Timestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         ExeWrittenTime = iif(DeviceCustomDate1Label == \"ExeWrittenTimestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         DnsRequestTime = iif(DeviceCustomDate1Label == \"DNS Request Time\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         NetworkAccessTime = iif(DeviceCustomDate1Label == \"Network Access Timestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         DocAccessTime = iif(DeviceCustomDate1Label == \"DocAccessTimestamp\" or DeviceCustomDate1Label == \"Document Accessed Timestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         HashSpreadingEventTime = iif(DeviceCustomDate2Label == \"HashSpreadingEventTime\", todatetime(DeviceCustomDate2), todatetime(\"\")),\n         HashSpreadingSensorTime = iif(DeviceCustomDate2Label == \"HashSpreadingSensorEventTime\", todatetime(DeviceCustomDate2), todatetime(\"\"))\n| project-away DeviceCustomDate1Label, DeviceCustomDate1, DeviceCustomDate2Label, DeviceCustomDate2\n// Device Custom String Values\n| extend ScanResultName = iif(DeviceCustomString1Label == \"ScanResultNam\", DeviceCustomString1, \"\"),\n         WrittenExeFileName = iif(DeviceCustomString2Label == \"WrittenExeFileName\", DeviceCustomString2, \"\"),\n         QuarantineFileSHA256 = iif(DeviceCustomString2Label == \"QuarantineFileSHA256\", DeviceCustomString2, \"\"),\n         ScanResultEngine = iif(DeviceCustomString2Label == \"ScanResultEngine\", DeviceCustomString2, \"\"),\n         AccessedDocFileName = iif(DeviceCustomString2Label == \"AccessedDocFileName\", DeviceCustomString2, \"\"),\n         WrittenExeFilePath = iif(DeviceCustomString3Label == \"WrittenExeFilePath\", DeviceCustomString3, \"\"),\n         AccessedDocFilePath = iif(DeviceCustomString3Label == \"AccessedDocFilePath\", DeviceCustomString3, \"\"),\n         QuarantineFilePath = iif(DeviceCustomString3Label == \"QuarantineFilePath\", DeviceCustomString3, \"\"),\n         ScanResultVersion = iif(DeviceCustomString4Label == \"ScanResultVersion\", DeviceCustomString4, \"\"),\n         CommandLine = iif(DeviceCustomString5Label == \"CommandLine\", DeviceCustomString5, \"\"),\n         FalconHostLink = iif(DeviceCustomString6Label == \"FalconHostLink\", DeviceCustomString6, \"\")\n| project-away DeviceCustomString1Label, DeviceCustomString1, DeviceCustomString2Label, DeviceCustomString2, DeviceCustomString3Label, DeviceCustomString3, DeviceCustomString4Label, DeviceCustomString4, DeviceCustomString5Label, DeviceCustomString5, DeviceCustomString6Label, DeviceCustomString6\n// Data Field Normalization\n| project-rename DstHostName = DestinationHostName,\n         DstNtDomain = DestinationNTDomain,\n         DstUserName = DestinationUserName,\n         DstIpAddr = DestinationTranslatedAddress,\n         SrcMacAddr = SourceMACAddress,\n         SrcIpAddr = SourceIP\n| extend EventType = iif(DeviceEventClassID == \"DetectionSummaryEvent\" or DeviceEventClassID contains \"Detection Summary Event\", \"DetectionSummaryEvent\", EventType), \n         ReceiptTime = unixtime_milliseconds_todatetime(tolong(ReceiptTime)),\n         SensorId = extract(@\"/detail/([^/]+)\\/\",1,FalconHostLink),\n         Severity = case(LogSeverity == 1, \"Informational\",\n                         LogSeverity == 2, \"Low\",\n                         LogSeverity == 3, \"Medium\",\n                         LogSeverity == 4, \"High\",\n                         LogSeverity == 5, \"Critical\",\n                         LogSeverity)\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
              "dependsOn": [
                "[variables('parserObject1')._parserId1]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdStrikeFalconEventStream Data Parser')]",
                "contentId": "[variables('parserObject1').parserContentId1]",
                "kind": "Parser",
                "version": "[variables('parserObject1').parserVersion1]",
                "source": {
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "contentKind": "Parser",
        "displayName": "Parser for CrowdStrikeFalconEventStream",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "version": "[variables('parserObject1').parserVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject1')._parserName1]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Parser for CrowdStrikeFalconEventStream",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "CrowdStrikeFalconEventStream",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"CrowdStrike\" and DeviceProduct == \"FalconHost\"\n| extend DeviceCustomNumber1 = coalesce(column_ifexists(\"FieldDeviceCustomNumber1\", long(null)),DeviceCustomNumber1),\n         DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)),DeviceCustomNumber2),\n         DeviceCustomNumber3 = coalesce(column_ifexists(\"FieldDeviceCustomNumber3\", long(null)),DeviceCustomNumber3)\n// Additional Extensions\n| extend EventType = extract(@\"cat=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         Outcome = extract(@\"outcome=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         Technique = extract(@\"reason=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         PatternDisposition = extract(@\"CSMTRPatternDisposition=([^;]+)(\\;|$)\",1,AdditionalExtensions),\n         SessionStartTime = unixtime_seconds_todatetime(toint(extract(@\"sessionStartTimestamp=([^;]+)(\\;|$)\",1,AdditionalExtensions))),\n         SessionEndTime = unixtime_seconds_todatetime(toint(extract(@\"sessionEndTimestamp=([^;]+)(\\;|$)\",1,AdditionalExtensions)))\n| extend EventType = coalesce(column_ifexists(\"DeviceEventCategory\",\"\"),EventType), \n         Outcome = coalesce(column_ifexists(\"EventOutcome\",\"\"),Outcome),\n\t\t Technique = coalesce(column_ifexists(\"Reason\",\"\"),Technique)\n// Device Custom Number Values\n| extend ParentProcessId = iif(DeviceCustomNumber1Label == \"ParentProcessId\" , DeviceCustomNumber1, toint(\"\")),\n         ChildProcessId = iif(DeviceCustomNumber2Label == \"ProcessId\" , DeviceCustomNumber2, toint(\"\")),\n         Offset = iif(DeviceCustomNumber3Label == \"Offset\", DeviceCustomNumber3, toint(\"\"))\n| project-away DeviceCustomNumber1Label, DeviceCustomNumber1,DeviceCustomNumber2Label, DeviceCustomNumber2,DeviceCustomNumber3Label, DeviceCustomNumber3\n// Device Custom Date Values\n| extend EventTimestamp = iif(DeviceCustomDate1Label == \"Timestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         ExeWrittenTime = iif(DeviceCustomDate1Label == \"ExeWrittenTimestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         DnsRequestTime = iif(DeviceCustomDate1Label == \"DNS Request Time\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         NetworkAccessTime = iif(DeviceCustomDate1Label == \"Network Access Timestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         DocAccessTime = iif(DeviceCustomDate1Label == \"DocAccessTimestamp\" or DeviceCustomDate1Label == \"Document Accessed Timestamp\", todatetime(DeviceCustomDate1), todatetime(\"\")),\n         HashSpreadingEventTime = iif(DeviceCustomDate2Label == \"HashSpreadingEventTime\", todatetime(DeviceCustomDate2), todatetime(\"\")),\n         HashSpreadingSensorTime = iif(DeviceCustomDate2Label == \"HashSpreadingSensorEventTime\", todatetime(DeviceCustomDate2), todatetime(\"\"))\n| project-away DeviceCustomDate1Label, DeviceCustomDate1, DeviceCustomDate2Label, DeviceCustomDate2\n// Device Custom String Values\n| extend ScanResultName = iif(DeviceCustomString1Label == \"ScanResultNam\", DeviceCustomString1, \"\"),\n         WrittenExeFileName = iif(DeviceCustomString2Label == \"WrittenExeFileName\", DeviceCustomString2, \"\"),\n         QuarantineFileSHA256 = iif(DeviceCustomString2Label == \"QuarantineFileSHA256\", DeviceCustomString2, \"\"),\n         ScanResultEngine = iif(DeviceCustomString2Label == \"ScanResultEngine\", DeviceCustomString2, \"\"),\n         AccessedDocFileName = iif(DeviceCustomString2Label == \"AccessedDocFileName\", DeviceCustomString2, \"\"),\n         WrittenExeFilePath = iif(DeviceCustomString3Label == \"WrittenExeFilePath\", DeviceCustomString3, \"\"),\n         AccessedDocFilePath = iif(DeviceCustomString3Label == \"AccessedDocFilePath\", DeviceCustomString3, \"\"),\n         QuarantineFilePath = iif(DeviceCustomString3Label == \"QuarantineFilePath\", DeviceCustomString3, \"\"),\n         ScanResultVersion = iif(DeviceCustomString4Label == \"ScanResultVersion\", DeviceCustomString4, \"\"),\n         CommandLine = iif(DeviceCustomString5Label == \"CommandLine\", DeviceCustomString5, \"\"),\n         FalconHostLink = iif(DeviceCustomString6Label == \"FalconHostLink\", DeviceCustomString6, \"\")\n| project-away DeviceCustomString1Label, DeviceCustomString1, DeviceCustomString2Label, DeviceCustomString2, DeviceCustomString3Label, DeviceCustomString3, DeviceCustomString4Label, DeviceCustomString4, DeviceCustomString5Label, DeviceCustomString5, DeviceCustomString6Label, DeviceCustomString6\n// Data Field Normalization\n| project-rename DstHostName = DestinationHostName,\n         DstNtDomain = DestinationNTDomain,\n         DstUserName = DestinationUserName,\n         DstIpAddr = DestinationTranslatedAddress,\n         SrcMacAddr = SourceMACAddress,\n         SrcIpAddr = SourceIP\n| extend EventType = iif(DeviceEventClassID == \"DetectionSummaryEvent\" or DeviceEventClassID contains \"Detection Summary Event\", \"DetectionSummaryEvent\", EventType), \n         ReceiptTime = unixtime_milliseconds_todatetime(tolong(ReceiptTime)),\n         SensorId = extract(@\"/detail/([^/]+)\\/\",1,FalconHostLink),\n         Severity = case(LogSeverity == 1, \"Informational\",\n                         LogSeverity == 2, \"Low\",\n                         LogSeverity == 3, \"Medium\",\n                         LogSeverity == 4, \"High\",\n                         LogSeverity == 5, \"Critical\",\n                         LogSeverity)\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
      "dependsOn": [
        "[variables('parserObject1')._parserId1]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdStrikeFalconEventStream Data Parser')]",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "kind": "Parser",
        "version": "[variables('parserObject1').parserVersion1]",
        "source": {
          "kind": "Solution",
          "name": "CrowdStrike Falcon Endpoint Protection",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject2').parserTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdstrikeReplicator Data Parser with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject2').parserVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject2')._parserName2]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Union Parser for all CrowdStrike Falcon Data Replicator V1 and V2 events",
                "category": "CrowdStrikeParser",
                "functionAlias": "CrowdStrikeReplicator",
                "query": "let parser = (\nstarttime: datetime=datetime(null), \nendtime: datetime=datetime(null)\n){    \nlet emptytable = datatable( \n    TimeGenerated: datetime, \n    custom_fields_message_s: string, \n    event_simpleName: string,  \n    aip: string, \n    aid: string)[];\nlet CrowdStrikeFDRv1Events = \nunion isfuzzy = true\n    emptytable,\n    CrowdstrikeReplicatorLogs_CL\n| where (isnull(starttime) or TimeGenerated >= endtime)\n    and (isnull(starttime) or TimeGenerated <= endtime)\n| extend customFields = parse_json(custom_fields_message_s)\n| extend CSFDRBaseFields = pack_all()\n| extend \n    EventMessage = tostring(CSFDRBaseFields.event_simpleName_s),\n    ContextTimeStamp = toreal(CSFDRBaseFields.timestamp_t),\n    Aip = tostring(CSFDRBaseFields.aip_s),\n    DvcInterfaceGuid = replace_string(tostring(CSFDRBaseFields.aid_g), '-', ''),\n    EventType = tostring(CSFDRBaseFields.EventType_s),  \n    LogonType = tostring(CSFDRBaseFields.LogonType_s),  \n    HostProcessType = tostring(CSFDRBaseFields.HostProcessType_s),  \n    UserPrincipal = tostring(CSFDRBaseFields.UserPrincipal_s),  \n    DomainName = tostring(CSFDRBaseFields.DomainName_s),                \n    RemoteAddressIP = tostring(CSFDRBaseFields.RemoteAddressIP_s),  \n    ConnectionDirection = tostring(CSFDRBaseFields.ConnectionDirection_s),  \n    TargetFileName = tostring(CSFDRBaseFields.TargetFileName_s),  \n    LocalAddressIP4 = tostring(CSFDRBaseFields.LocalAddressIP4_s),  \n    IsOnRemovableDisk = tostring(CSFDRBaseFields.IsOnRemovableDisk_s), \n    UserIsAdmin = tostring(CSFDRBaseFields.UserIsAdmin_s), \n    LogonTime = tostring(CSFDRBaseFields.LogonTime_s), \n    LogonDomain = tostring(CSFDRBaseFields.LogonDomain_s), \n    RemoteAccount = tostring(CSFDRBaseFields.RemoteAccount_s), \n    UserId = tostring(CSFDRBaseFields.UserId_s), \n    Prevalence = tostring(CSFDRBaseFields.Prevalence_s), \n    CurrentProcess = tostring(CSFDRBaseFields.CurrentProcess_s), \n    TargetProcessId = tostring(CSFDRBaseFields.TargetProcessId_s), \n    ProcessStartTime = tostring(CSFDRBaseFields.ProcessStartTime_s), \n    UserName = tostring(CSFDRBaseFields.UserName_s), \n    DeviceProductId = tostring(CSFDRBaseFields.DeviceProductId_s), \n    TargetSHA256HashData = tostring(CSFDRBaseFields.TargetSHA256HashData_s), \n    SHA256HashData = tostring(CSFDRBaseFields.SHA256HashData_s), \n    MD5HashData =  tostring(CSFDRBaseFields.MD5HashData_g),\n    TargetDirectoryName = tostring(CSFDRBaseFields.TargetDirectoryName_s), \n    FirewallRule = tostring(CSFDRBaseFields.FirewallRule_s), \n    TaskName = tostring(CSFDRBaseFields.TaskName_s), \n    TaskExecCommand = tostring(CSFDRBaseFields.TaskExecCommand_s), \n    TargetAddress = tostring(CSFDRBaseFields.TargetAddress_s), \n    SourceFileName = tostring(CSFDRBaseFields.SourceFileName_s), \n    RegObjectName = tostring(CSFDRBaseFields.RegObjectName_s), \n    RegValueName = tostring(CSFDRBaseFields.RegValueName_g), \n    ServiceObjectName = tostring(CSFDRBaseFields.ServiceObjectName_s), \n    RegistryPath = tostring(CSFDRBaseFields.RegistryPath_s), \n    RawProcessId = tostring(CSFDRBaseFields.RawProcessId_s), \n    event_platform = tostring(CSFDRBaseFields.event_platform_s), \n    CommandLine = tostring(CSFDRBaseFields.CommandLine_s), \n    ParentProcessId = tostring(CSFDRBaseFields.ParentProcessId_s), \n    ParentCommandLine = tostring(CSFDRBaseFields.ParentCommandLine_s), \n    ParentBaseFileName = tostring(CSFDRBaseFields.ParentBaseFileName_s), \n    GrandParentBaseFileName = tostring(CSFDRBaseFields.GrandParentBaseFileName_s), \n    RemotePort = tostring(CSFDRBaseFields.RemotePort_s), \n    VolumeDeviceType = tostring(CSFDRBaseFields.VolumeDeviceType_s), \n    VolumeName = tostring(CSFDRBaseFields.VolumeName_s), \n    ClientComputerName = tostring(CSFDRBaseFields.ClientComputerName_s), \n    ProductId = tostring(CSFDRBaseFields.ProductId_s), \n    ComputerName = tostring(CSFDRBaseFields.ComputerName_s),\n    FileMode = tostring(CSFDRBaseFields.customFields.FileMode),\n    DeviceSerialNumber = tostring(customFields.DeviceSerialNumber),\n    IcmpCode = tostring(customFields.IcmpCode),\n    IcmpType = tostring(customFields.IcmpType),\n    LastUpdateInstalledTime = tostring(customFields.LastUpdateInstalledTime),\n    RebootRequired = tostring(customFields.RebootRequired),\n    PendingUpdateIds = tostring(customFields.PendingUpdateIds),\n    InstalledUpdateIds = tostring(customFields.InstalledUpdateIds),\n    InstalledUpdateExtendedStatus = tostring(customFields.InstalledUpdateExtendedStatus),\n    SupersededUpdateIds = tostring(customFields.SupersededUpdateIds),\n    ConfigurationDescriptorValue = tostring(customFields.ConfigurationDescriptorValue),\n    ConfigurationDescriptorAttributes = tostring(customFields.ConfigurationDescriptorAttributes),\n    DeviceDescriptorUniqueIdentifier = tostring(customFields.DeviceDescriptorUniqueIdentifier),\n    ConfigurationDescriptorName = tostring(customFields.ConfigurationDescriptorName),\n    ConfigurationDescriptorNumInterfaces = tostring(customFields.ConfigurationDescriptorNumInterfaces),\n    ConfigurationDescriptorMaxPowerDraw = tostring(customFields.ConfigurationDescriptorMaxPowerDraw),\n    ScreenshotsTakenCount = tostring(customFields.ScreenshotsTakenCount),\n    ExitCode = tostring(customFields.ExitCode),\n    DstUserIdentity = tostring(customFields.DstUserIdentity),\n    NetworkListenCount = tostring(customFields.NetworkListenCount),\n    SuspiciousRawDiskReadCount = tostring(customFields.SuspiciousRawDiskReadCount),\n    NetworkBindCount = tostring(customFields.NetworkBindCount),\n    NetworkRecvAcceptCount = tostring(customFields.NetworkRecvAcceptCount),\n    ContextData = tostring(customFields.ContextData),\n    Id = tostring(customFields.Id),\n    NewExecutableWrittenCount = tostring(customFields.NewExecutableWrittenCount),\n    ExeAndServiceCount = tostring(customFields.ExeAndServiceCount),\n    NetworkCloseCount = tostring(customFields.NetworkCloseCount),\n    SuspectStackCount = tostring(customFields.SuspectStackCount),\n    CLICreationCount = tostring(customFields.CLICreationCount),\n    UnsignedModuleLoadCount = tostring(customFields.UnsignedModuleLoadCount),\n    UserTime = tostring(customFields.UserTime),\n    AllocateVirtualMemoryCount = tostring(customFields.AllocateVirtualMemoryCount),\n    ContextProcessId = tostring(customFields.ContextProcessId),\n    ServiceEventCount = tostring(customFields.ServiceEventCount),\n    SnapshotFileOpenCount = tostring(customFields.SnapshotFileOpenCount),\n    RemovableDiskFileWrittenCount = tostring(customFields.RemovableDiskFileWrittenCount),\n    InjectedDllCount = tostring(customFields.InjectedDllCount),\n    ModuleLoadCount = tostring(customFields.ModuleLoadCount),\n    UserMemoryProtectExecutableCount = tostring(customFields.UserMemoryProtectExecutableCount),\n    NetworkCapableAsepWriteCount = tostring(customFields.NetworkCapableAsepWriteCount),\n    DnsRequestCount = tostring(customFields.DnsRequestCount),\n    ArchiveFileWrittenCount = tostring(customFields.ArchiveFileWrittenCount),\n    Entitlements = tostring(customFields.Entitlements),\n    Name = tostring(customFields.Name),\n    SetThreadContextCount = tostring(customFields.SetThreadContextCount),\n    SuspiciousCredentialModuleLoadCount = tostring(customFields.SuspiciousCredentialModuleLoadCount),\n    Cid = tostring(customFields.Cid),\n    FileDeletedCount = tostring(customFields.FileDeletedCount),\n    UserMemoryAllocateExecutableCount = tostring(customFields.UserMemoryAllocateExecutableCount),\n    DirectoryCreatedCount = tostring(customFields.DirectoryCreatedCount),\n    NetworkConnectCountUdp = tostring(customFields.NetworkConnectCountUdp),\n    QueueApcCount = tostring(customFields.QueueApcCount),\n    ContextThreadId = tostring(customFields.ContextThreadId),\n    SuspiciousFontLoadCount = tostring(customFields.SuspiciousFontLoadCount),\n    ConHostId = tostring(customFields.ConHostId),\n    NetworkConnectCount = tostring(customFields.NetworkConnectCount),\n    BinaryExecutableWrittenCount = tostring(customFields.BinaryExecutableWrittenCount),\n    CycleTime = tostring(customFields.CycleTime),\n    DvcOs = tostring(customFields.DvcOs),\n    ConHostProcessId = tostring(customFields.ConHostProcessId),\n    PrivilegedProcessHandleCount = tostring(customFields.PrivilegedProcessHandleCount),\n    MaxThreadCount = tostring(customFields.MaxThreadCount),\n    ImageSubsystem = tostring(customFields.ImageSubsystem),\n    GenericFileWrittenCount = tostring(customFields.GenericFileWrittenCount),\n    EffectiveTransmissionClass = tostring(customFields.EffectiveTransmissionClass),\n    ScriptEngineInvocationCount = tostring(customFields.ScriptEngineInvocationCount),\n    RunDllInvocationCount = tostring(customFields.RunDllInvocationCount),\n    CreateProcessCount = toreal(customFields.CreateProcessCount),\n    KernelTime = tostring(customFields.KernelTime),\n    DirectoryEnumeratedCount = tostring(customFields.DirectoryEnumeratedCount),\n    ConfigStateHash = tostring(customFields.ConfigStateHash),\n    AsepWrittenCount = tostring(customFields.AsepWrittenCount),\n    SuspiciousDnsRequestCount = tostring(customFields.SuspiciousDnsRequestCount),\n    DocumentFileWrittenCount = tostring(customFields.DocumentFileWrittenCount),\n    ProtectVirtualMemoryCount = tostring(customFields.ProtectVirtualMemoryCount),\n    ProcessHashSha256 = tostring(customFields.ProcessHashSha256),\n    UserMemoryProtectExecutableRemoteCount = tostring(customFields.UserMemoryProtectExecutableRemoteCount),\n    ConfigBuild = tostring(customFields.ConfigBuild),\n    UserMemoryAllocateExecutableRemoteCount = tostring(customFields.UserMemoryAllocateExecutableRemoteCount),\n    ExecutableDeletedCount = tostring(customFields.ExecutableDeletedCount),\n    RegKeySecurityDecreasedCount = tostring(customFields.RegKeySecurityDecreasedCount),\n    InjectedThreadCount = tostring(customFields.InjectedThreadCount),\n    NetworkModuleLoadCount = tostring(customFields.NetworkModuleLoadCount),\n    WindowTitle = tostring(customFields.WindowTitle),\n    ProcessCreateFlags = tostring(customFields.ProcessCreateFlags),\n    IntegrityLevel = tostring(customFields.IntegrityLevel),\n    SourceProcessId = tostring(customFields.SourceProcessId),\n    ProcessHashSha1 = tostring(customFields.ProcessHashSha1),\n    TokenType = tostring(customFields.TokenType),\n    ProcessEndTime = toreal(customFields.ProcessEndTime),\n    AuthenticodeHashData = tostring(customFields.AuthenticodeHashData),\n    SessionId = tostring(customFields.SessionId),\n    Tags = tostring(customFields.Tags),\n    ProcessHashMd5 = tostring(customFields.ProcessHashMd5),\n    ProcessSxsFlags = tostring(customFields.ProcessSxsFlags),\n    AuthenticationId = tostring(customFields.AuthenticationId),\n    WindowFlags = tostring(customFields.WindowFlags),\n    ProcessCommandLine = tostring(customFields.ProcessCommandLine),\n    ParentAuthenticationId = tostring(customFields.ParentAuthenticationId),\n    FileName = tostring(customFields.FileName),\n    SourceThreadId = tostring(customFields.SourceThreadId),\n    ProcessParameterFlags = tostring(customFields.ProcessParameterFlags),\n    SignInfoFlags = tostring(customFields.SignInfoFlags),\n    ChannelVersion = tostring(customFields.ChannelVersion),\n    ChannelVersionRequired = tostring(customFields.ChannelVersionRequired),\n    ChannelId = tostring(customFields.ChannelId),\n    DnsResponseType = tostring(customFields.DnsResponseType),\n    IP4Records = tostring(customFields.IP4Records),\n    CNAMERecords = tostring(customFields.CNAMERecords),\n    QueryStatus = tostring(customFields.QueryStatus),\n    InterfaceIndex = tostring(customFields.InterfaceIndex),\n    DualRequest = tostring(customFields.DualRequest),\n    FirstIP4Record = tostring(customFields.FirstIP4Record),\n    UrlDomain = tostring(customFields.UrlDomain),\n    RespondingDnsServer = tostring(customFields.RespondingDnsServer),\n    RequestType = tostring(customFields.RequestType),\n    FirewallRuleId = tostring(customFields.FirewallRuleId),\n    Options = tostring(customFields.Options),\n    MinorFunction = tostring(customFields.MinorFunction),\n    FileIdentifier = tostring(customFields.FileIdentifier),\n    Information = tostring(customFields.Information),\n    ShareAccess = tostring(customFields.ShareAccess),\n    FileObject = tostring(customFields.FileObject),\n    FilePermission = tostring(customFields.FilePermission),\n    Status = tostring(customFields.Status),\n    IrpFlags = tostring(customFields.IrpFlags),\n    MajorFunction = tostring(customFields.MajorFunction),\n    DesiredAccess = tostring(customFields.DesiredAccess),\n    OperationFlags = tostring(customFields.OperationFlags),\n    CallStackModuleNamesVersion = tostring(customFields.CallStackModuleNamesVersion),\n    CsaProcessDataCollectionInstanceId = tostring(customFields.CsaProcessDataCollectionInstanceId),\n    CallStackModuleNames = tostring(customFields.CallStackModuleNames),\n    CreateProcessType = tostring(customFields.CreateProcessType),\n    EtwRawProcessId = tostring(customFields.EtwRawProcessId),\n    EventMax = tostring(customFields.EventMax),\n    EtwRawThreadId = tostring(customFields.EtwRawThreadId),\n    Flags = tostring(customFields.Flags),\n    EventMin = tostring(customFields.EventMin),\n    RawThreadId = tostring(customFields.RawThreadId),\n    SrcIpAddr = tostring(customFields.SrcIpAddr),\n    ConnectionFlags = tostring(customFields.ConnectionFlags),\n    DstIpPort = tostring(customFields.DstIpPort),\n    SrcIpPort = tostring(customFields.SrcIpPort),\n    Protocol = tostring(customFields.Protocol),\n    DstIpAddr = tostring(customFields.DstIpAddr),\n    InContext = tostring(customFields.InContext),\n    NetworkContainmentState = tostring(customFields.NetworkContainmentState),\n    ConfigIDBase = tostring(customFields.ConfigIDBase),\n    SensorStateBitMap = tostring(customFields.SensorStateBitMap),\n    ConfigurationVersion = tostring(customFields.ConfigurationVersion),\n    ConfigIDPlatform = tostring(customFields.ConfigIDPlatform),\n    ConfigIDBuild = tostring(customFields.ConfigIDBuild),\n    ProvisionState = tostring(customFields.ProvisionState),\n    Size = tostring(customFields.Size),\n    IsOnNetwork = tostring(customFields.IsOnNetwork),\n    DiskParentDeviceInstanceId = tostring(customFields.DiskParentDeviceInstanceId),\n    TemporaryFileName = tostring(customFields.TemporaryFileName),\n    FileEcpBitmask = tostring(customFields.FileEcpBitmask),\n    ModuleCharacteristics = tostring(customFields.ModuleCharacteristics),\n    OriginalEventTimeStamp = tostring(customFields.OriginalEventTimeStamp),\n    MappedFromUserMode = tostring(customFields.MappedFromUserMode),\n    TreeId = tostring(customFields.TreeId),\n    PrimaryModule = tostring(customFields.PrimaryModule),\n    LogoffTime = tostring(customFields.LogoffTime),\n    UserFlags = tostring(customFields.UserFlags),\n    LogonServer = tostring(customFields.LogonServer),\n    DstUserName = tostring(customFields.DstUserName),\n    AuthenticationPackage = tostring(customFields.AuthenticationPackage),\n    PasswordLastSet = tostring(customFields.PasswordLastSet),\n    UserLogoffType = tostring(customFields.UserLogoffType),\n    UserLogonFlags = tostring(customFields.UserLogonFlags),\n    Parameter2 = tostring(customFields.Parameter2),\n    Parameter1 = tostring(customFields.Parameter1),\n    Parameter3 = tostring(customFields.Parameter3),\n    Line = tostring(customFields.Line),\n    ErrorStatus = tostring(customFields.ErrorStatus),\n    Facility = tostring(customFields.Facility),\n    File = tostring(customFields.File),\n    PublicKeys = tostring(customFields.PublicKeys),\n    HandleCreated = tostring(customFields.HandleCreated),\n    ExtendedKeyUsages = tostring(customFields.ExtendedKeyUsages),\n    FileSigningTime = tostring(customFields.FileSigningTime),\n    Object1Name = tostring(customFields.Object1Name),\n    Object1Type = tostring(customFields.Object1Type),\n    Certificate = tostring(customFields.Certificate),\n    RpcClientProcessId = tostring(customFields.RpcClientProcessId),\n    SyntheticPR2Flags = tostring(customFields.SyntheticPR2Flags),\n    MachOSubType = tostring(customFields.MachOSubType),\n    SessionProcessId = tostring(customFields.SessionProcessId),\n    SVUID = tostring(customFields.SVUID),\n    ProcessGroupId = tostring(customFields.ProcessGroupId),\n    GID = tostring(customFields.GID),\n    SVGID = tostring(customFields.SVGID),\n    UID = tostring(customFields.UID),\n    RGID = tostring(customFields.RGID),\n    RUID = tostring(customFields.RUID),\n    NeighborList = tostring(customFields.NeighborList),\n    DownloadServer = tostring(customFields.DownloadServer),\n    DownloadPath = tostring(customFields.DownloadPath),\n    DownloadPort = tostring(customFields.DownloadPort),\n    CompletionEventId = tostring(customFields.CompletionEventId),\n    IsTransactedFile = tostring(customFields.IsTransactedFile),\n    WindowStation = tostring(customFields.WindowStation),\n    BoundingLimitCount = tostring(customFields.BoundingLimitCount),\n    ProcessBehaviorBitfield = tostring(customFields.ProcessBehaviorBitfield),\n    Desktop = tostring(customFields.Desktop),\n    PatternId = tostring(customFields.PatternId),\n    ExclusionType = tostring(customFields.ExclusionType),\n    ExclusionSource = tostring(customFields.ExclusionSource),\n    DriverLoadFlags = tostring(customFields.DriverLoadFlags),\n    CompanyName = tostring(customFields.CompanyName),\n    OriginalFilename = tostring(customFields.OriginalFilename),\n    FileVersion = tostring(customFields.FileVersion),\n    ShowWindowFlags = tostring(customFields.ShowWindowFlags),\n    ThreadStartAddress = tostring(customFields.ThreadStartAddress),\n    InjectedThreadFlag = tostring(customFields.InjectedThreadFlag),\n    UserThread = tostring(customFields.UserThread),\n    TargetThreadModule = tostring(customFields.TargetThreadModule),\n    TargetThreadId = tostring(customFields.TargetThreadId),\n    ThreadStartContext = tostring(customFields.ThreadStartContext),\n    SourceThreadStartAddress = tostring(customFields.SourceThreadStartAddress),\n    InterfaceGuid = tostring(customFields.InterfaceGuid),\n    InterfaceVersion = tostring(customFields.InterfaceVersion),\n    RpcClientThreadId = tostring(customFields.RpcClientThreadId),\n    TaskXml = tostring(customFields.TaskXml),\n    TaskAuthor = tostring(customFields.TaskAuthor),\n    RpcOpNum = tostring(customFields.RpcOpNum),\n    TaskExecArguments = tostring(customFields.TaskExecArguments),\n    RpcNestingLevel = tostring(customFields.RpcNestingLevel),\n    ErrorLocation = tostring(customFields.ErrorLocation),\n    ErrorReason = tostring(customFields.ErrorReason),\n    Parameter64_1 = tostring(customFields.Parameter64_1),\n    ErrorSource = tostring(customFields.ErrorSource),\n    ParameterSizedBuffer_1 = tostring(customFields.ParameterSizedBuffer_1),\n    ErrorCode = tostring(customFields.ErrorCode),\n    DeviceVersion = tostring(customFields.DeviceVersion),\n    DeviceTimeStamp = toreal(customFields.DeviceTimeStamp),\n    DeviceInstanceId = tostring(customFields.DeviceInstanceId),\n    DeviceDescriptorSetHash = tostring(customFields.DeviceDescriptorSetHash),\n    DeviceVendorId = tostring(customFields.DeviceVendorId),\n    DeviceManufacturer = tostring(customFields.DeviceManufacturer),\n    DeviceProduct = tostring(customFields.DeviceProduct),\n    GroupRid = tostring(customFields.GroupRid),\n    UserRid = tostring(customFields.UserRid),\n    DomainSid = tostring(customFields.DomainSid),\n    LightningLatencyState = tostring(customFields.LightningLatencyState),\n    UnixMode = tostring(customFields.UnixMode),\n    VnodeType = tostring(customFields.VnodeType),\n    ApiReturnValue = tostring(customFields.ApiReturnValue),\n    ServiceDisplayName = tostring(customFields.ServiceDisplayName),\n    LinkName = tostring(customFields.LinkName),\n    VersionInfo = tostring(customFields.VersionInfo),\n    LanguageId = tostring(customFields.LanguageId),\n    AsepFlags = tostring(customFields.AsepFlags),\n    Data1 = tostring(customFields.Data1),\n    RegOperationType = tostring(customFields.RegOperationType),\n    ProcessArgs = tostring(customFields.ProcessArgs),\n    RegStringValue = tostring(customFields.RegStringValue),\n    RegType = tostring(customFields.RegType),\n    AsepClass = tostring(customFields.AsepClass),\n    AsepIndex = tostring(customFields.AsepIndex),\n    AsepValueType = tostring(customFields.AsepValueType),\n    LocalSession = tostring(customFields.LocalSession),\n    DstDvcHostname = tostring(customFields.DstDvcHostname),\n    PrivilegesBitmask = tostring(customFields.PrivilegesBitmask),\n    EnabledPrivilegesBitmask = tostring(customFields.EnabledPrivilegesBitmask),\n    UserGroupsBitmask = tostring(customFields.UserGroupsBitmask),\n    Timeout = tostring(customFields.Timeout),\n    ProcessCount = tostring(customFields.ProcessCount),\n    SuppressType = tostring(customFields.SuppressType),\n    BoundedCount = tolong(customFields.BoundedCount),\n    IP6Records = tostring(customFields.IP6Records),\n    FirstIP6Record = tostring(customFields.FirstIP6Record),\n    WmiQuery = tostring(customFields.WmiQuery),\n    WmiNamespaceName = tostring(customFields.WmiNamespaceName),\n    RegClassificationIndex = tostring(customFields.RegClassificationIndex),\n    RegClassificationFlags = tostring(customFields.RegClassificationFlags),\n    RegClassification = tostring(customFields.RegClassification),\n    SystemTableIndex = tostring(customFields.SystemTableIndex),\n    ScreenshotType = tostring(customFields.ScreenshotType),\n    SubStatus = tostring(customFields.SubStatus),\n    UmppaInjectAbortCount = tostring(customFields.UmppaInjectAbortCount),\n    UmppaInjectFailedCount = tostring(customFields.UmppaInjectFailedCount),\n    UmppaInjectionType = tostring(customFields.UmppaInjectionType),\n    UmppaInjectLoadFailCount = tostring(customFields.UmppaInjectLoadFailCount),\n    UmppaInjectCfgCheckCount = tostring(customFields.UmppaInjectCfgCheckCount),\n    UmppaInjectExtensionErrorCount = tostring(customFields.UmppaInjectExtensionErrorCount),\n    UmppaInjectInvalidThreadCount = tostring(customFields.UmppaInjectInvalidThreadCount),\n    UmppaInjectFileSectionCount = tostring(customFields.UmppaInjectFileSectionCount),\n    TotalCount = tostring(customFields.TotalCount),\n    UmppaInjectLoadErrorCount = tostring(customFields.UmppaInjectLoadErrorCount),\n    UmppaInjectBadAlertCount = tostring(customFields.UmppaInjectBadAlertCount),\n    UmppaInjectApcInsertionCount = tostring(customFields.UmppaInjectApcInsertionCount),\n    UmppaInjectCopyFailCount = tostring(customFields.UmppaInjectCopyFailCount),\n    RegNumericValue = tostring(customFields.RegNumericValue),\n    VolumeDriveLetter = tostring(customFields.VolumeDriveLetter),\n    VolumeSnapshotName = tostring(customFields.VolumeSnapshotName),\n    UserCanonical = tostring(customFields.UserCanonical),\n    LogonId = tostring(customFields.LogonId),\n    ConfigStateData = tostring(customFields.ConfigStateData),\n    FirewallProfile = tostring(customFields.FirewallProfile),\n    FirewallOption = tostring(customFields.FirewallOption),\n    FirewallOptionNumericValue = tostring(customFields.FirewallOptionNumericValue),\n    SmbShareName = tostring(customFields.SmbShareName),\n    IsCpuDataCommonOnAllCores = tostring(customFields.IsCpuDataCommonOnAllCores),\n    SpibarDataFrap = tostring(customFields.SpibarDataFrap),\n    EfiVariableDbxSha256Hash = tostring(customFields.EfiVariableDbxSha256Hash),\n    PciConfigDataBgsm = tostring(customFields.PciConfigDataBgsm),\n    PciConfigDataDpr = tostring(customFields.PciConfigDataDpr),\n    CpuDataCommonSmrrSupported = tostring(customFields.CpuDataCommonSmrrSupported),\n    SpibarDataHsfc = tostring(customFields.SpibarDataHsfc),\n    EfiVariableSecureBoot = tostring(customFields.EfiVariableSecureBoot),\n    PciConfigDataMesegMask = tostring(customFields.PciConfigDataMesegMask),\n    PciConfigDataTolud = tostring(customFields.PciConfigDataTolud),\n    EfiVariableDbxAttributes = tostring(customFields.EfiVariableDbxAttributes),\n    PciConfigDataPavpc = tostring(customFields.PciConfigDataPavpc),\n    EfiVariableCustomModeAttributes = tostring(customFields.EfiVariableCustomModeAttributes),\n    SpibarDataFreg3 = tostring(customFields.SpibarDataFreg3),\n    SpibarDataFreg4 = tostring(customFields.SpibarDataFreg4),\n    SpibarDataFreg1 = tostring(customFields.SpibarDataFreg1),\n    SpibarDataFreg2 = tostring(customFields.SpibarDataFreg2),\n    SpibarDataFreg0 = tostring(customFields.SpibarDataFreg0),\n    EfiSupported = tostring(customFields.EfiSupported),\n    EfiVariablePkAttributes = tostring(customFields.EfiVariablePkAttributes),\n    CpuDataCommonPrmrrUncorePhysicalMask = tostring(customFields.CpuDataCommonPrmrrUncorePhysicalMask),\n    PciConfigDataGenPmconA = tostring(customFields.PciConfigDataGenPmconA),\n    PciConfigDataTsegmb = tostring(customFields.PciConfigDataTsegmb),\n    SpibarDataVscc0 = tostring(customFields.SpibarDataVscc0),\n    EfiVariablePkSha256Hash = tostring(customFields.EfiVariablePkSha256Hash),\n    SpibarDataVscc1 = tostring(customFields.SpibarDataVscc1),\n    CpuDataCommonSmrrPhysicalMask = tostring(customFields.CpuDataCommonSmrrPhysicalMask),\n    NorthBridgeDeviceId = tostring(customFields.NorthBridgeDeviceId),\n    IsNorthBridgeSupported = tostring(customFields.IsNorthBridgeSupported),\n    PciConfigDataTom = tostring(customFields.PciConfigDataTom),\n    EfiVariableKekSha256Hash = tostring(customFields.EfiVariableKekSha256Hash),\n    SouthBridgeVendorId = tostring(customFields.SouthBridgeVendorId),\n    EfiVariableSignatureSupport = tostring(customFields.EfiVariableSignatureSupport),\n    MmioDataTco1Cnt = tostring(customFields.MmioDataTco1Cnt),\n    EfiVariableKekAttributes = tostring(customFields.EfiVariableKekAttributes),\n    FirmwareAnalysisCpuSupported = tostring(customFields.FirmwareAnalysisCpuSupported),\n    MmioDataSmiEn = tostring(customFields.MmioDataSmiEn),\n    CpuDataCommonPrmrrUncoreSupported = tostring(customFields.CpuDataCommonPrmrrUncoreSupported),\n    NorthBridgeVendorId = tostring(customFields.NorthBridgeVendorId),\n    CpuDataCommonMsrApicBase = tostring(customFields.CpuDataCommonMsrApicBase),\n    EfiVariableDbAttributes = tostring(customFields.EfiVariableDbAttributes),\n    SpibarDataPr2 = tostring(customFields.SpibarDataPr2),\n    SpibarDataBfpr = tostring(customFields.SpibarDataBfpr),\n    SpibarDataPr1 = tostring(customFields.SpibarDataPr1),\n    EfiVariableSecureBootAttributes = tostring(customFields.EfiVariableSecureBootAttributes),\n    SpibarDataPr0 = tostring(customFields.SpibarDataPr0),\n    IsSouthBridgeSupported = tostring(customFields.IsSouthBridgeSupported),\n    PciConfigDataHfsts1 = tostring(customFields.PciConfigDataHfsts1),\n    CpuDataCommonMsrFeatureControl = tostring(customFields.CpuDataCommonMsrFeatureControl),\n    PciConfigDataRemaplimit = tostring(customFields.PciConfigDataRemaplimit),\n    CpuDataCommonSiliconDebugFeatureControl = tostring(customFields.CpuDataCommonSiliconDebugFeatureControl),\n    CpuDataCommonSmrrPhysicalBase = tostring(customFields.CpuDataCommonSmrrPhysicalBase),\n    SouthBridgeDeviceId = tostring(customFields.SouthBridgeDeviceId),\n    CpuDataCommonPrmrrPhysicalMask = tostring(customFields.CpuDataCommonPrmrrPhysicalMask),\n    EfiVariableDbSha256Hash = tostring(customFields.EfiVariableDbSha256Hash),\n    SpibarDataHsfs = tostring(customFields.SpibarDataHsfs),\n    PciConfigDataRemapbase = tostring(customFields.PciConfigDataRemapbase),\n    EfiVariableCustomMode = tostring(customFields.EfiVariableCustomMode),\n    PciConfigDataGgc = tostring(customFields.PciConfigDataGgc),\n    PciConfigDataTouud = tostring(customFields.PciConfigDataTouud),\n    SpibarDataPr4 = tostring(customFields.SpibarDataPr4),\n    SpibarDataPr3 = tostring(customFields.SpibarDataPr3),\n    CpuDataCommonPrmrrSupported = tostring(customFields.CpuDataCommonPrmrrSupported),\n    PciConfigDataSmramc = tostring(customFields.PciConfigDataSmramc),\n    EfiVariableSignatureSupportAttributes = tostring(customFields.EfiVariableSignatureSupportAttributes),\n    PciConfigDataBdsm = tostring(customFields.PciConfigDataBdsm),\n    EfiVariableSetupModeAttributes = tostring(customFields.EfiVariableSetupModeAttributes),\n    EfiVariableSetupMode = tostring(customFields.EfiVariableSetupMode),\n    PciConfigDataBiosCntl = tostring(customFields.PciConfigDataBiosCntl),\n    PciConfigDataMesegBase = tostring(customFields.PciConfigDataMesegBase),\n    NewFileIdentifier = tostring(customFields.NewFileIdentifier),\n    FeatureVector = tostring(customFields.FeatureVector),\n    ModelPrediction = tostring(customFields.ModelPrediction),\n    Malicious = tostring(customFields.Malicious),\n    FeatureExtractionVersion = tostring(customFields.FeatureExtractionVersion),\n    FXFileSize = tostring(customFields.FXFileSize),\n    MLModelVersion = tostring(customFields.MLModelVersion),\n    FontBufferLength = tostring(customFields.FontBufferLength),\n    FontFileCount = tostring(customFields.FontFileCount),\n    FontLoadOperation = tostring(customFields.FontLoadOperation),\n    FontBuffer = tostring(customFields.FontBuffer),\n    FontFileName = tostring(customFields.FontFileName),\n    TemplateInstanceId = tostring(customFields.TemplateInstanceId),\n    PatternDisposition = tostring(customFields.PatternDisposition),\n    ServicePackMajor = tostring(customFields.ServicePackMajor),\n    ProductSku = tostring(customFields.ProductSku),\n    PointerSize = tostring(customFields.PointerSize),\n    ProductName = tostring(customFields.ProductName),\n    AgentVersion = tostring(customFields.AgentVersion),\n    ServicePackMinor = tostring(customFields.ServicePackMinor),\n    SuiteMask = tostring(customFields.SuiteMask),\n    SubBuildNumber = tostring(customFields.SubBuildNumber),\n    PlatformId = tostring(customFields.PlatformId),\n    BuildType = tostring(customFields.BuildType),\n    MajorVersion = tostring(customFields.MajorVersion),\n    ProductType = tostring(customFields.ProductType),\n    MinorVersion = tostring(customFields.MinorVersion),\n    CheckedBuild = tostring(customFields.CheckedBuild),\n    BuildNumber = tostring(customFields.BuildNumber),\n    RFMState = tostring(customFields.RFMState),\n    FirmwareAnalysisEclControlInterfaceVersion = tostring(customFields.FirmwareAnalysisEclControlInterfaceVersion),\n    FirmwareAnalysisEclConsumerInterfaceVersion = tostring(customFields.FirmwareAnalysisEclConsumerInterfaceVersion),\n    BootTimeFunctionalityLevel = tostring(customFields.BootTimeFunctionalityLevel),\n    ReasonOfFunctionalityLevel = tostring(customFields.ReasonOfFunctionalityLevel),\n    CurrentFunctionalityLevel = tostring(customFields.CurrentFunctionalityLevel),\n    PciAttachmentState = tostring(customFields.PciAttachmentState),\n    LocalAddressIP6 = tostring(customFields.LocalAddressIP6),\n    RemoteAddressIP6 = tostring(customFields.RemoteAddressIP6),\n    RegBinaryValue = tostring(customFields.RegBinaryValue),\n    ServiceDescription = tostring(customFields.ServiceDescription),\n    ServiceSecurity = tostring(customFields.ServiceSecurity),\n    ServiceImagePath = tostring(customFields.ServiceImagePath),\n    ServiceStart = tostring(customFields.ServiceStart),\n    ServiceType = tostring(customFields.ServiceType),\n    ServiceFailureActions = tostring(customFields.ServiceFailureActions),\n    ServiceErrorControl = tostring(customFields.ServiceErrorControl),\n    SymbolicLinkName = tostring(customFields.SymbolicLinkName),\n    SymbolicLinkTarget = tostring(customFields.SymbolicLinkTarget),\n    DevicePropertyClassName = tostring(customFields.DevicePropertyClassName),\n    DeviceActiveConfigurationNumber = tostring(customFields.DeviceActiveConfigurationNumber),\n    DevicePropertyClassGuid = tostring(customFields.DevicePropertyClassGuid),\n    DeviceUsbSubclass = tostring(customFields.DeviceUsbSubclass),\n    ParentHubInstanceId = tostring(customFields.ParentHubInstanceId),\n    DeviceConnectionStatus = tostring(customFields.DeviceConnectionStatus),\n    DeviceUsbClass = tostring(customFields.DeviceUsbClass),\n    ParentHubPort = tostring(customFields.ParentHubPort),\n    DevicePropertyManufacturer = tostring(customFields.DevicePropertyManufacturer),\n    DevicePropertyLocationInformation = tostring(customFields.DevicePropertyLocationInformation),\n    DeviceProtocol = tostring(customFields.DeviceProtocol),\n    DevicePropertyDeviceDescription = tostring(customFields.DevicePropertyDeviceDescription),\n    DeviceUsbVersion = tostring(customFields.DeviceUsbVersion),\n    ModuleBaseAddress = tostring(customFields.ModuleBaseAddress),\n    ModuleSize = tostring(customFields.ModuleSize),\n    IsOnClearCaseMvfs = tostring(customFields.IsOnClearCaseMvfs),\n    DllCharacteristics = tostring(customFields.DllCharacteristics),\n    ActiveCpuCount = tostring(customFields.ActiveCpuCount),\n    MemoryTotal = tostring(customFields.MemoryTotal),\n    BillingType = tostring(customFields.BillingType),\n    ConnectionCipher = tostring(customFields.ConnectionCipher),\n    ConnectType = tostring(customFields.ConnectType),\n    ConnectionProtocol = tostring(customFields.ConnectionProtocol),\n    ConnectionHash = tostring(customFields.ConnectionHash),\n    ConnectTime = tostring(customFields.ConnectTime),\n    ConnectionHashStrength = tostring(customFields.ConnectionHashStrength),\n    FailedConnectCount = tostring(customFields.FailedConnectCount),\n    ConnectionCipherStrength = tostring(customFields.ConnectionCipherStrength),\n    ConnectionExchangeStrength = tostring(customFields.ConnectionExchangeStrength),\n    ConnectionExchange = tostring(customFields.ConnectionExchange),\n    PreviousConnectTime = tostring(customFields.PreviousConnectTime),\n    FalconServiceServletErrors = tostring(customFields.FalconServiceServletErrors),\n    FalconServiceComponent = tostring(customFields.FalconServiceComponent),\n    FalconServiceServletStarts = tostring(customFields.FalconServiceServletStarts),\n    FalconServiceState = tostring(customFields.FalconServiceState),\n    ScriptContent = tostring(customFields.ScriptContent),\n    OriginalContentLength = tostring(customFields.OriginalContentLength),\n    ScriptingLanguageId = tostring(customFields.ScriptingLanguageId),\n    ParentImageFileName = tostring(customFields.ParentImageFileName),\n    GrandparentImageFileName = tostring(customFields.GrandparentImageFileName),\n    ScriptContentName = tostring(customFields.ScriptContentName),\n    ProcessParentCommandLine = tostring(customFields.ProcessParentCommandLine),\n    ContentSHA256HashData = tostring(customFields.ContentSHA256HashData),\n    ProcessGrandparentCommandLine = tostring(customFields.ProcessGrandparentCommandLine),\n    ThreatFirstReportedTime = tostring(customFields.ThreatFirstReportedTime),\n    ThreatLastReportedTime = tostring(customFields.ThreatLastReportedTime),\n    ThreatOriginalRiskLevel = toint(customFields.ThreatOriginalRiskLevel)\n| project\n    TimeGenerated, \n    FileMode,\n    DeviceSerialNumber,\n    IcmpCode,\n    IcmpType,\n    LastUpdateInstalledTime,\n    RebootRequired,\n    PendingUpdateIds,\n    InstalledUpdateIds,\n    InstalledUpdateExtendedStatus,\n    SupersededUpdateIds,\n    ConfigurationDescriptorValue,\n    ConfigurationDescriptorAttributes,\n    DeviceDescriptorUniqueIdentifier,\n    ConfigurationDescriptorName,\n    ConfigurationDescriptorNumInterfaces,\n    ConfigurationDescriptorMaxPowerDraw,\n    ScreenshotsTakenCount,\n    ExitCode,\n    ParentProcessId,\n    DstUserIdentity,\n    NetworkListenCount,\n    SuspiciousRawDiskReadCount,\n    NetworkBindCount,\n    NetworkRecvAcceptCount,\n    ContextData,\n    Id,\n    NewExecutableWrittenCount,\n    ExeAndServiceCount,\n    NetworkCloseCount,\n    SuspectStackCount,\n    CLICreationCount,\n    UnsignedModuleLoadCount,\n    UserTime,\n    EventMessage,\n    RawProcessId,\n    ContextTimeStamp,\n    AllocateVirtualMemoryCount,\n    ContextProcessId,\n    ServiceEventCount,\n    SnapshotFileOpenCount,\n    RemovableDiskFileWrittenCount,\n    InjectedDllCount,\n    ModuleLoadCount,\n    UserMemoryProtectExecutableCount,\n    NetworkCapableAsepWriteCount,\n    TargetProcessId,\n    DnsRequestCount,\n    ArchiveFileWrittenCount,\n    Entitlements,\n    Name,\n    ProcessStartTime,\n    SetThreadContextCount,\n    SuspiciousCredentialModuleLoadCount,\n    DvcInterfaceGuid,\n    Cid,\n    FileDeletedCount,\n    UserMemoryAllocateExecutableCount,\n    DirectoryCreatedCount,\n    NetworkConnectCountUdp,\n    QueueApcCount,\n    ContextThreadId,\n    Aip,\n    SuspiciousFontLoadCount,\n    ConHostId,\n    NetworkConnectCount,\n    BinaryExecutableWrittenCount,\n    CycleTime,\n    DvcOs,\n    ConHostProcessId,\n    PrivilegedProcessHandleCount,\n    MaxThreadCount,\n    ImageSubsystem,\n    GenericFileWrittenCount,\n    EffectiveTransmissionClass,\n    ScriptEngineInvocationCount,\n    RunDllInvocationCount,\n    CreateProcessCount,\n    KernelTime,\n    DirectoryEnumeratedCount,\n    ConfigStateHash,\n    AsepWrittenCount,\n    SuspiciousDnsRequestCount,\n    DocumentFileWrittenCount,\n    ProtectVirtualMemoryCount,\n    ProcessHashSha256,\n    UserMemoryProtectExecutableRemoteCount,\n    ConfigBuild,\n    UserMemoryAllocateExecutableRemoteCount,\n    ExecutableDeletedCount,\n    RegKeySecurityDecreasedCount,\n    InjectedThreadCount,\n    NetworkModuleLoadCount,\n    WindowTitle,\n    ProcessCreateFlags,\n    IntegrityLevel,\n    SourceProcessId,\n    ProcessHashSha1,\n    TokenType,\n    ProcessEndTime,\n    AuthenticodeHashData,\n    ParentBaseFileName,\n    SessionId,\n    Tags,\n    ProcessHashMd5,\n    ProcessSxsFlags,\n    AuthenticationId,\n    WindowFlags,\n    ProcessCommandLine,\n    ParentAuthenticationId,\n    FileName,\n    SourceThreadId,\n    ProcessParameterFlags,\n    SignInfoFlags,\n    ChannelVersion,\n    ChannelVersionRequired,\n    ChannelId,\n    DnsResponseType,\n    IP4Records,\n    CNAMERecords,\n    QueryStatus,\n    InterfaceIndex,\n    DualRequest,\n    FirstIP4Record,\n    UrlDomain,\n    RespondingDnsServer,\n    RequestType,\n    FirewallRuleId,\n    Options,\n    MinorFunction,\n    FileIdentifier,\n    Information,\n    ShareAccess,\n    FileObject,\n    FilePermission,\n    Status,\n    IrpFlags,\n    MajorFunction,\n    DesiredAccess,\n    OperationFlags,\n    TargetFileName,\n    CallStackModuleNamesVersion,\n    CsaProcessDataCollectionInstanceId,\n    CallStackModuleNames,\n    CreateProcessType,\n    EtwRawProcessId,\n    EventMax,\n    EtwRawThreadId,\n    Flags,\n    EventMin,\n    RawThreadId,\n    SrcIpAddr,\n    ConnectionFlags,\n    DstIpPort,\n    SrcIpPort,\n    Protocol,\n    DstIpAddr,\n    ConnectionDirection,\n    InContext,\n    NetworkContainmentState,\n    ConfigIDBase,\n    SensorStateBitMap,\n    ConfigurationVersion,\n    ConfigIDPlatform,\n    ConfigIDBuild,\n    ProvisionState,\n    Size,\n    IsOnNetwork,\n    DiskParentDeviceInstanceId,\n    TemporaryFileName,\n    FileEcpBitmask,\n    IsOnRemovableDisk,\n    ModuleCharacteristics,\n    OriginalEventTimeStamp,\n    MappedFromUserMode,\n    TreeId,\n    PrimaryModule,\n    UserIsAdmin,\n    LogoffTime,\n    LogonTime,\n    LogonDomain,\n    RemoteAccount,\n    UserFlags,\n    LogonServer,\n    DstUserName,\n    LogonType,\n    AuthenticationPackage,\n    UserPrincipal,\n    PasswordLastSet,\n    UserLogoffType,\n    UserLogonFlags,\n    Parameter2,\n    Parameter1,\n    Parameter3,\n    Line,\n    ErrorStatus,\n    Facility,\n    File,\n    PublicKeys,\n    HandleCreated,\n    ExtendedKeyUsages,\n    FileSigningTime,\n    Object1Name,\n    Object1Type,\n    Certificate,\n    RpcClientProcessId,\n    SyntheticPR2Flags,\n    MachOSubType,\n    SessionProcessId,\n    SVUID,\n    ProcessGroupId,\n    GID,\n    SVGID,\n    UID,\n    RGID,\n    RUID,\n    NeighborList,\n    DownloadServer,\n    DownloadPath,\n    DownloadPort,\n    CompletionEventId,\n    IsTransactedFile,\n    WindowStation,\n    BoundingLimitCount,\n    ProcessBehaviorBitfield,\n    Desktop,\n    PatternId,\n    ExclusionType,\n    ExclusionSource,\n    DriverLoadFlags,\n    CompanyName,\n    OriginalFilename,\n    FileVersion,\n    GrandParentBaseFileName,\n    ShowWindowFlags,\n    ThreadStartAddress,\n    InjectedThreadFlag,\n    UserThread,\n    TargetThreadModule,\n    TargetThreadId,\n    ThreadStartContext,\n    SourceThreadStartAddress,\n    InterfaceGuid,\n    InterfaceVersion,\n    RpcClientThreadId,\n    TaskXml,\n    TaskAuthor,\n    TaskName,\n    RpcOpNum,\n    TaskExecArguments,\n    TaskExecCommand,\n    RpcNestingLevel,\n    ErrorLocation,\n    ErrorReason,\n    Parameter64_1,\n    ErrorSource,\n    ParameterSizedBuffer_1,\n    ErrorCode,\n    DeviceProductId,\n    DeviceVersion,\n    DeviceTimeStamp,\n    DeviceInstanceId,\n    DeviceDescriptorSetHash,\n    DeviceVendorId,\n    DeviceManufacturer,\n    DeviceProduct,\n    GroupRid,\n    UserRid,\n    DomainSid,\n    LightningLatencyState,\n    UnixMode,\n    VnodeType,\n    TargetDirectoryName,\n    ApiReturnValue,\n    ServiceDisplayName,\n    LinkName,\n    VersionInfo,\n    LanguageId,\n    AsepFlags,\n    RegObjectName,\n    Data1,\n    RegOperationType,\n    ProcessArgs,\n    RegStringValue,\n    RegType,\n    AsepClass,\n    AsepIndex,\n    RegValueName,\n    AsepValueType,\n    LocalSession,\n    DstDvcHostname,\n    PrivilegesBitmask,\n    EnabledPrivilegesBitmask,\n    UserGroupsBitmask,\n    Timeout,\n    ProcessCount,\n    SuppressType,\n    BoundedCount,\n    IP6Records,\n    FirstIP6Record,\n    WmiQuery,\n    WmiNamespaceName,\n    RegClassificationIndex,\n    RegClassificationFlags,\n    RegClassification,\n    SystemTableIndex,\n    ScreenshotType,\n    SubStatus,\n    UmppaInjectAbortCount,\n    UmppaInjectFailedCount,\n    UmppaInjectionType,\n    UmppaInjectLoadFailCount,\n    UmppaInjectCfgCheckCount,\n    UmppaInjectExtensionErrorCount,\n    UmppaInjectInvalidThreadCount,\n    UmppaInjectFileSectionCount,\n    TotalCount,\n    UmppaInjectLoadErrorCount,\n    UmppaInjectBadAlertCount,\n    UmppaInjectApcInsertionCount,\n    UmppaInjectCopyFailCount,\n    FirewallRule,\n    RegNumericValue,\n    VolumeDriveLetter,\n    VolumeSnapshotName,\n    VolumeName,\n    UserCanonical,\n    LogonId,\n    ConfigStateData,\n    FirewallProfile,\n    FirewallOption,\n    FirewallOptionNumericValue,\n    SmbShareName,\n    TargetSHA256HashData,\n    IsCpuDataCommonOnAllCores,\n    SpibarDataFrap,\n    EfiVariableDbxSha256Hash,\n    PciConfigDataBgsm,\n    PciConfigDataDpr,\n    CpuDataCommonSmrrSupported,\n    SpibarDataHsfc,\n    EfiVariableSecureBoot,\n    PciConfigDataMesegMask,\n    PciConfigDataTolud,\n    EfiVariableDbxAttributes,\n    PciConfigDataPavpc,\n    EfiVariableCustomModeAttributes,\n    SpibarDataFreg3,\n    SpibarDataFreg4,\n    SpibarDataFreg1,\n    SpibarDataFreg2,\n    SpibarDataFreg0,\n    EfiSupported,\n    EfiVariablePkAttributes,\n    CpuDataCommonPrmrrUncorePhysicalMask,\n    PciConfigDataGenPmconA,\n    PciConfigDataTsegmb,\n    SpibarDataVscc0,\n    EfiVariablePkSha256Hash,\n    SpibarDataVscc1,\n    CpuDataCommonSmrrPhysicalMask,\n    NorthBridgeDeviceId,\n    IsNorthBridgeSupported,\n    PciConfigDataTom,\n    EfiVariableKekSha256Hash,\n    SouthBridgeVendorId,\n    EfiVariableSignatureSupport,\n    MmioDataTco1Cnt,\n    EfiVariableKekAttributes,\n    FirmwareAnalysisCpuSupported,\n    MmioDataSmiEn,\n    CpuDataCommonPrmrrUncoreSupported,\n    NorthBridgeVendorId,\n    CpuDataCommonMsrApicBase,\n    EfiVariableDbAttributes,\n    SpibarDataPr2,\n    SpibarDataBfpr,\n    SpibarDataPr1,\n    EfiVariableSecureBootAttributes,\n    SpibarDataPr0,\n    IsSouthBridgeSupported,\n    PciConfigDataHfsts1,\n    CpuDataCommonMsrFeatureControl,\n    PciConfigDataRemaplimit,\n    CpuDataCommonSiliconDebugFeatureControl,\n    CpuDataCommonSmrrPhysicalBase,\n    SouthBridgeDeviceId,\n    CpuDataCommonPrmrrPhysicalMask,\n    EfiVariableDbSha256Hash,\n    SpibarDataHsfs,\n    PciConfigDataRemapbase,\n    EfiVariableCustomMode,\n    PciConfigDataGgc,\n    PciConfigDataTouud,\n    SpibarDataPr4,\n    SpibarDataPr3,\n    CpuDataCommonPrmrrSupported,\n    PciConfigDataSmramc,\n    EfiVariableSignatureSupportAttributes,\n    PciConfigDataBdsm,\n    EfiVariableSetupModeAttributes,\n    EfiVariableSetupMode,\n    PciConfigDataBiosCntl,\n    PciConfigDataMesegBase,\n    SourceFileName,\n    NewFileIdentifier,\n    FeatureVector,\n    ModelPrediction,\n    Malicious,\n    FeatureExtractionVersion,\n    FXFileSize,\n    MLModelVersion,\n    FontBufferLength,\n    FontFileCount,\n    FontLoadOperation,\n    FontBuffer,\n    FontFileName,\n    TemplateInstanceId,\n    PatternDisposition,\n    ServicePackMajor,\n    ProductSku,\n    PointerSize,\n    ProductName,\n    AgentVersion,\n    ServicePackMinor,\n    SuiteMask,\n    SubBuildNumber,\n    PlatformId,\n    BuildType,\n    MajorVersion,\n    ProductType,\n    MinorVersion,\n    CheckedBuild,\n    BuildNumber,\n    RFMState,\n    FirmwareAnalysisEclControlInterfaceVersion,\n    FirmwareAnalysisEclConsumerInterfaceVersion,\n    BootTimeFunctionalityLevel,\n    ReasonOfFunctionalityLevel,\n    CurrentFunctionalityLevel,\n    PciAttachmentState,\n    LocalAddressIP6,\n    RemoteAddressIP6,\n    RegBinaryValue,\n    ServiceDescription,\n    ServiceSecurity,\n    ServiceImagePath,\n    ServiceStart,\n    ServiceType,\n    ServiceFailureActions,\n    ServiceErrorControl,\n    SymbolicLinkName,\n    SymbolicLinkTarget,\n    DevicePropertyClassName,\n    DeviceActiveConfigurationNumber,\n    DevicePropertyClassGuid,\n    DeviceUsbSubclass,\n    ParentHubInstanceId,\n    DeviceConnectionStatus,\n    DeviceUsbClass,\n    ParentHubPort,\n    DevicePropertyManufacturer,\n    DevicePropertyLocationInformation,\n    DeviceProtocol,\n    DevicePropertyDeviceDescription,\n    DeviceUsbVersion,\n    ModuleBaseAddress,\n    ModuleSize,\n    IsOnClearCaseMvfs,\n    DllCharacteristics,\n    ActiveCpuCount,\n    MemoryTotal,\n    BillingType,\n    ConnectionCipher,\n    ConnectType,\n    ConnectionProtocol,\n    ConnectionHash,\n    ConnectTime,\n    ConnectionHashStrength,\n    FailedConnectCount,\n    ConnectionCipherStrength,\n    ConnectionExchangeStrength,\n    ConnectionExchange,\n    PreviousConnectTime,\n    FalconServiceServletErrors,\n    FalconServiceComponent,\n    FalconServiceServletStarts,\n    FalconServiceState,\n    ScriptContent,\n    OriginalContentLength,\n    ScriptingLanguageId,\n    ParentImageFileName,\n    GrandparentImageFileName,\n    ScriptContentName,\n    HostProcessType,\n    ProcessParentCommandLine,\n    ContentSHA256HashData,\n    ProcessGrandparentCommandLine,\n    Type\n;\nlet CrowdStrikeReplicator_All = \nunion isfuzzy = true CrowdStrikeFDRv1Events, CrowdStrikeReplicatorV2(starttime = starttime, endtime = endtime)\n| extend \n    EventVendor = \"Crowdstrike\",\n    EventProduct = \"Replicator\",\n    EventMessage = event_simpleName,\n    ContextTimeStamp = timestamp,\n    Aip = aip,\n    DvcInterfaceGuid = aid\n| project-away aid, aip, event_simpleName, timestamp\n;\nCrowdStrikeReplicator_All\n};\nparser(\nstarttime=starttime, \nendtime=endtime\n)\n",
                "functionParameters": "starttime:datetime=datetime(null),endtime:datetime=datetime(null)",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
              "dependsOn": [
                "[variables('parserObject2')._parserId2]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdstrikeReplicator Data Parser')]",
                "contentId": "[variables('parserObject2').parserContentId2]",
                "kind": "Parser",
                "version": "[variables('parserObject2').parserVersion2]",
                "source": {
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "contentKind": "Parser",
        "displayName": "Union Parser for all CrowdStrike Falcon Data Replicator V1 and V2 events",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '2.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject2').parserContentId2,'-', '2.0.0')))]",
        "version": "[variables('parserObject2').parserVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject2')._parserName2]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Union Parser for all CrowdStrike Falcon Data Replicator V1 and V2 events",
        "category": "CrowdStrikeParser",
        "functionAlias": "CrowdStrikeReplicator",
        "query": "let parser = (\nstarttime: datetime=datetime(null), \nendtime: datetime=datetime(null)\n){    \nlet emptytable = datatable( \n    TimeGenerated: datetime, \n    custom_fields_message_s: string, \n    event_simpleName: string,  \n    aip: string, \n    aid: string)[];\nlet CrowdStrikeFDRv1Events = \nunion isfuzzy = true\n    emptytable,\n    CrowdstrikeReplicatorLogs_CL\n| where (isnull(starttime) or TimeGenerated >= endtime)\n    and (isnull(starttime) or TimeGenerated <= endtime)\n| extend customFields = parse_json(custom_fields_message_s)\n| extend CSFDRBaseFields = pack_all()\n| extend \n    EventMessage = tostring(CSFDRBaseFields.event_simpleName_s),\n    ContextTimeStamp = toreal(CSFDRBaseFields.timestamp_t),\n    Aip = tostring(CSFDRBaseFields.aip_s),\n    DvcInterfaceGuid = replace_string(tostring(CSFDRBaseFields.aid_g), '-', ''),\n    EventType = tostring(CSFDRBaseFields.EventType_s),  \n    LogonType = tostring(CSFDRBaseFields.LogonType_s),  \n    HostProcessType = tostring(CSFDRBaseFields.HostProcessType_s),  \n    UserPrincipal = tostring(CSFDRBaseFields.UserPrincipal_s),  \n    DomainName = tostring(CSFDRBaseFields.DomainName_s),                \n    RemoteAddressIP = tostring(CSFDRBaseFields.RemoteAddressIP_s),  \n    ConnectionDirection = tostring(CSFDRBaseFields.ConnectionDirection_s),  \n    TargetFileName = tostring(CSFDRBaseFields.TargetFileName_s),  \n    LocalAddressIP4 = tostring(CSFDRBaseFields.LocalAddressIP4_s),  \n    IsOnRemovableDisk = tostring(CSFDRBaseFields.IsOnRemovableDisk_s), \n    UserIsAdmin = tostring(CSFDRBaseFields.UserIsAdmin_s), \n    LogonTime = tostring(CSFDRBaseFields.LogonTime_s), \n    LogonDomain = tostring(CSFDRBaseFields.LogonDomain_s), \n    RemoteAccount = tostring(CSFDRBaseFields.RemoteAccount_s), \n    UserId = tostring(CSFDRBaseFields.UserId_s), \n    Prevalence = tostring(CSFDRBaseFields.Prevalence_s), \n    CurrentProcess = tostring(CSFDRBaseFields.CurrentProcess_s), \n    TargetProcessId = tostring(CSFDRBaseFields.TargetProcessId_s), \n    ProcessStartTime = tostring(CSFDRBaseFields.ProcessStartTime_s), \n    UserName = tostring(CSFDRBaseFields.UserName_s), \n    DeviceProductId = tostring(CSFDRBaseFields.DeviceProductId_s), \n    TargetSHA256HashData = tostring(CSFDRBaseFields.TargetSHA256HashData_s), \n    SHA256HashData = tostring(CSFDRBaseFields.SHA256HashData_s), \n    MD5HashData =  tostring(CSFDRBaseFields.MD5HashData_g),\n    TargetDirectoryName = tostring(CSFDRBaseFields.TargetDirectoryName_s), \n    FirewallRule = tostring(CSFDRBaseFields.FirewallRule_s), \n    TaskName = tostring(CSFDRBaseFields.TaskName_s), \n    TaskExecCommand = tostring(CSFDRBaseFields.TaskExecCommand_s), \n    TargetAddress = tostring(CSFDRBaseFields.TargetAddress_s), \n    SourceFileName = tostring(CSFDRBaseFields.SourceFileName_s), \n    RegObjectName = tostring(CSFDRBaseFields.RegObjectName_s), \n    RegValueName = tostring(CSFDRBaseFields.RegValueName_g), \n    ServiceObjectName = tostring(CSFDRBaseFields.ServiceObjectName_s), \n    RegistryPath = tostring(CSFDRBaseFields.RegistryPath_s), \n    RawProcessId = tostring(CSFDRBaseFields.RawProcessId_s), \n    event_platform = tostring(CSFDRBaseFields.event_platform_s), \n    CommandLine = tostring(CSFDRBaseFields.CommandLine_s), \n    ParentProcessId = tostring(CSFDRBaseFields.ParentProcessId_s), \n    ParentCommandLine = tostring(CSFDRBaseFields.ParentCommandLine_s), \n    ParentBaseFileName = tostring(CSFDRBaseFields.ParentBaseFileName_s), \n    GrandParentBaseFileName = tostring(CSFDRBaseFields.GrandParentBaseFileName_s), \n    RemotePort = tostring(CSFDRBaseFields.RemotePort_s), \n    VolumeDeviceType = tostring(CSFDRBaseFields.VolumeDeviceType_s), \n    VolumeName = tostring(CSFDRBaseFields.VolumeName_s), \n    ClientComputerName = tostring(CSFDRBaseFields.ClientComputerName_s), \n    ProductId = tostring(CSFDRBaseFields.ProductId_s), \n    ComputerName = tostring(CSFDRBaseFields.ComputerName_s),\n    FileMode = tostring(CSFDRBaseFields.customFields.FileMode),\n    DeviceSerialNumber = tostring(customFields.DeviceSerialNumber),\n    IcmpCode = tostring(customFields.IcmpCode),\n    IcmpType = tostring(customFields.IcmpType),\n    LastUpdateInstalledTime = tostring(customFields.LastUpdateInstalledTime),\n    RebootRequired = tostring(customFields.RebootRequired),\n    PendingUpdateIds = tostring(customFields.PendingUpdateIds),\n    InstalledUpdateIds = tostring(customFields.InstalledUpdateIds),\n    InstalledUpdateExtendedStatus = tostring(customFields.InstalledUpdateExtendedStatus),\n    SupersededUpdateIds = tostring(customFields.SupersededUpdateIds),\n    ConfigurationDescriptorValue = tostring(customFields.ConfigurationDescriptorValue),\n    ConfigurationDescriptorAttributes = tostring(customFields.ConfigurationDescriptorAttributes),\n    DeviceDescriptorUniqueIdentifier = tostring(customFields.DeviceDescriptorUniqueIdentifier),\n    ConfigurationDescriptorName = tostring(customFields.ConfigurationDescriptorName),\n    ConfigurationDescriptorNumInterfaces = tostring(customFields.ConfigurationDescriptorNumInterfaces),\n    ConfigurationDescriptorMaxPowerDraw = tostring(customFields.ConfigurationDescriptorMaxPowerDraw),\n    ScreenshotsTakenCount = tostring(customFields.ScreenshotsTakenCount),\n    ExitCode = tostring(customFields.ExitCode),\n    DstUserIdentity = tostring(customFields.DstUserIdentity),\n    NetworkListenCount = tostring(customFields.NetworkListenCount),\n    SuspiciousRawDiskReadCount = tostring(customFields.SuspiciousRawDiskReadCount),\n    NetworkBindCount = tostring(customFields.NetworkBindCount),\n    NetworkRecvAcceptCount = tostring(customFields.NetworkRecvAcceptCount),\n    ContextData = tostring(customFields.ContextData),\n    Id = tostring(customFields.Id),\n    NewExecutableWrittenCount = tostring(customFields.NewExecutableWrittenCount),\n    ExeAndServiceCount = tostring(customFields.ExeAndServiceCount),\n    NetworkCloseCount = tostring(customFields.NetworkCloseCount),\n    SuspectStackCount = tostring(customFields.SuspectStackCount),\n    CLICreationCount = tostring(customFields.CLICreationCount),\n    UnsignedModuleLoadCount = tostring(customFields.UnsignedModuleLoadCount),\n    UserTime = tostring(customFields.UserTime),\n    AllocateVirtualMemoryCount = tostring(customFields.AllocateVirtualMemoryCount),\n    ContextProcessId = tostring(customFields.ContextProcessId),\n    ServiceEventCount = tostring(customFields.ServiceEventCount),\n    SnapshotFileOpenCount = tostring(customFields.SnapshotFileOpenCount),\n    RemovableDiskFileWrittenCount = tostring(customFields.RemovableDiskFileWrittenCount),\n    InjectedDllCount = tostring(customFields.InjectedDllCount),\n    ModuleLoadCount = tostring(customFields.ModuleLoadCount),\n    UserMemoryProtectExecutableCount = tostring(customFields.UserMemoryProtectExecutableCount),\n    NetworkCapableAsepWriteCount = tostring(customFields.NetworkCapableAsepWriteCount),\n    DnsRequestCount = tostring(customFields.DnsRequestCount),\n    ArchiveFileWrittenCount = tostring(customFields.ArchiveFileWrittenCount),\n    Entitlements = tostring(customFields.Entitlements),\n    Name = tostring(customFields.Name),\n    SetThreadContextCount = tostring(customFields.SetThreadContextCount),\n    SuspiciousCredentialModuleLoadCount = tostring(customFields.SuspiciousCredentialModuleLoadCount),\n    Cid = tostring(customFields.Cid),\n    FileDeletedCount = tostring(customFields.FileDeletedCount),\n    UserMemoryAllocateExecutableCount = tostring(customFields.UserMemoryAllocateExecutableCount),\n    DirectoryCreatedCount = tostring(customFields.DirectoryCreatedCount),\n    NetworkConnectCountUdp = tostring(customFields.NetworkConnectCountUdp),\n    QueueApcCount = tostring(customFields.QueueApcCount),\n    ContextThreadId = tostring(customFields.ContextThreadId),\n    SuspiciousFontLoadCount = tostring(customFields.SuspiciousFontLoadCount),\n    ConHostId = tostring(customFields.ConHostId),\n    NetworkConnectCount = tostring(customFields.NetworkConnectCount),\n    BinaryExecutableWrittenCount = tostring(customFields.BinaryExecutableWrittenCount),\n    CycleTime = tostring(customFields.CycleTime),\n    DvcOs = tostring(customFields.DvcOs),\n    ConHostProcessId = tostring(customFields.ConHostProcessId),\n    PrivilegedProcessHandleCount = tostring(customFields.PrivilegedProcessHandleCount),\n    MaxThreadCount = tostring(customFields.MaxThreadCount),\n    ImageSubsystem = tostring(customFields.ImageSubsystem),\n    GenericFileWrittenCount = tostring(customFields.GenericFileWrittenCount),\n    EffectiveTransmissionClass = tostring(customFields.EffectiveTransmissionClass),\n    ScriptEngineInvocationCount = tostring(customFields.ScriptEngineInvocationCount),\n    RunDllInvocationCount = tostring(customFields.RunDllInvocationCount),\n    CreateProcessCount = toreal(customFields.CreateProcessCount),\n    KernelTime = tostring(customFields.KernelTime),\n    DirectoryEnumeratedCount = tostring(customFields.DirectoryEnumeratedCount),\n    ConfigStateHash = tostring(customFields.ConfigStateHash),\n    AsepWrittenCount = tostring(customFields.AsepWrittenCount),\n    SuspiciousDnsRequestCount = tostring(customFields.SuspiciousDnsRequestCount),\n    DocumentFileWrittenCount = tostring(customFields.DocumentFileWrittenCount),\n    ProtectVirtualMemoryCount = tostring(customFields.ProtectVirtualMemoryCount),\n    ProcessHashSha256 = tostring(customFields.ProcessHashSha256),\n    UserMemoryProtectExecutableRemoteCount = tostring(customFields.UserMemoryProtectExecutableRemoteCount),\n    ConfigBuild = tostring(customFields.ConfigBuild),\n    UserMemoryAllocateExecutableRemoteCount = tostring(customFields.UserMemoryAllocateExecutableRemoteCount),\n    ExecutableDeletedCount = tostring(customFields.ExecutableDeletedCount),\n    RegKeySecurityDecreasedCount = tostring(customFields.RegKeySecurityDecreasedCount),\n    InjectedThreadCount = tostring(customFields.InjectedThreadCount),\n    NetworkModuleLoadCount = tostring(customFields.NetworkModuleLoadCount),\n    WindowTitle = tostring(customFields.WindowTitle),\n    ProcessCreateFlags = tostring(customFields.ProcessCreateFlags),\n    IntegrityLevel = tostring(customFields.IntegrityLevel),\n    SourceProcessId = tostring(customFields.SourceProcessId),\n    ProcessHashSha1 = tostring(customFields.ProcessHashSha1),\n    TokenType = tostring(customFields.TokenType),\n    ProcessEndTime = toreal(customFields.ProcessEndTime),\n    AuthenticodeHashData = tostring(customFields.AuthenticodeHashData),\n    SessionId = tostring(customFields.SessionId),\n    Tags = tostring(customFields.Tags),\n    ProcessHashMd5 = tostring(customFields.ProcessHashMd5),\n    ProcessSxsFlags = tostring(customFields.ProcessSxsFlags),\n    AuthenticationId = tostring(customFields.AuthenticationId),\n    WindowFlags = tostring(customFields.WindowFlags),\n    ProcessCommandLine = tostring(customFields.ProcessCommandLine),\n    ParentAuthenticationId = tostring(customFields.ParentAuthenticationId),\n    FileName = tostring(customFields.FileName),\n    SourceThreadId = tostring(customFields.SourceThreadId),\n    ProcessParameterFlags = tostring(customFields.ProcessParameterFlags),\n    SignInfoFlags = tostring(customFields.SignInfoFlags),\n    ChannelVersion = tostring(customFields.ChannelVersion),\n    ChannelVersionRequired = tostring(customFields.ChannelVersionRequired),\n    ChannelId = tostring(customFields.ChannelId),\n    DnsResponseType = tostring(customFields.DnsResponseType),\n    IP4Records = tostring(customFields.IP4Records),\n    CNAMERecords = tostring(customFields.CNAMERecords),\n    QueryStatus = tostring(customFields.QueryStatus),\n    InterfaceIndex = tostring(customFields.InterfaceIndex),\n    DualRequest = tostring(customFields.DualRequest),\n    FirstIP4Record = tostring(customFields.FirstIP4Record),\n    UrlDomain = tostring(customFields.UrlDomain),\n    RespondingDnsServer = tostring(customFields.RespondingDnsServer),\n    RequestType = tostring(customFields.RequestType),\n    FirewallRuleId = tostring(customFields.FirewallRuleId),\n    Options = tostring(customFields.Options),\n    MinorFunction = tostring(customFields.MinorFunction),\n    FileIdentifier = tostring(customFields.FileIdentifier),\n    Information = tostring(customFields.Information),\n    ShareAccess = tostring(customFields.ShareAccess),\n    FileObject = tostring(customFields.FileObject),\n    FilePermission = tostring(customFields.FilePermission),\n    Status = tostring(customFields.Status),\n    IrpFlags = tostring(customFields.IrpFlags),\n    MajorFunction = tostring(customFields.MajorFunction),\n    DesiredAccess = tostring(customFields.DesiredAccess),\n    OperationFlags = tostring(customFields.OperationFlags),\n    CallStackModuleNamesVersion = tostring(customFields.CallStackModuleNamesVersion),\n    CsaProcessDataCollectionInstanceId = tostring(customFields.CsaProcessDataCollectionInstanceId),\n    CallStackModuleNames = tostring(customFields.CallStackModuleNames),\n    CreateProcessType = tostring(customFields.CreateProcessType),\n    EtwRawProcessId = tostring(customFields.EtwRawProcessId),\n    EventMax = tostring(customFields.EventMax),\n    EtwRawThreadId = tostring(customFields.EtwRawThreadId),\n    Flags = tostring(customFields.Flags),\n    EventMin = tostring(customFields.EventMin),\n    RawThreadId = tostring(customFields.RawThreadId),\n    SrcIpAddr = tostring(customFields.SrcIpAddr),\n    ConnectionFlags = tostring(customFields.ConnectionFlags),\n    DstIpPort = tostring(customFields.DstIpPort),\n    SrcIpPort = tostring(customFields.SrcIpPort),\n    Protocol = tostring(customFields.Protocol),\n    DstIpAddr = tostring(customFields.DstIpAddr),\n    InContext = tostring(customFields.InContext),\n    NetworkContainmentState = tostring(customFields.NetworkContainmentState),\n    ConfigIDBase = tostring(customFields.ConfigIDBase),\n    SensorStateBitMap = tostring(customFields.SensorStateBitMap),\n    ConfigurationVersion = tostring(customFields.ConfigurationVersion),\n    ConfigIDPlatform = tostring(customFields.ConfigIDPlatform),\n    ConfigIDBuild = tostring(customFields.ConfigIDBuild),\n    ProvisionState = tostring(customFields.ProvisionState),\n    Size = tostring(customFields.Size),\n    IsOnNetwork = tostring(customFields.IsOnNetwork),\n    DiskParentDeviceInstanceId = tostring(customFields.DiskParentDeviceInstanceId),\n    TemporaryFileName = tostring(customFields.TemporaryFileName),\n    FileEcpBitmask = tostring(customFields.FileEcpBitmask),\n    ModuleCharacteristics = tostring(customFields.ModuleCharacteristics),\n    OriginalEventTimeStamp = tostring(customFields.OriginalEventTimeStamp),\n    MappedFromUserMode = tostring(customFields.MappedFromUserMode),\n    TreeId = tostring(customFields.TreeId),\n    PrimaryModule = tostring(customFields.PrimaryModule),\n    LogoffTime = tostring(customFields.LogoffTime),\n    UserFlags = tostring(customFields.UserFlags),\n    LogonServer = tostring(customFields.LogonServer),\n    DstUserName = tostring(customFields.DstUserName),\n    AuthenticationPackage = tostring(customFields.AuthenticationPackage),\n    PasswordLastSet = tostring(customFields.PasswordLastSet),\n    UserLogoffType = tostring(customFields.UserLogoffType),\n    UserLogonFlags = tostring(customFields.UserLogonFlags),\n    Parameter2 = tostring(customFields.Parameter2),\n    Parameter1 = tostring(customFields.Parameter1),\n    Parameter3 = tostring(customFields.Parameter3),\n    Line = tostring(customFields.Line),\n    ErrorStatus = tostring(customFields.ErrorStatus),\n    Facility = tostring(customFields.Facility),\n    File = tostring(customFields.File),\n    PublicKeys = tostring(customFields.PublicKeys),\n    HandleCreated = tostring(customFields.HandleCreated),\n    ExtendedKeyUsages = tostring(customFields.ExtendedKeyUsages),\n    FileSigningTime = tostring(customFields.FileSigningTime),\n    Object1Name = tostring(customFields.Object1Name),\n    Object1Type = tostring(customFields.Object1Type),\n    Certificate = tostring(customFields.Certificate),\n    RpcClientProcessId = tostring(customFields.RpcClientProcessId),\n    SyntheticPR2Flags = tostring(customFields.SyntheticPR2Flags),\n    MachOSubType = tostring(customFields.MachOSubType),\n    SessionProcessId = tostring(customFields.SessionProcessId),\n    SVUID = tostring(customFields.SVUID),\n    ProcessGroupId = tostring(customFields.ProcessGroupId),\n    GID = tostring(customFields.GID),\n    SVGID = tostring(customFields.SVGID),\n    UID = tostring(customFields.UID),\n    RGID = tostring(customFields.RGID),\n    RUID = tostring(customFields.RUID),\n    NeighborList = tostring(customFields.NeighborList),\n    DownloadServer = tostring(customFields.DownloadServer),\n    DownloadPath = tostring(customFields.DownloadPath),\n    DownloadPort = tostring(customFields.DownloadPort),\n    CompletionEventId = tostring(customFields.CompletionEventId),\n    IsTransactedFile = tostring(customFields.IsTransactedFile),\n    WindowStation = tostring(customFields.WindowStation),\n    BoundingLimitCount = tostring(customFields.BoundingLimitCount),\n    ProcessBehaviorBitfield = tostring(customFields.ProcessBehaviorBitfield),\n    Desktop = tostring(customFields.Desktop),\n    PatternId = tostring(customFields.PatternId),\n    ExclusionType = tostring(customFields.ExclusionType),\n    ExclusionSource = tostring(customFields.ExclusionSource),\n    DriverLoadFlags = tostring(customFields.DriverLoadFlags),\n    CompanyName = tostring(customFields.CompanyName),\n    OriginalFilename = tostring(customFields.OriginalFilename),\n    FileVersion = tostring(customFields.FileVersion),\n    ShowWindowFlags = tostring(customFields.ShowWindowFlags),\n    ThreadStartAddress = tostring(customFields.ThreadStartAddress),\n    InjectedThreadFlag = tostring(customFields.InjectedThreadFlag),\n    UserThread = tostring(customFields.UserThread),\n    TargetThreadModule = tostring(customFields.TargetThreadModule),\n    TargetThreadId = tostring(customFields.TargetThreadId),\n    ThreadStartContext = tostring(customFields.ThreadStartContext),\n    SourceThreadStartAddress = tostring(customFields.SourceThreadStartAddress),\n    InterfaceGuid = tostring(customFields.InterfaceGuid),\n    InterfaceVersion = tostring(customFields.InterfaceVersion),\n    RpcClientThreadId = tostring(customFields.RpcClientThreadId),\n    TaskXml = tostring(customFields.TaskXml),\n    TaskAuthor = tostring(customFields.TaskAuthor),\n    RpcOpNum = tostring(customFields.RpcOpNum),\n    TaskExecArguments = tostring(customFields.TaskExecArguments),\n    RpcNestingLevel = tostring(customFields.RpcNestingLevel),\n    ErrorLocation = tostring(customFields.ErrorLocation),\n    ErrorReason = tostring(customFields.ErrorReason),\n    Parameter64_1 = tostring(customFields.Parameter64_1),\n    ErrorSource = tostring(customFields.ErrorSource),\n    ParameterSizedBuffer_1 = tostring(customFields.ParameterSizedBuffer_1),\n    ErrorCode = tostring(customFields.ErrorCode),\n    DeviceVersion = tostring(customFields.DeviceVersion),\n    DeviceTimeStamp = toreal(customFields.DeviceTimeStamp),\n    DeviceInstanceId = tostring(customFields.DeviceInstanceId),\n    DeviceDescriptorSetHash = tostring(customFields.DeviceDescriptorSetHash),\n    DeviceVendorId = tostring(customFields.DeviceVendorId),\n    DeviceManufacturer = tostring(customFields.DeviceManufacturer),\n    DeviceProduct = tostring(customFields.DeviceProduct),\n    GroupRid = tostring(customFields.GroupRid),\n    UserRid = tostring(customFields.UserRid),\n    DomainSid = tostring(customFields.DomainSid),\n    LightningLatencyState = tostring(customFields.LightningLatencyState),\n    UnixMode = tostring(customFields.UnixMode),\n    VnodeType = tostring(customFields.VnodeType),\n    ApiReturnValue = tostring(customFields.ApiReturnValue),\n    ServiceDisplayName = tostring(customFields.ServiceDisplayName),\n    LinkName = tostring(customFields.LinkName),\n    VersionInfo = tostring(customFields.VersionInfo),\n    LanguageId = tostring(customFields.LanguageId),\n    AsepFlags = tostring(customFields.AsepFlags),\n    Data1 = tostring(customFields.Data1),\n    RegOperationType = tostring(customFields.RegOperationType),\n    ProcessArgs = tostring(customFields.ProcessArgs),\n    RegStringValue = tostring(customFields.RegStringValue),\n    RegType = tostring(customFields.RegType),\n    AsepClass = tostring(customFields.AsepClass),\n    AsepIndex = tostring(customFields.AsepIndex),\n    AsepValueType = tostring(customFields.AsepValueType),\n    LocalSession = tostring(customFields.LocalSession),\n    DstDvcHostname = tostring(customFields.DstDvcHostname),\n    PrivilegesBitmask = tostring(customFields.PrivilegesBitmask),\n    EnabledPrivilegesBitmask = tostring(customFields.EnabledPrivilegesBitmask),\n    UserGroupsBitmask = tostring(customFields.UserGroupsBitmask),\n    Timeout = tostring(customFields.Timeout),\n    ProcessCount = tostring(customFields.ProcessCount),\n    SuppressType = tostring(customFields.SuppressType),\n    BoundedCount = tolong(customFields.BoundedCount),\n    IP6Records = tostring(customFields.IP6Records),\n    FirstIP6Record = tostring(customFields.FirstIP6Record),\n    WmiQuery = tostring(customFields.WmiQuery),\n    WmiNamespaceName = tostring(customFields.WmiNamespaceName),\n    RegClassificationIndex = tostring(customFields.RegClassificationIndex),\n    RegClassificationFlags = tostring(customFields.RegClassificationFlags),\n    RegClassification = tostring(customFields.RegClassification),\n    SystemTableIndex = tostring(customFields.SystemTableIndex),\n    ScreenshotType = tostring(customFields.ScreenshotType),\n    SubStatus = tostring(customFields.SubStatus),\n    UmppaInjectAbortCount = tostring(customFields.UmppaInjectAbortCount),\n    UmppaInjectFailedCount = tostring(customFields.UmppaInjectFailedCount),\n    UmppaInjectionType = tostring(customFields.UmppaInjectionType),\n    UmppaInjectLoadFailCount = tostring(customFields.UmppaInjectLoadFailCount),\n    UmppaInjectCfgCheckCount = tostring(customFields.UmppaInjectCfgCheckCount),\n    UmppaInjectExtensionErrorCount = tostring(customFields.UmppaInjectExtensionErrorCount),\n    UmppaInjectInvalidThreadCount = tostring(customFields.UmppaInjectInvalidThreadCount),\n    UmppaInjectFileSectionCount = tostring(customFields.UmppaInjectFileSectionCount),\n    TotalCount = tostring(customFields.TotalCount),\n    UmppaInjectLoadErrorCount = tostring(customFields.UmppaInjectLoadErrorCount),\n    UmppaInjectBadAlertCount = tostring(customFields.UmppaInjectBadAlertCount),\n    UmppaInjectApcInsertionCount = tostring(customFields.UmppaInjectApcInsertionCount),\n    UmppaInjectCopyFailCount = tostring(customFields.UmppaInjectCopyFailCount),\n    RegNumericValue = tostring(customFields.RegNumericValue),\n    VolumeDriveLetter = tostring(customFields.VolumeDriveLetter),\n    VolumeSnapshotName = tostring(customFields.VolumeSnapshotName),\n    UserCanonical = tostring(customFields.UserCanonical),\n    LogonId = tostring(customFields.LogonId),\n    ConfigStateData = tostring(customFields.ConfigStateData),\n    FirewallProfile = tostring(customFields.FirewallProfile),\n    FirewallOption = tostring(customFields.FirewallOption),\n    FirewallOptionNumericValue = tostring(customFields.FirewallOptionNumericValue),\n    SmbShareName = tostring(customFields.SmbShareName),\n    IsCpuDataCommonOnAllCores = tostring(customFields.IsCpuDataCommonOnAllCores),\n    SpibarDataFrap = tostring(customFields.SpibarDataFrap),\n    EfiVariableDbxSha256Hash = tostring(customFields.EfiVariableDbxSha256Hash),\n    PciConfigDataBgsm = tostring(customFields.PciConfigDataBgsm),\n    PciConfigDataDpr = tostring(customFields.PciConfigDataDpr),\n    CpuDataCommonSmrrSupported = tostring(customFields.CpuDataCommonSmrrSupported),\n    SpibarDataHsfc = tostring(customFields.SpibarDataHsfc),\n    EfiVariableSecureBoot = tostring(customFields.EfiVariableSecureBoot),\n    PciConfigDataMesegMask = tostring(customFields.PciConfigDataMesegMask),\n    PciConfigDataTolud = tostring(customFields.PciConfigDataTolud),\n    EfiVariableDbxAttributes = tostring(customFields.EfiVariableDbxAttributes),\n    PciConfigDataPavpc = tostring(customFields.PciConfigDataPavpc),\n    EfiVariableCustomModeAttributes = tostring(customFields.EfiVariableCustomModeAttributes),\n    SpibarDataFreg3 = tostring(customFields.SpibarDataFreg3),\n    SpibarDataFreg4 = tostring(customFields.SpibarDataFreg4),\n    SpibarDataFreg1 = tostring(customFields.SpibarDataFreg1),\n    SpibarDataFreg2 = tostring(customFields.SpibarDataFreg2),\n    SpibarDataFreg0 = tostring(customFields.SpibarDataFreg0),\n    EfiSupported = tostring(customFields.EfiSupported),\n    EfiVariablePkAttributes = tostring(customFields.EfiVariablePkAttributes),\n    CpuDataCommonPrmrrUncorePhysicalMask = tostring(customFields.CpuDataCommonPrmrrUncorePhysicalMask),\n    PciConfigDataGenPmconA = tostring(customFields.PciConfigDataGenPmconA),\n    PciConfigDataTsegmb = tostring(customFields.PciConfigDataTsegmb),\n    SpibarDataVscc0 = tostring(customFields.SpibarDataVscc0),\n    EfiVariablePkSha256Hash = tostring(customFields.EfiVariablePkSha256Hash),\n    SpibarDataVscc1 = tostring(customFields.SpibarDataVscc1),\n    CpuDataCommonSmrrPhysicalMask = tostring(customFields.CpuDataCommonSmrrPhysicalMask),\n    NorthBridgeDeviceId = tostring(customFields.NorthBridgeDeviceId),\n    IsNorthBridgeSupported = tostring(customFields.IsNorthBridgeSupported),\n    PciConfigDataTom = tostring(customFields.PciConfigDataTom),\n    EfiVariableKekSha256Hash = tostring(customFields.EfiVariableKekSha256Hash),\n    SouthBridgeVendorId = tostring(customFields.SouthBridgeVendorId),\n    EfiVariableSignatureSupport = tostring(customFields.EfiVariableSignatureSupport),\n    MmioDataTco1Cnt = tostring(customFields.MmioDataTco1Cnt),\n    EfiVariableKekAttributes = tostring(customFields.EfiVariableKekAttributes),\n    FirmwareAnalysisCpuSupported = tostring(customFields.FirmwareAnalysisCpuSupported),\n    MmioDataSmiEn = tostring(customFields.MmioDataSmiEn),\n    CpuDataCommonPrmrrUncoreSupported = tostring(customFields.CpuDataCommonPrmrrUncoreSupported),\n    NorthBridgeVendorId = tostring(customFields.NorthBridgeVendorId),\n    CpuDataCommonMsrApicBase = tostring(customFields.CpuDataCommonMsrApicBase),\n    EfiVariableDbAttributes = tostring(customFields.EfiVariableDbAttributes),\n    SpibarDataPr2 = tostring(customFields.SpibarDataPr2),\n    SpibarDataBfpr = tostring(customFields.SpibarDataBfpr),\n    SpibarDataPr1 = tostring(customFields.SpibarDataPr1),\n    EfiVariableSecureBootAttributes = tostring(customFields.EfiVariableSecureBootAttributes),\n    SpibarDataPr0 = tostring(customFields.SpibarDataPr0),\n    IsSouthBridgeSupported = tostring(customFields.IsSouthBridgeSupported),\n    PciConfigDataHfsts1 = tostring(customFields.PciConfigDataHfsts1),\n    CpuDataCommonMsrFeatureControl = tostring(customFields.CpuDataCommonMsrFeatureControl),\n    PciConfigDataRemaplimit = tostring(customFields.PciConfigDataRemaplimit),\n    CpuDataCommonSiliconDebugFeatureControl = tostring(customFields.CpuDataCommonSiliconDebugFeatureControl),\n    CpuDataCommonSmrrPhysicalBase = tostring(customFields.CpuDataCommonSmrrPhysicalBase),\n    SouthBridgeDeviceId = tostring(customFields.SouthBridgeDeviceId),\n    CpuDataCommonPrmrrPhysicalMask = tostring(customFields.CpuDataCommonPrmrrPhysicalMask),\n    EfiVariableDbSha256Hash = tostring(customFields.EfiVariableDbSha256Hash),\n    SpibarDataHsfs = tostring(customFields.SpibarDataHsfs),\n    PciConfigDataRemapbase = tostring(customFields.PciConfigDataRemapbase),\n    EfiVariableCustomMode = tostring(customFields.EfiVariableCustomMode),\n    PciConfigDataGgc = tostring(customFields.PciConfigDataGgc),\n    PciConfigDataTouud = tostring(customFields.PciConfigDataTouud),\n    SpibarDataPr4 = tostring(customFields.SpibarDataPr4),\n    SpibarDataPr3 = tostring(customFields.SpibarDataPr3),\n    CpuDataCommonPrmrrSupported = tostring(customFields.CpuDataCommonPrmrrSupported),\n    PciConfigDataSmramc = tostring(customFields.PciConfigDataSmramc),\n    EfiVariableSignatureSupportAttributes = tostring(customFields.EfiVariableSignatureSupportAttributes),\n    PciConfigDataBdsm = tostring(customFields.PciConfigDataBdsm),\n    EfiVariableSetupModeAttributes = tostring(customFields.EfiVariableSetupModeAttributes),\n    EfiVariableSetupMode = tostring(customFields.EfiVariableSetupMode),\n    PciConfigDataBiosCntl = tostring(customFields.PciConfigDataBiosCntl),\n    PciConfigDataMesegBase = tostring(customFields.PciConfigDataMesegBase),\n    NewFileIdentifier = tostring(customFields.NewFileIdentifier),\n    FeatureVector = tostring(customFields.FeatureVector),\n    ModelPrediction = tostring(customFields.ModelPrediction),\n    Malicious = tostring(customFields.Malicious),\n    FeatureExtractionVersion = tostring(customFields.FeatureExtractionVersion),\n    FXFileSize = tostring(customFields.FXFileSize),\n    MLModelVersion = tostring(customFields.MLModelVersion),\n    FontBufferLength = tostring(customFields.FontBufferLength),\n    FontFileCount = tostring(customFields.FontFileCount),\n    FontLoadOperation = tostring(customFields.FontLoadOperation),\n    FontBuffer = tostring(customFields.FontBuffer),\n    FontFileName = tostring(customFields.FontFileName),\n    TemplateInstanceId = tostring(customFields.TemplateInstanceId),\n    PatternDisposition = tostring(customFields.PatternDisposition),\n    ServicePackMajor = tostring(customFields.ServicePackMajor),\n    ProductSku = tostring(customFields.ProductSku),\n    PointerSize = tostring(customFields.PointerSize),\n    ProductName = tostring(customFields.ProductName),\n    AgentVersion = tostring(customFields.AgentVersion),\n    ServicePackMinor = tostring(customFields.ServicePackMinor),\n    SuiteMask = tostring(customFields.SuiteMask),\n    SubBuildNumber = tostring(customFields.SubBuildNumber),\n    PlatformId = tostring(customFields.PlatformId),\n    BuildType = tostring(customFields.BuildType),\n    MajorVersion = tostring(customFields.MajorVersion),\n    ProductType = tostring(customFields.ProductType),\n    MinorVersion = tostring(customFields.MinorVersion),\n    CheckedBuild = tostring(customFields.CheckedBuild),\n    BuildNumber = tostring(customFields.BuildNumber),\n    RFMState = tostring(customFields.RFMState),\n    FirmwareAnalysisEclControlInterfaceVersion = tostring(customFields.FirmwareAnalysisEclControlInterfaceVersion),\n    FirmwareAnalysisEclConsumerInterfaceVersion = tostring(customFields.FirmwareAnalysisEclConsumerInterfaceVersion),\n    BootTimeFunctionalityLevel = tostring(customFields.BootTimeFunctionalityLevel),\n    ReasonOfFunctionalityLevel = tostring(customFields.ReasonOfFunctionalityLevel),\n    CurrentFunctionalityLevel = tostring(customFields.CurrentFunctionalityLevel),\n    PciAttachmentState = tostring(customFields.PciAttachmentState),\n    LocalAddressIP6 = tostring(customFields.LocalAddressIP6),\n    RemoteAddressIP6 = tostring(customFields.RemoteAddressIP6),\n    RegBinaryValue = tostring(customFields.RegBinaryValue),\n    ServiceDescription = tostring(customFields.ServiceDescription),\n    ServiceSecurity = tostring(customFields.ServiceSecurity),\n    ServiceImagePath = tostring(customFields.ServiceImagePath),\n    ServiceStart = tostring(customFields.ServiceStart),\n    ServiceType = tostring(customFields.ServiceType),\n    ServiceFailureActions = tostring(customFields.ServiceFailureActions),\n    ServiceErrorControl = tostring(customFields.ServiceErrorControl),\n    SymbolicLinkName = tostring(customFields.SymbolicLinkName),\n    SymbolicLinkTarget = tostring(customFields.SymbolicLinkTarget),\n    DevicePropertyClassName = tostring(customFields.DevicePropertyClassName),\n    DeviceActiveConfigurationNumber = tostring(customFields.DeviceActiveConfigurationNumber),\n    DevicePropertyClassGuid = tostring(customFields.DevicePropertyClassGuid),\n    DeviceUsbSubclass = tostring(customFields.DeviceUsbSubclass),\n    ParentHubInstanceId = tostring(customFields.ParentHubInstanceId),\n    DeviceConnectionStatus = tostring(customFields.DeviceConnectionStatus),\n    DeviceUsbClass = tostring(customFields.DeviceUsbClass),\n    ParentHubPort = tostring(customFields.ParentHubPort),\n    DevicePropertyManufacturer = tostring(customFields.DevicePropertyManufacturer),\n    DevicePropertyLocationInformation = tostring(customFields.DevicePropertyLocationInformation),\n    DeviceProtocol = tostring(customFields.DeviceProtocol),\n    DevicePropertyDeviceDescription = tostring(customFields.DevicePropertyDeviceDescription),\n    DeviceUsbVersion = tostring(customFields.DeviceUsbVersion),\n    ModuleBaseAddress = tostring(customFields.ModuleBaseAddress),\n    ModuleSize = tostring(customFields.ModuleSize),\n    IsOnClearCaseMvfs = tostring(customFields.IsOnClearCaseMvfs),\n    DllCharacteristics = tostring(customFields.DllCharacteristics),\n    ActiveCpuCount = tostring(customFields.ActiveCpuCount),\n    MemoryTotal = tostring(customFields.MemoryTotal),\n    BillingType = tostring(customFields.BillingType),\n    ConnectionCipher = tostring(customFields.ConnectionCipher),\n    ConnectType = tostring(customFields.ConnectType),\n    ConnectionProtocol = tostring(customFields.ConnectionProtocol),\n    ConnectionHash = tostring(customFields.ConnectionHash),\n    ConnectTime = tostring(customFields.ConnectTime),\n    ConnectionHashStrength = tostring(customFields.ConnectionHashStrength),\n    FailedConnectCount = tostring(customFields.FailedConnectCount),\n    ConnectionCipherStrength = tostring(customFields.ConnectionCipherStrength),\n    ConnectionExchangeStrength = tostring(customFields.ConnectionExchangeStrength),\n    ConnectionExchange = tostring(customFields.ConnectionExchange),\n    PreviousConnectTime = tostring(customFields.PreviousConnectTime),\n    FalconServiceServletErrors = tostring(customFields.FalconServiceServletErrors),\n    FalconServiceComponent = tostring(customFields.FalconServiceComponent),\n    FalconServiceServletStarts = tostring(customFields.FalconServiceServletStarts),\n    FalconServiceState = tostring(customFields.FalconServiceState),\n    ScriptContent = tostring(customFields.ScriptContent),\n    OriginalContentLength = tostring(customFields.OriginalContentLength),\n    ScriptingLanguageId = tostring(customFields.ScriptingLanguageId),\n    ParentImageFileName = tostring(customFields.ParentImageFileName),\n    GrandparentImageFileName = tostring(customFields.GrandparentImageFileName),\n    ScriptContentName = tostring(customFields.ScriptContentName),\n    ProcessParentCommandLine = tostring(customFields.ProcessParentCommandLine),\n    ContentSHA256HashData = tostring(customFields.ContentSHA256HashData),\n    ProcessGrandparentCommandLine = tostring(customFields.ProcessGrandparentCommandLine),\n    ThreatFirstReportedTime = tostring(customFields.ThreatFirstReportedTime),\n    ThreatLastReportedTime = tostring(customFields.ThreatLastReportedTime),\n    ThreatOriginalRiskLevel = toint(customFields.ThreatOriginalRiskLevel)\n| project\n    TimeGenerated, \n    FileMode,\n    DeviceSerialNumber,\n    IcmpCode,\n    IcmpType,\n    LastUpdateInstalledTime,\n    RebootRequired,\n    PendingUpdateIds,\n    InstalledUpdateIds,\n    InstalledUpdateExtendedStatus,\n    SupersededUpdateIds,\n    ConfigurationDescriptorValue,\n    ConfigurationDescriptorAttributes,\n    DeviceDescriptorUniqueIdentifier,\n    ConfigurationDescriptorName,\n    ConfigurationDescriptorNumInterfaces,\n    ConfigurationDescriptorMaxPowerDraw,\n    ScreenshotsTakenCount,\n    ExitCode,\n    ParentProcessId,\n    DstUserIdentity,\n    NetworkListenCount,\n    SuspiciousRawDiskReadCount,\n    NetworkBindCount,\n    NetworkRecvAcceptCount,\n    ContextData,\n    Id,\n    NewExecutableWrittenCount,\n    ExeAndServiceCount,\n    NetworkCloseCount,\n    SuspectStackCount,\n    CLICreationCount,\n    UnsignedModuleLoadCount,\n    UserTime,\n    EventMessage,\n    RawProcessId,\n    ContextTimeStamp,\n    AllocateVirtualMemoryCount,\n    ContextProcessId,\n    ServiceEventCount,\n    SnapshotFileOpenCount,\n    RemovableDiskFileWrittenCount,\n    InjectedDllCount,\n    ModuleLoadCount,\n    UserMemoryProtectExecutableCount,\n    NetworkCapableAsepWriteCount,\n    TargetProcessId,\n    DnsRequestCount,\n    ArchiveFileWrittenCount,\n    Entitlements,\n    Name,\n    ProcessStartTime,\n    SetThreadContextCount,\n    SuspiciousCredentialModuleLoadCount,\n    DvcInterfaceGuid,\n    Cid,\n    FileDeletedCount,\n    UserMemoryAllocateExecutableCount,\n    DirectoryCreatedCount,\n    NetworkConnectCountUdp,\n    QueueApcCount,\n    ContextThreadId,\n    Aip,\n    SuspiciousFontLoadCount,\n    ConHostId,\n    NetworkConnectCount,\n    BinaryExecutableWrittenCount,\n    CycleTime,\n    DvcOs,\n    ConHostProcessId,\n    PrivilegedProcessHandleCount,\n    MaxThreadCount,\n    ImageSubsystem,\n    GenericFileWrittenCount,\n    EffectiveTransmissionClass,\n    ScriptEngineInvocationCount,\n    RunDllInvocationCount,\n    CreateProcessCount,\n    KernelTime,\n    DirectoryEnumeratedCount,\n    ConfigStateHash,\n    AsepWrittenCount,\n    SuspiciousDnsRequestCount,\n    DocumentFileWrittenCount,\n    ProtectVirtualMemoryCount,\n    ProcessHashSha256,\n    UserMemoryProtectExecutableRemoteCount,\n    ConfigBuild,\n    UserMemoryAllocateExecutableRemoteCount,\n    ExecutableDeletedCount,\n    RegKeySecurityDecreasedCount,\n    InjectedThreadCount,\n    NetworkModuleLoadCount,\n    WindowTitle,\n    ProcessCreateFlags,\n    IntegrityLevel,\n    SourceProcessId,\n    ProcessHashSha1,\n    TokenType,\n    ProcessEndTime,\n    AuthenticodeHashData,\n    ParentBaseFileName,\n    SessionId,\n    Tags,\n    ProcessHashMd5,\n    ProcessSxsFlags,\n    AuthenticationId,\n    WindowFlags,\n    ProcessCommandLine,\n    ParentAuthenticationId,\n    FileName,\n    SourceThreadId,\n    ProcessParameterFlags,\n    SignInfoFlags,\n    ChannelVersion,\n    ChannelVersionRequired,\n    ChannelId,\n    DnsResponseType,\n    IP4Records,\n    CNAMERecords,\n    QueryStatus,\n    InterfaceIndex,\n    DualRequest,\n    FirstIP4Record,\n    UrlDomain,\n    RespondingDnsServer,\n    RequestType,\n    FirewallRuleId,\n    Options,\n    MinorFunction,\n    FileIdentifier,\n    Information,\n    ShareAccess,\n    FileObject,\n    FilePermission,\n    Status,\n    IrpFlags,\n    MajorFunction,\n    DesiredAccess,\n    OperationFlags,\n    TargetFileName,\n    CallStackModuleNamesVersion,\n    CsaProcessDataCollectionInstanceId,\n    CallStackModuleNames,\n    CreateProcessType,\n    EtwRawProcessId,\n    EventMax,\n    EtwRawThreadId,\n    Flags,\n    EventMin,\n    RawThreadId,\n    SrcIpAddr,\n    ConnectionFlags,\n    DstIpPort,\n    SrcIpPort,\n    Protocol,\n    DstIpAddr,\n    ConnectionDirection,\n    InContext,\n    NetworkContainmentState,\n    ConfigIDBase,\n    SensorStateBitMap,\n    ConfigurationVersion,\n    ConfigIDPlatform,\n    ConfigIDBuild,\n    ProvisionState,\n    Size,\n    IsOnNetwork,\n    DiskParentDeviceInstanceId,\n    TemporaryFileName,\n    FileEcpBitmask,\n    IsOnRemovableDisk,\n    ModuleCharacteristics,\n    OriginalEventTimeStamp,\n    MappedFromUserMode,\n    TreeId,\n    PrimaryModule,\n    UserIsAdmin,\n    LogoffTime,\n    LogonTime,\n    LogonDomain,\n    RemoteAccount,\n    UserFlags,\n    LogonServer,\n    DstUserName,\n    LogonType,\n    AuthenticationPackage,\n    UserPrincipal,\n    PasswordLastSet,\n    UserLogoffType,\n    UserLogonFlags,\n    Parameter2,\n    Parameter1,\n    Parameter3,\n    Line,\n    ErrorStatus,\n    Facility,\n    File,\n    PublicKeys,\n    HandleCreated,\n    ExtendedKeyUsages,\n    FileSigningTime,\n    Object1Name,\n    Object1Type,\n    Certificate,\n    RpcClientProcessId,\n    SyntheticPR2Flags,\n    MachOSubType,\n    SessionProcessId,\n    SVUID,\n    ProcessGroupId,\n    GID,\n    SVGID,\n    UID,\n    RGID,\n    RUID,\n    NeighborList,\n    DownloadServer,\n    DownloadPath,\n    DownloadPort,\n    CompletionEventId,\n    IsTransactedFile,\n    WindowStation,\n    BoundingLimitCount,\n    ProcessBehaviorBitfield,\n    Desktop,\n    PatternId,\n    ExclusionType,\n    ExclusionSource,\n    DriverLoadFlags,\n    CompanyName,\n    OriginalFilename,\n    FileVersion,\n    GrandParentBaseFileName,\n    ShowWindowFlags,\n    ThreadStartAddress,\n    InjectedThreadFlag,\n    UserThread,\n    TargetThreadModule,\n    TargetThreadId,\n    ThreadStartContext,\n    SourceThreadStartAddress,\n    InterfaceGuid,\n    InterfaceVersion,\n    RpcClientThreadId,\n    TaskXml,\n    TaskAuthor,\n    TaskName,\n    RpcOpNum,\n    TaskExecArguments,\n    TaskExecCommand,\n    RpcNestingLevel,\n    ErrorLocation,\n    ErrorReason,\n    Parameter64_1,\n    ErrorSource,\n    ParameterSizedBuffer_1,\n    ErrorCode,\n    DeviceProductId,\n    DeviceVersion,\n    DeviceTimeStamp,\n    DeviceInstanceId,\n    DeviceDescriptorSetHash,\n    DeviceVendorId,\n    DeviceManufacturer,\n    DeviceProduct,\n    GroupRid,\n    UserRid,\n    DomainSid,\n    LightningLatencyState,\n    UnixMode,\n    VnodeType,\n    TargetDirectoryName,\n    ApiReturnValue,\n    ServiceDisplayName,\n    LinkName,\n    VersionInfo,\n    LanguageId,\n    AsepFlags,\n    RegObjectName,\n    Data1,\n    RegOperationType,\n    ProcessArgs,\n    RegStringValue,\n    RegType,\n    AsepClass,\n    AsepIndex,\n    RegValueName,\n    AsepValueType,\n    LocalSession,\n    DstDvcHostname,\n    PrivilegesBitmask,\n    EnabledPrivilegesBitmask,\n    UserGroupsBitmask,\n    Timeout,\n    ProcessCount,\n    SuppressType,\n    BoundedCount,\n    IP6Records,\n    FirstIP6Record,\n    WmiQuery,\n    WmiNamespaceName,\n    RegClassificationIndex,\n    RegClassificationFlags,\n    RegClassification,\n    SystemTableIndex,\n    ScreenshotType,\n    SubStatus,\n    UmppaInjectAbortCount,\n    UmppaInjectFailedCount,\n    UmppaInjectionType,\n    UmppaInjectLoadFailCount,\n    UmppaInjectCfgCheckCount,\n    UmppaInjectExtensionErrorCount,\n    UmppaInjectInvalidThreadCount,\n    UmppaInjectFileSectionCount,\n    TotalCount,\n    UmppaInjectLoadErrorCount,\n    UmppaInjectBadAlertCount,\n    UmppaInjectApcInsertionCount,\n    UmppaInjectCopyFailCount,\n    FirewallRule,\n    RegNumericValue,\n    VolumeDriveLetter,\n    VolumeSnapshotName,\n    VolumeName,\n    UserCanonical,\n    LogonId,\n    ConfigStateData,\n    FirewallProfile,\n    FirewallOption,\n    FirewallOptionNumericValue,\n    SmbShareName,\n    TargetSHA256HashData,\n    IsCpuDataCommonOnAllCores,\n    SpibarDataFrap,\n    EfiVariableDbxSha256Hash,\n    PciConfigDataBgsm,\n    PciConfigDataDpr,\n    CpuDataCommonSmrrSupported,\n    SpibarDataHsfc,\n    EfiVariableSecureBoot,\n    PciConfigDataMesegMask,\n    PciConfigDataTolud,\n    EfiVariableDbxAttributes,\n    PciConfigDataPavpc,\n    EfiVariableCustomModeAttributes,\n    SpibarDataFreg3,\n    SpibarDataFreg4,\n    SpibarDataFreg1,\n    SpibarDataFreg2,\n    SpibarDataFreg0,\n    EfiSupported,\n    EfiVariablePkAttributes,\n    CpuDataCommonPrmrrUncorePhysicalMask,\n    PciConfigDataGenPmconA,\n    PciConfigDataTsegmb,\n    SpibarDataVscc0,\n    EfiVariablePkSha256Hash,\n    SpibarDataVscc1,\n    CpuDataCommonSmrrPhysicalMask,\n    NorthBridgeDeviceId,\n    IsNorthBridgeSupported,\n    PciConfigDataTom,\n    EfiVariableKekSha256Hash,\n    SouthBridgeVendorId,\n    EfiVariableSignatureSupport,\n    MmioDataTco1Cnt,\n    EfiVariableKekAttributes,\n    FirmwareAnalysisCpuSupported,\n    MmioDataSmiEn,\n    CpuDataCommonPrmrrUncoreSupported,\n    NorthBridgeVendorId,\n    CpuDataCommonMsrApicBase,\n    EfiVariableDbAttributes,\n    SpibarDataPr2,\n    SpibarDataBfpr,\n    SpibarDataPr1,\n    EfiVariableSecureBootAttributes,\n    SpibarDataPr0,\n    IsSouthBridgeSupported,\n    PciConfigDataHfsts1,\n    CpuDataCommonMsrFeatureControl,\n    PciConfigDataRemaplimit,\n    CpuDataCommonSiliconDebugFeatureControl,\n    CpuDataCommonSmrrPhysicalBase,\n    SouthBridgeDeviceId,\n    CpuDataCommonPrmrrPhysicalMask,\n    EfiVariableDbSha256Hash,\n    SpibarDataHsfs,\n    PciConfigDataRemapbase,\n    EfiVariableCustomMode,\n    PciConfigDataGgc,\n    PciConfigDataTouud,\n    SpibarDataPr4,\n    SpibarDataPr3,\n    CpuDataCommonPrmrrSupported,\n    PciConfigDataSmramc,\n    EfiVariableSignatureSupportAttributes,\n    PciConfigDataBdsm,\n    EfiVariableSetupModeAttributes,\n    EfiVariableSetupMode,\n    PciConfigDataBiosCntl,\n    PciConfigDataMesegBase,\n    SourceFileName,\n    NewFileIdentifier,\n    FeatureVector,\n    ModelPrediction,\n    Malicious,\n    FeatureExtractionVersion,\n    FXFileSize,\n    MLModelVersion,\n    FontBufferLength,\n    FontFileCount,\n    FontLoadOperation,\n    FontBuffer,\n    FontFileName,\n    TemplateInstanceId,\n    PatternDisposition,\n    ServicePackMajor,\n    ProductSku,\n    PointerSize,\n    ProductName,\n    AgentVersion,\n    ServicePackMinor,\n    SuiteMask,\n    SubBuildNumber,\n    PlatformId,\n    BuildType,\n    MajorVersion,\n    ProductType,\n    MinorVersion,\n    CheckedBuild,\n    BuildNumber,\n    RFMState,\n    FirmwareAnalysisEclControlInterfaceVersion,\n    FirmwareAnalysisEclConsumerInterfaceVersion,\n    BootTimeFunctionalityLevel,\n    ReasonOfFunctionalityLevel,\n    CurrentFunctionalityLevel,\n    PciAttachmentState,\n    LocalAddressIP6,\n    RemoteAddressIP6,\n    RegBinaryValue,\n    ServiceDescription,\n    ServiceSecurity,\n    ServiceImagePath,\n    ServiceStart,\n    ServiceType,\n    ServiceFailureActions,\n    ServiceErrorControl,\n    SymbolicLinkName,\n    SymbolicLinkTarget,\n    DevicePropertyClassName,\n    DeviceActiveConfigurationNumber,\n    DevicePropertyClassGuid,\n    DeviceUsbSubclass,\n    ParentHubInstanceId,\n    DeviceConnectionStatus,\n    DeviceUsbClass,\n    ParentHubPort,\n    DevicePropertyManufacturer,\n    DevicePropertyLocationInformation,\n    DeviceProtocol,\n    DevicePropertyDeviceDescription,\n    DeviceUsbVersion,\n    ModuleBaseAddress,\n    ModuleSize,\n    IsOnClearCaseMvfs,\n    DllCharacteristics,\n    ActiveCpuCount,\n    MemoryTotal,\n    BillingType,\n    ConnectionCipher,\n    ConnectType,\n    ConnectionProtocol,\n    ConnectionHash,\n    ConnectTime,\n    ConnectionHashStrength,\n    FailedConnectCount,\n    ConnectionCipherStrength,\n    ConnectionExchangeStrength,\n    ConnectionExchange,\n    PreviousConnectTime,\n    FalconServiceServletErrors,\n    FalconServiceComponent,\n    FalconServiceServletStarts,\n    FalconServiceState,\n    ScriptContent,\n    OriginalContentLength,\n    ScriptingLanguageId,\n    ParentImageFileName,\n    GrandparentImageFileName,\n    ScriptContentName,\n    HostProcessType,\n    ProcessParentCommandLine,\n    ContentSHA256HashData,\n    ProcessGrandparentCommandLine,\n    Type\n;\nlet CrowdStrikeReplicator_All = \nunion isfuzzy = true CrowdStrikeFDRv1Events, CrowdStrikeReplicatorV2(starttime = starttime, endtime = endtime)\n| extend \n    EventVendor = \"Crowdstrike\",\n    EventProduct = \"Replicator\",\n    EventMessage = event_simpleName,\n    ContextTimeStamp = timestamp,\n    Aip = aip,\n    DvcInterfaceGuid = aid\n| project-away aid, aip, event_simpleName, timestamp\n;\nCrowdStrikeReplicator_All\n};\nparser(\nstarttime=starttime, \nendtime=endtime\n)\n",
        "functionParameters": "starttime:datetime=datetime(null),endtime:datetime=datetime(null)",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject2')._parserId2,'/'))))]",
      "dependsOn": [
        "[variables('parserObject2')._parserId2]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdstrikeReplicator Data Parser')]",
        "contentId": "[variables('parserObject2').parserContentId2]",
        "kind": "Parser",
        "version": "[variables('parserObject2').parserVersion2]",
        "source": {
          "kind": "Solution",
          "name": "CrowdStrike Falcon Endpoint Protection",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject3').parserTemplateSpecName3]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdStrikeReplicatorV2 Data Parser with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject3').parserVersion3]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject3')._parserName3]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Union Parser for all CrowdStrike Falcon Data Replicator events",
                "category": "CrowdStrikeParser",
                "functionAlias": "CrowdStrikeReplicatorV2",
                "query": "let parser = (\n    starttime:datetime=datetime(null), \n    endtime:datetime=datetime(null), \n    tablesRequired:dynamic=dynamic([]), \n    eventTypesRequired:dynamic=dynamic([])\n)\n{\n    union isfuzzy=true\n    (\n        ASimDnsActivityLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"DNS\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimFileEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"File\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n            (\n        ASimFileEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"File\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimProcessEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Process\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimProcessEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Process\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimAuthenticationEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Auth\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimAuthenticationEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Auth\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimNetworkSessionLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Network\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimAuditEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Audit\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimRegistryEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Registry\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n            (\n        ASimRegistryEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Registry\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimUserManagementLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"User\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimUserManagementActivityLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"User\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        CrowdStrike_Additional_Events_CL \n        | where array_length(tablesRequired) == 0 or \"Additional\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or name in~ (eventTypesRequired)\n    ),\n    (\n        CrowdStrike_Secondary_Data_CL \n        | where array_length(tablesRequired) == 0 or \"Secondary\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0\n    )\n};\nparser(\n    starttime=starttime, \n    endtime=endtime, \n    tablesRequired=tablesRequired, \n    eventTypesRequired=eventTypesRequired\n)\n",
                "functionParameters": "starttime:datetime=datetime(null),endtime:datetime=datetime(null),tablesRequired:dynamic=dynamic([]),eventTypesRequired:dynamic=dynamic([])",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
              "dependsOn": [
                "[variables('parserObject3')._parserId3]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdStrikeReplicatorV2 Data Parser')]",
                "contentId": "[variables('parserObject3').parserContentId3]",
                "kind": "Parser",
                "version": "[variables('parserObject3').parserVersion3]",
                "source": {
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "contentKind": "Parser",
        "displayName": "Union Parser for all CrowdStrike Falcon Data Replicator events",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject3').parserContentId3,'-', '1.0.0')))]",
        "version": "[variables('parserObject3').parserVersion3]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject3')._parserName3]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Union Parser for all CrowdStrike Falcon Data Replicator events",
        "category": "CrowdStrikeParser",
        "functionAlias": "CrowdStrikeReplicatorV2",
        "query": "let parser = (\n    starttime:datetime=datetime(null), \n    endtime:datetime=datetime(null), \n    tablesRequired:dynamic=dynamic([]), \n    eventTypesRequired:dynamic=dynamic([])\n)\n{\n    union isfuzzy=true\n    (\n        ASimDnsActivityLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"DNS\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimFileEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"File\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n            (\n        ASimFileEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"File\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimProcessEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Process\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimProcessEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Process\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimAuthenticationEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Auth\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimAuthenticationEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Auth\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimNetworkSessionLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Network\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimAuditEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Audit\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimRegistryEventLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Registry\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n            (\n        ASimRegistryEventLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"Registry\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimUserManagementLogs_CL\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"User\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        ASimUserManagementActivityLogs\n        | where EventVendor == \"CrowdStrike\" and EventProduct == \"Falcon Data Replicator\"\n        | where array_length(tablesRequired) == 0 or \"User\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or EventOriginalType in~ (eventTypesRequired)\n    ),\n    (\n        CrowdStrike_Additional_Events_CL \n        | where array_length(tablesRequired) == 0 or \"Additional\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0 or name in~ (eventTypesRequired)\n    ),\n    (\n        CrowdStrike_Secondary_Data_CL \n        | where array_length(tablesRequired) == 0 or \"Secondary\" in~ (tablesRequired)\n        | where (isnull(starttime) or TimeGenerated>=starttime)\n                and     (isnull(endtime) or TimeGenerated<=endtime)\n        | where array_length(eventTypesRequired) == 0\n    )\n};\nparser(\n    starttime=starttime, \n    endtime=endtime, \n    tablesRequired=tablesRequired, \n    eventTypesRequired=eventTypesRequired\n)\n",
        "functionParameters": "starttime:datetime=datetime(null),endtime:datetime=datetime(null),tablesRequired:dynamic=dynamic([]),eventTypesRequired:dynamic=dynamic([])",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject3')._parserId3,'/'))))]",
      "dependsOn": [
        "[variables('parserObject3')._parserId3]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'CrowdStrikeReplicatorV2 Data Parser')]",
        "contentId": "[variables('parserObject3').parserContentId3]",
        "kind": "Parser",
        "version": "[variables('parserObject3').parserVersion3]",
        "source": {
          "kind": "Solution",
          "name": "CrowdStrike Falcon Endpoint Protection",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdStrikeFalconEndpointProtection Workbook with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Sets the time name for analysis"
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f6ef388-eba8-456d-a86d-b0e5d13753dc\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":7776000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"e75aea48-9de8-48ca-8420-93fcdda9b996\",\"cellValue\":\"TabName\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Detections\",\"subTarget\":\"Detections\",\"style\":\"link\"},{\"id\":\"e06768ad-90d3-49d2-aa55-bac601c19769\",\"cellValue\":\"TabName\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Authentication\",\"subTarget\":\"Authentication\",\"style\":\"link\"}]},\"name\":\"links - 7\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"28302220-bac7-4011-bd0b-b8565627887e\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Operation\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| distinct Activity\\r\\n| sort by Activity asc\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"]},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},{\"id\":\"94066942-9782-41b5-b60d-4ea12fda9a28\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TargetUserName\",\"label\":\"Target User\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| distinct DstUserName\\r\\n| sort by DstUserName asc\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"]},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Authentication\"},\"name\":\"parameters - 11\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| where Activity in ({Operation}) or '*' in ({Operation})\\r\\n| where DstUserName in ({TargetUserName}) or '*' in ({TargetUserName})\\r\\n| summarize Total = count() by Activity, bin(TimeGenerated, {TimeRange:grain})\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Events by Operation over Time\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"areachart\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Authentication\"},\"customWidth\":\"75\",\"name\":\"query - 2 - Copy\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"4d809240-d4ee-4266-adc0-cb05344a2f5a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Hostnames\",\"label\":\"Hostname\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| distinct DstHostName\\r\\n| sort by DstHostName asc\",\"value\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},{\"version\":\"KqlParameterItem/1.0\",\"name\":\"Usernames\",\"label\":\"Username\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| distinct DstUserName\\r\\n| sort by DstUserName asc\",\"value\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"id\":\"3be22ee0-2638-4205-bfb4-ba56f9baee92\"},{\"version\":\"KqlParameterItem/1.0\",\"name\":\"Tactics\",\"label\":\"Tactic\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| distinct Activity\\r\\n| sort by Activity asc\",\"value\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":604800000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"id\":\"6c37e6c7-3704-4a9c-a10c-227c1d46b694\"},{\"version\":\"KqlParameterItem/1.0\",\"name\":\"SensorId\",\"label\":\"Sensor ID\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| distinct SensorId\\r\\n| sort by SensorId asc\",\"value\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"id\":\"6e7adfa5-99de-4a23-bf94-2322beee79f1\"},{\"version\":\"KqlParameterItem/1.0\",\"name\":\"Severity\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| distinct Severity\\r\\n| sort by Severity asc\",\"value\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"id\":\"e3a85e7b-f5ed-43d6-a398-fc1a20bb42f7\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"name\":\"parameters - 1\"},{\"type\":1,\"content\":{\"json\":\"___\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"name\":\"text - 17\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize ['Total Detections'] = count() by EventType\",\"size\":4,\"showAnalytics\":true,\"title\":\"Total Detections\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total Detections\",\"formatter\":12,\"formatOptions\":{\"palette\":\"none\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":false}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"30\",\"name\":\"query - 2 - Copy - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = dcount(SensorId) by EventType\",\"size\":4,\"showAnalytics\":true,\"title\":\"Number of Sensors\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"none\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":0}}},\"showBorder\":false}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"30\",\"name\":\"query - 2 - Copy - Copy - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by Severity\",\"size\":4,\"showAnalytics\":true,\"title\":\"Detection by Severity\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"High\",\"color\":\"redDark\"},{\"seriesName\":\"Medium\",\"color\":\"orange\"},{\"seriesName\":\"Low\",\"color\":\"blue\"},{\"seriesName\":\"Critical\",\"color\":\"redBright\"}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"40\",\"name\":\"query - 2 - Copy - Copy\"},{\"type\":1,\"content\":{\"json\":\"___\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"name\":\"text - 17 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| where Severity == \\\"Critical\\\"\\r\\n| summarize Total = count() by TimeGenerated, Severity, DstHostName, DstUserName, Activity, Technique, Message\\r\\n| sort by TimeGenerated desc\\r\\n\",\"size\":1,\"showAnalytics\":true,\"title\":\"Critical Severity Events\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"name\":\"query - 2 - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by Hostname = DstHostName, ['IP Address'] = SrcIpAddr, bin(TimeGenerated, {TimeRange:grain})\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Detections by Host over Time\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"60\",\"name\":\"query - 2\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by Hostname = DstHostName, ['IP Address'] = SrcIpAddr\\r\\n| top 10 by Total desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 Hosts\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"40\",\"name\":\"query - 2 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| where Activity in ({Operation}) or '*' in ({Operation})\\r\\n| where DstUserName in ({TargetUserName}) or '*' in ({TargetUserName})\\r\\n| summarize Total = count() by Activity\\r\\n| sort by Total desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Events by Operation\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Authentication\"},\"customWidth\":\"25\",\"name\":\"query - 2 - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| where Activity in ({Operation}) or '*' in ({Operation})\\r\\n| where DstUserName in ({TargetUserName}) or '*' in ({TargetUserName})\\r\\n| where Outcome == \\\"false\\\"\\r\\n| summarize Total = count() by TimeGenerated, Activity, ['Target Username'] = DstUserName, ['IP Address'] =  DstIpAddr\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Failed Events\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Authentication\"},\"customWidth\":\"100\",\"name\":\"query - 2 - Copy - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| where Activity in ({Operation}) or '*' in ({Operation})\\r\\n| where DstUserName in ({TargetUserName}) or '*' in ({TargetUserName})\\r\\n| where Outcome == \\\"false\\\"\\r\\n| summarize Total = count() by User = DstUserName\\r\\n| sort by Total desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Failed Events by User\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Authentication\"},\"customWidth\":\"50\",\"name\":\"query - 2 - Copy - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"AuthActivityAuditEvent\\\"\\r\\n| where Activity in ({Operation}) or '*' in ({Operation})\\r\\n| where DstUserName in ({TargetUserName}) or '*' in ({TargetUserName})\\r\\n| where Outcome == \\\"false\\\"\\r\\n| summarize Total = count() by ['IP Address'] = DstIpAddr\\r\\n| sort by Total desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Failed Events by IP Address\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Authentication\"},\"customWidth\":\"50\",\"name\":\"query - 2 - Copy - Copy - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by DstUserName, bin(TimeGenerated, {TimeRange:grain})\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Detections by User over Time\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"60\",\"name\":\"query - 2 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by Username = DstUserName\\r\\n| top 10 by Total desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 Users\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2}}}]}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"40\",\"name\":\"query - 2 - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by FileName, FilePath, Tactic = Activity\\r\\n| top 10 by Total desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"File-Based Detections\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2}}}],\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"60\",\"name\":\"query - 15\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by FileName, bin(TimeGenerated, {TimeRange:grain})\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"File-Based Detections over Time\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\",\"gridSettings\":{\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"40\",\"name\":\"query - 15 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by Activity, bin(TimeGenerated, {TimeRange:grain})\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Total Detections by Tactics over Time\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"unstackedbar\"},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"60\",\"name\":\"query - 2 - Copy - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CrowdStrikeFalconEventStream\\r\\n| where EventType == \\\"DetectionSummaryEvent\\\"\\r\\n| where DstHostName in ({Hostnames}) or '*' in ({Hostnames})\\r\\n| where DstUserName in ({Usernames}) or '*' in ({Usernames})\\r\\n| where Activity in ({Tactics}) or '*' in ({Tactics})\\r\\n| where SensorId in ({SensorId}) or '*' in ({SensorId})\\r\\n| where Severity in ({Severity}) or '*' in ({Severity})\\r\\n| summarize Total = count() by Activity\\r\\n| top 10 by Total desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Detections by Tactics\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total\",\"formatter\":8,\"formatOptions\":{\"palette\":\"coldHot\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2}}}]},\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"Activity\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"conditionalVisibility\":{\"parameterName\":\"TabName\",\"comparison\":\"isEqualTo\",\"value\":\"Detections\"},\"customWidth\":\"40\",\"name\":\"query - 2 - Copy - Copy - Copy\"}],\"fallbackResourceIds\":[\"/subscriptions/1ef0bead-010f-49ae-bcf3-142bbc8572cd/resourcegroups/logmanagement-rg/providers/microsoft.operationalinsights/workspaces/cd-azuresentinelworkspace\"],\"fromTemplateId\":\"sentinel-CrowdStrikeFalconEndpointProtection\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=CrowdStrikeFalconEndpointProtectionWorkbook; logoFileName=crowdstrike.svg; description=Sets the time name for analysis; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=CrowdStrike Falcon Endpoint Protection; templateRelativePath=CrowdStrikeFalconEndpointProtection.json; subtitle=; provider=Microsoft}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "CrowdStrikeFalconEventStream",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "CrowdstrikeReplicator",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CriticalOrHighSeverityDetectionsByUser_AnalyticalRules Analytics Rule with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Creates an incident when a large number of Critical/High severity CrowdStrike Falcon sensor detections is triggered by a single user",
                "displayName": "Critical or High Severity Detections by User",
                "enabled": false,
                "query": "let timeframe = 1h;\nlet threshold = 15; // update threshold value based on organization's preference\nlet NoteableEvents = CrowdStrikeFalconEventStream\n| where TimeGenerated > ago(timeframe)\n| where EventType == \"DetectionSummaryEvent\"\n| where Severity in (\"Critical\", \"High\")\n| summarize Total = count() by DstUserName\n| where Total > threshold;\nCrowdStrikeFalconEventStream\n| where TimeGenerated > ago(timeframe)\n| where EventType == \"DetectionSummaryEvent\"\n| where Severity in (\"Critical\", \"High\")\n| join kind=inner (NoteableEvents) on DstUserName\n| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DstHostName, SrcIpAddr, DstUserName, FileName, FileHash, Message\n| extend timestamp = StartTimeUtc, AccountCustomEntity = DstUserName, HostCustomEntity = DstHostName, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash, FileHashAlgo = \"MD5\"\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CommonSecurityLog"
                    ],
                    "connectorId": "CefAma"
                  }
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "identifier": "FullName",
                        "columnName": "AccountCustomEntity"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "identifier": "FullName",
                        "columnName": "HostCustomEntity"
                      }
                    ],
                    "entityType": "Host"
                  },
                  {
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "IPCustomEntity"
                      }
                    ],
                    "entityType": "IP"
                  },
                  {
                    "fieldMappings": [
                      {
                        "identifier": "Algorithm",
                        "columnName": "FileHashAlgo"
                      },
                      {
                        "identifier": "Value",
                        "columnName": "FileHashCustomEntity"
                      }
                    ],
                    "entityType": "FileHash"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "CrowdStrike Falcon Endpoint Protection Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "Critical or High Severity Detections by User",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject2').analyticRuleTemplateSpecName2]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CriticalSeverityDetection_AnalyticalRules Analytics Rule with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject2').analyticRuleVersion2]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Creates an incident when a CrowdStrike Falcon sensor detection is triggered with a Critical Severity",
                "displayName": "Critical Severity Detection",
                "enabled": false,
                "query": "let timeframe = 1h;\nCrowdStrikeFalconEventStream\n| where TimeGenerated > ago(timeframe)\n| where EventType == \"DetectionSummaryEvent\"\n| where Severity == \"Critical\"\n| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DstHostName, SrcIpAddr, DstUserName, Activity, Technique, FileName, FilePath, FileHash, Message\n| extend timestamp = StartTimeUtc, AccountCustomEntity = DstUserName, HostCustomEntity = DstHostName, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash, FileHashAlgo = \"MD5\"\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "dataTypes": [
                      "CommonSecurityLog"
                    ],
                    "connectorId": "CefAma"
                  }
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "identifier": "FullName",
                        "columnName": "AccountCustomEntity"
                      }
                    ],
                    "entityType": "Account"
                  },
                  {
                    "fieldMappings": [
                      {
                        "identifier": "FullName",
                        "columnName": "HostCustomEntity"
                      }
                    ],
                    "entityType": "Host"
                  },
                  {
                    "fieldMappings": [
                      {
                        "identifier": "Address",
                        "columnName": "IPCustomEntity"
                      }
                    ],
                    "entityType": "IP"
                  },
                  {
                    "fieldMappings": [
                      {
                        "identifier": "Algorithm",
                        "columnName": "FileHashAlgo"
                      },
                      {
                        "identifier": "Value",
                        "columnName": "FileHashCustomEntity"
                      }
                    ],
                    "entityType": "FileHash"
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject2').analyticRuleId2,'/'))))]",
              "properties": {
                "description": "CrowdStrike Falcon Endpoint Protection Analytics Rule 2",
                "parentId": "[variables('analyticRuleObject2').analyticRuleId2]",
                "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject2').analyticRuleVersion2]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
        "contentKind": "AnalyticsRule",
        "displayName": "Critical Severity Detection",
        "contentProductId": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "id": "[variables('analyticRuleObject2')._analyticRulecontentProductId2]",
        "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "CrowdStrike_Base Playbook with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion1')]",
          "parameters": {
            "keyvault_Name": {
              "type": "string",
              "defaultValue": "Crowdstrikekey",
              "metadata": {
                "description": "Name of the key vault"
              }
            },
            "ClientID": {
              "type": "string",
              "defaultValue": "ClientID",
              "metadata": {
                "description": "The client Id from key vault"
              }
            },
            "ClientSecret": {
              "type": "securestring",
              "defaultValue": "ClientSecret",
              "metadata": {
                "description": "The client secret from key vault"
              }
            },
            "Service_Endpoint": {
              "defaultValue": "api.crowdstrike.com",
              "type": "String",
              "metadata": {
                "description": "Enter the service endpoint of crowdstrike ex: {crowdsrtikeurl.com}"
              }
            },
            "PlaybookName": {
              "type": "string",
              "minLength": 1,
              "defaultValue": "CrowdStrike_Base",
              "metadata": {
                "description": "Name of the Logic App/Playbook"
              }
            }
          },
          "variables": {
            "keyvault_Connection_Name": "keyvault",
            "ServiceName": "[[concat('https://', parameters('Service_Endpoint'))]",
            "connection-2": "[[concat(subscription().id, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/', 'keyvault')]",
            "_connection-2": "[[variables('connection-2')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    }
                  },
                  "triggers": {
                    "manual": {
                      "type": "Request",
                      "kind": "Http"
                    }
                  },
                  "actions": {
                    "Get_secret_-_Client_ID": {
                      "runAfter": {
                        "Initialize_variable_ClientSecret": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['keyvault']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/secrets/@{encodeURIComponent(variables('ClientID'))}/value"
                      },
                      "description": "This gets the secret Client Id from the keyvault",
                      "runtimeConfiguration": {
                        "secureData": {
                          "properties": [
                            "inputs",
                            "outputs"
                          ]
                        }
                      }
                    },
                    "Get_secret_-_Client_Secret": {
                      "runAfter": {
                        "Get_secret_-_Client_ID": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['keyvault']['connectionId']"
                          }
                        },
                        "method": "get",
                        "path": "/secrets/@{encodeURIComponent(variables('ClientSecret'))}/value"
                      },
                      "description": "This gets the Clientsecret from the keyvault",
                      "runtimeConfiguration": {
                        "secureData": {
                          "properties": [
                            "inputs",
                            "outputs"
                          ]
                        }
                      }
                    },
                    "HTTP_-_Get_Access_Token": {
                      "runAfter": {
                        "Initialize_variable_Falcon_Host_URL": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "body": "client_id=@{body('Get_secret_-_Client_ID')?['value']}&client_secret=@{body('Get_secret_-_Client_Secret')?['value']}",
                        "headers": {
                          "Content-Type": "application/x-www-form-urlencoded",
                          "accept": "application/json"
                        },
                        "method": "POST",
                        "uri": "@{variables('FalconHost')}/oauth2/token"
                      },
                      "description": "This calls the crowdstrike to generate the access token",
                      "runtimeConfiguration": {
                        "secureData": {
                          "properties": [
                            "inputs",
                            "outputs"
                          ]
                        }
                      }
                    },
                    "Initialize_variable_ClientID": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "ClientID",
                            "type": "string",
                            "value": "[[parameters('ClientID')]"
                          }
                        ]
                      }
                    },
                    "Initialize_variable_ClientSecret": {
                      "runAfter": {
                        "Initialize_variable_ClientID": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "ClientSecret",
                            "type": "string",
                            "value": "[[parameters('ClientSecret')]"
                          }
                        ]
                      }
                    },
                    "Initialize_variable_Falcon_Host_URL": {
                      "runAfter": {
                        "Get_secret_-_Client_Secret": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "FalconHost",
                            "type": "string",
                            "value": "[[variables('ServiceName')]"
                          }
                        ]
                      },
                      "description": "This is to hold the Falcon Host URL"
                    },
                    "Parse_JSON_-_Access_Token_Response": {
                      "runAfter": {
                        "HTTP_-_Get_Access_Token": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('HTTP_-_Get_Access_Token')",
                        "schema": {
                          "properties": {
                            "access_token": {
                              "type": "string"
                            },
                            "expires_in": {
                              "type": "integer"
                            },
                            "token_type": {
                              "type": "string"
                            }
                          },
                          "type": "object"
                        }
                      },
                      "description": "prepare json format for get access token response",
                      "runtimeConfiguration": {
                        "secureData": {
                          "properties": [
                            "inputs"
                          ]
                        }
                      }
                    },
                    "Response": {
                      "runAfter": {
                        "Parse_JSON_-_Access_Token_Response": [
                          "Succeeded"
                        ]
                      },
                      "type": "Response",
                      "kind": "Http",
                      "inputs": {
                        "body": {
                          "AccessToken": "Bearer @{body('Parse_JSON_-_Access_Token_Response')?['access_token']}",
                          "FalconHost": "@{variables('FalconHost')}"
                        },
                        "statusCode": 200
                      },
                      "description": "This holds the access token and falcon host URL"
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "keyvault": {
                        "id": "[[concat(subscription().id, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/', 'keyvault')]",
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('keyvault_Connection_Name'))]",
                        "connectionName": "[[variables('keyvault_Connection_Name')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "name": "[[parameters('PlaybookName')]",
              "type": "Microsoft.Logic/workflows",
              "location": "[[variables('workspace-location-inline')]",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('keyvault_Connection_Name'))]"
              ],
              "tags": {
                "hidden-SentinelTemplateName": "Crowdstrike-Authentication",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned",
                "principalId": "[variables('blanks')]",
                "tenantId": "[variables('blanks')]"
              },
              "apiVersion": "2016-06-01"
            },
            {
              "type": "Microsoft.Web/Connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('keyvault_Connection_Name')]",
              "location": "[[variables('workspace-location-inline')]",
              "properties": {
                "api": {
                  "id": "[[variables('_connection-2')]"
                },
                "displayName": "[[variables('keyvault_Connection_Name')]",
                "parameterValueType": "Alternative",
                "AlternativeParameterValues": {
                  "vaultName": "[[parameters('keyvault_Name')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId1'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId1')]",
                "contentId": "[variables('_playbookContentId1')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ],
          "metadata": {
            "title": "Crowdstrike API authentication",
            "description": "This is Crowdstrike base template which is used to generate access token and this is used in actual crowdstrike templates. This playbook gets triggered when a new Http request is created and this is being called from other Crowdstrike playbooks.",
            "prerequisites": [
              "1. Azure Key vault is required for storing the Crowdstrike ClientID and Secrets, create key vault if not exists [learn how](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fquickstarts%2Fmicrosoft.keyvault%2Fkey-vault-secret-create%2Fazuredeploy.json)",
              "2. Add Crowdstrike Client ID and Client Secret in Key vault secrets and capture the keys which are required during the template deployment."
            ],
            "lastUpdateTime": "2022-07-25T00:00:00Z",
            "tags": [
              "Utilities"
            ],
            "source": {
              "type": "solution",
              "name": "CrowdStrike Falcon Endpoint Protection"
            },
            "postDeployment": [
              "**a. Authorize playbook**",
              "Once deployment is complete, we need to add the playbook in the access policy of the Keyvault [learn how](https://docs.microsoft.com/azure/key-vault/general/assign-access-policy-portal)"
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Crowdstrike API authentication",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId1')]",
        "contentKind": "Playbook",
        "displayName": "CrowdStrike_Base",
        "contentProductId": "[variables('_playbookcontentProductId1')]",
        "id": "[variables('_playbookcontentProductId1')]",
        "version": "[variables('playbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Crowdstrike-EndpointEnrichment Playbook with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion2')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "Crowdstrike-EndpointEnrichment",
              "type": "String",
              "metadata": {
                "description": "Name of the Logic App/Playbook"
              }
            },
            "CrowdStrike_Base_Playbook_Name": {
              "defaultValue": "CrowdStrike_Base",
              "type": "String"
            }
          },
          "variables": {
            "AzureSentinelConnectionName": "[[concat('azuresentinel-', parameters('PlaybookName'))]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-2": "[[variables('connection-2')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "actions": {
                    "Add_comment_to_incident_(V3)": {
                      "runAfter": {
                        "Compose_image_to_add_in_the_incident": [
                          "Succeeded"
                        ]
                      },
                      "type": "ApiConnection",
                      "inputs": {
                        "body": {
                          "incidentArmId": "@triggerBody()?['object']?['id']",
                          "message": "<p>@{outputs('Compose_image_to_add_in_the_incident')}<span style=\"font-size: 14px\"><strong>Crowdstrike_Enrichment_GetDeviceInformation playbook run results:</strong></span><br>\n<br>\n@{variables('Comment')}<br>\n</p>"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/Incidents/Comment"
                      }
                    },
                    "Compose_image_to_add_in_the_incident": {
                      "type": "Compose",
                      "inputs": "<img src=\"https://uploads4.craft.co/uploads/company/logo/852xx/85212/normal_1171b7695370eb94.jpg\" alt=\"Lamp\" width=\"32\" height=\"32\">",
                      "runAfter": {
                        "Condition__to_check_if_device_id_returns_results": [
                          "Succeeded"
                        ]
                      },
                      "description": "This composes crowdstrike image to comment in the incident"
                    },
                    "Condition__to_check_if_device_id_returns_results": {
                      "type": "If",
                      "expression": {
                        "and": [
                          {
                            "not": {
                              "equals": [
                                "@body('Parse_JSON_Get_device_id_response')?['resources']?[0]",
                                "@null"
                              ]
                            }
                          }
                        ]
                      },
                      "actions": {
                        "Append_to_string_variable_comment_for_device_information": {
                          "type": "AppendToStringVariable",
                          "inputs": {
                            "name": "Comment",
                            "value": "Device information:\n@{body('Create_HTML_table_for_device_information')}"
                          },
                          "runAfter": {
                            "Create_HTML_table_for_device_information": [
                              "Succeeded"
                            ]
                          },
                          "description": "Appends device information to comment variable"
                        },
                        "Condition_if_detections_are_present_for_the_host": {
                          "type": "If",
                          "expression": {
                            "and": [
                              {
                                "not": {
                                  "equals": [
                                    "@body('Parse_JSON_search_detections_response')?['resources']?[0]",
                                    "@null"
                                  ]
                                }
                              }
                            ]
                          },
                          "actions": {
                            "Append_to_string_variable_detection_information": {
                              "type": "AppendToStringVariable",
                              "inputs": {
                                "name": "Comment",
                                "value": "Detection Information:\n@{body('Select_detection_information')}"
                              },
                              "runAfter": {
                                "Select_detection_information": [
                                  "Succeeded"
                                ]
                              },
                              "description": "This appends detection information to comment variable"
                            },
                            "HTTP-Get_detection_information": {
                              "type": "Http",
                              "inputs": {
                                "method": "POST",
                                "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/detects/entities/summaries/GET/v1",
                                "headers": {
                                  "Accept": "application/json",
                                  "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                                  "Content-Type": "application/json"
                                },
                                "body": {
                                  "ids": "@body('Parse_JSON_search_detections_response')?['resources']"
                                }
                              },
                              "description": "This gets the detection information from the crowdstrike"
                            },
                            "Parse_JSON_detection_information_response": {
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@body('HTTP-Get_detection_information')",
                                "schema": {
                                  "properties": {
                                    "errors": {
                                      "type": "array"
                                    },
                                    "meta": {
                                      "properties": {
                                        "powered_by": {
                                          "type": "string"
                                        },
                                        "query_time": {
                                          "type": "number"
                                        },
                                        "trace_id": {
                                          "type": "string"
                                        }
                                      },
                                      "type": "object"
                                    },
                                    "resources": {
                                      "items": {
                                        "properties": {
                                          "behaviors": {
                                            "items": {
                                              "properties": {
                                                "alleged_filetype": {
                                                  "type": "string"
                                                },
                                                "behavior_id": {
                                                  "type": "string"
                                                },
                                                "cmdline": {
                                                  "type": "string"
                                                },
                                                "confidence": {
                                                  "type": "integer"
                                                },
                                                "control_graph_id": {
                                                  "type": "string"
                                                },
                                                "device_id": {
                                                  "type": "string"
                                                },
                                                "display_name": {
                                                  "type": "string"
                                                },
                                                "filename": {
                                                  "type": "string"
                                                },
                                                "filepath": {
                                                  "type": "string"
                                                },
                                                "ioc_description": {
                                                  "type": "string"
                                                },
                                                "ioc_source": {
                                                  "type": "string"
                                                },
                                                "ioc_type": {
                                                  "type": "string"
                                                },
                                                "ioc_value": {
                                                  "type": "string"
                                                },
                                                "md5": {
                                                  "type": "string"
                                                },
                                                "objective": {
                                                  "type": "string"
                                                },
                                                "parent_details": {
                                                  "properties": {
                                                    "parent_cmdline": {
                                                      "type": "string"
                                                    },
                                                    "parent_md5": {
                                                      "type": "string"
                                                    },
                                                    "parent_process_graph_id": {
                                                      "type": "string"
                                                    },
                                                    "parent_sha256": {
                                                      "type": "string"
                                                    }
                                                  },
                                                  "type": "object"
                                                },
                                                "pattern_disposition": {
                                                  "type": "integer"
                                                },
                                                "pattern_disposition_details": {
                                                  "properties": {
                                                    "bootup_safeguard_enabled": {
                                                      "type": "boolean"
                                                    },
                                                    "critical_process_disabled": {
                                                      "type": "boolean"
                                                    },
                                                    "detect": {
                                                      "type": "boolean"
                                                    },
                                                    "fs_operation_blocked": {
                                                      "type": "boolean"
                                                    },
                                                    "handle_operation_downgraded": {
                                                      "type": "boolean"
                                                    },
                                                    "inddet_mask": {
                                                      "type": "boolean"
                                                    },
                                                    "indicator": {
                                                      "type": "boolean"
                                                    },
                                                    "kill_parent": {
                                                      "type": "boolean"
                                                    },
                                                    "kill_process": {
                                                      "type": "boolean"
                                                    },
                                                    "kill_subprocess": {
                                                      "type": "boolean"
                                                    },
                                                    "operation_blocked": {
                                                      "type": "boolean"
                                                    },
                                                    "policy_disabled": {
                                                      "type": "boolean"
                                                    },
                                                    "process_blocked": {
                                                      "type": "boolean"
                                                    },
                                                    "quarantine_file": {
                                                      "type": "boolean"
                                                    },
                                                    "quarantine_machine": {
                                                      "type": "boolean"
                                                    },
                                                    "registry_operation_blocked": {
                                                      "type": "boolean"
                                                    },
                                                    "rooting": {
                                                      "type": "boolean"
                                                    },
                                                    "sensor_only": {
                                                      "type": "boolean"
                                                    }
                                                  },
                                                  "type": "object"
                                                },
                                                "scenario": {
                                                  "type": "string"
                                                },
                                                "severity": {
                                                  "type": "integer"
                                                },
                                                "sha256": {
                                                  "type": "string"
                                                },
                                                "tactic": {
                                                  "type": "string"
                                                },
                                                "tactic_id": {
                                                  "type": "string"
                                                },
                                                "technique": {
                                                  "type": "string"
                                                },
                                                "technique_id": {
                                                  "type": "string"
                                                },
                                                "timestamp": {
                                                  "type": "string"
                                                },
                                                "triggering_process_graph_id": {
                                                  "type": "string"
                                                },
                                                "user_id": {
                                                  "type": "string"
                                                },
                                                "user_name": {
                                                  "type": "string"
                                                }
                                              },
                                              "required": [
                                                "device_id",
                                                "timestamp",
                                                "behavior_id",
                                                "filename",
                                                "filepath",
                                                "alleged_filetype",
                                                "cmdline",
                                                "scenario",
                                                "objective",
                                                "tactic",
                                                "tactic_id",
                                                "technique",
                                                "technique_id",
                                                "display_name",
                                                "severity",
                                                "confidence",
                                                "ioc_type",
                                                "ioc_value",
                                                "ioc_source",
                                                "ioc_description",
                                                "user_name",
                                                "user_id",
                                                "control_graph_id",
                                                "triggering_process_graph_id",
                                                "sha256",
                                                "md5",
                                                "parent_details",
                                                "pattern_disposition",
                                                "pattern_disposition_details"
                                              ],
                                              "type": "object"
                                            },
                                            "type": "array"
                                          },
                                          "behaviors_processed": {
                                            "items": {
                                              "type": "string"
                                            },
                                            "type": "array"
                                          },
                                          "cid": {
                                            "type": "string"
                                          },
                                          "created_timestamp": {
                                            "type": "string"
                                          },
                                          "detection_id": {
                                            "type": "string"
                                          },
                                          "device": {
                                            "properties": {
                                              "agent_load_flags": {
                                                "type": "string"
                                              },
                                              "agent_local_time": {
                                                "type": "string"
                                              },
                                              "agent_version": {
                                                "type": "string"
                                              },
                                              "bios_manufacturer": {
                                                "type": "string"
                                              },
                                              "bios_version": {
                                                "type": "string"
                                              },
                                              "cid": {
                                                "type": "string"
                                              },
                                              "config_id_base": {
                                                "type": "string"
                                              },
                                              "config_id_build": {
                                                "type": "string"
                                              },
                                              "config_id_platform": {
                                                "type": "string"
                                              },
                                              "device_id": {
                                                "type": "string"
                                              },
                                              "external_ip": {
                                                "type": "string"
                                              },
                                              "first_seen": {
                                                "type": "string"
                                              },
                                              "groups": {
                                                "items": {
                                                  "type": "string"
                                                },
                                                "type": "array"
                                              },
                                              "hostname": {
                                                "type": "string"
                                              },
                                              "last_seen": {
                                                "type": "string"
                                              },
                                              "local_ip": {
                                                "type": "string"
                                              },
                                              "mac_address": {
                                                "type": "string"
                                              },
                                              "machine_domain": {
                                                "type": "string"
                                              },
                                              "major_version": {
                                                "type": "string"
                                              },
                                              "minor_version": {
                                                "type": "string"
                                              },
                                              "modified_timestamp": {
                                                "type": "string"
                                              },
                                              "os_version": {
                                                "type": "string"
                                              },
                                              "ou": {
                                                "items": {
                                                  "type": "string"
                                                },
                                                "type": "array"
                                              },
                                              "platform_id": {
                                                "type": "string"
                                              },
                                              "platform_name": {
                                                "type": "string"
                                              },
                                              "product_type": {
                                                "type": "string"
                                              },
                                              "product_type_desc": {
                                                "type": "string"
                                              },
                                              "site_name": {
                                                "type": "string"
                                              },
                                              "status": {
                                                "type": "string"
                                              },
                                              "system_manufacturer": {
                                                "type": "string"
                                              },
                                              "system_product_name": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "email_sent": {
                                            "type": "boolean"
                                          },
                                          "first_behavior": {
                                            "type": "string"
                                          },
                                          "hostinfo": {
                                            "properties": {
                                              "active_directory_dn_display": {
                                                "items": {
                                                  "type": "string"
                                                },
                                                "type": "array"
                                              },
                                              "domain": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "last_behavior": {
                                            "type": "string"
                                          },
                                          "max_confidence": {
                                            "type": "integer"
                                          },
                                          "max_severity": {
                                            "type": "integer"
                                          },
                                          "max_severity_displayname": {
                                            "type": "string"
                                          },
                                          "seconds_to_resolved": {
                                            "type": "integer"
                                          },
                                          "seconds_to_triaged": {
                                            "type": "integer"
                                          },
                                          "show_in_ui": {
                                            "type": "boolean"
                                          },
                                          "status": {
                                            "type": "string"
                                          }
                                        },
                                        "required": [
                                          "cid",
                                          "created_timestamp",
                                          "detection_id",
                                          "device",
                                          "behaviors",
                                          "email_sent",
                                          "first_behavior",
                                          "last_behavior",
                                          "max_confidence",
                                          "max_severity",
                                          "max_severity_displayname",
                                          "show_in_ui",
                                          "status",
                                          "hostinfo",
                                          "seconds_to_triaged",
                                          "seconds_to_resolved",
                                          "behaviors_processed"
                                        ],
                                        "type": "object"
                                      },
                                      "type": "array"
                                    }
                                  },
                                  "type": "object"
                                }
                              },
                              "runAfter": {
                                "HTTP-Get_detection_information": [
                                  "Succeeded"
                                ]
                              },
                              "description": "prepares json message for detection information"
                            },
                            "Select_detection_information": {
                              "type": "Select",
                              "inputs": {
                                "from": "@body('Parse_JSON_detection_information_response')?['resources']",
                                "select": {
                                  "detection_id": "@item()?['detection_id']",
                                  "device_id": "@item()?['device']?['device_id']",
                                  "domain": "@item()?['hostinfo']?['domain']",
                                  "local_ip": "@item()?['device']?['local_ip']"
                                }
                              },
                              "runAfter": {
                                "Parse_JSON_detection_information_response": [
                                  "Succeeded"
                                ]
                              },
                              "description": "compose detection information"
                            }
                          },
                          "runAfter": {
                            "Parse_JSON_search_detections_response": [
                              "Succeeded"
                            ]
                          },
                          "else": {
                            "actions": {
                              "Append_to_string_variable_comment_if_no_detections_are_present": {
                                "type": "AppendToStringVariable",
                                "inputs": {
                                  "name": "Comment",
                                  "value": "There are no detections present for this device."
                                },
                                "description": "this appends text to comments if no detections are present"
                              }
                            }
                          },
                          "description": "This checks if detections are present for the host"
                        },
                        "Create_HTML_table_for_device_information": {
                          "type": "Table",
                          "inputs": {
                            "from": "@body('Parse_JSON_device_information_response')?['resources']",
                            "format": "HTML",
                            "columns": [
                              {
                                "header": "device_id",
                                "value": "@item()?['device_id']"
                              },
                              {
                                "header": "external_ip",
                                "value": "@item()?['external_ip']"
                              },
                              {
                                "header": "mac_address",
                                "value": "@item()?['mac_address']"
                              },
                              {
                                "header": "hostname",
                                "value": "@item()?['hostname']"
                              },
                              {
                                "header": "first_seen",
                                "value": "@item()?['first_seen']"
                              },
                              {
                                "header": "last_seen",
                                "value": "@item()?['last_seen']"
                              },
                              {
                                "header": "local_ip",
                                "value": "@item()?['local_ip']"
                              },
                              {
                                "header": "machine_domain",
                                "value": "@item()?['machine_domain']"
                              },
                              {
                                "header": "os_version",
                                "value": "@item()?['os_version']"
                              }
                            ]
                          },
                          "runAfter": {
                            "Parse_JSON_device_information_response": [
                              "Succeeded"
                            ]
                          },
                          "description": "prepares HTML table for device information"
                        },
                        "HTTP_-Search_for_detections": {
                          "type": "Http",
                          "inputs": {
                            "method": "GET",
                            "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/detects/queries/detects/v1?filter=first_behavior:>'@{variables('Timestamp')}'&device_id:'@{body('Parse_JSON_Get_device_id_response')?['resources']?[0]}'&sort=first_behavior.desc",
                            "headers": {
                              "Accept": "application/json",
                              "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                              "Content-Type": "application/json"
                            }
                          },
                          "runAfter": {
                            "Set_variable_timestamp_for_past_3_days": [
                              "Succeeded"
                            ]
                          },
                          "description": "searches the detections based on the filters from crowdstrike"
                        },
                        "HTTP_-_Get_device_information_": {
                          "type": "Http",
                          "inputs": {
                            "method": "GET",
                            "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/devices/entities/devices/v1?ids=@{body('Parse_JSON_Get_device_id_response')?['resources']?[0]}",
                            "headers": {
                              "Accept": "application/json",
                              "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                              "Content-Type": "application/json"
                            }
                          },
                          "description": "This gets the device information from crowdstrike"
                        },
                        "Parse_JSON_device_information_response": {
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@body('HTTP_-_Get_device_information_')",
                            "schema": {
                              "properties": {
                                "errors": {
                                  "type": "array"
                                },
                                "meta": {
                                  "properties": {
                                    "powered_by": {
                                      "type": "string"
                                    },
                                    "query_time": {
                                      "type": "number"
                                    },
                                    "trace_id": {
                                      "type": "string"
                                    }
                                  },
                                  "type": "object"
                                },
                                "resources": {
                                  "items": {
                                    "properties": {
                                      "agent_load_flags": {
                                        "type": "string"
                                      },
                                      "agent_local_time": {
                                        "type": "string"
                                      },
                                      "agent_version": {
                                        "type": "string"
                                      },
                                      "bios_manufacturer": {
                                        "type": "string"
                                      },
                                      "bios_version": {
                                        "type": "string"
                                      },
                                      "build_number": {
                                        "type": "string"
                                      },
                                      "cid": {
                                        "type": "string"
                                      },
                                      "config_id_base": {
                                        "type": "string"
                                      },
                                      "config_id_build": {
                                        "type": "string"
                                      },
                                      "config_id_platform": {
                                        "type": "string"
                                      },
                                      "cpu_signature": {
                                        "type": "string"
                                      },
                                      "device_id": {
                                        "type": "string"
                                      },
                                      "device_policies": {
                                        "properties": {
                                          "device_control": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "firewall": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "rule_set_id": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "global_config": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "prevention": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "rule_groups": {
                                                "items": {
                                                  "type": "string"
                                                },
                                                "type": "array"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "remote_response": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "sensor_update": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              },
                                              "uninstall_protection": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "external_ip": {
                                        "type": "string"
                                      },
                                      "first_seen": {
                                        "type": "string"
                                      },
                                      "group_hash": {
                                        "type": "string"
                                      },
                                      "groups": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "hostname": {
                                        "type": "string"
                                      },
                                      "last_seen": {
                                        "type": "string"
                                      },
                                      "local_ip": {
                                        "type": "string"
                                      },
                                      "mac_address": {
                                        "type": "string"
                                      },
                                      "machine_domain": {
                                        "type": "string"
                                      },
                                      "major_version": {
                                        "type": "string"
                                      },
                                      "meta": {
                                        "properties": {
                                          "version": {
                                            "type": "string"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "minor_version": {
                                        "type": "string"
                                      },
                                      "modified_timestamp": {
                                        "type": "string"
                                      },
                                      "os_version": {
                                        "type": "string"
                                      },
                                      "ou": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "platform_id": {
                                        "type": "string"
                                      },
                                      "platform_name": {
                                        "type": "string"
                                      },
                                      "pointer_size": {
                                        "type": "string"
                                      },
                                      "policies": {
                                        "items": {
                                          "properties": {
                                            "applied": {
                                              "type": "boolean"
                                            },
                                            "applied_date": {
                                              "type": "string"
                                            },
                                            "assigned_date": {
                                              "type": "string"
                                            },
                                            "policy_id": {
                                              "type": "string"
                                            },
                                            "policy_type": {
                                              "type": "string"
                                            },
                                            "rule_groups": {
                                              "items": {
                                                "type": "string"
                                              },
                                              "type": "array"
                                            },
                                            "settings_hash": {
                                              "type": "string"
                                            }
                                          },
                                          "required": [
                                            "policy_type",
                                            "policy_id",
                                            "applied",
                                            "settings_hash",
                                            "assigned_date",
                                            "applied_date",
                                            "rule_groups"
                                          ],
                                          "type": "object"
                                        },
                                        "type": "array"
                                      },
                                      "product_type": {
                                        "type": "string"
                                      },
                                      "product_type_desc": {
                                        "type": "string"
                                      },
                                      "provision_status": {
                                        "type": "string"
                                      },
                                      "reduced_functionality_mode": {
                                        "type": "string"
                                      },
                                      "serial_number": {
                                        "type": "string"
                                      },
                                      "service_pack_major": {
                                        "type": "string"
                                      },
                                      "service_pack_minor": {
                                        "type": "string"
                                      },
                                      "site_name": {
                                        "type": "string"
                                      },
                                      "slow_changing_modified_timestamp": {
                                        "type": "string"
                                      },
                                      "status": {
                                        "type": "string"
                                      },
                                      "system_manufacturer": {
                                        "type": "string"
                                      },
                                      "system_product_name": {
                                        "type": "string"
                                      },
                                      "tags": {
                                        "type": "array"
                                      }
                                    },
                                    "required": [
                                      "device_id",
                                      "cid",
                                      "agent_load_flags",
                                      "agent_local_time",
                                      "agent_version",
                                      "bios_manufacturer",
                                      "bios_version",
                                      "build_number",
                                      "config_id_base",
                                      "config_id_build",
                                      "config_id_platform",
                                      "cpu_signature",
                                      "external_ip",
                                      "mac_address",
                                      "hostname",
                                      "first_seen",
                                      "last_seen",
                                      "local_ip",
                                      "major_version",
                                      "minor_version",
                                      "os_version",
                                      "platform_id",
                                      "platform_name",
                                      "policies",
                                      "reduced_functionality_mode",
                                      "device_policies",
                                      "groups",
                                      "group_hash",
                                      "product_type",
                                      "product_type_desc",
                                      "provision_status",
                                      "serial_number",
                                      "service_pack_major",
                                      "service_pack_minor",
                                      "pointer_size",
                                      "status",
                                      "system_manufacturer",
                                      "system_product_name",
                                      "tags",
                                      "modified_timestamp",
                                      "slow_changing_modified_timestamp",
                                      "meta"
                                    ],
                                    "type": "object"
                                  },
                                  "type": "array"
                                }
                              },
                              "type": "object"
                            }
                          },
                          "runAfter": {
                            "HTTP_-_Get_device_information_": [
                              "Succeeded"
                            ]
                          },
                          "description": "prepares json for device information"
                        },
                        "Parse_JSON_search_detections_response": {
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@body('HTTP_-Search_for_detections')",
                            "schema": {
                              "properties": {
                                "errors": {
                                  "type": "array"
                                },
                                "meta": {
                                  "properties": {
                                    "pagination": {
                                      "properties": {
                                        "limit": {
                                          "type": "integer"
                                        },
                                        "offset": {
                                          "type": "integer"
                                        },
                                        "total": {
                                          "type": "integer"
                                        }
                                      },
                                      "type": "object"
                                    },
                                    "powered_by": {
                                      "type": "string"
                                    },
                                    "query_time": {
                                      "type": "number"
                                    },
                                    "trace_id": {
                                      "type": "string"
                                    }
                                  },
                                  "type": "object"
                                },
                                "resources": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array"
                                }
                              },
                              "type": "object"
                            }
                          },
                          "runAfter": {
                            "HTTP_-Search_for_detections": [
                              "Succeeded"
                            ]
                          },
                          "description": "prepares json for search detections"
                        },
                        "Set_variable_timestamp_for_past_3_days": {
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Timestamp",
                            "value": "@{getPastTime(3, 'Day')}"
                          },
                          "runAfter": {
                            "Append_to_string_variable_comment_for_device_information": [
                              "Succeeded"
                            ]
                          },
                          "description": "set variable timestamp for past 3 days to filter detections"
                        }
                      },
                      "runAfter": {
                        "Parse_JSON_Get_device_id_response": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_string_variable_if_no_devices_are_present": {
                            "type": "AppendToStringVariable",
                            "inputs": {
                              "name": "Comment",
                              "value": "There are no devices present"
                            },
                            "description": "This appends text to string variable if no devices are present"
                          }
                        }
                      },
                      "description": "This checks if device is present in falcon host or not"
                    },
                    "CrowdStrike_Base": {
                      "runAfter": {
                        "Initialize_variable_comment": [
                          "Succeeded"
                        ]
                      },
                      "type": "Workflow",
                      "inputs": {
                        "host": {
                          "triggerName": "manual",
                          "workflow": {
                            "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name ,'/providers/Microsoft.Logic/workflows/', parameters('CrowdStrike_Base_Playbook_Name'))]"
                          }
                        }
                      },
                      "description": "This is to call the base logic app to get the access token and falcon host URL"
                    },
                    "Entities_-_Get_Hosts": {
                      "type": "ApiConnection",
                      "inputs": {
                        "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "path": "/entities/host"
                      }
                    },
                    "HTTP_-_Get_device_id": {
                      "type": "Http",
                      "inputs": {
                        "method": "GET",
                        "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/devices/queries/devices/v1?filter=hostname:'@{body('Entities_-_Get_Hosts')?['Hosts']?[0]?['HostName']}'",
                        "headers": {
                          "Accept": "application/json",
                          "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                          "Content-Type": "application/json"
                        }
                      },
                      "runAfter": {
                        "CrowdStrike_Base": [
                          "Succeeded"
                        ]
                      },
                      "description": "This filters the device id by hostname"
                    },
                    "Initialize_variable_comment": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Comment",
                            "type": "string"
                          }
                        ]
                      },
                      "runAfter": {
                        "Initialize_variable_timestamp": [
                          "Succeeded"
                        ]
                      },
                      "description": "This holds the variable comment to include in the incident"
                    },
                    "Initialize_variable_timestamp": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Timestamp",
                            "type": "string"
                          }
                        ]
                      },
                      "runAfter": {
                        "Entities_-_Get_Hosts": [
                          "Succeeded"
                        ]
                      },
                      "description": "Initialize timestamp variable to hold the timestamp"
                    },
                    "Parse_JSON_Get_device_id_response": {
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('HTTP_-_Get_device_id')",
                        "schema": {
                          "errors": "[variables('TemplateEmptyArray')]",
                          "meta": {
                            "pagination": {
                              "limit": 100,
                              "offset": 1,
                              "total": 1
                            },
                            "powered_by": "device-api",
                            "query_time": 0.005041315,
                            "trace_id": "aa7b84f5-3e81-4980-ad9f-c14b6d8ca577"
                          },
                          "resources": [
                            "cdc977a72a8c49528bb82f89dde2c2e9"
                          ]
                        }
                      },
                      "runAfter": {
                        "HTTP_-_Get_device_id": [
                          "Succeeded"
                        ]
                      },
                      "description": "prepares json for the device id response"
                    }
                  },
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    }
                  },
                  "triggers": {
                    "When_Azure_Sentinel_incident_creation_rule_was_triggered_(Private_Preview_only)": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "contentVersion": "1.0.0.0"
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                        "connectionName": "[[variables('AzureSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "identity": {
                "type": "SystemAssigned"
              },
              "tags": {
                "hidden-SentinelTemplateName": "EndpointEnrichment-Crowdstrike",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]"
              ]
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('AzureSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('AzureSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId2'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId2')]",
                "contentId": "[variables('_playbookContentId2')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ],
          "metadata": {
            "title": "Endpoint enrichment - Crowdstrike",
            "description": "When a new Microsoft Sentinel incident is created, this playbook gets triggered and performs below actions:",
            "mainSteps": [
              "1. Fetches the device information from Crowdstrike",
              "2. Enrich the incident with device information from Crowdstrike"
            ],
            "prerequisites": [
              "1. Azure Key vault is required for storing the Crowdstrike ClientID and Secrets, create key vault if not exists [learn how](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fquickstarts%2Fmicrosoft.keyvault%2Fkey-vault-secret-create%2Fazuredeploy.json)",
              "2. Add Crowdstrike Client ID and Client Secret in Key vault secrets and capture the keys which are required during the template deployment",
              "3. CrowdStrike_Base playbook needs to be deployed prior to the deployment of this playbook under the same subscription and under the same resource group.",
              "4. CrowdStrike_Base playbook needs to be added in the access policy of the Key Vault [learn how](https://docs.microsoft.com/azure/key-vault/general/assign-access-policy-portal)"
            ],
            "lastUpdateTime": "2022-07-25T00:00:00Z",
            "entities": [
              "Host"
            ],
            "tags": [
              "Remediation"
            ],
            "source": {
              "type": "solution",
              "name": "CrowdStrike Falcon Endpoint Protection"
            },
            "postDeployment": [
              "** a. Authorize connections **",
              "Once deployment is complete, you will need to authorize connections.",
              "1. Click the Microsoft Sentinel connection resource",
              "2. Click edit API connection",
              "3. Click Authorize",
              "4. Sign in",
              "5. Click Save",
              "** b. Configurations in Sentinel **",
              "1. In Microsoft sentinel analytical rules should be configured to trigger an incident with risky device",
              "2. Configure the automation rules to trigger this playbook"
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Endpoint enrichment - Crowdstrike",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId2')]",
        "contentKind": "Playbook",
        "displayName": "Crowdstrike-EndpointEnrichment",
        "contentProductId": "[variables('_playbookcontentProductId2')]",
        "id": "[variables('_playbookcontentProductId2')]",
        "version": "[variables('playbookVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName3')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Crowdstrike-ContainHost Playbook with template version 3.1.8",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion3')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "Crowdstrike-ContainHost",
              "type": "String",
              "metadata": {
                "description": "Name of the Logic App/Playbook"
              }
            },
            "CrowdStrike_Base_Playbook_Name": {
              "defaultValue": "CrowdStrike_Base",
              "type": "String"
            }
          },
          "variables": {
            "AzureSentinelConnectionName": "[[concat('azuresentinel-', parameters('PlaybookName'))]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
            "_connection-2": "[[variables('connection-2')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "actions": {
                    "Add_comment_to_incident_(V3)": {
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "body": {
                          "incidentArmId": "@triggerBody()?['object']?['id']",
                          "message": "<p>@{outputs('Compose_image_to_add_in_the_incident')}<span style=\"font-size: 16px\"><strong>CrowdStrike_ContainHost playbook run results:</strong></span><br>\n<br>\n@{variables('Comment')}</p>"
                        },
                        "path": "/Incidents/Comment"
                      },
                      "runAfter": {
                        "Compose_image_to_add_in_the_incident": [
                          "Succeeded"
                        ]
                      },
                      "description": "This adds comments to the Microsoft sentinel incident"
                    },
                    "Compose_image_to_add_in_the_incident": {
                      "type": "Compose",
                      "inputs": "<img src=\"https://uploads4.craft.co/uploads/company/logo/852xx/85212/normal_1171b7695370eb94.jpg\"  width=\"32\" height=\"32\">",
                      "runAfter": {
                        "Condition_to_check_if_device_is_present_in_falcon_host_crowdstrike": [
                          "Succeeded"
                        ]
                      },
                      "description": "This composes the crowd strike image to comment in the incident"
                    },
                    "Condition_to_check_if_crowdstrike_action_is_successful": {
                      "type": "If",
                      "expression": {
                        "and": [
                          {
                            "equals": [
                              "@variables('Successfromcrowdstike')",
                              "Success"
                            ]
                          }
                        ]
                      },
                      "actions": {
                        "Update_incident": {
                          "type": "ApiConnection",
                          "inputs": {
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                              }
                            },
                            "method": "put",
                            "body": {
                              "incidentArmId": "@triggerBody()?['object']?['id']",
                              "status": "Closed",
                              "classification": {
                                "ClassificationAndReason": "Benign Positive - Suspicious But Expected",
                                "ClassificationReasonText": "CrowdStrike_ContainHost playbook ran and closed this incident"
                              }
                            },
                            "path": "/Incidents"
                          }
                        }
                      },
                      "runAfter": {
                        "Add_comment_to_incident_(V3)": [
                          "Succeeded"
                        ]
                      },
                      "description": "This checks if crowdstrike action is successful or not"
                    },
                    "Condition_to_check_if_device_is_present_in_falcon_host_crowdstrike": {
                      "type": "If",
                      "expression": {
                        "and": [
                          {
                            "not": {
                              "equals": [
                                "@body('Parse_JSON_Get_device_id_response')?['resources']?[0]",
                                "@null"
                              ]
                            }
                          }
                        ]
                      },
                      "actions": {
                        "Append_to_string_variable_comment_for_device_information": {
                          "type": "AppendToStringVariable",
                          "inputs": {
                            "name": "Comment",
                            "value": "Devices information from crowdstrike:\n@{body('Create_HTML_table_for_device_information')}"
                          },
                          "runAfter": {
                            "Create_HTML_table_for_device_information": [
                              "Succeeded"
                            ]
                          },
                          "description": "Append html format of device information to comment in the incident"
                        },
                        "Create_HTML_table_for_device_information": {
                          "type": "Table",
                          "inputs": {
                            "from": "@body('Parse_JSON_device_information_response')?['resources']",
                            "format": "HTML",
                            "columns": [
                              {
                                "header": "device_id",
                                "value": "@item()?['device_id']"
                              },
                              {
                                "header": "external_ip",
                                "value": "@item()?['external_ip']"
                              },
                              {
                                "header": "mac_address",
                                "value": "@item()?['mac_address']"
                              },
                              {
                                "header": "hostname",
                                "value": "@item()?['hostname']"
                              },
                              {
                                "header": "first_seen",
                                "value": "@item()?['first_seen']"
                              },
                              {
                                "header": "last_seen",
                                "value": "@item()?['last_seen']"
                              },
                              {
                                "header": "local_ip",
                                "value": "@item()?['local_ip']"
                              },
                              {
                                "header": "machine_domain",
                                "value": "@item()?['machine_domain']"
                              },
                              {
                                "header": "os_version",
                                "value": "@item()?['os_version']"
                              }
                            ]
                          },
                          "runAfter": {
                            "Parse_JSON_device_information_response": [
                              "Succeeded"
                            ]
                          },
                          "description": "prepare HTML table format to update in the incident"
                        },
                        "HTTP_-_Get_device_information_": {
                          "type": "Http",
                          "inputs": {
                            "method": "GET",
                            "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/devices/entities/devices/v1?ids=@{body('Parse_JSON_Get_device_id_response')?['resources']?[0]}",
                            "headers": {
                              "Accept": "application/json",
                              "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                              "Content-Type": "application/json"
                            }
                          },
                          "description": "This gets the device information from crowdstrike"
                        },
                        "Parse_JSON_device_information_response": {
                          "type": "ParseJson",
                          "inputs": {
                            "content": "@body('HTTP_-_Get_device_information_')",
                            "schema": {
                              "properties": {
                                "errors": {
                                  "type": "array"
                                },
                                "meta": {
                                  "properties": {
                                    "powered_by": {
                                      "type": "string"
                                    },
                                    "query_time": {
                                      "type": "number"
                                    },
                                    "trace_id": {
                                      "type": "string"
                                    }
                                  },
                                  "type": "object"
                                },
                                "resources": {
                                  "items": {
                                    "properties": {
                                      "agent_load_flags": {
                                        "type": "string"
                                      },
                                      "agent_local_time": {
                                        "type": "string"
                                      },
                                      "agent_version": {
                                        "type": "string"
                                      },
                                      "bios_manufacturer": {
                                        "type": "string"
                                      },
                                      "bios_version": {
                                        "type": "string"
                                      },
                                      "build_number": {
                                        "type": "string"
                                      },
                                      "cid": {
                                        "type": "string"
                                      },
                                      "config_id_base": {
                                        "type": "string"
                                      },
                                      "config_id_build": {
                                        "type": "string"
                                      },
                                      "config_id_platform": {
                                        "type": "string"
                                      },
                                      "cpu_signature": {
                                        "type": "string"
                                      },
                                      "device_id": {
                                        "type": "string"
                                      },
                                      "device_policies": {
                                        "properties": {
                                          "device_control": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "firewall": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "rule_set_id": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "global_config": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "prevention": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "rule_groups": {
                                                "items": {
                                                  "type": "string"
                                                },
                                                "type": "array"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "remote_response": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          },
                                          "sensor_update": {
                                            "properties": {
                                              "applied": {
                                                "type": "boolean"
                                              },
                                              "applied_date": {
                                                "type": "string"
                                              },
                                              "assigned_date": {
                                                "type": "string"
                                              },
                                              "policy_id": {
                                                "type": "string"
                                              },
                                              "policy_type": {
                                                "type": "string"
                                              },
                                              "settings_hash": {
                                                "type": "string"
                                              },
                                              "uninstall_protection": {
                                                "type": "string"
                                              }
                                            },
                                            "type": "object"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "external_ip": {
                                        "type": "string"
                                      },
                                      "first_seen": {
                                        "type": "string"
                                      },
                                      "group_hash": {
                                        "type": "string"
                                      },
                                      "groups": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "hostname": {
                                        "type": "string"
                                      },
                                      "last_seen": {
                                        "type": "string"
                                      },
                                      "local_ip": {
                                        "type": "string"
                                      },
                                      "mac_address": {
                                        "type": "string"
                                      },
                                      "machine_domain": {
                                        "type": "string"
                                      },
                                      "major_version": {
                                        "type": "string"
                                      },
                                      "meta": {
                                        "properties": {
                                          "version": {
                                            "type": "string"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "minor_version": {
                                        "type": "string"
                                      },
                                      "modified_timestamp": {
                                        "type": "string"
                                      },
                                      "os_version": {
                                        "type": "string"
                                      },
                                      "ou": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "platform_id": {
                                        "type": "string"
                                      },
                                      "platform_name": {
                                        "type": "string"
                                      },
                                      "pointer_size": {
                                        "type": "string"
                                      },
                                      "policies": {
                                        "items": {
                                          "properties": {
                                            "applied": {
                                              "type": "boolean"
                                            },
                                            "applied_date": {
                                              "type": "string"
                                            },
                                            "assigned_date": {
                                              "type": "string"
                                            },
                                            "policy_id": {
                                              "type": "string"
                                            },
                                            "policy_type": {
                                              "type": "string"
                                            },
                                            "rule_groups": {
                                              "items": {
                                                "type": "string"
                                              },
                                              "type": "array"
                                            },
                                            "settings_hash": {
                                              "type": "string"
                                            }
                                          },
                                          "required": [
                                            "policy_type",
                                            "policy_id",
                                            "applied",
                                            "settings_hash",
                                            "assigned_date",
                                            "applied_date",
                                            "rule_groups"
                                          ],
                                          "type": "object"
                                        },
                                        "type": "array"
                                      },
                                      "product_type": {
                                        "type": "string"
                                      },
                                      "product_type_desc": {
                                        "type": "string"
                                      },
                                      "provision_status": {
                                        "type": "string"
                                      },
                                      "reduced_functionality_mode": {
                                        "type": "string"
                                      },
                                      "serial_number": {
                                        "type": "string"
                                      },
                                      "service_pack_major": {
                                        "type": "string"
                                      },
                                      "service_pack_minor": {
                                        "type": "string"
                                      },
                                      "site_name": {
                                        "type": "string"
                                      },
                                      "slow_changing_modified_timestamp": {
                                        "type": "string"
                                      },
                                      "status": {
                                        "type": "string"
                                      },
                                      "system_manufacturer": {
                                        "type": "string"
                                      },
                                      "system_product_name": {
                                        "type": "string"
                                      },
                                      "tags": {
                                        "type": "array"
                                      }
                                    },
                                    "required": [
                                      "device_id",
                                      "cid",
                                      "agent_load_flags",
                                      "agent_local_time",
                                      "agent_version",
                                      "bios_manufacturer",
                                      "bios_version",
                                      "build_number",
                                      "config_id_base",
                                      "config_id_build",
                                      "config_id_platform",
                                      "cpu_signature",
                                      "external_ip",
                                      "mac_address",
                                      "hostname",
                                      "first_seen",
                                      "last_seen",
                                      "local_ip",
                                      "machine_domain",
                                      "major_version",
                                      "minor_version",
                                      "platform_id",
                                      "platform_name",
                                      "policies",
                                      "reduced_functionality_mode",
                                      "device_policies",
                                      "groups",
                                      "group_hash",
                                      "product_type",
                                      "product_type_desc",
                                      "provision_status",
                                      "serial_number",
                                      "service_pack_major",
                                      "service_pack_minor",
                                      "pointer_size",
                                      "status",
                                      "system_manufacturer",
                                      "system_product_name",
                                      "tags",
                                      "modified_timestamp",
                                      "slow_changing_modified_timestamp",
                                      "meta"
                                    ],
                                    "type": "object"
                                  },
                                  "type": "array"
                                }
                              },
                              "type": "object"
                            }
                          },
                          "runAfter": {
                            "HTTP_-_Get_device_information_": [
                              "Succeeded"
                            ]
                          },
                          "description": "prepare Json message for device information"
                        },
                        "Switch_to_check_the_device_status": {
                          "type": "Switch",
                          "expression": "@body('Parse_JSON_device_information_response')?['resources']?[0]?['status']",
                          "cases": {
                            "Case_-_contained": {
                              "case": "contained",
                              "actions": {
                                "Append_to_string_variable_comment_if_host_is_contained": {
                                  "type": "AppendToStringVariable",
                                  "inputs": {
                                    "name": "Comment",
                                    "value": "Host Status : Contained\nActions taken on devices : No action taken from playbook"
                                  },
                                  "description": "This appends comments if the host status is already contained"
                                },
                                "Set_variable_success_from_crowdstirke_in_case_of_host_is_already_contained": {
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Successfromcrowdstike",
                                    "value": "Success"
                                  },
                                  "runAfter": {
                                    "Append_to_string_variable_comment_if_host_is_contained": [
                                      "Succeeded"
                                    ]
                                  },
                                  "description": "This sets the variable success from crowdstrike to update in the incident"
                                }
                              }
                            },
                            "Case_-_containment_pending": {
                              "case": "containment_pending",
                              "actions": {
                                "Append_to_string_variable_comment_if_host_status_is_containment_pending": {
                                  "type": "AppendToStringVariable",
                                  "inputs": {
                                    "name": "Comment",
                                    "value": "Host Status : containment_pending\nActions taken on devices : No action taken from playbook"
                                  },
                                  "description": "This appends comments if the host status is containment pending"
                                },
                                "Set_variable_success_from_crowdstirke_in_case_of_containment_pending": {
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Successfromcrowdstike",
                                    "value": "Success"
                                  },
                                  "runAfter": {
                                    "Append_to_string_variable_comment_if_host_status_is_containment_pending": [
                                      "Succeeded"
                                    ]
                                  },
                                  "description": "This sets the variable success from crowdstrike to update in the incident"
                                }
                              }
                            },
                            "Case_-_lift_containment_pending": {
                              "case": "lift_containment_pending",
                              "actions": {
                                "Append_to_string_variable_comment_if_host_status_is_lift_containment_pending": {
                                  "type": "AppendToStringVariable",
                                  "inputs": {
                                    "name": "Comment",
                                    "value": "Host Status : Lift_containment_pending\nActions taken on devices : No action taken from playbook"
                                  },
                                  "description": "Append to variable comment if host status is lift containment pending"
                                },
                                "Set_variable_success_from_crowdstirke_in_case_of_lift_containment_pending": {
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Successfromcrowdstike",
                                    "value": "Success"
                                  },
                                  "runAfter": {
                                    "Append_to_string_variable_comment_if_host_status_is_lift_containment_pending": [
                                      "Succeeded"
                                    ]
                                  },
                                  "description": "This sets the variable success from crowdstrike to update in the incident"
                                }
                              }
                            },
                            "Case_-_not_contained": {
                              "case": "normal",
                              "actions": {
                                "Condition_to_check_if_contain_success_or_not": {
                                  "type": "If",
                                  "expression": {
                                    "and": [
                                      {
                                        "equals": [
                                          "@outputs('HTTP_-_Contain_a_host')['statusCode']",
                                          202
                                        ]
                                      }
                                    ]
                                  },
                                  "actions": {
                                    "Append_to_string_variable_comment_if_host_is_contained_by_playbook": {
                                      "type": "AppendToStringVariable",
                                      "inputs": {
                                        "name": "Comment",
                                        "value": "Host Status : Contained\nActions taken on devices : The playbook sucessfully contained the host"
                                      },
                                      "description": "This appends the variable comment if host is contained by playbook"
                                    },
                                    "Set_variable_success_from_crowdstirke_in_case_of_success": {
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Successfromcrowdstike",
                                        "value": "Success"
                                      },
                                      "runAfter": {
                                        "Append_to_string_variable_comment_if_host_is_contained_by_playbook": [
                                          "Succeeded"
                                        ]
                                      },
                                      "description": "This sets variable success from crowdstirke in case of success"
                                    }
                                  },
                                  "runAfter": {
                                    "HTTP_-_Contain_a_host": [
                                      "Succeeded"
                                    ]
                                  },
                                  "else": {
                                    "actions": {
                                      "Append_to_string_variable_comment_if_host_is_not_contained_by_playbook": {
                                        "type": "AppendToStringVariable",
                                        "inputs": {
                                          "name": "Comment",
                                          "value": "Host Status : Not contained/Normal\nActions taken on devices : The playbook failed to contain the host"
                                        },
                                        "description": "This sets the variable comment if host is not contained by playbook"
                                      },
                                      "Set_variable_success_from_crowdstrike_in_case_of_failure": {
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Successfromcrowdstike",
                                          "value": "Failure"
                                        },
                                        "runAfter": {
                                          "Append_to_string_variable_comment_if_host_is_not_contained_by_playbook": [
                                            "Succeeded"
                                          ]
                                        },
                                        "description": "This sets variable success from crowdstirke in case of Failure"
                                      }
                                    }
                                  },
                                  "description": "condition to check if contain a host is success or failure"
                                },
                                "HTTP_-_Contain_a_host": {
                                  "type": "Http",
                                  "inputs": {
                                    "method": "POST",
                                    "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/devices/entities/devices-actions/v2?action_name=contain",
                                    "headers": {
                                      "Accept": "application/json",
                                      "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                                      "Content-Type": "application/json"
                                    },
                                    "body": {
                                      "action_parameters": [
                                        {
                                          "name": "contain"
                                        }
                                      ],
                                      "ids": [
                                        "@{body('Parse_JSON_Get_device_id_response')?['resources']?[0]}"
                                      ]
                                    }
                                  },
                                  "description": "This will contain a host in crowdstrike"
                                }
                              }
                            }
                          },
                          "runAfter": {
                            "Append_to_string_variable_comment_for_device_information": [
                              "Succeeded"
                            ]
                          },
                          "description": "This checks on the device status"
                        }
                      },
                      "runAfter": {
                        "Parse_JSON_Get_device_id_response": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_string_variable_comment_if_no_device_exist": {
                            "type": "AppendToStringVariable",
                            "inputs": {
                              "name": "Comment",
                              "value": "There is no device present in Crowdstrike"
                            },
                            "description": "This appends test to comment if no device available in crowdstrike"
                          },
                          "Set_variable_success_from_crowdstrike": {
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Successfromcrowdstike",
                              "value": "Success"
                            },
                            "runAfter": {
                              "Append_to_string_variable_comment_if_no_device_exist": [
                                "Succeeded"
                              ]
                            },
                            "description": "This sets the variable success in case of no device info found"
                          }
                        }
                      },
                      "description": "This checks if device is present in crowdstrike or not"
                    },
                    "CrowdStrike_Base": {
                      "type": "Workflow",
                      "inputs": {
                        "host": {
                          "triggerName": "manual",
                          "workflow": {
                            "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name ,'/providers/Microsoft.Logic/workflows/', parameters('CrowdStrike_Base_Playbook_Name'))]"
                          }
                        }
                      },
                      "runAfter": {
                        "Initialize_variable_success_from_crowdstrike": [
                          "Succeeded"
                        ]
                      },
                      "description": "Call the base logic App to get access token and Falcon Host URL",
                      "runtimeConfiguration": {
                        "secureData": {
                          "properties": [
                            "inputs",
                            "outputs"
                          ]
                        }
                      }
                    },
                    "Entities_-_Get_Hosts": {
                      "type": "ApiConnection",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "method": "post",
                        "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                        "path": "/entities/host"
                      }
                    },
                    "HTTP_-_Get_device_id": {
                      "type": "Http",
                      "inputs": {
                        "method": "GET",
                        "uri": "@{body('CrowdStrike_Base')?['FalconHost']}/devices/queries/devices/v1?filter=hostname:'@{body('Entities_-_Get_Hosts')?['Hosts']?[0]?['HostName']}'",
                        "headers": {
                          "Accept": "application/json",
                          "Authorization": "@{body('CrowdStrike_Base')?['AccessToken']}",
                          "Content-Type": "application/json"
                        }
                      },
                      "runAfter": {
                        "CrowdStrike_Base": [
                          "Succeeded"
                        ]
                      },
                      "description": "This gets the device id from crowdstrike by filtering on hostname"
                    },
                    "Initialize_variable_comment": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Comment",
                            "type": "string"
                          }
                        ]
                      },
                      "runAfter": {
                        "Entities_-_Get_Hosts": [
                          "Succeeded"
                        ]
                      },
                      "description": "This is used to store comments to update in the incident"
                    },
                    "Initialize_variable_success_from_crowdstrike": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Successfromcrowdstike",
                            "type": "string"
                          }
                        ]
                      },
                      "runAfter": {
                        "Initialize_variable_comment": [
                          "Succeeded"
                        ]
                      },
                      "description": "This is used to hold the success or failure information from crowdstrike api actions"
                    },
                    "Parse_JSON_Get_device_id_response": {
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('HTTP_-_Get_device_id')",
                        "schema": {
                          "errors": "[variables('TemplateEmptyArray')]",
                          "meta": {
                            "pagination": {
                              "limit": 100,
                              "offset": 1,
                              "total": 1
                            },
                            "powered_by": "device-api",
                            "query_time": 0.005041315,
                            "trace_id": "aa7b84f5-3e81-4980-ad9f-c14b6d8ca577"
                          },
                          "resources": [
                            "cdc977a72a8c49528bb82f89dde2c2e9"
                          ]
                        }
                      },
                      "runAfter": {
                        "HTTP_-_Get_device_id": [
                          "Succeeded"
                        ]
                      },
                      "description": "prepare json message for the device id response"
                    }
                  },
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    }
                  },
                  "triggers": {
                    "When_Azure_Sentinel_incident_creation_rule_was_triggered_(Private_Preview_only)": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                          }
                        },
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "contentVersion": "1.0.0.0"
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "azuresentinel": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                        "connectionName": "[[variables('AzureSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      }
                    }
                  }
                }
              },
              "type": "Microsoft.Logic/workflows",
              "apiVersion": "2017-07-01",
              "name": "[[parameters('PlaybookName')]",
              "location": "[[variables('workspace-location-inline')]",
              "identity": {
                "type": "SystemAssigned"
              },
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]"
              ],
              "tags": {
                "hidden-SentinelTemplateName": "IsolateEndpoint-Crowdstrike",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('AzureSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('AzureSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId3'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId3')]",
                "contentId": "[variables('_playbookContentId3')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion3')]",
                "source": {
                  "kind": "Solution",
                  "name": "CrowdStrike Falcon Endpoint Protection",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Microsoft",
                  "email": "[variables('_email')]"
                },
                "support": {
                  "name": "Microsoft Corporation",
                  "email": "support@microsoft.com",
                  "tier": "Microsoft",
                  "link": "https://support.microsoft.com"
                }
              }
            }
          ],
          "metadata": {
            "title": "Isolate endpoint - Crowdstrike",
            "description": "When a new Microsoft Sentinel incident is created, this playbook gets triggered and performs below actions:",
            "mainSteps": [
              "1. Fetches the device information from Crowdstrike",
              "2. Contain host if it is not already contained",
              "3. Enrich the incident with device information from Crowdstrike \n",
              "![Comment example](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CrowdStrike%20Falcon%20Endpoint%20Protection/Playbooks/CrowdStrike_ContainHost/images/Incident_Comment.png?raw=true) \n",
              "4. Close the incident if contained the host"
            ],
            "prerequisites": [
              "1. Azure Key vault is required for storing the Crowdstrike ClientID and Secrets, create key vault if not exists [learn how](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2Fazure-quickstart-templates%2Fmaster%2Fquickstarts%2Fmicrosoft.keyvault%2Fkey-vault-secret-create%2Fazuredeploy.json)",
              "2. Add Crowdstrike Client ID and Client Secret in Key vault secrets and capture the keys which are required during the template deployment",
              "3. CrowdStrike_Base playbook needs to be deployed prior to the deployment of this playbook under the same subscription and under the same resource group.",
              "4. CrowdStrike_Base playbook needs to be added in the access policy of the Key Vault [learn how](https://docs.microsoft.com/azure/key-vault/general/assign-access-policy-portal)"
            ],
            "lastUpdateTime": "2022-07-25T00:00:00Z",
            "entities": [
              "Host"
            ],
            "tags": [
              "Remediation"
            ],
            "source": {
              "type": "solution",
              "name": "CrowdStrike Falcon Endpoint Protection"
            },
            "postDeployment": [
              "** a. Authorize connections **",
              "Once deployment is complete, you will need to authorize each connection.",
              "1. Click the Microsoft Sentinel connection resource",
              "2. Click edit API connection",
              "3. Click Authorize",
              "4. Sign in",
              "5. Click Save",
              "** b. Configurations in Sentinel **",
              "1. In Microsoft sentinel analytical rules should be configured to trigger an incident with risky device",
              "2. Configure the automation rules to trigger this playbook"
            ],
            "releaseNotes": [
              {
                "version": "1.0.0",
                "title": "Isolate endpoint - Crowdstrike",
                "notes": [
                  "Initial version"
                ]
              }
            ]
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId3')]",
        "contentKind": "Playbook",
        "displayName": "Crowdstrike-ContainHost",
        "contentProductId": "[variables('_playbookcontentProductId3')]",
        "id": "[variables('_playbookcontentProductId3')]",
        "version": "[variables('playbookVersion3')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.1.8",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "CrowdStrike Falcon Endpoint Protection",
        "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/CrowdStrike%20Falcon%20Endpoint%20Protection/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The <a href=\"https://www.crowdstrike.com/products/\">CrowdStrike Falcon Endpoint Protection</a> solution allows you to easily onboard CrowdStrike Falcon Endpoint Protection to Microsoft Sentinel. The data collected can be used to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organization's endpoints and improves your security operation capabilities.</p>\n<p>This solution contains multiple Data Connectors that help ingest Falcon Data Replicator logs, Adversary Intelligence &amp; other more specific data from CrowdStrike. Carefully review the capabilities of each connector and configure/enable the most relevant connector based on specific requirements.</p>\n<p><strong>Data Connectors:</strong> 4, <strong>Parsers:</strong> 3, <strong>Workbooks:</strong> 1, <strong>Analytic Rules:</strong> 2, <strong>Playbooks:</strong> 3</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/CrowdStrike%20Falcon%20Endpoint%20Protection/Data%20Connectors/Logo/crowdstrike.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "CrowdStrike Falcon Endpoint Protection",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Microsoft",
          "email": "[variables('_email')]"
        },
        "support": {
          "name": "Microsoft Corporation",
          "email": "support@microsoft.com",
          "tier": "Microsoft",
          "link": "https://support.microsoft.com"
        },
        "dependencies": {
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId2')]",
              "version": "[variables('dataConnectorVersion2')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections3')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections4')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject1').parserContentId1]",
              "version": "[variables('parserObject1').parserVersion1]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject2').parserContentId2]",
              "version": "[variables('parserObject2').parserVersion2]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject3').parserContentId3]",
              "version": "[variables('parserObject3').parserVersion3]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject2')._analyticRulecontentId2]",
              "version": "[variables('analyticRuleObject2').analyticRuleVersion2]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CrowdStrike_Base')]",
              "version": "[variables('playbookVersion1')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CrowdStrike_Enrichment_GetDeviceInformation')]",
              "version": "[variables('playbookVersion2')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_CrowdStrike_ContainHost')]",
              "version": "[variables('playbookVersion3')]"
            },
            {
              "kind": "Solution",
              "contentId": "azuresentinel.azure-sentinel-solution-commoneventformat"
            }
          ]
        },
        "firstPublishDate": "2022-06-01",
        "providers": [
          "Crowdstrike"
        ],
        "categories": {
          "domains": [
            "Security - Threat Protection",
            "Security - Automation (SOAR)"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
