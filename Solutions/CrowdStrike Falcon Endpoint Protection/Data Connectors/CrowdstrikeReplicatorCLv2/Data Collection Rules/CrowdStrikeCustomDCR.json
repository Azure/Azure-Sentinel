{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "dataCollectionRules_CrowdStrikeCustomDCR_name": {
      "defaultValue": "CrowdStrikeRawDataDCR",
      "type": "String"
    },
    "dataCollectionEndpoints_externalid": {
      "defaultValue": "",
      "type": "String"
    },
    "workspaces_externalid": {
      "defaultValue": "",
      "type": "String"
    }
  },
  "variables": {},
  "resources": [
    {
      "type": "Microsoft.Insights/dataCollectionRules",
      "apiVersion": "2022-06-01",
      "name": "[parameters('dataCollectionRules_CrowdStrikeCustomDCR_name')]",
      "location": "westus",
      "properties": {
        "dataCollectionEndpointId": "[parameters('dataCollectionEndpoints_externalid')]",
        "streamDeclarations": {
          "Custom-CrowdstrikeDns": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "DomainName",
                "type": "string"
              },
              {
                "name": "RequestType",
                "type": "string"
              },
              {
                "name": "IP4Records",
                "type": "string"
              },
              {
                "name": "QueryStatus",
                "type": "string"
              },
              {
                "name": "FirstIP4Record",
                "type": "string"
              },
              {
                "name": "DnsRequestCount",
                "type": "string"
              },
              {
                "name": "IP6Records",
                "type": "string"
              },
              {
                "name": "InterfaceIndex",
                "type": "string"
              },
              {
                "name": "DualRequest",
                "type": "string"
              },
              {
                "name": "DnsResponseType",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "RespondingDnsServer",
                "type": "string"
              },
              {
                "name": "CNAMERecords",
                "type": "string"
              },
              {
                "name": "FirstIP6Record",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeAuth": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "LogonType",
                "type": "string"
              },
              {
                "name": "LogonTime",
                "type": "string"
              },
              {
                "name": "UserIsAdmin",
                "type": "string"
              },
              {
                "name": "LogonDomain",
                "type": "string"
              },
              {
                "name": "RemoteAccount",
                "type": "string"
              },
              {
                "name": "ClientComputerName",
                "type": "string"
              },
              {
                "name": "UserPrincipal",
                "type": "string"
              },
              {
                "name": "RawProcessId",
                "type": "string"
              },
              {
                "name": "UserSid",
                "type": "string"
              },
              {
                "name": "LogonServer",
                "type": "string"
              },
              {
                "name": "AuthenticationPackage",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "UserLogonFlags",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP6",
                "type": "string"
              },
              {
                "name": "UserLogoffType",
                "type": "string"
              },
              {
                "name": "LogoffTime",
                "type": "string"
              },
              {
                "name": "SessionId",
                "type": "string"
              },
              {
                "name": "UserFlags",
                "type": "string"
              },
              {
                "name": "PrivilegesBitmask",
                "type": "string"
              },
              {
                "name": "PasswordLastSet",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "TargetProcessId",
                "type": "string"
              },
              {
                "name": "Status",
                "type": "string"
              },
              {
                "name": "EtwRawProcessId",
                "type": "string"
              },
              {
                "name": "EtwRawThreadId",
                "type": "string"
              },
              {
                "name": "SubStatus",
                "type": "string"
              },
              {
                "name": "LocalSession",
                "type": "string"
              },
              {
                "name": "EnabledPrivilegesBitmask",
                "type": "string"
              },
              {
                "name": "UserGroupsBitmask",
                "type": "string"
              },
              {
                "name": "LinkedAuthenticationId",
                "type": "string"
              },
              {
                "name": "UserCanonical",
                "type": "string"
              },
              {
                "name": "LoginSessionId",
                "type": "string"
              },
              {
                "name": "AuthenticationUuidAsString",
                "type": "string"
              },
              {
                "name": "UID",
                "type": "string"
              },
              {
                "name": "AuthenticationUuid",
                "type": "string"
              },
              {
                "name": "AuthenticationIdMac",
                "type": "string"
              },
              {
                "name": "ResendToCloud",
                "type": "string"
              },
              {
                "name": "LogonId",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeFile": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "TargetFileName",
                "type": "string"
              },
              {
                "name": "FileOperatorSid",
                "type": "string"
              },
              {
                "name": "Size",
                "type": "string"
              },
              {
                "name": "FileWrittenFlags",
                "type": "string"
              },
              {
                "name": "OperationFlags",
                "type": "string"
              },
              {
                "name": "SHA256HashData",
                "type": "string"
              },
              {
                "name": "SourceFileName",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "OriginalFilename",
                "type": "string"
              },
              {
                "name": "ClientId",
                "type": "string"
              },
              {
                "name": "TargetDirectoryName",
                "type": "string"
              },
              {
                "name": "UID",
                "type": "string"
              },
              {
                "name": "Status",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "IsOnRemovableDisk",
                "type": "string"
              },
              {
                "name": "MinorFunction",
                "type": "string"
              },
              {
                "name": "IsOnNetwork",
                "type": "string"
              },
              {
                "name": "FileIdentifier",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "DiskParentDeviceInstanceId",
                "type": "string"
              },
              {
                "name": "FileObject",
                "type": "string"
              },
              {
                "name": "IrpFlags",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "FileEcpBitmask",
                "type": "string"
              },
              {
                "name": "MajorFunction",
                "type": "string"
              },
              {
                "name": "TemporaryFileName",
                "type": "string"
              },
              {
                "name": "VolumeSessionUUID",
                "type": "string"
              },
              {
                "name": "PatternId",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "MSOfficeSubType",
                "type": "string"
              },
              {
                "name": "GID",
                "type": "string"
              },
              {
                "name": "UnixMode",
                "type": "string"
              },
              {
                "name": "USN",
                "type": "string"
              },
              {
                "name": "FileCategory",
                "type": "string"
              },
              {
                "name": "ShareAccess",
                "type": "string"
              },
              {
                "name": "DesiredAccess",
                "type": "string"
              },
              {
                "name": "ELFSubType",
                "type": "string"
              },
              {
                "name": "IsTransactedFile",
                "type": "string"
              },
              {
                "name": "MachOSubType",
                "type": "string"
              },
              {
                "name": "VnodeModificationType",
                "type": "string"
              },
              {
                "name": "NewFileIdentifier",
                "type": "string"
              },
              {
                "name": "Options",
                "type": "string"
              },
              {
                "name": "Information",
                "type": "string"
              },
              {
                "name": "FileAttributes",
                "type": "string"
              },
              {
                "name": "Tags",
                "type": "string"
              },
              {
                "name": "FixedFileVersion",
                "type": "string"
              },
              {
                "name": "HandleCreateAuthenticationId",
                "type": "string"
              },
              {
                "name": "VnodeType",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeNetwork": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "ConnectionDirection",
                "type": "string"
              },
              {
                "name": "RemotePort",
                "type": "string"
              },
              {
                "name": "LocalAddressIP6",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP6",
                "type": "string"
              },
              {
                "name": "LocalPort",
                "type": "string"
              },
              {
                "name": "Protocol",
                "type": "string"
              },
              {
                "name": "RemoteAddressString",
                "type": "string"
              },
              {
                "name": "FirewallAction",
                "type": "string"
              },
              {
                "name": "NegateLocalAddress",
                "type": "string"
              },
              {
                "name": "RemoteAddressMaskIP6",
                "type": "string"
              },
              {
                "name": "LocalAddressMaskIP6",
                "type": "string"
              },
              {
                "name": "NegateRemoteAddress",
                "type": "string"
              },
              {
                "name": "IcmpCode",
                "type": "string"
              },
              {
                "name": "IcmpType",
                "type": "string"
              },
              {
                "name": "LocalAddressIP4",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "RemoteAddressMaskIP4",
                "type": "string"
              },
              {
                "name": "LocalAddressMaskIP4",
                "type": "string"
              },
              {
                "name": "PhysicalAddress",
                "type": "string"
              },
              {
                "name": "ConnectionFlags",
                "type": "string"
              },
              {
                "name": "InContext",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "InterfaceIndex",
                "type": "string"
              },
              {
                "name": "NetLuidIndex",
                "type": "string"
              },
              {
                "name": "NeighborList",
                "type": "string"
              },
              {
                "name": "TcpConnectErrorCode",
                "type": "string"
              },
              {
                "name": "InterfaceAlias",
                "type": "string"
              },
              {
                "name": "NegateInterface",
                "type": "string"
              },
              {
                "name": "IsUnique",
                "type": "string"
              },
              {
                "name": "LocalPortRangeStart",
                "type": "string"
              },
              {
                "name": "LocalPortRangeOperation",
                "type": "string"
              },
              {
                "name": "RemotePortRangeOperation",
                "type": "string"
              },
              {
                "name": "RemotePortRangeStart",
                "type": "string"
              },
              {
                "name": "HbfwRuleId",
                "type": "string"
              },
              {
                "name": "NetworkProfile",
                "type": "string"
              },
              {
                "name": "PolicyIdentifier",
                "type": "string"
              },
              {
                "name": "HbfwRuleFlags",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "RuleAction",
                "type": "string"
              },
              {
                "name": "RuleMatchCount",
                "type": "string"
              },
              {
                "name": "RuleMatchCountSinceLastReport",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeProcess": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "UserSid",
                "type": "string"
              },
              {
                "name": "ParentBaseFileName",
                "type": "string"
              },
              {
                "name": "SHA256HashData",
                "type": "string"
              },
              {
                "name": "MD5HashData",
                "type": "string"
              },
              {
                "name": "SHA1HashData",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "InjecteeImageFileName",
                "type": "string"
              },
              {
                "name": "InjectorImageFileName",
                "type": "string"
              },
              {
                "name": "IntegrityLevel",
                "type": "string"
              },
              {
                "name": "ParentProcessId",
                "type": "string"
              },
              {
                "name": "TargetProcessId",
                "type": "string"
              },
              {
                "name": "ConHostProcessId",
                "type": "string"
              },
              {
                "name": "WritingProcessId",
                "type": "string"
              },
              {
                "name": "SourceProcessId",
                "type": "string"
              },
              {
                "name": "TargetFileName",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "WritingProcessImageFileName",
                "type": "string"
              },
              {
                "name": "WritingProcessCommandLine",
                "type": "string"
              },
              {
                "name": "OriginalFilename",
                "type": "string"
              },
              {
                "name": "ProcessStartTime",
                "type": "string"
              },
              {
                "name": "ProcessEndTime",
                "type": "string"
              },
              {
                "name": "ModuleName",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "RpcClientProcessId",
                "type": "string"
              },
              {
                "name": "ParentCommandLine",
                "type": "string"
              },
              {
                "name": "TemplateInstanceId",
                "type": "string"
              },
              {
                "name": "ParentImageFileName",
                "type": "string"
              },
              {
                "name": "PatternId",
                "type": "string"
              },
              {
                "name": "Tags",
                "type": "string"
              },
              {
                "name": "ProcessGroupId",
                "type": "string"
              },
              {
                "name": "RawProcessId",
                "type": "string"
              },
              {
                "name": "SyntheticPR2Flags",
                "type": "string"
              },
              {
                "name": "ImageSubsystem",
                "type": "string"
              },
              {
                "name": "SourceThreadId",
                "type": "string"
              },
              {
                "name": "AuthenticodeHashData",
                "type": "string"
              },
              {
                "name": "SessionId",
                "type": "string"
              },
              {
                "name": "ParentAuthenticationId",
                "type": "string"
              },
              {
                "name": "SignInfoFlags",
                "type": "string"
              },
              {
                "name": "CallStackModuleNamesVersion",
                "type": "string"
              },
              {
                "name": "CsaProcessDataCollectionInstanceId",
                "type": "string"
              },
              {
                "name": "CallStackModuleNames",
                "type": "string"
              },
              {
                "name": "CreateProcessType",
                "type": "string"
              },
              {
                "name": "ZoneIdentifier",
                "type": "string"
              },
              {
                "name": "HostUrl",
                "type": "string"
              },
              {
                "name": "TargetThreadId",
                "type": "string"
              },
              {
                "name": "SignatureErrorState",
                "type": "string"
              },
              {
                "name": "ModuleCharacteristics",
                "type": "string"
              },
              {
                "name": "PublicKeys",
                "type": "string"
              },
              {
                "name": "ExtendedKeyUsages",
                "type": "string"
              },
              {
                "name": "SignatureState",
                "type": "string"
              },
              {
                "name": "MappedFromUserMode",
                "type": "string"
              },
              {
                "name": "FileSigningTime",
                "type": "string"
              },
              {
                "name": "Certificate",
                "type": "string"
              },
              {
                "name": "FileIdentifier",
                "type": "string"
              },
              {
                "name": "ExecutableBytes",
                "type": "string"
              },
              {
                "name": "LoadingProcessOriginalFilename",
                "type": "string"
              },
              {
                "name": "ModuleTagsAsString",
                "type": "string"
              },
              {
                "name": "ImageDirectoryClassification",
                "type": "string"
              },
              {
                "name": "ParentProcessPatternIdList",
                "type": "string"
              },
              {
                "name": "ModuleLoadMechanism",
                "type": "string"
              },
              {
                "name": "PatternIdList",
                "type": "string"
              },
              {
                "name": "ScreenshotsTakenCount",
                "type": "string"
              },
              {
                "name": "ExitCode",
                "type": "string"
              },
              {
                "name": "NetworkListenCount",
                "type": "string"
              },
              {
                "name": "SuspiciousRawDiskReadCount",
                "type": "string"
              },
              {
                "name": "NetworkBindCount",
                "type": "string"
              },
              {
                "name": "NetworkRecvAcceptCount",
                "type": "string"
              },
              {
                "name": "ContextData",
                "type": "string"
              },
              {
                "name": "NewExecutableWrittenCount",
                "type": "string"
              },
              {
                "name": "ExeAndServiceCount",
                "type": "string"
              },
              {
                "name": "NetworkCloseCount",
                "type": "string"
              },
              {
                "name": "SuspectStackCount",
                "type": "string"
              },
              {
                "name": "CLICreationCount",
                "type": "string"
              },
              {
                "name": "UnsignedModuleLoadCount",
                "type": "string"
              },
              {
                "name": "UserTime",
                "type": "string"
              },
              {
                "name": "AllocateVirtualMemoryCount",
                "type": "string"
              },
              {
                "name": "ServiceEventCount",
                "type": "string"
              },
              {
                "name": "SnapshotFileOpenCount",
                "type": "string"
              },
              {
                "name": "RemovableDiskFileWrittenCount",
                "type": "string"
              },
              {
                "name": "InjectedDllCount",
                "type": "string"
              },
              {
                "name": "ModuleLoadCount",
                "type": "string"
              },
              {
                "name": "UserMemoryProtectExecutableCount",
                "type": "string"
              },
              {
                "name": "NetworkCapableAsepWriteCount",
                "type": "string"
              },
              {
                "name": "DnsRequestCount",
                "type": "string"
              },
              {
                "name": "ArchiveFileWrittenCount",
                "type": "string"
              },
              {
                "name": "SetThreadContextCount",
                "type": "string"
              },
              {
                "name": "SuspiciousCredentialModuleLoadCount",
                "type": "string"
              },
              {
                "name": "FileDeletedCount",
                "type": "string"
              },
              {
                "name": "UserMemoryAllocateExecutableCount",
                "type": "string"
              },
              {
                "name": "DirectoryCreatedCount",
                "type": "string"
              },
              {
                "name": "NetworkConnectCountUdp",
                "type": "string"
              },
              {
                "name": "QueueApcCount",
                "type": "string"
              },
              {
                "name": "SuspiciousFontLoadCount",
                "type": "string"
              },
              {
                "name": "ConHostId",
                "type": "string"
              },
              {
                "name": "NetworkConnectCount",
                "type": "string"
              },
              {
                "name": "BinaryExecutableWrittenCount",
                "type": "string"
              },
              {
                "name": "CycleTime",
                "type": "string"
              },
              {
                "name": "PrivilegedProcessHandleCount",
                "type": "string"
              },
              {
                "name": "MaxThreadCount",
                "type": "string"
              },
              {
                "name": "GenericFileWrittenCount",
                "type": "string"
              },
              {
                "name": "ScriptEngineInvocationCount",
                "type": "string"
              },
              {
                "name": "RunDllInvocationCount",
                "type": "string"
              },
              {
                "name": "CreateProcessCount",
                "type": "string"
              },
              {
                "name": "KernelTime",
                "type": "string"
              },
              {
                "name": "DirectoryEnumeratedCount",
                "type": "string"
              },
              {
                "name": "AsepWrittenCount",
                "type": "string"
              },
              {
                "name": "SuspiciousDnsRequestCount",
                "type": "string"
              },
              {
                "name": "DocumentFileWrittenCount",
                "type": "string"
              },
              {
                "name": "ProtectVirtualMemoryCount",
                "type": "string"
              },
              {
                "name": "UserMemoryProtectExecutableRemoteCount",
                "type": "string"
              },
              {
                "name": "UserMemoryAllocateExecutableRemoteCount",
                "type": "string"
              },
              {
                "name": "ExecutableDeletedCount",
                "type": "string"
              },
              {
                "name": "RegKeySecurityDecreasedCount",
                "type": "string"
              },
              {
                "name": "InjectedThreadCount",
                "type": "string"
              },
              {
                "name": "NetworkModuleLoadCount",
                "type": "string"
              },
              {
                "name": "ThreadStartAddress",
                "type": "string"
              },
              {
                "name": "ThreadExecutionControlType",
                "type": "string"
              },
              {
                "name": "PayloadClassification",
                "type": "string"
              },
              {
                "name": "PayloadClassificationFlags",
                "type": "string"
              },
              {
                "name": "MemoryDescriptionFlags",
                "type": "string"
              },
              {
                "name": "WellKnownTargetFunction",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeRegistry": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "RegObjectName",
                "type": "string"
              },
              {
                "name": "RegValueName",
                "type": "string"
              },
              {
                "name": "RegClassificationFlags",
                "type": "string"
              },
              {
                "name": "RegOperationType",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "RegStringValue",
                "type": "string"
              },
              {
                "name": "RegType",
                "type": "string"
              },
              {
                "name": "RegClassificationIndex",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "RegNumericValue",
                "type": "string"
              },
              {
                "name": "RegBinaryValue",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeAudit": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "VolumeSnapshotName",
                "type": "string"
              },
              {
                "name": "SmbShareName",
                "type": "string"
              },
              {
                "name": "ShareName",
                "type": "string"
              },
              {
                "name": "UploadId",
                "type": "string"
              },
              {
                "name": "SessionId",
                "type": "string"
              },
              {
                "name": "ComputerName",
                "type": "string"
              },
              {
                "name": "FirewallRule",
                "type": "string"
              },
              {
                "name": "FirewallRuleId",
                "type": "string"
              },
              {
                "name": "FirewallOption",
                "type": "string"
              },
              {
                "name": "SourceFileName",
                "type": "string"
              },
              {
                "name": "TargetFileName",
                "type": "string"
              },
              {
                "name": "DeviceVendorId",
                "type": "string"
              },
              {
                "name": "DeviceProductId",
                "type": "string"
              },
              {
                "name": "DeviceSerialNumber",
                "type": "string"
              },
              {
                "name": "BluetoothDeviceAddress",
                "type": "string"
              },
              {
                "name": "EnvironmentVariableName",
                "type": "string"
              },
              {
                "name": "SamAccountName",
                "type": "string"
              },
              {
                "name": "FirewallOptionNumericValue",
                "type": "string"
              },
              {
                "name": "FirewallOptionStringValue",
                "type": "string"
              },
              {
                "name": "FileVaultIsEnabled",
                "type": "string"
              },
              {
                "name": "EnvironmentVariableValue",
                "type": "string"
              },
              {
                "name": "ConfigStateData",
                "type": "string"
              },
              {
                "name": "ActiveDirectoryOuDn",
                "type": "string"
              },
              {
                "name": "ActiveDirectoryDepartment",
                "type": "string"
              },
              {
                "name": "SHA256HashData",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "VolumeName",
                "type": "string"
              },
              {
                "name": "VolumeDriveLetter",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "InterfaceGuid",
                "type": "string"
              },
              {
                "name": "RpcClientProcessId",
                "type": "string"
              },
              {
                "name": "InterfaceVersion",
                "type": "string"
              },
              {
                "name": "RpcClientThreadId",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "RpcOpNum",
                "type": "string"
              },
              {
                "name": "RpcNestingLevel",
                "type": "string"
              },
              {
                "name": "ClientComputerName",
                "type": "string"
              },
              {
                "name": "DomainName",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP6",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "SmbClientName",
                "type": "string"
              },
              {
                "name": "AgentLoadFlags",
                "type": "string"
              },
              {
                "name": "ProvisioningDuration",
                "type": "string"
              },
              {
                "name": "Status",
                "type": "string"
              },
              {
                "name": "ErrorText",
                "type": "string"
              },
              {
                "name": "CloudErrorCode",
                "type": "string"
              },
              {
                "name": "SharePath",
                "type": "string"
              },
              {
                "name": "ShareMaxCount",
                "type": "string"
              },
              {
                "name": "ShareRemark",
                "type": "string"
              },
              {
                "name": "ShareData",
                "type": "string"
              },
              {
                "name": "IntelTDTEnabled",
                "type": "string"
              },
              {
                "name": "FalconServiceState",
                "type": "string"
              },
              {
                "name": "LfoUploadFlags",
                "type": "string"
              },
              {
                "name": "AttemptNumber",
                "type": "string"
              },
              {
                "name": "Size",
                "type": "string"
              },
              {
                "name": "Tags",
                "type": "string"
              },
              {
                "name": "CloudRequestId",
                "type": "string"
              },
              {
                "name": "LocalSession",
                "type": "string"
              },
              {
                "name": "IOServiceClass",
                "type": "string"
              },
              {
                "name": "IOServicePath",
                "type": "string"
              },
              {
                "name": "IOServiceProperties",
                "type": "string"
              },
              {
                "name": "IOServiceName",
                "type": "string"
              },
              {
                "name": "Protocol",
                "type": "string"
              },
              {
                "name": "ChannelDiffStatusList",
                "type": "string"
              },
              {
                "name": "AccountDomain",
                "type": "string"
              },
              {
                "name": "AccountObjectGuid",
                "type": "string"
              },
              {
                "name": "AccountObjectSid",
                "type": "string"
              },
              {
                "name": "TotalCount",
                "type": "string"
              },
              {
                "name": "ErrorCode",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "AddressFamily",
                "type": "string"
              },
              {
                "name": "BluetoothDeviceType",
                "type": "string"
              },
              {
                "name": "DeviceTimeStamp",
                "type": "string"
              },
              {
                "name": "DeviceInstanceId",
                "type": "string"
              },
              {
                "name": "BluetoothDeviceAddressType",
                "type": "string"
              },
              {
                "name": "DeviceVersion",
                "type": "string"
              },
              {
                "name": "DeviceDescriptorSetHash",
                "type": "string"
              },
              {
                "name": "DeviceManufacturer",
                "type": "string"
              },
              {
                "name": "DeviceProduct",
                "type": "string"
              },
              {
                "name": "DeviceUserSid",
                "type": "string"
              },
              {
                "name": "DeviceUserAuthenticationId",
                "type": "string"
              },
              {
                "name": "FirewallProfile",
                "type": "string"
              },
              {
                "name": "ShareAccess",
                "type": "string"
              },
              {
                "name": "DesiredAccess",
                "type": "string"
              },
              {
                "name": "GID",
                "type": "string"
              },
              {
                "name": "UID",
                "type": "string"
              },
              {
                "name": "UnixMode",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          },
          "Custom-CrowdstrikeUser": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "string"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "string"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "string"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "UserRid",
                "type": "string"
              },
              {
                "name": "GroupRid",
                "type": "string"
              },
              {
                "name": "InterfaceVersion",
                "type": "string"
              },
              {
                "name": "RpcClientThreadId",
                "type": "string"
              },
              {
                "name": "RpcOpNum",
                "type": "string"
              },
              {
                "name": "InterfaceGuid",
                "type": "string"
              },
              {
                "name": "RpcClientProcessId",
                "type": "string"
              },
              {
                "name": "RpcNestingLevel",
                "type": "string"
              },
              {
                "name": "DomainSid",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "string"
              }
            ]
          }
        },
        "destinations": {
          "logAnalytics": [
            {
              "workspaceResourceId": "[parameters('workspaces_externalid')]",
              "name": "myworkspace"
            }
          ]
        },
        "dataFlows": [
          {
            "streams": [ "Custom-CrowdstrikeNetwork" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),        \r\n        BoundingLimitCount = tolong(BoundingLimitCount),        \r\n        RemotePort = tolong(RemotePort),\r\n        LocalPort = tolong(LocalPort),\r\n        InterfaceIndex = tolong(InterfaceIndex),\r\n        NetLuidIndex = tolong(NetLuidIndex),\r\n        RuleMatchCount = tolong(RuleMatchCount),\r\n        RuleMatchCountSinceLastReport = tolong(RuleMatchCountSinceLastReport),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_Network_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeDns" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n    CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        DnsRequestCount = tolong(DnsRequestCount),\r\n        InterfaceIndex = tolong(InterfaceIndex),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_DNS_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeFile" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        Size = tolong(Size),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_File_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeAuth" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        LogonTime = todouble(LogonTime),\r\n        LogoffTime = todouble(LogoffTime),\r\n        EtwRawThreadId = tolong(EtwRawThreadId),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_Auth_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeProcess" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),        \r\n        BoundingLimitCount = tolong(BoundingLimitCount),        \r\n        ProcessStartTime = todouble(ProcessStartTime),        \r\n        ProcessEndTime = todouble(ProcessEndTime),\r\n        FileSigningTime = todouble(FileSigningTime),\r\n        ScreenshotsTakenCount = tolong(ScreenshotsTakenCount),\r\n        NetworkListenCount = tolong(NetworkListenCount),\r\n        SuspiciousRawDiskReadCount = tolong(SuspiciousRawDiskReadCount),\r\n        NetworkBindCount = tolong(NetworkBindCount),\r\n        NetworkRecvAcceptCount = tolong(NetworkRecvAcceptCount),\r\n        NewExecutableWrittenCount = tolong(NewExecutableWrittenCount),\r\n        ExeAndServiceCount = tolong(ExeAndServiceCount),\r\n        NetworkCloseCount = tolong(NetworkCloseCount),\r\n        SuspectStackCount = tolong(SuspectStackCount),\r\n        CLICreationCount = tolong(CLICreationCount),\r\n        UnsignedModuleLoadCount = tolong(UnsignedModuleLoadCount),\r\n        UserTime = tolong(UserTime),\r\n        AllocateVirtualMemoryCount = tolong(AllocateVirtualMemoryCount),\r\n        ServiceEventCount = tolong(ServiceEventCount),\r\n        SnapshotFileOpenCount = tolong(SnapshotFileOpenCount),\r\n        RemovableDiskFileWrittenCount = tolong(RemovableDiskFileWrittenCount),\r\n        InjectedDllCount = tolong(InjectedDllCount),        \r\n        ModuleLoadCount = tolong(ModuleLoadCount),\r\n        UserMemoryProtectExecutableCount = tolong(UserMemoryProtectExecutableCount),\r\n        NetworkCapableAsepWriteCount = tolong(NetworkCapableAsepWriteCount),\r\n        DnsRequestCount = tolong(DnsRequestCount),\r\n        ArchiveFileWrittenCount = tolong(ArchiveFileWrittenCount),\r\n        SetThreadContextCount = tolong(SetThreadContextCount),        \r\n        SuspiciousCredentialModuleLoadCount = tolong(SuspiciousCredentialModuleLoadCount),\r\n        FileDeletedCount = tolong(FileDeletedCount),\r\n        UserMemoryAllocateExecutableCount = tolong(UserMemoryAllocateExecutableCount),\r\n        DirectoryCreatedCount = tolong(DirectoryCreatedCount),\r\n        NetworkConnectCountUdp = tolong(NetworkConnectCountUdp),\r\n        QueueApcCount = tolong(QueueApcCount),\r\n        SuspiciousFontLoadCount = tolong(SuspiciousFontLoadCount),        \r\n        NetworkConnectCount = tolong(NetworkConnectCount),\r\n        BinaryExecutableWrittenCount = tolong(BinaryExecutableWrittenCount),\r\n        CycleTime = tolong(CycleTime),\r\n        PrivilegedProcessHandleCount = tolong(PrivilegedProcessHandleCount),\r\n        MaxThreadCount = tolong(MaxThreadCount),\r\n        GenericFileWrittenCount = tolong(GenericFileWrittenCount),\r\n        ScriptEngineInvocationCount = tolong(ScriptEngineInvocationCount),\r\n        RunDllInvocationCount = tolong(RunDllInvocationCount),\r\n        CreateProcessCount = tolong(CreateProcessCount),        \r\n        KernelTime = tolong(KernelTime),\r\n        DirectoryEnumeratedCount = tolong(DirectoryEnumeratedCount),\r\n        AsepWrittenCount = tolong(AsepWrittenCount),\r\n        SuspiciousDnsRequestCount = tolong(SuspiciousDnsRequestCount),\r\n        DocumentFileWrittenCount = tolong(DocumentFileWrittenCount),\r\n        ProtectVirtualMemoryCount = tolong(ProtectVirtualMemoryCount),\r\n        UserMemoryProtectExecutableRemoteCount = tolong(UserMemoryProtectExecutableRemoteCount),\r\n        UserMemoryAllocateExecutableRemoteCount = tolong(UserMemoryAllocateExecutableRemoteCount),\r\n        ExecutableDeletedCount = tolong(ExecutableDeletedCount),        \r\n        InjectedThreadCount = tolong(InjectedThreadCount),\r\n        RegKeySecurityDecreasedCount = tolong(RegKeySecurityDecreasedCount),\r\n        NetworkModuleLoadCount = tolong(NetworkModuleLoadCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_Process_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeRegistry" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        RegNumericValue = toint(RegNumericValue),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_Registry_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeAudit" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        FileVaultIsEnabled = tobool(FileVaultIsEnabled),\r\n        ShareMaxCount = tolong(ShareMaxCount),\r\n        AttemptNumber = tolong(AttemptNumber),\r\n        TotalCount = tolong(TotalCount),\r\n        DeviceTimeStamp = todouble(DeviceTimeStamp),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_Audit_Events_CL"
          },
          {
            "streams": [ "Custom-CrowdstrikeUser" ],
            "destinations": [ "myworkspace" ],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
            "outputStream": "Custom-CrowdStrike_User_Events_CL"
          }
        ]
      }
    }
  ]
}
