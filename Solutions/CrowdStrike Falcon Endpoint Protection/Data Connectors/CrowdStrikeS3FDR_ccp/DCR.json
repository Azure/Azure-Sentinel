[
    {
        "name": "crowdStrikeFalconS3DCR",
        "apiVersion": "2021-09-01-preview",
        "type": "Microsoft.Insights/dataCollectionRules",
        "location": "{{location}}",
        "properties": {
            "streamDeclarations": {
                "Custom-CrowdstrikeStream": {
                    "columns": [
                        {
                            "name": "event_simpleName",
                            "type": "string"
                        },
                        {
                            "name": "timestamp",
                            "type": "string"
                        },
                        {
                            "name": "aip",
                            "type": "string"
                        },
                        {
                            "name": "aid",
                            "type": "string"
                        },
                        {
                            "name": "UserName",
                            "type": "string"
                        },
                        {
                            "name": "event_platform",
                            "type": "string"
                        },
                        {
                            "name": "ContextTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "name",
                            "type": "string"
                        },
                        {
                            "name": "id",
                            "type": "string"
                        },
                        {
                            "name": "ContextProcessId",
                            "type": "string"
                        },
                        {
                            "name": "ContextThreadId",
                            "type": "string"
                        },
                        {
                            "name": "Entitlements",
                            "type": "string"
                        },
                        {
                            "name": "cid",
                            "type": "string"
                        },
                        {
                            "name": "OciContainerId",
                            "type": "string"
                        },
                        {
                            "name": "TreeId",
                            "type": "string"
                        },
                        {
                            "name": "DomainName",
                            "type": "string"
                        },
                        {
                            "name": "RequestType",
                            "type": "string"
                        },
                        {
                            "name": "IP4Records",
                            "type": "string"
                        },
                        {
                            "name": "QueryStatus",
                            "type": "string"
                        },
                        {
                            "name": "FirstIP4Record",
                            "type": "string"
                        },
                        {
                            "name": "DnsRequestCount",
                            "type": "string"
                        },
                        {
                            "name": "IP6Records",
                            "type": "string"
                        },
                        {
                            "name": "InterfaceIndex",
                            "type": "string"
                        },
                        {
                            "name": "DualRequest",
                            "type": "string"
                        },
                        {
                            "name": "DnsResponseType",
                            "type": "string"
                        },
                        {
                            "name": "EventOrigin",
                            "type": "string"
                        },
                        {
                            "name": "RespondingDnsServer",
                            "type": "string"
                        },
                        {
                            "name": "CNAMERecords",
                            "type": "string"
                        },
                        {
                            "name": "FirstIP6Record",
                            "type": "string"
                        },
                        {
                            "name": "AdditionalFields",
                            "type": "string"
                        },
                        {
                            "name": "CloudErrorCode",
                            "type": "string"
                        },
                        {
                            "name": "LogonType",
                            "type": "string"
                        },
                        {
                            "name": "UserPrincipal",
                            "type": "string"
                        },
                        {
                            "name": "UserIsAdmin",
                            "type": "string"
                        },
                        {
                            "name": "LogonTime",
                            "type": "string"
                        },
                        {
                            "name": "LogonDomain",
                            "type": "string"
                        },
                        {
                            "name": "RemoteAccount",
                            "type": "string"
                        },
                        {
                            "name": "UserSid",
                            "type": "string"
                        },
                        {
                            "name": "UserFlags",
                            "type": "string"
                        },
                        {
                            "name": "LogonServer",
                            "type": "string"
                        },
                        {
                            "name": "LogonId",
                            "type": "string"
                        },
                        {
                            "name": "SessionId",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticationPackage",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticationId",
                            "type": "string"
                        },
                        {
                            "name": "PasswordLastSet",
                            "type": "string"
                        },
                        {
                            "name": "UserLogonFlags",
                            "type": "string"
                        },
                        {
                            "name": "LoginSessionId",
                            "type": "string"
                        },
                        {
                            "name": "UID",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticationUuid",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticationIdMac",
                            "type": "string"
                        },
                        {
                            "name": "CommandLine",
                            "type": "string"
                        },
                        {
                            "name": "ClientComputerName",
                            "type": "string"
                        },
                        {
                            "name": "WmiConsumerType",
                            "type": "string"
                        },
                        {
                            "name": "WmiFilterType",
                            "type": "string"
                        },
                        {
                            "name": "EtwRawProcessId",
                            "type": "string"
                        },
                        {
                            "name": "ImageFileName",
                            "type": "string"
                        },
                        {
                            "name": "OriginalParentAuthenticationId",
                            "type": "string"
                        },
                        {
                            "name": "ParentAuthenticationId",
                            "type": "string"
                        },
                        {
                            "name": "OriginalUserSid",
                            "type": "string"
                        },
                        {
                            "name": "SHA256HashData",
                            "type": "string"
                        },
                        {
                            "name": "TargetFileName",
                            "type": "string"
                        },
                        {
                            "name": "Status",
                            "type": "string"
                        },
                        {
                            "name": "ErrorText",
                            "type": "string"
                        },
                        {
                            "name": "WmiProviderType",
                            "type": "string"
                        },
                        {
                            "name": "RawProcessId",
                            "type": "string"
                        },
                        {
                            "name": "UmppaInjectionType",
                            "type": "string"
                        },
                        {
                            "name": "ErrorStatus",
                            "type": "string"
                        },
                        {
                            "name": "SourceFileName",
                            "type": "string"
                        },
                        {
                            "name": "WmiQuery",
                            "type": "string"
                        },
                        {
                            "name": "WmiNamespaceName",
                            "type": "string"
                        },
                        {
                            "name": "ServiceDisplayName",
                            "type": "string"
                        },
                        {
                            "name": "ErrorCode",
                            "type": "string"
                        },
                        {
                            "name": "TargetProcessId",
                            "type": "string"
                        },
                        {
                            "name": "TokenType",
                            "type": "string"
                        },
                        {
                            "name": "InterfaceGuid",
                            "type": "string"
                        },
                        {
                            "name": "RpcClientProcessId",
                            "type": "string"
                        },
                        {
                            "name": "RpcClientThreadId",
                            "type": "string"
                        },
                        {
                            "name": "SourceProcessId",
                            "type": "string"
                        },
                        {
                            "name": "EtwRawThreadId",
                            "type": "string"
                        },
                        {
                            "name": "SourceThreadId",
                            "type": "string"
                        },
                        {
                            "name": "RawThreadId",
                            "type": "string"
                        },
                        {
                            "name": "OriginalContentLength",
                            "type": "string"
                        },
                        {
                            "name": "ContentSHA256HashData",
                            "type": "string"
                        },
                        {
                            "name": "ScriptContentName",
                            "type": "string"
                        },
                        {
                            "name": "HostProcessType",
                            "type": "string"
                        },
                        {
                            "name": "ParentCommandLine",
                            "type": "string"
                        },
                        {
                            "name": "ParentImageFileName",
                            "type": "string"
                        },
                        {
                            "name": "GrandparentImageFileName",
                            "type": "string"
                        },
                        {
                            "name": "GrandparentCommandLine",
                            "type": "string"
                        },
                        {
                            "name": "ScriptContentBytes",
                            "type": "string"
                        },
                        {
                            "name": "ExecutableBytes",
                            "type": "string"
                        },
                        {
                            "name": "CallStackModuleNames",
                            "type": "string"
                        },
                        {
                            "name": "KernelTime",
                            "type": "string"
                        },
                        {
                            "name": "ScriptContentSource",
                            "type": "string"
                        },
                        {
                            "name": "OriginalFilename",
                            "type": "string"
                        },
                        {
                            "name": "ScreenshotType",
                            "type": "string"
                        },
                        {
                            "name": "TaskName",
                            "type": "string"
                        },
                        {
                            "name": "TaskExecCommand",
                            "type": "string"
                        },
                        {
                            "name": "TaskXml",
                            "type": "string"
                        },
                        {
                            "name": "TaskExecArguments",
                            "type": "string"
                        },
                        {
                            "name": "KeyObject",
                            "type": "string"
                        },
                        {
                            "name": "PublicKeys",
                            "type": "string"
                        },
                        {
                            "name": "RegPostObjectName",
                            "type": "string"
                        },
                        {
                            "name": "RegKeyName",
                            "type": "string"
                        },
                        {
                            "name": "RegRootObjectName",
                            "type": "string"
                        },
                        {
                            "name": "ExtendedKeyUsages",
                            "type": "string"
                        },
                        {
                            "name": "RegCreateDisposition",
                            "type": "string"
                        },
                        {
                            "name": "FileSigningTime",
                            "type": "string"
                        },
                        {
                            "name": "RegCreateOptions",
                            "type": "string"
                        },
                        {
                            "name": "SignInfoFlags",
                            "type": "string"
                        },
                        {
                            "name": "Certificate",
                            "type": "string"
                        },
                        {
                            "name": "OdsActionType",
                            "type": "string"
                        },
                        {
                            "name": "FileSubType",
                            "type": "string"
                        },
                        {
                            "name": "TargetAddress",
                            "type": "string"
                        },
                        {
                            "name": "Size",
                            "type": "string"
                        },
                        {
                            "name": "CompanyName",
                            "type": "string"
                        },
                        {
                            "name": "FileVersion",
                            "type": "string"
                        },
                        {
                            "name": "ProductSku",
                            "type": "string"
                        },
                        {
                            "name": "ProductName",
                            "type": "string"
                        },
                        {
                            "name": "EventMax",
                            "type": "string"
                        },
                        {
                            "name": "PlatformId",
                            "type": "string"
                        },
                        {
                            "name": "BuildType",
                            "type": "string"
                        },
                        {
                            "name": "ProductType",
                            "type": "string"
                        },
                        {
                            "name": "AttemptNumber",
                            "type": "string"
                        },
                        {
                            "name": "OSVersionFileData",
                            "type": "string"
                        },
                        {
                            "name": "OSVersionString",
                            "type": "string"
                        },
                        {
                            "name": "OSVersionFileName",
                            "type": "string"
                        },
                        {
                            "name": "IntegrityLevel",
                            "type": "string"
                        },
                        {
                            "name": "RemotePort",
                            "type": "string"
                        },
                        {
                            "name": "Protocol",
                            "type": "string"
                        },
                        {
                            "name": "VolumeDeviceType",
                            "type": "string"
                        },
                        {
                            "name": "VolumeName",
                            "type": "string"
                        },
                        {
                            "name": "VolumeDeviceObjectFlags",
                            "type": "string"
                        },
                        {
                            "name": "Length",
                            "type": "string"
                        },
                        {
                            "name": "ServiceObjectName",
                            "type": "string"
                        },
                        {
                            "name": "ServiceDescription",
                            "type": "string"
                        },
                        {
                            "name": "ServiceSecurity",
                            "type": "string"
                        },
                        {
                            "name": "ServiceImagePath",
                            "type": "string"
                        },
                        {
                            "name": "ServiceStart",
                            "type": "string"
                        },
                        {
                            "name": "ServiceType",
                            "type": "string"
                        },
                        {
                            "name": "ServiceFailureActions",
                            "type": "string"
                        },
                        {
                            "name": "ServiceErrorControl",
                            "type": "string"
                        },
                        {
                            "name": "ServiceGroup",
                            "type": "string"
                        },
                        {
                            "name": "ProcessIntegrityLevel",
                            "type": "string"
                        },
                        {
                            "name": "MD5HashData",
                            "type": "string"
                        },
                        {
                            "name": "CloudRequestId",
                            "type": "string"
                        },
                        {
                            "name": "VolumeSessionUUID",
                            "type": "string"
                        },
                        {
                            "name": "VolumeFileSystemDevice",
                            "type": "string"
                        },
                        {
                            "name": "VolumeSnapshotName",
                            "type": "string"
                        },
                        {
                            "name": "VolumeIsEncrypted",
                            "type": "string"
                        },
                        {
                            "name": "VolumeFileSystemDriver",
                            "type": "string"
                        },
                        {
                            "name": "VolumeSnapshotTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "VolumeRealDeviceName",
                            "type": "string"
                        },
                        {
                            "name": "VolumeEncryptionStatus",
                            "type": "string"
                        },
                        {
                            "name": "RemoteAddressIP4",
                            "type": "string"
                        },
                        {
                            "name": "IsOnRemovableDisk",
                            "type": "string"
                        },
                        {
                            "name": "QuarantinedFileExtendedState",
                            "type": "string"
                        },
                        {
                            "name": "DeviceId",
                            "type": "string"
                        },
                        {
                            "name": "LocalAddressIP4",
                            "type": "string"
                        },
                        {
                            "name": "NetworkGuid",
                            "type": "string"
                        },
                        {
                            "name": "InterfaceAlias",
                            "type": "string"
                        },
                        {
                            "name": "PermanentPhysicalAddress",
                            "type": "string"
                        },
                        {
                            "name": "InterfaceType",
                            "type": "string"
                        },
                        {
                            "name": "MediaType",
                            "type": "string"
                        },
                        {
                            "name": "AccessType",
                            "type": "string"
                        },
                        {
                            "name": "ConnectionType",
                            "type": "string"
                        },
                        {
                            "name": "PhysicalAddress",
                            "type": "string"
                        },
                        {
                            "name": "DirectionType",
                            "type": "string"
                        },
                        {
                            "name": "CreationTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "BaseReachableTime",
                            "type": "string"
                        },
                        {
                            "name": "TunnelType",
                            "type": "string"
                        },
                        {
                            "name": "NetworkInterfaceGuid",
                            "type": "string"
                        },
                        {
                            "name": "PhysicalMediumType",
                            "type": "string"
                        },
                        {
                            "name": "LocalAddressIP6",
                            "type": "string"
                        },
                        {
                            "name": "DefaultGatewayIP6",
                            "type": "string"
                        },
                        {
                            "name": "ModuleNativePath",
                            "type": "string"
                        },
                        {
                            "name": "DotnetModuleFlags",
                            "type": "string"
                        },
                        {
                            "name": "FirmwareSize",
                            "type": "string"
                        },
                        {
                            "name": "ImageAnalysisRequestTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "FirmwareType",
                            "type": "string"
                        },
                        {
                            "name": "ProcessCount",
                            "type": "string"
                        },
                        {
                            "name": "EtwTargetRawProcessId",
                            "type": "string"
                        },
                        {
                            "name": "MinorFunction",
                            "type": "string"
                        },
                        {
                            "name": "FileObject",
                            "type": "string"
                        },
                        {
                            "name": "MajorFunction",
                            "type": "string"
                        },
                        {
                            "name": "SHA1HashData",
                            "type": "string"
                        },
                        {
                            "name": "SignatureState",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticodeHashData",
                            "type": "string"
                        },
                        {
                            "name": "ToBeSignedAlgorithm",
                            "type": "string"
                        },
                        {
                            "name": "ToBeSignedHash",
                            "type": "string"
                        },
                        {
                            "name": "SignInfoRequestFlags",
                            "type": "string"
                        },
                        {
                            "name": "HashAlgorithm",
                            "type": "string"
                        },
                        {
                            "name": "RegObjectName",
                            "type": "string"
                        },
                        {
                            "name": "RegValueName",
                            "type": "string"
                        },
                        {
                            "name": "RegType",
                            "type": "string"
                        },
                        {
                            "name": "RegClassificationIndex",
                            "type": "string"
                        },
                        {
                            "name": "RegClassificationFlags",
                            "type": "string"
                        },
                        {
                            "name": "RegOperationType",
                            "type": "string"
                        },
                        {
                            "name": "RegClassification",
                            "type": "string"
                        },
                        {
                            "name": "RegStringValue",
                            "type": "string"
                        },
                        {
                            "name": "Facility",
                            "type": "string"
                        },
                        {
                            "name": "File",
                            "type": "string"
                        },
                        {
                            "name": "BatchTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "LastUpdateInstalledTime",
                            "type": "string"
                        },
                        {
                            "name": "RawTargetProcessId",
                            "type": "string"
                        },
                        {
                            "name": "TargetThreadId",
                            "type": "string"
                        },
                        {
                            "name": "ApcContextFileName",
                            "type": "string"
                        },
                        {
                            "name": "RawTargetThreadId",
                            "type": "string"
                        },
                        {
                            "name": "InjectedThreadFlag",
                            "type": "string"
                        },
                        {
                            "name": "DownloadServer",
                            "type": "string"
                        },
                        {
                            "name": "DownloadPath",
                            "type": "string"
                        },
                        {
                            "name": "DownloadPort",
                            "type": "string"
                        },
                        {
                            "name": "RuleMatchCount",
                            "type": "string"
                        },
                        {
                            "name": "VolumeMountPoint",
                            "type": "string"
                        },
                        {
                            "name": "VolumeDriveLetter",
                            "type": "string"
                        },
                        {
                            "name": "DiskParentDeviceInstanceId",
                            "type": "string"
                        },
                        {
                            "name": "BoundingLimitCount",
                            "type": "string"
                        },
                        {
                            "name": "TargetDirectoryName",
                            "type": "string"
                        },
                        {
                            "name": "ReflectivePeTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "ProcessExecuteFlags",
                            "type": "string"
                        },
                        {
                            "name": "TargetIntegrityLevel",
                            "type": "string"
                        },
                        {
                            "name": "TargetAuthenticationId",
                            "type": "string"
                        },
                        {
                            "name": "ImageBaseName",
                            "type": "string"
                        },
                        {
                            "name": "ConnectionDirection",
                            "type": "string"
                        },
                        {
                            "name": "ConnectionFlags",
                            "type": "string"
                        },
                        {
                            "name": "LocalPort",
                            "type": "string"
                        },
                        {
                            "name": "AppName",
                            "type": "string"
                        },
                        {
                            "name": "AppVersion",
                            "type": "string"
                        },
                        {
                            "name": "UpdateFlag",
                            "type": "string"
                        },
                        {
                            "name": "AppProductId",
                            "type": "string"
                        },
                        {
                            "name": "AppPath",
                            "type": "string"
                        },
                        {
                            "name": "InstallDate",
                            "type": "string"
                        },
                        {
                            "name": "AppType",
                            "type": "string"
                        },
                        {
                            "name": "AppSource",
                            "type": "string"
                        },
                        {
                            "name": "AppProvider",
                            "type": "string"
                        },
                        {
                            "name": "AppIdentificationData",
                            "type": "string"
                        },
                        {
                            "name": "CommandCloudTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "CommandSequenceTotal",
                            "type": "string"
                        },
                        {
                            "name": "CommandCode",
                            "type": "string"
                        },
                        {
                            "name": "CommandEndTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "CommandStartTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "CommandSequenceNumber",
                            "type": "string"
                        },
                        {
                            "name": "CommandName",
                            "type": "string"
                        },
                        {
                            "name": "CommandStdOut",
                            "type": "string"
                        },
                        {
                            "name": "CommandStdErr",
                            "type": "string"
                        },
                        {
                            "name": "QuarantinedFileState",
                            "type": "string"
                        },
                        {
                            "name": "QuarantinedFileName",
                            "type": "string"
                        },
                        {
                            "name": "FileSystemOperationType",
                            "type": "string"
                        },
                        {
                            "name": "TargetSHA256HashData",
                            "type": "string"
                        },
                        {
                            "name": "TargetCommandLineParameters",
                            "type": "string"
                        },
                        {
                            "name": "RegConfigValueType",
                            "type": "string"
                        },
                        {
                            "name": "RegConfigFlags",
                            "type": "string"
                        },
                        {
                            "name": "RegConfigClass",
                            "type": "string"
                        },
                        {
                            "name": "RegConfigIndex",
                            "type": "string"
                        },
                        {
                            "name": "RegKeyChangeType",
                            "type": "string"
                        },
                        {
                            "name": "Options",
                            "type": "string"
                        },
                        {
                            "name": "Information",
                            "type": "string"
                        },
                        {
                            "name": "FileIdentifier",
                            "type": "string"
                        },
                        {
                            "name": "ShareAccess",
                            "type": "string"
                        },
                        {
                            "name": "FileAttributes",
                            "type": "string"
                        },
                        {
                            "name": "ImageTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "ExclusionType",
                            "type": "string"
                        },
                        {
                            "name": "CommandHistory",
                            "type": "string"
                        },
                        {
                            "name": "FirstCommand",
                            "type": "string"
                        },
                        {
                            "name": "CommandCount",
                            "type": "string"
                        },
                        {
                            "name": "DeviceProductId",
                            "type": "string"
                        },
                        {
                            "name": "BluetoothDeviceType",
                            "type": "string"
                        },
                        {
                            "name": "BluetoothDeviceAddressType",
                            "type": "string"
                        },
                        {
                            "name": "BluetoothDeviceAddress",
                            "type": "string"
                        },
                        {
                            "name": "BluetoothDeviceName",
                            "type": "string"
                        },
                        {
                            "name": "DeviceVendorId",
                            "type": "string"
                        },
                        {
                            "name": "AmsiStatusCode",
                            "type": "string"
                        },
                        {
                            "name": "AmsiRegistrationState",
                            "type": "string"
                        },
                        {
                            "name": "SourceEndpointNetworkType",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountUserPrincipal",
                            "type": "string"
                        },
                        {
                            "name": "ActiveDirectoryAuthenticationMethod",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountType",
                            "type": "string"
                        },
                        {
                            "name": "TargetAccountObjectSid",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountObjectSid",
                            "type": "string"
                        },
                        {
                            "name": "AggregationWindowTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountDomain",
                            "type": "string"
                        },
                        {
                            "name": "TargetAccountType",
                            "type": "string"
                        },
                        {
                            "name": "NtlmAvFlags",
                            "type": "string"
                        },
                        {
                            "name": "AggregationLatestTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "DeviceTimeStamp",
                            "type": "string"
                        },
                        {
                            "name": "ParentHubInstanceId",
                            "type": "string"
                        },
                        {
                            "name": "DeviceProduct",
                            "type": "string"
                        },
                        {
                            "name": "ParentHubPort",
                            "type": "string"
                        },
                        {
                            "name": "DeviceProtocol",
                            "type": "string"
                        },
                        {
                            "name": "DcPolicyFlags",
                            "type": "string"
                        },
                        {
                            "name": "DeviceVersion",
                            "type": "string"
                        },
                        {
                            "name": "DeviceInstanceId",
                            "type": "string"
                        },
                        {
                            "name": "DeviceUserSid",
                            "type": "string"
                        },
                        {
                            "name": "DeviceUserAuthenticationId",
                            "type": "string"
                        },
                        {
                            "name": "SocketType",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountSamAccountName",
                            "type": "string"
                        },
                        {
                            "name": "KerberosRequestTicketValidityPeriod",
                            "type": "string"
                        },
                        {
                            "name": "DelegatorAccountObjectSid",
                            "type": "string"
                        },
                        {
                            "name": "DelegatorAccountSamAccountName",
                            "type": "string"
                        },
                        {
                            "name": "DesiredKerberosEncryptionTypes",
                            "type": "string"
                        },
                        {
                            "name": "DcPropertyIdInterfaceType",
                            "type": "string"
                        },
                        {
                            "name": "DcSensorInterfaceType",
                            "type": "string"
                        },
                        {
                            "name": "AmsScanTypeId",
                            "type": "string"
                        },
                        {
                            "name": "AmsStatus",
                            "type": "string"
                        },
                        {
                            "name": "LdapSecurityType",
                            "type": "string"
                        },
                        {
                            "name": "ObjectTypeEtw",
                            "type": "string"
                        },
                        {
                            "name": "SessionProcessId",
                            "type": "string"
                        },
                        {
                            "name": "ModuleCharacteristics",
                            "type": "string"
                        },
                        {
                            "name": "HostUrl",
                            "type": "string"
                        },
                        {
                            "name": "FileFormatString",
                            "type": "string"
                        },
                        {
                            "name": "MemoryScanFlags",
                            "type": "string"
                        },
                        {
                            "name": "AmsDeviceType",
                            "type": "string"
                        },
                        {
                            "name": "AsepFlags",
                            "type": "string"
                        },
                        {
                            "name": "AsepValueType",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountBadPasswordCount",
                            "type": "string"
                        },
                        {
                            "name": "SourceAccountBadPasswordTime",
                            "type": "string"
                        },
                        {
                            "name": "EndpointDescriptorAddress",
                            "type": "string"
                        },
                        {
                            "name": "EndpointDescriptorAttributes",
                            "type": "string"
                        },
                        {
                            "name": "ConfigurationDescriptorValue",
                            "type": "string"
                        },
                        {
                            "name": "ConfigurationDescriptorAttributes",
                            "type": "string"
                        },
                        {
                            "name": "ConfigurationDescriptorName",
                            "type": "string"
                        },
                        {
                            "name": "ConfigurationDescriptorNumInterfaces",
                            "type": "string"
                        },
                        {
                            "name": "DcTypeOrLocation",
                            "type": "string"
                        },
                        {
                            "name": "AgentLocalTime",
                            "type": "string"
                        },
                        {
                            "name": "ComputerName",
                            "type": "string"
                        },
                        {
                            "name": "ChassisType",
                            "type": "string"
                        },
                        {
                            "name": "ThreadStartBytes",
                            "type": "string"
                        },
                        {
                            "name": "BaseTime",
                            "type": "string"
                        },
                        {
                            "name": "TpmType",
                            "type": "string"
                        },
                        {
                            "name": "UTCTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "SubjectDN",
                            "type": "string"
                        },
                        {
                            "name": "SignatureDigestEncryptAlg",
                            "type": "string"
                        },
                        {
                            "name": "SignInfoFlagSignHashMismatch",
                            "type": "string"
                        },
                        {
                            "name": "SubjectSerialNumber",
                            "type": "string"
                        },
                        {
                            "name": "IssuerDN",
                            "type": "string"
                        },
                        {
                            "name": "SubjectCN",
                            "type": "string"
                        },
                        {
                            "name": "ExternalApiType",
                            "type": "string"
                        },
                        {
                            "name": "SignInfoFlagSelfSigned",
                            "type": "string"
                        },
                        {
                            "name": "product_type_desc",
                            "type": "string"
                        },
                        {
                            "name": "event_type",
                            "type": "string"
                        },
                        {
                            "name": "StartTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "HostnameField",
                            "type": "string"
                        },
                        {
                            "name": "OriginSourceIpAddress",
                            "type": "string"
                        },
                        {
                            "name": "SHA1String",
                            "type": "string"
                        },
                        {
                            "name": "ProcessStartTime",
                            "type": "string"
                        },
                        {
                            "name": "ProcessEndTime",
                            "type": "string"
                        },
                        {
                            "name": "DnsRequests",
                            "type": "string"
                        },
                        {
                            "name": "PatternDispositionFlags",
                            "type": "string"
                        },
                        {
                            "name": "FileName",
                            "type": "string"
                        },
                        {
                            "name": "LocalIP",
                            "type": "string"
                        },
                        {
                            "name": "FilePath",
                            "type": "string"
                        },
                        {
                            "name": "EventUUID",
                            "type": "string"
                        },
                        {
                            "name": "MD5String",
                            "type": "string"
                        },
                        {
                            "name": "SeverityName",
                            "type": "string"
                        },
                        {
                            "name": "Severity",
                            "type": "string"
                        },
                        {
                            "name": "SHA256String",
                            "type": "string"
                        },
                        {
                            "name": "NetworkAccesses",
                            "type": "string"
                        },
                        {
                            "name": "MACAddress",
                            "type": "string"
                        },
                        {
                            "name": "ProcessId",
                            "type": "string"
                        },
                        {
                            "name": "BillingType",
                            "type": "string"
                        },
                        {
                            "name": "RegNumericValue",
                            "type": "string"
                        },
                        {
                            "name": "RegBinaryValue",
                            "type": "string"
                        },
                        {
                            "name": "RpcOpClassification",
                            "type": "string"
                        },
                        {
                            "name": "RemoteAddressIP6",
                            "type": "string"
                        },
                        {
                            "name": "UserLogoffType",
                            "type": "string"
                        },
                        {
                            "name": "LogoffTime",
                            "type": "string"
                        },
                        {
                            "name": "PrivilegesBitmask",
                            "type": "string"
                        },
                        {
                            "name": "SubStatus",
                            "type": "string"
                        },
                        {
                            "name": "LocalSession",
                            "type": "string"
                        },
                        {
                            "name": "EnabledPrivilegesBitmask",
                            "type": "string"
                        },
                        {
                            "name": "UserGroupsBitmask",
                            "type": "string"
                        },
                        {
                            "name": "LinkedAuthenticationId",
                            "type": "string"
                        },
                        {
                            "name": "FileWrittenFlags",
                            "type": "string"
                        },
                        {
                            "name": "ClientId",
                            "type": "string"
                        },
                        {
                            "name": "IsOnNetwork",
                            "type": "string"
                        },
                        {
                            "name": "TemporaryFileName",
                            "type": "string"
                        },
                        {
                            "name": "MSOfficeSubType",
                            "type": "string"
                        },
                        {
                            "name": "GID",
                            "type": "string"
                        },
                        {
                            "name": "UnixMode",
                            "type": "string"
                        },
                        {
                            "name": "USN",
                            "type": "string"
                        },
                        {
                            "name": "FileCategory",
                            "type": "string"
                        },
                        {
                            "name": "ELFSubType",
                            "type": "string"
                        },
                        {
                            "name": "IsTransactedFile",
                            "type": "string"
                        },
                        {
                            "name": "MachOSubType",
                            "type": "string"
                        },
                        {
                            "name": "NewFileIdentifier",
                            "type": "string"
                        },
                        {
                            "name": "Tags",
                            "type": "string"
                        },
                        {
                            "name": "VnodeType",
                            "type": "string"
                        },
                        {
                            "name": "FileEventType",
                            "type": "string"
                        },
                        {
                            "name": "RemoteAddressString",
                            "type": "string"
                        },
                        {
                            "name": "FirewallAction",
                            "type": "string"
                        },
                        {
                            "name": "NegateLocalAddress",
                            "type": "string"
                        },
                        {
                            "name": "RemoteAddressMaskIP6",
                            "type": "string"
                        },
                        {
                            "name": "LocalAddressMaskIP6",
                            "type": "string"
                        },
                        {
                            "name": "NegateRemoteAddress",
                            "type": "string"
                        },
                        {
                            "name": "IcmpCode",
                            "type": "string"
                        },
                        {
                            "name": "IcmpType",
                            "type": "string"
                        },
                        {
                            "name": "RemoteAddressMaskIP4",
                            "type": "string"
                        },
                        {
                            "name": "LocalAddressMaskIP4",
                            "type": "string"
                        },
                        {
                            "name": "InContext",
                            "type": "string"
                        },
                        {
                            "name": "NeighborList",
                            "type": "string"
                        },
                        {
                            "name": "TcpConnectErrorCode",
                            "type": "string"
                        },
                        {
                            "name": "NegateInterface",
                            "type": "string"
                        },
                        {
                            "name": "HbfwRuleId",
                            "type": "string"
                        },
                        {
                            "name": "NetworkProfile",
                            "type": "string"
                        },
                        {
                            "name": "PolicyIdentifier",
                            "type": "string"
                        },
                        {
                            "name": "HbfwRuleFlags",
                            "type": "string"
                        },
                        {
                            "name": "RuleAction",
                            "type": "string"
                        },
                        {
                            "name": "ParentBaseFileName",
                            "type": "string"
                        },
                        {
                            "name": "InjecteeImageFileName",
                            "type": "string"
                        },
                        {
                            "name": "InjectorImageFileName",
                            "type": "string"
                        },
                        {
                            "name": "ParentProcessId",
                            "type": "string"
                        },
                        {
                            "name": "ConHostProcessId",
                            "type": "string"
                        },
                        {
                            "name": "WritingProcessId",
                            "type": "string"
                        },
                        {
                            "name": "WritingProcessImageFileName",
                            "type": "string"
                        },
                        {
                            "name": "WritingProcessCommandLine",
                            "type": "string"
                        },
                        {
                            "name": "ModuleName",
                            "type": "string"
                        },
                        {
                            "name": "TemplateInstanceId",
                            "type": "string"
                        },
                        {
                            "name": "ProcessGroupId",
                            "type": "string"
                        },
                        {
                            "name": "CreateProcessType",
                            "type": "string"
                        },
                        {
                            "name": "ZoneIdentifier",
                            "type": "string"
                        },
                        {
                            "name": "MappedFromUserMode",
                            "type": "string"
                        },
                        {
                            "name": "LoadingProcessOriginalFilename",
                            "type": "string"
                        },
                        {
                            "name": "ImageDirectoryClassification",
                            "type": "string"
                        },
                        {
                            "name": "ModuleLoadMechanism",
                            "type": "string"
                        },
                        {
                            "name": "PatternIdList",
                            "type": "string"
                        },
                        {
                            "name": "ScreenshotsTakenCount",
                            "type": "string"
                        },
                        {
                            "name": "ExitCode",
                            "type": "string"
                        },
                        {
                            "name": "NetworkListenCount",
                            "type": "string"
                        },
                        {
                            "name": "SuspiciousRawDiskReadCount",
                            "type": "string"
                        },
                        {
                            "name": "NetworkBindCount",
                            "type": "string"
                        },
                        {
                            "name": "NetworkRecvAcceptCount",
                            "type": "string"
                        },
                        {
                            "name": "ContextData",
                            "type": "string"
                        },
                        {
                            "name": "NewExecutableWrittenCount",
                            "type": "string"
                        },
                        {
                            "name": "ExeAndServiceCount",
                            "type": "string"
                        },
                        {
                            "name": "NetworkCloseCount",
                            "type": "string"
                        },
                        {
                            "name": "SuspectStackCount",
                            "type": "string"
                        },
                        {
                            "name": "CLICreationCount",
                            "type": "string"
                        },
                        {
                            "name": "UnsignedModuleLoadCount",
                            "type": "string"
                        },
                        {
                            "name": "UserTime",
                            "type": "string"
                        },
                        {
                            "name": "AllocateVirtualMemoryCount",
                            "type": "string"
                        },
                        {
                            "name": "ServiceEventCount",
                            "type": "string"
                        },
                        {
                            "name": "SnapshotFileOpenCount",
                            "type": "string"
                        },
                        {
                            "name": "RemovableDiskFileWrittenCount",
                            "type": "string"
                        },
                        {
                            "name": "InjectedDllCount",
                            "type": "string"
                        },
                        {
                            "name": "UserMemoryProtectExecutableCount",
                            "type": "string"
                        },
                        {
                            "name": "NetworkCapableAsepWriteCount",
                            "type": "string"
                        },
                        {
                            "name": "SetThreadContextCount",
                            "type": "string"
                        },
                        {
                            "name": "SuspiciousCredentialModuleLoadCount",
                            "type": "string"
                        },
                        {
                            "name": "FileDeletedCount",
                            "type": "string"
                        },
                        {
                            "name": "UserMemoryAllocateExecutableCount",
                            "type": "string"
                        },
                        {
                            "name": "NetworkConnectCountUdp",
                            "type": "string"
                        },
                        {
                            "name": "SuspiciousFontLoadCount",
                            "type": "string"
                        },
                        {
                            "name": "ConHostId",
                            "type": "string"
                        },
                        {
                            "name": "NetworkConnectCount",
                            "type": "string"
                        },
                        {
                            "name": "CreateProcessCount",
                            "type": "string"
                        },
                        {
                            "name": "DirectoryEnumeratedCount",
                            "type": "string"
                        },
                        {
                            "name": "SuspiciousDnsRequestCount",
                            "type": "string"
                        },
                        {
                            "name": "DocumentFileWrittenCount",
                            "type": "string"
                        },
                        {
                            "name": "ExecutableDeletedCount",
                            "type": "string"
                        },
                        {
                            "name": "RegKeySecurityDecreasedCount",
                            "type": "string"
                        },
                        {
                            "name": "InjectedThreadCount",
                            "type": "string"
                        },
                        {
                            "name": "ThreadStartAddress",
                            "type": "string"
                        },
                        {
                            "name": "PayloadClassification",
                            "type": "string"
                        },
                        {
                            "name": "PayloadClassificationFlags",
                            "type": "string"
                        },
                        {
                            "name": "UserMemoryProtectExecutableRemoteCount",
                            "type": "string"
                        },
                        {
                            "name": "WellKnownTargetFunction",
                            "type": "string"
                        },
                        {
                            "name": "SmbShareName",
                            "type": "string"
                        },
                        {
                            "name": "ShareName",
                            "type": "string"
                        },
                        {
                            "name": "UploadId",
                            "type": "string"
                        },
                        {
                            "name": "FirewallRule",
                            "type": "string"
                        },
                        {
                            "name": "FirewallRuleId",
                            "type": "string"
                        },
                        {
                            "name": "FirewallOption",
                            "type": "string"
                        },
                        {
                            "name": "DeviceSerialNumber",
                            "type": "string"
                        },
                        {
                            "name": "EnvironmentVariableName",
                            "type": "string"
                        },
                        {
                            "name": "SamAccountName",
                            "type": "string"
                        },
                        {
                            "name": "FirewallOptionNumericValue",
                            "type": "string"
                        },
                        {
                            "name": "FirewallOptionStringValue",
                            "type": "string"
                        },
                        {
                            "name": "FileVaultIsEnabled",
                            "type": "string"
                        },
                        {
                            "name": "EnvironmentVariableValue",
                            "type": "string"
                        },
                        {
                            "name": "ConfigStateData",
                            "type": "string"
                        },
                        {
                            "name": "ActiveDirectoryOuDn",
                            "type": "string"
                        },
                        {
                            "name": "SmbClientName",
                            "type": "string"
                        },
                        {
                            "name": "SharePath",
                            "type": "string"
                        },
                        {
                            "name": "ShareData",
                            "type": "string"
                        },
                        {
                            "name": "UserMemoryAllocateExecutableRemoteCount",
                            "type": "string"
                        },
                        {
                            "name": "FalconServiceState",
                            "type": "string"
                        },
                        {
                            "name": "IOServiceClass",
                            "type": "string"
                        },
                        {
                            "name": "IOServicePath",
                            "type": "string"
                        },
                        {
                            "name": "IOServiceProperties",
                            "type": "string"
                        },
                        {
                            "name": "IOServiceName",
                            "type": "string"
                        },
                        {
                            "name": "AccountDomain",
                            "type": "string"
                        },
                        {
                            "name": "AccountObjectGuid",
                            "type": "string"
                        },
                        {
                            "name": "AccountObjectSid",
                            "type": "string"
                        },
                        {
                            "name": "AddressFamily",
                            "type": "string"
                        },
                        {
                            "name": "FirewallProfile",
                            "type": "string"
                        },
                        {
                            "name": "UserRid",
                            "type": "string"
                        },
                        {
                            "name": "GroupRid",
                            "type": "string"
                        },
                        {
                            "name": "DomainSid",
                            "type": "string"
                        }
                    ]
                },
                "Custom-CrowdStrikeSecondary": {
                    "columns": [
                        {
                            "name": "FolderName",
                            "type": "string"
                        },
                        {
                            "name": "AdditionalFields",
                            "type": "string"
                        },
                        {
                            "name": "AgentLoadFlags",
                            "type": "string"
                        },
                        {
                            "name": "AgentLocalTime",
                            "type": "string"
                        },
                        {
                            "name": "AgentTimeOffset",
                            "type": "string"
                        },
                        {
                            "name": "AgentVersion",
                            "type": "string"
                        },
                        {
                            "name": "BiosManufacturer",
                            "type": "string"
                        },
                        {
                            "name": "BiosVersion",
                            "type": "string"
                        },
                        {
                            "name": "ChassisType",
                            "type": "string"
                        },
                        {
                            "name": "City",
                            "type": "string"
                        },
                        {
                            "name": "ComputerName",
                            "type": "string"
                        },
                        {
                            "name": "ConfigBuild",
                            "type": "string"
                        },
                        {
                            "name": "ConfigIDBuild",
                            "type": "string"
                        },
                        {
                            "name": "Continent",
                            "type": "string"
                        },
                        {
                            "name": "Country",
                            "type": "string"
                        },
                        {
                            "name": "FalconGroupingTags",
                            "type": "string"
                        },
                        {
                            "name": "FirstSeen",
                            "type": "string"
                        },
                        {
                            "name": "HostHiddenStatus",
                            "type": "string"
                        },
                        {
                            "name": "MachineDomain",
                            "type": "string"
                        },
                        {
                            "name": "OU",
                            "type": "string"
                        },
                        {
                            "name": "PointerSize",
                            "type": "string"
                        },
                        {
                            "name": "ProductType",
                            "type": "string"
                        },
                        {
                            "name": "SensorGroupingTags",
                            "type": "string"
                        },
                        {
                            "name": "ServicePackMajor",
                            "type": "string"
                        },
                        {
                            "name": "SiteName",
                            "type": "string"
                        },
                        {
                            "name": "SystemManufacturer",
                            "type": "string"
                        },
                        {
                            "name": "SystemProductName",
                            "type": "string"
                        },
                        {
                            "name": "Timezone",
                            "type": "string"
                        },
                        {
                            "name": "Version",
                            "type": "string"
                        },
                        {
                            "name": "aid",
                            "type": "string"
                        },
                        {
                            "name": "aip",
                            "type": "string"
                        },
                        {
                            "name": "cid",
                            "type": "string"
                        },
                        {
                            "name": "event_platform",
                            "type": "string"
                        },
                        {
                            "name": "CompanyName",
                            "type": "string"
                        },
                        {
                            "name": "FileName",
                            "type": "string"
                        },
                        {
                            "name": "FileVersion",
                            "type": "string"
                        },
                        {
                            "name": "ProductName",
                            "type": "string"
                        },
                        {
                            "name": "ProductVersion",
                            "type": "string"
                        },
                        {
                            "name": "SHA256HashData",
                            "type": "string"
                        },
                        {
                            "name": "detectionCount",
                            "type": "string"
                        },
                        {
                            "name": "hostname",
                            "type": "string"
                        },
                        {
                            "name": "externalIP",
                            "type": "string"
                        },
                        {
                            "name": "installationTimestamp",
                            "type": "string"
                        },
                        {
                            "name": "SoftwareType",
                            "type": "string"
                        },
                        {
                            "name": "Category",
                            "type": "string"
                        },
                        {
                            "name": "GatewayIP",
                            "type": "string"
                        },
                        {
                            "name": "GatewayMAC",
                            "type": "string"
                        },
                        {
                            "name": "InterfaceAlias",
                            "type": "string"
                        },
                        {
                            "name": "InterfaceDescription",
                            "type": "string"
                        },
                        {
                            "name": "LocalAddressIP4",
                            "type": "string"
                        },
                        {
                            "name": "MAC",
                            "type": "string"
                        },
                        {
                            "name": "MACPrefix",
                            "type": "string"
                        },
                        {
                            "name": "CurrentLocalIP",
                            "type": "string"
                        },
                        {
                            "name": "FirstDiscoveredDate",
                            "type": "string"
                        },
                        {
                            "name": "LastDiscoveredBy",
                            "type": "string"
                        },
                        {
                            "name": "discovererCount",
                            "type": "string"
                        },
                        {
                            "name": "discoverer_aid",
                            "type": "string"
                        },
                        {
                            "name": "discoverer_devicetype",
                            "type": "string"
                        },
                        {
                            "name": "localipCount",
                            "type": "string"
                        },
                        {
                            "name": "subnet",
                            "type": "string"
                        }
                    ]
                }
            },
            "dataSources": {},
            "destinations": {
                "logAnalytics": [
                    {
                        "workspaceResourceId": "{{workspaceResourceId}}",
                        "name": "clv2ws1"
                    }
                ]
            },
            "dataFlows": [
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n|  where event_simpleName in ('RawBindIP6', 'RawBindIP4', 'NetworkReceiveAcceptIP6', 'NetworkReceiveAcceptIP4', 'NetworkListenIP6', 'NetworkListenIP4', 'NetworkConnectIP6', 'NetworkConnectIP4', 'NetworkCloseIP6', 'NetworkCloseIP4', 'LocalIpAddressRemovedIP6', 'LocalIpAddressRemovedIP4', 'FirewallRuleIP6Matched', 'FirewallRuleIP4Matched', 'FirewallDeleteRuleIP6', 'FirewallDeleteRuleIP4', 'FirewallSetRuleIP6', 'FirewallSetRuleIP4') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),        \r\n        BoundingLimitCount = tolong(BoundingLimitCount),        \r\n        RemotePort = tolong(RemotePort),\r\n        LocalPort = tolong(LocalPort),\r\n        InterfaceIndex = tolong(InterfaceIndex),\r\n        RuleMatchCount = tolong(RuleMatchCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Network_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('UserIdentity', 'ActiveDirectoryInteractiveDomainLogon', 'PeVersionInfo', 'ActiveDirectoryAuthenticationFailure', 'ActiveDirectoryAuthentication', 'NeighborListIP6', 'NeighborListIP4', 'SuspiciousUserRemoteAPCAttempt', 'ServiceStarted', 'ScriptControlScanTelemetry', 'ScheduledTaskRegistered', 'ScheduledTaskModified', 'ScheduledTaskDeleted', 'KernelServiceStarted', 'HostedServiceStopped', 'HostedServiceStarted', 'DriverLoad', 'CustomIOAFileWrittenDetectionInfoEvent', 'CustomIOABasicProcessDetectionInfoEvent', 'CreateThreadReflectiveDll', 'CreateThreadNoStartImage', 'CreateThreadKernelNoStartImage', 'CreateService', 'BITSJobCreated', 'RegistryOperationDetectInfo', 'SnapshotVolumeMounted', 'SmbServerV1AuditEtw', 'RemovableMediaVolumeMounted', 'FsVolumeUnmounted', 'FsVolumeMounted', 'FirmwareRegionMeasured', 'FirmwareImageAnalyzed', 'AsepValueUpdate', 'AsepKeyUpdate', 'AmsiRegistrationStatus', 'WroteExeAndGeneratedServiceEvent', 'WmiProviderRegistrationEtw', 'WmiFilterConsumerBindingEtw', 'WfpFilterTamperingFilterDeleted', 'WfpFilterTamperingFilterAdded') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp), \r\n        BaseTime = todouble(BaseTime),\r\n        CommandCloudTimeStamp = todouble(CommandCloudTimeStamp),       \r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        ProcessCount = tolong(ProcessCount), \r\n        CommandCount = tolong(CommandCount),\r\n        SourceAccountBadPasswordCount = tolong(SourceAccountBadPasswordCount),\r\n        LogonTime = todouble(LogonTime),\r\n        KernelTime = todouble(KernelTime),\r\n        FileSigningTime = todouble(FileSigningTime),\r\n        VolumeSnapshotTimeStamp = todouble(VolumeSnapshotTimeStamp),\r\n        CreationTimeStamp = todouble(CreationTimeStamp),\r\n        BaseReachableTime = tolong(BaseReachableTime),\r\n        BatchTimestamp = todouble(BatchTimestamp),\r\n        ReflectivePeTimestamp = todouble(ReflectivePeTimestamp),\r\n        CommandEndTimeStamp = todouble(CommandEndTimeStamp),\r\n        CommandStartTimeStamp = todouble(CommandStartTimeStamp),\r\n        AggregationWindowTimestamp = todouble(AggregationWindowTimestamp),\r\n        AggregationLatestTimestamp = todouble(AggregationLatestTimestamp),\r\n        ImageAnalysisRequestTimestamp = todouble(ImageAnalysisRequestTimestamp),\r\n        ImageTimeStamp = todouble(ImageTimeStamp),\r\n        UTCTimestamp = todouble(UTCTimestamp),\r\n        DeviceTimeStamp = todouble(DeviceTimeStamp),\r\n        AgentLocalTime = todouble(AgentLocalTime),\r\n        StartTimestamp = todouble(StartTimestamp),\r\n        CommandSequenceTotal = toint(CommandSequenceTotal),\r\n        ProcessStartTime = todouble(ProcessStartTime),        \r\n        ProcessEndTime = todouble(ProcessEndTime),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Additional_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('DnsRequest', 'SuspiciousDnsRequest') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n    CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        DnsRequestCount = tolong(DnsRequestCount),\r\n        InterfaceIndex = tolong(InterfaceIndex),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_DNS_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('ZipFileWritten', 'XarFileWritten', 'SourceCodeFileWritten', 'IsoExtensionFileWritten', 'ImgExtensionFileWritten', 'UnixFileWritten', 'PythonFileWritten', 'WebScriptFileWritten', 'RegistryHiveFileWritten', 'ADExplorerFileWritten', 'CrxFileWritten', 'DexFileWritten', 'VmdkFileWritten', 'VdiFileWritten', 'TiffFileWritten', 'TarFileWritten', 'SuspiciousPeFileWritten', 'SuspiciousEseFileWritten', 'SldFileWritten', 'SevenZipFileWritten', 'RtfFileWritten', 'RpmFileWritten', 'RarFileWritten', 'RansomwareRenameFile', 'RansomwareOpenFile', 'RansomwareFileAccessPattern', 'RansomwareCreateFile', 'PngFileWritten', 'PeFileWritten', 'PdfFileWritten', 'OoxmlFileWritten', 'OleFileWritten', 'NewScriptWritten', 'NewExecutableWritten', 'NewExecutableRenamed', 'MSXlsxFileWritten', 'MSVsdxFileWritten', 'MSPptxFileWritten', 'MsiFileWritten', 'MSDocxFileWritten', 'MachOFileWritten', 'LnkFileWritten', 'JpegFileWritten', 'JavaClassFileWritten', 'JarFileWritten', 'IdwFileWritten', 'GzipFileWritten', 'GifFileWritten', 'GenericFileWritten', 'FileDetectInfo', 'EseFileWritten', 'EmailFileWritten', 'EmailArchiveFileWritten', 'ELFFileWritten', 'DxfFileWritten', 'DwgFileWritten', 'DmpFileWritten', 'DmgFileWritten', 'DirectoryCreate', 'DebFileWritten', 'CriticalFileModified', 'CriticalFileAccessed', 'CabFileWritten', 'BZip2FileWritten', 'BmpFileWritten', 'BlfFileWritten', 'AsepFileChange', 'ArjFileWritten', 'ArcFileWritten') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        Size = tolong(Size),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_File_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('UserLogonFailed2', 'UserLogonFailed', 'UserLogon', 'UserLogoff', 'IoSessionLoggedOn')  | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        LogonTime = todouble(LogonTime),\r\n        LogoffTime = todouble(LogoffTime),\r\n        EtwRawThreadId = tolong(EtwRawThreadId),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Auth_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('WmiCreateProcess', 'UnsignedModuleLoad', 'TerminateProcess', 'SyntheticProcessRollup2', 'ProcessSelfDeleted', 'ProcessRollup2', 'ProcessInjection', 'ProcessBlocked', 'ModuleLoadV3DetectInfo', 'FileWrittenAndExecutedInContainer', 'ExecutableDeleted', 'EndOfProcess') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),        \r\n        BoundingLimitCount = tolong(BoundingLimitCount),        \r\n        ProcessStartTime = todouble(ProcessStartTime),        \r\n        ProcessEndTime = todouble(ProcessEndTime),\r\n        FileSigningTime = todouble(FileSigningTime),\r\n        ScreenshotsTakenCount = tolong(ScreenshotsTakenCount),\r\n        NetworkListenCount = tolong(NetworkListenCount),\r\n        SuspiciousRawDiskReadCount = tolong(SuspiciousRawDiskReadCount),\r\n        NetworkBindCount = tolong(NetworkBindCount),\r\n        NetworkRecvAcceptCount = tolong(NetworkRecvAcceptCount),\r\n        NewExecutableWrittenCount = tolong(NewExecutableWrittenCount),\r\n        ExeAndServiceCount = tolong(ExeAndServiceCount),\r\n        NetworkCloseCount = tolong(NetworkCloseCount),\r\n        SuspectStackCount = tolong(SuspectStackCount),\r\n        CLICreationCount = tolong(CLICreationCount),\r\n        UnsignedModuleLoadCount = tolong(UnsignedModuleLoadCount),\r\n        UserTime = tolong(UserTime),\r\n        AllocateVirtualMemoryCount = tolong(AllocateVirtualMemoryCount),\r\n        ServiceEventCount = tolong(ServiceEventCount),\r\n        SnapshotFileOpenCount = tolong(SnapshotFileOpenCount),\r\n        RemovableDiskFileWrittenCount = tolong(RemovableDiskFileWrittenCount),\r\n        InjectedDllCount = tolong(InjectedDllCount),\r\n        UserMemoryProtectExecutableCount = tolong(UserMemoryProtectExecutableCount),\r\n        NetworkCapableAsepWriteCount = tolong(NetworkCapableAsepWriteCount),\r\n        DnsRequestCount = tolong(DnsRequestCount),\r\n        SetThreadContextCount = tolong(SetThreadContextCount),        \r\n        SuspiciousCredentialModuleLoadCount = tolong(SuspiciousCredentialModuleLoadCount),\r\n        FileDeletedCount = tolong(FileDeletedCount),\r\n        UserMemoryAllocateExecutableCount = tolong(UserMemoryAllocateExecutableCount),\r\n        NetworkConnectCountUdp = tolong(NetworkConnectCountUdp),\r\n        SuspiciousFontLoadCount = tolong(SuspiciousFontLoadCount),        \r\n        NetworkConnectCount = tolong(NetworkConnectCount),\r\n        CreateProcessCount = tolong(CreateProcessCount),        \r\n        KernelTime = tolong(KernelTime),\r\n        DirectoryEnumeratedCount = tolong(DirectoryEnumeratedCount),\r\n        SuspiciousDnsRequestCount = tolong(SuspiciousDnsRequestCount),\r\n        DocumentFileWrittenCount = tolong(DocumentFileWrittenCount),\r\n        UserMemoryProtectExecutableRemoteCount = tolong(UserMemoryProtectExecutableRemoteCount),\r\n        UserMemoryAllocateExecutableRemoteCount = tolong(UserMemoryAllocateExecutableRemoteCount),\r\n        ExecutableDeletedCount = tolong(ExecutableDeletedCount),        \r\n        InjectedThreadCount = tolong(InjectedThreadCount),\r\n        RegKeySecurityDecreasedCount = tolong(RegKeySecurityDecreasedCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Process_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ( 'RegSystemConfigValueUpdate', 'RegGenericValueUpdate') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        RegNumericValue = toint(RegNumericValue),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Registry_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ('VolumeSnapshotDeleted', 'VolumeSnapshotCreated', 'SmbServerShareOpenedEtw', 'SmbClientShareOpenedEtw', 'SmbClientShareClosedEtw', 'ProvisioningStarted', 'ProvisioningEnded', 'OsfmDownloadComplete', 'NetShareSecurityModify', 'NetShareDelete', 'NetShareAdd', 'MemoryScanEnabled', 'ManifestDownloadComplete', 'LfoUploadStart', 'FileRenameInfo', 'FileOpenInfo', 'FileDeleteInfo', 'FileCreateInfo', 'IoSessionConnected', 'IOServiceRegister', 'InstallServiceDownloadComplete', 'InstallBundleDownloadComplete', 'HostnameChanged', 'FirewallSetRule', 'FirewallEnabled', 'FirewallDisabled', 'FirewallDeleteRule', 'FirewallChangeOption', 'FileVaultStatus', 'EventLogCleared', 'DcUsbDeviceWhitelisted', 'DcUsbDeviceDisconnected', 'DcBluetoothDeviceDisconnected', 'DcBluetoothDeviceConnected', 'CriticalEnvironmentVariableChanged', 'ConfigStateUpdate', 'ActiveDirectoryAccountUnlocked', 'ActiveDirectoryAccountPasswordUpdate', 'ActiveDirectoryAccountOuUpdate', 'ActiveDirectoryAccountNameUpdate', 'ActiveDirectoryAccountLocked', 'ActiveDirectoryAccountEnabled', 'ActiveDirectoryAccountDisabled', 'ActiveDirectoryAccountDepartmentUpdate', 'ActiveDirectoryAccountCreated') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        FileVaultIsEnabled = tobool(FileVaultIsEnabled),\r\n        AttemptNumber = tolong(AttemptNumber),\r\n        DeviceTimeStamp = todouble(DeviceTimeStamp),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Audit_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdstrikeStream"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| where event_simpleName in ( 'UserAccountDeleted', 'UserAccountCreated', 'UserAccountAddedToGroup') | extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']\r\n| extend \r\n        timestamp = tolong(timestamp),\r\n        ContextTimeStamp = todouble(ContextTimeStamp),\r\n        BoundingLimitCount = tolong(BoundingLimitCount),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_User_Events_CL"
                },
                {
                    "streams": [
                        "Custom-CrowdStrikeSecondary"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source\r\n| extend TimeGenerated = now(),\r\n        AdditionalFields = todynamic(AdditionalFields)",
                    "outputStream": "Custom-CrowdStrike_Secondary_Data_CL"
                }
            ],
            "dataCollectionEndpointId": "[concat('/subscriptions/',variables('subscriptionID'),'/resourceGroups/',resourceGroup().name,'/providers/Microsoft.Insights/dataCollectionEndpoints/',{{dataCollectionEndpointId}}"
        }
    }
]