{
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "apiVersion": "2022-09-01-preview",
    "name": "ZoomReportsUsingRESTAPI",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
      "connectorUiConfig": {
        "id": "ZoomReportsUsingRESTAPI",
        "title": "Zoom Reports (using REST API)",
        "publisher": "Microsoft",
        "descriptionMarkdown": "The [Zoom Reports](https://zoom.us) data connector provides the capability to ingest [Zoom Report events](https://developers.zoom.us/docs/api/rest/reference/zoom-api/methods/#tag/Reports) into Microsoft Sentinel.",
       
        "graphQueries": [
          {
            "metricName": "Total Zoom Operation logs received",
            "legend": "Zoom Operation logs",
            "baseQuery": "Zoom_Operations_CL"
          },
          {
            "metricName": "Total Zoom Activity logs received",
            "legend": "Zoom Activity logs",
            "baseQuery": "Zoom_Activities_CL"
          },
          {
            "metricName": "Total Zoom User logs received",
            "legend": "Zoom User logs",
            "baseQuery": "Zoom_Users_CL"
          },
          {
            "metricName": "Total Zoom Cloud Recording logs received",
            "legend": "Zoom Cloud Recording logs",
            "baseQuery": "Zoom_CloudRecordings_CL"
          },
          {
            "metricName": "Total Zoom Daily Report logs received",
            "legend": "Zoom Daily Report logs",
            "baseQuery": "Zoom_DailyReports_CL"
          },
          {
            "metricName": "Total Zoom telephone Report logs received",
            "legend": "Zoom telephone Report log",
            "baseQuery": "Zoom_TelephoneReports_CL"
          }
        ],
        "sampleQueries": [
          {
            "description": "Get a sample of Zoom Operation logs",
            "query": "Zoom_Operations_CL\n| take 10"
          },
          {
            "description": "Get a sample of Zoom Activity logs",
            "query": "Zoom_Activities_CL\n| take 10"
          },
          {
            "description": "Get a sample of Zoom User logs",
            "query": "Zoom_Users_CL\n| take 10"
          },
          {
            "description": "Get a sample of Zoom Cloud Recording logs",
            "query": "Zoom_CloudRecordings_CL\n| take 10"
          },
          {
            "description": "Get a sample of Zoom Daily Report logs",
            "query": "Zoom_DailyReports_CL\n| take 10"
          },
          {
            "description": "Get a sample of Zoom Telephone Report logs",
            "query": "Zoom_TelephoneReports_CL\n| take 10"
          }
        ],
        "dataTypes": [
          {
            "name": "Zoom_Operations_CL",
            "lastDataReceivedQuery": "{{graphQueriesTableName}}\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
          },
          {
            "name": "Zoom_Activities_CL",
            "lastDataReceivedQuery": "Zoom_Activities_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
          },
          {
            "name": "Zoom_Users_CL",
            "lastDataReceivedQuery": "Zoom_Users_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
          },
          {
            "name": "Zoom_TelephoneReports_CL",
            "lastDataReceivedQuery": "Zoom_TelephoneReports_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
          },
          {
            "name": "Zoom_CloudRecordings_CL",
            "lastDataReceivedQuery": "Zoom_CloudRecordings_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
          },
          {
            "name": "Zoom_DailyReports_CL",
            "lastDataReceivedQuery": "Zoom_DailyReports_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
          }
          
        ],
        "connectivityCriteria": [
          {
            "type": "HasDataConnectors"
          }
        ],
        "availability": {
          "isPreview": false
        },
        "permissions": {
          "resourceProvider": [
            {
              "provider": "Microsoft.OperationalInsights/workspaces",
              "permissionsDisplayText": "Read and Write permissions are required.",
              "providerDisplayName": "Workspace",
              "scope": "Workspace",
              "requiredPermissions": {
                "write": true,
                "read": true,
                "delete": true
              }
            }
          ],
          "customs": [
            {
              "name": "Zoom API access",
              "description": "Access to the Zoom API through a service principal is required."
            }
          ]
        },
        "instructionSteps": [
          {
            "description": "Connect to Zoom API to start collecting logs in Microsoft Sentinel",
            "instructions": [
              {
                "type": "Textbox",
                "parameters": {
                  "label": "Account ID",
                  "placeholder": "Account ID",
                  "type": "securestring",
                  "name": "accountId"
                }
              },
              {
                "type": "OAuthForm",
                "parameters": {
                  "clientIdLabel": "Client ID",
                  "clientSecretLabel": "Client Secret",
                  "connectButtonLabel": "Connect",
                  "disconnectButtonLabel": "Disconnect"
                }
              },
              {
                "type": "DataConnectorsGrid",
                "parameters": {
                  "mapping": [
                    {
                      "columnName": "Zoom Api Endpoints",
                      "columnValue": "properties.request.apiEndpoint"
                    }
                  ],
                  "menuItems": [
                    "DeleteConnector"
                  ]
                }
              }
            ],
            "title": "Connect to Zoom API to start collecting logs in Microsoft Sentinel"
          }
        ]
      }
    }
  }
  