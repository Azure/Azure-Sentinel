id: 1e5f6c7d-8e9f-0a1b-2c3d-4e5f6a7b8c9d
name: SOCRadar Audit Analysis
description: |
  Monitors SOCRadar import and sync operations via audit logs.
  Identifies failed operations that may require investigation.
severity: Medium
requiredDataConnectors:
  - connectorId: SOCRadar
    dataTypes:
      - SOCRadarAuditLog_CL
tactics:
  - Collection
relevantTechniques: []
query: |
  SOCRadarAuditLog_CL
  | where TimeGenerated > ago(24h)
  | summarize
      TotalOps = count(),
      Imported = countif(EventType == "AlarmImported"),
      Synced = countif(EventType == "AlarmSynced"),
      Errors = countif(EventType == "Error"),
      Failed = countif(OperationStatus == "Failed")
  | extend HealthStatus = iff(Failed > 0 or Errors > 0, "Degraded", "Healthy")
