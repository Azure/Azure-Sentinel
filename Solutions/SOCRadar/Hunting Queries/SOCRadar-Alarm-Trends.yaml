id: 9c3f4c5d-6e7f-8a9b-0c1d-2e3f4a5b6c7d
name: SOCRadar Alarm Trends
description: |
  Week-over-week comparison of alarm volumes by type.
  Helps identify emerging threats and trend changes.
severity: Informational
requiredDataConnectors:
  - connectorId: SOCRadar
    dataTypes:
      - SOCRadar_Alarms_CL
tactics:
  - Discovery
relevantTechniques: []
query: |
  SOCRadar_Alarms_CL
  | where TimeGenerated > ago(14d)
  | summarize
      ThisWeek = countif(TimeGenerated > ago(7d)),
      LastWeek = countif(TimeGenerated between (ago(14d) .. ago(7d)))
      by AlarmMainType
  | extend
      Change = ThisWeek - LastWeek,
      ChangePercent = iff(LastWeek > 0, round(100.0 * (ThisWeek - LastWeek) / LastWeek, 1), 0.0)
  | order by Change desc
