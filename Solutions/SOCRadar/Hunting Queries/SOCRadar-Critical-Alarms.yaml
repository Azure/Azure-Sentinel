id: 8b2f3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
name: SOCRadar Critical Alarms Not Yet Closed
description: |
  Identifies high and critical severity SOCRadar alarms that have not been closed in Sentinel.
  Use this to find alarms requiring immediate attention.
severity: High
requiredDataConnectors:
  - connectorId: SOCRadar
    dataTypes:
      - SOCRadar_Alarms_CL
tactics:
  - Impact
relevantTechniques: []
query: |
  SOCRadar_Alarms_CL
  | where TimeGenerated > ago(7d)
  | where Severity in ("HIGH", "CRITICAL")
  | join kind=leftanti (
      SecurityIncident
      | where Status == "Closed"
      | where Title contains "[SOCRadar]"
      | extend AlarmId = extract(@"#(\d+)", 1, Title)
  ) on AlarmId
  | project
      TimeGenerated,
      AlarmId,
      Severity,
      Title,
      AlarmMainType,
      AlarmSubType,
      DaysOpen = datetime_diff('day', now(), TimeGenerated)
  | order by Severity, DaysOpen desc
