{
    "name": "HalcyonPush",
    "apiVersion": "2025-07-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
      "connectorUiConfig": {
        "id": "HalcyonPush",
        "title": "Halcyon Connector",
        "publisher": "Halcyon",
        "logo": "halcyon.svg",
        "descriptionMarkdown": "The [Halcyon](https://www.halcyon.ai) connector provides the capability to send data from Halcyon to Microsoft Sentinel.",
        "graphQueries": [
          {
            "metricName": "Authentication Events",
            "legend": "HalcyonAuthenticationEvents_CL",
            "baseQuery": "HalcyonAuthenticationEvents_CL"
          },
          {
            "metricName": "DNS Activity",
            "legend": "HalcyonDnsActivity_CL",
            "baseQuery": "HalcyonDnsActivity_CL"
          },
          {
            "metricName": "File Activity",
            "legend": "HalcyonFileActivity_CL",
            "baseQuery": "HalcyonFileActivity_CL"
          },
          {
            "metricName": "Network Sessions",
            "legend": "HalcyonNetworkSession_CL",
            "baseQuery": "HalcyonNetworkSession_CL"
          },
          {
            "metricName": "Process Events",
            "legend": "HalcyonProcessEvent_CL",
            "baseQuery": "HalcyonProcessEvent_CL"
          }
        ],
        "sampleQueries": [
          {
            "description": "Get Sample Authentication Events",
            "query": "HalcyonAuthenticationEvents_CL\n | take 10"
          },
          {
            "description": "Get Sample DNS Activity",
            "query": "HalcyonDnsActivity_CL\n | take 10"
          },
          {
            "description": "Get Sample File Activity",
            "query": "HalcyonFileActivity_CL\n | take 10"
          },
          {
            "description": "Get Sample Network Sessions",
            "query": "HalcyonNetworkSession_CL\n | take 10"
          },
          {
            "description": "Get Sample Process Events",
            "query": "HalcyonProcessEvent_CL\n | take 10"
          }
        ],
        "dataTypes": [
          {
            "name": "Halcyon Authentication Events",
            "lastDataReceivedQuery": "HalcyonAuthenticationEvents_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
          },
          {
            "name": "Halcyon DNS Activity",
            "lastDataReceivedQuery": "HalcyonDnsActivity_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
          },
          {
            "name": "Halcyon File Activity",
            "lastDataReceivedQuery": "HalcyonFileActivity_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
          },
          {
            "name": "Halcyon Network Sessions",
            "lastDataReceivedQuery": "HalcyonNetworkSession_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
          },
          {
            "name": "Halcyon Process Events",
            "lastDataReceivedQuery": "HalcyonProcessEvent_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
          }
        ],
        "connectivityCriteria": [
          {
            "type": "HasDataConnectors"
          }
        ],
        "availability": {
          "isPreview": true
        },
        "permissions": {
          "resourceProvider": [
            {
              "provider": "Microsoft.OperationalInsights/workspaces",
              "permissionsDisplayText": "Read and Write permissions are required.",
              "providerDisplayName": "Workspace Permissions",
              "scope": "Workspace",
              "requiredPermissions": {
                "write": true,
                "read": true,
                "delete": false
              }
            }
          ],
          "customs": [
            {
              "name": "Microsoft Entra Create Permissions",
              "description": "Permissions to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
            },
            {
              "name": "Role Assignment Permissions",
              "description": "Write permissions required to assign Monitoring Metrics Publisher role to the data collection rule (DCR). Typically requires Owner or User Access Administrator role at the resource group level."
            }
          ]
        },
        "instructionSteps": [
          {
            "title": "1. Create ARM Resources and Provision Required Permissions",
            "description": "This connector reads data from the tables that Halcyon uses in a Microsoft Analytics Workspace, if the data is being forwarded",
            "instructions": [
              {
                "type": "Markdown",
                "parameters": {
                  "content": "#### Automated Configuration and Secure Data Ingestion with Entra Application \nClicking on \"Deploy\" will trigger the creation of Log Analytics tables and a Data Collection Rule (DCR). \nIt will then create an Entra application, link the DCR to it, and set the entered secret in the application. This setup enables data to be sent securely to the DCR using an Entra token."
                }
              },
              {
                "parameters": {
                  "label": "Deploy Halcyon Connector Resources",
                  "applicationDisplayName": "Halcyon Connector Application"
                },
                "type": "DeployPushConnectorButton"
              }
            ]
          },
          {
            "title": "2. Configured your integration in the Halcyon Platform",
            "description": "Use the following parameters to configure your integration in the Halcyon Platform.",
            "instructions": [
              {
                "parameters": {
                  "label": "Directory ID (Tenant ID)",
                  "fillWith": [
                    "TenantId"
                  ]
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "label": "Entra App Registration Application ID (Client ID)",
                  "fillWith": [
                    "ApplicationId"
                  ],
                  "placeholder": "Deploy the Push Connector to get the App Registration Application ID"
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "label": "Entra App Registration Secret (Credential Secret) (THIS SECRET WILL NOT BE VISIBLE AFTER LEAVING THIS PAGE)",
                  "fillWith": [
                    "ApplicationSecret"
                  ],
                  "placeholder": "Deploy the Push Connector to get the App Registration Secret"
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "label": "Data Collection Endpoint (URL)",
                  "fillWith": [
                    "DataCollectionEndpoint"
                  ],
                  "placeholder": "Deploy the Push Connector to get the Data Collection Endpoint"
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "label": "Data Collection Rule Immutable ID (Rule ID)",
                  "fillWith": [
                    "DataCollectionRuleId"
                  ],
                  "placeholder": "Deploy the Push Connector to get the Data Collection Rule ID"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      }
    }
  }