{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "``` \r\nVersion: 1.0.1\r\nAuthor: aaron.hoffmann@reversinglabs.com\r\n```\r\n"
            },
            "conditionalVisibility": {
              "parameterName": "showWorkbookInfo",
              "comparison": "isNotEqualTo"
            },
            "name": "text - 2"
          },
          {
            "type": 1,
            "content": {
              "json": "<svg x=\"0px\" y=\"0px\"\r\n\t viewBox=\"0 150 1541.9 295.3\" style=\"enable-background:new 0 0 1241.9 295.3; background:white\" xml:space=\"preserve\">\r\n<g>\r\n\t<g>\r\n\t\t<path class=\"st0\" style=\"fill:#F6143F\" d=\"M279.3,303.1h-30.8l-27.9,92.2H173v-92.2h-20.6v109.6h84l9.7-30.7h35.2l9.4,30.7h22.5L279.3,303.1z M250,365\r\n\t\t\tl9.3-30.2c1.6-5.5,2.7-11.4,3.8-17.3h1.3c1,5.9,2.2,11.8,3.8,17.3l9.1,30.2H250z\"/>\r\n\t\t<path class=\"st0\" style=\"fill:#F6143F\" d=\"M349.8,413.5c-12.5,0-17.8-0.3-31.7-0.9V303.1c14.5-0.6,19.8-0.9,32.3-0.9c29.3,0,47.5,5.2,47.5,29.8v1.3\r\n\t\t\tc0,9.4-4.1,18.6-13.9,23c10.3,4.3,14.5,13.7,14.5,23.1v1.5C398.5,408.3,378.1,413.5,349.8,413.5 M377.8,332.7\r\n\t\t\tc0-12.5-9.9-13.6-27.4-13.6h-12.2v29.7h18.6c17,0,21.1-5.6,21.1-14.7V332.7z M378.3,379.3c-0.1-9.6-4.6-15.6-21.4-15.6h-18.7v32.9\r\n\t\t\th5.6c22.4,0,34.5-0.1,34.5-15.6V379.3z\"/>\r\n\t\t<path class=\"st0\" style=\"fill:#F6143F\" d=\"M446,415c-14.3,0-29.1-1.9-34.5-3.4v-15.8c9,0.9,19.2,1.8,32.9,1.8c13.3,0,19.6-3.7,19.6-13.6\r\n\t\t\tc0-7.1-2.8-11.1-13.7-15.6l-16.5-6.8c-16.2-6.6-24.9-15.9-24.9-31.9c0-21.2,13.3-28.9,39.2-28.9c13.8,0,26.8,2.2,32,3.5V320\r\n\t\t\tc-8.4-0.7-19.6-1.9-31.1-1.9c-12.8,0-19.8,2.2-19.8,11.1c0,6.6,3.1,10,14,14.5l14.9,6.1c19.2,7.8,26.8,15.6,26.8,34.2\r\n\t\t\tC484.9,403.8,470.6,415,446,415\"/>\r\n\t</g>\r\n\t<g>\r\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M52.9,292.1l25.8-44.7c-11.7-5-18.9-13.7-18.9-30.4v-1c0-28.9,21.8-34.2,48.2-34.2c11.1,0,21,0.3,30.7,0.7\r\n\t\t\tv109.6h-20.1v-40.4h-10.2c-3.4,0-6.6,0-9.6-0.1l-24.2,40.6H52.9z M80,217.2c0,14.2,8.4,18.1,27.3,18.1c3.8,0,7.5,0,11.4-0.2v-36\r\n\t\t\tc-26.8,0-38.6,0.2-38.6,17.1V217.2z\"/>\r\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M291.5,182.5l-22.6,75.9c-1.9,6.4-3.2,13.7-4.4,19.6h-0.3c-1.5-5.8-2.5-13.3-4.4-19.6l-22.6-75.9h-84.9v109.6\r\n\t\t\th69.8v-16.9H173V244h46v-16.5h-46v-27.9h48.1l27.9,92.5h30.1l33.2-109.6H291.5z\"/>\r\n\t\t<polygon class=\"st1\" style=\"fill:#231F20\" points=\"318,292.1 318,182.5 387.7,182.5 387.7,199.6 338.6,199.6 338.6,227.5 384.6,227.5 384.6,244 \r\n\t\t\t338.6,244 338.6,275.1 387.7,275.1 387.7,292.1 \t\t\"/>\r\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M463.7,292.1l-24.2-40.5c-2.9,0.1-6.2,0.1-9.6,0.1h-10.2v40.4h-20.1V182.5c9.7-0.4,19.6-0.7,30.7-0.7\r\n\t\t\tc26.4,0,48.2,5.3,48.2,34.2v1c0,16.7-7.2,25.4-18.9,30.4l25.8,44.7H463.7z M458.4,216.3c0-17-11.8-17.1-38.6-17.1v36\r\n\t\t\tc3.8,0.2,7.5,0.2,11.4,0.2c18.9,0,27.3-4,27.3-18.1V216.3z\"/>\r\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M525.1,294.5c-14.3,0-29.1-1.9-34.5-3.4v-15.8c9,0.9,19.2,1.8,32.9,1.8c13.3,0,19.6-3.7,19.6-13.6\r\n\t\t\tc0-7.1-2.8-11.1-13.7-15.6l-16.5-6.8c-16.2-6.6-24.9-15.9-24.9-31.9c0-21.2,13.3-28.9,39.2-28.9c13.9,0,26.8,2.2,32,3.5v15.6\r\n\t\t\tc-8.4-0.7-19.6-1.9-31.1-1.9c-12.8,0-19.8,2.2-19.8,11.1c0,6.6,3.1,10,14,14.5l14.9,6c19.2,7.8,26.8,15.6,26.8,34.2\r\n\t\t\tC564,283.2,549.7,294.5,525.1,294.5\"/>\r\n\t\t<rect x=\"573\" y=\"182.5\" class=\"st1\" style=\"fill:#231F20\" width=\"20.6\" height=\"109.6\"/>\r\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M671.5,292.1l-35.1-65c-2.7-5-5.8-10.9-8.3-16.4h-0.3c0.3,6.2,0.6,13,0.6,19.6v61.8h-18.9V182.5h23.9l35,63.7\r\n\t\t\tc2.6,5,6,11.4,8.4,16.7h0.3c-0.5-6.5-0.6-14.2-0.6-20.8v-59.6h19v109.6H671.5z\"/>\r\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M753.2,294.5c-25.1,0-45.9-9.7-45.9-49.4v-15.5c0-41.9,23.6-49.3,46.3-49.3c16.1,0,31.9,2.7,35.2,3.7v15.8\r\n\t\t\tc-7.1-0.6-24.2-1.5-31.7-1.5c-17.8,0-29.3,4-29.3,31.3V245c0,25.1,9.1,31.4,26.8,31.4c5.5,0,10.9-0.2,14.7-0.4v-26.6l-8.4,0v-15.7\r\n\t\t\th28v57.4C783,292.4,769,294.5,753.2,294.5\"/>\r\n\t</g>\r\n</g>\r\n</svg>\r\n"
            },
            "customWidth": "50",
            "name": "text - 1"
          },
          {
            "type": 1,
            "content": {
              "json": "# Welcome to ReversingLabs for Microsoft Sentinel!\r\n\r\nThank you for activating ReversingLabs' solution for Microsoft Sentinel. In this workbook you will find a summary of the capabilities of ReversingLabs' Microsoft Sentinel content.\r\n\r\nClick the \"More information\" tab to view our offers in the Azure Marketplace."
            },
            "customWidth": "50",
            "name": "welcome",
            "styleSettings": {
              "padding": "20px",
              "showBorder": true
            }
          }
        ]
      },
      "name": "header group"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "e800163c-e34f-4e3a-a131-2376ea998b85",
            "version": "KqlParameterItem/1.0",
            "name": "guide",
            "label": "ðŸ”ŽGuide",
            "type": 10,
            "isRequired": true,
            "isGlobal": true,
            "value": "Yes",
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\"Yes\", \"No\"]",
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "cc8e1a84-7479-4eb2-aa5a-d95ee81bc962",
            "version": "KqlParameterItem/1.0",
            "name": "subscription",
            "label": "ðŸ—ï¸Subscription",
            "type": 6,
            "value": "",
            "typeSettings": {
              "additionalResourceOptions": [],
              "includeAll": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "1231613d-d734-40da-8baf-c55fdee75df1",
            "version": "KqlParameterItem/1.0",
            "name": "workspace",
            "label": "Workspace",
            "type": 5,
            "value": "",
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.operationalinsights/workspaces": true
              },
              "additionalResourceOptions": []
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "46ef1dfe-ea81-413c-a410-1ea67b7e61ab",
            "version": "KqlParameterItem/1.0",
            "name": "timerange",
            "label": "â±ï¸Time Range",
            "type": 4,
            "isRequired": true,
            "isGlobal": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "3e436b2e-1d8c-43e5-8973-9dbe95d5b4d1",
            "version": "KqlParameterItem/1.0",
            "name": "rl_feed_check",
            "type": 1,
            "description": "Grabs list of TI sources and checks for a ReversingLabs feed",
            "query": "ThreatIntelligenceIndicator\r\n| where Tags contains \"ReversingLabs\"\r\n| summarize count()\r\n| extend rl_feed_exists = iff(count_ > 0, \"true\", \"false\")\r\n| project rl_feed_exists",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "timerange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "c089844b-0cd0-4a36-b056-f21cecc1e340",
            "version": "KqlParameterItem/1.0",
            "name": "analyst_salary",
            "type": 1,
            "description": "Used to calculate automation savings in $ amount",
            "isGlobal": true,
            "query": "print salary = 90000",
            "value": "90000",
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "7b067269-07aa-43aa-8211-df299811d6d4",
            "version": "KqlParameterItem/1.0",
            "name": "offer",
            "type": 1,
            "isGlobal": true,
            "value": "offer1",
            "isHiddenWhenLocked": true
          },
          {
            "id": "d5bd670d-29fe-4ab9-9a17-f152e731ab5e",
            "version": "KqlParameterItem/1.0",
            "name": "ti_feed_check",
            "type": 1,
            "description": "Checks if there are any items in the ThreatIntelligenceIndicators table in the selected workspace",
            "query": "ThreatIntelligenceIndicator\r\n| summarize count()\r\n| extend ti_check = iff(count_ > 0, \"true\", \"false\")\r\n| project ti_check",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "timerange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 2"
    },
    {
      "type": 1,
      "content": {
        "json": "# How to use this workbook\r\n\r\nThis workbook is designed to give you a summary of your Microsoft Sentinel workspace. You'll find details about your implementation of the Threat Intelligence feature and your operations within Sentinel. \r\n\r\nEnsure that you set the Subscription and Workspace parameters with values associated with your Sentinel workspace.\r\n\r\nTo hide all informational messages, change the Guide parameter to \"No\"",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "guide",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "text - 6"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "tabStyle": "bigger",
        "links": [
          {
            "id": "9f5bb9c2-95a4-4825-9b58-cda448650a8d",
            "cellValue": "section",
            "linkTarget": "parameter",
            "linkLabel": "Threat Intelligence",
            "subTarget": "ti",
            "preText": "",
            "style": "primary"
          },
          {
            "id": "5f16aeff-f8a3-40eb-9101-4cd932beb2ff",
            "cellValue": "section",
            "linkTarget": "parameter",
            "linkLabel": "Operations",
            "subTarget": "operations",
            "preText": "",
            "style": "primary"
          },
          {
            "id": "8e99b95f-7ab5-415c-b31d-5afdb4240e5f",
            "cellValue": "section",
            "linkTarget": "parameter",
            "linkLabel": "More Information",
            "subTarget": "info",
            "style": "link"
          }
        ]
      },
      "name": "links - 5"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Your Threat Intel Summary\r\n"
            },
            "name": "text - 0"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Threat Intel Executive Summary"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "**You could be getting more from your Threat Intelligence feeds!**",
                    "style": "upsell"
                  },
                  "conditionalVisibility": {
                    "parameterName": "rl_feed_check",
                    "comparison": "isEqualTo",
                    "value": "false"
                  },
                  "name": "text - 8"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "The ReversingLabs Ransomware Intel Feed injects indicators curated specifically to hunt ransomware. Our indicators are harvested from confirmed malware and vetted for accuracy, enhanced with additional intel, and evaluated for activeness. This provides your Sentinel deployment with dynamic CTI to hunt ransomware in every stage of the ransomware lifecycle.\r\n\r\n**Unlock the unlimited potential of Sentinel with an unmatched high-quality CTI dataset to protect your organization from ransomware**\r\n\r\n- <ins>Ransomware Focused Intelligence</ins> - Indicators harvested from the +2.5 million confirmed, unique malware files analyzed every day producing a wealth of ransomware-related datasets.\r\n- <ins>Focus on the Hunt</ins> - All indicators are enriched with metadata from the perceived vulnerability exploitation techniques, eliminating the need for manual technique identification and tagging.\r\n- <ins>Lower Alert Fatigue</ins> - All indicators are strictly vetted and curated to ensure indicators are not only accurate but active within the last 30 days, eliminating false positives.\r\n- <ins>Policy Driven by Intelligence</ins> - With indicators harvested from active, confirmed malware these indicators can be pushed to short-term policy with confidence.\r\n\r\n**[Click here to view the ReversingLabs Ransomware Threat Intel Feed in the Azure Marketplace](https://portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/reversinglabs1597673283347.rw_feed_offer0/product~/%7B%22displayName%22%3A%22ReversingLabs%20-%20Early%20Detection%20of%20Ransomware%20for%20Sentinel%22%2C%22itemDisplayName%22%3A%22ReversingLabs%20-%20Early%20Detection%20of%20Ransomware%20for%20Sentinel%22%2C%22id%22%3A%22reversinglabs1597673283347.rw_feed_offer0%22%2C%22bigId%22%3A%22DZH318Z0J1ZC%22%2C%22offerId%22%3A%22rw_feed_offer0%22%2C%22publisherId%22%3A%22reversinglabs1597673283347%22%2C%22publisherDisplayName%22%3A%22ReversingLabs%22%2C%22longSummary%22%3A%22Detect%20ransomware%20hiding%20in%20your%20network%20waiting%20for%20attackers%20to%20initiate%20an%20encryption%20campaign%22%2C%22description%22%3A%22%3Cdiv%3E%3Cb%3E%3Cbr%3E%3C%2Fb%3E%3C%2Fdiv%3E%3Ch5%3E%3Cb%3EI%20AM%20RANSOMWARE%3C%2Fb%3E%3C%2Fh5%3E%3Cpre%3EI%20came%20in%20through%20your%20%3Ci%3E%3Cb%3Eredacted%3C%2Fb%3E%3C%2Fi%3E%20and%20%3C%2Fpre%3E%3Cpre%3EI%20have%20already%20communicated%20to%20my%20team%20that%20I'm%20in...%20%20%3C%2Fpre%3E%3Cpre%3Enow%20I%20%3Ci%3Ewait%3C%2Fi%3E.%3C%2Fpre%3E%3Cpre%3E%3Cpre%3EIt%20could%20be%20a%20day%2C%20it%20could%20be%20a%20month%2C%20%3C%2Fpre%3E%3Cpre%3Ebut%20I%20am%20waiting%20for%20the%20moment%20when%20we're%20positioned%20%3C%2Fpre%3E%3Cpre%3Efor%20mass%20effect.%20%3C%2Fpre%3E%3Cpre%3EThe%20only%20thing%20that%20can%20stop%20what's%20happening%20is%20%3C%2Fpre%3E%3Cpre%3Eif%20one%20of%20my%20copies%20gets%20busted%20and%20gives%20up%20its%20code%20%3C%2Fpre%3E%3Cpre%3Eand%20my%20indicators%20get%20put%20into%20a%20list%20to%20watch%20out%20for.%3C%2Fpre%3E%3Cpre%3E%3Cbr%3ENot%20worried%20about%20that%2C%20ain't%20too%20many%20creating%20that%20kind%20of%20info...%3C%2Fpre%3E%3C%2Fpre%3E%3Cdiv%3E%3Cbr%3E%3C%2Fdiv%3E%3Cp%3E%3Cb%3EThreat%20Actor%20Overview%3C%2Fb%3E%3C%2Fp%3E%3Cdiv%3E%3Cspan%3E%3C%2Fspan%3EThreat%20actors%20have%20significantly%20increased%20the%20complexity%20of%20their%20operations%20to%20the%20point%20where%20they're%20run%20like%20a%20business%20to%20ensure%20efforts%20are%20coordinated%20and%20efficient.%20They%20work%20tirelessly%20to%20create%20malicious%20code%20that%20hides%20in%20plain%20site%20and%20avoids%20modern%20detection%20methods%20and%20they're%20not%20going%20to%20initiate%20the%20final%20phase%20of%20attack%20until%20they're%20positioned%20to%20maximize%20their%20effectiveness.%3C%2Fdiv%3E%3Cdiv%3EThis%20provides%20you%20with%20precious%20time%20that%20can%20be%20used%20to%20seek%2C%20identify%2C%20and%20remove%20ransomware%20waiting%20to%20be%20detonated.%3C%2Fdiv%3E%3Cdiv%3E%3Cbr%3E%3C%2Fdiv%3E%3Cp%3E%3Cb%3ESolution%20Overview%3C%2Fb%3E%3C%2Fp%3E%3Cdiv%3E%3Cspan%3E%3C%2Fspan%3EEnter%20ReversingLabs%20Ransomware%20Intel%20Feed%20for%20the%20Sentinel%20TAXII%20data%20connector%20that%20injects%20indicators%20%3Cb%3Ecurated%20specifically%20to%20hunt%20ransomware%3C%2Fb%3E%20into%20your%20Threat%20Intelligence%20blade.%20%20Our%20indicators%20are%20harvested%20from%20confirmed%20malware%20and%20vetted%20for%20accuracy%2C%20enhanced%20with%20additional%20intel%2C%20and%20evaluated%20for%20activeness.%20This%20provides%20your%20Sentinel%20deployment%20with%20dynamic%20CTI%20to%20hunt%20ransomware%20in%20every%20stage%20of%20the%20ransomware%20lifecycle.%3C%2Fdiv%3E%3Cdiv%3E%3Cb%3E%3Cbr%3E%3C%2Fb%3E%3C%2Fdiv%3E%3Cblockquote%3E%3Cb%3EUnlock%20the%20unlimited%20potential%20of%20Sentinel%20with%20an%20unmatched%20high-quality%20CTI%20dataset%20to%20protect%20your%20organization%20from%20ransomware%3C%2Fb%3E%3Cbr%3E%3C%2Fblockquote%3E%3Cdiv%3E%3Cspan%3E%3C%2Fspan%3E%3C%2Fdiv%3E%3Cul%3E%3Cul%3E%3Cli%3E%3Cu%3ERansomware%20Focused%20Intelligence%3C%2Fu%3E%20-%20Indicators%20harvested%20from%20the%20%2B2.5%20million%20confirmed%2C%20unique%20malware%20files%20analyzed%20every%20day%20producing%20a%20wealth%20of%20ransomware-related%20datasets.%3C%2Fli%3E%3Cli%3E%3Cu%3EFocus%20on%20the%20Hunt%3C%2Fu%3E%20-%20All%20indicators%20are%20enriched%20with%20metadata%20from%20the%20perceived%20vulnerability%20exploitation%20techniques%2C%20eliminating%20the%20need%20for%20manual%20technique%20identification%20and%20tagging.%3C%2Fli%3E%3Cli%3E%3Cu%3ELower%20Alert%20Fatigue%3C%2Fu%3E%20-%20All%20indicators%20are%20strictly%20vetted%20and%20curated%20to%20ensure%20indicators%20are%20not%20only%20accurate%20but%20active%20within%20the%20last%2030%20days%2C%20eliminating%20false%20positives.%3C%2Fli%3E%3Cli%3E%3Cu%3EPolicy%20Driven%20by%20Intelligence%3C%2Fu%3E%20-%20With%20indicators%20harvested%20from%20active%2C%20confirmed%20malware%20these%20indicators%20can%20be%20pushed%20to%20short-term%20policy%20with%20confidence.%3C%2Fli%3E%3C%2Ful%3E%3C%2Ful%3E%3Cdiv%3E%3Cbr%3E%3C%2Fdiv%3E%22%2C%22isPrivate%22%3Afalse%2C%22hasPrivateOffer%22%3Afalse%2C%22isMacc%22%3Afalse%2C%22isPreview%22%3Afalse%2C%22isByol%22%3Afalse%2C%22isCSPEnabled%22%3Afalse%2C%22isCSPSelective%22%3Afalse%2C%22isThirdParty%22%3Atrue%2C%22isStopSell%22%3Afalse%2C%22isReseller%22%3Afalse%2C%22hasFreeTrials%22%3Atrue%2C%22marketingMaterial%22%3A%5B%5D%2C%22legalTermsUri%22%3A%22https%3A%2F%2Fgo.microsoft.com%2Ffwlink%2F%3Flinkid%3D2041178%22%2C%22privacyPolicyUri%22%3A%22https%3A%2F%2Fwww.reversinglabs.com%2Fprivacy-policy%22%2C%22version%22%3A%22f42cba0e-b2ee-4856-aae2-f38c323f0a15%22%2C%22metadata%22%3A%7B%22leadGeneration%22%3A%7B%22productId%22%3Anull%7D%2C%22testDrive%22%3Anull%7D%2C%22categoryIds%22%3A%5B%22security%22%2C%22threat-protection%22%2C%22azureCertified%22%2C%22fromPublishingPortal%22%5D%2C%22screenshotUris%22%3A%5B%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.1058.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.09093d5c-d51d-4f56-b40d-0d4da0a7cde6%22%2C%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.57732.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.15c00869-f45a-441d-b99b-845ef100eb0b%22%5D%2C%22videos%22%3A%5B%7B%22caption%22%3A%22Anatomy%20of%20a%20Ransomware%20Attack%22%2C%22uri%22%3A%22https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DIfQdAtn1hZM%22%2C%22videoPurpose%22%3A%22trailer%22%2C%22previewImage%22%3A%7B%22caption%22%3A%22Anatomy%20of%20a%20Ransomware%20Attack%22%2C%22uri%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.46826.4eb982c2-6c68-4d75-88e6-40aef3130a0e.ddd10bff-7cc8-485e-85c0-a277b390c888.775474f3-8258-4912-ae16-cba2cb4b60ac%22%2C%22imagePurpose%22%3A%22trailer%22%7D%7D%5D%2C%22links%22%3A%5B%7B%22id%22%3A%22ReversingLabs%20Ransomware%20Feed%20Product%20Landing%20Page%22%2C%22displayName%22%3A%22ReversingLabs%20Ransomware%20Feed%20Product%20Landing%20Page%22%2C%22uri%22%3A%22https%3A%2F%2Fwww.reversinglabs.com%2Fsolutions%2Fransomware-feed%22%7D%5D%2C%22filters%22%3A%5B%5D%2C%22plans%22%3A%5B%7B%22id%22%3A%220004%22%2C%22displayName%22%3A%22Ransomware%20Intel%20Feed%22%2C%22description%22%3A%22The%20ReversingLabs%20Ransomware%20Intel%20Feed%20for%20Microsoft%20Sentinel%20offered%20as%20month%20to%20month%20subscription%20or%20annual%20subscription.%20For%20a%20limited%20time%20only%20to%20mark%20the%20launch%20on%20this%20marketplace%20we%20are%20offering%20a%20substantial%20discount%20on%20annual%20plans.%20The%20discount%20is%20reflected%20in%20this%20listing.%22%2C%22restrictedAudience%22%3A%7B%7D%2C%22skuId%22%3A%220004%22%2C%22planId%22%3A%22tctf-0001-01%22%2C%22legacyPlanId%22%3A%22reversinglabs1597673283347.rw_feed_offer0tctf-0001-01%22%2C%22keywords%22%3A%5B%5D%2C%22type%22%3A%22SaaS%22%2C%22leadGeneration%22%3A%7B%22productId%22%3A%22reversinglabs1597673283347.rw_feed_offer0%22%7D%2C%22testDrive%22%3Anull%2C%22categoryIds%22%3A%5B%5D%2C%22conversionPaths%22%3A%5B%5D%2C%22metadata%22%3A%7B%7D%2C%22uiDefinitionUri%22%3A%22https%3A%2F%2Fquery.prod.cms.rt.microsoft.com%2Fcms%2Fapi%2Fam%2Fbinary%2FRE4ZUuc%22%2C%22artifacts%22%3A%5B%7B%22name%22%3A%22UiDefinition.json%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FUiDefinition.json%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22DefaultTemplate%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FmainTemplate.json%22%2C%22type%22%3A%22Template%22%7D%2C%7B%22name%22%3A%22Documents_MSSentinelRansomwareListActivation.pdf%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FDocuments%2FMSSentinelRansomwareListActivation.pdf%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22SampleImage_apps.1058.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.09093d5c-d51d-4f56-b40d-0d4da0a7cde6%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FSampleImage%2Fapps.1058.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.09093d5c-d51d-4f56-b40d-0d4da0a7cde6%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22SampleImage_apps.57732.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.15c00869-f45a-441d-b99b-845ef100eb0b%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FSampleImage%2Fapps.57732.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.15c00869-f45a-441d-b99b-845ef100eb0b%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22Thumbnails_apps.46826.4eb982c2-6c68-4d75-88e6-40aef3130a0e.ddd10bff-7cc8-485e-85c0-a277b390c888.775474f3-8258-4912-ae16-cba2cb4b60ac%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FThumbnails%2Fapps.46826.4eb982c2-6c68-4d75-88e6-40aef3130a0e.ddd10bff-7cc8-485e-85c0-a277b390c888.775474f3-8258-4912-ae16-cba2cb4b60ac%22%2C%22type%22%3A%22Custom%22%7D%5D%2C%22isPrivate%22%3Afalse%2C%22isHidden%22%3Afalse%2C%22hasFreeTrials%22%3Atrue%2C%22isByol%22%3Afalse%2C%22isFree%22%3Atrue%2C%22isPayg%22%3Afalse%2C%22isStopSell%22%3Afalse%2C%22cspState%22%3A%22OptOut%22%2C%22isQuantifiable%22%3Afalse%2C%22displayRank%22%3A%222147483647%22%2C%22purchaseDurationDiscounts%22%3A%5B%5D%2C%22upns%22%3A%5B%5D%2C%22hasRI%22%3Afalse%2C%22stackType%22%3A%22ARM%22%7D%5D%2C%22selectedPlanId%22%3A%22tctf-0001-01%22%2C%22iconFileUris%22%3A%7B%22small%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.64148.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.ce37b4f0-b002-4934-bc08-2b1ef77bec3d%22%2C%22medium%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.48822.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.1fb200c9-bb73-4f74-b130-57750bb0226c%22%2C%22wide%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.53088.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.440f72c7-c092-4b72-9315-61e6c22ea021%22%2C%22large%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.8229.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.d19bc112-999e-438a-a760-da497774b10f%22%7D%2C%22itemType%22%3A%22Single%22%2C%22hasNoProducts%22%3Afalse%2C%22hasNoPlans%22%3Afalse%2C%22filledHeartIcon%22%3A%7B%22type%22%3A1%2C%22data%22%3A%22%3Csvg%20viewBox%3D'0%200%2016%2015'%20class%3D'msportalfx-svg-placeholder'%20role%3D'presentation'%20focusable%3D'false'%20xmlns%3Asvg%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cg%3E%3Ctitle%3E%3C%2Ftitle%3E%3Cpath%20d%3D'M14.758%201.242c.276.276.505.578.688.906.188.328.325.669.414%201.024a4.257%204.257%200%200%201-1.103%204.086L8%2014.008l-6.758-6.75a4.269%204.269%200%200%201-.695-.906%204.503%204.503%200%200%201-.414-1.016%204.437%204.437%200%200%201%200-2.164c.094-.354.232-.695.414-1.024A4.302%204.302%200%200%201%202.625.32C3.141.107%203.682%200%204.25%200s1.109.107%201.625.32c.516.214.977.521%201.383.922l.742.75.742-.75A4.292%204.292%200%200%201%2010.125.32C10.641.107%2011.182%200%2011.75%200s1.109.107%201.625.32c.516.214.977.521%201.383.922z'%20class%3D'msportalfx-svg-c19'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%22%7D%2C%22emptyHeartIcon%22%3A%7B%22type%22%3A1%2C%22data%22%3A%22%3Csvg%20viewBox%3D'0%200%2016%2015'%20class%3D'msportalfx-svg-placeholder'%20role%3D'presentation'%20focusable%3D'false'%20xmlns%3Asvg%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cg%3E%3Ctitle%3E%3C%2Ftitle%3E%3Cpath%20d%3D'M11.75%200c.588%200%201.14.112%201.656.336.516.224.966.529%201.352.914.385.38.687.83.906%201.352.224.515.336%201.065.336%201.648%200%20.568-.11%201.112-.328%201.633-.214.52-.518.979-.914%201.375L8%2014.008l-6.758-6.75A4.256%204.256%200%200%201%20.32%205.883%204.263%204.263%200%200%201%200%204.25a4.177%204.177%200%200%201%201.242-3c.386-.385.836-.69%201.352-.914A4.113%204.113%200%200%201%204.25%200c.432%200%20.818.05%201.156.148.339.1.651.237.938.415.291.171.567.38.828.625.266.244.542.513.828.804.286-.291.56-.56.82-.805.266-.244.542-.453.828-.625.292-.177.607-.315.946-.414A4.126%204.126%200%200%201%2011.75%200zm2.297%206.547c.307-.307.541-.659.703-1.055.162-.396.242-.81.242-1.242a3.19%203.19%200%200%200-.25-1.266%203.048%203.048%200%200%200-.695-1.023%203.095%203.095%200%200%200-1.031-.68%203.192%203.192%200%200%200-1.266-.25c-.438%200-.825.07-1.164.211a3.816%203.816%200%200%200-.938.54%207.001%207.001%200%200%200-.828.765c-.26.281-.534.568-.82.86a31.352%2031.352%200%200%201-.82-.852%207.247%207.247%200%200%200-.836-.774%204.017%204.017%200%200%200-.946-.562A2.875%202.875%200%200%200%204.25%201c-.448%200-.87.086-1.266.258A3.222%203.222%200%200%200%201%204.25c0%20.432.08.846.242%201.242.167.396.404.748.711%201.055L8%2012.594l6.047-6.047z'%20class%3D'msportalfx-svg-c19%20msportalfx-svg-c19'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%22%7D%2C%22privateBadgeText%22%3Anull%2C%22createBladeType%22%3A0%2C%22offerType%22%3A%22SaaS%22%2C%22useEnterpriseContract%22%3Atrue%2C%22hasStandardContractAmendments%22%3Afalse%2C%22standardContractAmendmentsRevisionId%22%3A%2200000000-0000-0000-0000-000000000000%22%2C%22supportUri%22%3A%22https%3A%2F%2Fsupport.reversinglabs.com%2Fhc%2Fen-us%2Frestricted%22%2C%22isMicrosoftProduct%22%3Atrue%2C%22productOwnershipSellingMotion%22%3A%223PPAgency%22%2C%22galleryItemAccess%22%3A0%2C%22privateSubscriptions%22%3A%5B%5D%2C%22isTenantPrivate%22%3Afalse%2C%22hasRIPlans%22%3Afalse%2C%22pricingTypes%22%3A%5B%22FreeTrial%22%2C%22Payg%22%5D%7D/selectionMode~/false/resourceGroupId//resourceGroupLocation//dontDiscardJourney~/false)**\r\n\r\n**[Click here for more info on ReversingLabs' Threat Intelligence offerings](https://www.reversinglabs.com/products/file-reputation-service)**"
                  },
                  "conditionalVisibility": {
                    "parameterName": "rl_feed_check",
                    "comparison": "isEqualTo",
                    "value": "false"
                  },
                  "name": "text - 5"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "**Thank you for subscribing to the ReversingLabs threat intelligence feed!**",
                    "style": "success"
                  },
                  "conditionalVisibility": {
                    "parameterName": "rl_feed_check",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "text - 5 - Copy"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Here's how to get the most benefit out of the feed:\r\n\r\n- Enable analytic rules mapping threat intelligence indicators to your data sources\r\n- Deploy playbooks that will automatically enrich your incidents\r\n- Hunt for indicators in your environment"
                  },
                  "conditionalVisibility": {
                    "parameterName": "rl_feed_check",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "text - 7"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "ti_feed_check",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "TI Executive Summary",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Threat intelligence is information about cyber threats (malware, ransomware, etc.) and threat actors that help identify malicious events. This information can be referred to as indicators of compromise (or IoC). It consists of objects such as IP addresses, file hashes, and URLs which can be used to identify an attack. Threat Feeds and Search/Query APIs automate processing, correlation, analysis, and threat status information gathering to enable orchestration to build the foundation of threat informed defense.\r\n\r\n### Indicator quality\r\n\r\nUse this table to check the overall quality of your existing threat intel feeds.\r\n* **Active Indicators**: the total number of active indicators\r\n* **Average Tags**: tags help provide add context indicators\r\n* **Average Age**: stale indicators potentially lead to more false positives\r\n* **Uniqueness Percentage**: this metric shows the percetnage of unique indicators in each of your feeds",
                    "style": "info"
                  },
                  "conditionalVisibility": {
                    "parameterName": "guide",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 1",
                  "styleSettings": {
                    "padding": "5px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let DomainQuery=view() { \r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(DomainName)\r\n| summarize dcount_=dcount(DomainName) by SourceSystem\r\n| project SourceSystem, dcount_, EntryType=\"DomainEntry\"\r\n};\r\nlet UrlQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(Url)\r\n| summarize dcount_=dcount(Url) by SourceSystem\r\n| project SourceSystem, dcount_, EntryType=\"UrlEntry\"\r\n};\r\nlet FileHashQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(FileHashValue)\r\n| summarize dcount_=dcount(FileHashValue) by SourceSystem\r\n| project SourceSystem, dcount_, EntryType=\"FileHashEntry\"\r\n};\r\nlet IPQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(NetworkIP) or isnotempty(NetworkSourceIP)\r\n| summarize dcount_=dcount(NetworkIP) by SourceSystem\r\n| project SourceSystem, dcount_, EntryType=\"IPEntry\"\r\n};\r\nlet EmailAddressQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSenderAddress)\r\n| summarize dcount_=dcount(EmailSenderAddress) by SourceSystem\r\n| project SourceSystem, dcount_, EntryType=\"EmailAddressEntry\"\r\n};\r\nlet EmailMessageQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSubject)\r\n| summarize dcount_=dcount(EmailSubject) by SourceSystem\r\n| project SourceSystem, dcount_, EntryType=\"EmailMessageEntry\"\r\n};\r\nlet AllIndicators=view(){\r\n    DomainQuery\r\n    | union UrlQuery\r\n    | union FileHashQuery\r\n    | union IPQuery\r\n    | union EmailAddressQuery\r\n    | union EmailMessageQuery\r\n    | summarize sum(dcount_) by SourceSystem\r\n    | project SourceSystem, sum_dcount_\r\n};\r\nAllIndicators",
                    "size": 3,
                    "title": "Summary of TI Sources",
                    "noDataMessage": "You don't have any TI sources!",
                    "noDataMessageStyle": 5,
                    "timeContextFromParameter": "timerange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "piechart"
                  },
                  "customWidth": "50",
                  "name": "query - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// get average age of indicators in source\r\nlet AvgAge = ThreatIntelligenceIndicator \r\n| extend indicator_age = datetime_diff('day', now(), TimeGenerated)\r\n| summarize round(avg(indicator_age)) by SourceSystem;\r\n// get average number of tags per indicator\r\nlet tagCount = ThreatIntelligenceIndicator\r\n| extend iocTagCount = iff(isempty(array_length(todynamic(Tags))), 0, array_length(todynamic(Tags)))\r\n| summarize round(avg(iocTagCount)) by SourceSystem;\r\n// uniqueness\r\nlet DomainQuery=view() { \r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(DomainName)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by DomainName\r\n| extend SourceSystemArray=array_sort_asc(SourceSystemArray)\r\n| summarize dcount_=dcount(DomainName) by tostring(SourceSystemArray)\r\n| project SourceSystemArray, dcount_, EntryType=\"DomainEntry\"\r\n};\r\nlet UrlQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(Url)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by Url\r\n| extend SourceSystemArray=array_sort_asc(SourceSystemArray)\r\n| summarize dcount_=dcount(Url) by tostring(SourceSystemArray)\r\n| project SourceSystemArray, dcount_, EntryType=\"UrlEntry\"\r\n};\r\nlet FileHashQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(FileHashValue)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by FileHashValue\r\n| extend SourceSystemArray=array_sort_asc(SourceSystemArray)\r\n| summarize dcount_=dcount(FileHashValue) by tostring(SourceSystemArray)\r\n| project SourceSystemArray, dcount_, EntryType=\"FileHashEntry\"\r\n};\r\nlet IPQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(NetworkIP) or isnotempty(NetworkSourceIP)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by NetworkIP, NetworkSourceIP\r\n| extend SourceSystemArray=array_sort_asc(SourceSystemArray)\r\n| summarize dcount_=dcount(NetworkIP) by tostring(SourceSystemArray)\r\n| project SourceSystemArray, dcount_, EntryType=\"IPEntry\"\r\n};\r\nlet EmailAddressQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSenderAddress)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSenderAddress\r\n| extend SourceSystemArray=array_sort_asc(SourceSystemArray)\r\n| summarize dcount_=dcount(EmailSenderAddress) by tostring(SourceSystemArray)\r\n| project SourceSystemArray, dcount_, EntryType=\"EmailAddressEntry\"\r\n};\r\nlet EmailMessageQuery=view(){\r\nThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSubject)\r\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSubject\r\n| extend SourceSystemArray=array_sort_asc(SourceSystemArray)\r\n| summarize dcount_=dcount(EmailSubject) by tostring(SourceSystemArray)\r\n| project SourceSystemArray, dcount_, EntryType=\"EmailMessageEntry\"\r\n};\r\nlet SingleSourceIndicators=view(){\r\n    DomainQuery\r\n    | union UrlQuery\r\n    | union FileHashQuery\r\n    | union IPQuery\r\n    | union EmailAddressQuery\r\n    | union EmailMessageQuery\r\n    | where array_length(todynamic(SourceSystemArray))==1\r\n    | summarize sum(dcount_) by SourceSystemArray\r\n    | extend counter=1 \r\n};\r\nlet MultipleSourceIndicators=view(){\r\n    DomainQuery\r\n    | union UrlQuery\r\n    | union FileHashQuery\r\n    | union IPQuery\r\n    | union EmailAddressQuery\r\n    | union EmailMessageQuery\r\n    | where array_length(todynamic(SourceSystemArray))!=1\r\n    | summarize sum(dcount_) by SourceSystemArray\r\n    | extend counter=1\r\n};\r\nlet CountOfActiveIndicatorsBySource=view(){\r\n    ThreatIntelligenceIndicator\r\n\t| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n    | where ExpirationDateTime > now() and Active == true\r\n    | summarize count() by SourceSystem\r\n    | project SourceSystem, count_\r\n    | extend IndicatorSource = SourceSystem\r\n};\r\nlet UniquePercentage = view(){\r\n    SingleSourceIndicators\r\n    | join kind=fullouter MultipleSourceIndicators on counter \r\n    | extend uniquetotal=iff(SourceSystemArray1 contains tostring(todynamic(SourceSystemArray)[0]), sum_dcount_1 + sum_dcount_, sum_dcount_)\r\n    | where SourceSystemArray1 contains todynamic(SourceSystemArray)[0] \r\n    | order by SourceSystemArray\r\n    | extend solitary_count=sum_dcount_\r\n    | summarize shared_count = sum(sum_dcount_1) by SourceSystemArray, solitary_count\r\n    | extend total_count = shared_count + solitary_count\r\n    | extend unique_percentage = round(toreal(solitary_count)/toreal(total_count)*100, 1)\r\n    | extend IndicatorSource = tostring(todynamic(SourceSystemArray)[0])\r\n    | union CountOfActiveIndicatorsBySource\r\n    | summarize sum(unique_percentage) by IndicatorSource\r\n    | extend sum_unique_percentage = iff(tolong(sum_unique_percentage) == 0, 100, tolong(sum_unique_percentage))\r\n    | project IndicatorSource, UniquenessPercentage=sum_unique_percentage\r\n};\r\n// join on total count of indicators per source\r\nThreatIntelligenceIndicator \r\n| where Active == true\r\n| summarize dcount(IndicatorId) by SourceSystem\r\n| join AvgAge on SourceSystem\r\n| join tagCount on SourceSystem\r\n| join UniquePercentage on $left.SourceSystem == $right.IndicatorSource\r\n| project [\"Source Feed\"]=SourceSystem, [\"Total Active Indicators\"]=dcount_IndicatorId, [\"Avg. Tags\"]=avg_iocTagCount, [\"Avg. Age\"]=avg_indicator_age, UniquenessPercentage\r\n| sort by [\"Total Active Indicators\"]",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Indicator Quality",
                    "timeContextFromParameter": "timerange",
                    "exportFieldName": "Source Feed",
                    "exportParameterName": "sourceFeed",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Avg. Tags",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Average count of tags per indicator"
                          }
                        },
                        {
                          "columnMatch": "Avg. Age",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Average age of an indicator in the source"
                          }
                        },
                        {
                          "columnMatch": "UniquenessPercentage",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "15%"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          },
                          "tooltipFormat": {
                            "tooltip": "{0} of indicators are unique to this feed"
                          }
                        },
                        {
                          "columnMatch": "SourceSystem",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "TI Feed"
                          }
                        },
                        {
                          "columnMatch": "Total Indicators",
                          "formatter": 0,
                          "tooltipFormat": {
                            "tooltip": "Total indicators in the source"
                          }
                        }
                      ],
                      "sortBy": [
                        {
                          "itemKey": "$gen_bar_UniquenessPercentage_4",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_bar_UniquenessPercentage_4",
                        "sortOrder": 2
                      }
                    ],
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "Source",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "Avg. Age",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "graphSettings": {
                      "type": 0,
                      "topContent": {
                        "columnMatch": "Source",
                        "formatter": 1
                      },
                      "centerContent": {
                        "columnMatch": "Avg. Age",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Select a feed from the dropdown and indicator type below to view more details",
                    "style": "info"
                  },
                  "conditionalVisibility": {
                    "parameterName": "guide",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 17"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "parameters": [
                      {
                        "id": "6a1e142a-62c3-4e27-875e-a01c921f3095",
                        "version": "KqlParameterItem/1.0",
                        "name": "sourceFeed",
                        "label": "Threat Intelligence Feed",
                        "type": 2,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "ThreatIntelligenceIndicator\r\n| summarize by SourceSystem\r\n| project SourceSystem",
                        "crossComponentResources": [
                          "{workspace}"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "timerange",
                        "defaultValue": "value::all",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      {
                        "id": "3031a525-f8dc-48b9-a756-cb70bfcad48f",
                        "version": "KqlParameterItem/1.0",
                        "name": "indicatorParam",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 0
                        },
                        "timeContextFromParameter": "timerange"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 16"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "### Feed indicator summary by type\r\n\r\n"
                  },
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "text - 15"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "View a breakdown of your indicators by type below. Clicking on a tile will provide a summary of the indicator type by feed, and trend in newly added indicators over time.",
                    "style": "info"
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "sourceFeed",
                      "comparison": "isNotEqualTo"
                    },
                    {
                      "parameterName": "guide",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    }
                  ],
                  "name": "text - 15 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| where SourceSystem in ({sourceFeed})\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(DomainName)\r\n| summarize dcount_=dcount(DomainName)\r\n| project dcount_, IndicatorType=\"Domain Indicators\", indicatorParam=\"DomainName\"",
                    "size": 3,
                    "noDataMessage": "No DomainName indicators found",
                    "exportFieldName": "indicatorParam",
                    "exportParameterName": "indicatorParam",
                    "exportDefaultValue": "",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "IndicatorType",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "dcount_",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "Globe",
                              "text": "{0}{1}"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "16.6",
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "query - 9 - Copy - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| where SourceSystem in ({sourceFeed})\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(Url)\r\n| summarize dcount_=dcount(Url)\r\n| project dcount_, IndicatorType=\"URL Indicators\", indicatorParam=\"Url\"",
                    "size": 3,
                    "noDataMessage": "No URL Indicators found",
                    "exportFieldName": "indicatorParam",
                    "exportParameterName": "indicatorParam",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "IndicatorType",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "dcount_",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "Link",
                              "text": "{0}{1}"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "16.6",
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "query - 9 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| where SourceSystem in ({sourceFeed})\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(FileHashValue)\r\n| summarize dcount_=dcount(FileHashValue)\r\n| project dcount_, IndicatorType=\"FileHash Indicators\", indicatorParam=\"FileHashValue\"",
                    "size": 3,
                    "noDataMessage": "No FileHash indicators found",
                    "exportFieldName": "indicatorParam",
                    "exportParameterName": "indicatorParam",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "IndicatorType",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "dcount_",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "File",
                              "text": "{0}{1}"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": true,
                      "size": "auto"
                    }
                  },
                  "customWidth": "16.6",
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "query - 9 - Copy - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| where SourceSystem in ({sourceFeed})\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(NetworkIP)\r\n| summarize dcount_=dcount(NetworkIP)\r\n| project dcount_, IndicatorType=\"IP Indicators\", indicatorParam=\"NetworkIP\"",
                    "size": 3,
                    "noDataMessage": "No IP indicators found",
                    "exportFieldName": "indicatorParam",
                    "exportParameterName": "indicatorParam",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "IndicatorType",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "dcount_",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "Connect",
                              "text": "{0}{1}"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "16.6",
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "query - 9 - Copy - Copy - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| where SourceSystem in ({sourceFeed})\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSenderAddress)\r\n| summarize dcount_=dcount(EmailSenderAddress)\r\n| project dcount_, IndicatorType=\"EmailSenderAddress Indicators\", indicatorParam=\"EmailSenderAddress\"",
                    "size": 3,
                    "noDataMessage": "No EmailSenderAddress indicators found",
                    "exportFieldName": "indicatorParam",
                    "exportParameterName": "indicatorParam",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "IndicatorType",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "dcount_",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "Person",
                              "text": "{0}{1}"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "16.6",
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "EmailSenderAddressCount"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| where SourceSystem in ({sourceFeed})\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSubject)\r\n| summarize dcount_=dcount(EmailSubject)\r\n| project dcount_, IndicatorType=\"EmailSubject Indicators\", indicatorParam=\"EmailSubject\"",
                    "size": 3,
                    "noDataMessage": "No EmailSubject indicators found",
                    "exportFieldName": "indicatorParam",
                    "exportParameterName": "indicatorParam",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "IndicatorType",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "dcount_",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "Mail",
                              "text": "{0}{1}"
                            }
                          ]
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2,
                            "maximumSignificantDigits": 3
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "16.6",
                  "conditionalVisibility": {
                    "parameterName": "sourceFeed",
                    "comparison": "isNotEqualTo"
                  },
                  "showPin": false,
                  "name": "EmailSubjectCount"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where SourceSystem in ({sourceFeed})\r\n| where isnotempty({indicatorParam})\r\n| make-series Trend = dcount({indicatorParam}) default = 0 on TimeGenerated from ago({timerange:seconds}s) to now() step 1d by SourceSystem\r\n| project-away TimeGenerated\r\n| extend FeedName=SourceSystem\r\n| join kind = inner (ThreatIntelligenceIndicator\r\n    | summarize arg_max(TimeGenerated, *) by IndicatorId\r\n    | where isnotempty({indicatorParam})\r\n    | summarize dcount_=dcount({indicatorParam}) by SourceSystem\r\n    | project FeedName=SourceSystem, dcount_\r\n    ) on FeedName\r\n| project FeedName, Total=dcount_, Trend",
                    "size": 3,
                    "timeContextFromParameter": "timerange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "dcount_",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 10,
                          "formatOptions": {
                            "palette": "red"
                          }
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "indicatorParam",
                    "comparison": "isNotEqualTo"
                  },
                  "name": "query - 17"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "ti_feed_check",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "TI used",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# You don't have any Threat Intelligence feeds!",
                    "style": "error"
                  },
                  "name": "text - 0"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Threat intelligence is information about cyber threats (malware, ransomware, etc.) and threat actors that help identify malicious events. This information can be referred to as indicators of compromise (or IoC). It consists of objects such as IP addresses, file hashes, and URLs which can be used to identify an attack. Threat Feeds and Search/Query APIs automate processing, correlation, analysis, and threat status information gathering to enable orchestration to build the foundation of threat informed defense.\r\n\r\nTo learn about how to get started with Threat Intelligence in Microsoft Sentinel, check out the following resources:\r\n* [Understand threat intelligence in Microsoft Sentinel](https://docs.microsoft.com/azure/sentinel/understand-threat-intelligence?WT.mc_id=Portal-fx#adding-threat-indicators-to-azure-sentinel-with-the-threat-intelligence---taxii-data-connector)\r\n* [Connect Microsoft Sentinel to STIX/TAXII threat intelligence feeds](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence-taxii)\r\n* [ReversingLabs - Explainable Threat Intelligence Overview](https://www.youtube.com/watch?v=s0N5oWxZdh4)"
                  },
                  "name": "text - 1"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "ti_feed_check",
              "comparison": "isEqualTo",
              "value": "false"
            },
            "name": "TI unused",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Incidents created from Threat Intelligence indicators"
                  },
                  "name": "text - 2"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Use this section to see how your threat intelligence feeds impact your Sentinel incidents.\r\n\r\n* Incidents created from TI indicators by severity - a summary of incidents created from a threat intelligence indicator by severity\r\n* Closed incident classifications by TI feed - view a breakdown of closing classifications (True Positive, Benign Positive, False Positive, Undetermined) by each feed.",
                    "style": "info"
                  },
                  "name": "text - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let AlertIDs = SecurityAlert\r\n| extend Query_ = tostring(parse_json(ExtendedProperties).Query)\r\n| extend OriginalQuery_ = tostring(parse_json(ExtendedProperties).OriginalQuery)\r\n| where Query_ contains \"ThreatIntelligenceIndicator\" or OriginalQuery_ contains \"ThreatIntelligenceIndicator\"\r\n| project TimeGenerated, SystemAlertId;\r\nSecurityIncident\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| mv-expand AlertIds\r\n| extend AlertIds = tostring(AlertIds)\r\n| join AlertIDs on $left.AlertIds == $right.SystemAlertId\r\n| summarize dcount(IncidentName) by Severity\r\n\r\n",
                    "size": 3,
                    "title": "Incidents created from TI indicators by severity",
                    "timeContextFromParameter": "timerange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "piechart",
                    "chartSettings": {
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Medium",
                          "color": "orange"
                        },
                        {
                          "seriesName": "High",
                          "color": "redBright"
                        },
                        {
                          "seriesName": "Low",
                          "color": "blue"
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 7"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let ioclookback = 30d;\r\nlet DomainQuery=view() { \r\nThreatIntelligenceIndicator\r\n| where TimeGenerated > ago(ioclookback)\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(DomainName)\r\n| extend IndicatorValue=DomainName\r\n| summarize SourceSystemArray=make_set(SourceSystem) by IndicatorValue, Tags\r\n};\r\nlet UrlQuery=view(){\r\nThreatIntelligenceIndicator\r\n| where TimeGenerated > ago(ioclookback)\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(Url)\r\n| extend IndicatorValue=Url\r\n| summarize SourceSystemArray=make_set(SourceSystem) by IndicatorValue, Tags\r\n};\r\nlet FileHashQuery=view(){\r\nThreatIntelligenceIndicator\r\n| where TimeGenerated > ago(ioclookback)\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(FileHashValue)\r\n| extend IndicatorValue=FileHashValue\r\n| summarize SourceSystemArray=make_set(SourceSystem) by IndicatorValue, Tags\r\n};\r\nlet IPQuery=view(){\r\nThreatIntelligenceIndicator\r\n| where TimeGenerated > ago(ioclookback)\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(NetworkIP) or isnotempty(NetworkSourceIP)\r\n| extend IndicatorValue=NetworkIP\r\n| summarize SourceSystemArray=make_set(SourceSystem) by IndicatorValue, NetworkSourceIP, Tags\r\n};\r\nlet EmailAddressQuery=view(){\r\nThreatIntelligenceIndicator\r\n| where TimeGenerated > ago(ioclookback)\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSenderAddress)\r\n| extend IndicatorValue=EmailSenderAddress\r\n| summarize SourceSystemArray=make_set(SourceSystem) by IndicatorValue, Tags\r\n};\r\nlet EmailMessageQuery=view(){\r\nThreatIntelligenceIndicator\r\n| where TimeGenerated > ago(ioclookback)\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| where isnotempty(EmailSubject)\r\n| extend IndicatorValue=EmailSubject\r\n| summarize SourceSystemArray=make_set(SourceSystem) by IndicatorValue, Tags\r\n};\r\nlet AllIndicators=view(){\r\n    DomainQuery\r\n    | union UrlQuery\r\n    | union FileHashQuery\r\n    | union IPQuery\r\n    | union EmailAddressQuery\r\n    | union EmailMessageQuery\r\n};\r\n// get alert IDs and entities where the alert query contains the ThreatIntelligenceIndicator table\r\nlet AlertIDs = SecurityAlert\r\n| where TimeGenerated {timerange}\r\n| extend Query_ = tostring(parse_json(ExtendedProperties).Query)\r\n| extend OriginalQuery_ = tostring(parse_json(ExtendedProperties).OriginalQuery)\r\n| where Query_ contains \"ThreatIntelligenceIndicator\" or OriginalQuery_ contains \"ThreatIntelligenceIndicator\"\r\n| project TimeGenerated, SystemAlertId, Entities;\r\n// query incidents that match AlertIDs value\r\nSecurityIncident\r\n| where TimeGenerated {timerange}\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| mv-expand AlertIds\r\n| extend AlertIds = tostring(AlertIds)\r\n| join AlertIDs on $left.AlertIds == $right.SystemAlertId\r\n| extend entity = parse_json(Entities)[0]\r\n| extend IndicatorValue = case(\r\n    entity.Value!=\"\", tostring(entity.Value),\r\n    entity.Address!=\"\", tostring(entity.Address),\r\n    entity.Url!=\"\", tostring(entity.Url),\r\n    entity.DomainName!=\"\", tostring(entity.DomainName),\r\n    \"\")\r\n| where Status == \"Closed\"\r\n| join kind=inner AllIndicators on $left.IndicatorValue == $right.IndicatorValue\r\n| summarize dcount(IncidentName) by Status, Classification, tostring(SourceSystemArray)\r\n| project [\"Incidents closed\"]=dcount_IncidentName, Classification, FeedName=SourceSystemArray",
                    "size": 3,
                    "title": "Closed incident classifications by TI feed",
                    "timeContextFromParameter": "timerange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "table",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Classification",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "TruePositive",
                                "representation": "3",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "FalsePositive",
                                "representation": "Noisy",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Undetermined",
                                "representation": "question",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "BenignPositive",
                                "representation": "warning",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Blank",
                                "text": "{0}{1}"
                              }
                            ],
                            "compositeBarSettings": {
                              "labelText": "",
                              "columnSettings": [
                                {
                                  "columnName": "Classification",
                                  "color": "blue"
                                }
                              ]
                            }
                          }
                        }
                      ]
                    },
                    "chartSettings": {
                      "showLegend": true
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 8"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "ti_feed_check",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "TI incident summary",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "section",
        "comparison": "isEqualTo",
        "value": "ti"
      },
      "name": "ti summary"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "loadType": "always",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Your Operations Summary"
            },
            "name": "text - 0"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Operations Executive Summary"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Resolution of alerts with the help of actionable threat intelligence can improve the speed and accuracy of triage. Below you will find a summary of your environment's incidents and how a ReversingLabs Threat Intel feed combined with the ReversingLabs solution for Microsoft Sentinel can help take your operations to the next level.\r\n\r\n### Summary of incidents\r\nThis line chart provides a summary of all incidents created over the selected time range, and how many of those incidents where created from Threat Intelligence indicators.\r\n\r\n\r\n### Operational efficiency summary\r\nSee how playbooks from ReversingLabs impact your operational efficiency:\r\n\r\n* **No Enrichment**: incidents that have not had any enrichment \r\n* **Enriched**: incidents that have been enriched with automation\r\n* **Auto-triaged**: incidents that have been automatically worked via automation",
                    "style": "info"
                  },
                  "conditionalVisibility": {
                    "parameterName": "guide",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 1"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let AlertIDs = SecurityAlert\r\n| extend Query_ = tostring(parse_json(ExtendedProperties).Query)\r\n| extend OriginalQuery_ = tostring(parse_json(ExtendedProperties).OriginalQuery)\r\n| where Query_ contains \"ThreatIntelligenceIndicator\" or OriginalQuery_ contains \"ThreatIntelligenceIndicator\"\r\n| project TimeGenerated, SystemAlertId;\r\nlet TIIncidents = SecurityIncident\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| mv-expand AlertIds\r\n| extend AlertIds = tostring(AlertIds)\r\n| join AlertIDs on $left.AlertIds == $right.SystemAlertId\r\n| summarize dcount(IncidentName) by bin(TimeGenerated, 1d)\r\n| extend [\"Number of incidents\"] = dcount_IncidentName\r\n| extend label = \"TI\"\r\n| project TimeGenerated, [\"Number of incidents\"], label;\r\nSecurityIncident\r\n| summarize arg_min(TimeGenerated, *) by IncidentName\r\n| summarize count() by bin(TimeGenerated, 1d)\r\n| project TimeGenerated, [\"Number of incidents\"]=count_\r\n| extend label = \"All\"\r\n| union TIIncidents",
                    "size": 1,
                    "title": "Summary of Incidents",
                    "timeContextFromParameter": "timerange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "linechart",
                    "chartSettings": {
                      "seriesLabelSettings": [
                        {
                          "seriesName": "All",
                          "color": "blueDarkDark"
                        },
                        {
                          "seriesName": "TI",
                          "color": "redBright"
                        }
                      ]
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "// find all incidents that had a comment with a ReversingLabs playbook\r\nlet RLEnrichedIncidents = SecurityIncident\r\n| mv-expand Comments\r\n| extend CommenterName = tostring(parse_json(tostring(Comments.author)).name)\r\n| where CommenterName contains \"Comment created from playbook - ReversingLabs\"\r\n| summarize arg_max(TimeGenerated, *) by IncidentName\r\n| summarize count()\r\n| extend type = \"Enriched by ReversingLabs\";\r\n// find incidents that had a playbook comment, non RL\r\nlet enrichedIncidents = SecurityIncident\r\n| mv-expand Comments\r\n| extend CommenterName = tostring(parse_json(tostring(Comments.author)).name)\r\n| where CommenterName == \"Comment created from playbook\"\r\n| where CommenterName !contains \"ReversingLabs\"\r\n| summarize arg_max(TimeGenerated, *) by IncidentName\r\n| summarize count()\r\n| extend type = \"Enriched\";\r\n// find all incidents closed by a playbook\r\nlet autoTriage = SecurityIncident\r\n| where Status == \"Closed\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentName\r\n| where ModifiedBy contains \"Playbook - \"\r\n| summarize count()\r\n| extend type = \"Auto-triaged\";\r\nSecurityIncident\r\n| summarize arg_max(TimeGenerated, *) by IncidentName\r\n| where Comments !contains \"Comment created from playbook\"\r\n| summarize count()\r\n| extend type = \"No Enrichment\"\r\n| union RLEnrichedIncidents, enrichedIncidents, autoTriage\r\n| project Type=type, [\"Total\"]=count_",
                    "size": 3,
                    "title": "Operational Efficiency Summary",
                    "noDataMessage": "None of your incidents are currently being enriched!",
                    "noDataMessageStyle": 5,
                    "timeContextFromParameter": "timerange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{workspace}"
                    ],
                    "visualization": "piechart",
                    "gridSettings": {
                      "sortBy": [
                        {
                          "itemKey": "Type",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "Type",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "query - 3"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Time and Cost analysis"
                        },
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "The following data is based on average time spent performing manual enrichment lookups compared to a default SOC analyst salary of $90,000 USD defined in the analyst_salary parameter.\r\n\r\n* Time saved - the amount of time saved on performing lookups when using a ReversingLabs playbook\r\n* Current cost savings - based on incidents that have been enriched by a ReversingLabs playbook, this is the amount of money you've saved\r\n* Estimated potential cost savings - this is the amount of money you could be saving when performing enrichment lookups on incidents\r\n\r\n**NOTE:** if you modified any ReversingLabs playbook names from the default value during solution deployment, you will need to update the KQL query for each tile below.\r\n",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "guide",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// average time to manually perform a lookup ~2 minutes\r\nlet avg_lookup_time = 120;\r\nlet avg_playbook_time = 10;\r\nSecurityIncident\r\n| extend CommenterName = tostring(parse_json(tostring(Comments[0].author)).name)\r\n| where CommenterName == \"Comment created from playbook - ReversingLabs-EnrichFileHash\"\r\n| summarize arg_max(TimeGenerated, *) by IncidentName\r\n| summarize count()\r\n| extend manual_time = count_ * avg_lookup_time\r\n| extend auto_time = count_ * avg_playbook_time\r\n| extend time_saved = manual_time - auto_time\r\n| project time_saved\r\n| extend title = \"Time saved\"",
                          "size": 3,
                          "timeContextFromParameter": "timerange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "title",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "time_saved",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 24,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 0
                                }
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "33",
                        "name": "query - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// average time to manually perform a lookup ~2 minutes\r\nlet avg_lookup_time = 120;\r\n// salary in $ per hour assuming 2080 work hours in a year\r\nlet salary_per_second = round(todecimal({analyst_salary}/2080)/60/60, 5);\r\nSecurityIncident\r\n| extend CommenterName = tostring(parse_json(tostring(Comments[0].author)).name)\r\n| where CommenterName == \"Comment created from playbook - ReversingLabs-EnrichFileHash\"\r\n| summarize arg_max(TimeGenerated, *) by IncidentName\r\n| summarize count()\r\n| extend cost = (salary_per_second) * (avg_lookup_time * count_)\r\n| project cost, title=\"Current cost savings\"",
                          "size": 3,
                          "timeContextFromParameter": "timerange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "title",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "cost",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "currency": "USD",
                                  "style": "currency",
                                  "useGrouping": true
                                }
                              },
                              "tooltipFormat": {
                                "tooltip": "Assuming average lookup time of 15 seconds"
                              }
                            },
                            "showBorder": true
                          }
                        },
                        "customWidth": "33",
                        "name": "query - 10"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "// average time to perform a manual lookup ~2 minutes\r\nlet avg_lookup_time = 120;\r\n// salary in $ per hour assuming 2080 work hours in a year\r\nlet salary_per_second = round(todecimal({analyst_salary}/2080)/60/60, 2);\r\nSecurityIncident\r\n| extend CommenterName = tostring(parse_json(tostring(Comments[0].author)).name)\r\n| summarize arg_max(TimeGenerated, *) by IncidentName\r\n| where CommenterName != \"Comment created from playbook - ReversingLabs-EnrichFileHash\"\r\n| summarize count()\r\n| extend cost = (salary_per_second) * (avg_lookup_time * count_)\r\n| project cost, title=\"Estimated potential cost savings\"",
                          "size": 3,
                          "timeContextFromParameter": "timerange",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{workspace}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "title",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "cost",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 0,
                                "options": {
                                  "currency": "USD",
                                  "style": "currency",
                                  "useGrouping": true
                                }
                              },
                              "tooltipFormat": {
                                "tooltip": "Assuming average lookup time of 15 seconds"
                              }
                            },
                            "showBorder": true,
                            "size": "auto"
                          }
                        },
                        "customWidth": "33",
                        "name": "query - 10 - Copy"
                      }
                    ]
                  },
                  "name": "Ops - Costs"
                }
              ]
            },
            "name": "Operations Executive Summary",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "section",
        "comparison": "isEqualTo",
        "value": "operations"
      },
      "name": "operations"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "loadType": "always",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# More Information\r\n\r\nCheck out our offerings in the Azure Marketplace! Select an option using the buttons on the right.",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibilities": [
              {
                "parameterName": "offer",
                "comparison": "isEqualTo"
              },
              {
                "parameterName": "section",
                "comparison": "isEqualTo",
                "value": "info"
              }
            ],
            "name": "text - 7"
          },
          {
            "type": 1,
            "content": {
              "json": "# Reversinglabs Ransomware Intel Feed\r\n\r\n```\r\nI AM RANSOMWARE\r\n\r\nI came in through your redacted and \r\nI have already communicated to my team that I'm in...  \r\nnow I wait.\r\nIt could be a day, it could be a month, \r\nbut I am waiting for the moment when we're positioned \r\nfor mass effect. \r\nThe only thing that can stop what's happening is \r\nif one of my copies gets busted and gives up its code \r\nand my indicators get put into a list to watch out for.\r\n\r\nNot worried about that, ain't too many creating that kind of info...\r\n```\r\n\r\n## Threat Actor Overview\r\n\r\nThreat actors have significantly increased the complexity of their operations to the point where they're run like a business to ensure efforts are coordinated and efficient. They work tirelessly to create malicious code that hides in plain site and avoids modern detection methods and they're not going to initiate the final phase of attack until they're positioned to maximize their effectiveness.\r\nThis provides you with precious time that can be used to seek, identify, and remove ransomware waiting to be detonated.\r\n\r\n## Solution Overview\r\n\r\nEnter ReversingLabs Ransomware Intel Feed for the Sentinel TAXII data connector that injects indicators **curated specifically to hunt ransomware** into your Threat Intelligence blade. Our indicators are harvested from confirmed malware and vetted for accuracy, enhanced with additional intel, and evaluated for activeness. This provides your Sentinel deployment with dynamic CTI to hunt ransomware in every stage of the ransomware lifecycle.\r\n\r\n**Unlock the unlimited potential of Sentinel with an unmatched high-quality CTI dataset to protect your organization from ransomware**\r\n* Ransomware Focused Intelligence - Indicators harvested from the +2.5 million confirmed, unique malware files analyzed every day producing a wealth of ransomware-related datasets.\r\n* Focus on the Hunt - All indicators are enriched with metadata from the perceived vulnerability exploitation techniques, eliminating the need for manual technique identification and tagging.\r\n* Lower Alert Fatigue - All indicators are strictly vetted and curated to ensure indicators are not only accurate but active within the last 30 days, eliminating false positives.\r\n* Policy Driven by Intelligence - With indicators harvested from active, confirmed malware these indicators can be pushed to short-term policy with confidence.\r\n\r\n### View the ReversingLabs Ransomware Intel Feed in the Azure Marketplace here: [LINK](https://portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/reversinglabs1597673283347.rw_feed_offer0/product~/%7B%22displayName%22%3A%22ReversingLabs%20-%20Early%20Detection%20of%20Ransomware%20for%20Sentinel%22%2C%22itemDisplayName%22%3A%22ReversingLabs%20-%20Early%20Detection%20of%20Ransomware%20for%20Sentinel%22%2C%22id%22%3A%22reversinglabs1597673283347.rw_feed_offer0%22%2C%22bigId%22%3A%22DZH318Z0J1ZC%22%2C%22offerId%22%3A%22rw_feed_offer0%22%2C%22publisherId%22%3A%22reversinglabs1597673283347%22%2C%22publisherDisplayName%22%3A%22ReversingLabs%22%2C%22longSummary%22%3A%22Detect%20ransomware%20hiding%20in%20your%20network%20waiting%20for%20attackers%20to%20initiate%20an%20encryption%20campaign%22%2C%22description%22%3A%22%3Cdiv%3E%3Cb%3E%3Cbr%3E%3C%2Fb%3E%3C%2Fdiv%3E%3Ch5%3E%3Cb%3EI%20AM%20RANSOMWARE%3C%2Fb%3E%3C%2Fh5%3E%3Cpre%3EI%20came%20in%20through%20your%20%3Ci%3E%3Cb%3Eredacted%3C%2Fb%3E%3C%2Fi%3E%20and%20%3C%2Fpre%3E%3Cpre%3EI%20have%20already%20communicated%20to%20my%20team%20that%20I'm%20in...%20%20%3C%2Fpre%3E%3Cpre%3Enow%20I%20%3Ci%3Ewait%3C%2Fi%3E.%3C%2Fpre%3E%3Cpre%3E%3Cpre%3EIt%20could%20be%20a%20day%2C%20it%20could%20be%20a%20month%2C%20%3C%2Fpre%3E%3Cpre%3Ebut%20I%20am%20waiting%20for%20the%20moment%20when%20we're%20positioned%20%3C%2Fpre%3E%3Cpre%3Efor%20mass%20effect.%20%3C%2Fpre%3E%3Cpre%3EThe%20only%20thing%20that%20can%20stop%20what's%20happening%20is%20%3C%2Fpre%3E%3Cpre%3Eif%20one%20of%20my%20copies%20gets%20busted%20and%20gives%20up%20its%20code%20%3C%2Fpre%3E%3Cpre%3Eand%20my%20indicators%20get%20put%20into%20a%20list%20to%20watch%20out%20for.%3C%2Fpre%3E%3Cpre%3E%3Cbr%3ENot%20worried%20about%20that%2C%20ain't%20too%20many%20creating%20that%20kind%20of%20info...%3C%2Fpre%3E%3C%2Fpre%3E%3Cdiv%3E%3Cbr%3E%3C%2Fdiv%3E%3Cp%3E%3Cb%3EThreat%20Actor%20Overview%3C%2Fb%3E%3C%2Fp%3E%3Cdiv%3E%3Cspan%3E%3C%2Fspan%3EThreat%20actors%20have%20significantly%20increased%20the%20complexity%20of%20their%20operations%20to%20the%20point%20where%20they're%20run%20like%20a%20business%20to%20ensure%20efforts%20are%20coordinated%20and%20efficient.%20They%20work%20tirelessly%20to%20create%20malicious%20code%20that%20hides%20in%20plain%20site%20and%20avoids%20modern%20detection%20methods%20and%20they're%20not%20going%20to%20initiate%20the%20final%20phase%20of%20attack%20until%20they're%20positioned%20to%20maximize%20their%20effectiveness.%3C%2Fdiv%3E%3Cdiv%3EThis%20provides%20you%20with%20precious%20time%20that%20can%20be%20used%20to%20seek%2C%20identify%2C%20and%20remove%20ransomware%20waiting%20to%20be%20detonated.%3C%2Fdiv%3E%3Cdiv%3E%3Cbr%3E%3C%2Fdiv%3E%3Cp%3E%3Cb%3ESolution%20Overview%3C%2Fb%3E%3C%2Fp%3E%3Cdiv%3E%3Cspan%3E%3C%2Fspan%3EEnter%20ReversingLabs%20Ransomware%20Intel%20Feed%20for%20the%20Sentinel%20TAXII%20data%20connector%20that%20injects%20indicators%20%3Cb%3Ecurated%20specifically%20to%20hunt%20ransomware%3C%2Fb%3E%20into%20your%20Threat%20Intelligence%20blade.%20%20Our%20indicators%20are%20harvested%20from%20confirmed%20malware%20and%20vetted%20for%20accuracy%2C%20enhanced%20with%20additional%20intel%2C%20and%20evaluated%20for%20activeness.%20This%20provides%20your%20Sentinel%20deployment%20with%20dynamic%20CTI%20to%20hunt%20ransomware%20in%20every%20stage%20of%20the%20ransomware%20lifecycle.%3C%2Fdiv%3E%3Cdiv%3E%3Cb%3E%3Cbr%3E%3C%2Fb%3E%3C%2Fdiv%3E%3Cblockquote%3E%3Cb%3EUnlock%20the%20unlimited%20potential%20of%20Sentinel%20with%20an%20unmatched%20high-quality%20CTI%20dataset%20to%20protect%20your%20organization%20from%20ransomware%3C%2Fb%3E%3Cbr%3E%3C%2Fblockquote%3E%3Cdiv%3E%3Cspan%3E%3C%2Fspan%3E%3C%2Fdiv%3E%3Cul%3E%3Cul%3E%3Cli%3E%3Cu%3ERansomware%20Focused%20Intelligence%3C%2Fu%3E%20-%20Indicators%20harvested%20from%20the%20%2B2.5%20million%20confirmed%2C%20unique%20malware%20files%20analyzed%20every%20day%20producing%20a%20wealth%20of%20ransomware-related%20datasets.%3C%2Fli%3E%3Cli%3E%3Cu%3EFocus%20on%20the%20Hunt%3C%2Fu%3E%20-%20All%20indicators%20are%20enriched%20with%20metadata%20from%20the%20perceived%20vulnerability%20exploitation%20techniques%2C%20eliminating%20the%20need%20for%20manual%20technique%20identification%20and%20tagging.%3C%2Fli%3E%3Cli%3E%3Cu%3ELower%20Alert%20Fatigue%3C%2Fu%3E%20-%20All%20indicators%20are%20strictly%20vetted%20and%20curated%20to%20ensure%20indicators%20are%20not%20only%20accurate%20but%20active%20within%20the%20last%2030%20days%2C%20eliminating%20false%20positives.%3C%2Fli%3E%3Cli%3E%3Cu%3EPolicy%20Driven%20by%20Intelligence%3C%2Fu%3E%20-%20With%20indicators%20harvested%20from%20active%2C%20confirmed%20malware%20these%20indicators%20can%20be%20pushed%20to%20short-term%20policy%20with%20confidence.%3C%2Fli%3E%3C%2Ful%3E%3C%2Ful%3E%3Cdiv%3E%3Cbr%3E%3C%2Fdiv%3E%22%2C%22isPrivate%22%3Afalse%2C%22hasPrivateOffer%22%3Afalse%2C%22isMacc%22%3Afalse%2C%22isPreview%22%3Afalse%2C%22isByol%22%3Afalse%2C%22isCSPEnabled%22%3Afalse%2C%22isCSPSelective%22%3Afalse%2C%22isThirdParty%22%3Atrue%2C%22isStopSell%22%3Afalse%2C%22isReseller%22%3Afalse%2C%22hasFreeTrials%22%3Atrue%2C%22marketingMaterial%22%3A%5B%5D%2C%22legalTermsUri%22%3A%22https%3A%2F%2Fgo.microsoft.com%2Ffwlink%2F%3Flinkid%3D2041178%22%2C%22privacyPolicyUri%22%3A%22https%3A%2F%2Fwww.reversinglabs.com%2Fprivacy-policy%22%2C%22version%22%3A%22f42cba0e-b2ee-4856-aae2-f38c323f0a15%22%2C%22metadata%22%3A%7B%22leadGeneration%22%3A%7B%22productId%22%3Anull%7D%2C%22testDrive%22%3Anull%7D%2C%22categoryIds%22%3A%5B%22security%22%2C%22threat-protection%22%2C%22azureCertified%22%2C%22fromPublishingPortal%22%5D%2C%22screenshotUris%22%3A%5B%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.1058.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.09093d5c-d51d-4f56-b40d-0d4da0a7cde6%22%2C%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.57732.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.15c00869-f45a-441d-b99b-845ef100eb0b%22%5D%2C%22videos%22%3A%5B%7B%22caption%22%3A%22Anatomy%20of%20a%20Ransomware%20Attack%22%2C%22uri%22%3A%22https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DIfQdAtn1hZM%22%2C%22videoPurpose%22%3A%22trailer%22%2C%22previewImage%22%3A%7B%22caption%22%3A%22Anatomy%20of%20a%20Ransomware%20Attack%22%2C%22uri%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.46826.4eb982c2-6c68-4d75-88e6-40aef3130a0e.ddd10bff-7cc8-485e-85c0-a277b390c888.775474f3-8258-4912-ae16-cba2cb4b60ac%22%2C%22imagePurpose%22%3A%22trailer%22%7D%7D%5D%2C%22links%22%3A%5B%7B%22id%22%3A%22ReversingLabs%20Ransomware%20Feed%20Product%20Landing%20Page%22%2C%22displayName%22%3A%22ReversingLabs%20Ransomware%20Feed%20Product%20Landing%20Page%22%2C%22uri%22%3A%22https%3A%2F%2Fwww.reversinglabs.com%2Fsolutions%2Fransomware-feed%22%7D%5D%2C%22filters%22%3A%5B%5D%2C%22plans%22%3A%5B%7B%22id%22%3A%220004%22%2C%22displayName%22%3A%22Ransomware%20Intel%20Feed%22%2C%22description%22%3A%22The%20ReversingLabs%20Ransomware%20Intel%20Feed%20for%20Microsoft%20Sentinel%20offered%20as%20month%20to%20month%20subscription%20or%20annual%20subscription.%20For%20a%20limited%20time%20only%20to%20mark%20the%20launch%20on%20this%20marketplace%20we%20are%20offering%20a%20substantial%20discount%20on%20annual%20plans.%20The%20discount%20is%20reflected%20in%20this%20listing.%22%2C%22restrictedAudience%22%3A%7B%7D%2C%22skuId%22%3A%220004%22%2C%22planId%22%3A%22tctf-0001-01%22%2C%22legacyPlanId%22%3A%22reversinglabs1597673283347.rw_feed_offer0tctf-0001-01%22%2C%22keywords%22%3A%5B%5D%2C%22type%22%3A%22SaaS%22%2C%22leadGeneration%22%3A%7B%22productId%22%3A%22reversinglabs1597673283347.rw_feed_offer0%22%7D%2C%22testDrive%22%3Anull%2C%22categoryIds%22%3A%5B%5D%2C%22conversionPaths%22%3A%5B%5D%2C%22metadata%22%3A%7B%7D%2C%22uiDefinitionUri%22%3A%22https%3A%2F%2Fquery.prod.cms.rt.microsoft.com%2Fcms%2Fapi%2Fam%2Fbinary%2FRE4ZUuc%22%2C%22artifacts%22%3A%5B%7B%22name%22%3A%22UiDefinition.json%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FUiDefinition.json%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22DefaultTemplate%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FmainTemplate.json%22%2C%22type%22%3A%22Template%22%7D%2C%7B%22name%22%3A%22Documents_MSSentinelRansomwareListActivation.pdf%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FDocuments%2FMSSentinelRansomwareListActivation.pdf%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22SampleImage_apps.1058.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.09093d5c-d51d-4f56-b40d-0d4da0a7cde6%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FSampleImage%2Fapps.1058.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.09093d5c-d51d-4f56-b40d-0d4da0a7cde6%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22SampleImage_apps.57732.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.15c00869-f45a-441d-b99b-845ef100eb0b%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FSampleImage%2Fapps.57732.4eb982c2-6c68-4d75-88e6-40aef3130a0e.85559ca0-7d20-437e-8bab-042bbef9ee2d.15c00869-f45a-441d-b99b-845ef100eb0b%22%2C%22type%22%3A%22Custom%22%7D%2C%7B%22name%22%3A%22Thumbnails_apps.46826.4eb982c2-6c68-4d75-88e6-40aef3130a0e.ddd10bff-7cc8-485e-85c0-a277b390c888.775474f3-8258-4912-ae16-cba2cb4b60ac%22%2C%22uri%22%3A%22https%3A%2F%2Fcatalogartifact.azureedge.net%2Fpublicartifacts%2Freversinglabs1597673283347.rw_feed_offer0-f42cba0e-b2ee-4856-aae2-f38c323f0a15%2FArtifacts%2FThumbnails%2Fapps.46826.4eb982c2-6c68-4d75-88e6-40aef3130a0e.ddd10bff-7cc8-485e-85c0-a277b390c888.775474f3-8258-4912-ae16-cba2cb4b60ac%22%2C%22type%22%3A%22Custom%22%7D%5D%2C%22isPrivate%22%3Afalse%2C%22isHidden%22%3Afalse%2C%22hasFreeTrials%22%3Atrue%2C%22isByol%22%3Afalse%2C%22isFree%22%3Atrue%2C%22isPayg%22%3Afalse%2C%22isStopSell%22%3Afalse%2C%22cspState%22%3A%22OptOut%22%2C%22isQuantifiable%22%3Afalse%2C%22displayRank%22%3A%222147483647%22%2C%22purchaseDurationDiscounts%22%3A%5B%5D%2C%22upns%22%3A%5B%5D%2C%22hasRI%22%3Afalse%2C%22stackType%22%3A%22ARM%22%7D%5D%2C%22selectedPlanId%22%3A%22tctf-0001-01%22%2C%22iconFileUris%22%3A%7B%22small%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.64148.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.ce37b4f0-b002-4934-bc08-2b1ef77bec3d%22%2C%22medium%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.48822.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.1fb200c9-bb73-4f74-b130-57750bb0226c%22%2C%22wide%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.53088.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.440f72c7-c092-4b72-9315-61e6c22ea021%22%2C%22large%22%3A%22https%3A%2F%2Fstore-images.s-microsoft.com%2Fimage%2Fapps.8229.4eb982c2-6c68-4d75-88e6-40aef3130a0e.f2a0fa45-b548-4292-8826-3f82f222fa57.d19bc112-999e-438a-a760-da497774b10f%22%7D%2C%22itemType%22%3A%22Single%22%2C%22hasNoProducts%22%3Afalse%2C%22hasNoPlans%22%3Afalse%2C%22filledHeartIcon%22%3A%7B%22type%22%3A1%2C%22data%22%3A%22%3Csvg%20viewBox%3D'0%200%2016%2015'%20class%3D'msportalfx-svg-placeholder'%20role%3D'presentation'%20focusable%3D'false'%20xmlns%3Asvg%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cg%3E%3Ctitle%3E%3C%2Ftitle%3E%3Cpath%20d%3D'M14.758%201.242c.276.276.505.578.688.906.188.328.325.669.414%201.024a4.257%204.257%200%200%201-1.103%204.086L8%2014.008l-6.758-6.75a4.269%204.269%200%200%201-.695-.906%204.503%204.503%200%200%201-.414-1.016%204.437%204.437%200%200%201%200-2.164c.094-.354.232-.695.414-1.024A4.302%204.302%200%200%201%202.625.32C3.141.107%203.682%200%204.25%200s1.109.107%201.625.32c.516.214.977.521%201.383.922l.742.75.742-.75A4.292%204.292%200%200%201%2010.125.32C10.641.107%2011.182%200%2011.75%200s1.109.107%201.625.32c.516.214.977.521%201.383.922z'%20class%3D'msportalfx-svg-c19'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%22%7D%2C%22emptyHeartIcon%22%3A%7B%22type%22%3A1%2C%22data%22%3A%22%3Csvg%20viewBox%3D'0%200%2016%2015'%20class%3D'msportalfx-svg-placeholder'%20role%3D'presentation'%20focusable%3D'false'%20xmlns%3Asvg%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cg%3E%3Ctitle%3E%3C%2Ftitle%3E%3Cpath%20d%3D'M11.75%200c.588%200%201.14.112%201.656.336.516.224.966.529%201.352.914.385.38.687.83.906%201.352.224.515.336%201.065.336%201.648%200%20.568-.11%201.112-.328%201.633-.214.52-.518.979-.914%201.375L8%2014.008l-6.758-6.75A4.256%204.256%200%200%201%20.32%205.883%204.263%204.263%200%200%201%200%204.25a4.177%204.177%200%200%201%201.242-3c.386-.385.836-.69%201.352-.914A4.113%204.113%200%200%201%204.25%200c.432%200%20.818.05%201.156.148.339.1.651.237.938.415.291.171.567.38.828.625.266.244.542.513.828.804.286-.291.56-.56.82-.805.266-.244.542-.453.828-.625.292-.177.607-.315.946-.414A4.126%204.126%200%200%201%2011.75%200zm2.297%206.547c.307-.307.541-.659.703-1.055.162-.396.242-.81.242-1.242a3.19%203.19%200%200%200-.25-1.266%203.048%203.048%200%200%200-.695-1.023%203.095%203.095%200%200%200-1.031-.68%203.192%203.192%200%200%200-1.266-.25c-.438%200-.825.07-1.164.211a3.816%203.816%200%200%200-.938.54%207.001%207.001%200%200%200-.828.765c-.26.281-.534.568-.82.86a31.352%2031.352%200%200%201-.82-.852%207.247%207.247%200%200%200-.836-.774%204.017%204.017%200%200%200-.946-.562A2.875%202.875%200%200%200%204.25%201c-.448%200-.87.086-1.266.258A3.222%203.222%200%200%200%201%204.25c0%20.432.08.846.242%201.242.167.396.404.748.711%201.055L8%2012.594l6.047-6.047z'%20class%3D'msportalfx-svg-c19%20msportalfx-svg-c19'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%22%7D%2C%22privateBadgeText%22%3Anull%2C%22createBladeType%22%3A0%2C%22offerType%22%3A%22SaaS%22%2C%22useEnterpriseContract%22%3Atrue%2C%22hasStandardContractAmendments%22%3Afalse%2C%22standardContractAmendmentsRevisionId%22%3A%2200000000-0000-0000-0000-000000000000%22%2C%22supportUri%22%3A%22https%3A%2F%2Fsupport.reversinglabs.com%2Fhc%2Fen-us%2Frestricted%22%2C%22isMicrosoftProduct%22%3Atrue%2C%22productOwnershipSellingMotion%22%3A%223PPAgency%22%2C%22galleryItemAccess%22%3A0%2C%22privateSubscriptions%22%3A%5B%5D%2C%22isTenantPrivate%22%3Afalse%2C%22hasRIPlans%22%3Afalse%2C%22pricingTypes%22%3A%5B%22FreeTrial%22%2C%22Payg%22%5D%7D/selectionMode~/false/resourceGroupId//resourceGroupLocation//dontDiscardJourney~/false)",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibilities": [
              {
                "parameterName": "offer",
                "comparison": "isEqualTo",
                "value": "offer1"
              },
              {
                "parameterName": "section",
                "comparison": "isEqualTo",
                "value": "info"
              }
            ],
            "name": "text - 0"
          },
          {
            "type": 1,
            "content": {
              "json": "# TitaniumCloud API\r\n\r\nTitaniumCloud is a threat intelligence solution providing up-to-date file reputation services, threat classification and rich context on over 10 billion goodware and malware files. Files are processed using ReversingLabs [File Decomposition Technology](https://www.reversinglabs.com/technology/active-file-decomposition). A powerful set of REST API query and feed functions deliver targeted file and malware intelligence for threat identification, analysis, intelligence development, and threat hunting services.\r\n\r\n\r\n## OVERVIEW\r\n\r\nTitaniumCloud Reputation Services are powerful threat intelligence solutions with up-to-date, threat classification and rich context on over 10 billion goodware and malware files. ReversingLabs does not depend on crowd-sourced collection, but instead curates the harvesting of files from software vendors and diverse malware sources. All files are processed using unique ReversingLabs File Decomposition Technology, combined with other dynamic and detection information, to provide industry reputation consensus. TitaniumCloud supports a powerful set of REST API query and feed functions that deliver targeted file and malware intelligence for threat identification, analysis, intelligence development, and hunting.\r\n\r\n## Global File Reputation\r\n\r\nTitaniumCloud continually processes goodware and malware files providing early intelligence about attacks before they infiltrate customer infrastructures. This visibility to threats â€œin-the-wildâ€ enables preparation for new attacks and quickly identifies the threat levels of new files as they arrive. TitaniumCloud enables more effective and efficient file analysis, development of better threat intelligence, and implementation of proactive threat hunting programs.\r\n\r\n## Contact us to learn more about TitaniumCloud: [LINK](https://www.reversinglabs.com/contact-us)",
              "style": "info"
            },
            "customWidth": "50",
            "conditionalVisibilities": [
              {
                "parameterName": "offer",
                "comparison": "isEqualTo",
                "value": "offer2"
              },
              {
                "parameterName": "section",
                "comparison": "isEqualTo",
                "value": "info"
              }
            ],
            "name": "text - 0 - Copy"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "list",
              "links": [
                {
                  "id": "7a3bd117-b6a5-47c4-aae1-dd22dbae0116",
                  "cellValue": "offer",
                  "linkTarget": "parameter",
                  "linkLabel": "Ransomware Intel Feed",
                  "subTarget": "offer1",
                  "style": "primary"
                },
                {
                  "id": "6eaf2743-0db8-495f-95a1-cad9a980d3d9",
                  "cellValue": "offer",
                  "linkTarget": "parameter",
                  "linkLabel": "TitaniumCloud API",
                  "subTarget": "offer2",
                  "style": "primary"
                }
              ]
            },
            "customWidth": "50",
            "name": "links - 0"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibility": {
        "parameterName": "section",
        "comparison": "isEqualTo",
        "value": "info"
      },
      "name": "moreinfo"
    }
  ],
  "fromTemplateId": "sentinel-ReversingLabs-CapabilitiesOverview",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}