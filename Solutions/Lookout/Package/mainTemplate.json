{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Lookout",
    "comments": "Solution template for Lookout"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "Lookout",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    }
  },
  "variables": {
    "_solutionName": "Lookout",
    "_solutionVersion": "3.0.0",
    "solutionId": "lookoutinc.lookout_mtd_sentinel",
    "_solutionId": "[variables('solutionId')]",
    "uiConfigId1": "LookoutAPI",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "LookoutAPI",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))))]",
    "dataConnectorVersion1": "1.0.0",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "dataConnectorCCPVersion": "1.0.0",
    "_dataConnectorContentIdConnectorDefinition2": "LookoutStreaming_Definition",
    "dataConnectorTemplateNameConnectorDefinition2": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition2')))]",
    "_dataConnectorContentIdConnections2": "LookoutStreaming_DefinitionConnections",
    "dataConnectorTemplateNameConnections2": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections2')))]",
    "dataCollectionEndpointId2": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "blanks": "[replace('b', 'b', '')]",
    "analyticRuleObject1": {
      "analyticRuleVersion1": "1.0.0",
      "_analyticRulecontentId1": "7593cc60-e294-402d-9202-279fb3c7d55f",
      "analyticRuleId1": "[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates', '7593cc60-e294-402d-9202-279fb3c7d55f')]",
      "analyticRuleTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-ar-',uniquestring('7593cc60-e294-402d-9202-279fb3c7d55f')))]",
      "_analyticRulecontentProductId1": "[concat(take(variables('_solutionId'),50),'-','ar','-', uniqueString(concat(variables('_solutionId'),'-','AnalyticsRule','-','7593cc60-e294-402d-9202-279fb3c7d55f','-', '1.0.0')))]"
    },
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "LookoutEvents",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "parserObject1": {
      "_parserName1": "[concat(parameters('workspace'),'/','Lookout Data Parser')]",
      "_parserId1": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Lookout Data Parser')]",
      "parserTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pr-',uniquestring('LookoutEvents-Parser')))]",
      "parserVersion1": "1.0.0",
      "parserContentId1": "LookoutEvents-Parser"
    },
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Lookout data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "[DEPRECATED] Lookout",
                  "publisher": "Lookout",
                  "descriptionMarkdown": "The [Lookout](https://lookout.com) data connector provides the capability to ingest [Lookout](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#commoneventfields) events into Microsoft Sentinel through the Mobile Risk API. Refer to [API documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) for more information. The [Lookout](https://lookout.com) data connector provides ability to get events which helps to examine potential security risks and more.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
                  "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Microsoft Sentinel Solution.",
                  "graphQueries": [
                    {
                      "metricName": "Total data received",
                      "legend": "Lookout_CL",
                      "baseQuery": "Lookout_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Lookout Events - All Activities.",
                      "query": "Lookout_CL\n | sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "Lookout_CL",
                      "lastDataReceivedQuery": "Lookout_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Lookout_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "Mobile Risk API Credentials/permissions",
                        "description": "**EnterpriseName** & **ApiKey** are required for Mobile Risk API. [See the documentation to learn more about API](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide). Check all [requirements and follow  the instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) for obtaining credentials."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This [Lookout](https://lookout.com) data connector uses Azure Functions to connect to the Mobile Risk API to pull its events into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Microsoft Sentinel Solution."
                    },
                    {
                      "description": "**STEP 1 - Configuration steps for the Mobile Risk API**\n\n [Follow the instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) to obtain the credentials. \n"
                    },
                    {
                      "description": "**STEP 2 - Follow below mentioned instructions to deploy the [Lookout](https://lookout.com) data connector and the associated Azure Function**\n\n>**IMPORTANT:** Before starting the deployment of the [Lookout](https://lookout.com) data connector, make sure to have the Workspace ID and Workspace Key ready (can be copied from the following).",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Workspace Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Follow below steps for automated deployment of the [Lookout](https://lookout.com) data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-lookoutapi-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **Function Name**, **Workspace ID**,**Workspace Key**,**Enterprise Name** & **Api Key** and deploy. \n4. Click **Create** to deploy.",
                      "title": "Azure Resource Manager (ARM) Template"
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Lookout",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Lookout"
                },
                "support": {
                  "name": "Lookout",
                  "tier": "Partner",
                  "link": "https://www.lookout.com/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "[DEPRECATED] Lookout",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Lookout",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Lookout"
        },
        "support": {
          "name": "Lookout",
          "tier": "Partner",
          "link": "https://www.lookout.com/support"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "[DEPRECATED] Lookout",
          "publisher": "Lookout",
          "descriptionMarkdown": "The [Lookout](https://lookout.com) data connector provides the capability to ingest [Lookout](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#commoneventfields) events into Microsoft Sentinel through the Mobile Risk API. Refer to [API documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) for more information. The [Lookout](https://lookout.com) data connector provides ability to get events which helps to examine potential security risks and more.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
          "graphQueries": [
            {
              "metricName": "Total data received",
              "legend": "Lookout_CL",
              "baseQuery": "Lookout_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "Lookout_CL",
              "lastDataReceivedQuery": "Lookout_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "Lookout_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Lookout Events - All Activities.",
              "query": "Lookout_CL\n | sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "Mobile Risk API Credentials/permissions",
                "description": "**EnterpriseName** & **ApiKey** are required for Mobile Risk API. [See the documentation to learn more about API](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide). Check all [requirements and follow  the instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) for obtaining credentials."
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This [Lookout](https://lookout.com) data connector uses Azure Functions to connect to the Mobile Risk API to pull its events into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Microsoft Sentinel Solution."
            },
            {
              "description": "**STEP 1 - Configuration steps for the Mobile Risk API**\n\n [Follow the instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) to obtain the credentials. \n"
            },
            {
              "description": "**STEP 2 - Follow below mentioned instructions to deploy the [Lookout](https://lookout.com) data connector and the associated Azure Function**\n\n>**IMPORTANT:** Before starting the deployment of the [Lookout](https://lookout.com) data connector, make sure to have the Workspace ID and Workspace Key ready (can be copied from the following).",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Workspace Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Follow below steps for automated deployment of the [Lookout](https://lookout.com) data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-lookoutapi-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **Function Name**, **Workspace ID**,**Workspace Key**,**Enterprise Name** & **Api Key** and deploy. \n4. Click **Create** to deploy.",
              "title": "Azure Resource Manager (ARM) Template"
            }
          ],
          "id": "[variables('_uiConfigId1')]",
          "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Microsoft Sentinel Solution."
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition2'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition2')]",
        "displayName": "Lookout Mobile Threat Detection Connector (via Codeless Connector Framework) (Preview)",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition2'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "LookoutStreaming_Definition",
                  "title": "Lookout Mobile Threat Detection Connector (via Codeless Connector Framework) (Preview)",
                  "publisher": "Microsoft",
                  "descriptionMarkdown": "The [Lookout Mobile Threat Detection](https://lookout.com) data connector provides the capability to ingest events related to mobile security risks into Microsoft Sentinel through the Mobile Risk API. Refer to [API documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) for more information. This connector helps you examine potential security risks detected in mobile devices.",
                  "graphQueriesTableName": "LookoutMtdV2_CL",
                  "graphQueries": [
                    {
                      "metricName": "Total events received",
                      "legend": "Events",
                      "baseQuery": "LookoutMtdV2_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Lookout Mobile Threat Detection Events - All Activities.",
                      "query": "LookoutMtdV2_CL\n | take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "LookoutMtdV2_CL",
                      "lastDataReceivedQuery": "LookoutMtdV2_CL\n | summarize Time = max(TimeGenerated)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": false,
                          "action": false
                        }
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "Connect Lookout Mobile Threat Defence connector to Microsoft Sentinel",
                      "instructions": [
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "Before connecting to Lookout, ensure the following prerequisites are completed."
                          }
                        },
                        {
                          "type": "Markdown",
                          "parameters": {
                            "content": "#### 1.  **ApiKey** is required for Mobile Threat Detection API. See the [documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) to learn more about API. Check all requirements and follow  the [instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) for obtaining credentials."
                          }
                        },
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "API key",
                            "placeholder": "Enter your API key ",
                            "type": "password",
                            "name": "applicationKey",
                            "required": true
                          }
                        },
                        {
                          "type": "ConnectionToggleButton",
                          "parameters": {
                            "connectLabel": "Connect",
                            "name": "toggle"
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition2')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition2'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition2')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Lookout"
                },
                "support": {
                  "name": "Lookout",
                  "tier": "Partner",
                  "link": "https://www.lookout.com/support"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections2')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "LookoutMtdDCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId2')]",
                "streamDeclarations": {
                  "Custom-LookoutMtdV2_CL": {
                    "columns": [
                      {
                        "name": "id",
                        "type": "string"
                      },
                      {
                        "name": "enterprise_guid",
                        "type": "string"
                      },
                      {
                        "name": "created_time",
                        "type": "datetime"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "change_type",
                        "type": "string"
                      },
                      {
                        "name": "device",
                        "type": "dynamic"
                      },
                      {
                        "name": "threat",
                        "type": "dynamic"
                      },
                      {
                        "name": "audit",
                        "type": "dynamic"
                      },
                      {
                        "name": "smishing_alert",
                        "type": "dynamic"
                      },
                      {
                        "name": "target",
                        "type": "dynamic"
                      },
                      {
                        "name": "actor",
                        "type": "dynamic"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-LookoutMtdV2_CL"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend actor_device_guid=tostring(actor.guid), log_type=tostring(type), TimeGenerated = todatetime(created_time)",
                    "outputStream": "Custom-LookoutMtdV2_CL"
                  }
                ]
              }
            },
            {
              "name": "LookoutMtdV2_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "location": "[parameters('workspace-location')]",
              "kind": null,
              "properties": {
                "schema": {
                  "name": "LookoutMtdV2_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "id",
                      "type": "string"
                    },
                    {
                      "name": "enterprise_guid",
                      "type": "string"
                    },
                    {
                      "name": "actor_device_guid",
                      "type": "string"
                    },
                    {
                      "name": "created_time",
                      "type": "datetime"
                    },
                    {
                      "name": "log_type",
                      "type": "string"
                    },
                    {
                      "name": "change_type",
                      "type": "string"
                    },
                    {
                      "name": "device",
                      "type": "dynamic"
                    },
                    {
                      "name": "threat",
                      "type": "dynamic"
                    },
                    {
                      "name": "audit",
                      "type": "dynamic"
                    },
                    {
                      "name": "smishing_alert",
                      "type": "dynamic"
                    },
                    {
                      "name": "target",
                      "type": "dynamic"
                    },
                    {
                      "name": "actor",
                      "type": "dynamic"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition2'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition2'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "LookoutStreaming_Definition",
          "title": "Lookout Mobile Threat Detection Connector (via Codeless Connector Framework) (Preview)",
          "publisher": "Microsoft",
          "descriptionMarkdown": "The [Lookout Mobile Threat Detection](https://lookout.com) data connector provides the capability to ingest events related to mobile security risks into Microsoft Sentinel through the Mobile Risk API. Refer to [API documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) for more information. This connector helps you examine potential security risks detected in mobile devices.",
          "graphQueriesTableName": "LookoutMtdV2_CL",
          "graphQueries": [
            {
              "metricName": "Total events received",
              "legend": "Events",
              "baseQuery": "LookoutMtdV2_CL"
            }
          ],
          "sampleQueries": [
            {
              "description": "Lookout Mobile Threat Detection Events - All Activities.",
              "query": "LookoutMtdV2_CL\n | take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "LookoutMtdV2_CL",
              "lastDataReceivedQuery": "LookoutMtdV2_CL\n | summarize Time = max(TimeGenerated)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": false,
                  "action": false
                }
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "Connect Lookout Mobile Threat Defence connector to Microsoft Sentinel",
              "instructions": [
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "Before connecting to Lookout, ensure the following prerequisites are completed."
                  }
                },
                {
                  "type": "Markdown",
                  "parameters": {
                    "content": "#### 1.  **ApiKey** is required for Mobile Threat Detection API. See the [documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) to learn more about API. Check all requirements and follow  the [instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) for obtaining credentials."
                  }
                },
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "API key",
                    "placeholder": "Enter your API key ",
                    "type": "password",
                    "name": "applicationKey",
                    "required": true
                  }
                },
                {
                  "type": "ConnectionToggleButton",
                  "parameters": {
                    "connectLabel": "Connect",
                    "name": "toggle"
                  }
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition2')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition2'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition2')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Lookout"
        },
        "support": {
          "name": "Lookout",
          "tier": "Partner",
          "link": "https://www.lookout.com/support"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections2')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections2'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections2')]",
        "displayName": "Lookout Mobile Threat Detection Connector (via Codeless Connector Framework) (Preview)",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "guidValue": {
              "defaultValue": "[[newGuid()]",
              "type": "securestring"
            },
            "innerWorkspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "connectorDefinitionName": {
              "defaultValue": "Lookout Mobile Threat Detection Connector (via Codeless Connector Framework) (Preview)",
              "type": "securestring",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "securestring"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "applicationKey": {
              "defaultValue": "applicationKey",
              "type": "securestring",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections2": "[variables('_dataConnectorContentIdConnections2')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections2')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections2'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections2')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Lookout"
                },
                "support": {
                  "name": "Lookout",
                  "tier": "Partner",
                  "link": "https://www.lookout.com/support"
                }
              }
            },
            {
              "name": "[[concat(parameters('innerWorkspace'),'/Microsoft.SecurityInsights/', 'LookoutMtd_PollingConfig', parameters('guidValue'))]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "SSE",
              "properties": {
                "connectorDefinitionName": "LookoutStreaming_Definition",
                "dataType": "LookoutMtdV2_CL",
                "dcrConfig": {
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                  "streamName": "Custom-LookoutMtdV2_CL"
                },
                "auth": {
                  "type": "OAuth2",
                  "isCredentialsInHeaders": true,
                  "ClientId": "NA",
                  "ClientSecret": "NA",
                  "APIKey": "[[parameters('applicationKey')]",
                  "grantType": "client_credentials",
                  "tokenEndpoint": "https://api.lookout.com/oauth2/token",
                  "tokenEndpointHeaders": {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "Accept": "application/json",
                    "Kind": "SSE"
                  },
                  "TokenEndpointQueryParameters": {}
                },
                "request": {
                  "apiEndpoint": "https://api.lookout.com/mra/stream/v2/events",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "yyyy-MM-dd'T'HH:mm:ss",
                  "rateLimitQps": 5,
                  "retryCount": 3,
                  "logResponseContent": true,
                  "startTimeAttributeName": "start_time",
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "text/event-stream",
                    "User-Agent": "Scuba"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.events"
                  ],
                  "format": "json"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections2'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('analyticRuleObject1').analyticRuleTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "LookoutThreatEvent_AnalyticalRules Analytics Rule with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('analyticRuleObject1').analyticRuleVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
              "name": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "apiVersion": "2023-02-01-preview",
              "kind": "Scheduled",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "description": "Created to detect new Threat events from the data which is recently synced by Lookout Solution.",
                "displayName": "Lookout - New Threat events found.",
                "enabled": false,
                "query": "Lookout_CL\n| where details_action_s == 'DETECTED' and type_s == 'THREAT'\n| extend DetailsPackageName = details_packageName_s\n| extend TargetPlatform = target_platform_s\n| extend TargetOsVersion = target_osVersion_s\n| extend Type = type_s\n| extend Severity = details_severity_s\n| extend Classifications = details_classifications_s\n| extend Platform = target_platform_s\n",
                "queryFrequency": "PT1H",
                "queryPeriod": "PT1H",
                "severity": "High",
                "suppressionDuration": "PT1H",
                "suppressionEnabled": false,
                "triggerOperator": "GreaterThan",
                "triggerThreshold": 0,
                "status": "Available",
                "requiredDataConnectors": [
                  {
                    "connectorId": "LookoutAPI",
                    "dataTypes": [
                      "Lookout_CL"
                    ]
                  }
                ],
                "tactics": [
                  "Discovery"
                ],
                "techniques": [
                  "T1057"
                ],
                "entityMappings": [
                  {
                    "fieldMappings": [
                      {
                        "identifier": "FullName",
                        "columnName": "DetailsPackageName"
                      },
                      {
                        "identifier": "OSFamily",
                        "columnName": "TargetPlatform"
                      },
                      {
                        "identifier": "OSVersion",
                        "columnName": "TargetOsVersion"
                      }
                    ],
                    "entityType": "Host"
                  }
                ],
                "customDetails": {
                  "Severity": "Severity",
                  "Classification": "Classifications",
                  "Platform": "Platform",
                  "Type": "Type"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-', last(split(variables('analyticRuleObject1').analyticRuleId1,'/'))))]",
              "properties": {
                "description": "Lookout Analytics Rule 1",
                "parentId": "[variables('analyticRuleObject1').analyticRuleId1]",
                "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
                "kind": "AnalyticsRule",
                "version": "[variables('analyticRuleObject1').analyticRuleVersion1]",
                "source": {
                  "kind": "Solution",
                  "name": "Lookout",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Lookout"
                },
                "support": {
                  "name": "Lookout",
                  "tier": "Partner",
                  "link": "https://www.lookout.com/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
        "contentKind": "AnalyticsRule",
        "displayName": "Lookout - New Threat events found.",
        "contentProductId": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "id": "[variables('analyticRuleObject1')._analyticRulecontentProductId1]",
        "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "LookoutEvents Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "Sets the time name for analysis"
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"**NOTE**: This workbook depends on a parser based on Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Azure Sentinel Solution.\"},\"name\":\"text - 0\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"fed5b1d8-5baa-44e8-b4e2-5da29af20794\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":7776000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 4\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"LookoutEvents \\n| where EventStartTime {TimeRange} and DetailsSeverity in (\\\"LOW\\\",\\\"MEDIUM\\\",\\\"HIGH\\\")\\n| summarize count() by DetailsSeverity\",\"size\":3,\"title\":\"Event Severity Chart\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"customWidth\":\"50\",\"name\":\"Event Severity Chart\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"LookoutEvents \\n| where EventStartTime  {TimeRange}\\n| where DetailsAction == \\\"DETECTED\\\" and DetailsSeverity in (\\\"LOW\\\",\\\"MEDIUM\\\",\\\"HIGH\\\")\\n| summarize count() by DetailsType,DetailsSeverity\\n| render barchart\",\"size\":1,\"title\":\"Active Issues\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"DetailsType\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"xAxis\":\"DetailsType\",\"group\":\"DetailsSeverity\",\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"LookoutEvents \\n| where  EventStartTime {TimeRange}\\n| project EventStartTime, Type, ActorType, DetailsApplicationName, TargetPlatform,DetailsAction,DetailsClassifications,DetailsSeverity\",\"size\":1,\"title\":\"Event List\",\"noDataMessage\":\"No events to display\",\"timeContext\":{\"durationMs\":7776000000},\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"TimeGenerated\",\"formatter\":5},{\"columnMatch\":\"EventVendor\",\"formatter\":5},{\"columnMatch\":\"ID\",\"formatter\":5},{\"columnMatch\":\"ChangeType\",\"formatter\":5},{\"columnMatch\":\"ActorId\",\"formatter\":5},{\"columnMatch\":\"DetailsActivationStatus\",\"formatter\":5},{\"columnMatch\":\"DetailsSecurityStatus\",\"formatter\":5},{\"columnMatch\":\"DetailsProtectionStatus\",\"formatter\":5},{\"columnMatch\":\"UpdatedDetails\",\"formatter\":5},{\"columnMatch\":\"DetailsDescription\",\"formatter\":5},{\"columnMatch\":\"DetailsPackageName\",\"formatter\":5},{\"columnMatch\":\"DetailsPath\",\"formatter\":5},{\"columnMatch\":\"DetailsFileName\",\"formatter\":5},{\"columnMatch\":\"DetailsPackageSha\",\"formatter\":5},{\"columnMatch\":\"DetailsAttributeChanges\",\"formatter\":5},{\"columnMatch\":\"DetailsId\",\"formatter\":5},{\"columnMatch\":\"DetailsAssessments\",\"formatter\":5},{\"columnMatch\":\"DetailsPcpReportingReason\",\"formatter\":5},{\"columnMatch\":\"DetailsPcpDeviceResponse\",\"formatter\":5},{\"columnMatch\":\"TargetType\",\"formatter\":5},{\"columnMatch\":\"TargetId\",\"formatter\":5},{\"columnMatch\":\"TargetEmailAddress\",\"formatter\":5},{\"columnMatch\":\"TargetOSVersion\",\"formatter\":5},{\"columnMatch\":\"TargetManufacturer\",\"formatter\":5},{\"columnMatch\":\"TargetModel\",\"formatter\":5}],\"rowLimit\":250,\"filter\":true,\"labelSettings\":[{\"columnId\":\"EventStartTime\",\"label\":\"Time\"},{\"columnId\":\"Type\"},{\"columnId\":\"ActorType\",\"label\":\"\"},{\"columnId\":\"DetailsApplicationName\",\"label\":\"ApplicationName\"},{\"columnId\":\"TargetPlatform\",\"label\":\"Platform\"},{\"columnId\":\"DetailsAction\",\"label\":\"Action\"},{\"columnId\":\"DetailsClassifications\",\"label\":\"Classifications\"},{\"columnId\":\"DetailsSeverity\",\"label\":\"Severity\"}]}},\"name\":\"Event List\"}],\"fromTemplateId\":\"sentinel-LookoutEvents\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=LookoutEvents; logoFileName=lookout.svg; description=Sets the time name for analysis; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Lookout; templateRelativePath=LookoutEvents.json; subtitle=; provider=Lookout}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Lookout",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Lookout"
                },
                "support": {
                  "name": "Lookout",
                  "tier": "Partner",
                  "link": "https://www.lookout.com/support"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "Lookout_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "LookoutAPI",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('parserObject1').parserTemplateSpecName1]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "LookoutEvents Data Parser with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('parserObject1').parserVersion1]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[variables('parserObject1')._parserName1]",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
              "location": "[parameters('workspace-location')]",
              "properties": {
                "eTag": "*",
                "displayName": "Lookout Data Parser",
                "category": "Microsoft Sentinel Parser",
                "functionAlias": "LookoutEvents",
                "query": "let LookoutEvents_view  = view () { \n    Lookout_CL\n    | extend \n        EventVendor=\"Lookout\",\n        EventProduct=\"Lookout Sentinel\",\n\t\tEnterpriseName=column_ifexists('enterprise_name_s', ''),\n\t\tDetailsActivationStatus=column_ifexists('details_activationStatus_s', ''),\n\t\tDetailsSecurityStatus=column_ifexists('details_securityStatus_s', ''),\n\t\tDetailsProtectionStatus=column_ifexists('details_protectionStatus_s', ''),\n\t\tUpdatedDetails=column_ifexists('updatedDetails_s', ''),\n\t\tDetailsDescription=column_ifexists('details_description_s', ''),\n\t\tDetailsApplicationName=column_ifexists('details_applicationName_s', ''),\n\t\tDetailsPackageName=column_ifexists('details_packageName_s', ''),\n\t\tDetailsPath=column_ifexists('details_path_s', ''),\n\t\tDetailsFileName=column_ifexists('details_fileName_s', ''),\n\t\tDetailsPackageSha=column_ifexists('details_packageSha_s', ''),\n\t\tDetailsAttributeChanges=column_ifexists('details_attributeChanges_s', ''),\n\t\tType=column_ifexists('type_s', ''),\n\t\tID=column_ifexists('id_s', ''),\n        EventStartTime=column_ifexists('eventTime_t', ''),\n\t\tEventEndTime=column_ifexists('eventTime_t', ''),\n\t\tChangeType=column_ifexists('changeType_s', ''),\n\t\tActorType=column_ifexists('actor_type_s', ''),\n\t\tActorId=column_ifexists('actor_id_g', ''),\n\t\tDetailsType=column_ifexists('details_type_s', ''),\n\t\tDetailsId=column_ifexists('details_id_g', ''),\n\t\tDetailsAction=column_ifexists('details_action_s', ''),\n\t\tDetailsSeverity=column_ifexists('details_severity_s', ''),\n\t\tDetailsClassifications=column_ifexists('details_classifications_s', ''),\n\t\tDetailsAssessments=column_ifexists('details_assessments_s', ''),\n\t\tDetailsPcpReportingReason=column_ifexists('details_pcpReportingReason_s', ''),\n\t\tDetailsPcpDeviceResponse=column_ifexists('details_pcpDeviceResponse_s', ''),\n\t\tTargetType=column_ifexists('target_type_s', ''),\n\t\tTargetId=column_ifexists('target_id_g', ''),\n\t\tTargetEmailAddress=column_ifexists('target_emailAddress_s', ''),\n\t\tTargetPlatform=column_ifexists('target_platform_s', ''),\n\t\tTargetOSVersion=column_ifexists('target_osVersion_s', ''),\n\t\tTargetManufacturer=column_ifexists('target_manufacturer_s', ''),\n\t\tTargetModel=column_ifexists('target_model_s', '')\n    | project\n        TimeGenerated, \n        Type,\n\t\tEnterpriseName,\n\t\tID,\n\t\tEventStartTime,\n\t\tEventEndTime,\n\t\tChangeType,\n\t\tActorType,\n\t\tActorId,\n        TargetType,\n        DetailsSeverity,\n\t\tDetailsClassifications,\n        DetailsActivationStatus,\n\t\tDetailsSecurityStatus,\n\t\tDetailsProtectionStatus,\n\t\tUpdatedDetails,\n\t\tDetailsDescription,\n\t\tDetailsApplicationName,\n\t\tDetailsPackageName,\n\t\tDetailsPath,\n\t\tDetailsFileName,\n\t\tDetailsPackageSha,\n\t\tDetailsAttributeChanges,\n\t\tDetailsType,\n\t\tDetailsId,\n\t\tDetailsAction,\n\t\tDetailsAssessments,\n\t\tDetailsPcpReportingReason,\n\t\tDetailsPcpDeviceResponse,\n\t\tTargetId,\n\t\tTargetEmailAddress,\n\t\tTargetPlatform,\n\t\tTargetOSVersion,\n\t\tTargetManufacturer,\n\t\tTargetModel\n};\nLookoutEvents_view\n",
                "functionParameters": "",
                "version": 2,
                "tags": [
                  {
                    "name": "description",
                    "value": ""
                  }
                ]
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
              "dependsOn": [
                "[variables('parserObject1')._parserId1]"
              ],
              "properties": {
                "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Lookout Data Parser')]",
                "contentId": "[variables('parserObject1').parserContentId1]",
                "kind": "Parser",
                "version": "[variables('parserObject1').parserVersion1]",
                "source": {
                  "name": "Lookout",
                  "kind": "Solution",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Lookout"
                },
                "support": {
                  "name": "Lookout",
                  "tier": "Partner",
                  "link": "https://www.lookout.com/support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "contentKind": "Parser",
        "displayName": "Lookout Data Parser",
        "contentProductId": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "id": "[concat(take(variables('_solutionId'),50),'-','pr','-', uniqueString(concat(variables('_solutionId'),'-','Parser','-',variables('parserObject1').parserContentId1,'-', '1.0.0')))]",
        "version": "[variables('parserObject1').parserVersion1]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2022-10-01",
      "name": "[variables('parserObject1')._parserName1]",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "eTag": "*",
        "displayName": "Lookout Data Parser",
        "category": "Microsoft Sentinel Parser",
        "functionAlias": "LookoutEvents",
        "query": "let LookoutEvents_view  = view () { \n    Lookout_CL\n    | extend \n        EventVendor=\"Lookout\",\n        EventProduct=\"Lookout Sentinel\",\n\t\tEnterpriseName=column_ifexists('enterprise_name_s', ''),\n\t\tDetailsActivationStatus=column_ifexists('details_activationStatus_s', ''),\n\t\tDetailsSecurityStatus=column_ifexists('details_securityStatus_s', ''),\n\t\tDetailsProtectionStatus=column_ifexists('details_protectionStatus_s', ''),\n\t\tUpdatedDetails=column_ifexists('updatedDetails_s', ''),\n\t\tDetailsDescription=column_ifexists('details_description_s', ''),\n\t\tDetailsApplicationName=column_ifexists('details_applicationName_s', ''),\n\t\tDetailsPackageName=column_ifexists('details_packageName_s', ''),\n\t\tDetailsPath=column_ifexists('details_path_s', ''),\n\t\tDetailsFileName=column_ifexists('details_fileName_s', ''),\n\t\tDetailsPackageSha=column_ifexists('details_packageSha_s', ''),\n\t\tDetailsAttributeChanges=column_ifexists('details_attributeChanges_s', ''),\n\t\tType=column_ifexists('type_s', ''),\n\t\tID=column_ifexists('id_s', ''),\n        EventStartTime=column_ifexists('eventTime_t', ''),\n\t\tEventEndTime=column_ifexists('eventTime_t', ''),\n\t\tChangeType=column_ifexists('changeType_s', ''),\n\t\tActorType=column_ifexists('actor_type_s', ''),\n\t\tActorId=column_ifexists('actor_id_g', ''),\n\t\tDetailsType=column_ifexists('details_type_s', ''),\n\t\tDetailsId=column_ifexists('details_id_g', ''),\n\t\tDetailsAction=column_ifexists('details_action_s', ''),\n\t\tDetailsSeverity=column_ifexists('details_severity_s', ''),\n\t\tDetailsClassifications=column_ifexists('details_classifications_s', ''),\n\t\tDetailsAssessments=column_ifexists('details_assessments_s', ''),\n\t\tDetailsPcpReportingReason=column_ifexists('details_pcpReportingReason_s', ''),\n\t\tDetailsPcpDeviceResponse=column_ifexists('details_pcpDeviceResponse_s', ''),\n\t\tTargetType=column_ifexists('target_type_s', ''),\n\t\tTargetId=column_ifexists('target_id_g', ''),\n\t\tTargetEmailAddress=column_ifexists('target_emailAddress_s', ''),\n\t\tTargetPlatform=column_ifexists('target_platform_s', ''),\n\t\tTargetOSVersion=column_ifexists('target_osVersion_s', ''),\n\t\tTargetManufacturer=column_ifexists('target_manufacturer_s', ''),\n\t\tTargetModel=column_ifexists('target_model_s', '')\n    | project\n        TimeGenerated, \n        Type,\n\t\tEnterpriseName,\n\t\tID,\n\t\tEventStartTime,\n\t\tEventEndTime,\n\t\tChangeType,\n\t\tActorType,\n\t\tActorId,\n        TargetType,\n        DetailsSeverity,\n\t\tDetailsClassifications,\n        DetailsActivationStatus,\n\t\tDetailsSecurityStatus,\n\t\tDetailsProtectionStatus,\n\t\tUpdatedDetails,\n\t\tDetailsDescription,\n\t\tDetailsApplicationName,\n\t\tDetailsPackageName,\n\t\tDetailsPath,\n\t\tDetailsFileName,\n\t\tDetailsPackageSha,\n\t\tDetailsAttributeChanges,\n\t\tDetailsType,\n\t\tDetailsId,\n\t\tDetailsAction,\n\t\tDetailsAssessments,\n\t\tDetailsPcpReportingReason,\n\t\tDetailsPcpDeviceResponse,\n\t\tTargetId,\n\t\tTargetEmailAddress,\n\t\tTargetPlatform,\n\t\tTargetOSVersion,\n\t\tTargetManufacturer,\n\t\tTargetModel\n};\nLookoutEvents_view\n",
        "functionParameters": "",
        "version": 2,
        "tags": [
          {
            "name": "description",
            "value": ""
          }
        ]
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2022-01-01-preview",
      "location": "[parameters('workspace-location')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Parser-', last(split(variables('parserObject1')._parserId1,'/'))))]",
      "dependsOn": [
        "[variables('parserObject1')._parserId1]"
      ],
      "properties": {
        "parentId": "[resourceId('Microsoft.OperationalInsights/workspaces/savedSearches', parameters('workspace'), 'Lookout Data Parser')]",
        "contentId": "[variables('parserObject1').parserContentId1]",
        "kind": "Parser",
        "version": "[variables('parserObject1').parserVersion1]",
        "source": {
          "kind": "Solution",
          "name": "Lookout",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Lookout"
        },
        "support": {
          "name": "Lookout",
          "tier": "Partner",
          "link": "https://www.lookout.com/support"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.0",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Lookout",
        "publisherDisplayName": "Lookout",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p> Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Lookout/ReleaseNotes.md\">Release Notes</a></p>\n<p> There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The <a href=\"https://lookout.com\">Lookout</a> solution provides the capability to ingest <a href=\"https://enterprise.support.lookout.com/hc/articles/115002741773-Mobile-Risk-API-Guide#commoneventfields\">Lookout events</a> into Microsoft Sentinel through the Mobile Risk API. It can get events which helps to examine potential security risks and more. Refer to <a href=\"https://enterprise.support.lookout.com/hc/articles/115002741773-Mobile-Risk-API-Guide\">API documentation</a> for more information .</p>\n<p><strong>Underlying Microsoft Technologies used:</strong></p>\n<p>This solution takes a dependency on the following technologies, and some of these dependencies either may be in <a href=\"https://azure.microsoft.com/support/legal/preview-supplemental-terms/\">Preview</a> state or might result in additional ingestion or operational costs:</p>\n<ol type=\"a\">\n<li><p><a href=\"https://docs.microsoft.com/azure/azure-monitor/logs/data-collector-api\">Azure Monitor HTTP Data Collector API</a></p>\n</li>\n<li><p><a href=\"https://aka.ms/Sentinel-CCP_Platform\">Microsoft Sentinel Codeless Connector Platform</a></p>\n</li>\n</ol>\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: Microsoft recommends installation of \"LookoutStreaming_Definition\" (via Codeless Connector Framework). This connector is build on the Codeless Connector Framework (CCF), which uses the Log Ingestion API, which replaces ingestion via the <a href='https://aka.ms/Sentinel-Logs_migration' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>. CCF-based data connectors also support <a href='https://aka.ms/Sentinel-DCR_Overview' style='color:#1890F1;'>Data Collection Rules</a> (DCRs) offering transformations and enrichment.</p>\n<p><span style='color:red; font-weight:bold;'>Important</span>: While the updated connector(s) can coexist with their legacy versions, running them together will result in duplicated data ingestion. You can disable the older versions of these connectors to avoid duplication of data..</p>\n<p><strong>Data Connectors:</strong> 2, <strong>Parsers:</strong> 1, <strong>Workbooks:</strong> 1, <strong>Analytic Rules:</strong> 1</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Lookout/Workbooks/Images/Logo/lookout.svg\"width=\"75px\"height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Lookout",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Lookout"
        },
        "support": {
          "name": "Lookout",
          "tier": "Partner",
          "link": "https://www.lookout.com/support"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections2')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            },
            {
              "kind": "AnalyticsRule",
              "contentId": "[variables('analyticRuleObject1')._analyticRulecontentId1]",
              "version": "[variables('analyticRuleObject1').analyticRuleVersion1]"
            },
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "Parser",
              "contentId": "[variables('parserObject1').parserContentId1]",
              "version": "[variables('parserObject1').parserVersion1]"
            }
          ]
        },
        "firstPublishDate": "2021-10-18",
        "providers": [
          "Lookout"
        ],
        "categories": {
          "domains": [
            "Security - Threat Protection"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
