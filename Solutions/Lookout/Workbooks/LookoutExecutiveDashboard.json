{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## Lookout Mobile Security - Executive Dashboard\n\n**Real-time mobile threat detection and device security monitoring**"
      },
      "name": "text - title"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "TimeRange",
            "name": "TimeRange",
            "label": "Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 604800000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 3600000,
                  "createdTime": "2023-01-01T00:00:00.000Z",
                  "isInitialTime": false,
                  "grain": 1,
                  "useDashboardTimeRange": false
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 2592000000
                }
              ],
              "allowCustom": true
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - time"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, Severity = tostring(threat.severity)\n| where EventType == \"THREAT\" and Severity in (\"HIGH\", \"CRITICAL\")\n| summarize Count = count()",
        "size": 4,
        "title": "Active High Severity Threats",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Count",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "Count",
            "formatter": 12,
            "formatOptions": {
              "palette": "red"
            }
          },
          "showBorder": true,
          "size": "auto"
        }
      },
      "customWidth": "20",
      "name": "query - high severity count"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, Status = tostring(threat.status)\n| where EventType == \"THREAT\" and Status in (\"RESOLVED\", \"CLOSED\", \"BLOCKED\")\n| summarize Count = count()",
        "size": 4,
        "title": "Threats Resolved",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Count",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "Count",
            "formatter": 12,
            "formatOptions": {
              "palette": "green"
            }
          },
          "showBorder": true
        }
      },
      "customWidth": "20",
      "name": "query - threats resolved"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, DeviceEmail = tostring(threat.device.email)\n| where EventType == \"THREAT\" and isnotempty(DeviceEmail)\n| summarize Count = dcount(DeviceEmail)",
        "size": 4,
        "title": "Devices with Threats",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Count",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "Count",
            "formatter": 12,
            "formatOptions": {
              "palette": "orange"
            }
          },
          "showBorder": true
        }
      },
      "customWidth": "20",
      "name": "query - devices with threats"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type\n| where EventType == \"AUDIT\"\n| summarize Count = count()",
        "size": 4,
        "title": "Audit Events",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Count",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "Count",
            "formatter": 12,
            "formatOptions": {
              "palette": "blue"
            }
          },
          "showBorder": true
        }
      },
      "customWidth": "20",
      "name": "query - audit events"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, TotalEvents = tostring(\"Total\")\n| summarize Count = count()",
        "size": 4,
        "title": "Total Events",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Count",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "Count",
            "formatter": 12,
            "formatOptions": {
              "palette": "gray"
            }
          },
          "showBorder": true
        }
      },
      "customWidth": "20",
      "name": "query - total events"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, ThreatType = tostring(threat.type)\n| where EventType == \"THREAT\" and isnotempty(ThreatType)\n| summarize Count = count() by ThreatType\n| sort by Count desc\n| take 10",
        "size": 0,
        "title": "Threat Type Distribution",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "barchart",
        "chartSettings": {
          "seriesLabelSettings": [
            {
              "seriesName": "Count",
              "color": "orange"
            }
          ]
        }
      },
      "customWidth": "33",
      "name": "query - threat distribution"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, Status = tostring(threat.status)\n| where EventType == \"THREAT\"\n| summarize Count = count() by Status\n| sort by Count desc",
        "size": 0,
        "title": "Threat Status Overview",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart"
      },
      "customWidth": "33",
      "name": "query - threat status"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, Severity = tostring(threat.severity)\n| where EventType == \"THREAT\" and isnotempty(Severity)\n| summarize Count = count() by Severity\n| sort by Count desc",
        "size": 0,
        "title": "Severity Breakdown",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "columnchart",
        "chartSettings": {
          "ySettings": {
            "numberFormatSettings": {
              "unit": 0,
              "options": {
                "style": "decimal"
              }
            }
          }
        }
      },
      "customWidth": "34",
      "name": "query - severity breakdown"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, Severity = tostring(threat.severity)\n| where EventType == \"THREAT\"\n| summarize Count = count() by bin(TimeGenerated, 1h), Severity\n| render timechart",
        "size": 0,
        "title": "Threat Activity Timeline",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "linechart"
      },
      "customWidth": "50",
      "name": "query - timeline"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type, Platform = tostring(threat.device.platform)\n| where EventType == \"THREAT\" and isnotempty(Platform)\n| summarize Count = count() by Platform",
        "size": 0,
        "title": "Devices by Platform",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart"
      },
      "customWidth": "50",
      "name": "query - platform distribution"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend \n    EventType = log_type,\n    ThreatType = tostring(threat.type),\n    Severity = tostring(threat.severity),\n    Status = tostring(threat.status),\n    DeviceEmail = tostring(threat.device.email),\n    DevicePlatform = tostring(threat.device.platform),\n    ThreatDetails = tostring(threat.details.network_ssid)\n| where EventType == \"THREAT\" and Severity in (\"HIGH\", \"CRITICAL\")\n| project \n    TimeGenerated,\n    Severity,\n    ThreatType,\n    Status,\n    DeviceEmail,\n    DevicePlatform,\n    ThreatDetails\n| sort by TimeGenerated desc\n| take 20",
        "size": 0,
        "title": "HIGH PRIORITY - Recent High-Severity Threats",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Severity",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "colors",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "CRITICAL",
                    "representation": "redBright",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "==",
                    "thresholdValue": "HIGH",
                    "representation": "orange",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "gray",
                    "text": "{0}{1}"
                  }
                ]
              }
            },
            {
              "columnMatch": "Status",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "colors",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "OPEN",
                    "representation": "red",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "==",
                    "thresholdValue": "RESOLVED",
                    "representation": "green",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "blue",
                    "text": "{0}{1}"
                  }
                ]
              }
            }
          ]
        }
      },
      "customWidth": "100",
      "name": "query - high priority table"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend \n    EventType = log_type,\n    DeviceEmail = tostring(threat.device.email),\n    ThreatType = tostring(threat.type),\n    Severity = tostring(threat.severity)\n| where EventType == \"THREAT\" and isnotempty(DeviceEmail)\n| summarize \n    ThreatCount = count(),\n    HighestSeverity = max(Severity),\n    ThreatTypes = make_set(ThreatType),\n    LastSeen = max(TimeGenerated)\n    by DeviceEmail\n| sort by ThreatCount desc\n| take 20",
        "size": 0,
        "title": "Most Targeted Devices",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "table"
      },
      "customWidth": "50",
      "name": "query - targeted devices"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend \n    EventType = log_type,\n    NetworkSSID = tostring(threat.details.network_ssid),\n    ThreatType = tostring(threat.type)\n| where EventType == \"THREAT\" and ThreatType == \"NETWORK\" and isnotempty(NetworkSSID)\n| summarize \n    DetectionCount = count(),\n    UniqueDevices = dcount(tostring(threat.device.email)),\n    LastSeen = max(TimeGenerated)\n    by NetworkSSID\n| sort by DetectionCount desc\n| take 15",
        "size": 0,
        "title": "Rogue WiFi Networks Detected",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "table"
      },
      "customWidth": "50",
      "name": "query - rogue networks"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend EventType = log_type\n| summarize Count = count() by EventType\n| render piechart",
        "size": 0,
        "title": "Event Type Distribution",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart"
      },
      "customWidth": "50",
      "name": "query - event types"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "LookoutMtdV2_CL\n| where TimeGenerated {TimeRange}\n| extend \n    EventType = log_type,\n    ActorType = tostring(actor.type)\n| where EventType == \"AUDIT\" and isnotempty(ActorType)\n| summarize Count = count() by ActorType\n| sort by Count desc",
        "size": 0,
        "title": "Audit Events by Actor",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "columnchart"
      },
      "customWidth": "50",
      "name": "query - audit actors"
    }
  ],
  "styleSettings": {},
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
