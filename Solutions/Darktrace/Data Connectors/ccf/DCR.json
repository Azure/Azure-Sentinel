{
    "apiVersion": "2024-03-11",
    "id": "/subscriptions/20ac8776-c56d-4158-a314-56ed60f9d5d8/resourceGroups/Tom-test_group/providers/Microsoft.Insights/dataCollectionRules/darktrace-dcr",
    "name": "darktrace-dcr",
    "type": "microsoft.insights/datacollectionrules",
    "location": "eastus",
    "properties": {
        "immutableId": "dcr-39dcdb8e9916417eb7e280bc5ae57d2e",
        "dataCollectionEndpointId": "/subscriptions/20ac8776-c56d-4158-a314-56ed60f9d5d8/resourceGroups/Tom-test_group/providers/Microsoft.Insights/dataCollectionEndpoints/darktrace-dce",
        "streamDeclarations": {
            "Custom-DarktraceModelAlerts": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "alertTime",
                        "type": "datetime"
                    },
                    {
                        "name": "alertUrl",
                        "type": "string"
                    },
                    {
                        "name": "modelName",
                        "type": "string"
                    },
                    {
                        "name": "score",
                        "type": "int"
                    },
                    {
                        "name": "deviceHostname",
                        "type": "string"
                    },
                    {
                        "name": "sourceIp",
                        "type": "string"
                    },
                    {
                        "name": "destIp",
                        "type": "string"
                    },
                    {
                        "name": "message",
                        "type": "string"
                    }
                ]
            },
            "Custom-DarktraceASM": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "action",
                        "type": "string"
                    },
                    {
                        "name": "alertTime",
                        "type": "datetime"
                    },
                    {
                        "name": "alertTitle",
                        "type": "string"
                    },
                    {
                        "name": "assetName",
                        "type": "string"
                    },
                    {
                        "name": "rating",
                        "type": "string"
                    },
                    {
                        "name": "state",
                        "type": "string"
                    }
                ]
            },
            "Custom-DarktraceEMAIL": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "actions",
                        "type": "dynamic"
                    },
                    {
                        "name": "alertTime",
                        "type": "datetime"
                    },
                    {
                        "name": "anomalyScore",
                        "type": "int"
                    },
                    {
                        "name": "from",
                        "type": "string"
                    },
                    {
                        "name": "recipients",
                        "type": "dynamic"
                    },
                    {
                        "name": "subject",
                        "type": "string"
                    },
                    {
                        "name": "url",
                        "type": "string"
                    }
                ]
            },
            "Custom-DarktraceIncidents": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "aiaScore",
                        "type": "int"
                    },
                    {
                        "name": "bestAssetName",
                        "type": "string"
                    },
                    {
                        "name": "currentGroup",
                        "type": "string"
                    },
                    {
                        "name": "deviceHostname",
                        "type": "string"
                    },
                    {
                        "name": "deviceIp",
                        "type": "string"
                    },
                    {
                        "name": "groupCategory",
                        "type": "string"
                    },
                    {
                        "name": "groupScore",
                        "type": "int"
                    },
                    {
                        "name": "incidentEventTime",
                        "type": "datetime"
                    },
                    {
                        "name": "incidentEventTitle",
                        "type": "string"
                    },
                    {
                        "name": "summary",
                        "type": "string"
                    },
                    {
                        "name": "url",
                        "type": "string"
                    }
                ]
            },
            "Custom-DarktraceResponseActions": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "action",
                        "type": "string"
                    },
                    {
                        "name": "alertTime",
                        "type": "datetime"
                    },
                    {
                        "name": "deviceHostname",
                        "type": "string"
                    },
                    {
                        "name": "deviceIp",
                        "type": "string"
                    },
                    {
                        "name": "model",
                        "type": "string"
                    },
                    {
                        "name": "score",
                        "type": "int"
                    },
                    {
                        "name": "state",
                        "type": "string"
                    },
                    {
                        "name": "url",
                        "type": "string"
                    }
                ]
            },
            "Custom-DarktraceSystemStatusAlerts": {
                "columns": [
                    {
                        "name": "TimeGenerated",
                        "type": "datetime"
                    },
                    {
                        "name": "alertTime",
                        "type": "datetime"
                    },
                    {
                        "name": "friendlyModelName",
                        "type": "string"
                    },
                    {
                        "name": "message",
                        "type": "string"
                    },
                    {
                        "name": "priority",
                        "type": "string"
                    },
                    {
                        "name": "severity",
                        "type": "int"
                    },
                    {
                        "name": "status",
                        "type": "string"
                    },
                    {
                        "name": "url",
                        "type": "string"
                    }
                ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "/subscriptions/20ac8776-c56d-4158-a314-56ed60f9d5d8/resourceGroups/Tom-test_group/providers/microsoft.OperationalInsights/Workspaces/DylansNewLAW",
                    "workspaceId": "1833059b-ff58-4903-8f98-61b3ce3541b2",
                    "name": "workspace"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-DarktraceModelAlerts"
                ],
                "destinations": [
                    "workspace"
                ],
                "transformKql": "source",
                "outputStream": "Custom-DarktraceModelAlerts_CL"
            },
            {
                "streams": [
                    "Custom-DarktraceASM"
                ],
                "destinations": [
                    "workspace"
                ],
                "transformKql": "source",
                "outputStream": "Custom-DarktraceASM_CL"
            },
            {
                "streams": [
                    "Custom-DarktraceEMAIL"
                ],
                "destinations": [
                    "workspace"
                ],
                "transformKql": "source",
                "outputStream": "Custom-DarktraceEMAIL_CL"
            },
            {
                "streams": [
                    "Custom-DarktraceIncidents"
                ],
                "destinations": [
                    "workspace"
                ],
                "transformKql": "source",
                "outputStream": "Custom-DarktraceIncidents_CL"
            },
            {
                "streams": [
                    "Custom-DarktraceResponseActions"
                ],
                "destinations": [
                    "workspace"
                ],
                "transformKql": "source",
                "outputStream": "Custom-DarktraceResponseActions_CL"
            },
            {
                "streams": [
                    "Custom-DarktraceSystemStatusAlerts"
                ],
                "destinations": [
                    "workspace"
                ],
                "transformKql": "source",
                "outputStream": "Custom-DarktraceSystemStatusAlerts_CL"
            }
        ],
        "provisioningState": "Succeeded"
    },
    "systemData": {
        "createdBy": "dylan.osullivan@slammar.onmicrosoft.com",
        "createdByType": "User",
        "createdAt": "2026-01-16T12:19:53.3585798Z",
        "lastModifiedBy": "dylan.osullivan@slammar.onmicrosoft.com",
        "lastModifiedByType": "User",
        "lastModifiedAt": "2026-01-21T15:51:05.0349034Z"
    },
    "etag": "\"210372c4-0000-0100-0000-6970f5ea0000\""
}