id: 05DE0EAF-01BC-4615-99FC-2EC769864B34
name: Darktrace Incident Event
kind: NRT
description: Creates a Sentinel Incident from a Darktrace Incident Event.
severity: High
requiredDataConnectors:
  - connectorId: DarktraceLogIngestionAPIConnector
    dataTypes:
      - DarktraceIncidents_CL
tactics: []
relevantTechniques: []
query: |
  DarktraceIncidents_CL
  | extend SentinelSeverity = case(groupCategory == "suspicious", "Medium",
  groupCategory == "critical", "High", "Informational")
  | extend ProviderName = "Darktrace"
eventGroupingSettings:
  aggregationKind: AlertPerResult
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: deviceIp
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: deviceHostname
customDetails:
  Asset: bestAssetName
  IncidentEventScore: aiaScore
  IncidentScore: groupScore
  CurrentGroup: currentGroup
  PreviousGroups: groupPreviousGroups
  StartTime: startTime
  EndTime: endTime
  CustomLabel: customLabel
  AssetDetails: devices
alertDetailsOverride:
  alertDisplayNameFormat: 'Darktrace Incident Event: {{incidentEventTitle}} '
  alertDescriptionFormat: '{{summary}}'
  alertSeverityColumnName: SentinelSeverity
  alertDynamicProperties:
    - alertProperty: AlertLink
      value: url
    - alertProperty: ProductName
      value: darktraceProduct
    - alertProperty: ProviderName
      value: ProviderName
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5M
    matchingMethod: AllEntities
version: 1.0.0