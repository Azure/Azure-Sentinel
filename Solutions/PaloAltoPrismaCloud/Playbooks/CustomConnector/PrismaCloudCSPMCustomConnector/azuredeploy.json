{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "CustomConnectorName": {
      "defaultValue": "PrismaCloudCSPMCustomConnector",
      "type": "String",
      "metadata": {
        "description": "Name of the custom connector, if you want to change the default name, make sure to use the same in all Prisma Cloud automation playbooks as well"
      }
    },
    "PrismaCloudAPIURL": {
      "type": "String",
      "metadata": {
        "description": "Check documentation of prisma cloud for Actual API url (https://prisma.pan.dev/api/cloud/api-urls) . Note: Do NOT prefix with https:// or http:// etc"
      }
    }

  },
  "variables": {
    "api_host": "[replace(replace(parameters('PrismaCloudAPIURL'),'https://',''),'http://','')]",
    "ServiceName": "[concat('https://', variables('api_host'))]"
  },
  "resources": [
    {
      "type": "Microsoft.Web/customApis",
      "apiVersion": "2016-06-01",
      "name": "[parameters('CustomConnectorName')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "capabilities": [],
        "description": "[concat(parameters('CustomConnectorName'),' connects to Prisma Cloud CSPM services end point to runs any Prisma supported API get/post/patch calls and gives response back in JSON format. \n\nNote: For better understanding , check https://prisma.pan.dev/api/cloud/cspm/')]",
        "displayName": "[parameters('CustomConnectorName')]",
        "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANMAAAEACAYAAAAp2kPsAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAAAOWaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0OCA3OS4xNjM4NTgsIDIwMTkvMDMvMDYtMDM6MTg6MzYgICAgICAgICI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpkYW09Imh0dHA6Ly93d3cuZGF5LmNvbS9kYW0vMS4wIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgIGRhbTpQaHlzaWNhbGhlaWdodGluaW5jaGVzPSIzLjU1NjM2NTcyODM3ODI5NiIKICAgZGFtOlBoeXNpY2Fsd2lkdGhpbmluY2hlcz0iMTcuNjE1MTIzNzQ4Nzc5Mjk3IgogICBkYW06RmlsZWZvcm1hdD0iUE5HIgogICBkYW06UHJvZ3Jlc3NpdmU9Im5vIgogICBkYW06Qml0c3BlcnBpeGVsPSIzMiIKICAgZGFtOk1JTUV0eXBlPSJpbWFnZS9wbmciCiAgIGRhbTpQaHlzaWNhbHdpZHRoaW5kcGk9IjcyIgogICBkYW06UGh5c2ljYWxoZWlnaHRpbmRwaT0iNzIiCiAgIGRhbTpOdW1iZXJvZmltYWdlcz0iMSIKICAgZGFtOk51bWJlcm9mdGV4dHVhbGNvbW1lbnRzPSIwIgogICB0aWZmOkltYWdlTGVuZ3RoPSIyNTYiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iMTI2OCIKICAgZGM6Zm9y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uZNiEoLa0s+fO3h9WH/4yuSYhKA4jt6b5XWaFZNkDko/Z46j92V5nWbHJFmDYpVssPrwlUUxSbagWCU7Pvn2ocnj7YtjkkxB3bp5jVUyxOK106qYJENQ20d3XR3ewQKLD19ZHZNED4oPaG2ytk5FYpKoQfGQFLusrVOxmCRiUKySbZbu7BWNSSIFxSrZp2flWzneXjwmiRLUx2++OryCZVaunarEJN6D4ji6H1YevlItJvEcFNdKvlhYp6oxicegWCV/LKxT9ZjEW1Cskk+6s9fzeHuTmMRLUKySX72PtzeLSTwExR0833o+fKVpTGI5KI6j+9dznZrHJFaD4lophl7r1CUmsRYUqxSHQrp998Hwrp1uMYmloFilWO7ca/9osK4xiYWgFBKrFE/rD3K7xyQ9g9L/k+PoMbV++IqJmKRXUDwkJbaW62QmJmkdFKsUX8t1MhWTtAyKVcrh/a9+GF7VdeXxE8NrU3To650vv6v6eYEekvLac7li+vz7X4dXuehvttS+yWQ2JmkRVDa6c/nhG9eGdyjJ3Ld551m4bQ5MZTomISh4YT4mISh44CImIShY5yYmIShY5iomIShY5S4mIShY5DImIShY4zYmIShY4jomIShY4T4mIShYECImISj0FiYmISj0FComISj0Ei4mISj0EDImISi0FjYmISi0FDomISi0Ej4mISi0kCImISjUliYmISjUlComISjUki4mISjUkDImISiUljYmISiUlDomISiUkj4mISiUQEwDgsJaxHQOQWENYtpBUFiKmPYgKCxBTAcQFOYipiMICnMQ0wkEhamIaQKCwhTENBFB4RRimoGgcAwxzURQOISYFiAo7ENMCxEUdhHTCgSF84hpJYLCiJgKICgIMRVCUCCmgggqN2IqjKDyIqYKCConYqqEoPIhpooIKhdiqoyg8iCmBggqB2JqhKDiI6aGCCo2YmqMoOIipg4IKiZi6oSg4iGmjggqFmLqjKDiICYDCCoGYjKCoPwjJkMIyjdiMoag/CImgwjKJ2IyiqD8ISbDCMoXYjKOoPwgJgcIygdicoKg7CMmRwjKNmJyhqDsIiaHCMomYnKKoOwhJscIyhZico6g7CCmAAjKBmIKgqD6I6ZACKovYgqGoPohpoAIqg9iCoqg2iOmwAiqLWIKjqDaIaYECKoNYkriWVD8ltex2fwfs//NjmqcgcgAAAAASUVORK5CYII=",
        "backendService": {
          "serviceUrl": "[variables('ServiceName')]"
        },
        "apiType": "Rest",
        "swagger": {
          "swagger": "2.0",
          "info": {
            "version": "1.0.0",
            "title": "Prisma Cloud",
            "description": "This custom connector connects to Prisma Cloud CSPM services end point to runs any Prisma supported API get/post/patch calls and gives response back in JSON format. \n\nNote: For better understanding , check https://prisma.pan.dev/api/cloud/cspm/')]"
          },
          "host": "[replace(replace(parameters('PrismaCloudAPIURL'),'https://',''),'http://','')]",
          "basePath": "/",
          "schemes": [ "https" ],
          "consumes": [],
          "produces": [ "application/json" ],
          "paths": {
            "/auth_token/extend": {
              "get": {
                "summary": "Refresh Token",
                "description": "Refresh Token",
                "operationId": "RefreshToken",
                "parameters": [
                  {
                    "name": "accept",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json; charset=UTF-8",
                    "description": "accept"
                  },
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json",
                    "description": "content-type"
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/login": {
              "post": {
                "summary": "Login Generate Token",
                "description": "Login Generate Token",
                "operationId": "LoginGenerateToken",
                "parameters": [
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json; charset=UTF-8",
                    "description": "content-type"
                  },
                  {
                    "name": "body",
                    "in": "body",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "customerName": {
                          "type": "string",
                          "description": "customerName"
                        },
                        "password": {
                          "type": "string",
                          "description": "password",
                          "title": "",
                          "format": "password"
                        },
                        "prismaId": {
                          "type": "string",
                          "description": "prismaId"
                        },
                        "username": {
                          "type": "string",
                          "description": "username",
                          "title": ""
                        }
                      },
                      "default": {
                        "customerName": "string",
                        "password": "string",
                        "prismaId": "string",
                        "username": "string"
                      },
                      "required": [ "password", "username" ]
                    },
                    "required": true
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string",
                          "description": "message"
                        },
                        "token": {
                          "type": "string",
                          "description": "token"
                        },
                        "customerNames": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "customerName": {
                                "type": "string",
                                "description": "customerName"
                              },
                              "prismaId": {
                                "type": "string",
                                "description": "prismaId"
                              },
                              "tosAccepted": {
                                "type": "boolean",
                                "description": "tosAccepted"
                              }
                            }
                          },
                          "description": "customerNames"
                        }
                      }
                    }
                  }
                }
              }
            },
            "/v2/inventory": {
              "get": {
                "summary": "Asset Inventory View V2",
                "description": "Asset Inventory View V2",
                "operationId": "AssetInventoryViewV2",
                "parameters": [
                  {
                    "name": "timeType",
                    "default": "relative",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeAmount",
                    "default": "40",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeUnit",
                    "default": "hour",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "accept",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json; charset=UTF-8",
                    "description": "accept"
                  },
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json",
                    "description": "content-type"
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/v2/inventory/trend": {
              "get": {
                "summary": "Asset Inventory Trend View V2",
                "description": "Asset Inventory Trend View V2",
                "operationId": "AssetInventoryTrendViewV2",
                "parameters": [
                  {
                    "name": "timeType",
                    "default": "relative",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeAmount",
                    "default": "40",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeUnit",
                    "default": "hour",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "accept",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json; charset=UTF-8",
                    "description": "accept"
                  },
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json",
                    "description": "content-type"
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/resource/scan_info": {
              "get": {
                "summary": "Assets Resource Scan",
                "description": "Assets Resource Scan",
                "operationId": "AssetsResourceScan",
                "parameters": [
                  {
                    "name": "timeType",
                    "default": "to_now",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeAmount",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "timeUnit",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "cloud.account",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "cloud.type",
                    "default": "azure",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "cloud.region",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "account.group",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.complianceStandard",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.complianceRequirement",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.complianceSection",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "limit",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "scan.status",
                    "default": "all",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "pageToken",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "timestamp": {
                          "type": "integer",
                          "format": "int32",
                          "description": "timestamp"
                        },
                        "totalMatchedCount": {
                          "type": "integer",
                          "format": "int32",
                          "description": "totalMatchedCount"
                        },
                        "pageSize": {
                          "type": "integer",
                          "format": "int32",
                          "description": "pageSize"
                        },
                        "resources": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "id"
                              },
                              "name": {
                                "type": "string",
                                "description": "name"
                              },
                              "accountId": {
                                "type": "string",
                                "description": "accountId"
                              },
                              "accountName": {
                                "type": "string",
                                "description": "accountName"
                              },
                              "regionId": {
                                "type": "string",
                                "description": "regionId"
                              },
                              "regionName": {
                                "type": "string",
                                "description": "regionName"
                              },
                              "cloudType": {
                                "type": "string",
                                "description": "cloudType"
                              },
                              "rrn": {
                                "type": "string",
                                "description": "rrn"
                              },
                              "overallPassed": {
                                "type": "boolean",
                                "description": "overallPassed"
                              },
                              "scannedPolicies": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "id": {
                                      "type": "string",
                                      "description": "id"
                                    },
                                    "name": {
                                      "type": "string",
                                      "description": "name"
                                    },
                                    "severity": {
                                      "type": "string",
                                      "description": "severity"
                                    },
                                    "labels": {
                                      "type": "array",
                                      "items": { "type": "string" },
                                      "description": "labels"
                                    },
                                    "passed": {
                                      "type": "boolean",
                                      "description": "passed"
                                    }
                                  }
                                },
                                "description": "scannedPolicies"
                              },
                              "alertStatus": {
                                "type": "object",
                                "properties": {
                                  "high": {
                                    "type": "integer",
                                    "format": "int32",
                                    "description": "high"
                                  },
                                  "medium": {
                                    "type": "integer",
                                    "format": "int32",
                                    "description": "medium"
                                  },
                                  "low": {
                                    "type": "integer",
                                    "format": "int32",
                                    "description": "low"
                                  },
                                  "critical": {
                                    "type": "integer",
                                    "format": "int32",
                                    "description": "critical"
                                  },
                                  "informational": {
                                    "type": "integer",
                                    "format": "int32",
                                    "description": "informational"
                                  }
                                },
                                "description": "alertStatus"
                              },
                              "appNames": {
                                "type": "array",
                                "items": { "type": "string" },
                                "description": "appNames"
                              },
                              "unifiedAssetId": {
                                "type": "string",
                                "description": "unifiedAssetId"
                              },
                              "resourceDetailsAvailable": {
                                "type": "boolean",
                                "description": "resourceDetailsAvailable"
                              },
                              "resourceConfigJsonAvailable": {
                                "type": "boolean",
                                "description": "resourceConfigJsonAvailable"
                              },
                              "assetType": {
                                "type": "string",
                                "description": "assetType"
                              }
                            }
                          },
                          "description": "resources"
                        }
                      }
                    }
                  }
                }
              }
            },
            "/uai/v1/asset": {
              "post": {
                "summary": "Assets Enrichment",
                "description": "Assets Enrichment",
                "operationId": "AssetsEnrichment",
                "parameters": [
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json",
                    "description": "content-type"
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  },
                  {
                    "name": "body",
                    "in": "body",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "assetId": {
                          "type": "string",
                          "description": "assetId",
                          "title": ""
                        },
                        "type": {
                          "type": "string",
                          "description": "type",
                          "title": "",
                          "enum": [ "EXTERNAL_FINDING", "ASSET", "ALERTS", "RAW_CONFIG", "NETWORK", "TIMELINE", "EXTERNAL_INTEGRATION", "ASSET_DATA_INDICATORS", "RELATIONSHIPS" ]
                        }
                      },
                      "default": {
                        "assetId": "94e06523e93b9b0f15ed03da031c95d5",
                        "type": "ALERTS"
                      },
                      "required": [ "type", "assetId" ]
                    },
                    "required": true
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/alert": {
              "get": {
                "summary": "List Alerts",
                "description": "List Alerts",
                "operationId": "ListAlerts",
                "parameters": [
                  {
                    "name": "timeType",
                    "default": "relative",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeAmount",
                    "default": "30",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "timeUnit",
                    "default": "day",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "detailed",
                    "default": "false",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "alert.id",
                    "default": "P-301",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "cloud.account",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "account.group",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "cloud.type",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "cloud.region",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.id",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.name",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.severity",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.label",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "policy.type",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "alertRule.name",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "resource.id",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "resource.name",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "resource.type",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "fields",
                    "default": "SOME_STRING_VALUE",
                    "in": "query",
                    "type": "string",
                    "required": false
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/alert/{id}": {
              "get": {
                "summary": "Get Alert Info",
                "description": "Get Alert Info",
                "operationId": "GetAlertInfo",
                "parameters": [
                  {
                    "name": "detailed",
                    "default": "true",
                    "in": "query",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "id",
                    "default": "{{id}}",
                    "in": "path",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/anomalies/trusted_list": {
              "get": {
                "summary": "Get Anomaly Trusted List",
                "description": "Get Anomaly Trusted List",
                "operationId": "GetAnomalyTrustedList",
                "parameters": [
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              },
              "post": {
                "summary": "Add Entries to Anomaly Trusted List",
                "description": "Add Entries to Anomaly Trusted List",
                "operationId": "AddEntriesToAnomalyTrustedList",
                "parameters": [
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json",
                    "description": "content-type"
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  },
                  {
                    "name": "body",
                    "in": "body",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "name"
                        },
                        "description": {
                          "type": "string",
                          "description": "description"
                        },
                        "applicablePolicies": {
                          "type": "array",
                          "items": { "type": "string" },
                          "description": "applicablePolicies"
                        },
                        "trustedListType": {
                          "type": "string",
                          "description": "trustedListType"
                        },
                        "accountID": {
                          "type": "string",
                          "description": "accountID"
                        },
                        "vpc": {
                          "type": "string",
                          "description": "vpc"
                        },
                        "trustedListEntries": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "ipCIDR": {
                                "type": "string",
                                "description": "ipCIDR"
                              },
                              "resourceID": {
                                "type": "string",
                                "description": "resourceID"
                              },
                              "imageID": {
                                "type": "string",
                                "description": "imageID"
                              },
                              "tagKey": {
                                "type": "string",
                                "description": "tagKey"
                              },
                              "tagValue": {
                                "type": "string",
                                "description": "tagValue"
                              },
                              "service": {
                                "type": "string",
                                "description": "service"
                              },
                              "port": {
                                "type": "string",
                                "description": "port"
                              },
                              "subject": {
                                "type": "string",
                                "description": "subject"
                              },
                              "domain": {
                                "type": "string",
                                "description": "domain"
                              },
                              "protocol": {
                                "type": "string",
                                "description": "protocol"
                              }
                            }
                          },
                          "description": "trustedListEntries"
                        }
                      },
                      "default": {
                        "name": "string",
                        "description": "string",
                        "applicablePolicies": [ "string" ],
                        "trustedListType": "ip, resource, image, tag, service, port, subject, domain, protocol",
                        "accountID": "any",
                        "vpc": "any",
                        "trustedListEntries": [
                          {
                            "ipCIDR": "string",
                            "resourceID": "string",
                            "imageID": "string",
                            "tagKey": "string",
                            "tagValue": "string",
                            "service": "string",
                            "port": "string",
                            "subject": "string",
                            "domain": "string",
                            "protocol": "string"
                          }
                        ]
                      }
                    },
                    "required": true
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/alert/remediation": {
              "post": {
                "summary": "List Remediation command",
                "description": "List Remediation command",
                "operationId": "ListRemediationCommand",
                "parameters": [
                  {
                    "name": "content-type",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "application/json; charset=UTF-8",
                    "description": "content-type"
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  },
                  {
                    "name": "body",
                    "in": "body",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "alerts": {
                          "type": "array",
                          "items": { "type": "string" },
                          "description": "alerts"
                        },
                        "filter": {
                          "type": "object",
                          "properties": {
                            "timeRange": {
                              "type": "object",
                              "properties": {
                                "relativeTimeType": {
                                  "type": "string",
                                  "description": "relativeTimeType"
                                },
                                "type": {
                                  "type": "string",
                                  "description": "type"
                                },
                                "value": {
                                  "type": "string",
                                  "description": "value"
                                }
                              },
                              "description": "timeRange"
                            }
                          },
                          "description": "filter"
                        }
                      },
                      "default": {
                        "alerts": [ "P-653" ],
                        "filter": {
                          "timeRange": {
                            "relativeTimeType": "BACKWARD",
                            "type": "to_now",
                            "value": "epoch"
                          }
                        }
                      }
                    },
                    "required": true
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            },
            "/alert/remediation/{id}": {
              "patch": {
                "summary": "Remediate Alert",
                "description": "Remediate Alert",
                "operationId": "RemediateAlert",
                "parameters": [
                  {
                    "name": "id",
                    "default": "{{id}}",
                    "in": "path",
                    "type": "string",
                    "required": true
                  },
                  {
                    "name": "x-redlock-auth",
                    "in": "header",
                    "required": true,
                    "type": "string",
                    "default": "{{token}}",
                    "description": "x-redlock-auth"
                  }
                ],
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                }
              }
            }
          },
          "definitions": {},
          "parameters": {},
          "responses": {},
          "securityDefinitions": {},
          "security": [],
          "tags": []
        }
      }
    }
  ]
}