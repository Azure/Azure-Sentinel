[
  {
    "name": "ImpervaWAFDCR",
    "apiVersion": "2023-03-11",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {
        "Custom-ImpervaCloudWAF": {
          "columns": [
            {
                "name": "Field1",
                "type": "string"
            },
            {
                "name": "Field2",
                "type": "string"
            },
            {
                "name": "Field3",
                "type": "string"
            },
            {
                "name": "Field4",
                "type": "string"
            },
            {
                "name": "Field5",
                "type": "string"
            },
            {
                "name": "Field6",
                "type": "string"
            },
            {
                "name": "Field7",
                "type": "string"
            },
            {
                "name": "Field8",
                "type": "string"
            },
            {
                "name": "Field9",
                "type": "string"
            },
            {
                "name": "Field10",
                "type": "string"
            }
          ]
        }
      },
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "clv2ws1"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Custom-ImpervaCloudWAF"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source | extend TimeGenerated = now()| project TimeGenerated, Column1 = tostring(Field1), Column2 = tostring(Field2), Column3 = tostring(Field3), Column4 = tostring(Field4), Column5 = tostring(Field5)",
          "outputStream": "Custom-ImpervaCloudWAFV2_CL"
        }
      ]
    }
  }
]