[
	{
		"name": "ImpervaCloudWAFLogsCCPDefinition",
		"apiVersion": "2022-12-01-preview",
		"type": "Microsoft.SecurityInsights/dataConnectors",
		"location": "{{location}}",
		"kind": "AmazonWebServicesS3",
		"properties": {
			"connectorDefinitionName": "ImpervaCloudWAFLogsCCPDefinition",
			"dataTypes": {
				"logs": {
					"state": "enabled"
				}
			},
			"dcrConfig": {
				"streamName": "Custom-ImpervaCloudWAF",
				"dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
				"dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
			},
			"destinationTable": "ImpervaCloudWAFV2_CL",
			"dataFormat": {
                "Format": "csv",
                "CsvDelimiter": "|",
                "IsCompressed": false,
                "compressType": "None",
                "HasCsvHeader": false
            },
			"roleArn": "{{roleArn}}",
			"sqsUrls": [
				"{{queueUrl}}"
			]
		}
	}
]