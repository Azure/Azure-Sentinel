id: be774c6e-7613-41db-b6e4-25975b680d24
name: NetApp RPS Medium Severity Alert
description: |
  'Detects medium severity NetApp RPS alerts that may require investigation. This rule monitors the rps_alerts_CL table for alerts with MEDIUM severity level.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: NetAppRPSCustomLogsIngestion
    dataTypes:
      - rps_alerts_CL
suppressionDuration: PT5H
suppressionEnabled: false
query: |
  rps_alerts_CL | where TimeGenerated > ago(1d)
  | where severity == "MEDIUM"
alertDetailsOverride:
  alertDisplayNameFormat: "{{description}}"
  alertDescriptionFormat: "Medium severity alert detected from NetApp RPS: {{description}}"
customDetails:
  Severity: severity
  IncidentDetails: incident
  ContextInfo: context
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT5H
    matchingMethod: AllEntities
eventGroupingSettings:
  aggregationKind: AlertPerResult
version: 1.0.0
kind: NRT