{
    "id": "NetAppRPSCustomLogsIngestion",
    "title": "NetAppRPS Data Connector",
    "publisher": "NetAppRPS",
    "descriptionMarkdown": "Data connector for ingesting NetApp RPS (Ransomware Protection Service) alerts into Microsoft Sentinel. This connector enables seamless integration of RPS alerts, facilitating enhanced monitoring and response capabilities for ransomware threats within NetApp storage environments.",
    "additionalRequirementBanner": "You need to have an active NetApp RPS subscription and appropriate permissions to access RPS alert data.",
    "graphQueries": [
        {
            "metricName": "Total data received",
            "legend": "NetAppRPS_alerts_CL",
            "baseQuery": "NetAppRPS_alerts_CL"
        }
    ],
    "dataTypes": [
        {
            "name": "NetAppRPS_alerts_CL",
            "lastDataReceivedQuery": "NetAppRPS_alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
        }
    ],
    "sampleQueries": [
        {
            "description": "Default Query",
            "query": "NetAppRPS_alerts_CL"
        }
    ],
    "connectivityCriterias": [
        {
            "type": "IsConnectedQuery",
            "value": [
                "NetAppRPS_alerts_CL"
            ]
        }
    ],
    "availability": {
        "status": 1,
        "isPreview": true
    },
    "permissions": {
        "resourceProvider": [
            {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                    "write": true,
                    "read": true,
                    "delete": true
                }
            },
            {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                    "action": true
                }
            }
        ],
        "customs": [
            {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
            },
            {
                "name": "NetApp Console Organization",
                "description": "NetApp Console Organization with permissions to create a new Service Account"
            }
        ]
    },
    "instructionSteps": [
        {
            "title": "1. Configuration",
            "description": "You need to have an active NetApp RPS subscription and appropriate permissions to access RPS alert data."
        },
        {
            "title": "2. Deploy the ARM Template",
            "description": "Click the button below to deploy the NetApp RPS data connector using Azure Resource Manager template:\n\n[![Deployment Button](https://aka.ms/deploytoazurebutton)](https://raw.githubusercontent.com/NetApp/Azure-Sentinel/refs/heads/netapp-rps/Solutions/NetAppRPS/Data%20Connectors/azuredeploy_rps_dataconnector.json)"
        }
    ]
}