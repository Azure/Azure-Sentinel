id: f4075d72-8d1b-4a2c-91ad-9f701f4d827f
Function:
  Title: ASIM Parser for OpenSystems Firewall logs
  Version: '1.0.0'
  LastUpdated: May 12th 2025
Category: OpenSystemsParser
FunctionName: ASimNetworkSessionOpenSystemsFirewall
FunctionAlias: ASimNetworkSessionOpenSystemsFirewall
FunctionQuery: |
  let parser = () {
    OpenSystemsFirewallLogs_CL
    | extend EventCount = toint(1)
    | extend EventStartTime = timestamp
    | extend EventEndTime = TimeGenerated
    | extend EventType = "NetworkSession"
    | extend EventProduct = "Firewall"
    | extend EventVendor = "Open Systems"
    | extend EventSchema = "NetworkSession"
    | extend EventSchemaVersion = "0.2.6"
    | extend EventResult = iff(action in ("DROP", "REJECT"), "Failure", "Success")
    | extend EventResultDetails = "Unknown"
    | extend EventSeverity = "Informational"
    | extend DvcHostname = host_name
    | extend Dvc = DvcHostname
    | extend DstIpAddr = ip_dst
    | extend DstPortNumber = iff(isnotempty(port_dst), toint(port_dst), int(null))
    | extend DstZone = zone_dst
    | extend Dst = DstIpAddr
    | extend SrcIpAddr = ip_src
    | extend SrcPortNumber = iff(isnotempty(port_src), toint(port_src), int(null))
    | extend SrcZone = zone_src
    | extend Src = SrcIpAddr
    | extend IpAddr = SrcIpAddr
    | project
          EventCount,
          EventStartTime,
          EventEndTime,
          EventType,
          EventProduct,
          EventVendor,
          EventSchema,
          EventSchemaVersion,
          EventResult,
          EventResultDetails,
          EventSeverity,
          DvcHostname,
          Dvc,
          DstIpAddr,
          DstPortNumber,
          DstZone,
          Dst,
          SrcIpAddr,
          SrcPortNumber,
          SrcZone,
          Src,
          IpAddr
  };
  parser
