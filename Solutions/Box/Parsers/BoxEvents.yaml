id: 231a04da-9a8d-4cd6-8a20-2da7ded173ba
Function:
  Title: Parser for BoxEvents
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: BoxEvents
FunctionAlias: BoxEvents
FunctionQuery: |
    BoxEvents_CL
    | extend
        additional_details_annotation_id_d=column_ifexists('additional_details_annotation_id_d', ''),
        additional_details_group_id_s=column_ifexists('additional_details_group_id_s', ''),
        additional_details_group_name_s=column_ifexists('additional_details_group_name_s', ''),
        source_user_email_s=column_ifexists('source_user_email_s', ''),
        additional_details_comment_id_d=column_ifexists('additional_details_comment_id_d', ''),
        additional_details_message_s=column_ifexists('additional_details_message_s', ''),
        additional_details_task_id_d=column_ifexists('additional_details_task_id_d', ''),
        additional_details_task_message_s=column_ifexists('additional_details_task_message_s', ''),
        additional_details_task_created_by_id_d=column_ifexists('additional_details_task_created_by_id_d', ''),
        additional_details_task_created_by_login_s=column_ifexists('additional_details_task_created_by_login_s', ''),
        additional_details_task_assignment_assigned_to_id_d=column_ifexists('additional_details_task_assignment_assigned_to_id_d', ''),
        additional_details_task_assignment_assigned_to_login_s=column_ifexists('additional_details_task_assignment_assigned_to_login_s', ''),
        additional_details_task_assignment_status_s=column_ifexists('additional_details_task_assignment_status_s', ''),
        additional_details_task_assignment_message_s=column_ifexists('additional_details_task_assignment_message_s', ''),
        source_file_id_s=column_ifexists('source_file_id_s', ''),
        source_file_name_s=column_ifexists('source_file_name_s', ''),
        source_parent_name_g=column_ifexists('source_parent_name_g', ''),
        source_item_type_s=column_ifexists('source_item_type_s', ''),
        source_item_id_s=column_ifexists('source_item_id_s', ''),
        source_item_name_s=column_ifexists('source_item_name_s', ''),
        source_parent_type_s=column_ifexists('source_parent_type_s', ''),
        source_parent_name_s=column_ifexists('source_parent_name_s', ''),
        source_parent_id_s=column_ifexists('source_parent_id_s', ''),
        source_owned_by_type_s=column_ifexists('source_owned_by_type_s', ''),
        source_owned_by_id_s=column_ifexists('source_owned_by_id_s', ''),
        source_owned_by_name_s=column_ifexists('source_owned_by_name_s', ''),
        source_owned_by_login_s=column_ifexists('source_owned_by_login_s', ''),
        created_by_type_s=column_ifexists('created_by_type_s', ''),
        created_by_id_s=column_ifexists('created_by_id_s', ''),
        created_by_name_s=column_ifexists('created_by_name_s', ''),
        created_by_login_s=column_ifexists('created_by_login_s', ''),
        created_at_t=column_ifexists('created_at_t', ''),
        event_id_g=column_ifexists('event_id_g', ''),
        event_type_s=column_ifexists('event_type_s', ''),
        ip_address_s=column_ifexists('ip_address_s', ''),
        type_s=column_ifexists('type_s', ''),
        additional_details_size_d=column_ifexists('additional_details_size_d', ''),
        additional_details_ekm_id_g=column_ifexists('additional_details_ekm_id_g', ''),
        additional_details_version_id_s=column_ifexists('additional_details_version_id_s', ''),
        additional_details_service_id_s=column_ifexists('additional_details_service_id_s', ''),
        additional_details_service_name_s=column_ifexists('additional_details_service_name_s', ''),
        source_type_s=column_ifexists('source_type_s', ''),
        source_id_s=column_ifexists('source_id_s', ''),
        source_name_s=column_ifexists('source_name_s', ''),
        source_login_s=column_ifexists('source_login_s', ''),
        additional_details_access_token_identifier_s=column_ifexists('additional_details_access_token_identifier_s', ''),
        additional_details_shared_link_id_s=column_ifexists('additional_details_shared_link_id_s', ''),
        source_folder_id_s=column_ifexists('source_folder_id_s', ''),
        source_folder_name_s=column_ifexists('source_folder_name_s', ''),
        source_user_id_s=column_ifexists('source_user_id_s', ''),
        source_user_name_s=column_ifexists('source_user_name_s', ''),
        accessible_by_type_s=column_ifexists('accessible_by_type_s', ''),
        accessible_by_id_s=column_ifexists('accessible_by_id_s', ''),
        accessible_by_name_s=column_ifexists('accessible_by_name_s', ''),
        accessible_by_login_s=column_ifexists('accessible_by_login_s', ''),
        additional_details_type_s=column_ifexists('additional_details_type_s', ''),
        additional_details_collab_id_s=column_ifexists('additional_details_collab_id_s', ''),
        additional_details_role_s=column_ifexists('additional_details_role_s', ''),
        additional_details_is_performed_by_admin_b=column_ifexists('additional_details_is_performed_by_admin_b', ''),
        session_id_s=column_ifexists('session_id_s', '')
    | project-rename
        AdditionalDetailsAnnotationId=additional_details_annotation_id_d,
        AdditionalDetailsGroupId=additional_details_group_id_s,
        AdditionalDetailsGroupName=additional_details_group_name_s,
        SourceUserEmail=source_user_email_s,
        AdditionalDetailsCommentId=additional_details_comment_id_d,
        AdditionalDetailsMessage=additional_details_message_s,
        AdditionalDetailsTaskId=additional_details_task_id_d,
        AdditionalDetailsTaskMessage=additional_details_task_message_s,
        AdditionalDetailsTaskCreatedById=additional_details_task_created_by_id_d,
        AdditionalDetailsTaskCreatedByLogin=additional_details_task_created_by_login_s,
        AdditionalDetailsTaskAssignmentAssignedToId=additional_details_task_assignment_assigned_to_id_d,
        AdditionalDetailsTaskAssignmentAssignedToLogin=additional_details_task_assignment_assigned_to_login_s,
        AdditionalDetailsTaskAssignmentStatus=additional_details_task_assignment_status_s,
        AdditionalDetailsTaskAssignmentMessage=additional_details_task_assignment_message_s,
        SourceFileId=source_file_id_s,
        SourceFileName=source_file_name_s,
        SourceParentName=source_parent_name_g,
        SourceItemType=source_item_type_s,
        SourceItemId=source_item_id_s,
        SourceItemName=source_item_name_s,
        SourceParentType=source_parent_type_s,
        FileDirectory=source_parent_name_s,
        SourceParentId=source_parent_id_s,
        SourceOwnedByType=source_owned_by_type_s,
        SourceOwnedById=source_owned_by_id_s,
        SourceOwnedByName=source_owned_by_name_s,
        SourceOwnedByLogin=source_owned_by_login_s,
        CreatedByType=created_by_type_s,
        SrcUserSid=created_by_id_s,
        SrcUserName=created_by_name_s,
        SrcUserUpn=created_by_login_s,
        EventEndTime=created_at_t,
        EventId=event_id_g,
        EventType=event_type_s,
        SrcIpAddr=ip_address_s,
        BoxType=type_s,
        FileSize=additional_details_size_d,
        AdditionalDetailsEkmId=additional_details_ekm_id_g,
        AdditionalDetailsVersionId=additional_details_version_id_s,
        AdditionalDetailsServiceId=additional_details_service_id_s,
        AdditionalDetailsServiceName=additional_details_service_name_s,
        SourceType=source_type_s,
        SourceId=source_id_s,
        SourceName=source_name_s,
        SourceLogin=source_login_s,
        AdditionalDetailsAccessTokenIdentifier=additional_details_access_token_identifier_s,
        AdditionalDetailsSharedLinkId=additional_details_shared_link_id_s,
        SourceFolderId=source_folder_id_s,
        SourceFolderName=source_folder_name_s,
        SourceUserId=source_user_id_s,
        SourceUserName=source_user_name_s,
        AccessibleByType=accessible_by_type_s,
        AccessibleById=accessible_by_id_s,
        AccessibleByName=accessible_by_name_s,
        AccessibleByLogin=accessible_by_login_s,
        AdditionalDetailsType=additional_details_type_s,
        AdditionalDetailsCollabId=additional_details_collab_id_s,
        AdditionalDetailsRole=additional_details_role_s,
        AdditionalDetailsIsPerformedByAdmin=additional_details_is_performed_by_admin_b,
        UserSessionId=session_id_s