id: 6c5ef8f1-8bb3-4444-921d-2d9ac007f469
Function:
  Title: Parser for TenableIOAssets
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: TenableIOAssets
FunctionAlias: TenableIOAssets
FunctionQuery: |
    Tenable_IO_Assets_CL
    | extend 
        EventVendor="TenableIO",
        EventProduct="Assets",
        EventType='AssetExport',
        AgentName=column_ifexists('agent_names_s', ''),
        AgentUUID=column_ifexists('agent_uuid_g', ''),
        AWSAvailabilityZone=column_ifexists('aws_availability_zone_s', ''),
        AWSEC2InstanceAMI=column_ifexists('aws_ec2_instance_ami_id_s', ''),
        AWSEC2InstanceGroupName=column_ifexists('aws_ec2_instance_group_name_s', ''),
        AWSEC2InstanceID=column_ifexists('aws_ec2_instance_id_s', ''),
        AWSEC2InstanceStateName=column_ifexists('aws_ec2_instance_state_name_s', ''),
        AWSEC2InstanceType=column_ifexists('aws_ec2_instance_type_s', ''),
        AWSOwnerID=column_ifexists('aws_owner_id_s', ''),
        AWSRegion=column_ifexists('aws_region_s', ''),
        AWSSubnetID=column_ifexists('aws_subnet_id_s', ''),
        AWSVPCID=column_ifexists('aws_vpc_id_s', ''),
        AzureResourceID=column_ifexists('azure_resource_id_s', ''),
        AzureVMID=column_ifexists('azure_vm_id_g', ''),
        BIOSUUID=strcat(bios_uuid_g, bios_uuid_s),
        Computer=column_ifexists('Computer', ''),
        CreatedAtTime=column_ifexists('created_at_t', ''),
        DeletedAtTime=column_ifexists('deleted_at_t', ''),
        DeletedBy=column_ifexists('deleted_by_g', ''),
        FirstScanTime=column_ifexists('first_scan_time_t', ''),
        FirstSeen=column_ifexists('first_seen_t', ''),
        FQDNs=column_ifexists('fqdns_s', ''),
        GCPInstanceID=column_ifexists('gcp_instance_id_s', ''),
        GCPProjectID=column_ifexists('gcp_project_id_s', ''),
        GCPZone=column_ifexists('gcp_zone_s', ''),
        HasAgent=column_ifexists('has_agent_b', ''),
        HasPluginResults=column_ifexists('has_plugin_results_b', ''),
        ID=column_ifexists('id_g', ''),
        InstalledSoftware=column_ifexists('installed_software_s', ''),
        IPV4s=column_ifexists('ipv4s_s', ''),
        IPV6s=column_ifexists('ipv6s_s', ''),
        LastAuthenticatedScanDate=column_ifexists('last_authenticated_scan_date_t', ''),
        LastLicensedScanDate=column_ifexists('last_licensed_scan_date_t', ''),
        LastScanID=strcat(last_scan_id_g, last_scan_id_s),
        LastScanDate=column_ifexists('last_scan_time_t', ''),
        LastScheduleID=column_ifexists('last_schedule_id_s', ''),
        LastSeenDate=column_ifexists('last_seen_t', ''),
        MACAddresses=column_ifexists('mac_addresses_s', ''),
        ManufacturerTPMIDs=column_ifexists('manufacturer_tpm_ids_s', ''),
        NetBIOSNames=column_ifexists('netbios_names_s', ''),
        NetworkID=column_ifexists('network_id_g', ''),
        NetworkInterfaces=column_ifexists('network_interfaces_s', ''),
        NetworkName=column_ifexists('network_name_s', ''),
        OperatingSystems=column_ifexists('operating_systems_s', ''),
        QualysAssetIDs=column_ifexists('qualys_asset_ids_s', ''),
        QualysHostIDs=column_ifexists('qualys_host_ids_s', ''),
        ServiceNowSysID=column_ifexists('servicenow_sysid_g', ''),
        Sources=column_ifexists('sources_s', ''),
        SSHFingerprints=column_ifexists('ssh_fingerprints_s', ''),
        SymantecEPHardwareKeys=column_ifexists('symantec_ep_hardware_keys_s', ''),
        SystemTypes=column_ifexists('system_types_s', ''),
        Tags=column_ifexists('tags_s', ''),
        TerminatedAt=column_ifexists('terminated_at_t', ''),
        TerminatedBy=column_ifexists('terminated_by_s', ''),
        UpdatedAt=column_ifexists('updated_at_t', '')
    | project
        FQDNs,
        AzureResourceID,
        AzureVMID,
        OperatingSystems,
        IPV4s,
        NetworkName,
        InstalledSoftware,
        FirstSeen,
        LastSeenDate,
        FirstScanTime,
        LastScanDate,
        LastAuthenticatedScanDate,
        LastLicensedScanDate,
        HasPluginResults,
        HasAgent,
        TimeGenerated, 
        EventVendor,
        EventProduct,
        EventType,
        AgentName,
        AgentUUID,
        AWSAvailabilityZone,
        AWSEC2InstanceAMI,
        AWSEC2InstanceGroupName,
        AWSEC2InstanceID,
        AWSEC2InstanceStateName,
        AWSEC2InstanceType,
        AWSOwnerID,
        AWSRegion,
        AWSSubnetID,
        AWSVPCID,
        BIOSUUID,
        Computer,
        CreatedAtTime,
        DeletedAtTime,
        DeletedBy,
        GCPInstanceID,
        GCPProjectID,
        GCPZone,
        ID,
        IPV6s,
        LastScanID,
        LastScheduleID,
        MACAddresses,
        ManufacturerTPMIDs,
        NetBIOSNames,
        NetworkID,
        NetworkInterfaces,
        QualysAssetIDs,
        QualysHostIDs,
        ServiceNowSysID,
        Sources,
        SSHFingerprints,
        SymantecEPHardwareKeys,
        SystemTypes,
        Tags,
        TerminatedAt,
        TerminatedBy,
        UpdatedAt