id: b2c3d4e5-f6a7-8901-bcde-f23456789012
name: TacitRed - High Confidence Compromise
version: 1.0.0
kind: Scheduled
description: |-
  Detects compromised credentials with high confidence scores.
  High confidence findings indicate verified credential compromises that require immediate attention.
  
  Ref: https://tacitred.com/
severity: High
requiredDataConnectors:
  - connectorId: TacitRedThreatIntel
    dataTypes:
      - TacitRed_Findings_CL
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: GreaterThan
triggerThreshold: 0
tactics:
  - CredentialAccess
  - InitialAccess
relevantTechniques:
  - T1078
  - T1589
query: |-
  TacitRed_Findings_CL
  | where TimeGenerated >= ago(1h)
  | where confidence_d >= 80
  | extend
      Email = tostring(email_s),
      Username = tostring(username_s),
      Domain = tostring(domain_s),
      FindingType = tostring(findingType_s),
      Confidence = todouble(confidence_d),
      Source = tostring(source_s),
      Severity = tostring(severity_s)
  | project
      TimeGenerated,
      Email,
      Username,
      Domain,
      FindingType,
      Confidence,
      Source,
      Severity
suppressionEnabled: false
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: 5h
    matchingMethod: Selected
    groupByEntities:
      - Account
suppressionDuration: 5h
eventGroupingSettings:
  aggregationKind: AlertPerResult
entityMappings:
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: Username
      - identifier: UPNSuffix
        columnName: Email
  - entityType: DNS
    fieldMappings:
      - identifier: DomainName
        columnName: Domain
