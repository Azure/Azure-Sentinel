# ForeScout playbook templates

<img src="./forescout-logo.png" alt="drawing" width="20%"/><br>

## Table of Contents

1. [Overview](#overview)
1. [Playbook Templates](#playbooks)

<a name="overview">

# Overview

"ForescoutHostPropertyMonitor" is a project that helps to check and report IP addresses of the hosts that are involved in various categories of malicious attacks. It does the checks by analyzing host properties uploaded by Forescout Continuum platform. This project analyzes number of times certain events are generated by a host to determine the classificaction and severity of activity done by the host. It forwards that severity and host information back to Forescout Continuum platform through description field of Sentinel Incident so that Coninuum platform can act upon the host.

<a name="playbooks">

# Playbook Templates
This package includes:  

* DNS Sniff Event Playbook   
This topic describes a sample Logic App/Playbook, "DNS Sniff Event Playbook".  
Analytic Rule (DNS Sniff Event Monitor) checks host properties and generates incidents containing number of times the events happened for any endpoint within the time interval. Based on this information, the Logic App/Playbook will set the Description field of the incident with the following information:   

<table>
<tr> <td>action_group </td> <td>Indicates the category of action. Valid values are: <em> manage, notify, remediate, and restrict</em>.</td></tr>
<tr> <td>endpoint_ip</td> <td>Indicates the IP address of the endpoint, which can be an IPv4 or IPv6 address.</td></tr>
<tr> <td>em_ip</td> <td>Indicates the IP address of the Enterprise Manager to which the endpoint belongs.</td></tr>
<tr> <td>info</td> <td> Indicates additional information</td></tr>
</table>
The em_ip and info are optional.  

Note that the eyeExtend for Microsoft Sentinel module polls the incidents information periodically and examines the Description field of each incident. Based on the information set in the Description field, the Continuum Platform applies the requested action set by Microsoft Sentinel playbook to the endpoints.  
The following is a sample description field of an incident set by the playbook:  
<em>action\_group="restrict";endpoint\_ip=["10.16.141.130"];em_ip=["10.16.147.96"];info=block network access</em>    
   
   
Following table lists valid info values for each action group:   
<table>  
<tr> <td><b>action_group</b></td> <td><b>Valid info value</b></td>
</tr>
<tr> <td>restrict</td> <td>block network access <br> quarantine <br> limit network access
</tr>
<tr> <td>remediate</td> <td>OS update <br> kill process &lt;Skype&gt; </td>
</tr>
<tr> <td>manage</td> <td>VA scan</td>
</tr>
<tr> <td>notify</td> <td> Unauthorized activity <br> Unauthorized app detected</td>
</tr>
</table>
    
Use the Microsoft Apps Designer to view or edit the playbook as needed to fulfil security requirements. The code is prepared by using the visual editor, which can be easily viewed and modified.  

You can choose to deploy the playbook:
   
[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FForescoutHostPropertyMonitor%2FPlaybooks%2FForescout-DNSSniffEventPlaybook.json) 
[![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://portal.azure.us/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FForescoutHostPropertyMonitor%2FPlaybooks%2FForescout-DNSSniffEventPlaybook.json)

