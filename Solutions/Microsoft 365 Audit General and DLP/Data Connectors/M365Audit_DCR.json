[
    {
        "name": "M365AuditGeneralDCR",
        "apiVersion": "2022-06-01",
        "type": "Microsoft.Insights/dataCollectionRules",
        "location": "{{location}}",
        "properties": {
            "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
            "streamDeclarations": {
                "Custom-M365AuditGeneralInput": {
                    "columns": [
                        {
                            "name": "TimeGenerated",
                            "type": "datetime"
                        },
                        {
                            "name": "Id",
                            "type": "string"
                        },
                        {
                            "name": "RecordType",
                            "type": "int"
                        },
                        {
                            "name": "CreationTime",
                            "type": "datetime"
                        },
                        {
                            "name": "Operation",
                            "type": "string"
                        },
                        {
                            "name": "OrganizationId",
                            "type": "string"
                        },
                        {
                            "name": "UserType",
                            "type": "int"
                        },
                        {
                            "name": "UserKey",
                            "type": "string"
                        },
                        {
                            "name": "Workload",
                            "type": "string"
                        },
                        {
                            "name": "ResultStatus",
                            "type": "string"
                        },
                        {
                            "name": "ObjectId",
                            "type": "string"
                        },
                        {
                            "name": "UserId",
                            "type": "string"
                        },
                        {
                            "name": "ClientIP",
                            "type": "string"
                        },
                        {
                            "name": "Scope",
                            "type": "string"
                        },
                        {
                            "name": "CopilotEventData",
                            "type": "dynamic"
                        },
                        {
                            "name": "AgentID",
                            "type": "string"
                        },
                        {
                            "name": "AgentName",
                            "type": "string"
                        },
                        {
                            "name": "AgentType",
                            "type": "int"
                        },
                        {
                            "name": "UserAssignments",
                            "type": "dynamic"
                        },
                        {
                            "name": "ForAllUsers",
                            "type": "boolean"
                        },
                        {
                            "name": "Property",
                            "type": "string"
                        },
                        {
                            "name": "RemovedIdentities",
                            "type": "dynamic"
                        },
                        {
                            "name": "AddedIdentities",
                            "type": "dynamic"
                        },
                        {
                            "name": "NewValue",
                            "type": "string"
                        },
                        {
                            "name": "OldValue",
                            "type": "string"
                        },
                        {
                            "name": "Entity",
                            "type": "string"
                        },
                        {
                            "name": "Action",
                            "type": "string"
                        },
                        {
                            "name": "OnBehalfOfResId",
                            "type": "string"
                        },
                        {
                            "name": "CaseId",
                            "type": "string"
                        },
                        {
                            "name": "CaseName",
                            "type": "string"
                        },
                        {
                            "name": "Object1Id",
                            "type": "string"
                        },
                        {
                            "name": "Object1Name",
                            "type": "string"
                        },
                        {
                            "name": "Object1Type",
                            "type": "string"
                        },
                        {
                            "name": "Object2Id",
                            "type": "string"
                        },
                        {
                            "name": "Object2Name",
                            "type": "string"
                        },
                        {
                            "name": "Object2Type",
                            "type": "string"
                        },
                        {
                            "name": "StartTime",
                            "type": "datetime"
                        },
                        {
                            "name": "EndTime",
                            "type": "datetime"
                        },
                        {
                            "name": "UserCancelled",
                            "type": "boolean"
                        },
                        {
                            "name": "ItemIds",
                            "type": "dynamic"
                        },
                        {
                            "name": "ItemNames",
                            "type": "dynamic"
                        },
                        {
                            "name": "DataSources",
                            "type": "dynamic"
                        },
                        {
                            "name": "QueryId",
                            "type": "string"
                        },
                        {
                            "name": "QueryText",
                            "type": "string"
                        },
                        {
                            "name": "QueryFiles",
                            "type": "dynamic"
                        },
                        {
                            "name": "Settings",
                            "type": "dynamic"
                        },
                        {
                            "name": "ExtendedProperties",
                            "type": "dynamic"
                        },
                        {
                            "name": "ExportName",
                            "type": "string"
                        },
                        {
                            "name": "JobId",
                            "type": "string"
                        },
                        {
                            "name": "RecordNumber",
                            "type": "string"
                        },
                        {
                            "name": "ClientRequestId",
                            "type": "string"
                        },
                        {
                            "name": "CmdletVersion",
                            "type": "string"
                        },
                        {
                            "name": "EffectiveOrganization",
                            "type": "string"
                        },
                        {
                            "name": "UserServicePlan",
                            "type": "string"
                        },
                        {
                            "name": "ClientApplication",
                            "type": "string"
                        },
                        {
                            "name": "Parameters",
                            "type": "string"
                        },
                        {
                            "name": "NonPiiParameters",
                            "type": "string"
                        },
                        {
                            "name": "AlertId",
                            "type": "string"
                        },
                        {
                            "name": "AlertType",
                            "type": "string"
                        },
                        {
                            "name": "Name",
                            "type": "string"
                        },
                        {
                            "name": "PolicyId",
                            "type": "string"
                        },
                        {
                            "name": "Status",
                            "type": "string"
                        },
                        {
                            "name": "Severity",
                            "type": "string"
                        },
                        {
                            "name": "Category",
                            "type": "string"
                        },
                        {
                            "name": "Source",
                            "type": "string"
                        },
                        {
                            "name": "Comments",
                            "type": "string"
                        },
                        {
                            "name": "Data",
                            "type": "string"
                        },
                        {
                            "name": "AlertEntityId",
                            "type": "string"
                        },
                        {
                            "name": "EntityType",
                            "type": "string"
                        },
                        {
                            "name": "ActorUserId",
                            "type": "string"
                        },
                        {
                            "name": "ActorYammerUserId",
                            "type": "long"
                        },
                        {
                            "name": "DataExportType",
                            "type": "string"
                        },
                        {
                            "name": "FileId",
                            "type": "long"
                        },
                        {
                            "name": "FileName",
                            "type": "string"
                        },
                        {
                            "name": "GroupName",
                            "type": "string"
                        },
                        {
                            "name": "IsSoftDelete",
                            "type": "boolean"
                        },
                        {
                            "name": "MeetingId",
                            "type": "string"
                        },
                        {
                            "name": "MessageId",
                            "type": "long"
                        },
                        {
                            "name": "ModifiedProperties",
                            "type": "dynamic"
                        },
                        {
                            "name": "YammerNetworkId",
                            "type": "long"
                        },
                        {
                            "name": "TargetObjectId",
                            "type": "string"
                        },
                        {
                            "name": "TargetUserId",
                            "type": "string"
                        },
                        {
                            "name": "TargetYammerUserId",
                            "type": "long"
                        },
                        {
                            "name": "ThreadId",
                            "type": "long"
                        },
                        {
                            "name": "VersionId",
                            "type": "long"
                        },
                        {
                            "name": "AttachmentData",
                            "type": "dynamic"
                        },
                        {
                            "name": "DetectionType",
                            "type": "string"
                        },
                        {
                            "name": "DetectionMethod",
                            "type": "string"
                        },
                        {
                            "name": "InternetMessageId",
                            "type": "string"
                        },
                        {
                            "name": "NetworkMessageId",
                            "type": "string"
                        },
                        {
                            "name": "P1Sender",
                            "type": "string"
                        },
                        {
                            "name": "P2Sender",
                            "type": "string"
                        },
                        {
                            "name": "Policy",
                            "type": "string"
                        },
                        {
                            "name": "Recipients",
                            "type": "dynamic"
                        },
                        {
                            "name": "SenderIp",
                            "type": "string"
                        },
                        {
                            "name": "Subject",
                            "type": "string"
                        },
                        {
                            "name": "Verdict",
                            "type": "string"
                        },
                        {
                            "name": "MessageTime",
                            "type": "datetime"
                        },
                        {
                            "name": "EventDeepLink",
                            "type": "string"
                        },
                        {
                            "name": "DeliveryAction",
                            "type": "string"
                        },
                        {
                            "name": "OriginalDeliverylocation",
                            "type": "string"
                        },
                        {
                            "name": "LatestDeliverylocation",
                            "type": "string"
                        },
                        {
                            "name": "Directionality",
                            "type": "string"
                        },
                        {
                            "name": "ThreatsAndDetectionTech",
                            "type": "string"
                        },
                        {
                            "name": "AdditionalActionsAndResults",
                            "type": "dynamic"
                        },
                        {
                            "name": "Connectors",
                            "type": "string"
                        },
                        {
                            "name": "AuthDetails",
                            "type": "dynamic"
                        },
                        {
                            "name": "SystemOverrides",
                            "type": "dynamic"
                        },
                        {
                            "name": "PhishConfidenceLevel",
                            "type": "string"
                        },
                        {
                            "name": "BatchID",
                            "type": "string"
                        },
                        {
                            "name": "CampaignID",
                            "type": "string"
                        },
                        {
                            "name": "UserDisplayName",
                            "type": "string"
                        },
                        {
                            "name": "AttackTechnique",
                            "type": "string"
                        },
                        {
                            "name": "CampaignType",
                            "type": "string"
                        },
                        {
                            "name": "TimeData",
                            "type": "datetime"
                        },
                        {
                            "name": "EndTimeData",
                            "type": "datetime"
                        },
                        {
                            "name": "AttackSimEvent",
                            "type": "string"
                        },
                        {
                            "name": "AttackSimAdminEvent",
                            "type": "string"
                        },
                        {
                            "name": "CourseID",
                            "type": "string"
                        },
                        {
                            "name": "UserTrainingEvent",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionRegistered",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionDeliveryCheck",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionSubmitting",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionSubmitted",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionTriage",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionTimeout",
                            "type": "string"
                        },
                        {
                            "name": "UserSubmission",
                            "type": "string"
                        },
                        {
                            "name": "UserSubmissionTriage",
                            "type": "string"
                        },
                        {
                            "name": "CustomSubmission",
                            "type": "string"
                        },
                        {
                            "name": "AttackSimUserSubmission",
                            "type": "string"
                        },
                        {
                            "name": "AdminSubmissionTablAllow",
                            "type": "string"
                        },
                        {
                            "name": "SubmissionNotification",
                            "type": "string"
                        },
                        {
                            "name": "InvestigationId",
                            "type": "string"
                        },
                        {
                            "name": "InvestigationName",
                            "type": "string"
                        },
                        {
                            "name": "InvestigationType",
                            "type": "string"
                        },
                        {
                            "name": "LastUpdateTimeUtc",
                            "type": "datetime"
                        },
                        {
                            "name": "StartTimeUtc",
                            "type": "datetime"
                        },
                        {
                            "name": "DeeplinkURL",
                            "type": "string"
                        },
                        {
                            "name": "Actions",
                            "type": "dynamic"
                        },
                        {
                            "name": "ActionType",
                            "type": "string"
                        },
                        {
                            "name": "ActionStatus",
                            "type": "string"
                        },
                        {
                            "name": "ApprovedBy",
                            "type": "string"
                        },
                        {
                            "name": "TimestampUtc",
                            "type": "datetime"
                        },
                        {
                            "name": "ActionId",
                            "type": "string"
                        },
                        {
                            "name": "RelatedAlertIds",
                            "type": "dynamic"
                        },
                        {
                            "name": "EndTimeUtc",
                            "type": "datetime"
                        },
                        {
                            "name": "ResourceIdentifiers",
                            "type": "string"
                        },
                        {
                            "name": "Entities",
                            "type": "dynamic"
                        },
                        {
                            "name": "Audit",
                            "type": "string"
                        },
                        {
                            "name": "Event",
                            "type": "string"
                        },
                        {
                            "name": "EventId",
                            "type": "long"
                        },
                        {
                            "name": "EventValue",
                            "type": "string"
                        },
                        {
                            "name": "Reason",
                            "type": "string"
                        },
                        {
                            "name": "AppName",
                            "type": "string"
                        },
                        {
                            "name": "DashboardName",
                            "type": "string"
                        },
                        {
                            "name": "DataClassification",
                            "type": "string"
                        },
                        {
                            "name": "DatasetName",
                            "type": "string"
                        },
                        {
                            "name": "MembershipInformation",
                            "type": "dynamic"
                        },
                        {
                            "name": "OrgAppPermission",
                            "type": "string"
                        },
                        {
                            "name": "ReportName",
                            "type": "string"
                        },
                        {
                            "name": "SharingInformation",
                            "type": "dynamic"
                        },
                        {
                            "name": "SwitchState",
                            "type": "string"
                        },
                        {
                            "name": "WorkSpaceName",
                            "type": "string"
                        },
                        {
                            "name": "WpaUserRole",
                            "type": "string"
                        },
                        {
                            "name": "OperationDetails",
                            "type": "dynamic"
                        },
                        {
                            "name": "RequestType",
                            "type": "string"
                        },
                        {
                            "name": "RequestSource",
                            "type": "string"
                        },
                        {
                            "name": "ReleaseTo",
                            "type": "string"
                        },
                        {
                            "name": "FormsUserTypes",
                            "type": "dynamic"
                        },
                        {
                            "name": "SourceApp",
                            "type": "string"
                        },
                        {
                            "name": "FormName",
                            "type": "string"
                        },
                        {
                            "name": "FormId",
                            "type": "string"
                        },
                        {
                            "name": "FormTypes",
                            "type": "dynamic"
                        },
                        {
                            "name": "ActivityParameters",
                            "type": "string"
                        },
                        {
                            "name": "Sender",
                            "type": "string"
                        },
                        {
                            "name": "Receivers",
                            "type": "dynamic"
                        },
                        {
                            "name": "ItemName",
                            "type": "string"
                        },
                        {
                            "name": "LabelId",
                            "type": "string"
                        },
                        {
                            "name": "LabelName",
                            "type": "string"
                        },
                        {
                            "name": "LabelAction",
                            "type": "string"
                        },
                        {
                            "name": "LabelAppliedDateTime",
                            "type": "datetime"
                        },
                        {
                            "name": "ApplicationMode",
                            "type": "string"
                        },
                        {
                            "name": "Recipient",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticationMethod",
                            "type": "string"
                        },
                        {
                            "name": "AuthenticationStatus",
                            "type": "string"
                        },
                        {
                            "name": "OperationStatus",
                            "type": "string"
                        },
                        {
                            "name": "AttachmentName",
                            "type": "string"
                        },
                        {
                            "name": "OperationProperties",
                            "type": "dynamic"
                        },
                        {
                            "name": "TaskId",
                            "type": "string"
                        },
                        {
                            "name": "ItemId",
                            "type": "string"
                        },
                        {
                            "name": "ItemSize",
                            "type": "long"
                        },
                        {
                            "name": "SourceUserId",
                            "type": "string"
                        },
                        {
                            "name": "FailureType",
                            "type": "string"
                        },
                        {
                            "name": "ResultMessage",
                            "type": "string"
                        },
                        {
                            "name": "IsRetry",
                            "type": "boolean"
                        },
                        {
                            "name": "Attachments",
                            "type": "dynamic"
                        },
                        {
                            "name": "DataStoreType",
                            "type": "string"
                        },
                        {
                            "name": "UserAction",
                            "type": "string"
                        },
                        {
                            "name": "ExportTriggeredAt",
                            "type": "datetime"
                        },
                        {
                            "name": "NameOfDownloadedZipFile",
                            "type": "string"
                        },
                        {
                            "name": "Invitation",
                            "type": "string"
                        },
                        {
                            "name": "ClientUUID",
                            "type": "string"
                        },
                        {
                            "name": "ImportType",
                            "type": "string"
                        },
                        {
                            "name": "DataDSRControl",
                            "type": "string"
                        },
                        {
                            "name": "DiscardEmployeeIds",
                            "type": "string"
                        },
                        {
                            "name": "ExtendedCompletionDate",
                            "type": "datetime"
                        },
                        {
                            "name": "FeedBackComponentName",
                            "type": "string"
                        },
                        {
                            "name": "Detail",
                            "type": "string"
                        },
                        {
                            "name": "Username",
                            "type": "string"
                        },
                        {
                            "name": "UserRole",
                            "type": "string"
                        },
                        {
                            "name": "OrganizationName",
                            "type": "string"
                        },
                        {
                            "name": "OrganizationOwner",
                            "type": "string"
                        },
                        {
                            "name": "OrganizationAdmins",
                            "type": "dynamic"
                        },
                        {
                            "name": "UserAgent",
                            "type": "string"
                        },
                        {
                            "name": "ModifiedFields",
                            "type": "dynamic"
                        },
                        {
                            "name": "ItemDetails",
                            "type": "dynamic"
                        },
                        {
                            "name": "EditMethodology",
                            "type": "string"
                        },
                        {
                            "name": "CountOfArtifactsBeingAdded",
                            "type": "int"
                        },
                        {
                            "name": "CountOfArtifactsBeingRemoved",
                            "type": "int"
                        },
                        {
                            "name": "ServiceType",
                            "type": "string"
                        },
                        {
                            "name": "CreationMethodology",
                            "type": "string"
                        },
                        {
                            "name": "RestoreTime",
                            "type": "datetime"
                        },
                        {
                            "name": "RestoreLocationType",
                            "type": "string"
                        },
                        {
                            "name": "RestoreLocation",
                            "type": "string"
                        },
                        {
                            "name": "BackupItemID",
                            "type": "string"
                        },
                        {
                            "name": "ProtectionUnitID",
                            "type": "string"
                        },
                        {
                            "name": "SuccessStatus",
                            "type": "string"
                        },
                        {
                            "name": "BackupItemType",
                            "type": "string"
                        },
                        {
                            "name": "URLPath",
                            "type": "string"
                        },
                        {
                            "name": "DomainURL",
                            "type": "string"
                        },
                        {
                            "name": "ScenarioType",
                            "type": "string"
                        },
                        {
                            "name": "PromptText",
                            "type": "string"
                        },
                        {
                            "name": "AutomationId",
                            "type": "string"
                        },
                        {
                            "name": "TriggerMode",
                            "type": "string"
                        },
                        {
                            "name": "PlaceType",
                            "type": "string"
                        },
                        {
                            "name": "EventTime",
                            "type": "datetime"
                        },
                        {
                            "name": "Compute",
                            "type": "string"
                        },
                        {
                            "name": "DatabaseName",
                            "type": "dynamic"
                        },
                        {
                            "name": "TableName",
                            "type": "string"
                        },
                        {
                            "name": "SessionDurationInSecs",
                            "type": "string"
                        },
                        {
                            "name": "SessionStartTime",
                            "type": "datetime"
                        },
                        {
                            "name": "SessionEndTime",
                            "type": "datetime"
                        },
                        {
                            "name": "KernalId",
                            "type": "string"
                        },
                        {
                            "name": "SessionId",
                            "type": "string"
                        },
                        {
                            "name": "Interface",
                            "type": "string"
                        },
                        {
                            "name": "JobType",
                            "type": "string"
                        },
                        {
                            "name": "JobName",
                            "type": "string"
                        },
                        {
                            "name": "Schedule",
                            "type": "string"
                        },
                        {
                            "name": "RunID",
                            "type": "string"
                        },
                        {
                            "name": "JobRunStatus",
                            "type": "string"
                        },
                        {
                            "name": "Logs",
                            "type": "string"
                        },
                        {
                            "name": "JobExecutionDurationInSecs",
                            "type": "long"
                        },
                        {
                            "name": "JobTotalDurationInSecs",
                            "type": "long"
                        },
                        {
                            "name": "JobStartTime",
                            "type": "datetime"
                        },
                        {
                            "name": "JobEndTime",
                            "type": "datetime"
                        },
                        {
                            "name": "DatabasesRead",
                            "type": "dynamic"
                        },
                        {
                            "name": "DatabasesWrite",
                            "type": "dynamic"
                        },
                        {
                            "name": "TablesRead",
                            "type": "dynamic"
                        },
                        {
                            "name": "TablesWrite",
                            "type": "dynamic"
                        },
                        {
                            "name": "Query",
                            "type": "string"
                        },
                        {
                            "name": "ResultTableCount",
                            "type": "long"
                        },
                        {
                            "name": "QueryResponse",
                            "type": "string"
                        },
                        {
                            "name": "TotalRows",
                            "type": "dynamic"
                        },
                        {
                            "name": "ComponentFault",
                            "type": "string"
                        },
                        {
                            "name": "FailureReason",
                            "type": "string"
                        },
                        {
                            "name": "ExecutionDuration",
                            "type": "long"
                        },
                        {
                            "name": "TotalCPU",
                            "type": "long"
                        },
                        {
                            "name": "MemoryPeak",
                            "type": "long"
                        },
                        {
                            "name": "BillingAzureSubscriptionId",
                            "type": "string"
                        },
                        {
                            "name": "BillingAzureResourceGroupName",
                            "type": "string"
                        },
                        {
                            "name": "ProvisioningStatus",
                            "type": "string"
                        },
                        {
                            "name": "DataOnboardingAtSetup",
                            "type": "string"
                        },
                        {
                            "name": "Tables",
                            "type": "dynamic"
                        },
                        {
                            "name": "SubscriptionsEnabled",
                            "type": "dynamic"
                        },
                        {
                            "name": "DataOnboardingStatus",
                            "type": "string"
                        },
                        {
                            "name": "EventOccurenceTime",
                            "type": "datetime"
                        },
                        {
                            "name": "ToolID",
                            "type": "string"
                        },
                        {
                            "name": "ToolName",
                            "type": "string"
                        },
                        {
                            "name": "InputParameters",
                            "type": "string"
                        },
                        {
                            "name": "APIsCalled",
                            "type": "dynamic"
                        },
                        {
                            "name": "DataScanned",
                            "type": "long"
                        },
                        {
                            "name": "TotalCpuHours",
                            "type": "long"
                        },
                        {
                            "name": "TotalSCUHours",
                            "type": "long"
                        },
                        {
                            "name": "GraphName",
                            "type": "string"
                        },
                        {
                            "name": "OperationInput",
                            "type": "string"
                        },
                        {
                            "name": "GraphQueryStats",
                            "type": "string"
                        },
                        {
                            "name": "GraphQueryStatus",
                            "type": "string"
                        },
                        {
                            "name": "DataCenterSecurityEventType",
                            "type": "string"
                        },
                        {
                            "name": "ElevationTime",
                            "type": "datetime"
                        },
                        {
                            "name": "ElevationApprover",
                            "type": "string"
                        },
                        {
                            "name": "ElevationApprovedTime",
                            "type": "datetime"
                        },
                        {
                            "name": "ElevationRequestId",
                            "type": "string"
                        },
                        {
                            "name": "ElevationRole",
                            "type": "string"
                        },
                        {
                            "name": "ElevationDuration",
                            "type": "int"
                        },
                        {
                            "name": "GenericInfo",
                            "type": "string"
                        },
                        {
                            "name": "EventName",
                            "type": "string"
                        },
                        {
                            "name": "PulseId",
                            "type": "string"
                        },
                        {
                            "name": "EventDetails",
                            "type": "dynamic"
                        },
                        {
                            "name": "SharePointMetaData",
                            "type": "dynamic"
                        },
                        {
                            "name": "ExchangeMetaData",
                            "type": "dynamic"
                        },
                        {
                            "name": "EndpointMetaData",
                            "type": "dynamic"
                        },
                        {
                            "name": "ExceptionInfo",
                            "type": "string"
                        },
                        {
                            "name": "PolicyDetails",
                            "type": "dynamic"
                        },
                        {
                            "name": "SensitiveInfoDetectionIsIncluded",
                            "type": "boolean"
                        }
                    ]
                }
            },
            "destinations": {
                "logAnalytics": [
                    {
                        "workspaceResourceId": "{{workspaceResourceId}}",
                        "name": "clv2ws1"
                    }
                ]
            },
            "dataFlows": [
                {
                    "streams": [
                        "Custom-M365AuditGeneralInput"
                    ],
                    "destinations": [
                        "clv2ws1"
                    ],
                    "transformKql": "source | where RecordType != 21 and RecordType != 278 and RecordType != 25 and RecordType != 71 and RecordType != 72 and RecordType != 75 and RecordType != 82 and RecordType != 83 and RecordType != 84 and RecordType != 93 and RecordType != 94 and RecordType != 95 and RecordType != 96 and RecordType != 97",
                    "outputStream": "Custom-M365AuditGeneral_CL"
                }
            ]
        }
    }
]
