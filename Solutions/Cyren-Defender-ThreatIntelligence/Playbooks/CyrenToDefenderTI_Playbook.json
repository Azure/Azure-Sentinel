{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "title": "Cyren to Defender TI - Playbook",
    "description": "This playbook polls the Cyren CCF threat intelligence feed and pushes STIX indicators to Microsoft Sentinel's ThreatIntelligenceIndicator table via the Sentinel TI createIndicator API.",
    "prerequisites": [
      "Cyren CCF API JWT Bearer token",
      "Microsoft Sentinel workspace with Sentinel enabled",
      "Logic App managed identity must have Microsoft Sentinel Contributor role on the workspace",
      "Logic App managed identity must have Storage Blob Data Contributor role on the storage account"
    ],
    "postDeployment": [
      "1. Verify the Logic App recurrence is 6 hours (NOT 15 minutes)",
      "2. Verify count=1000 and queryWindowInMin=360 in the Cyren API URL",
      "3. Verify PersistentToken pagination (NOT Offset)",
      "4. Check RBAC role assignments for the Logic App managed identity",
      "5. Enable the Logic App (it deploys in Disabled state)",
      "6. Run one manual trigger and check the run history",
      "7. Monitor for runaway polling in the first 24 hours"
    ],
    "lastUpdateTime": "2026-02-17T00:00:00.000Z",
    "tags": [
      "Cyren",
      "Threat Intelligence",
      "Defender",
      "STIX",
      "Automation"
    ],
    "support": {
      "tier": "Partner"
    },
    "author": {
      "name": "Data443 Risk Mitigation"
    }
  },
  "parameters": {
    "PlaybookName": {
      "defaultValue": "CyrenToDefenderTI",
      "type": "string",
      "metadata": {
        "description": "Name of the Logic App/Playbook"
      }
    }
  },
  "variables": {
    "comment": "The actual Logic App is deployed as part of the main template (Package/mainTemplate.json). This file serves as metadata for the Sentinel Content Hub solution packaging."
  },
  "resources": [],
  "outputs": {}
}
