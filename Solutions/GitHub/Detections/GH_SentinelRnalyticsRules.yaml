---
"$schema": https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#
contentVersion: 1.0.0.0
parameters:
  workspace:
    type: String
resources:
- id: "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'),
    'Microsoft.SecurityInsights'),'/alertRules/0b85a077-8ba5-4cb5-90f7-1e882afe10c4')]"
  name: "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/0b85a077-8ba5-4cb5-90f7-1e882afe10c4')]"
  type: Microsoft.OperationalInsights/workspaces/providers/alertRules
  kind: Scheduled
  apiVersion: 2021-09-01-preview
  properties:
    displayName: "(Preview) GitHub - A payment method was removed"
    description: This analytic alerts us everytime a payment method was removed, it
      runs every 6 hours and its severity is Medium.
    severity: Medium
    enabled: false
    query: "GitHubAuditLogPolling_CL\r\n| where action_s == \"payment_method.remove\""
    queryFrequency: PT6H
    queryPeriod: PT6H
    triggerOperator: GreaterThan
    triggerThreshold: 0
    suppressionDuration: PT1H
    suppressionEnabled: false
    tactics:
    - Persistence
    - Exfiltration
    - DefenseEvasion
    techniques: []
    alertRuleTemplateName:
    incidentConfiguration:
      createIncident: true
      groupingConfiguration:
        enabled: false
        reopenClosedIncident: false
        lookbackDuration: PT5M
        matchingMethod: AllEntities
        groupByEntities: []
        groupByAlertDetails:
        groupByCustomDetails:
    eventGroupingSettings:
    alertDetailsOverride:
    customDetails:
    entityMappings:
- id: "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'),
    'Microsoft.SecurityInsights'),'/alertRules/0b85a077-8ba5-4cb5-90f7-1e882afe10c5')]"
  name: "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/0b85a077-8ba5-4cb5-90f7-1e882afe10c5')]"
  type: Microsoft.OperationalInsights/workspaces/providers/alertRules
  kind: Scheduled
  apiVersion: 2021-09-01-preview
  properties:
    displayName: "(Preview) GitHub - Oauth application - a client secret was removed"
    description: This analytic alerts us everytime a client sevret was removed, it
      runs every 6 hours and its severity is Medium.
    severity: Medium
    enabled: false
    query: "GitHubAuditLogPolling_CL\r\n| where action_s == \"oauth_application.remove_client_secret\""
    queryFrequency: PT6H
    queryPeriod: PT6H
    triggerOperator: GreaterThan
    triggerThreshold: 0
    suppressionDuration: PT1H
    suppressionEnabled: false
    tactics:
    - Persistence
    - Exfiltration
    - DefenseEvasion
    techniques: []
    alertRuleTemplateName:
    incidentConfiguration:
      createIncident: true
      groupingConfiguration:
        enabled: false
        reopenClosedIncident: false
        lookbackDuration: PT5M
        matchingMethod: AllEntities
        groupByEntities: []
        groupByAlertDetails:
        groupByCustomDetails:
    eventGroupingSettings:
    alertDetailsOverride:
    customDetails:
    entityMappings:
- id: "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'),
    'Microsoft.SecurityInsights'),'/alertRules/0b85a077-8ba5-4cb5-90f7-1e882afe10c3')]"
  name: "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/0b85a077-8ba5-4cb5-90f7-1e882afe10c3')]"
  type: Microsoft.OperationalInsights/workspaces/providers/alertRules
  kind: Scheduled
  apiVersion: 2021-09-01-preview
  properties:
    displayName: "(Preview) GitHub - Repository was destroyed"
    description: This analytic alerts us everytime a repository was destroyed, it
      runs every 6 hours and its severity is Medium.
    severity: Medium
    enabled: false
    query: "GitHubAuditLogPolling_CL\r\n| where action_s == \"repo.destroy\""
    queryFrequency: PT6H
    queryPeriod: PT6H
    triggerOperator: GreaterThan
    triggerThreshold: 0
    suppressionDuration: PT1H
    suppressionEnabled: false
    tactics:
    - Persistence
    - Exfiltration
    - DefenseEvasion
    techniques: []
    alertRuleTemplateName:
    incidentConfiguration:
      createIncident: true
      groupingConfiguration:
        enabled: false
        reopenClosedIncident: false
        lookbackDuration: PT5M
        matchingMethod: AllEntities
        groupByEntities: []
        groupByAlertDetails:
        groupByCustomDetails:
    eventGroupingSettings:
    alertDetailsOverride:
    customDetails:
    entityMappings:
- id: "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'),
    'Microsoft.SecurityInsights'),'/alertRules/0b85a077-8ba5-4cb5-90f7-1e882afe10c2')]"
  name: "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/0b85a077-8ba5-4cb5-90f7-1e882afe10c2')]"
  type: Microsoft.OperationalInsights/workspaces/providers/alertRules
  kind: Scheduled
  apiVersion: 2021-09-01-preview
  properties:
    displayName: "(Preview) GitHub - Repository was created"
    description: This analytic alerts us everytime a repository is created, it runs
      every 6 hours and its severity is low.
    severity: Low
    enabled: false
    query: "GitHubAuditLogPolling_CL\r\n| where action_s == \"repo.create\""
    queryFrequency: PT6H
    queryPeriod: PT6H
    triggerOperator: GreaterThan
    triggerThreshold: 0
    suppressionDuration: PT1H
    suppressionEnabled: false
    tactics:
    - Persistence
    - Exfiltration
    - DefenseEvasion
    techniques: []
    alertRuleTemplateName:
    incidentConfiguration:
      createIncident: true
      groupingConfiguration:
        enabled: false
        reopenClosedIncident: false
        lookbackDuration: PT5M
        matchingMethod: AllEntities
        groupByEntities: []
        groupByAlertDetails:
        groupByCustomDetails:
    eventGroupingSettings:
    alertDetailsOverride:
    customDetails:
    entityMappings:
