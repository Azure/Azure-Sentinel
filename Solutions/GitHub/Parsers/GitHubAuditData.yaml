id: 32d7c900-875f-43d6-9e48-987fd5df3762
Function:
  Title: Parser for GitHubAuditData
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: GitHubAuditData
FunctionAlias: GitHubAuditData
FunctionQuery: |
    let GitHubAuditLogPolling_view = view () {
    GitHubAuditLogPolling_CL
       | extend 
           TimeGenerated=unixtime_milliseconds_todatetime(created_at_d),
           Organization=column_ifexists('org_s', ''),
           Action=column_ifexists('action_s', ''),
           Repository=column_ifexists('repo_s', ''),
           Actor=column_ifexists('actor_s', ''),
           Country=column_ifexists('actor_location_country_code_s', ''),
           ImpactedUser=column_ifexists('user_s', ''),
           InvitedUserPermission=column_ifexists('permission_s', ''),
           Visibility=column_ifexists('visibility_s', ''),
           PreviousVisibility=column_ifexists('previous_visibility_s', ''),
           CurrentPermission=column_ifexists('permission_s', ''),
           PreviousPermission=column_ifexists('old_permission_s', ''),
           TeamName=column_ifexists('team_s', ''),
           BlockedUser=column_ifexists('blocked_user_s', '')
    };
    let GitHubAuditLogsV2_view = view () {
    GitHubAuditLogsV2_CL
       | extend 
           TimeGenerated=unixtime_milliseconds_todatetime(CreatedAt),
           Organization=column_ifexists('Org', ''),
           Action=column_ifexists('Action', ''),
           Repository=column_ifexists('Repo', ''),
           Actor=column_ifexists('Actor', ''),
           Country=column_ifexists('CountryCode', ''),
           ImpactedUser=column_ifexists('User', ''),
           InvitedUserPermission=column_ifexists('Permission', ''),
           Visibility=column_ifexists('Visibility', ''),
           PreviousVisibility=column_ifexists('PreviousVisibility', ''),
           CurrentPermission=column_ifexists('Permission', ''),
           PreviousPermission=column_ifexists('OldPermission', ''),
           TeamName=column_ifexists('Team', ''),
           BlockedUser=column_ifexists('BlockedUser', '')
    };
    union isfuzzy=true (GitHubAuditLogPolling_view), (GitHubAuditLogsV2_view)
       | project
           TimeGenerated,
           Organization,
           Action,
           Repository,
           Actor,
           Country,
           ImpactedUser,
           InvitedUserPermission,
           Visibility,
           PreviousVisibility,
           CurrentPermission,
           PreviousPermission,
           TeamName,
           BlockedUser
       | project-reorder TimeGenerated, Organization, Action, Repository, Actor, Country, ImpactedUser, InvitedUserPermission, Visibility, PreviousVisibility, CurrentPermission, PreviousPermission, TeamName, BlockedUser