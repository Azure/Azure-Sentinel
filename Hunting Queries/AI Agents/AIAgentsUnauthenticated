id: 7f8e3c42-9d2a-4b5c-8e1f-3a7b9c4d5e6f
name: Unauthenticated AI Agents
description: |
  'Identifies AI agents that lack authentication mechanisms, which may pose significant security risks to the organization.
  These agents are publicly available and should be reviewed to ensure they are intentionally configured without authentication.
  Organizations should acknowledge and address any potential security implications of unauthenticated AI agents.'
requiredDataConnectors: []
tactics:
  - InitialAccess
relevantTechniques:
  - T1078
query: |
  // It is critical to identify agents that lack authentication mechanisms, as these may pose significant risks to the organization   
  // due to their public availability. Organizations should know about these agents so they can acknowledge any issues.  
  AIAgentsInfo 
  | summarize arg_max(Timestamp, *) by AIAgentId 
  | where AgentStatus != "Deleted"  
  | where UserAuthenticationType == "None" 
  | project-reorder AgentCreationTime, AIAgentId, AIAgentName, AgentStatus, CreatorAccountUpn, OwnerAccountUpns
  | extend AccountCustomEntity = CreatorAccountUpn
  | extend HostCustomEntity = AIAgentName
entityMappings:
  - entityType: Account
    fieldMappings:
      - identifier: FullName
        columnName: CreatorAccountUpn
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: AIAgentName
version: 1.0.0
