id: 2b7c1d3e-4f5a-6b7c-8d9e-0f1a2b3c4d5e
name: AI Agents - No Authentication Required
description: |
  This query identifies Copilot Studio AI agents without authentication mechanisms. Authentication is an agent-level configuration. 
  Such misconfiguration poses significant security risks because when the agent accesses resources requiring authentication, it authenticates as the agent's creator, not the user interacting with it. 
  If the agent has access to sensitive information, this could allow users to access resources they shouldn`t. Additionally, it expands the attack surface: if an attacker compromises a user who can access such an agent, the attacker can also authenticate as the maker.
requiredDataConnectors: []
tactics:
  - InitialAccess
  - PrivilegeEscalation
relevantTechniques:
  - T1078
  - T1190
query: |
  AIAgentsInfo  
  | summarize arg_max(Timestamp, *) by AIAgentId 
  | where AgentStatus != "Deleted"  
  | where AuthenticationTrigger == "As Needed" or UserAuthenticationType == "None" 
  | project-reorder AgentCreationTime, AIAgentId, AIAgentName, AgentStatus, CreatorAccountUpn, OwnerAccountUpns
entityMappings:
  - entityType: Account
    fieldMappings:
      - identifier: FullName
        columnName: CreatorAccountUpn
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: AIAgentName

version: 1.0.0
