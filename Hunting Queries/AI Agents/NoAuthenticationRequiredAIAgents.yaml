id: 2b7c1d3e-4f5a-6b7c-8d9e-0f1a2b3c4d5e
name: AI Agents - No Authentication Required
description: |
    This query identifies Copilot Studio AI agents that do not enforce authentication requirements and instead use an “As Needed” trigger. 
    //This configuration creates significant security risks because it allows agents to operate without consistent identity verification. 
    //If an agent interacts with sensitive resources, any user accessing it could bypass authentication controls, potentially exposing data or enabling unauthorized actions. 
    //Additionally, if an attacker compromises a user who can access such an agent, they could exploit this gap to escalate privileges or move laterally within the environment.
requiredDataConnectors: []
tactics:
  - InitialAccess
  - PrivilegeEscalation
relevantTechniques:
  - T1078
  - T1190
query: |
  // It is critical to identify agents that lack authentication requirements mechanisms, as these may pose significant risks to   
  // the organization due to their public availability. Organizations should know about these agents so they can acknowledge any issues.  
  AIAgentsInfo  
  | summarize arg_max(Timestamp, *) by AIAgentId 
  | where AgentStatus != "Deleted"  
  | where AuthenticationTrigger == "As Needed"   
  | project-reorder AgentCreationTime, AIAgentId, AIAgentName, AgentStatus, CreatorAccountUpn, OwnerAccountUpns
entityMappings:
  - entityType: Account
    fieldMappings:
      - identifier: FullName
        columnName: CreatorAccountUpn
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: AIAgentName
version: 1.0.0