Function:
  Title: An ASIM function to returns the HTTP Status code name based on a numerical response code
  Version: '0.1'
  LastUpdated: Nov 28, 2022
References:
- Title: ASIM
  Link: https://aka.ms/AboutASIM
- Title: List of HTTP Status Codes
  Link: https://en.wikipedia.org/wiki/List_of_HTTP_status_codes
- Title: IIS HTTP Status Code overview
  Link: https://learn.microsoft.com/en-us/troubleshoot/developer/webapps/iis/www-administration-management/http-status-code  
Description: |
  This ASIM function returns the HTTP Status code name associated with the response code numerical value provided as a parameter. For example, for the Status code 200, the function returns OK.  
FunctionName: ASIM_LookupHTTPStatusCode
EquivalentBuiltInFunction: _ASIM_LookupHTTPStatusCode
FunctionParams:
  - Name: StatusCode
    Type: string

FunctionQuery: |
  let function = (StatusCode:string) {
    let HTTPStatusCodesTable=dynamic
    ({
    "100":"Continue",
    "101":"Switching Protocols",
    "102":"Processing",
    "103":"Early Hints",
    "200":"OK",
    "201":"Created",
    "202":"Accepted",
    "203":"Non-Authoritative Information",
    "204":"No Content",
    "205":"Reset Content",
    "206":"Partial Content",
    "207":"Multi-Status",
    "208":"Already Reported",
    "226":"IM Used",
    "300":"Multiple Choices",
    "301":"Moved Permanently",
    "302":"Found",
    "303":"See Other",
    "304":"Not Modified",
    "305":"Use Proxy",
    "306":"Switch Proxy",
    "307":"Temporary Redirect",
    "308":"Permanent Redirect",
    "400":"Bad Request",
    "400.1":"Invalid Destination Header",
    "400.2":"Invalid Depth Header",
    "400.3":"Invalid If Header",
    "400.4":"Invalid Overwrite Header",
    "400.5":"Invalid Translate Header",
    "400.6":"Invalid Request Body",
    "400.7":"Invalid Content Length",
    "400.8":"Invalid Timeout",
    "400.9":"Invalid Lock Token",
    "400.10":"Invalid X-Forwarded-For (XFF) header",
    "400.11":"Invalid WebSocket request",
    "400.601":"Bad client request (ARR)",
    "400.602":"Invalid time format (ARR)",
    "400.603":"Parse range error (ARR)",
    "400.604":"Client gone (ARR)",
    "400.605":"Maximum number of forwards (ARR)",
    "400.606":"Asynchronous competition error (ARR)",
    "401":"Unauthorized",
    "401.1":"Logon failed",
    "401.2":"Logon failed due to server configuration",
    "401.3":"Unauthorized due to ACL on resource",
    "401.4":"Authorization failed by filter",
    "401.5":"Authorization failed by ISAPI/CGI application",
    "401.501":"Access Denied: Too many requests from the same client IP; Dynamic IP Restriction Concurrent request rate limit reached.",
    "401.502":"Forbidden: Too many requests from the same client IP; Dynamic IP Restriction Maximum request rate limit reached.",
    "401.503":"Access Denied: the IP address is included in the Deny list of IP Restriction",
    "401.504":"Access Denied: the host name is included in the Deny list of IP Restriction",
    "402":"Payment Required",
    "403":"Forbidden",
    "403.1":"Execute access forbidden",
    "403.2":"Read access forbidden",
    "403.3":"Write access forbidden",
    "403.4":"SSL required",
    "403.5":"SSL 128 required",
    "403.6":"IP address rejected",
    "403.7":"Client certificate required",
    "403.8":"Site access denied",
    "403.9":"Forbidden: Too many clients are trying to connect to the web server",
    "403.10":"Forbidden: web server is configured to deny Execute access",
    "403.11":"Forbidden: Password has been changed",
    "403.12":"Mapper denied access",
    "403.13":"Client certificate revoked",
    "403.14":"Directory listing denied",
    "403.15":"Forbidden: Client access licenses have exceeded limits on the web server",
    "403.16":"Client certificate is untrusted or invalid",
    "403.17":"Client certificate has expired or is not yet valid",
    "403.18":"Cannot execute requested URL in the current application pool",
    "403.19":"Cannot execute CGI applications for the client in this application pool",
    "403.20":"Forbidden: Passport logon failed",
    "403.21":"Forbidden: Source access denied",
    "403.22":"Forbidden: Infinite depth is denied",
    "403.501":"Forbidden: Too many requests from the same client IP; Dynamic IP Restriction Concurrent request rate limit reached",
    "403.502":"Forbidden: Too many requests from the same client IP; Dynamic IP Restriction Maximum request rate limit reached",
    "403.503":"Forbidden: the IP address is included in the Deny list of IP Restriction",
    "403.504":"Forbidden: the host name is included in the Deny list of IP Restriction",
    "404":"Not Found",
    "404.0":"Not found",
    "404.1":"Site Not Found",
    "404.2":"ISAPI or CGI restriction",
    "404.3":"Multipurpose Internet Mail Extensions (MIME) type restriction",
    "404.4":"No handler configured",
    "404.5":"Denied by request filtering configuration",
    "404.6":"Verb denied",
    "404.7":"File extension denied",
    "404.8":"Hidden namespace",
    "404.9":"File attribute hidden",
    "404.10":"Request header too long",
    "404.11":"Request contains double escape sequence",
    "404.12":"Request contains high-bit characters",
    "404.13":"Content length too large",
    "404.14":"Request URL too long",
    "404.15":"Query string too long",
    "404.16":"DAV request sent to the static file handler",
    "404.17":"Dynamic content mapped to the static file handler via a wildcard MIME mapping",
    "404.18":"Querystring sequence denied",
    "404.19":"Denied by filtering rule",
    "404.20":"Too Many URL Segments",
    "404.501":"Not Found: Too many requests from the same client IP; Dynamic IP Restriction Concurrent request rate limit reached",
    "404.502":"Not Found: Too many requests from the same client IP; Dynamic IP Restriction Maximum request rate limit reached",
    "404.503":"Not Found: the IP address is included in the Deny list of IP Restriction",
    "404.504":"Not Found: the host name is included in the Deny list of IP Restriction",      
    "405":"Method Not Allowed",
    "406":"Not Acceptable",
    "407":"Proxy Authentication Required",
    "408":"Request Timeout",
    "409":"Conflict",
    "410":"Gone",
    "411":"Length Required",
    "412":"Precondition Failed",
    "413":"Payload Too Large",
    "414":"URI Too Long",
    "415":"Unsupported Media Type",
    "416":"Range Not Satisfiable",
    "417":"Expectation Failed",
    "418":"I'm a teapot", // probably the most common one ;^)
    "421":"Misdirect Request",
    "422":"Unprocessable Entity",
    "423":"Locked",
    "424":"Failed Dependency",
    "425":"Too Early",
    "426":"Upgrade Required",
    "428":"Precondition Required",
    "429":"Too Many Requests",
    "431":"Request Header Fields Too Large",
    "451":"Unavailable For Legal Reasons/Redirect",
    "500":"Internal Server Error",
    "500.0":"Module or ISAPI error occurred",
    "500.11":"Application is shutting down on the web server",
    "500.12":"Application is busy restarting on the web server",
    "500.13":"Web server is too busy",
    "500.15":"Direct requests for Global.asax are not allowed",
    "500.19":"Configuration data is invalid",
    "500.21":"Module not recognized",
    "500.22":"An ASP.NET httpModules configuration does not apply in Managed Pipeline mode",
    "500.23":"An ASP.NET httpHandlers configuration does not apply in Managed Pipeline mode",
    "500.24":"An ASP.NET impersonation configuration does not apply in Managed Pipeline mode",
    "500.50":"A rewrite error occurred during RQ_BEGIN_REQUEST notification handling. A configuration or inbound rule execution error occurred.",
    "500.51":"A rewrite error occurred during GL_PRE_BEGIN_REQUEST notification handling. A global configuration or global rule execution error occurred",
    "500.52":"A rewrite error occurred during RQ_SEND_RESPONSE notification handling. An outbound rule execution occurred",
    "500.53":"A rewrite error occurred during RQ_RELEASE_REQUEST_STATE notification handling. An outbound rule execution error occurred. The rule is configured to be executed before the output user cache gets updated",
    "500.100":"Internal ASP error",
    "501":"Not Implemented",
    "502":"Bad Gateway",
    "502.1":"CGI application timeout",
    "502.2":"Bad gateway: Premature Exit/Map request failure (ARR)",
    "502.3":"Bad Gateway: Forwarder Connection Error (ARR)/WinHTTP asynchronous completion failure (ARR)",
    "502.4":"Bad Gateway: No Server (ARR)",
    "502.5":"WebSocket failure (ARR)",
    "502.6":"Forwarded request failure (ARR)",
    "502.7":"Execute request failure (ARR)",
    "503":"Service Unavailable",
    "503.0":"Application pool unavailable",
    "503.2":"Concurrent request limit exceeded",
    "503.3":"ASP.NET queue full",
    "503.4":"FastCGI queue full",
    "504":"Gateway Timeout",
    "505":"HTTP Version Not Supported",
    "506":"Variant Also Negotiates",
    "507":"Insufficient Storage",
    "508":"Loop Detected",
    "510":"Not Extended",
    "511":"Network Authentication Required",
    "419":"Page Expired",
    "420":"Method Failure",
    "430":"Request Header Field Too Large",
    "450":"Blocked by Windows Parental Controls",
    "498":"Invalid Token",
    "499":"Token Required(Esri)/Client Closed Request(nginx)",
    "509":"Bandwith Limit Exceeded",
    "529":"Site is overloaded",
    "530":"Site is frozen/Cloudflare HTTP error 530 is returned with an accompanying 1XXX error displayed",
    "598":"Network read timeout error",
    "599":"Network Connect Timeout Error",
    "440":"Login Time-out",
    "449":"Retry With",
    "444":"No Response",
    "494":"Request header too large",
    "495":"SSL Certificate Error",
    "496":"SSL Certificate Required",
    "497":"HTTP Request Sent to HTTPS Port",
    "520":"Web Server Returned an Unknown Error",
    "521":"Web Server Is Down",
    "523":"Origin Is Unreachable",
    "524":"A Timeout Occurred",
    "525":"SSL Handshake Failed",
    "526":"Invalid SSL Certificate",
    "527":"Railgun Error",
    "561":"Unauthorized",
    "110":"Response is Stale",
    "111":"Revalidation Failed",
    "112":"Disconnected Operation",
    "113":"Heuristic Expiration",
    "199":"Miscellaneous Warning",
    "214":"Transformation Applied",
    "299":"Miscellaneous Persistent Warning",
    "460":"AWS ELB Client closed the connection with the load balancer before the idle timeout period elapsed",
    "463":"AWS ELB The load balancer received an X-Forwarded-For request header with more than 30 IP addresses"
    });
    let HTTPStatusCodeLookup = HTTPStatusCodesTable[tostring(StatusCode)];
    iff (isnotempty(HTTPStatusCodeLookup), HTTPStatusCodeLookup, 'Unassigned')
  };
  function (StatusCode)